{"version":3,"file":"emailNotificationService-ca9f8bfb.js","sources":["../../src/services/emailNotificationService.js"],"sourcesContent":["/**\r\n * Email Notification Service\r\n * Integrates with the Nodemailer backend to send email notifications\r\n * Works with Supabase data\r\n */\r\n\r\nconst BACKEND_URL = import.meta.env.VITE_BACKEND_URL || 'http://localhost:8080';\r\n\r\nclass EmailNotificationService {\r\n  /**\r\n   * Send challenge notification email when someone is challenged\r\n   */\r\n  async sendChallengeNotification(challengeData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: challengeData.defenderEmail,\r\n        to_name: challengeData.defenderName,\r\n        from_name: challengeData.challengerName,\r\n        challenger_position: challengeData.challengerPosition,\r\n        defender_position: challengeData.defenderPosition,\r\n        ladder_name: challengeData.ladderName,\r\n        challenge_type: challengeData.matchType || 'Standard',\r\n        entry_fee: challengeData.entryFee || 5,\r\n        race_length: challengeData.raceLength || 'Race to 7',\r\n        game_type: challengeData.gameType || '9-ball',\r\n        proposed_date: challengeData.proposedDate,\r\n        proposed_location: challengeData.proposedLocation,\r\n        expires_at: challengeData.expiresAt,\r\n        message: challengeData.message || ''\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-challenge-notification`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Challenge notification email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending challenge notification email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send challenge accepted confirmation email\r\n   */\r\n  async sendChallengeAccepted(challengeData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: challengeData.challengerEmail,\r\n        to_name: challengeData.challengerName,\r\n        from_name: challengeData.defenderName,\r\n        challenger_position: challengeData.challengerPosition,\r\n        defender_position: challengeData.defenderPosition,\r\n        ladder_name: challengeData.ladderName,\r\n        match_date: challengeData.matchDate,\r\n        match_location: challengeData.location,\r\n        game_type: challengeData.gameType || '9-ball',\r\n        race_length: challengeData.raceLength || 'Race to 7'\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-challenge-confirmation`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Challenge accepted email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending challenge accepted email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send challenge declined email\r\n   */\r\n  async sendChallengeDeclined(challengeData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: challengeData.challengerEmail,\r\n        to_name: challengeData.challengerName,\r\n        from_name: challengeData.defenderName,\r\n        challenger_position: challengeData.challengerPosition,\r\n        defender_position: challengeData.defenderPosition,\r\n        ladder_name: challengeData.ladderName,\r\n        decline_reason: challengeData.declineReason || 'No reason provided'\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-challenge-decline`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Challenge declined email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending challenge declined email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send counter-proposal email\r\n   */\r\n  async sendCounterProposal(challengeData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: challengeData.challengerEmail,\r\n        to_name: challengeData.challengerName,\r\n        from_name: challengeData.defenderName,\r\n        original_date: challengeData.originalDate,\r\n        original_location: challengeData.originalLocation,\r\n        counter_date: challengeData.counterDate,\r\n        counter_location: challengeData.counterLocation,\r\n        ladder_name: challengeData.ladderName,\r\n        message: challengeData.message || ''\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-counter-proposal`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Counter-proposal email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending counter-proposal email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send match completed notification\r\n   */\r\n  async sendMatchCompleted(matchData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: matchData.loserEmail,\r\n        player_name: matchData.loserName,\r\n        opponent_name: matchData.winnerName,\r\n        match_date: matchData.matchDate,\r\n        location: matchData.location,\r\n        score: matchData.score,\r\n        ladder_name: matchData.ladderName,\r\n        new_position: matchData.newPosition\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-match-completed`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Match completed email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending match completed email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send match reminder email\r\n   */\r\n  async sendMatchReminder(matchData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: matchData.playerEmail,\r\n        to_name: matchData.playerName,\r\n        opponent_name: matchData.opponentName,\r\n        match_date: matchData.matchDate,\r\n        match_time: matchData.matchTime,\r\n        location: matchData.location,\r\n        ladder_name: matchData.ladderName\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-match-reminder`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Match reminder email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending match reminder email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send ladder application approved email\r\n   */\r\n  async sendLadderApproval(userData) {\r\n    try {\r\n      const emailData = {\r\n        to_email: userData.email,\r\n        to_name: `${userData.firstName} ${userData.lastName}`,\r\n        pin: userData.pin || 'Check your profile',\r\n        ladder_name: userData.ladderName,\r\n        position: userData.position\r\n      };\r\n\r\n      const response = await fetch(`${BACKEND_URL}/api/email/send-ladder-approval`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(emailData)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('ðŸ“§ Ladder approval email sent:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error sending ladder approval email:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send payment reminder email\r\n   */\r\n  async sendPaymentReminder(userData) {\r\n    try {\r\n      // This would need a new backend endpoint\r\n      // For now, we can use a generic admin email or create this endpoint\r\n      console.log('ðŸ“§ Payment reminder not yet implemented');\r\n      return { success: false, error: 'Not implemented yet' };\r\n    } catch (error) {\r\n      console.error('Error sending payment reminder:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const emailNotificationService = new EmailNotificationService();\r\nexport default emailNotificationService;\r\n\r\n"],"names":["BACKEND_URL","EmailNotificationService","challengeData","emailData","result","error","matchData","userData","emailNotificationService"],"mappings":"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"}