var YN=Object.defineProperty;var GN=(n,t,r)=>t in n?YN(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var av=(n,t,r)=>(GN(n,typeof t!="symbol"?t+"":t,r),r);function VN(n,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const o=Object.getOwnPropertyDescriptor(s,a);o&&Object.defineProperty(n,a,o.get?o:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var Is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function KN(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var a=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(r,s,a.get?a:{enumerable:!0,get:function(){return n[s]}})}),r}var B2={exports:{}},Fm={},O2={exports:{}},wr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph=Symbol.for("react.element"),JN=Symbol.for("react.portal"),XN=Symbol.for("react.fragment"),QN=Symbol.for("react.strict_mode"),ZN=Symbol.for("react.profiler"),e4=Symbol.for("react.provider"),t4=Symbol.for("react.context"),r4=Symbol.for("react.forward_ref"),n4=Symbol.for("react.suspense"),s4=Symbol.for("react.memo"),a4=Symbol.for("react.lazy"),ov=Symbol.iterator;function o4(n){return n===null||typeof n!="object"?null:(n=ov&&n[ov]||n["@@iterator"],typeof n=="function"?n:null)}var z2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F2=Object.assign,W2={};function bd(n,t,r){this.props=n,this.context=t,this.refs=W2,this.updater=r||z2}bd.prototype.isReactComponent={};bd.prototype.setState=function(n,t){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,t,"setState")};bd.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function U2(){}U2.prototype=bd.prototype;function ly(n,t,r){this.props=n,this.context=t,this.refs=W2,this.updater=r||z2}var cy=ly.prototype=new U2;cy.constructor=ly;F2(cy,bd.prototype);cy.isPureReactComponent=!0;var iv=Array.isArray,q2=Object.prototype.hasOwnProperty,dy={current:null},H2={key:!0,ref:!0,__self:!0,__source:!0};function Y2(n,t,r){var s,a={},o=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)q2.call(t,s)&&!H2.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(n&&n.defaultProps)for(s in l=n.defaultProps,l)a[s]===void 0&&(a[s]=l[s]);return{$$typeof:ph,type:n,key:o,ref:i,props:a,_owner:dy.current}}function i4(n,t){return{$$typeof:ph,type:n.type,key:t,ref:n.ref,props:n.props,_owner:n._owner}}function uy(n){return typeof n=="object"&&n!==null&&n.$$typeof===ph}function l4(n){var t={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(r){return t[r]})}var lv=/\/+/g;function Af(n,t){return typeof n=="object"&&n!==null&&n.key!=null?l4(""+n.key):t.toString(36)}function mp(n,t,r,s,a){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var i=!1;if(n===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(n.$$typeof){case ph:case JN:i=!0}}if(i)return i=n,a=a(i),n=s===""?"."+Af(i,0):s,iv(a)?(r="",n!=null&&(r=n.replace(lv,"$&/")+"/"),mp(a,t,r,"",function(d){return d})):a!=null&&(uy(a)&&(a=i4(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(lv,"$&/")+"/")+n)),t.push(a)),1;if(i=0,s=s===""?".":s+":",iv(n))for(var l=0;l<n.length;l++){o=n[l];var c=s+Af(o,l);i+=mp(o,t,r,c,a)}else if(c=o4(n),typeof c=="function")for(n=c.call(n),l=0;!(o=n.next()).done;)o=o.value,c=s+Af(o,l++),i+=mp(o,t,r,c,a);else if(o==="object")throw t=String(n),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Ph(n,t,r){if(n==null)return n;var s=[],a=0;return mp(n,s,"","",function(o){return t.call(r,o,a++)}),s}function c4(n){if(n._status===-1){var t=n._result;t=t(),t.then(function(r){(n._status===0||n._status===-1)&&(n._status=1,n._result=r)},function(r){(n._status===0||n._status===-1)&&(n._status=2,n._result=r)}),n._status===-1&&(n._status=0,n._result=t)}if(n._status===1)return n._result.default;throw n._result}var $s={current:null},fp={transition:null},d4={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:fp,ReactCurrentOwner:dy};function G2(){throw Error("act(...) is not supported in production builds of React.")}wr.Children={map:Ph,forEach:function(n,t,r){Ph(n,function(){t.apply(this,arguments)},r)},count:function(n){var t=0;return Ph(n,function(){t++}),t},toArray:function(n){return Ph(n,function(t){return t})||[]},only:function(n){if(!uy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};wr.Component=bd;wr.Fragment=XN;wr.Profiler=ZN;wr.PureComponent=ly;wr.StrictMode=QN;wr.Suspense=n4;wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d4;wr.act=G2;wr.cloneElement=function(n,t,r){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=F2({},n.props),a=n.key,o=n.ref,i=n._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=dy.current),t.key!==void 0&&(a=""+t.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in t)q2.call(t,c)&&!H2.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:ph,type:n.type,key:a,ref:o,props:s,_owner:i}};wr.createContext=function(n){return n={$$typeof:t4,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:e4,_context:n},n.Consumer=n};wr.createElement=Y2;wr.createFactory=function(n){var t=Y2.bind(null,n);return t.type=n,t};wr.createRef=function(){return{current:null}};wr.forwardRef=function(n){return{$$typeof:r4,render:n}};wr.isValidElement=uy;wr.lazy=function(n){return{$$typeof:a4,_payload:{_status:-1,_result:n},_init:c4}};wr.memo=function(n,t){return{$$typeof:s4,type:n,compare:t===void 0?null:t}};wr.startTransition=function(n){var t=fp.transition;fp.transition={};try{n()}finally{fp.transition=t}};wr.unstable_act=G2;wr.useCallback=function(n,t){return $s.current.useCallback(n,t)};wr.useContext=function(n){return $s.current.useContext(n)};wr.useDebugValue=function(){};wr.useDeferredValue=function(n){return $s.current.useDeferredValue(n)};wr.useEffect=function(n,t){return $s.current.useEffect(n,t)};wr.useId=function(){return $s.current.useId()};wr.useImperativeHandle=function(n,t,r){return $s.current.useImperativeHandle(n,t,r)};wr.useInsertionEffect=function(n,t){return $s.current.useInsertionEffect(n,t)};wr.useLayoutEffect=function(n,t){return $s.current.useLayoutEffect(n,t)};wr.useMemo=function(n,t){return $s.current.useMemo(n,t)};wr.useReducer=function(n,t,r){return $s.current.useReducer(n,t,r)};wr.useRef=function(n){return $s.current.useRef(n)};wr.useState=function(n){return $s.current.useState(n)};wr.useSyncExternalStore=function(n,t,r){return $s.current.useSyncExternalStore(n,t,r)};wr.useTransition=function(){return $s.current.useTransition()};wr.version="18.3.1";O2.exports=wr;var y=O2.exports;const Te=Jo(y),u4=VN({__proto__:null,default:Te},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h4=y,p4=Symbol.for("react.element"),m4=Symbol.for("react.fragment"),f4=Object.prototype.hasOwnProperty,g4=h4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x4={key:!0,ref:!0,__self:!0,__source:!0};function V2(n,t,r){var s,a={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)f4.call(t,s)&&!x4.hasOwnProperty(s)&&(a[s]=t[s]);if(n&&n.defaultProps)for(s in t=n.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:p4,type:n,key:o,ref:i,props:a,_owner:g4.current}}Fm.Fragment=m4;Fm.jsx=V2;Fm.jsxs=V2;B2.exports=Fm;var e=B2.exports,a0={},K2={exports:{}},ca={},J2={exports:{}},X2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function t(z,$){var W=z.length;z.push($);e:for(;0<W;){var Y=W-1>>>1,Q=z[Y];if(0<a(Q,$))z[Y]=$,z[W]=Q,W=Y;else break e}}function r(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var $=z[0],W=z.pop();if(W!==$){z[0]=W;e:for(var Y=0,Q=z.length,H=Q>>>1;Y<H;){var ue=2*(Y+1)-1,J=z[ue],be=ue+1,Ae=z[be];if(0>a(J,W))be<Q&&0>a(Ae,J)?(z[Y]=Ae,z[be]=W,Y=be):(z[Y]=J,z[ue]=W,Y=ue);else if(be<Q&&0>a(Ae,W))z[Y]=Ae,z[be]=W,Y=be;else break e}}return $}function a(z,$){var W=z.sortIndex-$.sortIndex;return W!==0?W:z.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();n.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,p=3,g=!1,f=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(z){for(var $=r(d);$!==null;){if($.callback===null)s(d);else if($.startTime<=z)s(d),$.sortIndex=$.expirationTime,t(c,$);else break;$=r(d)}}function j(z){if(m=!1,x(z),!f)if(r(c)!==null)f=!0,R(S);else{var $=r(d);$!==null&&U(j,$.startTime-z)}}function S(z,$){f=!1,m&&(m=!1,b(N),N=-1),g=!0;var W=p;try{for(x($),h=r(c);h!==null&&(!(h.expirationTime>$)||z&&!P());){var Y=h.callback;if(typeof Y=="function"){h.callback=null,p=h.priorityLevel;var Q=Y(h.expirationTime<=$);$=n.unstable_now(),typeof Q=="function"?h.callback=Q:h===r(c)&&s(c),x($)}else s(c);h=r(c)}if(h!==null)var H=!0;else{var ue=r(d);ue!==null&&U(j,ue.startTime-$),H=!1}return H}finally{h=null,p=W,g=!1}}var _=!1,C=null,N=-1,M=5,E=-1;function P(){return!(n.unstable_now()-E<M)}function D(){if(C!==null){var z=n.unstable_now();E=z;var $=!0;try{$=C(!0,z)}finally{$?T():(_=!1,C=null)}}else _=!1}var T;if(typeof w=="function")T=function(){w(D)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,k=A.port2;A.port1.onmessage=D,T=function(){k.postMessage(null)}}else T=function(){v(D,0)};function R(z){C=z,_||(_=!0,T())}function U(z,$){N=v(function(){z(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){f||g||(f=!0,R(S))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return r(c)},n.unstable_next=function(z){switch(p){case 1:case 2:case 3:var $=3;break;default:$=p}var W=p;p=$;try{return z()}finally{p=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,$){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var W=p;p=z;try{return $()}finally{p=W}},n.unstable_scheduleCallback=function(z,$,W){var Y=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Y+W:Y):W=Y,z){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=W+Q,z={id:u++,callback:$,priorityLevel:z,startTime:W,expirationTime:Q,sortIndex:-1},W>Y?(z.sortIndex=W,t(d,z),r(c)===null&&z===r(d)&&(m?(b(N),N=-1):m=!0,U(j,W-Y))):(z.sortIndex=Q,t(c,z),f||g||(f=!0,R(S))),z},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(z){var $=p;return function(){var W=p;p=$;try{return z.apply(this,arguments)}finally{p=W}}}})(X2);J2.exports=X2;var y4=J2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b4=y,ia=y4;function gt(n){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+n,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+n+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q2=new Set,_u={};function Gl(n,t){rd(n,t),rd(n+"Capture",t)}function rd(n,t){for(_u[n]=t,n=0;n<t.length;n++)Q2.add(t[n])}var qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),o0=Object.prototype.hasOwnProperty,v4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cv={},dv={};function w4(n){return o0.call(dv,n)?!0:o0.call(cv,n)?!1:v4.test(n)?dv[n]=!0:(cv[n]=!0,!1)}function j4(n,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function S4(n,t,r,s){if(t===null||typeof t>"u"||j4(n,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ls(n,t,r,s,a,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=n,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var us={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){us[n]=new Ls(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var t=n[0];us[t]=new Ls(t,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){us[n]=new Ls(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){us[n]=new Ls(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){us[n]=new Ls(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){us[n]=new Ls(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){us[n]=new Ls(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){us[n]=new Ls(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){us[n]=new Ls(n,5,!1,n.toLowerCase(),null,!1,!1)});var hy=/[\-:]([a-z])/g;function py(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var t=n.replace(hy,py);us[t]=new Ls(t,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var t=n.replace(hy,py);us[t]=new Ls(t,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var t=n.replace(hy,py);us[t]=new Ls(t,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){us[n]=new Ls(n,1,!1,n.toLowerCase(),null,!1,!1)});us.xlinkHref=new Ls("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){us[n]=new Ls(n,1,!1,n.toLowerCase(),null,!0,!0)});function my(n,t,r,s){var a=us.hasOwnProperty(t)?us[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(S4(t,r,a,s)&&(r=null),s||a===null?w4(t)&&(r===null?n.removeAttribute(t):n.setAttribute(t,""+r)):a.mustUseProperty?n[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,s=a.attributeNamespace,r===null?n.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,s?n.setAttributeNS(s,t,r):n.setAttribute(t,r))))}var Xo=b4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Eh=Symbol.for("react.element"),Pc=Symbol.for("react.portal"),Ec=Symbol.for("react.fragment"),fy=Symbol.for("react.strict_mode"),i0=Symbol.for("react.profiler"),Z2=Symbol.for("react.provider"),e5=Symbol.for("react.context"),gy=Symbol.for("react.forward_ref"),l0=Symbol.for("react.suspense"),c0=Symbol.for("react.suspense_list"),xy=Symbol.for("react.memo"),ui=Symbol.for("react.lazy"),t5=Symbol.for("react.offscreen"),uv=Symbol.iterator;function Td(n){return n===null||typeof n!="object"?null:(n=uv&&n[uv]||n["@@iterator"],typeof n=="function"?n:null)}var xn=Object.assign,Mf;function Xd(n){if(Mf===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Mf=t&&t[1]||""}return`
`+Mf+n}var If=!1;function Df(n,t){if(!n||If)return"";If=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var s=d}Reflect.construct(n,[],t)}else{try{t.call()}catch(d){s=d}n.call(t.prototype)}else{try{throw Error()}catch(d){s=d}n()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),o=s.stack.split(`
`),i=a.length-1,l=o.length-1;1<=i&&0<=l&&a[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||a[i]!==o[l]){var c=`
`+a[i].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=i&&0<=l);break}}}finally{If=!1,Error.prepareStackTrace=r}return(n=n?n.displayName||n.name:"")?Xd(n):""}function _4(n){switch(n.tag){case 5:return Xd(n.type);case 16:return Xd("Lazy");case 13:return Xd("Suspense");case 19:return Xd("SuspenseList");case 0:case 2:case 15:return n=Df(n.type,!1),n;case 11:return n=Df(n.type.render,!1),n;case 1:return n=Df(n.type,!0),n;default:return""}}function d0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ec:return"Fragment";case Pc:return"Portal";case i0:return"Profiler";case fy:return"StrictMode";case l0:return"Suspense";case c0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case e5:return(n.displayName||"Context")+".Consumer";case Z2:return(n._context.displayName||"Context")+".Provider";case gy:var t=n.render;return n=n.displayName,n||(n=t.displayName||t.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case xy:return t=n.displayName||null,t!==null?t:d0(n.type)||"Memo";case ui:t=n._payload,n=n._init;try{return d0(n(t))}catch{}}return null}function k4(n){var t=n.type;switch(n.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=t.render,n=n.displayName||n.name||"",t.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return d0(t);case 8:return t===fy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $i(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function r5(n){var t=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function C4(n){var t=r5(n)?"checked":"value",r=Object.getOwnPropertyDescriptor(n.constructor.prototype,t),s=""+n[t];if(!n.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,o=r.set;return Object.defineProperty(n,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(n,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){n._valueTracker=null,delete n[t]}}}}function Rh(n){n._valueTracker||(n._valueTracker=C4(n))}function n5(n){if(!n)return!1;var t=n._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return n&&(s=r5(n)?n.checked?"true":"false":n.value),n=s,n!==r?(t.setValue(n),!0):!1}function Op(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function u0(n,t){var r=t.checked;return xn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??n._wrapperState.initialChecked})}function hv(n,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=$i(t.value!=null?t.value:r),n._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function s5(n,t){t=t.checked,t!=null&&my(n,"checked",t,!1)}function h0(n,t){s5(n,t);var r=$i(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+r):n.value!==""+r&&(n.value=""+r);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}t.hasOwnProperty("value")?p0(n,t.type,r):t.hasOwnProperty("defaultValue")&&p0(n,t.type,$i(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(n.defaultChecked=!!t.defaultChecked)}function pv(n,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+n._wrapperState.initialValue,r||t===n.value||(n.value=t),n.defaultValue=t}r=n.name,r!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,r!==""&&(n.name=r)}function p0(n,t,r){(t!=="number"||Op(n.ownerDocument)!==n)&&(r==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+r&&(n.defaultValue=""+r))}var Qd=Array.isArray;function qc(n,t,r,s){if(n=n.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<n.length;r++)a=t.hasOwnProperty("$"+n[r].value),n[r].selected!==a&&(n[r].selected=a),a&&s&&(n[r].defaultSelected=!0)}else{for(r=""+$i(r),t=null,a=0;a<n.length;a++){if(n[a].value===r){n[a].selected=!0,s&&(n[a].defaultSelected=!0);return}t!==null||n[a].disabled||(t=n[a])}t!==null&&(t.selected=!0)}}function m0(n,t){if(t.dangerouslySetInnerHTML!=null)throw Error(gt(91));return xn({},t,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function mv(n,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(gt(92));if(Qd(r)){if(1<r.length)throw Error(gt(93));r=r[0]}t=r}t==null&&(t=""),r=t}n._wrapperState={initialValue:$i(r)}}function a5(n,t){var r=$i(t.value),s=$i(t.defaultValue);r!=null&&(r=""+r,r!==n.value&&(n.value=r),t.defaultValue==null&&n.defaultValue!==r&&(n.defaultValue=r)),s!=null&&(n.defaultValue=""+s)}function fv(n){var t=n.textContent;t===n._wrapperState.initialValue&&t!==""&&t!==null&&(n.value=t)}function o5(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function f0(n,t){return n==null||n==="http://www.w3.org/1999/xhtml"?o5(t):n==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ah,i5=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,a){MSApp.execUnsafeLocalFunction(function(){return n(t,r,s,a)})}:n}(function(n,t){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=t;else{for(Ah=Ah||document.createElement("div"),Ah.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ah.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;t.firstChild;)n.appendChild(t.firstChild)}});function ku(n,t){if(t){var r=n.firstChild;if(r&&r===n.lastChild&&r.nodeType===3){r.nodeValue=t;return}}n.textContent=t}var iu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N4=["Webkit","ms","Moz","O"];Object.keys(iu).forEach(function(n){N4.forEach(function(t){t=t+n.charAt(0).toUpperCase()+n.substring(1),iu[t]=iu[n]})});function l5(n,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||iu.hasOwnProperty(n)&&iu[n]?(""+t).trim():t+"px"}function c5(n,t){n=n.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,a=l5(r,t[r],s);r==="float"&&(r="cssFloat"),s?n.setProperty(r,a):n[r]=a}}var T4=xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function g0(n,t){if(t){if(T4[n]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(gt(137,n));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(gt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(gt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(gt(62))}}function x0(n,t){if(n.indexOf("-")===-1)return typeof t.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var y0=null;function yy(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var b0=null,Hc=null,Yc=null;function gv(n){if(n=gh(n)){if(typeof b0!="function")throw Error(gt(280));var t=n.stateNode;t&&(t=Ym(t),b0(n.stateNode,n.type,t))}}function d5(n){Hc?Yc?Yc.push(n):Yc=[n]:Hc=n}function u5(){if(Hc){var n=Hc,t=Yc;if(Yc=Hc=null,gv(n),t)for(n=0;n<t.length;n++)gv(t[n])}}function h5(n,t){return n(t)}function p5(){}var $f=!1;function m5(n,t,r){if($f)return n(t,r);$f=!0;try{return h5(n,t,r)}finally{$f=!1,(Hc!==null||Yc!==null)&&(p5(),u5())}}function Cu(n,t){var r=n.stateNode;if(r===null)return null;var s=Ym(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(r&&typeof r!="function")throw Error(gt(231,t,typeof r));return r}var v0=!1;if(qo)try{var Pd={};Object.defineProperty(Pd,"passive",{get:function(){v0=!0}}),window.addEventListener("test",Pd,Pd),window.removeEventListener("test",Pd,Pd)}catch{v0=!1}function P4(n,t,r,s,a,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var lu=!1,zp=null,Fp=!1,w0=null,E4={onError:function(n){lu=!0,zp=n}};function R4(n,t,r,s,a,o,i,l,c){lu=!1,zp=null,P4.apply(E4,arguments)}function A4(n,t,r,s,a,o,i,l,c){if(R4.apply(this,arguments),lu){if(lu){var d=zp;lu=!1,zp=null}else throw Error(gt(198));Fp||(Fp=!0,w0=d)}}function Vl(n){var t=n,r=n;if(n.alternate)for(;t.return;)t=t.return;else{n=t;do t=n,t.flags&4098&&(r=t.return),n=t.return;while(n)}return t.tag===3?r:null}function f5(n){if(n.tag===13){var t=n.memoizedState;if(t===null&&(n=n.alternate,n!==null&&(t=n.memoizedState)),t!==null)return t.dehydrated}return null}function xv(n){if(Vl(n)!==n)throw Error(gt(188))}function M4(n){var t=n.alternate;if(!t){if(t=Vl(n),t===null)throw Error(gt(188));return t!==n?null:n}for(var r=n,s=t;;){var a=r.return;if(a===null)break;var o=a.alternate;if(o===null){if(s=a.return,s!==null){r=s;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return xv(a),n;if(o===s)return xv(a),t;o=o.sibling}throw Error(gt(188))}if(r.return!==s.return)r=a,s=o;else{for(var i=!1,l=a.child;l;){if(l===r){i=!0,r=a,s=o;break}if(l===s){i=!0,s=a,r=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===r){i=!0,r=o,s=a;break}if(l===s){i=!0,s=o,r=a;break}l=l.sibling}if(!i)throw Error(gt(189))}}if(r.alternate!==s)throw Error(gt(190))}if(r.tag!==3)throw Error(gt(188));return r.stateNode.current===r?n:t}function g5(n){return n=M4(n),n!==null?x5(n):null}function x5(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var t=x5(n);if(t!==null)return t;n=n.sibling}return null}var y5=ia.unstable_scheduleCallback,yv=ia.unstable_cancelCallback,I4=ia.unstable_shouldYield,D4=ia.unstable_requestPaint,Pn=ia.unstable_now,$4=ia.unstable_getCurrentPriorityLevel,by=ia.unstable_ImmediatePriority,b5=ia.unstable_UserBlockingPriority,Wp=ia.unstable_NormalPriority,L4=ia.unstable_LowPriority,v5=ia.unstable_IdlePriority,Wm=null,mo=null;function B4(n){if(mo&&typeof mo.onCommitFiberRoot=="function")try{mo.onCommitFiberRoot(Wm,n,void 0,(n.current.flags&128)===128)}catch{}}var qa=Math.clz32?Math.clz32:F4,O4=Math.log,z4=Math.LN2;function F4(n){return n>>>=0,n===0?32:31-(O4(n)/z4|0)|0}var Mh=64,Ih=4194304;function Zd(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Up(n,t){var r=n.pendingLanes;if(r===0)return 0;var s=0,a=n.suspendedLanes,o=n.pingedLanes,i=r&268435455;if(i!==0){var l=i&~a;l!==0?s=Zd(l):(o&=i,o!==0&&(s=Zd(o)))}else i=r&~a,i!==0?s=Zd(i):o!==0&&(s=Zd(o));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,o=t&-t,a>=o||a===16&&(o&4194240)!==0))return t;if(s&4&&(s|=r&16),t=n.entangledLanes,t!==0)for(n=n.entanglements,t&=s;0<t;)r=31-qa(t),a=1<<r,s|=n[r],t&=~a;return s}function W4(n,t){switch(n){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U4(n,t){for(var r=n.suspendedLanes,s=n.pingedLanes,a=n.expirationTimes,o=n.pendingLanes;0<o;){var i=31-qa(o),l=1<<i,c=a[i];c===-1?(!(l&r)||l&s)&&(a[i]=W4(l,t)):c<=t&&(n.expiredLanes|=l),o&=~l}}function j0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function w5(){var n=Mh;return Mh<<=1,!(Mh&4194240)&&(Mh=64),n}function Lf(n){for(var t=[],r=0;31>r;r++)t.push(n);return t}function mh(n,t,r){n.pendingLanes|=t,t!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,t=31-qa(t),n[t]=r}function q4(n,t){var r=n.pendingLanes&~t;n.pendingLanes=t,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=t,n.mutableReadLanes&=t,n.entangledLanes&=t,t=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<r;){var a=31-qa(r),o=1<<a;t[a]=0,s[a]=-1,n[a]=-1,r&=~o}}function vy(n,t){var r=n.entangledLanes|=t;for(n=n.entanglements;r;){var s=31-qa(r),a=1<<s;a&t|n[s]&t&&(n[s]|=t),r&=~a}}var Ir=0;function j5(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var S5,wy,_5,k5,C5,S0=!1,Dh=[],ki=null,Ci=null,Ni=null,Nu=new Map,Tu=new Map,gi=[],H4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bv(n,t){switch(n){case"focusin":case"focusout":ki=null;break;case"dragenter":case"dragleave":Ci=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":Nu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tu.delete(t.pointerId)}}function Ed(n,t,r,s,a,o){return n===null||n.nativeEvent!==o?(n={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:o,targetContainers:[a]},t!==null&&(t=gh(t),t!==null&&wy(t)),n):(n.eventSystemFlags|=s,t=n.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),n)}function Y4(n,t,r,s,a){switch(t){case"focusin":return ki=Ed(ki,n,t,r,s,a),!0;case"dragenter":return Ci=Ed(Ci,n,t,r,s,a),!0;case"mouseover":return Ni=Ed(Ni,n,t,r,s,a),!0;case"pointerover":var o=a.pointerId;return Nu.set(o,Ed(Nu.get(o)||null,n,t,r,s,a)),!0;case"gotpointercapture":return o=a.pointerId,Tu.set(o,Ed(Tu.get(o)||null,n,t,r,s,a)),!0}return!1}function N5(n){var t=vl(n.target);if(t!==null){var r=Vl(t);if(r!==null){if(t=r.tag,t===13){if(t=f5(r),t!==null){n.blockedOn=t,C5(n.priority,function(){_5(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){n.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}n.blockedOn=null}function gp(n){if(n.blockedOn!==null)return!1;for(var t=n.targetContainers;0<t.length;){var r=_0(n.domEventName,n.eventSystemFlags,t[0],n.nativeEvent);if(r===null){r=n.nativeEvent;var s=new r.constructor(r.type,r);y0=s,r.target.dispatchEvent(s),y0=null}else return t=gh(r),t!==null&&wy(t),n.blockedOn=r,!1;t.shift()}return!0}function vv(n,t,r){gp(n)&&r.delete(t)}function G4(){S0=!1,ki!==null&&gp(ki)&&(ki=null),Ci!==null&&gp(Ci)&&(Ci=null),Ni!==null&&gp(Ni)&&(Ni=null),Nu.forEach(vv),Tu.forEach(vv)}function Rd(n,t){n.blockedOn===t&&(n.blockedOn=null,S0||(S0=!0,ia.unstable_scheduleCallback(ia.unstable_NormalPriority,G4)))}function Pu(n){function t(a){return Rd(a,n)}if(0<Dh.length){Rd(Dh[0],n);for(var r=1;r<Dh.length;r++){var s=Dh[r];s.blockedOn===n&&(s.blockedOn=null)}}for(ki!==null&&Rd(ki,n),Ci!==null&&Rd(Ci,n),Ni!==null&&Rd(Ni,n),Nu.forEach(t),Tu.forEach(t),r=0;r<gi.length;r++)s=gi[r],s.blockedOn===n&&(s.blockedOn=null);for(;0<gi.length&&(r=gi[0],r.blockedOn===null);)N5(r),r.blockedOn===null&&gi.shift()}var Gc=Xo.ReactCurrentBatchConfig,qp=!0;function V4(n,t,r,s){var a=Ir,o=Gc.transition;Gc.transition=null;try{Ir=1,jy(n,t,r,s)}finally{Ir=a,Gc.transition=o}}function K4(n,t,r,s){var a=Ir,o=Gc.transition;Gc.transition=null;try{Ir=4,jy(n,t,r,s)}finally{Ir=a,Gc.transition=o}}function jy(n,t,r,s){if(qp){var a=_0(n,t,r,s);if(a===null)Gf(n,t,s,Hp,r),bv(n,s);else if(Y4(a,n,t,r,s))s.stopPropagation();else if(bv(n,s),t&4&&-1<H4.indexOf(n)){for(;a!==null;){var o=gh(a);if(o!==null&&S5(o),o=_0(n,t,r,s),o===null&&Gf(n,t,s,Hp,r),o===a)break;a=o}a!==null&&s.stopPropagation()}else Gf(n,t,s,null,r)}}var Hp=null;function _0(n,t,r,s){if(Hp=null,n=yy(s),n=vl(n),n!==null)if(t=Vl(n),t===null)n=null;else if(r=t.tag,r===13){if(n=f5(t),n!==null)return n;n=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;n=null}else t!==n&&(n=null);return Hp=n,null}function T5(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($4()){case by:return 1;case b5:return 4;case Wp:case L4:return 16;case v5:return 536870912;default:return 16}default:return 16}}var vi=null,Sy=null,xp=null;function P5(){if(xp)return xp;var n,t=Sy,r=t.length,s,a="value"in vi?vi.value:vi.textContent,o=a.length;for(n=0;n<r&&t[n]===a[n];n++);var i=r-n;for(s=1;s<=i&&t[r-s]===a[o-s];s++);return xp=a.slice(n,1<s?1-s:void 0)}function yp(n){var t=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&t===13&&(n=13)):n=t,n===10&&(n=13),32<=n||n===13?n:0}function $h(){return!0}function wv(){return!1}function da(n){function t(r,s,a,o,i){this._reactName=r,this._targetInst=a,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(r=n[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?$h:wv,this.isPropagationStopped=wv,this}return xn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$h)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$h)},persist:function(){},isPersistent:$h}),t}var vd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_y=da(vd),fh=xn({},vd,{view:0,detail:0}),J4=da(fh),Bf,Of,Ad,Um=xn({},fh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ky,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ad&&(Ad&&n.type==="mousemove"?(Bf=n.screenX-Ad.screenX,Of=n.screenY-Ad.screenY):Of=Bf=0,Ad=n),Bf)},movementY:function(n){return"movementY"in n?n.movementY:Of}}),jv=da(Um),X4=xn({},Um,{dataTransfer:0}),Q4=da(X4),Z4=xn({},fh,{relatedTarget:0}),zf=da(Z4),e3=xn({},vd,{animationName:0,elapsedTime:0,pseudoElement:0}),t3=da(e3),r3=xn({},vd,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),n3=da(r3),s3=xn({},vd,{data:0}),Sv=da(s3),a3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l3(n){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(n):(n=i3[n])?!!t[n]:!1}function ky(){return l3}var c3=xn({},fh,{key:function(n){if(n.key){var t=a3[n.key]||n.key;if(t!=="Unidentified")return t}return n.type==="keypress"?(n=yp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?o3[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ky,charCode:function(n){return n.type==="keypress"?yp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?yp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),d3=da(c3),u3=xn({},Um,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_v=da(u3),h3=xn({},fh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ky}),p3=da(h3),m3=xn({},vd,{propertyName:0,elapsedTime:0,pseudoElement:0}),f3=da(m3),g3=xn({},Um,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),x3=da(g3),y3=[9,13,27,32],Cy=qo&&"CompositionEvent"in window,cu=null;qo&&"documentMode"in document&&(cu=document.documentMode);var b3=qo&&"TextEvent"in window&&!cu,E5=qo&&(!Cy||cu&&8<cu&&11>=cu),kv=String.fromCharCode(32),Cv=!1;function R5(n,t){switch(n){case"keyup":return y3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A5(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rc=!1;function v3(n,t){switch(n){case"compositionend":return A5(t);case"keypress":return t.which!==32?null:(Cv=!0,kv);case"textInput":return n=t.data,n===kv&&Cv?null:n;default:return null}}function w3(n,t){if(Rc)return n==="compositionend"||!Cy&&R5(n,t)?(n=P5(),xp=Sy=vi=null,Rc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return E5&&t.locale!=="ko"?null:t.data;default:return null}}var j3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nv(n){var t=n&&n.nodeName&&n.nodeName.toLowerCase();return t==="input"?!!j3[n.type]:t==="textarea"}function M5(n,t,r,s){d5(s),t=Yp(t,"onChange"),0<t.length&&(r=new _y("onChange","change",null,r,s),n.push({event:r,listeners:t}))}var du=null,Eu=null;function S3(n){q5(n,0)}function qm(n){var t=Ic(n);if(n5(t))return n}function _3(n,t){if(n==="change")return t}var I5=!1;if(qo){var Ff;if(qo){var Wf="oninput"in document;if(!Wf){var Tv=document.createElement("div");Tv.setAttribute("oninput","return;"),Wf=typeof Tv.oninput=="function"}Ff=Wf}else Ff=!1;I5=Ff&&(!document.documentMode||9<document.documentMode)}function Pv(){du&&(du.detachEvent("onpropertychange",D5),Eu=du=null)}function D5(n){if(n.propertyName==="value"&&qm(Eu)){var t=[];M5(t,Eu,n,yy(n)),m5(S3,t)}}function k3(n,t,r){n==="focusin"?(Pv(),du=t,Eu=r,du.attachEvent("onpropertychange",D5)):n==="focusout"&&Pv()}function C3(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return qm(Eu)}function N3(n,t){if(n==="click")return qm(t)}function T3(n,t){if(n==="input"||n==="change")return qm(t)}function P3(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var Ga=typeof Object.is=="function"?Object.is:P3;function Ru(n,t){if(Ga(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;var r=Object.keys(n),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var a=r[s];if(!o0.call(t,a)||!Ga(n[a],t[a]))return!1}return!0}function Ev(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Rv(n,t){var r=Ev(n);n=0;for(var s;r;){if(r.nodeType===3){if(s=n+r.textContent.length,n<=t&&s>=t)return{node:r,offset:t-n};n=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ev(r)}}function $5(n,t){return n&&t?n===t?!0:n&&n.nodeType===3?!1:t&&t.nodeType===3?$5(n,t.parentNode):"contains"in n?n.contains(t):n.compareDocumentPosition?!!(n.compareDocumentPosition(t)&16):!1:!1}function L5(){for(var n=window,t=Op();t instanceof n.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)n=t.contentWindow;else break;t=Op(n.document)}return t}function Ny(n){var t=n&&n.nodeName&&n.nodeName.toLowerCase();return t&&(t==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||t==="textarea"||n.contentEditable==="true")}function E3(n){var t=L5(),r=n.focusedElem,s=n.selectionRange;if(t!==r&&r&&r.ownerDocument&&$5(r.ownerDocument.documentElement,r)){if(s!==null&&Ny(r)){if(t=s.start,n=s.end,n===void 0&&(n=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(n,r.value.length);else if(n=(t=r.ownerDocument||document)&&t.defaultView||window,n.getSelection){n=n.getSelection();var a=r.textContent.length,o=Math.min(s.start,a);s=s.end===void 0?o:Math.min(s.end,a),!n.extend&&o>s&&(a=s,s=o,o=a),a=Rv(r,o);var i=Rv(r,s);a&&i&&(n.rangeCount!==1||n.anchorNode!==a.node||n.anchorOffset!==a.offset||n.focusNode!==i.node||n.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),n.removeAllRanges(),o>s?(n.addRange(t),n.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),n.addRange(t)))}}for(t=[],n=r;n=n.parentNode;)n.nodeType===1&&t.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)n=t[r],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var R3=qo&&"documentMode"in document&&11>=document.documentMode,Ac=null,k0=null,uu=null,C0=!1;function Av(n,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;C0||Ac==null||Ac!==Op(s)||(s=Ac,"selectionStart"in s&&Ny(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),uu&&Ru(uu,s)||(uu=s,s=Yp(k0,"onSelect"),0<s.length&&(t=new _y("onSelect","select",null,t,r),n.push({event:t,listeners:s}),t.target=Ac)))}function Lh(n,t){var r={};return r[n.toLowerCase()]=t.toLowerCase(),r["Webkit"+n]="webkit"+t,r["Moz"+n]="moz"+t,r}var Mc={animationend:Lh("Animation","AnimationEnd"),animationiteration:Lh("Animation","AnimationIteration"),animationstart:Lh("Animation","AnimationStart"),transitionend:Lh("Transition","TransitionEnd")},Uf={},B5={};qo&&(B5=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function Hm(n){if(Uf[n])return Uf[n];if(!Mc[n])return n;var t=Mc[n],r;for(r in t)if(t.hasOwnProperty(r)&&r in B5)return Uf[n]=t[r];return n}var O5=Hm("animationend"),z5=Hm("animationiteration"),F5=Hm("animationstart"),W5=Hm("transitionend"),U5=new Map,Mv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fi(n,t){U5.set(n,t),Gl(t,[n])}for(var qf=0;qf<Mv.length;qf++){var Hf=Mv[qf],A3=Hf.toLowerCase(),M3=Hf[0].toUpperCase()+Hf.slice(1);Fi(A3,"on"+M3)}Fi(O5,"onAnimationEnd");Fi(z5,"onAnimationIteration");Fi(F5,"onAnimationStart");Fi("dblclick","onDoubleClick");Fi("focusin","onFocus");Fi("focusout","onBlur");Fi(W5,"onTransitionEnd");rd("onMouseEnter",["mouseout","mouseover"]);rd("onMouseLeave",["mouseout","mouseover"]);rd("onPointerEnter",["pointerout","pointerover"]);rd("onPointerLeave",["pointerout","pointerover"]);Gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I3=new Set("cancel close invalid load scroll toggle".split(" ").concat(eu));function Iv(n,t,r){var s=n.type||"unknown-event";n.currentTarget=r,A4(s,t,void 0,n),n.currentTarget=null}function q5(n,t){t=(t&4)!==0;for(var r=0;r<n.length;r++){var s=n[r],a=s.event;s=s.listeners;e:{var o=void 0;if(t)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&a.isPropagationStopped())break e;Iv(a,l,d),o=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&a.isPropagationStopped())break e;Iv(a,l,d),o=c}}}if(Fp)throw n=w0,Fp=!1,w0=null,n}function Zr(n,t){var r=t[R0];r===void 0&&(r=t[R0]=new Set);var s=n+"__bubble";r.has(s)||(H5(t,n,2,!1),r.add(s))}function Yf(n,t,r){var s=0;t&&(s|=4),H5(r,n,s,t)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function Au(n){if(!n[Bh]){n[Bh]=!0,Q2.forEach(function(r){r!=="selectionchange"&&(I3.has(r)||Yf(r,!1,n),Yf(r,!0,n))});var t=n.nodeType===9?n:n.ownerDocument;t===null||t[Bh]||(t[Bh]=!0,Yf("selectionchange",!1,t))}}function H5(n,t,r,s){switch(T5(t)){case 1:var a=V4;break;case 4:a=K4;break;default:a=jy}r=a.bind(null,t,r,n),a=void 0,!v0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?n.addEventListener(t,r,{capture:!0,passive:a}):n.addEventListener(t,r,!0):a!==void 0?n.addEventListener(t,r,{passive:a}):n.addEventListener(t,r,!1)}function Gf(n,t,r,s,a){var o=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;i=i.return}for(;l!==null;){if(i=vl(l),i===null)return;if(c=i.tag,c===5||c===6){s=o=i;continue e}l=l.parentNode}}s=s.return}m5(function(){var d=o,u=yy(r),h=[];e:{var p=U5.get(n);if(p!==void 0){var g=_y,f=n;switch(n){case"keypress":if(yp(r)===0)break e;case"keydown":case"keyup":g=d3;break;case"focusin":f="focus",g=zf;break;case"focusout":f="blur",g=zf;break;case"beforeblur":case"afterblur":g=zf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=jv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Q4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=p3;break;case O5:case z5:case F5:g=t3;break;case W5:g=f3;break;case"scroll":g=J4;break;case"wheel":g=x3;break;case"copy":case"cut":case"paste":g=n3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=_v}var m=(t&4)!==0,v=!m&&n==="scroll",b=m?p!==null?p+"Capture":null:p;m=[];for(var w=d,x;w!==null;){x=w;var j=x.stateNode;if(x.tag===5&&j!==null&&(x=j,b!==null&&(j=Cu(w,b),j!=null&&m.push(Mu(w,j,x)))),v)break;w=w.return}0<m.length&&(p=new g(p,f,null,r,u),h.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&r!==y0&&(f=r.relatedTarget||r.fromElement)&&(vl(f)||f[Ho]))break e;if((g||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,g?(f=r.relatedTarget||r.toElement,g=d,f=f?vl(f):null,f!==null&&(v=Vl(f),f!==v||f.tag!==5&&f.tag!==6)&&(f=null)):(g=null,f=d),g!==f)){if(m=jv,j="onMouseLeave",b="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(m=_v,j="onPointerLeave",b="onPointerEnter",w="pointer"),v=g==null?p:Ic(g),x=f==null?p:Ic(f),p=new m(j,w+"leave",g,r,u),p.target=v,p.relatedTarget=x,j=null,vl(u)===d&&(m=new m(b,w+"enter",f,r,u),m.target=x,m.relatedTarget=v,j=m),v=j,g&&f)t:{for(m=g,b=f,w=0,x=m;x;x=sc(x))w++;for(x=0,j=b;j;j=sc(j))x++;for(;0<w-x;)m=sc(m),w--;for(;0<x-w;)b=sc(b),x--;for(;w--;){if(m===b||b!==null&&m===b.alternate)break t;m=sc(m),b=sc(b)}m=null}else m=null;g!==null&&Dv(h,p,g,m,!1),f!==null&&v!==null&&Dv(h,v,f,m,!0)}}e:{if(p=d?Ic(d):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var S=_3;else if(Nv(p))if(I5)S=T3;else{S=C3;var _=k3}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=N3);if(S&&(S=S(n,d))){M5(h,S,r,u);break e}_&&_(n,p,d),n==="focusout"&&(_=p._wrapperState)&&_.controlled&&p.type==="number"&&p0(p,"number",p.value)}switch(_=d?Ic(d):window,n){case"focusin":(Nv(_)||_.contentEditable==="true")&&(Ac=_,k0=d,uu=null);break;case"focusout":uu=k0=Ac=null;break;case"mousedown":C0=!0;break;case"contextmenu":case"mouseup":case"dragend":C0=!1,Av(h,r,u);break;case"selectionchange":if(R3)break;case"keydown":case"keyup":Av(h,r,u)}var C;if(Cy)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Rc?R5(n,r)&&(N="onCompositionEnd"):n==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(E5&&r.locale!=="ko"&&(Rc||N!=="onCompositionStart"?N==="onCompositionEnd"&&Rc&&(C=P5()):(vi=u,Sy="value"in vi?vi.value:vi.textContent,Rc=!0)),_=Yp(d,N),0<_.length&&(N=new Sv(N,n,null,r,u),h.push({event:N,listeners:_}),C?N.data=C:(C=A5(r),C!==null&&(N.data=C)))),(C=b3?v3(n,r):w3(n,r))&&(d=Yp(d,"onBeforeInput"),0<d.length&&(u=new Sv("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=C))}q5(h,t)})}function Mu(n,t,r){return{instance:n,listener:t,currentTarget:r}}function Yp(n,t){for(var r=t+"Capture",s=[];n!==null;){var a=n,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=Cu(n,r),o!=null&&s.unshift(Mu(n,o,a)),o=Cu(n,t),o!=null&&s.push(Mu(n,o,a))),n=n.return}return s}function sc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Dv(n,t,r,s,a){for(var o=t._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,a?(c=Cu(r,o),c!=null&&i.unshift(Mu(r,c,l))):a||(c=Cu(r,o),c!=null&&i.push(Mu(r,c,l)))),r=r.return}i.length!==0&&n.push({event:t,listeners:i})}var D3=/\r\n?/g,$3=/\u0000|\uFFFD/g;function $v(n){return(typeof n=="string"?n:""+n).replace(D3,`
`).replace($3,"")}function Oh(n,t,r){if(t=$v(t),$v(n)!==t&&r)throw Error(gt(425))}function Gp(){}var N0=null,T0=null;function P0(n,t){return n==="textarea"||n==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var E0=typeof setTimeout=="function"?setTimeout:void 0,L3=typeof clearTimeout=="function"?clearTimeout:void 0,Lv=typeof Promise=="function"?Promise:void 0,B3=typeof queueMicrotask=="function"?queueMicrotask:typeof Lv<"u"?function(n){return Lv.resolve(null).then(n).catch(O3)}:E0;function O3(n){setTimeout(function(){throw n})}function Vf(n,t){var r=t,s=0;do{var a=r.nextSibling;if(n.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(s===0){n.removeChild(a),Pu(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=a}while(r);Pu(t)}function Ti(n){for(;n!=null;n=n.nextSibling){var t=n.nodeType;if(t===1||t===3)break;if(t===8){if(t=n.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return n}function Bv(n){n=n.previousSibling;for(var t=0;n;){if(n.nodeType===8){var r=n.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return n;t--}else r==="/$"&&t++}n=n.previousSibling}return null}var wd=Math.random().toString(36).slice(2),co="__reactFiber$"+wd,Iu="__reactProps$"+wd,Ho="__reactContainer$"+wd,R0="__reactEvents$"+wd,z3="__reactListeners$"+wd,F3="__reactHandles$"+wd;function vl(n){var t=n[co];if(t)return t;for(var r=n.parentNode;r;){if(t=r[Ho]||r[co]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(n=Bv(n);n!==null;){if(r=n[co])return r;n=Bv(n)}return t}n=r,r=n.parentNode}return null}function gh(n){return n=n[co]||n[Ho],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ic(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(gt(33))}function Ym(n){return n[Iu]||null}var A0=[],Dc=-1;function Wi(n){return{current:n}}function en(n){0>Dc||(n.current=A0[Dc],A0[Dc]=null,Dc--)}function Kr(n,t){Dc++,A0[Dc]=n.current,n.current=t}var Li={},_s=Wi(Li),qs=Wi(!1),Dl=Li;function nd(n,t){var r=n.type.contextTypes;if(!r)return Li;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in r)a[o]=t[o];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=t,n.__reactInternalMemoizedMaskedChildContext=a),a}function Hs(n){return n=n.childContextTypes,n!=null}function Vp(){en(qs),en(_s)}function Ov(n,t,r){if(_s.current!==Li)throw Error(gt(168));Kr(_s,t),Kr(qs,r)}function Y5(n,t,r){var s=n.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(gt(108,k4(n)||"Unknown",a));return xn({},r,s)}function Kp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Li,Dl=_s.current,Kr(_s,n),Kr(qs,qs.current),!0}function zv(n,t,r){var s=n.stateNode;if(!s)throw Error(gt(169));r?(n=Y5(n,t,Dl),s.__reactInternalMemoizedMergedChildContext=n,en(qs),en(_s),Kr(_s,n)):en(qs),Kr(qs,r)}var $o=null,Gm=!1,Kf=!1;function G5(n){$o===null?$o=[n]:$o.push(n)}function W3(n){Gm=!0,G5(n)}function Ui(){if(!Kf&&$o!==null){Kf=!0;var n=0,t=Ir;try{var r=$o;for(Ir=1;n<r.length;n++){var s=r[n];do s=s(!0);while(s!==null)}$o=null,Gm=!1}catch(a){throw $o!==null&&($o=$o.slice(n+1)),y5(by,Ui),a}finally{Ir=t,Kf=!1}}return null}var $c=[],Lc=0,Jp=null,Xp=0,ya=[],ba=0,$l=null,Bo=1,Oo="";function ll(n,t){$c[Lc++]=Xp,$c[Lc++]=Jp,Jp=n,Xp=t}function V5(n,t,r){ya[ba++]=Bo,ya[ba++]=Oo,ya[ba++]=$l,$l=n;var s=Bo;n=Oo;var a=32-qa(s)-1;s&=~(1<<a),r+=1;var o=32-qa(t)+a;if(30<o){var i=a-a%5;o=(s&(1<<i)-1).toString(32),s>>=i,a-=i,Bo=1<<32-qa(t)+a|r<<a|s,Oo=o+n}else Bo=1<<o|r<<a|s,Oo=n}function Ty(n){n.return!==null&&(ll(n,1),V5(n,1,0))}function Py(n){for(;n===Jp;)Jp=$c[--Lc],$c[Lc]=null,Xp=$c[--Lc],$c[Lc]=null;for(;n===$l;)$l=ya[--ba],ya[ba]=null,Oo=ya[--ba],ya[ba]=null,Bo=ya[--ba],ya[ba]=null}var oa=null,aa=null,on=!1,Wa=null;function K5(n,t){var r=wa(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=n,t=n.deletions,t===null?(n.deletions=[r],n.flags|=16):t.push(r)}function Fv(n,t){switch(n.tag){case 5:var r=n.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(n.stateNode=t,oa=n,aa=Ti(t.firstChild),!0):!1;case 6:return t=n.pendingProps===""||t.nodeType!==3?null:t,t!==null?(n.stateNode=t,oa=n,aa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=$l!==null?{id:Bo,overflow:Oo}:null,n.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wa(18,null,null,0),r.stateNode=t,r.return=n,n.child=r,oa=n,aa=null,!0):!1;default:return!1}}function M0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function I0(n){if(on){var t=aa;if(t){var r=t;if(!Fv(n,t)){if(M0(n))throw Error(gt(418));t=Ti(r.nextSibling);var s=oa;t&&Fv(n,t)?K5(s,r):(n.flags=n.flags&-4097|2,on=!1,oa=n)}}else{if(M0(n))throw Error(gt(418));n.flags=n.flags&-4097|2,on=!1,oa=n}}}function Wv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;oa=n}function zh(n){if(n!==oa)return!1;if(!on)return Wv(n),on=!0,!1;var t;if((t=n.tag!==3)&&!(t=n.tag!==5)&&(t=n.type,t=t!=="head"&&t!=="body"&&!P0(n.type,n.memoizedProps)),t&&(t=aa)){if(M0(n))throw J5(),Error(gt(418));for(;t;)K5(n,t),t=Ti(t.nextSibling)}if(Wv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(gt(317));e:{for(n=n.nextSibling,t=0;n;){if(n.nodeType===8){var r=n.data;if(r==="/$"){if(t===0){aa=Ti(n.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}n=n.nextSibling}aa=null}}else aa=oa?Ti(n.stateNode.nextSibling):null;return!0}function J5(){for(var n=aa;n;)n=Ti(n.nextSibling)}function sd(){aa=oa=null,on=!1}function Ey(n){Wa===null?Wa=[n]:Wa.push(n)}var U3=Xo.ReactCurrentBatchConfig;function Md(n,t,r){if(n=r.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(gt(309));var s=r.stateNode}if(!s)throw Error(gt(147,n));var a=s,o=""+n;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=a.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof n!="string")throw Error(gt(284));if(!r._owner)throw Error(gt(290,n))}return n}function Fh(n,t){throw n=Object.prototype.toString.call(t),Error(gt(31,n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n))}function Uv(n){var t=n._init;return t(n._payload)}function X5(n){function t(b,w){if(n){var x=b.deletions;x===null?(b.deletions=[w],b.flags|=16):x.push(w)}}function r(b,w){if(!n)return null;for(;w!==null;)t(b,w),w=w.sibling;return null}function s(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function a(b,w){return b=Ai(b,w),b.index=0,b.sibling=null,b}function o(b,w,x){return b.index=x,n?(x=b.alternate,x!==null?(x=x.index,x<w?(b.flags|=2,w):x):(b.flags|=2,w)):(b.flags|=1048576,w)}function i(b){return n&&b.alternate===null&&(b.flags|=2),b}function l(b,w,x,j){return w===null||w.tag!==6?(w=rg(x,b.mode,j),w.return=b,w):(w=a(w,x),w.return=b,w)}function c(b,w,x,j){var S=x.type;return S===Ec?u(b,w,x.props.children,j,x.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ui&&Uv(S)===w.type)?(j=a(w,x.props),j.ref=Md(b,w,x),j.return=b,j):(j=kp(x.type,x.key,x.props,null,b.mode,j),j.ref=Md(b,w,x),j.return=b,j)}function d(b,w,x,j){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=ng(x,b.mode,j),w.return=b,w):(w=a(w,x.children||[]),w.return=b,w)}function u(b,w,x,j,S){return w===null||w.tag!==7?(w=Pl(x,b.mode,j,S),w.return=b,w):(w=a(w,x),w.return=b,w)}function h(b,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=rg(""+w,b.mode,x),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Eh:return x=kp(w.type,w.key,w.props,null,b.mode,x),x.ref=Md(b,null,w),x.return=b,x;case Pc:return w=ng(w,b.mode,x),w.return=b,w;case ui:var j=w._init;return h(b,j(w._payload),x)}if(Qd(w)||Td(w))return w=Pl(w,b.mode,x,null),w.return=b,w;Fh(b,w)}return null}function p(b,w,x,j){var S=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:l(b,w,""+x,j);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Eh:return x.key===S?c(b,w,x,j):null;case Pc:return x.key===S?d(b,w,x,j):null;case ui:return S=x._init,p(b,w,S(x._payload),j)}if(Qd(x)||Td(x))return S!==null?null:u(b,w,x,j,null);Fh(b,x)}return null}function g(b,w,x,j,S){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(x)||null,l(w,b,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Eh:return b=b.get(j.key===null?x:j.key)||null,c(w,b,j,S);case Pc:return b=b.get(j.key===null?x:j.key)||null,d(w,b,j,S);case ui:var _=j._init;return g(b,w,x,_(j._payload),S)}if(Qd(j)||Td(j))return b=b.get(x)||null,u(w,b,j,S,null);Fh(w,j)}return null}function f(b,w,x,j){for(var S=null,_=null,C=w,N=w=0,M=null;C!==null&&N<x.length;N++){C.index>N?(M=C,C=null):M=C.sibling;var E=p(b,C,x[N],j);if(E===null){C===null&&(C=M);break}n&&C&&E.alternate===null&&t(b,C),w=o(E,w,N),_===null?S=E:_.sibling=E,_=E,C=M}if(N===x.length)return r(b,C),on&&ll(b,N),S;if(C===null){for(;N<x.length;N++)C=h(b,x[N],j),C!==null&&(w=o(C,w,N),_===null?S=C:_.sibling=C,_=C);return on&&ll(b,N),S}for(C=s(b,C);N<x.length;N++)M=g(C,b,N,x[N],j),M!==null&&(n&&M.alternate!==null&&C.delete(M.key===null?N:M.key),w=o(M,w,N),_===null?S=M:_.sibling=M,_=M);return n&&C.forEach(function(P){return t(b,P)}),on&&ll(b,N),S}function m(b,w,x,j){var S=Td(x);if(typeof S!="function")throw Error(gt(150));if(x=S.call(x),x==null)throw Error(gt(151));for(var _=S=null,C=w,N=w=0,M=null,E=x.next();C!==null&&!E.done;N++,E=x.next()){C.index>N?(M=C,C=null):M=C.sibling;var P=p(b,C,E.value,j);if(P===null){C===null&&(C=M);break}n&&C&&P.alternate===null&&t(b,C),w=o(P,w,N),_===null?S=P:_.sibling=P,_=P,C=M}if(E.done)return r(b,C),on&&ll(b,N),S;if(C===null){for(;!E.done;N++,E=x.next())E=h(b,E.value,j),E!==null&&(w=o(E,w,N),_===null?S=E:_.sibling=E,_=E);return on&&ll(b,N),S}for(C=s(b,C);!E.done;N++,E=x.next())E=g(C,b,N,E.value,j),E!==null&&(n&&E.alternate!==null&&C.delete(E.key===null?N:E.key),w=o(E,w,N),_===null?S=E:_.sibling=E,_=E);return n&&C.forEach(function(D){return t(b,D)}),on&&ll(b,N),S}function v(b,w,x,j){if(typeof x=="object"&&x!==null&&x.type===Ec&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Eh:e:{for(var S=x.key,_=w;_!==null;){if(_.key===S){if(S=x.type,S===Ec){if(_.tag===7){r(b,_.sibling),w=a(_,x.props.children),w.return=b,b=w;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ui&&Uv(S)===_.type){r(b,_.sibling),w=a(_,x.props),w.ref=Md(b,_,x),w.return=b,b=w;break e}r(b,_);break}else t(b,_);_=_.sibling}x.type===Ec?(w=Pl(x.props.children,b.mode,j,x.key),w.return=b,b=w):(j=kp(x.type,x.key,x.props,null,b.mode,j),j.ref=Md(b,w,x),j.return=b,b=j)}return i(b);case Pc:e:{for(_=x.key;w!==null;){if(w.key===_)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(b,w.sibling),w=a(w,x.children||[]),w.return=b,b=w;break e}else{r(b,w);break}else t(b,w);w=w.sibling}w=ng(x,b.mode,j),w.return=b,b=w}return i(b);case ui:return _=x._init,v(b,w,_(x._payload),j)}if(Qd(x))return f(b,w,x,j);if(Td(x))return m(b,w,x,j);Fh(b,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(b,w.sibling),w=a(w,x),w.return=b,b=w):(r(b,w),w=rg(x,b.mode,j),w.return=b,b=w),i(b)):r(b,w)}return v}var ad=X5(!0),Q5=X5(!1),Qp=Wi(null),Zp=null,Bc=null,Ry=null;function Ay(){Ry=Bc=Zp=null}function My(n){var t=Qp.current;en(Qp),n._currentValue=t}function D0(n,t,r){for(;n!==null;){var s=n.alternate;if((n.childLanes&t)!==t?(n.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),n===r)break;n=n.return}}function Vc(n,t){Zp=n,Ry=Bc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&t&&(Us=!0),n.firstContext=null)}function ka(n){var t=n._currentValue;if(Ry!==n)if(n={context:n,memoizedValue:t,next:null},Bc===null){if(Zp===null)throw Error(gt(308));Bc=n,Zp.dependencies={lanes:0,firstContext:n}}else Bc=Bc.next=n;return t}var wl=null;function Iy(n){wl===null?wl=[n]:wl.push(n)}function Z5(n,t,r,s){var a=t.interleaved;return a===null?(r.next=r,Iy(t)):(r.next=a.next,a.next=r),t.interleaved=r,Yo(n,s)}function Yo(n,t){n.lanes|=t;var r=n.alternate;for(r!==null&&(r.lanes|=t),r=n,n=n.return;n!==null;)n.childLanes|=t,r=n.alternate,r!==null&&(r.childLanes|=t),r=n,n=n.return;return r.tag===3?r.stateNode:null}var hi=!1;function Dy(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eS(n,t){n=n.updateQueue,t.updateQueue===n&&(t.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Wo(n,t){return{eventTime:n,lane:t,tag:0,payload:null,callback:null,next:null}}function Pi(n,t,r){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,Cr&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,Yo(n,r)}return a=s.interleaved,a===null?(t.next=t,Iy(s)):(t.next=a.next,a.next=t),s.interleaved=t,Yo(n,r)}function bp(n,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=n.pendingLanes,r|=s,t.lanes=r,vy(n,r)}}function qv(n,t){var r=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var a=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?a=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?a=o=t:o=o.next=t}else a=o=t;r={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:s.shared,effects:s.effects},n.updateQueue=r;return}n=r.lastBaseUpdate,n===null?r.firstBaseUpdate=t:n.next=t,r.lastBaseUpdate=t}function em(n,t,r,s){var a=n.updateQueue;hi=!1;var o=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=n.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var h=a.baseState;i=0,u=d=c=null,l=o;do{var p=l.lane,g=l.eventTime;if((s&p)===p){u!==null&&(u=u.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=n,m=l;switch(p=t,g=r,m.tag){case 1:if(f=m.payload,typeof f=="function"){h=f.call(g,h,p);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,p=typeof f=="function"?f.call(g,h,p):f,p==null)break e;h=xn({},h,p);break e;case 2:hi=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,p=a.effects,p===null?a.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=g,c=h):u=u.next=g,i|=p;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;p=l,l=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(1);if(u===null&&(c=h),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else o===null&&(a.shared.lanes=0);Bl|=i,n.lanes=i,n.memoizedState=h}}function Hv(n,t,r){if(n=t.effects,t.effects=null,n!==null)for(t=0;t<n.length;t++){var s=n[t],a=s.callback;if(a!==null){if(s.callback=null,s=r,typeof a!="function")throw Error(gt(191,a));a.call(s)}}}var xh={},fo=Wi(xh),Du=Wi(xh),$u=Wi(xh);function jl(n){if(n===xh)throw Error(gt(174));return n}function $y(n,t){switch(Kr($u,t),Kr(Du,n),Kr(fo,xh),n=t.nodeType,n){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:f0(null,"");break;default:n=n===8?t.parentNode:t,t=n.namespaceURI||null,n=n.tagName,t=f0(t,n)}en(fo),Kr(fo,t)}function od(){en(fo),en(Du),en($u)}function tS(n){jl($u.current);var t=jl(fo.current),r=f0(t,n.type);t!==r&&(Kr(Du,n),Kr(fo,r))}function Ly(n){Du.current===n&&(en(fo),en(Du))}var mn=Wi(0);function tm(n){for(var t=n;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break;for(;t.sibling===null;){if(t.return===null||t.return===n)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jf=[];function By(){for(var n=0;n<Jf.length;n++)Jf[n]._workInProgressVersionPrimary=null;Jf.length=0}var vp=Xo.ReactCurrentDispatcher,Xf=Xo.ReactCurrentBatchConfig,Ll=0,gn=null,Vn=null,Jn=null,rm=!1,hu=!1,Lu=0,q3=0;function gs(){throw Error(gt(321))}function Oy(n,t){if(t===null)return!1;for(var r=0;r<t.length&&r<n.length;r++)if(!Ga(n[r],t[r]))return!1;return!0}function zy(n,t,r,s,a,o){if(Ll=o,gn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,vp.current=n===null||n.memoizedState===null?V3:K3,n=r(s,a),hu){o=0;do{if(hu=!1,Lu=0,25<=o)throw Error(gt(301));o+=1,Jn=Vn=null,t.updateQueue=null,vp.current=J3,n=r(s,a)}while(hu)}if(vp.current=nm,t=Vn!==null&&Vn.next!==null,Ll=0,Jn=Vn=gn=null,rm=!1,t)throw Error(gt(300));return n}function Fy(){var n=Lu!==0;return Lu=0,n}function io(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?gn.memoizedState=Jn=n:Jn=Jn.next=n,Jn}function Ca(){if(Vn===null){var n=gn.alternate;n=n!==null?n.memoizedState:null}else n=Vn.next;var t=Jn===null?gn.memoizedState:Jn.next;if(t!==null)Jn=t,Vn=n;else{if(n===null)throw Error(gt(310));Vn=n,n={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Jn===null?gn.memoizedState=Jn=n:Jn=Jn.next=n}return Jn}function Bu(n,t){return typeof t=="function"?t(n):t}function Qf(n){var t=Ca(),r=t.queue;if(r===null)throw Error(gt(311));r.lastRenderedReducer=n;var s=Vn,a=s.baseQueue,o=r.pending;if(o!==null){if(a!==null){var i=a.next;a.next=o.next,o.next=i}s.baseQueue=a=o,r.pending=null}if(a!==null){o=a.next,s=s.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((Ll&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:n(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,i=s):c=c.next=h,gn.lanes|=u,Bl|=u}d=d.next}while(d!==null&&d!==o);c===null?i=s:c.next=l,Ga(s,t.memoizedState)||(Us=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(n=r.interleaved,n!==null){a=n;do o=a.lane,gn.lanes|=o,Bl|=o,a=a.next;while(a!==n)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Zf(n){var t=Ca(),r=t.queue;if(r===null)throw Error(gt(311));r.lastRenderedReducer=n;var s=r.dispatch,a=r.pending,o=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do o=n(o,i.action),i=i.next;while(i!==a);Ga(o,t.memoizedState)||(Us=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,s]}function rS(){}function nS(n,t){var r=gn,s=Ca(),a=t(),o=!Ga(s.memoizedState,a);if(o&&(s.memoizedState=a,Us=!0),s=s.queue,Wy(oS.bind(null,r,s,n),[n]),s.getSnapshot!==t||o||Jn!==null&&Jn.memoizedState.tag&1){if(r.flags|=2048,Ou(9,aS.bind(null,r,s,a,t),void 0,null),Xn===null)throw Error(gt(349));Ll&30||sS(r,t,a)}return a}function sS(n,t,r){n.flags|=16384,n={getSnapshot:t,value:r},t=gn.updateQueue,t===null?(t={lastEffect:null,stores:null},gn.updateQueue=t,t.stores=[n]):(r=t.stores,r===null?t.stores=[n]:r.push(n))}function aS(n,t,r,s){t.value=r,t.getSnapshot=s,iS(t)&&lS(n)}function oS(n,t,r){return r(function(){iS(t)&&lS(n)})}function iS(n){var t=n.getSnapshot;n=n.value;try{var r=t();return!Ga(n,r)}catch{return!0}}function lS(n){var t=Yo(n,1);t!==null&&Ha(t,n,1,-1)}function Yv(n){var t=io();return typeof n=="function"&&(n=n()),t.memoizedState=t.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bu,lastRenderedState:n},t.queue=n,n=n.dispatch=G3.bind(null,gn,n),[t.memoizedState,n]}function Ou(n,t,r,s){return n={tag:n,create:t,destroy:r,deps:s,next:null},t=gn.updateQueue,t===null?(t={lastEffect:null,stores:null},gn.updateQueue=t,t.lastEffect=n.next=n):(r=t.lastEffect,r===null?t.lastEffect=n.next=n:(s=r.next,r.next=n,n.next=s,t.lastEffect=n)),n}function cS(){return Ca().memoizedState}function wp(n,t,r,s){var a=io();gn.flags|=n,a.memoizedState=Ou(1|t,r,void 0,s===void 0?null:s)}function Vm(n,t,r,s){var a=Ca();s=s===void 0?null:s;var o=void 0;if(Vn!==null){var i=Vn.memoizedState;if(o=i.destroy,s!==null&&Oy(s,i.deps)){a.memoizedState=Ou(t,r,o,s);return}}gn.flags|=n,a.memoizedState=Ou(1|t,r,o,s)}function Gv(n,t){return wp(8390656,8,n,t)}function Wy(n,t){return Vm(2048,8,n,t)}function dS(n,t){return Vm(4,2,n,t)}function uS(n,t){return Vm(4,4,n,t)}function hS(n,t){if(typeof t=="function")return n=n(),t(n),function(){t(null)};if(t!=null)return n=n(),t.current=n,function(){t.current=null}}function pS(n,t,r){return r=r!=null?r.concat([n]):null,Vm(4,4,hS.bind(null,t,n),r)}function Uy(){}function mS(n,t){var r=Ca();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Oy(t,s[1])?s[0]:(r.memoizedState=[n,t],n)}function fS(n,t){var r=Ca();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&Oy(t,s[1])?s[0]:(n=n(),r.memoizedState=[n,t],n)}function gS(n,t,r){return Ll&21?(Ga(r,t)||(r=w5(),gn.lanes|=r,Bl|=r,n.baseState=!0),t):(n.baseState&&(n.baseState=!1,Us=!0),n.memoizedState=r)}function H3(n,t){var r=Ir;Ir=r!==0&&4>r?r:4,n(!0);var s=Xf.transition;Xf.transition={};try{n(!1),t()}finally{Ir=r,Xf.transition=s}}function xS(){return Ca().memoizedState}function Y3(n,t,r){var s=Ri(n);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},yS(n))bS(t,r);else if(r=Z5(n,t,r,s),r!==null){var a=Ds();Ha(r,n,s,a),vS(r,t,s)}}function G3(n,t,r){var s=Ri(n),a={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(yS(n))bS(t,a);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,r);if(a.hasEagerState=!0,a.eagerState=l,Ga(l,i)){var c=t.interleaved;c===null?(a.next=a,Iy(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Z5(n,t,a,s),r!==null&&(a=Ds(),Ha(r,n,s,a),vS(r,t,s))}}function yS(n){var t=n.alternate;return n===gn||t!==null&&t===gn}function bS(n,t){hu=rm=!0;var r=n.pending;r===null?t.next=t:(t.next=r.next,r.next=t),n.pending=t}function vS(n,t,r){if(r&4194240){var s=t.lanes;s&=n.pendingLanes,r|=s,t.lanes=r,vy(n,r)}}var nm={readContext:ka,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useInsertionEffect:gs,useLayoutEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useMutableSource:gs,useSyncExternalStore:gs,useId:gs,unstable_isNewReconciler:!1},V3={readContext:ka,useCallback:function(n,t){return io().memoizedState=[n,t===void 0?null:t],n},useContext:ka,useEffect:Gv,useImperativeHandle:function(n,t,r){return r=r!=null?r.concat([n]):null,wp(4194308,4,hS.bind(null,t,n),r)},useLayoutEffect:function(n,t){return wp(4194308,4,n,t)},useInsertionEffect:function(n,t){return wp(4,2,n,t)},useMemo:function(n,t){var r=io();return t=t===void 0?null:t,n=n(),r.memoizedState=[n,t],n},useReducer:function(n,t,r){var s=io();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:t},s.queue=n,n=n.dispatch=Y3.bind(null,gn,n),[s.memoizedState,n]},useRef:function(n){var t=io();return n={current:n},t.memoizedState=n},useState:Yv,useDebugValue:Uy,useDeferredValue:function(n){return io().memoizedState=n},useTransition:function(){var n=Yv(!1),t=n[0];return n=H3.bind(null,n[1]),io().memoizedState=n,[t,n]},useMutableSource:function(){},useSyncExternalStore:function(n,t,r){var s=gn,a=io();if(on){if(r===void 0)throw Error(gt(407));r=r()}else{if(r=t(),Xn===null)throw Error(gt(349));Ll&30||sS(s,t,r)}a.memoizedState=r;var o={value:r,getSnapshot:t};return a.queue=o,Gv(oS.bind(null,s,o,n),[n]),s.flags|=2048,Ou(9,aS.bind(null,s,o,r,t),void 0,null),r},useId:function(){var n=io(),t=Xn.identifierPrefix;if(on){var r=Oo,s=Bo;r=(s&~(1<<32-qa(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Lu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=q3++,t=":"+t+"r"+r.toString(32)+":";return n.memoizedState=t},unstable_isNewReconciler:!1},K3={readContext:ka,useCallback:mS,useContext:ka,useEffect:Wy,useImperativeHandle:pS,useInsertionEffect:dS,useLayoutEffect:uS,useMemo:fS,useReducer:Qf,useRef:cS,useState:function(){return Qf(Bu)},useDebugValue:Uy,useDeferredValue:function(n){var t=Ca();return gS(t,Vn.memoizedState,n)},useTransition:function(){var n=Qf(Bu)[0],t=Ca().memoizedState;return[n,t]},useMutableSource:rS,useSyncExternalStore:nS,useId:xS,unstable_isNewReconciler:!1},J3={readContext:ka,useCallback:mS,useContext:ka,useEffect:Wy,useImperativeHandle:pS,useInsertionEffect:dS,useLayoutEffect:uS,useMemo:fS,useReducer:Zf,useRef:cS,useState:function(){return Zf(Bu)},useDebugValue:Uy,useDeferredValue:function(n){var t=Ca();return Vn===null?t.memoizedState=n:gS(t,Vn.memoizedState,n)},useTransition:function(){var n=Zf(Bu)[0],t=Ca().memoizedState;return[n,t]},useMutableSource:rS,useSyncExternalStore:nS,useId:xS,unstable_isNewReconciler:!1};function La(n,t){if(n&&n.defaultProps){t=xn({},t),n=n.defaultProps;for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}return t}function $0(n,t,r,s){t=n.memoizedState,r=r(s,t),r=r==null?t:xn({},t,r),n.memoizedState=r,n.lanes===0&&(n.updateQueue.baseState=r)}var Km={isMounted:function(n){return(n=n._reactInternals)?Vl(n)===n:!1},enqueueSetState:function(n,t,r){n=n._reactInternals;var s=Ds(),a=Ri(n),o=Wo(s,a);o.payload=t,r!=null&&(o.callback=r),t=Pi(n,o,a),t!==null&&(Ha(t,n,a,s),bp(t,n,a))},enqueueReplaceState:function(n,t,r){n=n._reactInternals;var s=Ds(),a=Ri(n),o=Wo(s,a);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=Pi(n,o,a),t!==null&&(Ha(t,n,a,s),bp(t,n,a))},enqueueForceUpdate:function(n,t){n=n._reactInternals;var r=Ds(),s=Ri(n),a=Wo(r,s);a.tag=2,t!=null&&(a.callback=t),t=Pi(n,a,s),t!==null&&(Ha(t,n,s,r),bp(t,n,s))}};function Vv(n,t,r,s,a,o,i){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,o,i):t.prototype&&t.prototype.isPureReactComponent?!Ru(r,s)||!Ru(a,o):!0}function wS(n,t,r){var s=!1,a=Li,o=t.contextType;return typeof o=="object"&&o!==null?o=ka(o):(a=Hs(t)?Dl:_s.current,s=t.contextTypes,o=(s=s!=null)?nd(n,a):Li),t=new t(r,o),n.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Km,n.stateNode=t,t._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=o),t}function Kv(n,t,r,s){n=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==n&&Km.enqueueReplaceState(t,t.state,null)}function L0(n,t,r,s){var a=n.stateNode;a.props=r,a.state=n.memoizedState,a.refs={},Dy(n);var o=t.contextType;typeof o=="object"&&o!==null?a.context=ka(o):(o=Hs(t)?Dl:_s.current,a.context=nd(n,o)),a.state=n.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&($0(n,t,o,r),a.state=n.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Km.enqueueReplaceState(a,a.state,null),em(n,r,a,s),a.state=n.memoizedState),typeof a.componentDidMount=="function"&&(n.flags|=4194308)}function id(n,t){try{var r="",s=t;do r+=_4(s),s=s.return;while(s);var a=r}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:t,stack:a,digest:null}}function eg(n,t,r){return{value:n,source:null,stack:r??null,digest:t??null}}function B0(n,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var X3=typeof WeakMap=="function"?WeakMap:Map;function jS(n,t,r){r=Wo(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){am||(am=!0,V0=s),B0(n,t)},r}function SS(n,t,r){r=Wo(-1,r),r.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;r.payload=function(){return s(a)},r.callback=function(){B0(n,t)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){B0(n,t),typeof s!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Jv(n,t,r){var s=n.pingCache;if(s===null){s=n.pingCache=new X3;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(r)||(a.add(r),n=uT.bind(null,n,t,r),t.then(n,n))}function Xv(n){do{var t;if((t=n.tag===13)&&(t=n.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return n;n=n.return}while(n!==null);return null}function Qv(n,t,r,s,a){return n.mode&1?(n.flags|=65536,n.lanes=a,n):(n===t?n.flags|=65536:(n.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Wo(-1,1),t.tag=2,Pi(r,t,1))),r.lanes|=1),n)}var Q3=Xo.ReactCurrentOwner,Us=!1;function Es(n,t,r,s){t.child=n===null?Q5(t,null,r,s):ad(t,n.child,r,s)}function Zv(n,t,r,s,a){r=r.render;var o=t.ref;return Vc(t,a),s=zy(n,t,r,s,o,a),r=Fy(),n!==null&&!Us?(t.updateQueue=n.updateQueue,t.flags&=-2053,n.lanes&=~a,Go(n,t,a)):(on&&r&&Ty(t),t.flags|=1,Es(n,t,s,a),t.child)}function e1(n,t,r,s,a){if(n===null){var o=r.type;return typeof o=="function"&&!Xy(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,_S(n,t,o,s,a)):(n=kp(r.type,null,s,t,t.mode,a),n.ref=t.ref,n.return=t,t.child=n)}if(o=n.child,!(n.lanes&a)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ru,r(i,s)&&n.ref===t.ref)return Go(n,t,a)}return t.flags|=1,n=Ai(o,s),n.ref=t.ref,n.return=t,t.child=n}function _S(n,t,r,s,a){if(n!==null){var o=n.memoizedProps;if(Ru(o,s)&&n.ref===t.ref)if(Us=!1,t.pendingProps=s=o,(n.lanes&a)!==0)n.flags&131072&&(Us=!0);else return t.lanes=n.lanes,Go(n,t,a)}return O0(n,t,r,s,a)}function kS(n,t,r){var s=t.pendingProps,a=s.children,o=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kr(zc,ta),ta|=r;else{if(!(r&1073741824))return n=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:n,cachePool:null,transitions:null},t.updateQueue=null,Kr(zc,ta),ta|=n,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:r,Kr(zc,ta),ta|=s}else o!==null?(s=o.baseLanes|r,t.memoizedState=null):s=r,Kr(zc,ta),ta|=s;return Es(n,t,a,r),t.child}function CS(n,t){var r=t.ref;(n===null&&r!==null||n!==null&&n.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function O0(n,t,r,s,a){var o=Hs(r)?Dl:_s.current;return o=nd(t,o),Vc(t,a),r=zy(n,t,r,s,o,a),s=Fy(),n!==null&&!Us?(t.updateQueue=n.updateQueue,t.flags&=-2053,n.lanes&=~a,Go(n,t,a)):(on&&s&&Ty(t),t.flags|=1,Es(n,t,r,a),t.child)}function t1(n,t,r,s,a){if(Hs(r)){var o=!0;Kp(t)}else o=!1;if(Vc(t,a),t.stateNode===null)jp(n,t),wS(t,r,s),L0(t,r,s,a),s=!0;else if(n===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=ka(d):(d=Hs(r)?Dl:_s.current,d=nd(t,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==d)&&Kv(t,i,s,d),hi=!1;var p=t.memoizedState;i.state=p,em(t,s,i,a),c=t.memoizedState,l!==s||p!==c||qs.current||hi?(typeof u=="function"&&($0(t,r,u,s),c=t.memoizedState),(l=hi||Vv(t,r,l,s,p,c,d))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=d,s=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,eS(n,t),l=t.memoizedProps,d=t.type===t.elementType?l:La(t.type,l),i.props=d,h=t.pendingProps,p=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=ka(c):(c=Hs(r)?Dl:_s.current,c=nd(t,c));var g=r.getDerivedStateFromProps;(u=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||p!==c)&&Kv(t,i,s,c),hi=!1,p=t.memoizedState,i.state=p,em(t,s,i,a);var f=t.memoizedState;l!==h||p!==f||qs.current||hi?(typeof g=="function"&&($0(t,r,g,s),f=t.memoizedState),(d=hi||Vv(t,r,d,s,p,f,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,f,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,f,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=f),i.props=s,i.state=f,i.context=c,s=d):(typeof i.componentDidUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(t.flags|=1024),s=!1)}return z0(n,t,r,s,o,a)}function z0(n,t,r,s,a,o){CS(n,t);var i=(t.flags&128)!==0;if(!s&&!i)return a&&zv(t,r,!1),Go(n,t,o);s=t.stateNode,Q3.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,n!==null&&i?(t.child=ad(t,n.child,null,o),t.child=ad(t,null,l,o)):Es(n,t,l,o),t.memoizedState=s.state,a&&zv(t,r,!0),t.child}function NS(n){var t=n.stateNode;t.pendingContext?Ov(n,t.pendingContext,t.pendingContext!==t.context):t.context&&Ov(n,t.context,!1),$y(n,t.containerInfo)}function r1(n,t,r,s,a){return sd(),Ey(a),t.flags|=256,Es(n,t,r,s),t.child}var F0={dehydrated:null,treeContext:null,retryLane:0};function W0(n){return{baseLanes:n,cachePool:null,transitions:null}}function TS(n,t,r){var s=t.pendingProps,a=mn.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=n!==null&&n.memoizedState===null?!1:(a&2)!==0),l?(o=!0,t.flags&=-129):(n===null||n.memoizedState!==null)&&(a|=1),Kr(mn,a&1),n===null)return I0(t),n=t.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(t.mode&1?n.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,n=s.fallback,o?(s=t.mode,o=t.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Qm(i,s,0,null),n=Pl(n,s,r,null),o.return=t,n.return=t,o.sibling=n,t.child=o,t.child.memoizedState=W0(r),t.memoizedState=F0,n):qy(t,i));if(a=n.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Z3(n,t,i,s,l,a,r);if(o){o=s.fallback,i=t.mode,a=n.child,l=a.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Ai(a,c),s.subtreeFlags=a.subtreeFlags&14680064),l!==null?o=Ai(l,o):(o=Pl(o,i,r,null),o.flags|=2),o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,i=n.child.memoizedState,i=i===null?W0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=n.childLanes&~r,t.memoizedState=F0,s}return o=n.child,n=o.sibling,s=Ai(o,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,n!==null&&(r=t.deletions,r===null?(t.deletions=[n],t.flags|=16):r.push(n)),t.child=s,t.memoizedState=null,s}function qy(n,t){return t=Qm({mode:"visible",children:t},n.mode,0,null),t.return=n,n.child=t}function Wh(n,t,r,s){return s!==null&&Ey(s),ad(t,n.child,null,r),n=qy(t,t.pendingProps.children),n.flags|=2,t.memoizedState=null,n}function Z3(n,t,r,s,a,o,i){if(r)return t.flags&256?(t.flags&=-257,s=eg(Error(gt(422))),Wh(n,t,i,s)):t.memoizedState!==null?(t.child=n.child,t.flags|=128,null):(o=s.fallback,a=t.mode,s=Qm({mode:"visible",children:s.children},a,0,null),o=Pl(o,a,i,null),o.flags|=2,s.return=t,o.return=t,s.sibling=o,t.child=s,t.mode&1&&ad(t,n.child,null,i),t.child.memoizedState=W0(i),t.memoizedState=F0,o);if(!(t.mode&1))return Wh(n,t,i,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var l=s.dgst;return s=l,o=Error(gt(419)),s=eg(o,s,void 0),Wh(n,t,i,s)}if(l=(i&n.childLanes)!==0,Us||l){if(s=Xn,s!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|i)?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,Yo(n,a),Ha(s,n,a,-1))}return Jy(),s=eg(Error(gt(421))),Wh(n,t,i,s)}return a.data==="$?"?(t.flags|=128,t.child=n.child,t=hT.bind(null,n),a._reactRetry=t,null):(n=o.treeContext,aa=Ti(a.nextSibling),oa=t,on=!0,Wa=null,n!==null&&(ya[ba++]=Bo,ya[ba++]=Oo,ya[ba++]=$l,Bo=n.id,Oo=n.overflow,$l=t),t=qy(t,s.children),t.flags|=4096,t)}function n1(n,t,r){n.lanes|=t;var s=n.alternate;s!==null&&(s.lanes|=t),D0(n.return,t,r)}function tg(n,t,r,s,a){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=r,o.tailMode=a)}function PS(n,t,r){var s=t.pendingProps,a=s.revealOrder,o=s.tail;if(Es(n,t,s.children,r),s=mn.current,s&2)s=s&1|2,t.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=t.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&n1(n,r,t);else if(n.tag===19)n1(n,r,t);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Kr(mn,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)n=r.alternate,n!==null&&tm(n)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),tg(t,!1,a,r,o);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(n=a.alternate,n!==null&&tm(n)===null){t.child=a;break}n=a.sibling,a.sibling=r,r=a,a=n}tg(t,!0,r,null,o);break;case"together":tg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jp(n,t){!(t.mode&1)&&n!==null&&(n.alternate=null,t.alternate=null,t.flags|=2)}function Go(n,t,r){if(n!==null&&(t.dependencies=n.dependencies),Bl|=t.lanes,!(r&t.childLanes))return null;if(n!==null&&t.child!==n.child)throw Error(gt(153));if(t.child!==null){for(n=t.child,r=Ai(n,n.pendingProps),t.child=r,r.return=t;n.sibling!==null;)n=n.sibling,r=r.sibling=Ai(n,n.pendingProps),r.return=t;r.sibling=null}return t.child}function eT(n,t,r){switch(t.tag){case 3:NS(t),sd();break;case 5:tS(t);break;case 1:Hs(t.type)&&Kp(t);break;case 4:$y(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;Kr(Qp,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Kr(mn,mn.current&1),t.flags|=128,null):r&t.child.childLanes?TS(n,t,r):(Kr(mn,mn.current&1),n=Go(n,t,r),n!==null?n.sibling:null);Kr(mn,mn.current&1);break;case 19:if(s=(r&t.childLanes)!==0,n.flags&128){if(s)return PS(n,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Kr(mn,mn.current),s)break;return null;case 22:case 23:return t.lanes=0,kS(n,t,r)}return Go(n,t,r)}var ES,U0,RS,AS;ES=function(n,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)n.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};U0=function(){};RS=function(n,t,r,s){var a=n.memoizedProps;if(a!==s){n=t.stateNode,jl(fo.current);var o=null;switch(r){case"input":a=u0(n,a),s=u0(n,s),o=[];break;case"select":a=xn({},a,{value:void 0}),s=xn({},s,{value:void 0}),o=[];break;case"textarea":a=m0(n,a),s=m0(n,s),o=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Gp)}g0(r,s);var i;r=null;for(d in a)if(!s.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(_u.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in s){var c=s[d];if(l=a!=null?a[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(_u.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Zr("scroll",n),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};AS=function(n,t,r,s){r!==s&&(t.flags|=4)};function Id(n,t){if(!on)switch(n.tailMode){case"hidden":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?n.tail=null:r.sibling=null;break;case"collapsed":r=n.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function xs(n){var t=n.alternate!==null&&n.alternate.child===n.child,r=0,s=0;if(t)for(var a=n.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=n,a=a.sibling;else for(a=n.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=n,a=a.sibling;return n.subtreeFlags|=s,n.childLanes=r,t}function tT(n,t,r){var s=t.pendingProps;switch(Py(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xs(t),null;case 1:return Hs(t.type)&&Vp(),xs(t),null;case 3:return s=t.stateNode,od(),en(qs),en(_s),By(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(zh(t)?t.flags|=4:n===null||n.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wa!==null&&(X0(Wa),Wa=null))),U0(n,t),xs(t),null;case 5:Ly(t);var a=jl($u.current);if(r=t.type,n!==null&&t.stateNode!=null)RS(n,t,r,s,a),n.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(gt(166));return xs(t),null}if(n=jl(fo.current),zh(t)){s=t.stateNode,r=t.type;var o=t.memoizedProps;switch(s[co]=t,s[Iu]=o,n=(t.mode&1)!==0,r){case"dialog":Zr("cancel",s),Zr("close",s);break;case"iframe":case"object":case"embed":Zr("load",s);break;case"video":case"audio":for(a=0;a<eu.length;a++)Zr(eu[a],s);break;case"source":Zr("error",s);break;case"img":case"image":case"link":Zr("error",s),Zr("load",s);break;case"details":Zr("toggle",s);break;case"input":hv(s,o),Zr("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Zr("invalid",s);break;case"textarea":mv(s,o),Zr("invalid",s)}g0(r,o),a=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?s.textContent!==l&&(o.suppressHydrationWarning!==!0&&Oh(s.textContent,l,n),a=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Oh(s.textContent,l,n),a=["children",""+l]):_u.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Zr("scroll",s)}switch(r){case"input":Rh(s),pv(s,o,!0);break;case"textarea":Rh(s),fv(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=Gp)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=o5(r)),n==="http://www.w3.org/1999/xhtml"?r==="script"?(n=i.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=i.createElement(r,{is:s.is}):(n=i.createElement(r),r==="select"&&(i=n,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):n=i.createElementNS(n,r),n[co]=t,n[Iu]=s,ES(n,t,!1,!1),t.stateNode=n;e:{switch(i=x0(r,s),r){case"dialog":Zr("cancel",n),Zr("close",n),a=s;break;case"iframe":case"object":case"embed":Zr("load",n),a=s;break;case"video":case"audio":for(a=0;a<eu.length;a++)Zr(eu[a],n);a=s;break;case"source":Zr("error",n),a=s;break;case"img":case"image":case"link":Zr("error",n),Zr("load",n),a=s;break;case"details":Zr("toggle",n),a=s;break;case"input":hv(n,s),a=u0(n,s),Zr("invalid",n);break;case"option":a=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},a=xn({},s,{value:void 0}),Zr("invalid",n);break;case"textarea":mv(n,s),a=m0(n,s),Zr("invalid",n);break;default:a=s}g0(r,a),l=a;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?c5(n,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&i5(n,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ku(n,c):typeof c=="number"&&ku(n,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(_u.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Zr("scroll",n):c!=null&&my(n,o,c,i))}switch(r){case"input":Rh(n),pv(n,s,!1);break;case"textarea":Rh(n),fv(n);break;case"option":s.value!=null&&n.setAttribute("value",""+$i(s.value));break;case"select":n.multiple=!!s.multiple,o=s.value,o!=null?qc(n,!!s.multiple,o,!1):s.defaultValue!=null&&qc(n,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(n.onclick=Gp)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xs(t),null;case 6:if(n&&t.stateNode!=null)AS(n,t,n.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(gt(166));if(r=jl($u.current),jl(fo.current),zh(t)){if(s=t.stateNode,r=t.memoizedProps,s[co]=t,(o=s.nodeValue!==r)&&(n=oa,n!==null))switch(n.tag){case 3:Oh(s.nodeValue,r,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Oh(s.nodeValue,r,(n.mode&1)!==0)}o&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[co]=t,t.stateNode=s}return xs(t),null;case 13:if(en(mn),s=t.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(on&&aa!==null&&t.mode&1&&!(t.flags&128))J5(),sd(),t.flags|=98560,o=!1;else if(o=zh(t),s!==null&&s.dehydrated!==null){if(n===null){if(!o)throw Error(gt(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(gt(317));o[co]=t}else sd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xs(t),o=!1}else Wa!==null&&(X0(Wa),Wa=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(n===null||mn.current&1?Kn===0&&(Kn=3):Jy())),t.updateQueue!==null&&(t.flags|=4),xs(t),null);case 4:return od(),U0(n,t),n===null&&Au(t.stateNode.containerInfo),xs(t),null;case 10:return My(t.type._context),xs(t),null;case 17:return Hs(t.type)&&Vp(),xs(t),null;case 19:if(en(mn),o=t.memoizedState,o===null)return xs(t),null;if(s=(t.flags&128)!==0,i=o.rendering,i===null)if(s)Id(o,!1);else{if(Kn!==0||n!==null&&n.flags&128)for(n=t.child;n!==null;){if(i=tm(n),i!==null){for(t.flags|=128,Id(o,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)o=r,n=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,n=i.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),r=r.sibling;return Kr(mn,mn.current&1|2),t.child}n=n.sibling}o.tail!==null&&Pn()>ld&&(t.flags|=128,s=!0,Id(o,!1),t.lanes=4194304)}else{if(!s)if(n=tm(i),n!==null){if(t.flags|=128,s=!0,r=n.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Id(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!on)return xs(t),null}else 2*Pn()-o.renderingStartTime>ld&&r!==1073741824&&(t.flags|=128,s=!0,Id(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Pn(),t.sibling=null,r=mn.current,Kr(mn,s?r&1|2:r&1),t):(xs(t),null);case 22:case 23:return Ky(),s=t.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?ta&1073741824&&(xs(t),t.subtreeFlags&6&&(t.flags|=8192)):xs(t),null;case 24:return null;case 25:return null}throw Error(gt(156,t.tag))}function rT(n,t){switch(Py(t),t.tag){case 1:return Hs(t.type)&&Vp(),n=t.flags,n&65536?(t.flags=n&-65537|128,t):null;case 3:return od(),en(qs),en(_s),By(),n=t.flags,n&65536&&!(n&128)?(t.flags=n&-65537|128,t):null;case 5:return Ly(t),null;case 13:if(en(mn),n=t.memoizedState,n!==null&&n.dehydrated!==null){if(t.alternate===null)throw Error(gt(340));sd()}return n=t.flags,n&65536?(t.flags=n&-65537|128,t):null;case 19:return en(mn),null;case 4:return od(),null;case 10:return My(t.type._context),null;case 22:case 23:return Ky(),null;case 24:return null;default:return null}}var Uh=!1,vs=!1,nT=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function Oc(n,t){var r=n.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Sn(n,t,s)}else r.current=null}function q0(n,t,r){try{r()}catch(s){Sn(n,t,s)}}var s1=!1;function sT(n,t){if(N0=qp,n=L5(),Ny(n)){if("selectionStart"in n)var r={start:n.selectionStart,end:n.selectionEnd};else e:{r=(r=n.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var a=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=n,p=null;t:for(;;){for(var g;h!==r||a!==0&&h.nodeType!==3||(l=i+a),h!==o||s!==0&&h.nodeType!==3||(c=i+s),h.nodeType===3&&(i+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===n)break t;if(p===r&&++d===a&&(l=i),p===o&&++u===s&&(c=i),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(T0={focusedElem:n,selectionRange:r},qp=!1,Mt=t;Mt!==null;)if(t=Mt,n=t.child,(t.subtreeFlags&1028)!==0&&n!==null)n.return=t,Mt=n;else for(;Mt!==null;){t=Mt;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,v=f.memoizedState,b=t.stateNode,w=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:La(t.type,m),v);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(gt(163))}}catch(j){Sn(t,t.return,j)}if(n=t.sibling,n!==null){n.return=t.return,Mt=n;break}Mt=t.return}return f=s1,s1=!1,f}function pu(n,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&n)===n){var o=a.destroy;a.destroy=void 0,o!==void 0&&q0(t,r,o)}a=a.next}while(a!==s)}}function Jm(n,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&n)===n){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function H0(n){var t=n.ref;if(t!==null){var r=n.stateNode;switch(n.tag){case 5:n=r;break;default:n=r}typeof t=="function"?t(n):t.current=n}}function MS(n){var t=n.alternate;t!==null&&(n.alternate=null,MS(t)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(t=n.stateNode,t!==null&&(delete t[co],delete t[Iu],delete t[R0],delete t[z3],delete t[F3])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function IS(n){return n.tag===5||n.tag===3||n.tag===4}function a1(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||IS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Y0(n,t,r){var s=n.tag;if(s===5||s===6)n=n.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(n,t):r.insertBefore(n,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(n,r)):(t=r,t.appendChild(n)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Gp));else if(s!==4&&(n=n.child,n!==null))for(Y0(n,t,r),n=n.sibling;n!==null;)Y0(n,t,r),n=n.sibling}function G0(n,t,r){var s=n.tag;if(s===5||s===6)n=n.stateNode,t?r.insertBefore(n,t):r.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(G0(n,t,r),n=n.sibling;n!==null;)G0(n,t,r),n=n.sibling}var is=null,Oa=!1;function ti(n,t,r){for(r=r.child;r!==null;)DS(n,t,r),r=r.sibling}function DS(n,t,r){if(mo&&typeof mo.onCommitFiberUnmount=="function")try{mo.onCommitFiberUnmount(Wm,r)}catch{}switch(r.tag){case 5:vs||Oc(r,t);case 6:var s=is,a=Oa;is=null,ti(n,t,r),is=s,Oa=a,is!==null&&(Oa?(n=is,r=r.stateNode,n.nodeType===8?n.parentNode.removeChild(r):n.removeChild(r)):is.removeChild(r.stateNode));break;case 18:is!==null&&(Oa?(n=is,r=r.stateNode,n.nodeType===8?Vf(n.parentNode,r):n.nodeType===1&&Vf(n,r),Pu(n)):Vf(is,r.stateNode));break;case 4:s=is,a=Oa,is=r.stateNode.containerInfo,Oa=!0,ti(n,t,r),is=s,Oa=a;break;case 0:case 11:case 14:case 15:if(!vs&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var o=a,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&q0(r,t,i),a=a.next}while(a!==s)}ti(n,t,r);break;case 1:if(!vs&&(Oc(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Sn(r,t,l)}ti(n,t,r);break;case 21:ti(n,t,r);break;case 22:r.mode&1?(vs=(s=vs)||r.memoizedState!==null,ti(n,t,r),vs=s):ti(n,t,r);break;default:ti(n,t,r)}}function o1(n){var t=n.updateQueue;if(t!==null){n.updateQueue=null;var r=n.stateNode;r===null&&(r=n.stateNode=new nT),t.forEach(function(s){var a=pT.bind(null,n,s);r.has(s)||(r.add(s),s.then(a,a))})}}function Ma(n,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var a=r[s];try{var o=n,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:is=l.stateNode,Oa=!1;break e;case 3:is=l.stateNode.containerInfo,Oa=!0;break e;case 4:is=l.stateNode.containerInfo,Oa=!0;break e}l=l.return}if(is===null)throw Error(gt(160));DS(o,i,a),is=null,Oa=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){Sn(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$S(t,n),t=t.sibling}function $S(n,t){var r=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ma(t,n),ro(n),s&4){try{pu(3,n,n.return),Jm(3,n)}catch(m){Sn(n,n.return,m)}try{pu(5,n,n.return)}catch(m){Sn(n,n.return,m)}}break;case 1:Ma(t,n),ro(n),s&512&&r!==null&&Oc(r,r.return);break;case 5:if(Ma(t,n),ro(n),s&512&&r!==null&&Oc(r,r.return),n.flags&32){var a=n.stateNode;try{ku(a,"")}catch(m){Sn(n,n.return,m)}}if(s&4&&(a=n.stateNode,a!=null)){var o=n.memoizedProps,i=r!==null?r.memoizedProps:o,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&s5(a,o),x0(l,i);var d=x0(l,o);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];u==="style"?c5(a,h):u==="dangerouslySetInnerHTML"?i5(a,h):u==="children"?ku(a,h):my(a,u,h,d)}switch(l){case"input":h0(a,o);break;case"textarea":a5(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?qc(a,!!o.multiple,g,!1):p!==!!o.multiple&&(o.defaultValue!=null?qc(a,!!o.multiple,o.defaultValue,!0):qc(a,!!o.multiple,o.multiple?[]:"",!1))}a[Iu]=o}catch(m){Sn(n,n.return,m)}}break;case 6:if(Ma(t,n),ro(n),s&4){if(n.stateNode===null)throw Error(gt(162));a=n.stateNode,o=n.memoizedProps;try{a.nodeValue=o}catch(m){Sn(n,n.return,m)}}break;case 3:if(Ma(t,n),ro(n),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Pu(t.containerInfo)}catch(m){Sn(n,n.return,m)}break;case 4:Ma(t,n),ro(n);break;case 13:Ma(t,n),ro(n),a=n.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(Gy=Pn())),s&4&&o1(n);break;case 22:if(u=r!==null&&r.memoizedState!==null,n.mode&1?(vs=(d=vs)||u,Ma(t,n),vs=d):Ma(t,n),ro(n),s&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!u&&n.mode&1)for(Mt=n,u=n.child;u!==null;){for(h=Mt=u;Mt!==null;){switch(p=Mt,g=p.child,p.tag){case 0:case 11:case 14:case 15:pu(4,p,p.return);break;case 1:Oc(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){s=p,r=p.return;try{t=s,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){Sn(s,r,m)}}break;case 5:Oc(p,p.return);break;case 22:if(p.memoizedState!==null){l1(h);continue}}g!==null?(g.return=p,Mt=g):l1(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,d?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=l5("display",i))}catch(m){Sn(n,n.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(m){Sn(n,n.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ma(t,n),ro(n),s&4&&o1(n);break;case 21:break;default:Ma(t,n),ro(n)}}function ro(n){var t=n.flags;if(t&2){try{e:{for(var r=n.return;r!==null;){if(IS(r)){var s=r;break e}r=r.return}throw Error(gt(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(ku(a,""),s.flags&=-33);var o=a1(n);G0(n,o,a);break;case 3:case 4:var i=s.stateNode.containerInfo,l=a1(n);Y0(n,l,i);break;default:throw Error(gt(161))}}catch(c){Sn(n,n.return,c)}n.flags&=-3}t&4096&&(n.flags&=-4097)}function aT(n,t,r){Mt=n,LS(n)}function LS(n,t,r){for(var s=(n.mode&1)!==0;Mt!==null;){var a=Mt,o=a.child;if(a.tag===22&&s){var i=a.memoizedState!==null||Uh;if(!i){var l=a.alternate,c=l!==null&&l.memoizedState!==null||vs;l=Uh;var d=vs;if(Uh=i,(vs=c)&&!d)for(Mt=a;Mt!==null;)i=Mt,c=i.child,i.tag===22&&i.memoizedState!==null?c1(a):c!==null?(c.return=i,Mt=c):c1(a);for(;o!==null;)Mt=o,LS(o),o=o.sibling;Mt=a,Uh=l,vs=d}i1(n)}else a.subtreeFlags&8772&&o!==null?(o.return=a,Mt=o):i1(n)}}function i1(n){for(;Mt!==null;){var t=Mt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vs||Jm(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!vs)if(r===null)s.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:La(t.type,r.memoizedProps);s.componentDidUpdate(a,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Hv(t,o,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hv(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Pu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(gt(163))}vs||t.flags&512&&H0(t)}catch(p){Sn(t,t.return,p)}}if(t===n){Mt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Mt=r;break}Mt=t.return}}function l1(n){for(;Mt!==null;){var t=Mt;if(t===n){Mt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Mt=r;break}Mt=t.return}}function c1(n){for(;Mt!==null;){var t=Mt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Jm(4,t)}catch(c){Sn(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(c){Sn(t,a,c)}}var o=t.return;try{H0(t)}catch(c){Sn(t,o,c)}break;case 5:var i=t.return;try{H0(t)}catch(c){Sn(t,i,c)}}}catch(c){Sn(t,t.return,c)}if(t===n){Mt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Mt=l;break}Mt=t.return}}var oT=Math.ceil,sm=Xo.ReactCurrentDispatcher,Hy=Xo.ReactCurrentOwner,ja=Xo.ReactCurrentBatchConfig,Cr=0,Xn=null,Bn=null,cs=0,ta=0,zc=Wi(0),Kn=0,zu=null,Bl=0,Xm=0,Yy=0,mu=null,Fs=null,Gy=0,ld=1/0,Mo=null,am=!1,V0=null,Ei=null,qh=!1,wi=null,om=0,fu=0,K0=null,Sp=-1,_p=0;function Ds(){return Cr&6?Pn():Sp!==-1?Sp:Sp=Pn()}function Ri(n){return n.mode&1?Cr&2&&cs!==0?cs&-cs:U3.transition!==null?(_p===0&&(_p=w5()),_p):(n=Ir,n!==0||(n=window.event,n=n===void 0?16:T5(n.type)),n):1}function Ha(n,t,r,s){if(50<fu)throw fu=0,K0=null,Error(gt(185));mh(n,r,s),(!(Cr&2)||n!==Xn)&&(n===Xn&&(!(Cr&2)&&(Xm|=r),Kn===4&&xi(n,cs)),Ys(n,s),r===1&&Cr===0&&!(t.mode&1)&&(ld=Pn()+500,Gm&&Ui()))}function Ys(n,t){var r=n.callbackNode;U4(n,t);var s=Up(n,n===Xn?cs:0);if(s===0)r!==null&&yv(r),n.callbackNode=null,n.callbackPriority=0;else if(t=s&-s,n.callbackPriority!==t){if(r!=null&&yv(r),t===1)n.tag===0?W3(d1.bind(null,n)):G5(d1.bind(null,n)),B3(function(){!(Cr&6)&&Ui()}),r=null;else{switch(j5(s)){case 1:r=by;break;case 4:r=b5;break;case 16:r=Wp;break;case 536870912:r=v5;break;default:r=Wp}r=HS(r,BS.bind(null,n))}n.callbackPriority=t,n.callbackNode=r}}function BS(n,t){if(Sp=-1,_p=0,Cr&6)throw Error(gt(327));var r=n.callbackNode;if(Kc()&&n.callbackNode!==r)return null;var s=Up(n,n===Xn?cs:0);if(s===0)return null;if(s&30||s&n.expiredLanes||t)t=im(n,s);else{t=s;var a=Cr;Cr|=2;var o=zS();(Xn!==n||cs!==t)&&(Mo=null,ld=Pn()+500,Tl(n,t));do try{cT();break}catch(l){OS(n,l)}while(1);Ay(),sm.current=o,Cr=a,Bn!==null?t=0:(Xn=null,cs=0,t=Kn)}if(t!==0){if(t===2&&(a=j0(n),a!==0&&(s=a,t=J0(n,a))),t===1)throw r=zu,Tl(n,0),xi(n,s),Ys(n,Pn()),r;if(t===6)xi(n,s);else{if(a=n.current.alternate,!(s&30)&&!iT(a)&&(t=im(n,s),t===2&&(o=j0(n),o!==0&&(s=o,t=J0(n,o))),t===1))throw r=zu,Tl(n,0),xi(n,s),Ys(n,Pn()),r;switch(n.finishedWork=a,n.finishedLanes=s,t){case 0:case 1:throw Error(gt(345));case 2:cl(n,Fs,Mo);break;case 3:if(xi(n,s),(s&130023424)===s&&(t=Gy+500-Pn(),10<t)){if(Up(n,0)!==0)break;if(a=n.suspendedLanes,(a&s)!==s){Ds(),n.pingedLanes|=n.suspendedLanes&a;break}n.timeoutHandle=E0(cl.bind(null,n,Fs,Mo),t);break}cl(n,Fs,Mo);break;case 4:if(xi(n,s),(s&4194240)===s)break;for(t=n.eventTimes,a=-1;0<s;){var i=31-qa(s);o=1<<i,i=t[i],i>a&&(a=i),s&=~o}if(s=a,s=Pn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*oT(s/1960))-s,10<s){n.timeoutHandle=E0(cl.bind(null,n,Fs,Mo),s);break}cl(n,Fs,Mo);break;case 5:cl(n,Fs,Mo);break;default:throw Error(gt(329))}}}return Ys(n,Pn()),n.callbackNode===r?BS.bind(null,n):null}function J0(n,t){var r=mu;return n.current.memoizedState.isDehydrated&&(Tl(n,t).flags|=256),n=im(n,t),n!==2&&(t=Fs,Fs=r,t!==null&&X0(t)),n}function X0(n){Fs===null?Fs=n:Fs.push.apply(Fs,n)}function iT(n){for(var t=n;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var a=r[s],o=a.getSnapshot;a=a.value;try{if(!Ga(o(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===n)break;for(;t.sibling===null;){if(t.return===null||t.return===n)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xi(n,t){for(t&=~Yy,t&=~Xm,n.suspendedLanes|=t,n.pingedLanes&=~t,n=n.expirationTimes;0<t;){var r=31-qa(t),s=1<<r;n[r]=-1,t&=~s}}function d1(n){if(Cr&6)throw Error(gt(327));Kc();var t=Up(n,0);if(!(t&1))return Ys(n,Pn()),null;var r=im(n,t);if(n.tag!==0&&r===2){var s=j0(n);s!==0&&(t=s,r=J0(n,s))}if(r===1)throw r=zu,Tl(n,0),xi(n,t),Ys(n,Pn()),r;if(r===6)throw Error(gt(345));return n.finishedWork=n.current.alternate,n.finishedLanes=t,cl(n,Fs,Mo),Ys(n,Pn()),null}function Vy(n,t){var r=Cr;Cr|=1;try{return n(t)}finally{Cr=r,Cr===0&&(ld=Pn()+500,Gm&&Ui())}}function Ol(n){wi!==null&&wi.tag===0&&!(Cr&6)&&Kc();var t=Cr;Cr|=1;var r=ja.transition,s=Ir;try{if(ja.transition=null,Ir=1,n)return n()}finally{Ir=s,ja.transition=r,Cr=t,!(Cr&6)&&Ui()}}function Ky(){ta=zc.current,en(zc)}function Tl(n,t){n.finishedWork=null,n.finishedLanes=0;var r=n.timeoutHandle;if(r!==-1&&(n.timeoutHandle=-1,L3(r)),Bn!==null)for(r=Bn.return;r!==null;){var s=r;switch(Py(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Vp();break;case 3:od(),en(qs),en(_s),By();break;case 5:Ly(s);break;case 4:od();break;case 13:en(mn);break;case 19:en(mn);break;case 10:My(s.type._context);break;case 22:case 23:Ky()}r=r.return}if(Xn=n,Bn=n=Ai(n.current,null),cs=ta=t,Kn=0,zu=null,Yy=Xm=Bl=0,Fs=mu=null,wl!==null){for(t=0;t<wl.length;t++)if(r=wl[t],s=r.interleaved,s!==null){r.interleaved=null;var a=s.next,o=r.pending;if(o!==null){var i=o.next;o.next=a,s.next=i}r.pending=s}wl=null}return n}function OS(n,t){do{var r=Bn;try{if(Ay(),vp.current=nm,rm){for(var s=gn.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}rm=!1}if(Ll=0,Jn=Vn=gn=null,hu=!1,Lu=0,Hy.current=null,r===null||r.return===null){Kn=1,zu=t,Bn=null;break}e:{var o=n,i=r.return,l=r,c=t;if(t=cs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=Xv(i);if(g!==null){g.flags&=-257,Qv(g,i,l,o,t),g.mode&1&&Jv(o,d,t),t=g,c=d;var f=t.updateQueue;if(f===null){var m=new Set;m.add(c),t.updateQueue=m}else f.add(c);break e}else{if(!(t&1)){Jv(o,d,t),Jy();break e}c=Error(gt(426))}}else if(on&&l.mode&1){var v=Xv(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Qv(v,i,l,o,t),Ey(id(c,l));break e}}o=c=id(c,l),Kn!==4&&(Kn=2),mu===null?mu=[o]:mu.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var b=jS(o,c,t);qv(o,b);break e;case 1:l=c;var w=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ei===null||!Ei.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=SS(o,l,t);qv(o,j);break e}}o=o.return}while(o!==null)}WS(r)}catch(S){t=S,Bn===r&&r!==null&&(Bn=r=r.return);continue}break}while(1)}function zS(){var n=sm.current;return sm.current=nm,n===null?nm:n}function Jy(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),Xn===null||!(Bl&268435455)&&!(Xm&268435455)||xi(Xn,cs)}function im(n,t){var r=Cr;Cr|=2;var s=zS();(Xn!==n||cs!==t)&&(Mo=null,Tl(n,t));do try{lT();break}catch(a){OS(n,a)}while(1);if(Ay(),Cr=r,sm.current=s,Bn!==null)throw Error(gt(261));return Xn=null,cs=0,Kn}function lT(){for(;Bn!==null;)FS(Bn)}function cT(){for(;Bn!==null&&!I4();)FS(Bn)}function FS(n){var t=qS(n.alternate,n,ta);n.memoizedProps=n.pendingProps,t===null?WS(n):Bn=t,Hy.current=null}function WS(n){var t=n;do{var r=t.alternate;if(n=t.return,t.flags&32768){if(r=rT(r,t),r!==null){r.flags&=32767,Bn=r;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Kn=6,Bn=null;return}}else if(r=tT(r,t,ta),r!==null){Bn=r;return}if(t=t.sibling,t!==null){Bn=t;return}Bn=t=n}while(t!==null);Kn===0&&(Kn=5)}function cl(n,t,r){var s=Ir,a=ja.transition;try{ja.transition=null,Ir=1,dT(n,t,r,s)}finally{ja.transition=a,Ir=s}return null}function dT(n,t,r,s){do Kc();while(wi!==null);if(Cr&6)throw Error(gt(327));r=n.finishedWork;var a=n.finishedLanes;if(r===null)return null;if(n.finishedWork=null,n.finishedLanes=0,r===n.current)throw Error(gt(177));n.callbackNode=null,n.callbackPriority=0;var o=r.lanes|r.childLanes;if(q4(n,o),n===Xn&&(Bn=Xn=null,cs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||qh||(qh=!0,HS(Wp,function(){return Kc(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=ja.transition,ja.transition=null;var i=Ir;Ir=1;var l=Cr;Cr|=4,Hy.current=null,sT(n,r),$S(r,n),E3(T0),qp=!!N0,T0=N0=null,n.current=r,aT(r),D4(),Cr=l,Ir=i,ja.transition=o}else n.current=r;if(qh&&(qh=!1,wi=n,om=a),o=n.pendingLanes,o===0&&(Ei=null),B4(r.stateNode),Ys(n,Pn()),t!==null)for(s=n.onRecoverableError,r=0;r<t.length;r++)a=t[r],s(a.value,{componentStack:a.stack,digest:a.digest});if(am)throw am=!1,n=V0,V0=null,n;return om&1&&n.tag!==0&&Kc(),o=n.pendingLanes,o&1?n===K0?fu++:(fu=0,K0=n):fu=0,Ui(),null}function Kc(){if(wi!==null){var n=j5(om),t=ja.transition,r=Ir;try{if(ja.transition=null,Ir=16>n?16:n,wi===null)var s=!1;else{if(n=wi,wi=null,om=0,Cr&6)throw Error(gt(331));var a=Cr;for(Cr|=4,Mt=n.current;Mt!==null;){var o=Mt,i=o.child;if(Mt.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Mt=d;Mt!==null;){var u=Mt;switch(u.tag){case 0:case 11:case 15:pu(8,u,o)}var h=u.child;if(h!==null)h.return=u,Mt=h;else for(;Mt!==null;){u=Mt;var p=u.sibling,g=u.return;if(MS(u),u===d){Mt=null;break}if(p!==null){p.return=g,Mt=p;break}Mt=g}}}var f=o.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Mt=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Mt=i;else e:for(;Mt!==null;){if(o=Mt,o.flags&2048)switch(o.tag){case 0:case 11:case 15:pu(9,o,o.return)}var b=o.sibling;if(b!==null){b.return=o.return,Mt=b;break e}Mt=o.return}}var w=n.current;for(Mt=w;Mt!==null;){i=Mt;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,Mt=x;else e:for(i=w;Mt!==null;){if(l=Mt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Jm(9,l)}}catch(S){Sn(l,l.return,S)}if(l===i){Mt=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Mt=j;break e}Mt=l.return}}if(Cr=a,Ui(),mo&&typeof mo.onPostCommitFiberRoot=="function")try{mo.onPostCommitFiberRoot(Wm,n)}catch{}s=!0}return s}finally{Ir=r,ja.transition=t}}return!1}function u1(n,t,r){t=id(r,t),t=jS(n,t,1),n=Pi(n,t,1),t=Ds(),n!==null&&(mh(n,1,t),Ys(n,t))}function Sn(n,t,r){if(n.tag===3)u1(n,n,r);else for(;t!==null;){if(t.tag===3){u1(t,n,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ei===null||!Ei.has(s))){n=id(r,n),n=SS(t,n,1),t=Pi(t,n,1),n=Ds(),t!==null&&(mh(t,1,n),Ys(t,n));break}}t=t.return}}function uT(n,t,r){var s=n.pingCache;s!==null&&s.delete(t),t=Ds(),n.pingedLanes|=n.suspendedLanes&r,Xn===n&&(cs&r)===r&&(Kn===4||Kn===3&&(cs&130023424)===cs&&500>Pn()-Gy?Tl(n,0):Yy|=r),Ys(n,t)}function US(n,t){t===0&&(n.mode&1?(t=Ih,Ih<<=1,!(Ih&130023424)&&(Ih=4194304)):t=1);var r=Ds();n=Yo(n,t),n!==null&&(mh(n,t,r),Ys(n,r))}function hT(n){var t=n.memoizedState,r=0;t!==null&&(r=t.retryLane),US(n,r)}function pT(n,t){var r=0;switch(n.tag){case 13:var s=n.stateNode,a=n.memoizedState;a!==null&&(r=a.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(gt(314))}s!==null&&s.delete(t),US(n,r)}var qS;qS=function(n,t,r){if(n!==null)if(n.memoizedProps!==t.pendingProps||qs.current)Us=!0;else{if(!(n.lanes&r)&&!(t.flags&128))return Us=!1,eT(n,t,r);Us=!!(n.flags&131072)}else Us=!1,on&&t.flags&1048576&&V5(t,Xp,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;jp(n,t),n=t.pendingProps;var a=nd(t,_s.current);Vc(t,r),a=zy(null,t,s,n,a,r);var o=Fy();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hs(s)?(o=!0,Kp(t)):o=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Dy(t),a.updater=Km,t.stateNode=a,a._reactInternals=t,L0(t,s,n,r),t=z0(null,t,s,!0,o,r)):(t.tag=0,on&&o&&Ty(t),Es(null,t,a,r),t=t.child),t;case 16:s=t.elementType;e:{switch(jp(n,t),n=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=fT(s),n=La(s,n),a){case 0:t=O0(null,t,s,n,r);break e;case 1:t=t1(null,t,s,n,r);break e;case 11:t=Zv(null,t,s,n,r);break e;case 14:t=e1(null,t,s,La(s.type,n),r);break e}throw Error(gt(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:La(s,a),O0(n,t,s,a,r);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:La(s,a),t1(n,t,s,a,r);case 3:e:{if(NS(t),n===null)throw Error(gt(387));s=t.pendingProps,o=t.memoizedState,a=o.element,eS(n,t),em(t,s,null,r);var i=t.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){a=id(Error(gt(423)),t),t=r1(n,t,s,r,a);break e}else if(s!==a){a=id(Error(gt(424)),t),t=r1(n,t,s,r,a);break e}else for(aa=Ti(t.stateNode.containerInfo.firstChild),oa=t,on=!0,Wa=null,r=Q5(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(sd(),s===a){t=Go(n,t,r);break e}Es(n,t,s,r)}t=t.child}return t;case 5:return tS(t),n===null&&I0(t),s=t.type,a=t.pendingProps,o=n!==null?n.memoizedProps:null,i=a.children,P0(s,a)?i=null:o!==null&&P0(s,o)&&(t.flags|=32),CS(n,t),Es(n,t,i,r),t.child;case 6:return n===null&&I0(t),null;case 13:return TS(n,t,r);case 4:return $y(t,t.stateNode.containerInfo),s=t.pendingProps,n===null?t.child=ad(t,null,s,r):Es(n,t,s,r),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:La(s,a),Zv(n,t,s,a,r);case 7:return Es(n,t,t.pendingProps,r),t.child;case 8:return Es(n,t,t.pendingProps.children,r),t.child;case 12:return Es(n,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,Kr(Qp,s._currentValue),s._currentValue=i,o!==null)if(Ga(o.value,i)){if(o.children===a.children&&!qs.current){t=Go(n,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(o.tag===1){c=Wo(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),D0(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(gt(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),D0(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Es(n,t,a.children,r),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Vc(t,r),a=ka(a),s=s(a),t.flags|=1,Es(n,t,s,r),t.child;case 14:return s=t.type,a=La(s,t.pendingProps),a=La(s.type,a),e1(n,t,s,a,r);case 15:return _S(n,t,t.type,t.pendingProps,r);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:La(s,a),jp(n,t),t.tag=1,Hs(s)?(n=!0,Kp(t)):n=!1,Vc(t,r),wS(t,s,a),L0(t,s,a,r),z0(null,t,s,!0,n,r);case 19:return PS(n,t,r);case 22:return kS(n,t,r)}throw Error(gt(156,t.tag))};function HS(n,t){return y5(n,t)}function mT(n,t,r,s){this.tag=n,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wa(n,t,r,s){return new mT(n,t,r,s)}function Xy(n){return n=n.prototype,!(!n||!n.isReactComponent)}function fT(n){if(typeof n=="function")return Xy(n)?1:0;if(n!=null){if(n=n.$$typeof,n===gy)return 11;if(n===xy)return 14}return 2}function Ai(n,t){var r=n.alternate;return r===null?(r=wa(n.tag,t,n.key,n.mode),r.elementType=n.elementType,r.type=n.type,r.stateNode=n.stateNode,r.alternate=n,n.alternate=r):(r.pendingProps=t,r.type=n.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=n.flags&14680064,r.childLanes=n.childLanes,r.lanes=n.lanes,r.child=n.child,r.memoizedProps=n.memoizedProps,r.memoizedState=n.memoizedState,r.updateQueue=n.updateQueue,t=n.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=n.sibling,r.index=n.index,r.ref=n.ref,r}function kp(n,t,r,s,a,o){var i=2;if(s=n,typeof n=="function")Xy(n)&&(i=1);else if(typeof n=="string")i=5;else e:switch(n){case Ec:return Pl(r.children,a,o,t);case fy:i=8,a|=8;break;case i0:return n=wa(12,r,t,a|2),n.elementType=i0,n.lanes=o,n;case l0:return n=wa(13,r,t,a),n.elementType=l0,n.lanes=o,n;case c0:return n=wa(19,r,t,a),n.elementType=c0,n.lanes=o,n;case t5:return Qm(r,a,o,t);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Z2:i=10;break e;case e5:i=9;break e;case gy:i=11;break e;case xy:i=14;break e;case ui:i=16,s=null;break e}throw Error(gt(130,n==null?n:typeof n,""))}return t=wa(i,r,t,a),t.elementType=n,t.type=s,t.lanes=o,t}function Pl(n,t,r,s){return n=wa(7,n,s,t),n.lanes=r,n}function Qm(n,t,r,s){return n=wa(22,n,s,t),n.elementType=t5,n.lanes=r,n.stateNode={isHidden:!1},n}function rg(n,t,r){return n=wa(6,n,null,t),n.lanes=r,n}function ng(n,t,r){return t=wa(4,n.children!==null?n.children:[],n.key,t),t.lanes=r,t.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},t}function gT(n,t,r,s,a){this.tag=t,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lf(0),this.expirationTimes=Lf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lf(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Qy(n,t,r,s,a,o,i,l,c){return n=new gT(n,t,r,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=wa(3,null,null,t),n.current=o,o.stateNode=n,o.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dy(o),n}function xT(n,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pc,key:s==null?null:""+s,children:n,containerInfo:t,implementation:r}}function YS(n){if(!n)return Li;n=n._reactInternals;e:{if(Vl(n)!==n||n.tag!==1)throw Error(gt(170));var t=n;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(gt(171))}if(n.tag===1){var r=n.type;if(Hs(r))return Y5(n,r,t)}return t}function GS(n,t,r,s,a,o,i,l,c){return n=Qy(r,s,!0,n,a,o,i,l,c),n.context=YS(null),r=n.current,s=Ds(),a=Ri(r),o=Wo(s,a),o.callback=t??null,Pi(r,o,a),n.current.lanes=a,mh(n,a,s),Ys(n,s),n}function Zm(n,t,r,s){var a=t.current,o=Ds(),i=Ri(a);return r=YS(r),t.context===null?t.context=r:t.pendingContext=r,t=Wo(o,i),t.payload={element:n},s=s===void 0?null:s,s!==null&&(t.callback=s),n=Pi(a,t,i),n!==null&&(Ha(n,a,i,o),bp(n,a,i)),i}function lm(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function h1(n,t){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var r=n.retryLane;n.retryLane=r!==0&&r<t?r:t}}function Zy(n,t){h1(n,t),(n=n.alternate)&&h1(n,t)}function yT(){return null}var VS=typeof reportError=="function"?reportError:function(n){console.error(n)};function eb(n){this._internalRoot=n}ef.prototype.render=eb.prototype.render=function(n){var t=this._internalRoot;if(t===null)throw Error(gt(409));Zm(n,t,null,null)};ef.prototype.unmount=eb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var t=n.containerInfo;Ol(function(){Zm(null,n,null,null)}),t[Ho]=null}};function ef(n){this._internalRoot=n}ef.prototype.unstable_scheduleHydration=function(n){if(n){var t=k5();n={blockedOn:null,target:n,priority:t};for(var r=0;r<gi.length&&t!==0&&t<gi[r].priority;r++);gi.splice(r,0,n),r===0&&N5(n)}};function tb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function tf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function p1(){}function bT(n,t,r,s,a){if(a){if(typeof s=="function"){var o=s;s=function(){var d=lm(i);o.call(d)}}var i=GS(t,s,n,0,null,!1,!1,"",p1);return n._reactRootContainer=i,n[Ho]=i.current,Au(n.nodeType===8?n.parentNode:n),Ol(),i}for(;a=n.lastChild;)n.removeChild(a);if(typeof s=="function"){var l=s;s=function(){var d=lm(c);l.call(d)}}var c=Qy(n,0,!1,null,null,!1,!1,"",p1);return n._reactRootContainer=c,n[Ho]=c.current,Au(n.nodeType===8?n.parentNode:n),Ol(function(){Zm(t,c,r,s)}),c}function rf(n,t,r,s,a){var o=r._reactRootContainer;if(o){var i=o;if(typeof a=="function"){var l=a;a=function(){var c=lm(i);l.call(c)}}Zm(t,i,n,a)}else i=bT(r,t,n,a,s);return lm(i)}S5=function(n){switch(n.tag){case 3:var t=n.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zd(t.pendingLanes);r!==0&&(vy(t,r|1),Ys(t,Pn()),!(Cr&6)&&(ld=Pn()+500,Ui()))}break;case 13:Ol(function(){var s=Yo(n,1);if(s!==null){var a=Ds();Ha(s,n,1,a)}}),Zy(n,1)}};wy=function(n){if(n.tag===13){var t=Yo(n,134217728);if(t!==null){var r=Ds();Ha(t,n,134217728,r)}Zy(n,134217728)}};_5=function(n){if(n.tag===13){var t=Ri(n),r=Yo(n,t);if(r!==null){var s=Ds();Ha(r,n,t,s)}Zy(n,t)}};k5=function(){return Ir};C5=function(n,t){var r=Ir;try{return Ir=n,t()}finally{Ir=r}};b0=function(n,t,r){switch(t){case"input":if(h0(n,r),t=r.name,r.type==="radio"&&t!=null){for(r=n;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==n&&s.form===n.form){var a=Ym(s);if(!a)throw Error(gt(90));n5(s),h0(s,a)}}}break;case"textarea":a5(n,r);break;case"select":t=r.value,t!=null&&qc(n,!!r.multiple,t,!1)}};h5=Vy;p5=Ol;var vT={usingClientEntryPoint:!1,Events:[gh,Ic,Ym,d5,u5,Vy]},Dd={findFiberByHostInstance:vl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wT={bundleType:Dd.bundleType,version:Dd.version,rendererPackageName:Dd.rendererPackageName,rendererConfig:Dd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=g5(n),n===null?null:n.stateNode},findFiberByHostInstance:Dd.findFiberByHostInstance||yT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hh.isDisabled&&Hh.supportsFiber)try{Wm=Hh.inject(wT),mo=Hh}catch{}}ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vT;ca.createPortal=function(n,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tb(t))throw Error(gt(200));return xT(n,t,null,r)};ca.createRoot=function(n,t){if(!tb(n))throw Error(gt(299));var r=!1,s="",a=VS;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Qy(n,1,!1,null,null,r,!1,s,a),n[Ho]=t.current,Au(n.nodeType===8?n.parentNode:n),new eb(t)};ca.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var t=n._reactInternals;if(t===void 0)throw typeof n.render=="function"?Error(gt(188)):(n=Object.keys(n).join(","),Error(gt(268,n)));return n=g5(t),n=n===null?null:n.stateNode,n};ca.flushSync=function(n){return Ol(n)};ca.hydrate=function(n,t,r){if(!tf(t))throw Error(gt(200));return rf(null,n,t,!0,r)};ca.hydrateRoot=function(n,t,r){if(!tb(n))throw Error(gt(405));var s=r!=null&&r.hydratedSources||null,a=!1,o="",i=VS;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=GS(t,null,n,1,r??null,a,!1,o,i),n[Ho]=t.current,Au(n),s)for(n=0;n<s.length;n++)r=s[n],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new ef(t)};ca.render=function(n,t,r){if(!tf(t))throw Error(gt(200));return rf(null,n,t,!1,r)};ca.unmountComponentAtNode=function(n){if(!tf(n))throw Error(gt(40));return n._reactRootContainer?(Ol(function(){rf(null,null,n,!1,function(){n._reactRootContainer=null,n[Ho]=null})}),!0):!1};ca.unstable_batchedUpdates=Vy;ca.unstable_renderSubtreeIntoContainer=function(n,t,r,s){if(!tf(r))throw Error(gt(200));if(n==null||n._reactInternals===void 0)throw Error(gt(38));return rf(n,t,r,!1,s)};ca.version="18.3.1-next-f1338f8080-20240426";function KS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KS)}catch(n){console.error(n)}}KS(),K2.exports=ca;var xr=K2.exports;const yh=Jo(xr);var m1=xr;a0.createRoot=m1.createRoot,a0.hydrateRoot=m1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fu(){return Fu=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])}return n},Fu.apply(this,arguments)}var ji;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ji||(ji={}));const f1="popstate";function jT(n){n===void 0&&(n={});function t(a,o){let{pathname:i="/",search:l="",hash:c=""}=Kl(a.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Q0("",{pathname:i,search:l,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(a,o){let i=a.document.querySelector("base"),l="";if(i&&i.getAttribute("href")){let c=a.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof o=="string"?o:JS(o))}function s(a,o){rb(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return _T(t,r,s,n)}function On(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function rb(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ST(){return Math.random().toString(36).substr(2,8)}function g1(n,t){return{usr:n.state,key:n.key,idx:t}}function Q0(n,t,r,s){return r===void 0&&(r=null),Fu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof t=="string"?Kl(t):t,{state:r,key:t&&t.key||s||ST()})}function JS(n){let{pathname:t="/",search:r="",hash:s=""}=n;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Kl(n){let t={};if(n){let r=n.indexOf("#");r>=0&&(t.hash=n.substr(r),n=n.substr(0,r));let s=n.indexOf("?");s>=0&&(t.search=n.substr(s),n=n.substr(0,s)),n&&(t.pathname=n)}return t}function _T(n,t,r,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:o=!1}=s,i=a.history,l=ji.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(Fu({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function h(){l=ji.Pop;let v=u(),b=v==null?null:v-d;d=v,c&&c({action:l,location:m.location,delta:b})}function p(v,b){l=ji.Push;let w=Q0(m.location,v,b);r&&r(w,v),d=u()+1;let x=g1(w,d),j=m.createHref(w);try{i.pushState(x,"",j)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(j)}o&&c&&c({action:l,location:m.location,delta:1})}function g(v,b){l=ji.Replace;let w=Q0(m.location,v,b);r&&r(w,v),d=u();let x=g1(w,d),j=m.createHref(w);i.replaceState(x,"",j),o&&c&&c({action:l,location:m.location,delta:0})}function f(v){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof v=="string"?v:JS(v);return w=w.replace(/ $/,"%20"),On(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let m={get action(){return l},get location(){return n(a,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(f1,h),c=v,()=>{a.removeEventListener(f1,h),c=null}},createHref(v){return t(a,v)},createURL:f,encodeLocation(v){let b=f(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:g,go(v){return i.go(v)}};return m}var x1;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(x1||(x1={}));function kT(n,t,r){return r===void 0&&(r="/"),CT(n,t,r,!1)}function CT(n,t,r,s){let a=typeof t=="string"?Kl(t):t,o=ZS(a.pathname||"/",r);if(o==null)return null;let i=XS(n);NT(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=BT(o);l=$T(i[c],d,s)}return l}function XS(n,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let a=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(On(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=El([s,c.relativePath]),u=r.concat(c);o.children&&o.children.length>0&&(On(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),XS(o.children,t,u,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:IT(d,o.index),routesMeta:u})};return n.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))a(o,i);else for(let c of QS(o.path))a(o,i,c)}),t}function QS(n){let t=n.split("/");if(t.length===0)return[];let[r,...s]=t,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let i=QS(s.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&l.push(...i),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function NT(n){n.sort((t,r)=>t.score!==r.score?r.score-t.score:DT(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const TT=/^:[\w-]+$/,PT=3,ET=2,RT=1,AT=10,MT=-2,y1=n=>n==="*";function IT(n,t){let r=n.split("/"),s=r.length;return r.some(y1)&&(s+=MT),t&&(s+=ET),r.filter(a=>!y1(a)).reduce((a,o)=>a+(TT.test(o)?PT:o===""?RT:AT),s)}function DT(n,t){return n.length===t.length&&n.slice(0,-1).every((s,a)=>s===t[a])?n[n.length-1]-t[t.length-1]:0}function $T(n,t,r){r===void 0&&(r=!1);let{routesMeta:s}=n,a={},o="/",i=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=o==="/"?t:t.slice(o.length)||"/",h=b1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),p=c.route;if(!h&&d&&r&&!s[s.length-1].route.index&&(h=b1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:El([o,h.pathname]),pathnameBase:WT(El([o,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(o=El([o,h.pathnameBase]))}return i}function b1(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[r,s]=LT(n.path,n.caseSensitive,n.end),a=t.match(r);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:s.reduce((d,u,h)=>{let{paramName:p,isOptional:g}=u;if(p==="*"){let m=l[h]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const f=l[h];return g&&!f?d[p]=void 0:d[p]=(f||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:n}}function LT(n,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),rb(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function BT(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return rb(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),n}}function ZS(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=n.charAt(r);return s&&s!=="/"?null:n.slice(r)||"/"}function OT(n,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:a=""}=typeof n=="string"?Kl(n):n;return{pathname:r?r.startsWith("/")?r:zT(r,t):t,search:UT(s),hash:qT(a)}}function zT(n,t){let r=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function sg(n,t,r,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function FT(n){return n.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function e_(n,t){let r=FT(n);return t?r.map((s,a)=>a===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function t_(n,t,r,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Kl(n):(a=Fu({},n),On(!a.pathname||!a.pathname.includes("?"),sg("?","pathname","search",a)),On(!a.pathname||!a.pathname.includes("#"),sg("#","pathname","hash",a)),On(!a.search||!a.search.includes("#"),sg("#","search","hash",a)));let o=n===""||a.pathname==="",i=o?"/":a.pathname,l;if(i==null)l=r;else{let h=t.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}l=h>=0?t[h]:"/"}let c=OT(a,l),d=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const El=n=>n.join("/").replace(/\/\/+/g,"/"),WT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),UT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function HT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const r_=["post","put","patch","delete"];new Set(r_);const YT=["get",...r_];new Set(YT);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wu(){return Wu=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])}return n},Wu.apply(this,arguments)}const nb=y.createContext(null),GT=y.createContext(null),bh=y.createContext(null),nf=y.createContext(null),Jl=y.createContext({outlet:null,matches:[],isDataRoute:!1}),n_=y.createContext(null);function vh(){return y.useContext(nf)!=null}function qi(){return vh()||On(!1),y.useContext(nf).location}function s_(n){y.useContext(bh).static||y.useLayoutEffect(n)}function yn(){let{isDataRoute:n}=y.useContext(Jl);return n?o8():VT()}function VT(){vh()||On(!1);let n=y.useContext(nb),{basename:t,future:r,navigator:s}=y.useContext(bh),{matches:a}=y.useContext(Jl),{pathname:o}=qi(),i=JSON.stringify(e_(a,r.v7_relativeSplatPath)),l=y.useRef(!1);return s_(()=>{l.current=!0}),y.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let h=t_(d,JSON.parse(i),o,u.relative==="path");n==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:El([t,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[t,s,i,o,n])}function KT(n,t){return JT(n,t)}function JT(n,t,r,s){vh()||On(!1);let{navigator:a}=y.useContext(bh),{matches:o}=y.useContext(Jl),i=o[o.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=qi(),u;if(t){var h;let v=typeof t=="string"?Kl(t):t;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||On(!1),u=v}else u=d;let p=u.pathname||"/",g=p;if(c!=="/"){let v=c.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let f=kT(n,{pathname:g}),m=t8(f&&f.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:El([c,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:El([c,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,r,s);return t&&m?y.createElement(nf.Provider,{value:{location:Wu({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ji.Pop}},m):m}function XT(){let n=a8(),t=HT(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),r=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),r?y.createElement("pre",{style:a},r):null,o)}const QT=y.createElement(XT,null);class ZT extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?y.createElement(Jl.Provider,{value:this.props.routeContext},y.createElement(n_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function e8(n){let{routeContext:t,match:r,children:s}=n,a=y.useContext(nb);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),y.createElement(Jl.Provider,{value:t},s)}function t8(n,t,r,s){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),s===void 0&&(s=null),n==null){var o;if(!r)return null;if(r.errors)n=r.matches;else if((o=s)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)n=r.matches;else return null}let i=n,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||On(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:p,errors:g}=r,f=h.route.loader&&p[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||f){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,h,p)=>{let g,f=!1,m=null,v=null;r&&(g=l&&h.route.id?l[h.route.id]:void 0,m=h.route.errorElement||QT,c&&(d<0&&p===0?(i8("route-fallback",!1),f=!0,v=null):d===p&&(f=!0,v=h.route.hydrateFallbackElement||null)));let b=t.concat(i.slice(0,p+1)),w=()=>{let x;return g?x=m:f?x=v:h.route.Component?x=y.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,y.createElement(e8,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:r!=null},children:x})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?y.createElement(ZT,{location:r.location,revalidation:r.revalidation,component:m,error:g,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var a_=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(a_||{}),cm=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(cm||{});function r8(n){let t=y.useContext(nb);return t||On(!1),t}function n8(n){let t=y.useContext(GT);return t||On(!1),t}function s8(n){let t=y.useContext(Jl);return t||On(!1),t}function o_(n){let t=s8(),r=t.matches[t.matches.length-1];return r.route.id||On(!1),r.route.id}function a8(){var n;let t=y.useContext(n_),r=n8(cm.UseRouteError),s=o_(cm.UseRouteError);return t!==void 0?t:(n=r.errors)==null?void 0:n[s]}function o8(){let{router:n}=r8(a_.UseNavigateStable),t=o_(cm.UseNavigateStable),r=y.useRef(!1);return s_(()=>{r.current=!0}),y.useCallback(function(a,o){o===void 0&&(o={}),r.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Wu({fromRouteId:t},o)))},[n,t])}const v1={};function i8(n,t,r){!t&&!v1[n]&&(v1[n]=!0)}function l8(n,t){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function no(n){let{to:t,replace:r,state:s,relative:a}=n;vh()||On(!1);let{future:o,static:i}=y.useContext(bh),{matches:l}=y.useContext(Jl),{pathname:c}=qi(),d=yn(),u=t_(t,e_(l,o.v7_relativeSplatPath),c,a==="path"),h=JSON.stringify(u);return y.useEffect(()=>d(JSON.parse(h),{replace:r,state:s,relative:a}),[d,h,a,r,s]),null}function Rr(n){On(!1)}function c8(n){let{basename:t="/",children:r=null,location:s,navigationType:a=ji.Pop,navigator:o,static:i=!1,future:l}=n;vh()&&On(!1);let c=t.replace(/^\/*/,"/"),d=y.useMemo(()=>({basename:c,navigator:o,static:i,future:Wu({v7_relativeSplatPath:!1},l)}),[c,l,o,i]);typeof s=="string"&&(s=Kl(s));let{pathname:u="/",search:h="",hash:p="",state:g=null,key:f="default"}=s,m=y.useMemo(()=>{let v=ZS(u,c);return v==null?null:{location:{pathname:v,search:h,hash:p,state:g,key:f},navigationType:a}},[c,u,h,p,g,f,a]);return m==null?null:y.createElement(bh.Provider,{value:d},y.createElement(nf.Provider,{children:r,value:m}))}function i_(n){let{children:t,location:r}=n;return KT(Z0(t),r)}new Promise(()=>{});function Z0(n,t){t===void 0&&(t=[]);let r=[];return y.Children.forEach(n,(s,a)=>{if(!y.isValidElement(s))return;let o=[...t,a];if(s.type===y.Fragment){r.push.apply(r,Z0(s.props.children,o));return}s.type!==Rr&&On(!1),!s.props.index||!s.props.children||On(!1);let i={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Z0(s.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ex(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((t,r)=>{let s=n[r];return t.concat(Array.isArray(s)?s.map(a=>[r,a]):[[r,s]])},[]))}function d8(n,t){let r=ex(n);return t&&t.forEach((s,a)=>{r.has(a)||t.getAll(a).forEach(o=>{r.append(a,o)})}),r}const u8="6";try{window.__reactRouterVersion=u8}catch{}const h8="startTransition",w1=u4[h8];function l_(n){let{basename:t,children:r,future:s,window:a}=n,o=y.useRef();o.current==null&&(o.current=jT({window:a,v5Compat:!0}));let i=o.current,[l,c]=y.useState({action:i.action,location:i.location}),{v7_startTransition:d}=s||{},u=y.useCallback(h=>{d&&w1?w1(()=>c(h)):c(h)},[c,d]);return y.useLayoutEffect(()=>i.listen(u),[i,u]),y.useEffect(()=>l8(s),[s]),y.createElement(c8,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:i,future:s})}var j1;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(j1||(j1={}));var S1;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(S1||(S1={}));function sb(n){let t=y.useRef(ex(n)),r=y.useRef(!1),s=qi(),a=y.useMemo(()=>d8(s.search,r.current?null:t.current),[s.search]),o=yn(),i=y.useCallback((l,c)=>{const d=ex(typeof l=="function"?l(a):l);r.current=!0,o("?"+d,c)},[o,a]);return[a,i]}function c_({gameType:n,size:t=22}){const r={"8 Ball":{emoji:""},"9 Ball":{color:"#FFD700",number:9},"10 Ball":{color:"#2196F3",number:10}};if(n==="8 Ball")return e.jsx("span",{role:"img","aria-label":"8-ball",style:{fontSize:t,verticalAlign:"middle",marginRight:4},children:r["8 Ball"].emoji});const{color:s,number:a}=r[n]||{};return!s||!a?null:e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:t,height:t,borderRadius:"50%",background:s,color:"#222",fontWeight:"bold",fontSize:t*.65,border:"2px solid #fff",boxShadow:"0 1px 2px #0003",marginRight:4,verticalAlign:"middle"},"aria-label":`${a}-ball`,children:a})}function Uo({open:n,onClose:t,children:r,title:s="Modal",maxWidth:a="800px",maxHeight:o=null,className:i="",borderColor:l="#e53e3e",textColor:c="#fff",glowColor:d="#e53e3e",style:u={},zIndex:h=1e5,containerSelector:p=null,fitContent:g=!1}){const[f,m]=y.useState({x:0,y:0}),[v,b]=y.useState(!1),[w,x]=y.useState(window.innerWidth<=768),j=y.useRef({x:0,y:0});y.useEffect(()=>{n&&(console.log(" Modal opening - resetting drag position to center"),m({x:0,y:0}))},[n]),y.useEffect(()=>{const D=()=>{x(window.innerWidth<=768)};return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[]);const S=D=>{b(!0),j.current={x:D.clientX-f.x,y:D.clientY-f.y},document.body.style.userSelect="none"},_=D=>{v&&m({x:D.clientX-j.current.x,y:D.clientY-j.current.y})},C=()=>{b(!1),document.body.style.userSelect=""};y.useEffect(()=>(v?(window.addEventListener("mousemove",_),window.addEventListener("mouseup",C)):(window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",C)),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",C)}),[v]);const[N,M]=y.useState(null);if(y.useEffect(()=>{if(n&&p){const D=document.querySelector(p);if(D){const T=()=>{const A=D.getBoundingClientRect();M({top:A.top,left:A.left,width:A.width,height:A.height})};return T(),window.addEventListener("resize",T),window.addEventListener("scroll",T,!0),()=>{window.removeEventListener("resize",T),window.removeEventListener("scroll",T,!0)}}}else M(null)},[n,p]),console.log(" DraggableModal: open prop is:",n),!n)return console.log(" DraggableModal: Not rendering because open is false"),null;console.log(" DraggableModal: Rendering modal because open is true");const E=N?{position:"fixed",top:`${N.top}px`,left:`${N.left}px`,width:`${N.width}px`,height:`${N.height}px`,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",padding:w?"10px":"20px",zIndex:h,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"}:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",padding:w?"10px":"20px",zIndex:h,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"},P=e.jsxs("div",{className:"modal-overlay",onClick:t,style:E,children:[e.jsxs("div",{className:`draggable-modal ${i}${g?" draggable-modal-fit-content":""}`,style:{transform:window.innerWidth<=768?"translate(-50%, -50%)":`translate(-50%, -50%) translate(${f.x}px, ${f.y}px)`,cursor:v?"grabbing":"default",background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:`2px solid ${l}`,borderRadius:window.innerWidth<=768?"0.5rem":"1.2rem",boxShadow:`0 0 32px ${d}, 0 0 40px rgba(0,0,0,0.85)`,width:window.innerWidth<=768?"95vw":(u.width||"800px")+" !important",maxWidth:window.innerWidth<=768?"95vw":u.maxWidth||a,minWidth:window.innerWidth<=768?"320px":"800px",maxHeight:window.innerWidth<=768?"90vh":u.maxHeight||o||"90vh",margin:"0",left:"50%",top:"50%",position:"fixed",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,fontFamily:"inherit",boxSizing:"border-box",height:g?u.height||"fit-content":u.height||o||(window.innerWidth<=768,"auto"),display:"flex",flexDirection:"column",...u},onClick:D=>D.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":s,tabIndex:-1,children:[e.jsxs("div",{className:"modal-header",onMouseDown:S,style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",background:l,padding:window.innerWidth<=768?"0.3rem 0.5rem":"0.4rem 0.6rem",borderTopLeftRadius:window.innerWidth<=768?"0.5rem":"1.2rem",borderTopRightRadius:window.innerWidth<=768?"0.5rem":"1.2rem",position:"relative",cursor:"grab",userSelect:"none",gap:window.innerWidth<=768?"0.3rem":"0.4rem"},children:[e.jsx("span",{className:"modal-accent-bar",style:{position:"absolute",left:0,top:0,width:"100%",height:"5px",background:`linear-gradient(90deg, #fff0 0%, ${l} 60%, #fff0 100%)`,borderTopLeftRadius:window.innerWidth<=768?"0.5rem":"1.2rem",borderTopRightRadius:window.innerWidth<=768?"0.5rem":"1.2rem",pointerEvents:"none"}}),e.jsx("h2",{className:"modal-title",style:{margin:0,fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0,color:c},children:s}),e.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close",style:{background:"none",border:"none",color:"#fff",fontSize:window.innerWidth<=768?"1.2em":"1.5em",fontWeight:"bold",cursor:"pointer",zIndex:10,alignSelf:"flex-start",marginTop:"0",lineHeight:1,transition:"color 0.2s, transform 0.2s",padding:0,marginLeft:"1rem"},onMouseEnter:D=>{D.target.style.color="#ffd6d6",D.target.style.transform="scale(1.2) rotate(10deg)"},onMouseLeave:D=>{D.target.style.color="#fff",D.target.style.transform="scale(1) rotate(0deg)"},children:""})]}),e.jsx("div",{className:"modal-content",style:{flex:g?"0 1 auto":"1 1 auto",minHeight:0,overflowY:"auto",padding:window.innerWidth<=768?"0.6rem 0.8rem 0.4rem 0.8rem":"0.8rem 1rem 0.6rem 1rem",background:"none"},children:r})]}),e.jsx("style",{children:`
        @keyframes modalBounceIn {
          0% { opacity: 0; transform: scale(0.95) translateY(-40px);}
          70% { opacity: 1; transform: scale(1.02) translateY(8px);}
          100% { opacity: 1; transform: scale(1) translateY(0);}
        }
        
        /* Force content to fill modal width */
        .draggable-modal form,
        .draggable-modal > div,
        .modal-content > * {
          width: 100% !important;
          max-width: 100% !important;
          box-sizing: border-box !important;
        }
        
        @media (max-width: 768px) {
          .modal-overlay {
            padding: 20px !important;
            align-items: center !important;
            justify-content: center !important;
          }
          .draggable-modal {
            max-width: 95vw !important;
            border-radius: 0.5rem !important;
            height: auto !important;
            max-height: 90vh !important;
          }
          .draggable-modal-fit-content {
            height: fit-content !important;
            max-height: min(280px, 90vh) !important;
            margin: 0 !important;
            left: 50% !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
            position: fixed !important;
          }
          .modal-header {
            padding: 0.5rem 0.5rem 0.3rem 0.5rem !important;
          }
          .modal-content {
            padding: 0.8rem 0.6rem 0.6rem 0.6rem !important;
            flex: 1 1 auto !important;
            min-height: 0 !important;
            overflow-y: auto !important;
            max-height: calc(90vh - 60px) !important;
          }
          .draggable-modal-fit-content .modal-content {
            flex: 0 1 auto !important;
          }
        }
        
        @media (max-width: 480px) {
          .modal-overlay {
            padding: 15px !important;
            align-items: center !important;
            justify-content: center !important;
          }
          .draggable-modal {
            max-width: 98vw !important;
            border-radius: 0.3rem !important;
            height: auto !important;
            max-height: 95vh !important;
            margin: 0 !important;
            left: 50% !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
            position: fixed !important;
          }
          .draggable-modal-fit-content {
            height: fit-content !important;
            max-height: min(280px, 95vh) !important;
          }
          .modal-content {
            max-height: calc(95vh - 50px) !important;
          }
          .modal-header {
            padding: 0.4rem 0.4rem 0.2rem 0.4rem !important;
          }
          .modal-content {
            padding: 0.6rem 0.5rem 0.5rem 0.5rem !important;
          }
        }
        /* Custom scrollbar for modal-content */
        .modal-content::-webkit-scrollbar {
          width: 10px;
        }
        .modal-content::-webkit-scrollbar-thumb {
          background: ${l};
          border-radius: 6px;
        }
        .modal-content::-webkit-scrollbar-track {
          background: #232323;
          border-radius: 6px;
        }
        .modal-content {
          scrollbar-width: thin;
          scrollbar-color: ${l} #232323;
        }
      `})]});return xr.createPortal(P,document.body)}function p8(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function m8({open:n,message:t,gameType:r,raceLength:s,day:a,date:o,time:i,location:l,proposalNote:c,confirmationNote:d,phase:u,onClose:h}){if(!n)return null;const p=typeof window<"u"&&window.innerWidth<=500,g=p?"100%":"240px",f=p?"90vw":"240px",m=p?"100%":"220px";return e.jsx(Uo,{open:n,onClose:h,title:"Proposal Sent!",maxWidth:f,width:g,children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{background:"#222",color:"#fff",borderRadius:6,padding:"0.6rem 0.7rem 0.6rem 0.7rem",margin:"0 auto 0.7rem auto",fontWeight:600,fontSize:"0.97rem",textAlign:"center",maxWidth:"220px",width:"100%",wordBreak:"break-word",whiteSpace:"pre-line"},children:t}),e.jsxs("div",{style:{background:"#f8f8f8",color:"#222",borderRadius:8,padding:p?"0.4rem 0.2rem":"0.5rem 0.5rem",margin:"0.7rem auto 0.7rem auto",textAlign:"center",fontSize:p?"0.92rem":"0.95rem",border:"1px solid #ff0000",maxWidth:m,width:"100%"},children:[e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Phase:"})," ",u==="scheduled"?"Phase 1 (Scheduled)":u==="challenge"?"Phase 2 (challenge)":u]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Game Type:"})," ",e.jsx(c_,{gameType:r,size:16})," ",r]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Race to:"})," ",s]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Day:"})," ",a]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Date:"})," ",p8(o)]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Time:"})," ",i]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Location:"})," ",l]}),c&&e.jsxs("div",{style:{marginTop:12,padding:"0.5rem 0.7rem",background:"#fffbe6",borderLeft:"3px solid #ffb300",borderRadius:4,color:"#a36c00",fontSize:"0.97rem"},children:[e.jsx("strong",{children:"Opponent's note:"})," ",c]}),d&&e.jsxs("div",{style:{marginTop:10,padding:"0.5rem 0.7rem",background:"#e6fff0",borderLeft:"3px solid #00b36b",borderRadius:4,color:"#006b3c",fontSize:"0.97rem"},children:[e.jsx("strong",{children:"Your note:"})," ",d]})]}),e.jsx("button",{style:{marginTop:"1.8rem",background:"#ff0000",color:"#fff",border:"none",borderRadius:"8px",padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer"},onClick:h,children:"Close"})]})})}var d_={exports:{}},f8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",g8=f8,x8=g8;function u_(){}function h_(){}h_.resetWarningCache=u_;var y8=function(){function n(s,a,o,i,l,c){if(c!==x8){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function t(){return n}var r={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:t,element:n,elementType:n,instanceOf:t,node:n,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:h_,resetWarningCache:u_};return r.PropTypes=r,r};d_.exports=y8();var b8=d_.exports;const ee=Jo(b8);var p_={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var t={}.hasOwnProperty;function r(){for(var o="",i=0;i<arguments.length;i++){var l=arguments[i];l&&(o=a(o,s(l)))}return o}function s(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return r.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var i="";for(var l in o)t.call(o,l)&&o[l]&&(i=a(i,l));return i}function a(o,i){return i?o?o+" "+i:o+i:o}n.exports?(r.default=r,n.exports=r):window.classNames=r})()})(p_);var v8=p_.exports;const ds=Jo(v8);function _n(n){"@babel/helpers - typeof";return _n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(n)}function bt(n,t){if(t.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+t.length+" present")}function sf(n){return bt(1,arguments),n instanceof Date||_n(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function Pt(n){bt(1,arguments);var t=Object.prototype.toString.call(n);return n instanceof Date||_n(n)==="object"&&t==="[object Date]"?new Date(n.getTime()):typeof n=="number"||t==="[object Number]"?new Date(n):((typeof n=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Uu(n){if(bt(1,arguments),!sf(n)&&typeof n!="number")return!1;var t=Pt(n);return!isNaN(Number(t))}function gr(n){if(n===null||n===!0||n===!1)return NaN;var t=Number(n);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function ab(n,t){bt(2,arguments);var r=Pt(n).getTime(),s=gr(t);return new Date(r+s)}function m_(n,t){bt(2,arguments);var r=gr(t);return ab(n,-r)}var w8=864e5;function j8(n){bt(1,arguments);var t=Pt(n),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var s=t.getTime(),a=r-s;return Math.floor(a/w8)+1}function cd(n){bt(1,arguments);var t=1,r=Pt(n),s=r.getUTCDay(),a=(s<t?7:0)+s-t;return r.setUTCDate(r.getUTCDate()-a),r.setUTCHours(0,0,0,0),r}function f_(n){bt(1,arguments);var t=Pt(n),r=t.getUTCFullYear(),s=new Date(0);s.setUTCFullYear(r+1,0,4),s.setUTCHours(0,0,0,0);var a=cd(s),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var i=cd(o);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function S8(n){bt(1,arguments);var t=f_(n),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var s=cd(r);return s}var _8=6048e5;function g_(n){bt(1,arguments);var t=Pt(n),r=cd(t).getTime()-S8(t).getTime();return Math.round(r/_8)+1}var k8={};function Xl(){return k8}function zl(n,t){var r,s,a,o,i,l,c,d;bt(1,arguments);var u=Xl(),h=gr((r=(s=(a=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&s!==void 0?s:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=Pt(n),g=p.getUTCDay(),f=(g<h?7:0)+g-h;return p.setUTCDate(p.getUTCDate()-f),p.setUTCHours(0,0,0,0),p}function ob(n,t){var r,s,a,o,i,l,c,d;bt(1,arguments);var u=Pt(n),h=u.getUTCFullYear(),p=Xl(),g=gr((r=(s=(a=(o=t==null?void 0:t.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:p.firstWeekContainsDate)!==null&&s!==void 0?s:(c=p.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(g>=1&&g<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setUTCFullYear(h+1,0,g),f.setUTCHours(0,0,0,0);var m=zl(f,t),v=new Date(0);v.setUTCFullYear(h,0,g),v.setUTCHours(0,0,0,0);var b=zl(v,t);return u.getTime()>=m.getTime()?h+1:u.getTime()>=b.getTime()?h:h-1}function C8(n,t){var r,s,a,o,i,l,c,d;bt(1,arguments);var u=Xl(),h=gr((r=(s=(a=(o=t==null?void 0:t.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&s!==void 0?s:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),p=ob(n,t),g=new Date(0);g.setUTCFullYear(p,0,h),g.setUTCHours(0,0,0,0);var f=zl(g,t);return f}var N8=6048e5;function x_(n,t){bt(1,arguments);var r=Pt(n),s=zl(r,t).getTime()-C8(r,t).getTime();return Math.round(s/N8)+1}function Mr(n,t){for(var r=n<0?"-":"",s=Math.abs(n).toString();s.length<t;)s="0"+s;return r+s}var T8={y:function(t,r){var s=t.getUTCFullYear(),a=s>0?s:1-s;return Mr(r==="yy"?a%100:a,r.length)},M:function(t,r){var s=t.getUTCMonth();return r==="M"?String(s+1):Mr(s+1,2)},d:function(t,r){return Mr(t.getUTCDate(),r.length)},a:function(t,r){var s=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h:function(t,r){return Mr(t.getUTCHours()%12||12,r.length)},H:function(t,r){return Mr(t.getUTCHours(),r.length)},m:function(t,r){return Mr(t.getUTCMinutes(),r.length)},s:function(t,r){return Mr(t.getUTCSeconds(),r.length)},S:function(t,r){var s=r.length,a=t.getUTCMilliseconds(),o=Math.floor(a*Math.pow(10,s-3));return Mr(o,r.length)}};const ri=T8;var ac={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},P8={G:function(t,r,s){var a=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(a,{width:"abbreviated"});case"GGGGG":return s.era(a,{width:"narrow"});case"GGGG":default:return s.era(a,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){var a=t.getUTCFullYear(),o=a>0?a:1-a;return s.ordinalNumber(o,{unit:"year"})}return ri.y(t,r)},Y:function(t,r,s,a){var o=ob(t,a),i=o>0?o:1-o;if(r==="YY"){var l=i%100;return Mr(l,2)}return r==="Yo"?s.ordinalNumber(i,{unit:"year"}):Mr(i,r.length)},R:function(t,r){var s=f_(t);return Mr(s,r.length)},u:function(t,r){var s=t.getUTCFullYear();return Mr(s,r.length)},Q:function(t,r,s){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return Mr(a,2);case"Qo":return s.ordinalNumber(a,{unit:"quarter"});case"QQQ":return s.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,s){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return Mr(a,2);case"qo":return s.ordinalNumber(a,{unit:"quarter"});case"qqq":return s.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,s){var a=t.getUTCMonth();switch(r){case"M":case"MM":return ri.M(t,r);case"Mo":return s.ordinalNumber(a+1,{unit:"month"});case"MMM":return s.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,s){var a=t.getUTCMonth();switch(r){case"L":return String(a+1);case"LL":return Mr(a+1,2);case"Lo":return s.ordinalNumber(a+1,{unit:"month"});case"LLL":return s.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,s,a){var o=x_(t,a);return r==="wo"?s.ordinalNumber(o,{unit:"week"}):Mr(o,r.length)},I:function(t,r,s){var a=g_(t);return r==="Io"?s.ordinalNumber(a,{unit:"week"}):Mr(a,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getUTCDate(),{unit:"date"}):ri.d(t,r)},D:function(t,r,s){var a=j8(t);return r==="Do"?s.ordinalNumber(a,{unit:"dayOfYear"}):Mr(a,r.length)},E:function(t,r,s){var a=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return s.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(a,{width:"short",context:"formatting"});case"EEEE":default:return s.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,s,a){var o=t.getUTCDay(),i=(o-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return Mr(i,2);case"eo":return s.ordinalNumber(i,{unit:"day"});case"eee":return s.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(o,{width:"short",context:"formatting"});case"eeee":default:return s.day(o,{width:"wide",context:"formatting"})}},c:function(t,r,s,a){var o=t.getUTCDay(),i=(o-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return Mr(i,r.length);case"co":return s.ordinalNumber(i,{unit:"day"});case"ccc":return s.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(o,{width:"narrow",context:"standalone"});case"cccccc":return s.day(o,{width:"short",context:"standalone"});case"cccc":default:return s.day(o,{width:"wide",context:"standalone"})}},i:function(t,r,s){var a=t.getUTCDay(),o=a===0?7:a;switch(r){case"i":return String(o);case"ii":return Mr(o,r.length);case"io":return s.ordinalNumber(o,{unit:"day"});case"iii":return s.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(a,{width:"short",context:"formatting"});case"iiii":default:return s.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,s){var a=t.getUTCHours(),o=a/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,r,s){var a=t.getUTCHours(),o;switch(a===12?o=ac.noon:a===0?o=ac.midnight:o=a/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,r,s){var a=t.getUTCHours(),o;switch(a>=17?o=ac.evening:a>=12?o=ac.afternoon:a>=4?o=ac.morning:o=ac.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),s.ordinalNumber(a,{unit:"hour"})}return ri.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getUTCHours(),{unit:"hour"}):ri.H(t,r)},K:function(t,r,s){var a=t.getUTCHours()%12;return r==="Ko"?s.ordinalNumber(a,{unit:"hour"}):Mr(a,r.length)},k:function(t,r,s){var a=t.getUTCHours();return a===0&&(a=24),r==="ko"?s.ordinalNumber(a,{unit:"hour"}):Mr(a,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):ri.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):ri.s(t,r)},S:function(t,r){return ri.S(t,r)},X:function(t,r,s,a){var o=a._originalDate||t,i=o.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return k1(i);case"XXXX":case"XX":return dl(i);case"XXXXX":case"XXX":default:return dl(i,":")}},x:function(t,r,s,a){var o=a._originalDate||t,i=o.getTimezoneOffset();switch(r){case"x":return k1(i);case"xxxx":case"xx":return dl(i);case"xxxxx":case"xxx":default:return dl(i,":")}},O:function(t,r,s,a){var o=a._originalDate||t,i=o.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+_1(i,":");case"OOOO":default:return"GMT"+dl(i,":")}},z:function(t,r,s,a){var o=a._originalDate||t,i=o.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+_1(i,":");case"zzzz":default:return"GMT"+dl(i,":")}},t:function(t,r,s,a){var o=a._originalDate||t,i=Math.floor(o.getTime()/1e3);return Mr(i,r.length)},T:function(t,r,s,a){var o=a._originalDate||t,i=o.getTime();return Mr(i,r.length)}};function _1(n,t){var r=n>0?"-":"+",s=Math.abs(n),a=Math.floor(s/60),o=s%60;if(o===0)return r+String(a);var i=t||"";return r+String(a)+i+Mr(o,2)}function k1(n,t){if(n%60===0){var r=n>0?"-":"+";return r+Mr(Math.abs(n)/60,2)}return dl(n,t)}function dl(n,t){var r=t||"",s=n>0?"-":"+",a=Math.abs(n),o=Mr(Math.floor(a/60),2),i=Mr(a%60,2);return s+o+r+i}const E8=P8;var C1=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},y_=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},R8=function(t,r){var s=t.match(/(P+)(p+)?/)||[],a=s[1],o=s[2];if(!o)return C1(t,r);var i;switch(a){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",C1(a,r)).replace("{{time}}",y_(o,r))},A8={p:y_,P:R8};const tx=A8;function dm(n){var t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),n.getTime()-t.getTime()}var M8=["D","DD"],I8=["YY","YYYY"];function b_(n){return M8.indexOf(n)!==-1}function v_(n){return I8.indexOf(n)!==-1}function um(n,t,r){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var D8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$8=function(t,r,s){var a,o=D8[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};const L8=$8;function ag(n){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):n.defaultWidth,s=n.formats[r]||n.formats[n.defaultWidth];return s}}var B8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},O8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},z8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},F8={date:ag({formats:B8,defaultWidth:"full"}),time:ag({formats:O8,defaultWidth:"full"}),dateTime:ag({formats:z8,defaultWidth:"full"})};const W8=F8;var U8={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},q8=function(t,r,s,a){return U8[t]};const H8=q8;function $d(n){return function(t,r){var s=r!=null&&r.context?String(r.context):"standalone",a;if(s==="formatting"&&n.formattingValues){var o=n.defaultFormattingWidth||n.defaultWidth,i=r!=null&&r.width?String(r.width):o;a=n.formattingValues[i]||n.formattingValues[o]}else{var l=n.defaultWidth,c=r!=null&&r.width?String(r.width):n.defaultWidth;a=n.values[c]||n.values[l]}var d=n.argumentCallback?n.argumentCallback(t):t;return a[d]}}var Y8={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},G8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},V8={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},K8={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},J8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},X8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Q8=function(t,r){var s=Number(t),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},Z8={ordinalNumber:Q8,era:$d({values:Y8,defaultWidth:"wide"}),quarter:$d({values:G8,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:$d({values:V8,defaultWidth:"wide"}),day:$d({values:K8,defaultWidth:"wide"}),dayPeriod:$d({values:J8,defaultWidth:"wide",formattingValues:X8,defaultFormattingWidth:"wide"})};const eP=Z8;function Ld(n){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.width,a=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],o=t.match(a);if(!o)return null;var i=o[0],l=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?rP(l,function(h){return h.test(i)}):tP(l,function(h){return h.test(i)}),d;d=n.valueCallback?n.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(i.length);return{value:d,rest:u}}}function tP(n,t){for(var r in n)if(n.hasOwnProperty(r)&&t(n[r]))return r}function rP(n,t){for(var r=0;r<n.length;r++)if(t(n[r]))return r}function nP(n){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.match(n.matchPattern);if(!s)return null;var a=s[0],o=t.match(n.parsePattern);if(!o)return null;var i=n.valueCallback?n.valueCallback(o[0]):o[0];i=r.valueCallback?r.valueCallback(i):i;var l=t.slice(a.length);return{value:i,rest:l}}}var sP=/^(\d+)(th|st|nd|rd)?/i,aP=/\d+/i,oP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},iP={any:[/^b/i,/^(a|c)/i]},lP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cP={any:[/1/i,/2/i,/3/i,/4/i]},dP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},fP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gP={ordinalNumber:nP({matchPattern:sP,parsePattern:aP,valueCallback:function(t){return parseInt(t,10)}}),era:Ld({matchPatterns:oP,defaultMatchWidth:"wide",parsePatterns:iP,defaultParseWidth:"any"}),quarter:Ld({matchPatterns:lP,defaultMatchWidth:"wide",parsePatterns:cP,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ld({matchPatterns:dP,defaultMatchWidth:"wide",parsePatterns:uP,defaultParseWidth:"any"}),day:Ld({matchPatterns:hP,defaultMatchWidth:"wide",parsePatterns:pP,defaultParseWidth:"any"}),dayPeriod:Ld({matchPatterns:mP,defaultMatchWidth:"any",parsePatterns:fP,defaultParseWidth:"any"})};const xP=gP;var yP={code:"en-US",formatDistance:L8,formatLong:W8,formatRelative:H8,localize:eP,match:xP,options:{weekStartsOn:0,firstWeekContainsDate:1}};const w_=yP;var bP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,wP=/^'([^]*?)'?$/,jP=/''/g,SP=/[a-zA-Z]/;function As(n,t,r){var s,a,o,i,l,c,d,u,h,p,g,f,m,v,b,w,x,j;bt(2,arguments);var S=String(t),_=Xl(),C=(s=(a=r==null?void 0:r.locale)!==null&&a!==void 0?a:_.locale)!==null&&s!==void 0?s:w_,N=gr((o=(i=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:_.firstWeekContainsDate)!==null&&i!==void 0?i:(h=_.locale)===null||h===void 0||(p=h.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(N>=1&&N<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=gr((g=(f=(m=(v=r==null?void 0:r.weekStartsOn)!==null&&v!==void 0?v:r==null||(b=r.locale)===null||b===void 0||(w=b.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&m!==void 0?m:_.weekStartsOn)!==null&&f!==void 0?f:(x=_.locale)===null||x===void 0||(j=x.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&g!==void 0?g:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var E=Pt(n);if(!Uu(E))throw new RangeError("Invalid time value");var P=dm(E),D=m_(E,P),T={firstWeekContainsDate:N,weekStartsOn:M,locale:C,_originalDate:E},A=S.match(vP).map(function(k){var R=k[0];if(R==="p"||R==="P"){var U=tx[R];return U(k,C.formatLong)}return k}).join("").match(bP).map(function(k){if(k==="''")return"'";var R=k[0];if(R==="'")return _P(k);var U=E8[R];if(U)return!(r!=null&&r.useAdditionalWeekYearTokens)&&v_(k)&&um(k,t,String(n)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&b_(k)&&um(k,t,String(n)),U(D,k,C.localize,T);if(R.match(SP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+R+"`");return k}).join("");return A}function _P(n){var t=n.match(wP);return t?t[1].replace(jP,"'"):n}var kP=6e4;function rx(n,t){bt(2,arguments);var r=gr(t);return ab(n,r*kP)}var CP=36e5;function NP(n,t){bt(2,arguments);var r=gr(t);return ab(n,r*CP)}function jd(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);return isNaN(s)?new Date(NaN):(s&&r.setDate(r.getDate()+s),r)}function hm(n,t){bt(2,arguments);var r=gr(t),s=r*7;return jd(n,s)}function Va(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);if(isNaN(s))return new Date(NaN);if(!s)return r;var a=r.getDate(),o=new Date(r.getTime());o.setMonth(r.getMonth()+s+1,0);var i=o.getDate();return a>=i?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function j_(n,t){bt(2,arguments);var r=gr(t),s=r*3;return Va(n,s)}function dd(n,t){bt(2,arguments);var r=gr(t);return Va(n,r*12)}function TP(n,t){bt(2,arguments);var r=gr(t);return jd(n,-r)}function N1(n,t){bt(2,arguments);var r=gr(t);return hm(n,-r)}function ud(n,t){bt(2,arguments);var r=gr(t);return Va(n,-r)}function PP(n,t){bt(2,arguments);var r=gr(t);return j_(n,-r)}function qu(n,t){bt(2,arguments);var r=gr(t);return dd(n,-r)}function T1(n){bt(1,arguments);var t=Pt(n),r=t.getSeconds();return r}function go(n){bt(1,arguments);var t=Pt(n),r=t.getMinutes();return r}function xo(n){bt(1,arguments);var t=Pt(n),r=t.getHours();return r}function EP(n){bt(1,arguments);var t=Pt(n),r=t.getDay();return r}function P1(n){bt(1,arguments);var t=Pt(n),r=t.getDate();return r}function S_(n,t){var r,s,a,o,i,l,c,d;bt(1,arguments);var u=Xl(),h=gr((r=(s=(a=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&s!==void 0?s:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=Pt(n),g=p.getDay(),f=(g<h?7:0)+g-h;return p.setDate(p.getDate()-f),p.setHours(0,0,0,0),p}function pm(n){return bt(1,arguments),S_(n,{weekStartsOn:1})}function RP(n){bt(1,arguments);var t=Pt(n),r=t.getFullYear(),s=new Date(0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);var a=pm(s),o=new Date(0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);var i=pm(o);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function AP(n){bt(1,arguments);var t=RP(n),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var s=pm(r);return s}var MP=6048e5;function IP(n){bt(1,arguments);var t=Pt(n),r=pm(t).getTime()-AP(t).getTime();return Math.round(r/MP)+1}function ws(n){bt(1,arguments);var t=Pt(n),r=t.getMonth();return r}function Fc(n){bt(1,arguments);var t=Pt(n),r=Math.floor(t.getMonth()/3)+1;return r}function br(n){return bt(1,arguments),Pt(n).getFullYear()}function nx(n){bt(1,arguments);var t=Pt(n),r=t.getTime();return r}function DP(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);return r.setSeconds(s),r}function Cp(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);return r.setMinutes(s),r}function Np(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);return r.setHours(s),r}function $P(n){bt(1,arguments);var t=Pt(n),r=t.getFullYear(),s=t.getMonth(),a=new Date(0);return a.setFullYear(r,s+1,0),a.setHours(0,0,0,0),a.getDate()}function Rs(n,t){bt(2,arguments);var r=Pt(n),s=gr(t),a=r.getFullYear(),o=r.getDate(),i=new Date(0);i.setFullYear(a,s,15),i.setHours(0,0,0,0);var l=$P(i);return r.setMonth(s,Math.min(o,l)),r}function oc(n,t){bt(2,arguments);var r=Pt(n),s=gr(t),a=Math.floor(r.getMonth()/3)+1,o=s-a;return Rs(r,r.getMonth()+o*3)}function Lo(n,t){bt(2,arguments);var r=Pt(n),s=gr(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(s),r)}function E1(n){bt(1,arguments);var t;if(n&&typeof n.forEach=="function")t=n;else if(_n(n)==="object"&&n!==null)t=Array.prototype.slice.call(n);else return new Date(NaN);var r;return t.forEach(function(s){var a=Pt(s);(r===void 0||r>a||isNaN(a.getDate()))&&(r=a)}),r||new Date(NaN)}function R1(n){bt(1,arguments);var t;if(n&&typeof n.forEach=="function")t=n;else if(_n(n)==="object"&&n!==null)t=Array.prototype.slice.call(n);else return new Date(NaN);var r;return t.forEach(function(s){var a=Pt(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}function yo(n){bt(1,arguments);var t=Pt(n);return t.setHours(0,0,0,0),t}var LP=864e5;function Hu(n,t){bt(2,arguments);var r=yo(n),s=yo(t),a=r.getTime()-dm(r),o=s.getTime()-dm(s);return Math.round((a-o)/LP)}function mm(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t),a=r.getFullYear()-s.getFullYear(),o=r.getMonth()-s.getMonth();return a*12+o}function fm(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getFullYear()-s.getFullYear()}function __(n){bt(1,arguments);var t=Pt(n);return t.setDate(1),t.setHours(0,0,0,0),t}function sx(n){bt(1,arguments);var t=Pt(n),r=t.getMonth(),s=r-r%3;return t.setMonth(s,1),t.setHours(0,0,0,0),t}function k_(n){bt(1,arguments);var t=Pt(n),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function ax(n){bt(1,arguments);var t=Pt(n);return t.setHours(23,59,59,999),t}function BP(n){bt(1,arguments);var t=Pt(n),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function OP(n){bt(1,arguments);var t=Pt(n),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function zP(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getTime()===s.getTime()}function FP(n,t){bt(2,arguments);var r=yo(n),s=yo(t);return r.getTime()===s.getTime()}function WP(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function UP(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getFullYear()===s.getFullYear()}function qP(n,t){bt(2,arguments);var r=sx(n),s=sx(t);return r.getTime()===s.getTime()}function Vo(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getTime()>s.getTime()}function Si(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t);return r.getTime()<s.getTime()}function Yu(n,t){bt(2,arguments);var r=Pt(n).getTime(),s=Pt(t.start).getTime(),a=Pt(t.end).getTime();if(!(s<=a))throw new RangeError("Invalid interval");return r>=s&&r<=a}function ox(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=Array(t);r<t;r++)s[r]=n[r];return s}function ib(n,t){if(n){if(typeof n=="string")return ox(n,t);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ox(n,t):void 0}}function A1(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=ib(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,i=!0,l=!1;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return i=d.done,d},e:function(d){l=!0,o=d},f:function(){try{i||r.return==null||r.return()}finally{if(l)throw o}}}}function HP(n,t){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function Et(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Gu(n,t){return Gu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Gu(n,t)}function _r(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&Gu(n,t)}function Fl(n){return Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fl(n)}function lb(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lb=function(){return!!n})()}function C_(n,t){if(t&&(_n(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Et(n)}function Nr(n){var t=lb();return function(){var r,s=Fl(n);if(t){var a=Fl(this).constructor;r=Reflect.construct(s,arguments,a)}else r=s.apply(this,arguments);return C_(this,r)}}function Vt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function YP(n,t){if(_n(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_n(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function N_(n){var t=YP(n,"string");return _n(t)=="symbol"?t:t+""}function M1(n,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,N_(s.key),s)}}function sr(n,t,r){return t&&M1(n.prototype,t),r&&M1(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function q(n,t,r){return(t=N_(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}var GP=10,T_=function(){function n(){Vt(this,n),q(this,"priority",void 0),q(this,"subPriority",0)}return sr(n,[{key:"validate",value:function(r,s){return!0}}]),n}(),VP=function(n){_r(r,n);var t=Nr(r);function r(s,a,o,i,l){var c;return Vt(this,r),c=t.call(this),c.value=s,c.validateValue=a,c.setValue=o,c.priority=i,l&&(c.subPriority=l),c}return sr(r,[{key:"validate",value:function(a,o){return this.validateValue(a,this.value,o)}},{key:"set",value:function(a,o,i){return this.setValue(a,o,this.value,i)}}]),r}(T_),KP=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",GP),q(Et(s),"subPriority",-1),s}return sr(r,[{key:"set",value:function(a,o){if(o.timestampIsSet)return a;var i=new Date(0);return i.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),i.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),i}}]),r}(T_),Tr=function(){function n(){Vt(this,n),q(this,"incompatibleTokens",void 0),q(this,"priority",void 0),q(this,"subPriority",void 0)}return sr(n,[{key:"run",value:function(r,s,a,o){var i=this.parse(r,s,a,o);return i?{setter:new VP(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}},{key:"validate",value:function(r,s,a){return!0}}]),n}(),JP=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",140),q(Et(s),"incompatibleTokens",["R","u","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"G":case"GG":case"GGG":return i.era(a,{width:"abbreviated"})||i.era(a,{width:"narrow"});case"GGGGG":return i.era(a,{width:"narrow"});case"GGGG":default:return i.era(a,{width:"wide"})||i.era(a,{width:"abbreviated"})||i.era(a,{width:"narrow"})}}},{key:"set",value:function(a,o,i){return o.era=i,a.setUTCFullYear(i,0,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),cb=6e4,af=36e5,XP=1e3,En={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},uo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Rn(n,t){return n&&{value:t(n.value),rest:n.rest}}function fn(n,t){var r=t.match(n);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function ho(n,t){var r=t.match(n);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};var s=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,o=r[3]?parseInt(r[3],10):0,i=r[5]?parseInt(r[5],10):0;return{value:s*(a*af+o*cb+i*XP),rest:t.slice(r[0].length)}}function P_(n){return fn(En.anyDigitsSigned,n)}function kn(n,t){switch(n){case 1:return fn(En.singleDigit,t);case 2:return fn(En.twoDigits,t);case 3:return fn(En.threeDigits,t);case 4:return fn(En.fourDigits,t);default:return fn(new RegExp("^\\d{1,"+n+"}"),t)}}function gm(n,t){switch(n){case 1:return fn(En.singleDigitSigned,t);case 2:return fn(En.twoDigitsSigned,t);case 3:return fn(En.threeDigitsSigned,t);case 4:return fn(En.fourDigitsSigned,t);default:return fn(new RegExp("^-?\\d{1,"+n+"}"),t)}}function db(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function E_(n,t){var r=t>0,s=r?t:1-t,a;if(s<=50)a=n||100;else{var o=s+50,i=Math.floor(o/100)*100,l=n>=o%100;a=n+i-(l?100:0)}return r?a:1-a}function R_(n){return n%400===0||n%4===0&&n%100!==0}var QP=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",130),q(Et(s),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){var l=function(d){return{year:d,isTwoDigitYear:o==="yy"}};switch(o){case"y":return Rn(kn(4,a),l);case"yo":return Rn(i.ordinalNumber(a,{unit:"year"}),l);default:return Rn(kn(o.length,a),l)}}},{key:"validate",value:function(a,o){return o.isTwoDigitYear||o.year>0}},{key:"set",value:function(a,o,i){var l=a.getUTCFullYear();if(i.isTwoDigitYear){var c=E_(i.year,l);return a.setUTCFullYear(c,0,1),a.setUTCHours(0,0,0,0),a}var d=!("era"in o)||o.era===1?i.year:1-i.year;return a.setUTCFullYear(d,0,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),ZP=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",130),q(Et(s),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){var l=function(d){return{year:d,isTwoDigitYear:o==="YY"}};switch(o){case"Y":return Rn(kn(4,a),l);case"Yo":return Rn(i.ordinalNumber(a,{unit:"year"}),l);default:return Rn(kn(o.length,a),l)}}},{key:"validate",value:function(a,o){return o.isTwoDigitYear||o.year>0}},{key:"set",value:function(a,o,i,l){var c=ob(a,l);if(i.isTwoDigitYear){var d=E_(i.year,c);return a.setUTCFullYear(d,0,l.firstWeekContainsDate),a.setUTCHours(0,0,0,0),zl(a,l)}var u=!("era"in o)||o.era===1?i.year:1-i.year;return a.setUTCFullYear(u,0,l.firstWeekContainsDate),a.setUTCHours(0,0,0,0),zl(a,l)}}]),r}(Tr),e6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",130),q(Et(s),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o){return gm(o==="R"?4:o.length,a)}},{key:"set",value:function(a,o,i){var l=new Date(0);return l.setUTCFullYear(i,0,4),l.setUTCHours(0,0,0,0),cd(l)}}]),r}(Tr),t6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",130),q(Et(s),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o){return gm(o==="u"?4:o.length,a)}},{key:"set",value:function(a,o,i){return a.setUTCFullYear(i,0,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),r6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",120),q(Et(s),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"Q":case"QQ":return kn(o.length,a);case"Qo":return i.ordinalNumber(a,{unit:"quarter"});case"QQQ":return i.quarter(a,{width:"abbreviated",context:"formatting"})||i.quarter(a,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(a,{width:"wide",context:"formatting"})||i.quarter(a,{width:"abbreviated",context:"formatting"})||i.quarter(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,o){return o>=1&&o<=4}},{key:"set",value:function(a,o,i){return a.setUTCMonth((i-1)*3,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),n6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",120),q(Et(s),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"q":case"qq":return kn(o.length,a);case"qo":return i.ordinalNumber(a,{unit:"quarter"});case"qqq":return i.quarter(a,{width:"abbreviated",context:"standalone"})||i.quarter(a,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(a,{width:"wide",context:"standalone"})||i.quarter(a,{width:"abbreviated",context:"standalone"})||i.quarter(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,o){return o>=1&&o<=4}},{key:"set",value:function(a,o,i){return a.setUTCMonth((i-1)*3,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),s6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),q(Et(s),"priority",110),s}return sr(r,[{key:"parse",value:function(a,o,i){var l=function(d){return d-1};switch(o){case"M":return Rn(fn(En.month,a),l);case"MM":return Rn(kn(2,a),l);case"Mo":return Rn(i.ordinalNumber(a,{unit:"month"}),l);case"MMM":return i.month(a,{width:"abbreviated",context:"formatting"})||i.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(a,{width:"wide",context:"formatting"})||i.month(a,{width:"abbreviated",context:"formatting"})||i.month(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,o){return o>=0&&o<=11}},{key:"set",value:function(a,o,i){return a.setUTCMonth(i,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),a6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",110),q(Et(s),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){var l=function(d){return d-1};switch(o){case"L":return Rn(fn(En.month,a),l);case"LL":return Rn(kn(2,a),l);case"Lo":return Rn(i.ordinalNumber(a,{unit:"month"}),l);case"LLL":return i.month(a,{width:"abbreviated",context:"standalone"})||i.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(a,{width:"wide",context:"standalone"})||i.month(a,{width:"abbreviated",context:"standalone"})||i.month(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,o){return o>=0&&o<=11}},{key:"set",value:function(a,o,i){return a.setUTCMonth(i,1),a.setUTCHours(0,0,0,0),a}}]),r}(Tr);function o6(n,t,r){bt(2,arguments);var s=Pt(n),a=gr(t),o=x_(s,r)-a;return s.setUTCDate(s.getUTCDate()-o*7),s}var i6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",100),q(Et(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"w":return fn(En.week,a);case"wo":return i.ordinalNumber(a,{unit:"week"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=1&&o<=53}},{key:"set",value:function(a,o,i,l){return zl(o6(a,i,l),l)}}]),r}(Tr);function l6(n,t){bt(2,arguments);var r=Pt(n),s=gr(t),a=g_(r)-s;return r.setUTCDate(r.getUTCDate()-a*7),r}var c6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",100),q(Et(s),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"I":return fn(En.week,a);case"Io":return i.ordinalNumber(a,{unit:"week"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=1&&o<=53}},{key:"set",value:function(a,o,i){return cd(l6(a,i))}}]),r}(Tr),d6=[31,28,31,30,31,30,31,31,30,31,30,31],u6=[31,29,31,30,31,30,31,31,30,31,30,31],h6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"subPriority",1),q(Et(s),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"d":return fn(En.date,a);case"do":return i.ordinalNumber(a,{unit:"date"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){var i=a.getUTCFullYear(),l=R_(i),c=a.getUTCMonth();return l?o>=1&&o<=u6[c]:o>=1&&o<=d6[c]}},{key:"set",value:function(a,o,i){return a.setUTCDate(i),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),p6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"subpriority",1),q(Et(s),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"D":case"DD":return fn(En.dayOfYear,a);case"Do":return i.ordinalNumber(a,{unit:"date"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){var i=a.getUTCFullYear(),l=R_(i);return l?o>=1&&o<=366:o>=1&&o<=365}},{key:"set",value:function(a,o,i){return a.setUTCMonth(0,i),a.setUTCHours(0,0,0,0),a}}]),r}(Tr);function ub(n,t,r){var s,a,o,i,l,c,d,u;bt(2,arguments);var h=Xl(),p=gr((s=(a=(o=(i=r==null?void 0:r.weekStartsOn)!==null&&i!==void 0?i:r==null||(l=r.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&o!==void 0?o:h.weekStartsOn)!==null&&a!==void 0?a:(d=h.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&s!==void 0?s:0);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=Pt(n),f=gr(t),m=g.getUTCDay(),v=f%7,b=(v+7)%7,w=(b<p?7:0)+f-m;return g.setUTCDate(g.getUTCDate()+w),g}var m6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"incompatibleTokens",["D","i","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"E":case"EE":case"EEE":return i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(a,{width:"wide",context:"formatting"})||i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,o){return o>=0&&o<=6}},{key:"set",value:function(a,o,i,l){return a=ub(a,i,l),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),f6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i,l){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+l.weekStartsOn+6)%7+h};switch(o){case"e":case"ee":return Rn(kn(o.length,a),c);case"eo":return Rn(i.ordinalNumber(a,{unit:"day"}),c);case"eee":return i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"});case"eeeee":return i.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(a,{width:"wide",context:"formatting"})||i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,o){return o>=0&&o<=6}},{key:"set",value:function(a,o,i,l){return a=ub(a,i,l),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),g6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i,l){var c=function(u){var h=Math.floor((u-1)/7)*7;return(u+l.weekStartsOn+6)%7+h};switch(o){case"c":case"cc":return Rn(kn(o.length,a),c);case"co":return Rn(i.ordinalNumber(a,{unit:"day"}),c);case"ccc":return i.day(a,{width:"abbreviated",context:"standalone"})||i.day(a,{width:"short",context:"standalone"})||i.day(a,{width:"narrow",context:"standalone"});case"ccccc":return i.day(a,{width:"narrow",context:"standalone"});case"cccccc":return i.day(a,{width:"short",context:"standalone"})||i.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(a,{width:"wide",context:"standalone"})||i.day(a,{width:"abbreviated",context:"standalone"})||i.day(a,{width:"short",context:"standalone"})||i.day(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,o){return o>=0&&o<=6}},{key:"set",value:function(a,o,i,l){return a=ub(a,i,l),a.setUTCHours(0,0,0,0),a}}]),r}(Tr);function x6(n,t){bt(2,arguments);var r=gr(t);r%7===0&&(r=r-7);var s=1,a=Pt(n),o=a.getUTCDay(),i=r%7,l=(i+7)%7,c=(l<s?7:0)+r-o;return a.setUTCDate(a.getUTCDate()+c),a}var y6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",90),q(Et(s),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){var l=function(d){return d===0?7:d};switch(o){case"i":case"ii":return kn(o.length,a);case"io":return i.ordinalNumber(a,{unit:"day"});case"iii":return Rn(i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"}),l);case"iiiii":return Rn(i.day(a,{width:"narrow",context:"formatting"}),l);case"iiiiii":return Rn(i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"}),l);case"iiii":default:return Rn(i.day(a,{width:"wide",context:"formatting"})||i.day(a,{width:"abbreviated",context:"formatting"})||i.day(a,{width:"short",context:"formatting"})||i.day(a,{width:"narrow",context:"formatting"}),l)}}},{key:"validate",value:function(a,o){return o>=1&&o<=7}},{key:"set",value:function(a,o,i){return a=x6(a,i),a.setUTCHours(0,0,0,0),a}}]),r}(Tr),b6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",80),q(Et(s),"incompatibleTokens",["b","B","H","k","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"a":case"aa":case"aaa":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})||i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,o,i){return a.setUTCHours(db(i),0,0,0),a}}]),r}(Tr),v6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",80),q(Et(s),"incompatibleTokens",["a","B","H","k","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"b":case"bb":case"bbb":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})||i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,o,i){return a.setUTCHours(db(i),0,0,0),a}}]),r}(Tr),w6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",80),q(Et(s),"incompatibleTokens",["a","b","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"B":case"BB":case"BBB":return i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(a,{width:"wide",context:"formatting"})||i.dayPeriod(a,{width:"abbreviated",context:"formatting"})||i.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,o,i){return a.setUTCHours(db(i),0,0,0),a}}]),r}(Tr),j6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",70),q(Et(s),"incompatibleTokens",["H","K","k","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"h":return fn(En.hour12h,a);case"ho":return i.ordinalNumber(a,{unit:"hour"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=1&&o<=12}},{key:"set",value:function(a,o,i){var l=a.getUTCHours()>=12;return l&&i<12?a.setUTCHours(i+12,0,0,0):!l&&i===12?a.setUTCHours(0,0,0,0):a.setUTCHours(i,0,0,0),a}}]),r}(Tr),S6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",70),q(Et(s),"incompatibleTokens",["a","b","h","K","k","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"H":return fn(En.hour23h,a);case"Ho":return i.ordinalNumber(a,{unit:"hour"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=0&&o<=23}},{key:"set",value:function(a,o,i){return a.setUTCHours(i,0,0,0),a}}]),r}(Tr),_6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",70),q(Et(s),"incompatibleTokens",["h","H","k","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"K":return fn(En.hour11h,a);case"Ko":return i.ordinalNumber(a,{unit:"hour"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=0&&o<=11}},{key:"set",value:function(a,o,i){var l=a.getUTCHours()>=12;return l&&i<12?a.setUTCHours(i+12,0,0,0):a.setUTCHours(i,0,0,0),a}}]),r}(Tr),k6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",70),q(Et(s),"incompatibleTokens",["a","b","h","H","K","t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"k":return fn(En.hour24h,a);case"ko":return i.ordinalNumber(a,{unit:"hour"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=1&&o<=24}},{key:"set",value:function(a,o,i){var l=i<=24?i%24:i;return a.setUTCHours(l,0,0,0),a}}]),r}(Tr),C6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",60),q(Et(s),"incompatibleTokens",["t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"m":return fn(En.minute,a);case"mo":return i.ordinalNumber(a,{unit:"minute"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=0&&o<=59}},{key:"set",value:function(a,o,i){return a.setUTCMinutes(i,0,0),a}}]),r}(Tr),N6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",50),q(Et(s),"incompatibleTokens",["t","T"]),s}return sr(r,[{key:"parse",value:function(a,o,i){switch(o){case"s":return fn(En.second,a);case"so":return i.ordinalNumber(a,{unit:"second"});default:return kn(o.length,a)}}},{key:"validate",value:function(a,o){return o>=0&&o<=59}},{key:"set",value:function(a,o,i){return a.setUTCSeconds(i,0),a}}]),r}(Tr),T6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",30),q(Et(s),"incompatibleTokens",["t","T"]),s}return sr(r,[{key:"parse",value:function(a,o){var i=function(c){return Math.floor(c*Math.pow(10,-o.length+3))};return Rn(kn(o.length,a),i)}},{key:"set",value:function(a,o,i){return a.setUTCMilliseconds(i),a}}]),r}(Tr),P6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",10),q(Et(s),"incompatibleTokens",["t","T","x"]),s}return sr(r,[{key:"parse",value:function(a,o){switch(o){case"X":return ho(uo.basicOptionalMinutes,a);case"XX":return ho(uo.basic,a);case"XXXX":return ho(uo.basicOptionalSeconds,a);case"XXXXX":return ho(uo.extendedOptionalSeconds,a);case"XXX":default:return ho(uo.extended,a)}}},{key:"set",value:function(a,o,i){return o.timestampIsSet?a:new Date(a.getTime()-i)}}]),r}(Tr),E6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",10),q(Et(s),"incompatibleTokens",["t","T","X"]),s}return sr(r,[{key:"parse",value:function(a,o){switch(o){case"x":return ho(uo.basicOptionalMinutes,a);case"xx":return ho(uo.basic,a);case"xxxx":return ho(uo.basicOptionalSeconds,a);case"xxxxx":return ho(uo.extendedOptionalSeconds,a);case"xxx":default:return ho(uo.extended,a)}}},{key:"set",value:function(a,o,i){return o.timestampIsSet?a:new Date(a.getTime()-i)}}]),r}(Tr),R6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",40),q(Et(s),"incompatibleTokens","*"),s}return sr(r,[{key:"parse",value:function(a){return P_(a)}},{key:"set",value:function(a,o,i){return[new Date(i*1e3),{timestampIsSet:!0}]}}]),r}(Tr),A6=function(n){_r(r,n);var t=Nr(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"priority",20),q(Et(s),"incompatibleTokens","*"),s}return sr(r,[{key:"parse",value:function(a){return P_(a)}},{key:"set",value:function(a,o,i){return[new Date(i),{timestampIsSet:!0}]}}]),r}(Tr),M6={G:new JP,y:new QP,Y:new ZP,R:new e6,u:new t6,Q:new r6,q:new n6,M:new s6,L:new a6,w:new i6,I:new c6,d:new h6,D:new p6,E:new m6,e:new f6,c:new g6,i:new y6,a:new b6,b:new v6,B:new w6,h:new j6,H:new S6,K:new _6,k:new k6,m:new C6,s:new N6,S:new T6,X:new P6,x:new E6,t:new R6,T:new A6},I6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,D6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$6=/^'([^]*?)'?$/,L6=/''/g,B6=/\S/,O6=/[a-zA-Z]/;function og(n,t,r,s){var a,o,i,l,c,d,u,h,p,g,f,m,v,b,w,x,j,S;bt(3,arguments);var _=String(n),C=String(t),N=Xl(),M=(a=(o=s==null?void 0:s.locale)!==null&&o!==void 0?o:N.locale)!==null&&a!==void 0?a:w_;if(!M.match)throw new RangeError("locale must contain match property");var E=gr((i=(l=(c=(d=s==null?void 0:s.firstWeekContainsDate)!==null&&d!==void 0?d:s==null||(u=s.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&c!==void 0?c:N.firstWeekContainsDate)!==null&&l!==void 0?l:(p=N.locale)===null||p===void 0||(g=p.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(E>=1&&E<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var P=gr((f=(m=(v=(b=s==null?void 0:s.weekStartsOn)!==null&&b!==void 0?b:s==null||(w=s.locale)===null||w===void 0||(x=w.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&v!==void 0?v:N.weekStartsOn)!==null&&m!==void 0?m:(j=N.locale)===null||j===void 0||(S=j.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&f!==void 0?f:0);if(!(P>=0&&P<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(C==="")return _===""?Pt(r):new Date(NaN);var D={firstWeekContainsDate:E,weekStartsOn:P,locale:M},T=[new KP],A=C.match(D6).map(function(O){var oe=O[0];if(oe in tx){var me=tx[oe];return me(O,M.formatLong)}return O}).join("").match(I6),k=[],R=A1(A),U;try{var z=function(){var oe=U.value;!(s!=null&&s.useAdditionalWeekYearTokens)&&v_(oe)&&um(oe,C,n),!(s!=null&&s.useAdditionalDayOfYearTokens)&&b_(oe)&&um(oe,C,n);var me=oe[0],Ce=M6[me];if(Ce){var ve=Ce.incompatibleTokens;if(Array.isArray(ve)){var De=k.find(function(Ze){return ve.includes(Ze.token)||Ze.token===me});if(De)throw new RangeError("The format string mustn't contain `".concat(De.fullToken,"` and `").concat(oe,"` at the same time"))}else if(Ce.incompatibleTokens==="*"&&k.length>0)throw new RangeError("The format string mustn't contain `".concat(oe,"` and any other token at the same time"));k.push({token:me,fullToken:oe});var Oe=Ce.run(_,oe,M.match,D);if(!Oe)return{v:new Date(NaN)};T.push(Oe.setter),_=Oe.rest}else{if(me.match(O6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+me+"`");if(oe==="''"?oe="'":me==="'"&&(oe=z6(oe)),_.indexOf(oe)===0)_=_.slice(oe.length);else return{v:new Date(NaN)}}};for(R.s();!(U=R.n()).done;){var $=z();if(_n($)==="object")return $.v}}catch(O){R.e(O)}finally{R.f()}if(_.length>0&&B6.test(_))return new Date(NaN);var W=T.map(function(O){return O.priority}).sort(function(O,oe){return oe-O}).filter(function(O,oe,me){return me.indexOf(O)===oe}).map(function(O){return T.filter(function(oe){return oe.priority===O}).sort(function(oe,me){return me.subPriority-oe.subPriority})}).map(function(O){return O[0]}),Y=Pt(r);if(isNaN(Y.getTime()))return new Date(NaN);var Q=m_(Y,dm(Y)),H={},ue=A1(W),J;try{for(ue.s();!(J=ue.n()).done;){var be=J.value;if(!be.validate(Q,D))return new Date(NaN);var Ae=be.set(Q,H,D);Array.isArray(Ae)?(Q=Ae[0],HP(H,Ae[1])):Q=Ae}}catch(O){ue.e(O)}finally{ue.f()}return Q}function z6(n){return n.match($6)[1].replace(L6,"'")}function A_(n,t){var r;bt(1,arguments);var s=gr((r=t==null?void 0:t.additionalDigits)!==null&&r!==void 0?r:2);if(s!==2&&s!==1&&s!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var a=q6(n),o;if(a.date){var i=H6(a.date,s);o=Y6(i.restDateString,i.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);var l=o.getTime(),c=0,d;if(a.time&&(c=G6(a.time),isNaN(c)))return new Date(NaN);if(a.timezone){if(d=V6(a.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),h=new Date(0);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return new Date(l+c+d)}var Yh={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},F6=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,W6=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,U6=/^([+-])(\d{2})(?::?(\d{2}))?$/;function q6(n){var t={},r=n.split(Yh.dateTimeDelimiter),s;if(r.length>2)return t;if(/:/.test(r[0])?s=r[0]:(t.date=r[0],s=r[1],Yh.timeZoneDelimiter.test(t.date)&&(t.date=n.split(Yh.timeZoneDelimiter)[0],s=n.substr(t.date.length,n.length))),s){var a=Yh.timezone.exec(s);a?(t.time=s.replace(a[1],""),t.timezone=a[1]):t.time=s}return t}function H6(n,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=n.match(r);if(!s)return{year:NaN,restDateString:""};var a=s[1]?parseInt(s[1]):null,o=s[2]?parseInt(s[2]):null;return{year:o===null?a:o*100,restDateString:n.slice((s[1]||s[2]).length)}}function Y6(n,t){if(t===null)return new Date(NaN);var r=n.match(F6);if(!r)return new Date(NaN);var s=!!r[4],a=Bd(r[1]),o=Bd(r[2])-1,i=Bd(r[3]),l=Bd(r[4]),c=Bd(r[5])-1;if(s)return Z6(t,l,c)?K6(t,l,c):new Date(NaN);var d=new Date(0);return!X6(t,o,i)||!Q6(t,a)?new Date(NaN):(d.setUTCFullYear(t,o,Math.max(a,i)),d)}function Bd(n){return n?parseInt(n):1}function G6(n){var t=n.match(W6);if(!t)return NaN;var r=ig(t[1]),s=ig(t[2]),a=ig(t[3]);return eE(r,s,a)?r*af+s*cb+a*1e3:NaN}function ig(n){return n&&parseFloat(n.replace(",","."))||0}function V6(n){if(n==="Z")return 0;var t=n.match(U6);if(!t)return 0;var r=t[1]==="+"?-1:1,s=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return tE(s,a)?r*(s*af+a*cb):NaN}function K6(n,t,r){var s=new Date(0);s.setUTCFullYear(n,0,4);var a=s.getUTCDay()||7,o=(t-1)*7+r+1-a;return s.setUTCDate(s.getUTCDate()+o),s}var J6=[31,null,31,30,31,30,31,31,30,31,30,31];function M_(n){return n%400===0||n%4===0&&n%100!==0}function X6(n,t,r){return t>=0&&t<=11&&r>=1&&r<=(J6[t]||(M_(n)?29:28))}function Q6(n,t){return t>=1&&t<=(M_(n)?366:365)}function Z6(n,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function eE(n,t,r){return n===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&n>=0&&n<25}function tE(n,t){return t>=0&&t<=59}function rE(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,ix(n,t)}function ix(n,t){return ix=Object.setPrototypeOf||function(s,a){return s.__proto__=a,s},ix(n,t)}function nE(n,t){if(n==null)return{};var r={},s=Object.keys(n),a,o;for(o=0;o<s.length;o++)a=s[o],!(t.indexOf(a)>=0)&&(r[a]=n[a]);return r}function I1(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function sE(n,t,r){return n===t?!0:n.correspondingElement?n.correspondingElement.classList.contains(r):n.classList.contains(r)}function aE(n,t,r){if(n===t)return!0;for(;n.parentNode||n.host;){if(n.parentNode&&sE(n,t,r))return!0;n=n.parentNode||n.host}return n}function oE(n){return document.documentElement.clientWidth<=n.clientX||document.documentElement.clientHeight<=n.clientY}var iE=function(){if(!(typeof window>"u"||typeof window.addEventListener!="function")){var t=!1,r=Object.defineProperty({},"passive",{get:function(){t=!0}}),s=function(){};return window.addEventListener("testPassiveEventSupport",s,r),window.removeEventListener("testPassiveEventSupport",s,r),t}};function lE(n){return n===void 0&&(n=0),function(){return++n}}var cE=lE(),lx,Gh={},lg={},dE=["touchstart","touchmove"],uE="ignore-react-onclickoutside";function D1(n,t){var r={},s=dE.indexOf(t)!==-1;return s&&lx&&(r.passive=!n.props.preventDefault),r}function of(n,t){var r,s,a=n.displayName||n.name||"Component";return s=r=function(o){rE(i,o);function i(c){var d;return d=o.call(this,c)||this,d.__outsideClickHandler=function(u){if(typeof d.__clickOutsideHandlerProp=="function"){d.__clickOutsideHandlerProp(u);return}var h=d.getInstance();if(typeof h.props.handleClickOutside=="function"){h.props.handleClickOutside(u);return}if(typeof h.handleClickOutside=="function"){h.handleClickOutside(u);return}throw new Error("WrappedComponent: "+a+" lacks a handleClickOutside(event) function for processing outside click events.")},d.__getComponentNode=function(){var u=d.getInstance();return t&&typeof t.setClickOutsideRef=="function"?t.setClickOutsideRef()(u):typeof u.setClickOutsideRef=="function"?u.setClickOutsideRef():xr.findDOMNode(u)},d.enableOnClickOutside=function(){if(!(typeof document>"u"||lg[d._uid])){typeof lx>"u"&&(lx=iE()),lg[d._uid]=!0;var u=d.props.eventTypes;u.forEach||(u=[u]),Gh[d._uid]=function(h){if(d.componentNode!==null&&!(d.initTimeStamp>h.timeStamp)&&(d.props.preventDefault&&h.preventDefault(),d.props.stopPropagation&&h.stopPropagation(),!(d.props.excludeScrollbar&&oE(h)))){var p=h.composed&&h.composedPath&&h.composedPath().shift()||h.target;aE(p,d.componentNode,d.props.outsideClickIgnoreClass)===document&&d.__outsideClickHandler(h)}},u.forEach(function(h){document.addEventListener(h,Gh[d._uid],D1(I1(d),h))})}},d.disableOnClickOutside=function(){delete lg[d._uid];var u=Gh[d._uid];if(u&&typeof document<"u"){var h=d.props.eventTypes;h.forEach||(h=[h]),h.forEach(function(p){return document.removeEventListener(p,u,D1(I1(d),p))}),delete Gh[d._uid]}},d.getRef=function(u){return d.instanceRef=u},d._uid=cE(),d.initTimeStamp=performance.now(),d}var l=i.prototype;return l.getInstance=function(){if(n.prototype&&!n.prototype.isReactComponent)return this;var d=this.instanceRef;return d.getInstance?d.getInstance():d},l.componentDidMount=function(){if(!(typeof document>"u"||!document.createElement)){var d=this.getInstance();if(t&&typeof t.handleClickOutside=="function"&&(this.__clickOutsideHandlerProp=t.handleClickOutside(d),typeof this.__clickOutsideHandlerProp!="function"))throw new Error("WrappedComponent: "+a+" lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=this.__getComponentNode(),!this.props.disableOnClickOutside&&this.enableOnClickOutside()}},l.componentDidUpdate=function(){this.componentNode=this.__getComponentNode()},l.componentWillUnmount=function(){this.disableOnClickOutside()},l.render=function(){var d=this.props;d.excludeScrollbar;var u=nE(d,["excludeScrollbar"]);return n.prototype&&n.prototype.isReactComponent?u.ref=this.getRef:u.wrappedRef=this.getRef,u.disableOnClickOutside=this.disableOnClickOutside,u.enableOnClickOutside=this.enableOnClickOutside,y.createElement(n,u)},i}(y.Component),r.displayName="OnClickOutside("+a+")",r.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:t&&t.excludeScrollbar||!1,outsideClickIgnoreClass:uE,preventDefault:!1,stopPropagation:!1},r.getClass=function(){return n.getClass?n.getClass():n},s}var I_=y.createContext(),D_=y.createContext();function hE(n){var t=n.children,r=y.useState(null),s=r[0],a=r[1],o=y.useRef(!1);y.useEffect(function(){return function(){o.current=!0}},[]);var i=y.useCallback(function(l){o.current||a(l)},[]);return y.createElement(I_.Provider,{value:s},y.createElement(D_.Provider,{value:i},t))}var $_=function(t){return Array.isArray(t)?t[0]:t},L_=function(t){if(typeof t=="function"){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return t.apply(void 0,s)}},cx=function(t,r){if(typeof t=="function")return L_(t,r);t!=null&&(t.current=r)},$1=function(t){return t.reduce(function(r,s){var a=s[0],o=s[1];return r[a]=o,r},{})},L1=typeof window<"u"&&window.document&&window.document.createElement?y.useLayoutEffect:y.useEffect,Gs="top",Na="bottom",Ta="right",Vs="left",hb="auto",wh=[Gs,Na,Ta,Vs],hd="start",Vu="end",pE="clippingParents",B_="viewport",Od="popper",mE="reference",B1=wh.reduce(function(n,t){return n.concat([t+"-"+hd,t+"-"+Vu])},[]),O_=[].concat(wh,[hb]).reduce(function(n,t){return n.concat([t,t+"-"+hd,t+"-"+Vu])},[]),fE="beforeRead",gE="read",xE="afterRead",yE="beforeMain",bE="main",vE="afterMain",wE="beforeWrite",jE="write",SE="afterWrite",_E=[fE,gE,xE,yE,bE,vE,wE,jE,SE];function jo(n){return n?(n.nodeName||"").toLowerCase():null}function la(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function Wl(n){var t=la(n).Element;return n instanceof t||n instanceof Element}function Sa(n){var t=la(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function pb(n){if(typeof ShadowRoot>"u")return!1;var t=la(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function kE(n){var t=n.state;Object.keys(t.elements).forEach(function(r){var s=t.styles[r]||{},a=t.attributes[r]||{},o=t.elements[r];!Sa(o)||!jo(o)||(Object.assign(o.style,s),Object.keys(a).forEach(function(i){var l=a[i];l===!1?o.removeAttribute(i):o.setAttribute(i,l===!0?"":l)}))})}function CE(n){var t=n.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(s){var a=t.elements[s],o=t.attributes[s]||{},i=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:r[s]),l=i.reduce(function(c,d){return c[d]="",c},{});!Sa(a)||!jo(a)||(Object.assign(a.style,l),Object.keys(o).forEach(function(c){a.removeAttribute(c)}))})}}const NE={name:"applyStyles",enabled:!0,phase:"write",fn:kE,effect:CE,requires:["computeStyles"]};function bo(n){return n.split("-")[0]}var Rl=Math.max,xm=Math.min,pd=Math.round;function dx(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function z_(){return!/^((?!chrome|android).)*safari/i.test(dx())}function md(n,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var s=n.getBoundingClientRect(),a=1,o=1;t&&Sa(n)&&(a=n.offsetWidth>0&&pd(s.width)/n.offsetWidth||1,o=n.offsetHeight>0&&pd(s.height)/n.offsetHeight||1);var i=Wl(n)?la(n):window,l=i.visualViewport,c=!z_()&&r,d=(s.left+(c&&l?l.offsetLeft:0))/a,u=(s.top+(c&&l?l.offsetTop:0))/o,h=s.width/a,p=s.height/o;return{width:h,height:p,top:u,right:d+h,bottom:u+p,left:d,x:d,y:u}}function mb(n){var t=md(n),r=n.offsetWidth,s=n.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:n.offsetLeft,y:n.offsetTop,width:r,height:s}}function F_(n,t){var r=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(r&&pb(r)){var s=t;do{if(s&&n.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Ko(n){return la(n).getComputedStyle(n)}function TE(n){return["table","td","th"].indexOf(jo(n))>=0}function Hi(n){return((Wl(n)?n.ownerDocument:n.document)||window.document).documentElement}function lf(n){return jo(n)==="html"?n:n.assignedSlot||n.parentNode||(pb(n)?n.host:null)||Hi(n)}function O1(n){return!Sa(n)||Ko(n).position==="fixed"?null:n.offsetParent}function PE(n){var t=/firefox/i.test(dx()),r=/Trident/i.test(dx());if(r&&Sa(n)){var s=Ko(n);if(s.position==="fixed")return null}var a=lf(n);for(pb(a)&&(a=a.host);Sa(a)&&["html","body"].indexOf(jo(a))<0;){var o=Ko(a);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return a;a=a.parentNode}return null}function jh(n){for(var t=la(n),r=O1(n);r&&TE(r)&&Ko(r).position==="static";)r=O1(r);return r&&(jo(r)==="html"||jo(r)==="body"&&Ko(r).position==="static")?t:r||PE(n)||t}function fb(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function gu(n,t,r){return Rl(n,xm(t,r))}function EE(n,t,r){var s=gu(n,t,r);return s>r?r:s}function W_(){return{top:0,right:0,bottom:0,left:0}}function U_(n){return Object.assign({},W_(),n)}function q_(n,t){return t.reduce(function(r,s){return r[s]=n,r},{})}var RE=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,U_(typeof t!="number"?t:q_(t,wh))};function AE(n){var t,r=n.state,s=n.name,a=n.options,o=r.elements.arrow,i=r.modifiersData.popperOffsets,l=bo(r.placement),c=fb(l),d=[Vs,Ta].indexOf(l)>=0,u=d?"height":"width";if(!(!o||!i)){var h=RE(a.padding,r),p=mb(o),g=c==="y"?Gs:Vs,f=c==="y"?Na:Ta,m=r.rects.reference[u]+r.rects.reference[c]-i[c]-r.rects.popper[u],v=i[c]-r.rects.reference[c],b=jh(o),w=b?c==="y"?b.clientHeight||0:b.clientWidth||0:0,x=m/2-v/2,j=h[g],S=w-p[u]-h[f],_=w/2-p[u]/2+x,C=gu(j,_,S),N=c;r.modifiersData[s]=(t={},t[N]=C,t.centerOffset=C-_,t)}}function ME(n){var t=n.state,r=n.options,s=r.element,a=s===void 0?"[data-popper-arrow]":s;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||F_(t.elements.popper,a)&&(t.elements.arrow=a))}const IE={name:"arrow",enabled:!0,phase:"main",fn:AE,effect:ME,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fd(n){return n.split("-")[1]}var DE={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $E(n,t){var r=n.x,s=n.y,a=t.devicePixelRatio||1;return{x:pd(r*a)/a||0,y:pd(s*a)/a||0}}function z1(n){var t,r=n.popper,s=n.popperRect,a=n.placement,o=n.variation,i=n.offsets,l=n.position,c=n.gpuAcceleration,d=n.adaptive,u=n.roundOffsets,h=n.isFixed,p=i.x,g=p===void 0?0:p,f=i.y,m=f===void 0?0:f,v=typeof u=="function"?u({x:g,y:m}):{x:g,y:m};g=v.x,m=v.y;var b=i.hasOwnProperty("x"),w=i.hasOwnProperty("y"),x=Vs,j=Gs,S=window;if(d){var _=jh(r),C="clientHeight",N="clientWidth";if(_===la(r)&&(_=Hi(r),Ko(_).position!=="static"&&l==="absolute"&&(C="scrollHeight",N="scrollWidth")),_=_,a===Gs||(a===Vs||a===Ta)&&o===Vu){j=Na;var M=h&&_===S&&S.visualViewport?S.visualViewport.height:_[C];m-=M-s.height,m*=c?1:-1}if(a===Vs||(a===Gs||a===Na)&&o===Vu){x=Ta;var E=h&&_===S&&S.visualViewport?S.visualViewport.width:_[N];g-=E-s.width,g*=c?1:-1}}var P=Object.assign({position:l},d&&DE),D=u===!0?$E({x:g,y:m},la(r)):{x:g,y:m};if(g=D.x,m=D.y,c){var T;return Object.assign({},P,(T={},T[j]=w?"0":"",T[x]=b?"0":"",T.transform=(S.devicePixelRatio||1)<=1?"translate("+g+"px, "+m+"px)":"translate3d("+g+"px, "+m+"px, 0)",T))}return Object.assign({},P,(t={},t[j]=w?m+"px":"",t[x]=b?g+"px":"",t.transform="",t))}function LE(n){var t=n.state,r=n.options,s=r.gpuAcceleration,a=s===void 0?!0:s,o=r.adaptive,i=o===void 0?!0:o,l=r.roundOffsets,c=l===void 0?!0:l,d={placement:bo(t.placement),variation:fd(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,z1(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,z1(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const BE={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:LE,data:{}};var Vh={passive:!0};function OE(n){var t=n.state,r=n.instance,s=n.options,a=s.scroll,o=a===void 0?!0:a,i=s.resize,l=i===void 0?!0:i,c=la(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&d.forEach(function(u){u.addEventListener("scroll",r.update,Vh)}),l&&c.addEventListener("resize",r.update,Vh),function(){o&&d.forEach(function(u){u.removeEventListener("scroll",r.update,Vh)}),l&&c.removeEventListener("resize",r.update,Vh)}}const zE={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:OE,data:{}};var FE={left:"right",right:"left",bottom:"top",top:"bottom"};function Tp(n){return n.replace(/left|right|bottom|top/g,function(t){return FE[t]})}var WE={start:"end",end:"start"};function F1(n){return n.replace(/start|end/g,function(t){return WE[t]})}function gb(n){var t=la(n),r=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:r,scrollTop:s}}function xb(n){return md(Hi(n)).left+gb(n).scrollLeft}function UE(n,t){var r=la(n),s=Hi(n),a=r.visualViewport,o=s.clientWidth,i=s.clientHeight,l=0,c=0;if(a){o=a.width,i=a.height;var d=z_();(d||!d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:o,height:i,x:l+xb(n),y:c}}function qE(n){var t,r=Hi(n),s=gb(n),a=(t=n.ownerDocument)==null?void 0:t.body,o=Rl(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),i=Rl(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-s.scrollLeft+xb(n),c=-s.scrollTop;return Ko(a||r).direction==="rtl"&&(l+=Rl(r.clientWidth,a?a.clientWidth:0)-o),{width:o,height:i,x:l,y:c}}function yb(n){var t=Ko(n),r=t.overflow,s=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+s)}function H_(n){return["html","body","#document"].indexOf(jo(n))>=0?n.ownerDocument.body:Sa(n)&&yb(n)?n:H_(lf(n))}function xu(n,t){var r;t===void 0&&(t=[]);var s=H_(n),a=s===((r=n.ownerDocument)==null?void 0:r.body),o=la(s),i=a?[o].concat(o.visualViewport||[],yb(s)?s:[]):s,l=t.concat(i);return a?l:l.concat(xu(lf(i)))}function ux(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function HE(n,t){var r=md(n,!1,t==="fixed");return r.top=r.top+n.clientTop,r.left=r.left+n.clientLeft,r.bottom=r.top+n.clientHeight,r.right=r.left+n.clientWidth,r.width=n.clientWidth,r.height=n.clientHeight,r.x=r.left,r.y=r.top,r}function W1(n,t,r){return t===B_?ux(UE(n,r)):Wl(t)?HE(t,r):ux(qE(Hi(n)))}function YE(n){var t=xu(lf(n)),r=["absolute","fixed"].indexOf(Ko(n).position)>=0,s=r&&Sa(n)?jh(n):n;return Wl(s)?t.filter(function(a){return Wl(a)&&F_(a,s)&&jo(a)!=="body"}):[]}function GE(n,t,r,s){var a=t==="clippingParents"?YE(n):[].concat(t),o=[].concat(a,[r]),i=o[0],l=o.reduce(function(c,d){var u=W1(n,d,s);return c.top=Rl(u.top,c.top),c.right=xm(u.right,c.right),c.bottom=xm(u.bottom,c.bottom),c.left=Rl(u.left,c.left),c},W1(n,i,s));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Y_(n){var t=n.reference,r=n.element,s=n.placement,a=s?bo(s):null,o=s?fd(s):null,i=t.x+t.width/2-r.width/2,l=t.y+t.height/2-r.height/2,c;switch(a){case Gs:c={x:i,y:t.y-r.height};break;case Na:c={x:i,y:t.y+t.height};break;case Ta:c={x:t.x+t.width,y:l};break;case Vs:c={x:t.x-r.width,y:l};break;default:c={x:t.x,y:t.y}}var d=a?fb(a):null;if(d!=null){var u=d==="y"?"height":"width";switch(o){case hd:c[d]=c[d]-(t[u]/2-r[u]/2);break;case Vu:c[d]=c[d]+(t[u]/2-r[u]/2);break}}return c}function Ku(n,t){t===void 0&&(t={});var r=t,s=r.placement,a=s===void 0?n.placement:s,o=r.strategy,i=o===void 0?n.strategy:o,l=r.boundary,c=l===void 0?pE:l,d=r.rootBoundary,u=d===void 0?B_:d,h=r.elementContext,p=h===void 0?Od:h,g=r.altBoundary,f=g===void 0?!1:g,m=r.padding,v=m===void 0?0:m,b=U_(typeof v!="number"?v:q_(v,wh)),w=p===Od?mE:Od,x=n.rects.popper,j=n.elements[f?w:p],S=GE(Wl(j)?j:j.contextElement||Hi(n.elements.popper),c,u,i),_=md(n.elements.reference),C=Y_({reference:_,element:x,strategy:"absolute",placement:a}),N=ux(Object.assign({},x,C)),M=p===Od?N:_,E={top:S.top-M.top+b.top,bottom:M.bottom-S.bottom+b.bottom,left:S.left-M.left+b.left,right:M.right-S.right+b.right},P=n.modifiersData.offset;if(p===Od&&P){var D=P[a];Object.keys(E).forEach(function(T){var A=[Ta,Na].indexOf(T)>=0?1:-1,k=[Gs,Na].indexOf(T)>=0?"y":"x";E[T]+=D[k]*A})}return E}function VE(n,t){t===void 0&&(t={});var r=t,s=r.placement,a=r.boundary,o=r.rootBoundary,i=r.padding,l=r.flipVariations,c=r.allowedAutoPlacements,d=c===void 0?O_:c,u=fd(s),h=u?l?B1:B1.filter(function(f){return fd(f)===u}):wh,p=h.filter(function(f){return d.indexOf(f)>=0});p.length===0&&(p=h);var g=p.reduce(function(f,m){return f[m]=Ku(n,{placement:m,boundary:a,rootBoundary:o,padding:i})[bo(m)],f},{});return Object.keys(g).sort(function(f,m){return g[f]-g[m]})}function KE(n){if(bo(n)===hb)return[];var t=Tp(n);return[F1(n),t,F1(t)]}function JE(n){var t=n.state,r=n.options,s=n.name;if(!t.modifiersData[s]._skip){for(var a=r.mainAxis,o=a===void 0?!0:a,i=r.altAxis,l=i===void 0?!0:i,c=r.fallbackPlacements,d=r.padding,u=r.boundary,h=r.rootBoundary,p=r.altBoundary,g=r.flipVariations,f=g===void 0?!0:g,m=r.allowedAutoPlacements,v=t.options.placement,b=bo(v),w=b===v,x=c||(w||!f?[Tp(v)]:KE(v)),j=[v].concat(x).reduce(function(ue,J){return ue.concat(bo(J)===hb?VE(t,{placement:J,boundary:u,rootBoundary:h,padding:d,flipVariations:f,allowedAutoPlacements:m}):J)},[]),S=t.rects.reference,_=t.rects.popper,C=new Map,N=!0,M=j[0],E=0;E<j.length;E++){var P=j[E],D=bo(P),T=fd(P)===hd,A=[Gs,Na].indexOf(D)>=0,k=A?"width":"height",R=Ku(t,{placement:P,boundary:u,rootBoundary:h,altBoundary:p,padding:d}),U=A?T?Ta:Vs:T?Na:Gs;S[k]>_[k]&&(U=Tp(U));var z=Tp(U),$=[];if(o&&$.push(R[D]<=0),l&&$.push(R[U]<=0,R[z]<=0),$.every(function(ue){return ue})){M=P,N=!1;break}C.set(P,$)}if(N)for(var W=f?3:1,Y=function(J){var be=j.find(function(Ae){var O=C.get(Ae);if(O)return O.slice(0,J).every(function(oe){return oe})});if(be)return M=be,"break"},Q=W;Q>0;Q--){var H=Y(Q);if(H==="break")break}t.placement!==M&&(t.modifiersData[s]._skip=!0,t.placement=M,t.reset=!0)}}const XE={name:"flip",enabled:!0,phase:"main",fn:JE,requiresIfExists:["offset"],data:{_skip:!1}};function U1(n,t,r){return r===void 0&&(r={x:0,y:0}),{top:n.top-t.height-r.y,right:n.right-t.width+r.x,bottom:n.bottom-t.height+r.y,left:n.left-t.width-r.x}}function q1(n){return[Gs,Ta,Na,Vs].some(function(t){return n[t]>=0})}function QE(n){var t=n.state,r=n.name,s=t.rects.reference,a=t.rects.popper,o=t.modifiersData.preventOverflow,i=Ku(t,{elementContext:"reference"}),l=Ku(t,{altBoundary:!0}),c=U1(i,s),d=U1(l,a,o),u=q1(c),h=q1(d);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const ZE={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:QE};function eR(n,t,r){var s=bo(n),a=[Vs,Gs].indexOf(s)>=0?-1:1,o=typeof r=="function"?r(Object.assign({},t,{placement:n})):r,i=o[0],l=o[1];return i=i||0,l=(l||0)*a,[Vs,Ta].indexOf(s)>=0?{x:l,y:i}:{x:i,y:l}}function tR(n){var t=n.state,r=n.options,s=n.name,a=r.offset,o=a===void 0?[0,0]:a,i=O_.reduce(function(u,h){return u[h]=eR(h,t.rects,o),u},{}),l=i[t.placement],c=l.x,d=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=d),t.modifiersData[s]=i}const rR={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tR};function nR(n){var t=n.state,r=n.name;t.modifiersData[r]=Y_({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const sR={name:"popperOffsets",enabled:!0,phase:"read",fn:nR,data:{}};function aR(n){return n==="x"?"y":"x"}function oR(n){var t=n.state,r=n.options,s=n.name,a=r.mainAxis,o=a===void 0?!0:a,i=r.altAxis,l=i===void 0?!1:i,c=r.boundary,d=r.rootBoundary,u=r.altBoundary,h=r.padding,p=r.tether,g=p===void 0?!0:p,f=r.tetherOffset,m=f===void 0?0:f,v=Ku(t,{boundary:c,rootBoundary:d,padding:h,altBoundary:u}),b=bo(t.placement),w=fd(t.placement),x=!w,j=fb(b),S=aR(j),_=t.modifiersData.popperOffsets,C=t.rects.reference,N=t.rects.popper,M=typeof m=="function"?m(Object.assign({},t.rects,{placement:t.placement})):m,E=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,D={x:0,y:0};if(_){if(o){var T,A=j==="y"?Gs:Vs,k=j==="y"?Na:Ta,R=j==="y"?"height":"width",U=_[j],z=U+v[A],$=U-v[k],W=g?-N[R]/2:0,Y=w===hd?C[R]:N[R],Q=w===hd?-N[R]:-C[R],H=t.elements.arrow,ue=g&&H?mb(H):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:W_(),be=J[A],Ae=J[k],O=gu(0,C[R],ue[R]),oe=x?C[R]/2-W-O-be-E.mainAxis:Y-O-be-E.mainAxis,me=x?-C[R]/2+W+O+Ae+E.mainAxis:Q+O+Ae+E.mainAxis,Ce=t.elements.arrow&&jh(t.elements.arrow),ve=Ce?j==="y"?Ce.clientTop||0:Ce.clientLeft||0:0,De=(T=P==null?void 0:P[j])!=null?T:0,Oe=U+oe-De-ve,Ze=U+me-De,et=gu(g?xm(z,Oe):z,U,g?Rl($,Ze):$);_[j]=et,D[j]=et-U}if(l){var re,je=j==="x"?Gs:Vs,V=j==="x"?Na:Ta,Ee=_[S],F=S==="y"?"height":"width",ae=Ee+v[je],I=Ee-v[V],X=[Gs,Vs].indexOf(b)!==-1,fe=(re=P==null?void 0:P[S])!=null?re:0,ne=X?ae:Ee-C[F]-N[F]-fe+E.altAxis,ye=X?Ee+C[F]+N[F]-fe-E.altAxis:I,ot=g&&X?EE(ne,Ee,ye):gu(g?ne:ae,Ee,g?ye:I);_[S]=ot,D[S]=ot-Ee}t.modifiersData[s]=D}}const iR={name:"preventOverflow",enabled:!0,phase:"main",fn:oR,requiresIfExists:["offset"]};function lR(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function cR(n){return n===la(n)||!Sa(n)?gb(n):lR(n)}function dR(n){var t=n.getBoundingClientRect(),r=pd(t.width)/n.offsetWidth||1,s=pd(t.height)/n.offsetHeight||1;return r!==1||s!==1}function uR(n,t,r){r===void 0&&(r=!1);var s=Sa(t),a=Sa(t)&&dR(t),o=Hi(t),i=md(n,a,r),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!r)&&((jo(t)!=="body"||yb(o))&&(l=cR(t)),Sa(t)?(c=md(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):o&&(c.x=xb(o))),{x:i.left+l.scrollLeft-c.x,y:i.top+l.scrollTop-c.y,width:i.width,height:i.height}}function hR(n){var t=new Map,r=new Set,s=[];n.forEach(function(o){t.set(o.name,o)});function a(o){r.add(o.name);var i=[].concat(o.requires||[],o.requiresIfExists||[]);i.forEach(function(l){if(!r.has(l)){var c=t.get(l);c&&a(c)}}),s.push(o)}return n.forEach(function(o){r.has(o.name)||a(o)}),s}function pR(n){var t=hR(n);return _E.reduce(function(r,s){return r.concat(t.filter(function(a){return a.phase===s}))},[])}function mR(n){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(n())})})),t}}function fR(n){var t=n.reduce(function(r,s){var a=r[s.name];return r[s.name]=a?Object.assign({},a,s,{options:Object.assign({},a.options,s.options),data:Object.assign({},a.data,s.data)}):s,r},{});return Object.keys(t).map(function(r){return t[r]})}var H1={placement:"bottom",modifiers:[],strategy:"absolute"};function Y1(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function gR(n){n===void 0&&(n={});var t=n,r=t.defaultModifiers,s=r===void 0?[]:r,a=t.defaultOptions,o=a===void 0?H1:a;return function(l,c,d){d===void 0&&(d=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},H1,o),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},h=[],p=!1,g={state:u,setOptions:function(b){var w=typeof b=="function"?b(u.options):b;m(),u.options=Object.assign({},o,u.options,w),u.scrollParents={reference:Wl(l)?xu(l):l.contextElement?xu(l.contextElement):[],popper:xu(c)};var x=pR(fR([].concat(s,u.options.modifiers)));return u.orderedModifiers=x.filter(function(j){return j.enabled}),f(),g.update()},forceUpdate:function(){if(!p){var b=u.elements,w=b.reference,x=b.popper;if(Y1(w,x)){u.rects={reference:uR(w,jh(x),u.options.strategy==="fixed"),popper:mb(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(E){return u.modifiersData[E.name]=Object.assign({},E.data)});for(var j=0;j<u.orderedModifiers.length;j++){if(u.reset===!0){u.reset=!1,j=-1;continue}var S=u.orderedModifiers[j],_=S.fn,C=S.options,N=C===void 0?{}:C,M=S.name;typeof _=="function"&&(u=_({state:u,options:N,name:M,instance:g})||u)}}}},update:mR(function(){return new Promise(function(v){g.forceUpdate(),v(u)})}),destroy:function(){m(),p=!0}};if(!Y1(l,c))return g;g.setOptions(d).then(function(v){!p&&d.onFirstUpdate&&d.onFirstUpdate(v)});function f(){u.orderedModifiers.forEach(function(v){var b=v.name,w=v.options,x=w===void 0?{}:w,j=v.effect;if(typeof j=="function"){var S=j({state:u,name:b,instance:g,options:x}),_=function(){};h.push(S||_)}})}function m(){h.forEach(function(v){return v()}),h=[]}return g}}var xR=[zE,sR,BE,NE,rR,XE,iR,IE,ZE],yR=gR({defaultModifiers:xR}),bR=typeof Element<"u",vR=typeof Map=="function",wR=typeof Set=="function",jR=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Pp(n,t){if(n===t)return!0;if(n&&t&&typeof n=="object"&&typeof t=="object"){if(n.constructor!==t.constructor)return!1;var r,s,a;if(Array.isArray(n)){if(r=n.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!Pp(n[s],t[s]))return!1;return!0}var o;if(vR&&n instanceof Map&&t instanceof Map){if(n.size!==t.size)return!1;for(o=n.entries();!(s=o.next()).done;)if(!t.has(s.value[0]))return!1;for(o=n.entries();!(s=o.next()).done;)if(!Pp(s.value[1],t.get(s.value[0])))return!1;return!0}if(wR&&n instanceof Set&&t instanceof Set){if(n.size!==t.size)return!1;for(o=n.entries();!(s=o.next()).done;)if(!t.has(s.value[0]))return!1;return!0}if(jR&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(t)){if(r=n.length,r!=t.length)return!1;for(s=r;s--!==0;)if(n[s]!==t[s])return!1;return!0}if(n.constructor===RegExp)return n.source===t.source&&n.flags===t.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof t.valueOf=="function")return n.valueOf()===t.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof t.toString=="function")return n.toString()===t.toString();if(a=Object.keys(n),r=a.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[s]))return!1;if(bR&&n instanceof Element)return!1;for(s=r;s--!==0;)if(!((a[s]==="_owner"||a[s]==="__v"||a[s]==="__o")&&n.$$typeof)&&!Pp(n[a[s]],t[a[s]]))return!1;return!0}return n!==n&&t!==t}var SR=function(t,r){try{return Pp(t,r)}catch(s){if((s.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw s}};const _R=Jo(SR);var kR=[],CR=function(t,r,s){s===void 0&&(s={});var a=y.useRef(null),o={onFirstUpdate:s.onFirstUpdate,placement:s.placement||"bottom",strategy:s.strategy||"absolute",modifiers:s.modifiers||kR},i=y.useState({styles:{popper:{position:o.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),l=i[0],c=i[1],d=y.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(g){var f=g.state,m=Object.keys(f.elements);xr.flushSync(function(){c({styles:$1(m.map(function(v){return[v,f.styles[v]||{}]})),attributes:$1(m.map(function(v){return[v,f.attributes[v]]}))})})},requires:["computeStyles"]}},[]),u=y.useMemo(function(){var p={onFirstUpdate:o.onFirstUpdate,placement:o.placement,strategy:o.strategy,modifiers:[].concat(o.modifiers,[d,{name:"applyStyles",enabled:!1}])};return _R(a.current,p)?a.current||p:(a.current=p,p)},[o.onFirstUpdate,o.placement,o.strategy,o.modifiers,d]),h=y.useRef();return L1(function(){h.current&&h.current.setOptions(u)},[u]),L1(function(){if(!(t==null||r==null)){var p=s.createPopper||yR,g=p(t,r,u);return h.current=g,function(){g.destroy(),h.current=null}}},[t,r,s.createPopper]),{state:h.current?h.current.state:null,styles:l.styles,attributes:l.attributes,update:h.current?h.current.update:null,forceUpdate:h.current?h.current.forceUpdate:null}},NR=function(){},TR=function(){return Promise.resolve(null)},PR=[];function ER(n){var t=n.placement,r=t===void 0?"bottom":t,s=n.strategy,a=s===void 0?"absolute":s,o=n.modifiers,i=o===void 0?PR:o,l=n.referenceElement,c=n.onFirstUpdate,d=n.innerRef,u=n.children,h=y.useContext(I_),p=y.useState(null),g=p[0],f=p[1],m=y.useState(null),v=m[0],b=m[1];y.useEffect(function(){cx(d,g)},[d,g]);var w=y.useMemo(function(){return{placement:r,strategy:a,onFirstUpdate:c,modifiers:[].concat(i,[{name:"arrow",enabled:v!=null,options:{element:v}}])}},[r,a,c,i,v]),x=CR(l||h,g,w),j=x.state,S=x.styles,_=x.forceUpdate,C=x.update,N=y.useMemo(function(){return{ref:f,style:S.popper,placement:j?j.placement:r,hasPopperEscaped:j&&j.modifiersData.hide?j.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:j&&j.modifiersData.hide?j.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:S.arrow,ref:b},forceUpdate:_||NR,update:C||TR}},[f,b,r,j,S,C,_]);return $_(u)(N)}var RR=function(){},AR=RR;const MR=Jo(AR);function IR(n){var t=n.children,r=n.innerRef,s=y.useContext(D_),a=y.useCallback(function(o){cx(r,o),L_(s,o)},[r,s]);return y.useEffect(function(){return function(){return cx(r,null)}},[]),y.useEffect(function(){MR(!!s,"`Reference` should not be used outside of a `Manager` component.")},[s]),$_(t)({ref:a})}function DR(n,t){if(bt(2,arguments),_n(t)!=="object"||t===null)throw new RangeError("values parameter must be an object");var r=Pt(n);return isNaN(r.getTime())?new Date(NaN):(t.year!=null&&r.setFullYear(t.year),t.month!=null&&(r=Rs(r,t.month)),t.date!=null&&r.setDate(gr(t.date)),t.hours!=null&&r.setHours(gr(t.hours)),t.minutes!=null&&r.setMinutes(gr(t.minutes)),t.seconds!=null&&r.setSeconds(gr(t.seconds)),t.milliseconds!=null&&r.setMilliseconds(gr(t.milliseconds)),r)}function G1(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function ym(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G1(Object(r),!0).forEach(function(s){ie(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):G1(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function hx(n){return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(n)}function Qn(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function V1(n,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,G_(s.key),s)}}function Zn(n,t,r){return t&&V1(n.prototype,t),r&&V1(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function ie(n,t,r){return(t=G_(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function gd(){return gd=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])}return n},gd.apply(this,arguments)}function es(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&px(n,t)}function bm(n){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bm(n)}function px(n,t){return px=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},px(n,t)}function de(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ts(n){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var r,s=bm(n);if(t){var a=bm(this).constructor;r=Reflect.construct(s,arguments,a)}else r=s.apply(this,arguments);return function(o,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(o)}(this,r)}}function Ju(n){return function(t){if(Array.isArray(t))return cg(t)}(n)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(n)||function(t,r){if(t){if(typeof t=="string")return cg(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return cg(t,r)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function cg(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function G_(n){var t=function(r,s){if(typeof r!="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var o=a.call(r,s||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}(n,"string");return typeof t=="symbol"?t:String(t)}var K1=function(n,t){switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},J1=function(n,t){switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},$R={p:J1,P:function(n,t){var r,s=n.match(/(P+)(p+)?/)||[],a=s[1],o=s[2];if(!o)return K1(n,t);switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",K1(a,t)).replace("{{time}}",J1(o,t))}},yu=12,LR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;function Wr(n){var t=n?typeof n=="string"||n instanceof String?A_(n):Pt(n):new Date;return pi(t)?t:null}function pi(n,t){return t=t||new Date("1/1/1000"),Uu(n)&&!Si(n,t)}function ln(n,t,r){if(r==="en")return As(n,t,{awareOfUnicodeTokens:!0});var s=Ii(r);return r&&!s&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),!s&&Al()&&Ii(Al())&&(s=Ii(Al())),As(n,t,{locale:s||null,awareOfUnicodeTokens:!0})}function so(n,t){var r=t.dateFormat,s=t.locale;return n&&ln(n,Array.isArray(r)?r[0]:r,s)||""}function X1(n,t){var r=t.hour,s=r===void 0?0:r,a=t.minute,o=a===void 0?0:a,i=t.second;return Np(Cp(DP(n,i===void 0?0:i),o),s)}function vo(n,t,r){var s=Ii(t||Al());return S_(n,{locale:s,weekStartsOn:r})}function Mi(n){return __(n)}function tu(n){return k_(n)}function Q1(n){return sx(n)}function Z1(){return yo(Wr())}function _i(n,t){return n&&t?UP(n,t):!n&&!t}function Ua(n,t){return n&&t?WP(n,t):!n&&!t}function vm(n,t){return n&&t?qP(n,t):!n&&!t}function Vr(n,t){return n&&t?FP(n,t):!n&&!t}function Sl(n,t){return n&&t?zP(n,t):!n&&!t}function Ep(n,t,r){var s,a=yo(t),o=ax(r);try{s=Yu(n,{start:a,end:o})}catch{s=!1}return s}function Al(){return(typeof window<"u"?window:globalThis).__localeId__}function Ii(n){if(typeof n=="string"){var t=typeof window<"u"?window:globalThis;return t.__localeData__?t.__localeData__[n]:null}return n}function bb(n,t){return ln(Rs(Wr(),n),"LLLL",t)}function V_(n,t){return ln(Rs(Wr(),n),"LLL",t)}function cf(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.maxDate,a=t.excludeDates,o=t.excludeDateIntervals,i=t.includeDates,l=t.includeDateIntervals,c=t.filterDate;return df(n,{minDate:r,maxDate:s})||a&&a.some(function(d){return Vr(n,d)})||o&&o.some(function(d){var u=d.start,h=d.end;return Yu(n,{start:u,end:h})})||i&&!i.some(function(d){return Vr(n,d)})||l&&!l.some(function(d){var u=d.start,h=d.end;return Yu(n,{start:u,end:h})})||c&&!c(Wr(n))||!1}function vb(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.excludeDates,s=t.excludeDateIntervals;return s&&s.length>0?s.some(function(a){var o=a.start,i=a.end;return Yu(n,{start:o,end:i})}):r&&r.some(function(a){return Vr(n,a)})||!1}function K_(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.maxDate,a=t.excludeDates,o=t.includeDates,i=t.filterDate;return df(n,{minDate:__(r),maxDate:BP(s)})||a&&a.some(function(l){return Ua(n,l)})||o&&!o.some(function(l){return Ua(n,l)})||i&&!i(Wr(n))||!1}function dg(n,t,r,s){var a=br(n),o=ws(n),i=br(t),l=ws(t),c=br(s);return a===i&&a===c?o<=r&&r<=l:a<i?c===a&&o<=r||c===i&&l>=r||c<i&&c>a:void 0}function BR(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.maxDate,a=t.excludeDates,o=t.includeDates,i=t.filterDate;return df(n,{minDate:r,maxDate:s})||a&&a.some(function(l){return vm(n,l)})||o&&!o.some(function(l){return vm(n,l)})||i&&!i(Wr(n))||!1}function ug(n,t,r){if(!Uu(t)||!Uu(r))return!1;var s=br(t),a=br(r);return s<=n&&a>=n}function J_(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.maxDate,a=t.excludeDates,o=t.includeDates,i=t.filterDate,l=new Date(n,0,1);return df(l,{minDate:k_(r),maxDate:OP(s)})||a&&a.some(function(c){return _i(l,c)})||o&&!o.some(function(c){return _i(l,c)})||i&&!i(Wr(l))||!1}function hg(n,t,r,s){var a=br(n),o=Fc(n),i=br(t),l=Fc(t),c=br(s);return a===i&&a===c?o<=r&&r<=l:a<i?c===a&&o<=r||c===i&&l>=r||c<i&&c>a:void 0}function df(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.maxDate;return r&&Hu(n,r)<0||s&&Hu(n,s)>0}function ew(n,t){return t.some(function(r){return xo(r)===xo(n)&&go(r)===go(n)})}function tw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.excludeTimes,s=t.includeTimes,a=t.filterTime;return r&&ew(n,r)||s&&!ew(n,s)||a&&!a(n)||!1}function rw(n,t){var r=t.minTime,s=t.maxTime;if(!r||!s)throw new Error("Both minTime and maxTime props required");var a,o=Wr(),i=Np(Cp(o,go(n)),xo(n)),l=Np(Cp(o,go(r)),xo(r)),c=Np(Cp(o,go(s)),xo(s));try{a=!Yu(i,{start:l,end:c})}catch{a=!1}return a}function nw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.includeDates,a=ud(n,1);return r&&mm(r,a)>0||s&&s.every(function(o){return mm(o,a)>0})||!1}function sw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,s=t.includeDates,a=Va(n,1);return r&&mm(a,r)>0||s&&s.every(function(o){return mm(a,o)>0})||!1}function aw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,s=t.includeDates,a=qu(n,1);return r&&fm(r,a)>0||s&&s.every(function(o){return fm(o,a)>0})||!1}function ow(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,s=t.includeDates,a=dd(n,1);return r&&fm(a,r)>0||s&&s.every(function(o){return fm(a,o)>0})||!1}function X_(n){var t=n.minDate,r=n.includeDates;if(r&&t){var s=r.filter(function(a){return Hu(a,t)>=0});return E1(s)}return r?E1(r):t}function Q_(n){var t=n.maxDate,r=n.includeDates;if(r&&t){var s=r.filter(function(a){return Hu(a,t)<=0});return R1(s)}return r?R1(r):t}function iw(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"react-datepicker__day--highlighted",r=new Map,s=0,a=n.length;s<a;s++){var o=n[s];if(sf(o)){var i=ln(o,"MM.dd.yyyy"),l=r.get(i)||[];l.includes(t)||(l.push(t),r.set(i,l))}else if(hx(o)==="object"){var c=Object.keys(o),d=c[0],u=o[c[0]];if(typeof d=="string"&&u.constructor===Array)for(var h=0,p=u.length;h<p;h++){var g=ln(u[h],"MM.dd.yyyy"),f=r.get(g)||[];f.includes(d)||(f.push(d),r.set(g,f))}}}return r}function OR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"react-datepicker__day--holidays",r=new Map;return n.forEach(function(s){var a=s.date,o=s.holidayName;if(sf(a)){var i=ln(a,"MM.dd.yyyy"),l=r.get(i)||{};if(!("className"in l)||l.className!==t||(c=l.holidayNames,d=[o],c.length!==d.length||!c.every(function(h,p){return h===d[p]}))){var c,d;l.className=t;var u=l.holidayNames;l.holidayNames=u?[].concat(Ju(u),[o]):[o],r.set(i,l)}}}),r}function zR(n,t,r,s,a){for(var o=a.length,i=[],l=0;l<o;l++){var c=rx(NP(n,xo(a[l])),go(a[l])),d=rx(n,(r+1)*s);Vo(c,t)&&Si(c,d)&&i.push(a[l])}return i}function lw(n){return n<10?"0".concat(n):"".concat(n)}function Wc(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yu,r=Math.ceil(br(n)/t)*t;return{startPeriod:r-(t-1),endPeriod:r}}function cw(n){var t=n.getSeconds(),r=n.getMilliseconds();return Pt(n.getTime()-1e3*t-r)}function FR(n,t,r,s){for(var a=[],o=0;o<2*t+1;o++){var i=n+t-o,l=!0;r&&(l=br(r)<=i),s&&l&&(l=br(s)>=i),l&&a.push(i)}return a}var WR=of(function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;Qn(this,r),ie(de(a=t.call(this,s)),"renderOptions",function(){var c=a.props.year,d=a.state.yearsList.map(function(p){return Te.createElement("div",{className:c===p?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:p,onClick:a.onChange.bind(de(a),p),"aria-selected":c===p?"true":void 0},c===p?Te.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",p)}),u=a.props.minDate?br(a.props.minDate):null,h=a.props.maxDate?br(a.props.maxDate):null;return h&&a.state.yearsList.find(function(p){return p===h})||d.unshift(Te.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:a.incrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),u&&a.state.yearsList.find(function(p){return p===u})||d.push(Te.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:a.decrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),d}),ie(de(a),"onChange",function(c){a.props.onChange(c)}),ie(de(a),"handleClickOutside",function(){a.props.onCancel()}),ie(de(a),"shiftYears",function(c){var d=a.state.yearsList.map(function(u){return u+c});a.setState({yearsList:d})}),ie(de(a),"incrementYears",function(){return a.shiftYears(1)}),ie(de(a),"decrementYears",function(){return a.shiftYears(-1)});var o=s.yearDropdownItemNumber,i=s.scrollableYearDropdown,l=o||(i?10:5);return a.state={yearsList:FR(a.props.year,l,a.props.minDate,a.props.maxDate)},a.dropdownRef=y.createRef(),a}return Zn(r,[{key:"componentDidMount",value:function(){var s=this.dropdownRef.current;if(s){var a=s.children?Array.from(s.children):null,o=a?a.find(function(i){return i.ariaSelected}):null;s.scrollTop=o?o.offsetTop+(o.clientHeight-s.clientHeight)/2:(s.scrollHeight-s.clientHeight)/2}}},{key:"render",value:function(){var s=ds({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Te.createElement("div",{className:s,ref:this.dropdownRef},this.renderOptions())}}]),r}()),UR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),ie(de(s),"renderSelectOptions",function(){for(var l=s.props.minDate?br(s.props.minDate):1900,c=s.props.maxDate?br(s.props.maxDate):2100,d=[],u=l;u<=c;u++)d.push(Te.createElement("option",{key:u,value:u},u));return d}),ie(de(s),"onSelectChange",function(l){s.onChange(l.target.value)}),ie(de(s),"renderSelectMode",function(){return Te.createElement("select",{value:s.props.year,className:"react-datepicker__year-select",onChange:s.onSelectChange},s.renderSelectOptions())}),ie(de(s),"renderReadView",function(l){return Te.createElement("div",{key:"read",style:{visibility:l?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(c){return s.toggleDropdown(c)}},Te.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},s.props.year))}),ie(de(s),"renderDropdown",function(){return Te.createElement(WR,{key:"dropdown",year:s.props.year,onChange:s.onChange,onCancel:s.toggleDropdown,minDate:s.props.minDate,maxDate:s.props.maxDate,scrollableYearDropdown:s.props.scrollableYearDropdown,yearDropdownItemNumber:s.props.yearDropdownItemNumber})}),ie(de(s),"renderScrollMode",function(){var l=s.state.dropdownVisible,c=[s.renderReadView(!l)];return l&&c.unshift(s.renderDropdown()),c}),ie(de(s),"onChange",function(l){s.toggleDropdown(),l!==s.props.year&&s.props.onChange(l)}),ie(de(s),"toggleDropdown",function(l){s.setState({dropdownVisible:!s.state.dropdownVisible},function(){s.props.adjustDateOnChange&&s.handleYearChange(s.props.date,l)})}),ie(de(s),"handleYearChange",function(l,c){s.onSelect(l,c),s.setOpen()}),ie(de(s),"onSelect",function(l,c){s.props.onSelect&&s.props.onSelect(l,c)}),ie(de(s),"setOpen",function(){s.props.setOpen&&s.props.setOpen(!0)}),s}return Zn(r,[{key:"render",value:function(){var s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode();break;case"select":s=this.renderSelectMode()}return Te.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},s)}}]),r}(),qR=of(function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"isSelectedMonth",function(l){return s.props.month===l}),ie(de(s),"renderOptions",function(){return s.props.monthNames.map(function(l,c){return Te.createElement("div",{className:s.isSelectedMonth(c)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:l,onClick:s.onChange.bind(de(s),c),"aria-selected":s.isSelectedMonth(c)?"true":void 0},s.isSelectedMonth(c)?Te.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",l)})}),ie(de(s),"onChange",function(l){return s.props.onChange(l)}),ie(de(s),"handleClickOutside",function(){return s.props.onCancel()}),s}return Zn(r,[{key:"render",value:function(){return Te.createElement("div",{className:"react-datepicker__month-dropdown"},this.renderOptions())}}]),r}()),HR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),ie(de(s),"renderSelectOptions",function(l){return l.map(function(c,d){return Te.createElement("option",{key:d,value:d},c)})}),ie(de(s),"renderSelectMode",function(l){return Te.createElement("select",{value:s.props.month,className:"react-datepicker__month-select",onChange:function(c){return s.onChange(c.target.value)}},s.renderSelectOptions(l))}),ie(de(s),"renderReadView",function(l,c){return Te.createElement("div",{key:"read",style:{visibility:l?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:s.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},c[s.props.month]))}),ie(de(s),"renderDropdown",function(l){return Te.createElement(qR,{key:"dropdown",month:s.props.month,monthNames:l,onChange:s.onChange,onCancel:s.toggleDropdown})}),ie(de(s),"renderScrollMode",function(l){var c=s.state.dropdownVisible,d=[s.renderReadView(!c,l)];return c&&d.unshift(s.renderDropdown(l)),d}),ie(de(s),"onChange",function(l){s.toggleDropdown(),l!==s.props.month&&s.props.onChange(l)}),ie(de(s),"toggleDropdown",function(){return s.setState({dropdownVisible:!s.state.dropdownVisible})}),s}return Zn(r,[{key:"render",value:function(){var s,a=this,o=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(i){return V_(i,a.props.locale)}:function(i){return bb(i,a.props.locale)});switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode(o);break;case"select":s=this.renderSelectMode(o)}return Te.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},s)}}]),r}();function YR(n,t){for(var r=[],s=Mi(n),a=Mi(t);!Vo(s,a);)r.push(Wr(s)),s=Va(s,1);return r}var GR=of(function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"renderOptions",function(){return a.state.monthYearsList.map(function(o){var i=nx(o),l=_i(a.props.date,o)&&Ua(a.props.date,o);return Te.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:i,onClick:a.onChange.bind(de(a),i),"aria-selected":l?"true":void 0},l?Te.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",ln(o,a.props.dateFormat,a.props.locale))})}),ie(de(a),"onChange",function(o){return a.props.onChange(o)}),ie(de(a),"handleClickOutside",function(){a.props.onCancel()}),a.state={monthYearsList:YR(a.props.minDate,a.props.maxDate)},a}return Zn(r,[{key:"render",value:function(){var s=ds({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Te.createElement("div",{className:s},this.renderOptions())}}]),r}()),VR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"state",{dropdownVisible:!1}),ie(de(s),"renderSelectOptions",function(){for(var l=Mi(s.props.minDate),c=Mi(s.props.maxDate),d=[];!Vo(l,c);){var u=nx(l);d.push(Te.createElement("option",{key:u,value:u},ln(l,s.props.dateFormat,s.props.locale))),l=Va(l,1)}return d}),ie(de(s),"onSelectChange",function(l){s.onChange(l.target.value)}),ie(de(s),"renderSelectMode",function(){return Te.createElement("select",{value:nx(Mi(s.props.date)),className:"react-datepicker__month-year-select",onChange:s.onSelectChange},s.renderSelectOptions())}),ie(de(s),"renderReadView",function(l){var c=ln(s.props.date,s.props.dateFormat,s.props.locale);return Te.createElement("div",{key:"read",style:{visibility:l?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:function(d){return s.toggleDropdown(d)}},Te.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},c))}),ie(de(s),"renderDropdown",function(){return Te.createElement(GR,{key:"dropdown",date:s.props.date,dateFormat:s.props.dateFormat,onChange:s.onChange,onCancel:s.toggleDropdown,minDate:s.props.minDate,maxDate:s.props.maxDate,scrollableMonthYearDropdown:s.props.scrollableMonthYearDropdown,locale:s.props.locale})}),ie(de(s),"renderScrollMode",function(){var l=s.state.dropdownVisible,c=[s.renderReadView(!l)];return l&&c.unshift(s.renderDropdown()),c}),ie(de(s),"onChange",function(l){s.toggleDropdown();var c=Wr(parseInt(l));_i(s.props.date,c)&&Ua(s.props.date,c)||s.props.onChange(c)}),ie(de(s),"toggleDropdown",function(){return s.setState({dropdownVisible:!s.state.dropdownVisible})}),s}return Zn(r,[{key:"render",value:function(){var s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode();break;case"select":s=this.renderSelectMode()}return Te.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},s)}}]),r}(),KR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"dayEl",Te.createRef()),ie(de(s),"handleClick",function(l){!s.isDisabled()&&s.props.onClick&&s.props.onClick(l)}),ie(de(s),"handleMouseEnter",function(l){!s.isDisabled()&&s.props.onMouseEnter&&s.props.onMouseEnter(l)}),ie(de(s),"handleOnKeyDown",function(l){l.key===" "&&(l.preventDefault(),l.key="Enter"),s.props.handleOnKeyDown(l)}),ie(de(s),"isSameDay",function(l){return Vr(s.props.day,l)}),ie(de(s),"isKeyboardSelected",function(){return!s.props.disabledKeyboardNavigation&&!(s.isSameDay(s.props.selected)||s.isSameWeek(s.props.selected))&&(s.isSameDay(s.props.preSelection)||s.isSameWeek(s.props.preSelection))}),ie(de(s),"isDisabled",function(){return cf(s.props.day,s.props)}),ie(de(s),"isExcluded",function(){return vb(s.props.day,s.props)}),ie(de(s),"isStartOfWeek",function(){return Vr(s.props.day,vo(s.props.day,s.props.locale,s.props.calendarStartDay))}),ie(de(s),"isSameWeek",function(l){return s.props.showWeekPicker&&Vr(l,vo(s.props.day,s.props.locale,s.props.calendarStartDay))}),ie(de(s),"getHighLightedClass",function(){var l=s.props,c=l.day,d=l.highlightDates;if(!d)return!1;var u=ln(c,"MM.dd.yyyy");return d.get(u)}),ie(de(s),"getHolidaysClass",function(){var l=s.props,c=l.day,d=l.holidays;if(!d)return!1;var u=ln(c,"MM.dd.yyyy");return d.has(u)?[d.get(u).className]:void 0}),ie(de(s),"isInRange",function(){var l=s.props,c=l.day,d=l.startDate,u=l.endDate;return!(!d||!u)&&Ep(c,d,u)}),ie(de(s),"isInSelectingRange",function(){var l,c=s.props,d=c.day,u=c.selectsStart,h=c.selectsEnd,p=c.selectsRange,g=c.selectsDisabledDaysInRange,f=c.startDate,m=c.endDate,v=(l=s.props.selectingDate)!==null&&l!==void 0?l:s.props.preSelection;return!(!(u||h||p)||!v||!g&&s.isDisabled())&&(u&&m&&(Si(v,m)||Sl(v,m))?Ep(d,v,m):(h&&f&&(Vo(v,f)||Sl(v,f))||!(!p||!f||m||!Vo(v,f)&&!Sl(v,f)))&&Ep(d,f,v))}),ie(de(s),"isSelectingRangeStart",function(){var l;if(!s.isInSelectingRange())return!1;var c=s.props,d=c.day,u=c.startDate,h=c.selectsStart,p=(l=s.props.selectingDate)!==null&&l!==void 0?l:s.props.preSelection;return Vr(d,h?p:u)}),ie(de(s),"isSelectingRangeEnd",function(){var l;if(!s.isInSelectingRange())return!1;var c=s.props,d=c.day,u=c.endDate,h=c.selectsEnd,p=c.selectsRange,g=(l=s.props.selectingDate)!==null&&l!==void 0?l:s.props.preSelection;return Vr(d,h||p?g:u)}),ie(de(s),"isRangeStart",function(){var l=s.props,c=l.day,d=l.startDate,u=l.endDate;return!(!d||!u)&&Vr(d,c)}),ie(de(s),"isRangeEnd",function(){var l=s.props,c=l.day,d=l.startDate,u=l.endDate;return!(!d||!u)&&Vr(u,c)}),ie(de(s),"isWeekend",function(){var l=EP(s.props.day);return l===0||l===6}),ie(de(s),"isAfterMonth",function(){return s.props.month!==void 0&&(s.props.month+1)%12===ws(s.props.day)}),ie(de(s),"isBeforeMonth",function(){return s.props.month!==void 0&&(ws(s.props.day)+1)%12===s.props.month}),ie(de(s),"isCurrentDay",function(){return s.isSameDay(Wr())}),ie(de(s),"isSelected",function(){return s.isSameDay(s.props.selected)||s.isSameWeek(s.props.selected)}),ie(de(s),"getClassNames",function(l){var c,d=s.props.dayClassName?s.props.dayClassName(l):void 0;return ds("react-datepicker__day",d,"react-datepicker__day--"+ln(s.props.day,"ddd",c),{"react-datepicker__day--disabled":s.isDisabled(),"react-datepicker__day--excluded":s.isExcluded(),"react-datepicker__day--selected":s.isSelected(),"react-datepicker__day--keyboard-selected":s.isKeyboardSelected(),"react-datepicker__day--range-start":s.isRangeStart(),"react-datepicker__day--range-end":s.isRangeEnd(),"react-datepicker__day--in-range":s.isInRange(),"react-datepicker__day--in-selecting-range":s.isInSelectingRange(),"react-datepicker__day--selecting-range-start":s.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":s.isSelectingRangeEnd(),"react-datepicker__day--today":s.isCurrentDay(),"react-datepicker__day--weekend":s.isWeekend(),"react-datepicker__day--outside-month":s.isAfterMonth()||s.isBeforeMonth()},s.getHighLightedClass("react-datepicker__day--highlighted"),s.getHolidaysClass())}),ie(de(s),"getAriaLabel",function(){var l=s.props,c=l.day,d=l.ariaLabelPrefixWhenEnabled,u=d===void 0?"Choose":d,h=l.ariaLabelPrefixWhenDisabled,p=h===void 0?"Not available":h,g=s.isDisabled()||s.isExcluded()?p:u;return"".concat(g," ").concat(ln(c,"PPPP",s.props.locale))}),ie(de(s),"getTitle",function(){var l=s.props,c=l.day,d=l.holidays,u=d===void 0?new Map:d,h=ln(c,"MM.dd.yyyy");return u.has(h)&&u.get(h).holidayNames.length>0?u.get(h).holidayNames.join(", "):""}),ie(de(s),"getTabIndex",function(l,c){var d=l||s.props.selected,u=c||s.props.preSelection;return(!s.props.showWeekPicker||!s.props.showWeekNumber&&s.isStartOfWeek())&&(s.isKeyboardSelected()||s.isSameDay(d)&&Vr(u,d))?0:-1}),ie(de(s),"handleFocusDay",function(){var l,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=!1;s.getTabIndex()===0&&!c.isInputFocused&&s.isSameDay(s.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(d=!0),s.props.inline&&!s.props.shouldFocusDayInline&&(d=!1),s.props.containerRef&&s.props.containerRef.current&&s.props.containerRef.current.contains(document.activeElement)&&document.activeElement.classList.contains("react-datepicker__day")&&(d=!0),s.props.monthShowsDuplicateDaysEnd&&s.isAfterMonth()&&(d=!1),s.props.monthShowsDuplicateDaysStart&&s.isBeforeMonth()&&(d=!1)),d&&((l=s.dayEl.current)===null||l===void 0||l.focus({preventScroll:!0}))}),ie(de(s),"renderDayContents",function(){return s.props.monthShowsDuplicateDaysEnd&&s.isAfterMonth()||s.props.monthShowsDuplicateDaysStart&&s.isBeforeMonth()?null:s.props.renderDayContents?s.props.renderDayContents(P1(s.props.day),s.props.day):P1(s.props.day)}),ie(de(s),"render",function(){return Te.createElement("div",{ref:s.dayEl,className:s.getClassNames(s.props.day),onKeyDown:s.handleOnKeyDown,onClick:s.handleClick,onMouseEnter:s.handleMouseEnter,tabIndex:s.getTabIndex(),"aria-label":s.getAriaLabel(),role:"option",title:s.getTitle(),"aria-disabled":s.isDisabled(),"aria-current":s.isCurrentDay()?"date":void 0,"aria-selected":s.isSelected()||s.isInRange()},s.renderDayContents(),s.getTitle()!==""&&Te.createElement("span",{className:"holiday-overlay"},s.getTitle()))}),s}return Zn(r,[{key:"componentDidMount",value:function(){this.handleFocusDay()}},{key:"componentDidUpdate",value:function(s){this.handleFocusDay(s)}}]),r}(),JR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"weekNumberEl",Te.createRef()),ie(de(s),"handleClick",function(l){s.props.onClick&&s.props.onClick(l)}),ie(de(s),"handleOnKeyDown",function(l){l.key===" "&&(l.preventDefault(),l.key="Enter"),s.props.handleOnKeyDown(l)}),ie(de(s),"isKeyboardSelected",function(){return!s.props.disabledKeyboardNavigation&&!Vr(s.props.date,s.props.selected)&&Vr(s.props.date,s.props.preSelection)}),ie(de(s),"getTabIndex",function(){return s.props.showWeekPicker&&s.props.showWeekNumber&&(s.isKeyboardSelected()||Vr(s.props.date,s.props.selected)&&Vr(s.props.preSelection,s.props.selected))?0:-1}),ie(de(s),"handleFocusWeekNumber",function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=!1;s.getTabIndex()===0&&!l.isInputFocused&&Vr(s.props.date,s.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(c=!0),s.props.inline&&!s.props.shouldFocusDayInline&&(c=!1),s.props.containerRef&&s.props.containerRef.current&&s.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(c=!0)),c&&s.weekNumberEl.current&&s.weekNumberEl.current.focus({preventScroll:!0})}),s}return Zn(r,[{key:"componentDidMount",value:function(){this.handleFocusWeekNumber()}},{key:"componentDidUpdate",value:function(s){this.handleFocusWeekNumber(s)}},{key:"render",value:function(){var s=this.props,a=s.weekNumber,o=s.ariaLabelPrefix,i=o===void 0?"week ":o,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!s.onClick,"react-datepicker__week-number--selected":Vr(this.props.date,this.props.selected),"react-datepicker__week-number--keyboard-selected":this.isKeyboardSelected()};return Te.createElement("div",{ref:this.weekNumberEl,className:ds(l),"aria-label":"".concat(i," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},a)}}],[{key:"defaultProps",get:function(){return{ariaLabelPrefix:"week "}}}]),r}(),XR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"handleDayClick",function(l,c){s.props.onDayClick&&s.props.onDayClick(l,c)}),ie(de(s),"handleDayMouseEnter",function(l){s.props.onDayMouseEnter&&s.props.onDayMouseEnter(l)}),ie(de(s),"handleWeekClick",function(l,c,d){if(typeof s.props.onWeekSelect=="function"&&s.props.onWeekSelect(l,c,d),s.props.showWeekPicker){var u=vo(l,s.props.locale,s.props.calendarStartDay);s.handleDayClick(u,d)}s.props.shouldCloseOnSelect&&s.props.setOpen(!1)}),ie(de(s),"formatWeekNumber",function(l){return s.props.formatWeekNumber?s.props.formatWeekNumber(l):function(c,d){var u=d&&Ii(d)||Al()&&Ii(Al());return IP(c,u?{locale:u}:null)}(l)}),ie(de(s),"renderDays",function(){var l=vo(s.props.day,s.props.locale,s.props.calendarStartDay),c=[],d=s.formatWeekNumber(l);if(s.props.showWeekNumber){var u=s.props.onWeekSelect||s.props.showWeekPicker?s.handleWeekClick.bind(de(s),l,d):void 0;c.push(Te.createElement(JR,{key:"W",weekNumber:d,date:l,onClick:u,selected:s.props.selected,preSelection:s.props.preSelection,ariaLabelPrefix:s.props.ariaLabelPrefix,showWeekPicker:s.props.showWeekPicker,showWeekNumber:s.props.showWeekNumber,disabledKeyboardNavigation:s.props.disabledKeyboardNavigation,handleOnKeyDown:s.props.handleOnKeyDown,isInputFocused:s.props.isInputFocused,containerRef:s.props.containerRef}))}return c.concat([0,1,2,3,4,5,6].map(function(h){var p=jd(l,h);return Te.createElement(KR,{ariaLabelPrefixWhenEnabled:s.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:s.props.disabledDayAriaLabelPrefix,key:p.valueOf(),day:p,month:s.props.month,onClick:s.handleDayClick.bind(de(s),p),onMouseEnter:s.handleDayMouseEnter.bind(de(s),p),minDate:s.props.minDate,maxDate:s.props.maxDate,excludeDates:s.props.excludeDates,excludeDateIntervals:s.props.excludeDateIntervals,includeDates:s.props.includeDates,includeDateIntervals:s.props.includeDateIntervals,highlightDates:s.props.highlightDates,holidays:s.props.holidays,selectingDate:s.props.selectingDate,filterDate:s.props.filterDate,preSelection:s.props.preSelection,selected:s.props.selected,selectsStart:s.props.selectsStart,selectsEnd:s.props.selectsEnd,selectsRange:s.props.selectsRange,showWeekPicker:s.props.showWeekPicker,showWeekNumber:s.props.showWeekNumber,selectsDisabledDaysInRange:s.props.selectsDisabledDaysInRange,startDate:s.props.startDate,endDate:s.props.endDate,dayClassName:s.props.dayClassName,renderDayContents:s.props.renderDayContents,disabledKeyboardNavigation:s.props.disabledKeyboardNavigation,handleOnKeyDown:s.props.handleOnKeyDown,isInputFocused:s.props.isInputFocused,containerRef:s.props.containerRef,inline:s.props.inline,shouldFocusDayInline:s.props.shouldFocusDayInline,monthShowsDuplicateDaysEnd:s.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:s.props.monthShowsDuplicateDaysStart,locale:s.props.locale})}))}),ie(de(s),"startOfWeek",function(){return vo(s.props.day,s.props.locale,s.props.calendarStartDay)}),ie(de(s),"isKeyboardSelected",function(){return!s.props.disabledKeyboardNavigation&&!Vr(s.startOfWeek(),s.props.selected)&&Vr(s.startOfWeek(),s.props.preSelection)}),s}return Zn(r,[{key:"render",value:function(){var s={"react-datepicker__week":!0,"react-datepicker__week--selected":Vr(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Te.createElement("div",{className:ds(s)},this.renderDays())}}],[{key:"defaultProps",get:function(){return{shouldCloseOnSelect:!0}}}]),r}(),Z_="two_columns",ek="three_columns",tk="four_columns",pg=ie(ie(ie({},Z_,{grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2}),ek,{grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3}),tk,{grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4});function dw(n,t){return n?tk:t?Z_:ek}var QR=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"MONTH_REFS",Ju(Array(12)).map(function(){return Te.createRef()})),ie(de(s),"QUARTER_REFS",Ju(Array(4)).map(function(){return Te.createRef()})),ie(de(s),"isDisabled",function(l){return cf(l,s.props)}),ie(de(s),"isExcluded",function(l){return vb(l,s.props)}),ie(de(s),"handleDayClick",function(l,c){s.props.onDayClick&&s.props.onDayClick(l,c,s.props.orderInDisplay)}),ie(de(s),"handleDayMouseEnter",function(l){s.props.onDayMouseEnter&&s.props.onDayMouseEnter(l)}),ie(de(s),"handleMouseLeave",function(){s.props.onMouseLeave&&s.props.onMouseLeave()}),ie(de(s),"isRangeStartMonth",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate;return!(!u||!h)&&Ua(Rs(d,l),u)}),ie(de(s),"isRangeStartQuarter",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate;return!(!u||!h)&&vm(oc(d,l),u)}),ie(de(s),"isRangeEndMonth",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate;return!(!u||!h)&&Ua(Rs(d,l),h)}),ie(de(s),"isRangeEndQuarter",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate;return!(!u||!h)&&vm(oc(d,l),h)}),ie(de(s),"isInSelectingRangeMonth",function(l){var c,d=s.props,u=d.day,h=d.selectsStart,p=d.selectsEnd,g=d.selectsRange,f=d.startDate,m=d.endDate,v=(c=s.props.selectingDate)!==null&&c!==void 0?c:s.props.preSelection;return!(!(h||p||g)||!v)&&(h&&m?dg(v,m,l,u):(p&&f||!(!g||!f||m))&&dg(f,v,l,u))}),ie(de(s),"isSelectingMonthRangeStart",function(l){var c;if(!s.isInSelectingRangeMonth(l))return!1;var d=s.props,u=d.day,h=d.startDate,p=d.selectsStart,g=Rs(u,l),f=(c=s.props.selectingDate)!==null&&c!==void 0?c:s.props.preSelection;return Ua(g,p?f:h)}),ie(de(s),"isSelectingMonthRangeEnd",function(l){var c;if(!s.isInSelectingRangeMonth(l))return!1;var d=s.props,u=d.day,h=d.endDate,p=d.selectsEnd,g=d.selectsRange,f=Rs(u,l),m=(c=s.props.selectingDate)!==null&&c!==void 0?c:s.props.preSelection;return Ua(f,p||g?m:h)}),ie(de(s),"isInSelectingRangeQuarter",function(l){var c,d=s.props,u=d.day,h=d.selectsStart,p=d.selectsEnd,g=d.selectsRange,f=d.startDate,m=d.endDate,v=(c=s.props.selectingDate)!==null&&c!==void 0?c:s.props.preSelection;return!(!(h||p||g)||!v)&&(h&&m?hg(v,m,l,u):(p&&f||!(!g||!f||m))&&hg(f,v,l,u))}),ie(de(s),"isWeekInMonth",function(l){var c=s.props.day,d=jd(l,6);return Ua(l,c)||Ua(d,c)}),ie(de(s),"isCurrentMonth",function(l,c){return br(l)===br(Wr())&&c===ws(Wr())}),ie(de(s),"isCurrentQuarter",function(l,c){return br(l)===br(Wr())&&c===Fc(Wr())}),ie(de(s),"isSelectedMonth",function(l,c,d){return ws(d)===c&&br(l)===br(d)}),ie(de(s),"isSelectedQuarter",function(l,c,d){return Fc(l)===c&&br(l)===br(d)}),ie(de(s),"renderWeeks",function(){for(var l=[],c=s.props.fixedHeight,d=0,u=!1,h=vo(Mi(s.props.day),s.props.locale,s.props.calendarStartDay);l.push(Te.createElement(XR,{ariaLabelPrefix:s.props.weekAriaLabelPrefix,chooseDayAriaLabelPrefix:s.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:s.props.disabledDayAriaLabelPrefix,key:d,day:h,month:ws(s.props.day),onDayClick:s.handleDayClick,onDayMouseEnter:s.handleDayMouseEnter,onWeekSelect:s.props.onWeekSelect,formatWeekNumber:s.props.formatWeekNumber,locale:s.props.locale,minDate:s.props.minDate,maxDate:s.props.maxDate,excludeDates:s.props.excludeDates,excludeDateIntervals:s.props.excludeDateIntervals,includeDates:s.props.includeDates,includeDateIntervals:s.props.includeDateIntervals,inline:s.props.inline,shouldFocusDayInline:s.props.shouldFocusDayInline,highlightDates:s.props.highlightDates,holidays:s.props.holidays,selectingDate:s.props.selectingDate,filterDate:s.props.filterDate,preSelection:s.props.preSelection,selected:s.props.selected,selectsStart:s.props.selectsStart,selectsEnd:s.props.selectsEnd,selectsRange:s.props.selectsRange,selectsDisabledDaysInRange:s.props.selectsDisabledDaysInRange,showWeekNumber:s.props.showWeekNumbers,showWeekPicker:s.props.showWeekPicker,startDate:s.props.startDate,endDate:s.props.endDate,dayClassName:s.props.dayClassName,setOpen:s.props.setOpen,shouldCloseOnSelect:s.props.shouldCloseOnSelect,disabledKeyboardNavigation:s.props.disabledKeyboardNavigation,renderDayContents:s.props.renderDayContents,handleOnKeyDown:s.props.handleOnKeyDown,isInputFocused:s.props.isInputFocused,containerRef:s.props.containerRef,calendarStartDay:s.props.calendarStartDay,monthShowsDuplicateDaysEnd:s.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:s.props.monthShowsDuplicateDaysStart})),!u;){d++,h=hm(h,1);var p=c&&d>=6,g=!c&&!s.isWeekInMonth(h);if(p||g){if(!s.props.peekNextMonth)break;u=!0}}return l}),ie(de(s),"onMonthClick",function(l,c){s.handleDayClick(Mi(Rs(s.props.day,c)),l)}),ie(de(s),"onMonthMouseEnter",function(l){s.handleDayMouseEnter(Mi(Rs(s.props.day,l)))}),ie(de(s),"handleMonthNavigation",function(l,c){s.isDisabled(c)||s.isExcluded(c)||(s.props.setPreSelection(c),s.MONTH_REFS[l].current&&s.MONTH_REFS[l].current.focus())}),ie(de(s),"onMonthKeyDown",function(l,c){var d=s.props,u=d.selected,h=d.preSelection,p=d.disabledKeyboardNavigation,g=d.showTwoColumnMonthYearPicker,f=d.showFourColumnMonthYearPicker,m=d.setPreSelection,v=l.key;if(v!=="Tab"&&l.preventDefault(),!p){var b=dw(f,g),w=pg[b].verticalNavigationOffset,x=pg[b].grid;switch(v){case"Enter":s.onMonthClick(l,c),m(u);break;case"ArrowRight":s.handleMonthNavigation(c===11?0:c+1,Va(h,1));break;case"ArrowLeft":s.handleMonthNavigation(c===0?11:c-1,ud(h,1));break;case"ArrowUp":s.handleMonthNavigation(x[0].includes(c)?c+12-w:c-w,ud(h,w));break;case"ArrowDown":s.handleMonthNavigation(x[x.length-1].includes(c)?c-12+w:c+w,Va(h,w))}}}),ie(de(s),"onQuarterClick",function(l,c){s.handleDayClick(Q1(oc(s.props.day,c)),l)}),ie(de(s),"onQuarterMouseEnter",function(l){s.handleDayMouseEnter(Q1(oc(s.props.day,l)))}),ie(de(s),"handleQuarterNavigation",function(l,c){s.isDisabled(c)||s.isExcluded(c)||(s.props.setPreSelection(c),s.QUARTER_REFS[l-1].current&&s.QUARTER_REFS[l-1].current.focus())}),ie(de(s),"onQuarterKeyDown",function(l,c){var d=l.key;if(!s.props.disabledKeyboardNavigation)switch(d){case"Enter":s.onQuarterClick(l,c),s.props.setPreSelection(s.props.selected);break;case"ArrowRight":s.handleQuarterNavigation(c===4?1:c+1,j_(s.props.preSelection,1));break;case"ArrowLeft":s.handleQuarterNavigation(c===1?4:c-1,PP(s.props.preSelection,1))}}),ie(de(s),"getMonthClassNames",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate,p=c.selected,g=c.minDate,f=c.maxDate,m=c.preSelection,v=c.monthClassName,b=c.excludeDates,w=c.includeDates,x=v?v(Rs(d,l)):void 0,j=Rs(d,l);return ds("react-datepicker__month-text","react-datepicker__month-".concat(l),x,{"react-datepicker__month-text--disabled":(g||f||b||w)&&K_(j,s.props),"react-datepicker__month-text--selected":s.isSelectedMonth(d,l,p),"react-datepicker__month-text--keyboard-selected":!s.props.disabledKeyboardNavigation&&ws(m)===l,"react-datepicker__month-text--in-selecting-range":s.isInSelectingRangeMonth(l),"react-datepicker__month-text--in-range":dg(u,h,l,d),"react-datepicker__month-text--range-start":s.isRangeStartMonth(l),"react-datepicker__month-text--range-end":s.isRangeEndMonth(l),"react-datepicker__month-text--selecting-range-start":s.isSelectingMonthRangeStart(l),"react-datepicker__month-text--selecting-range-end":s.isSelectingMonthRangeEnd(l),"react-datepicker__month-text--today":s.isCurrentMonth(d,l)})}),ie(de(s),"getTabIndex",function(l){var c=ws(s.props.preSelection);return s.props.disabledKeyboardNavigation||l!==c?"-1":"0"}),ie(de(s),"getQuarterTabIndex",function(l){var c=Fc(s.props.preSelection);return s.props.disabledKeyboardNavigation||l!==c?"-1":"0"}),ie(de(s),"getAriaLabel",function(l){var c=s.props,d=c.chooseDayAriaLabelPrefix,u=d===void 0?"Choose":d,h=c.disabledDayAriaLabelPrefix,p=h===void 0?"Not available":h,g=c.day,f=Rs(g,l),m=s.isDisabled(f)||s.isExcluded(f)?p:u;return"".concat(m," ").concat(ln(f,"MMMM yyyy"))}),ie(de(s),"getQuarterClassNames",function(l){var c=s.props,d=c.day,u=c.startDate,h=c.endDate,p=c.selected,g=c.minDate,f=c.maxDate,m=c.preSelection,v=c.disabledKeyboardNavigation;return ds("react-datepicker__quarter-text","react-datepicker__quarter-".concat(l),{"react-datepicker__quarter-text--disabled":(g||f)&&BR(oc(d,l),s.props),"react-datepicker__quarter-text--selected":s.isSelectedQuarter(d,l,p),"react-datepicker__quarter-text--keyboard-selected":!v&&Fc(m)===l,"react-datepicker__quarter-text--in-selecting-range":s.isInSelectingRangeQuarter(l),"react-datepicker__quarter-text--in-range":hg(u,h,l,d),"react-datepicker__quarter-text--range-start":s.isRangeStartQuarter(l),"react-datepicker__quarter-text--range-end":s.isRangeEndQuarter(l)})}),ie(de(s),"getMonthContent",function(l){var c=s.props,d=c.showFullMonthYearPicker,u=c.renderMonthContent,h=c.locale,p=c.day,g=V_(l,h),f=bb(l,h);return u?u(l,g,f,p):d?f:g}),ie(de(s),"getQuarterContent",function(l){var c=s.props,d=c.renderQuarterContent,u=function(h,p){return ln(oc(Wr(),h),"QQQ",p)}(l,c.locale);return d?d(l,u):u}),ie(de(s),"renderMonths",function(){var l=s.props,c=l.showTwoColumnMonthYearPicker,d=l.showFourColumnMonthYearPicker,u=l.day,h=l.selected;return pg[dw(d,c)].grid.map(function(p,g){return Te.createElement("div",{className:"react-datepicker__month-wrapper",key:g},p.map(function(f,m){return Te.createElement("div",{ref:s.MONTH_REFS[f],key:m,onClick:function(v){s.onMonthClick(v,f)},onKeyDown:function(v){s.onMonthKeyDown(v,f)},onMouseEnter:function(){return s.onMonthMouseEnter(f)},tabIndex:s.getTabIndex(f),className:s.getMonthClassNames(f),role:"option","aria-label":s.getAriaLabel(f),"aria-current":s.isCurrentMonth(u,f)?"date":void 0,"aria-selected":s.isSelectedMonth(u,f,h)},s.getMonthContent(f))}))})}),ie(de(s),"renderQuarters",function(){var l=s.props,c=l.day,d=l.selected;return Te.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map(function(u,h){return Te.createElement("div",{key:h,ref:s.QUARTER_REFS[h],role:"option",onClick:function(p){s.onQuarterClick(p,u)},onKeyDown:function(p){s.onQuarterKeyDown(p,u)},onMouseEnter:function(){return s.onQuarterMouseEnter(u)},className:s.getQuarterClassNames(u),"aria-selected":s.isSelectedQuarter(c,u,d),tabIndex:s.getQuarterTabIndex(u),"aria-current":s.isCurrentQuarter(c,u)?"date":void 0},s.getQuarterContent(u))}))}),ie(de(s),"getClassNames",function(){var l=s.props,c=l.selectingDate,d=l.selectsStart,u=l.selectsEnd,h=l.showMonthYearPicker,p=l.showQuarterYearPicker,g=l.showWeekPicker;return ds("react-datepicker__month",{"react-datepicker__month--selecting-range":c&&(d||u)},{"react-datepicker__monthPicker":h},{"react-datepicker__quarterPicker":p},{"react-datepicker__weekPicker":g})}),s}return Zn(r,[{key:"render",value:function(){var s=this.props,a=s.showMonthYearPicker,o=s.showQuarterYearPicker,i=s.day,l=s.ariaLabelPrefix,c=l===void 0?"month ":l;return Te.createElement("div",{className:this.getClassNames(),onMouseLeave:this.handleMouseLeave,"aria-label":"".concat(c," ").concat(ln(i,"yyyy-MM")),role:"listbox"},a?this.renderMonths():o?this.renderQuarters():this.renderWeeks())}}]),r}(),rk=function(n){es(r,Te.Component);var t=ts(r);function r(){var s;Qn(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ie(de(s=t.call.apply(t,[this].concat(o))),"state",{height:null}),ie(de(s),"scrollToTheSelectedTime",function(){requestAnimationFrame(function(){s.list&&(s.list.scrollTop=s.centerLi&&r.calcCenterPosition(s.props.monthRef?s.props.monthRef.clientHeight-s.header.clientHeight:s.list.clientHeight,s.centerLi))})}),ie(de(s),"handleClick",function(l){(s.props.minTime||s.props.maxTime)&&rw(l,s.props)||(s.props.excludeTimes||s.props.includeTimes||s.props.filterTime)&&tw(l,s.props)||s.props.onChange(l)}),ie(de(s),"isSelectedTime",function(l){return s.props.selected&&(c=s.props.selected,d=l,cw(c).getTime()===cw(d).getTime());var c,d}),ie(de(s),"isDisabledTime",function(l){return(s.props.minTime||s.props.maxTime)&&rw(l,s.props)||(s.props.excludeTimes||s.props.includeTimes||s.props.filterTime)&&tw(l,s.props)}),ie(de(s),"liClasses",function(l){var c=["react-datepicker__time-list-item",s.props.timeClassName?s.props.timeClassName(l):void 0];return s.isSelectedTime(l)&&c.push("react-datepicker__time-list-item--selected"),s.isDisabledTime(l)&&c.push("react-datepicker__time-list-item--disabled"),s.props.injectTimes&&(60*xo(l)+go(l))%s.props.intervals!=0&&c.push("react-datepicker__time-list-item--injected"),c.join(" ")}),ie(de(s),"handleOnKeyDown",function(l,c){l.key===" "&&(l.preventDefault(),l.key="Enter"),l.key!=="ArrowUp"&&l.key!=="ArrowLeft"||!l.target.previousSibling||(l.preventDefault(),l.target.previousSibling.focus()),l.key!=="ArrowDown"&&l.key!=="ArrowRight"||!l.target.nextSibling||(l.preventDefault(),l.target.nextSibling.focus()),l.key==="Enter"&&s.handleClick(c),s.props.handleOnKeyDown(l)}),ie(de(s),"renderTimes",function(){for(var l=[],c=s.props.format?s.props.format:"p",d=s.props.intervals,u=s.props.selected||s.props.openToDate||Wr(),h=yo(u),p=s.props.injectTimes&&s.props.injectTimes.sort(function(x,j){return x-j}),g=60*function(x){var j=new Date(x.getFullYear(),x.getMonth(),x.getDate()),S=new Date(x.getFullYear(),x.getMonth(),x.getDate(),24);return Math.round((+S-+j)/36e5)}(u),f=g/d,m=0;m<f;m++){var v=rx(h,m*d);if(l.push(v),p){var b=zR(h,v,m,d,p);l=l.concat(b)}}var w=l.reduce(function(x,j){return j.getTime()<=u.getTime()?j:x},l[0]);return l.map(function(x,j){return Te.createElement("li",{key:j,onClick:s.handleClick.bind(de(s),x),className:s.liClasses(x),ref:function(S){x===w&&(s.centerLi=S)},onKeyDown:function(S){s.handleOnKeyDown(S,x)},tabIndex:x===w?0:-1,role:"option","aria-selected":s.isSelectedTime(x)?"true":void 0,"aria-disabled":s.isDisabledTime(x)?"true":void 0},ln(x,c,s.props.locale))})}),s}return Zn(r,[{key:"componentDidMount",value:function(){this.scrollToTheSelectedTime(),this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})}},{key:"render",value:function(){var s=this,a=this.state.height;return Te.createElement("div",{className:"react-datepicker__time-container ".concat(this.props.todayButton?"react-datepicker__time-container--with-today-button":"")},Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(this.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(o){s.header=o}},Te.createElement("div",{className:"react-datepicker-time__header"},this.props.timeCaption)),Te.createElement("div",{className:"react-datepicker__time"},Te.createElement("div",{className:"react-datepicker__time-box"},Te.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){s.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))}}],[{key:"defaultProps",get:function(){return{intervals:30,onTimeChange:function(){},todayButton:null,timeCaption:"Time"}}}]),r}();ie(rk,"calcCenterPosition",function(n,t){return t.offsetTop-(n/2-t.clientHeight/2)});var ZR=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"YEAR_REFS",Ju(Array(a.props.yearItemNumber)).map(function(){return Te.createRef()})),ie(de(a),"isDisabled",function(o){return cf(o,a.props)}),ie(de(a),"isExcluded",function(o){return vb(o,a.props)}),ie(de(a),"selectingDate",function(){var o;return(o=a.props.selectingDate)!==null&&o!==void 0?o:a.props.preSelection}),ie(de(a),"updateFocusOnPaginate",function(o){var i=(function(){this.YEAR_REFS[o].current.focus()}).bind(de(a));window.requestAnimationFrame(i)}),ie(de(a),"handleYearClick",function(o,i){a.props.onDayClick&&a.props.onDayClick(o,i)}),ie(de(a),"handleYearNavigation",function(o,i){var l=a.props,c=l.date,d=l.yearItemNumber,u=Wc(c,d).startPeriod;a.isDisabled(i)||a.isExcluded(i)||(a.props.setPreSelection(i),o-u==-1?a.updateFocusOnPaginate(d-1):o-u===d?a.updateFocusOnPaginate(0):a.YEAR_REFS[o-u].current.focus())}),ie(de(a),"isSameDay",function(o,i){return Vr(o,i)}),ie(de(a),"isCurrentYear",function(o){return o===br(Wr())}),ie(de(a),"isRangeStart",function(o){return a.props.startDate&&a.props.endDate&&_i(Lo(Wr(),o),a.props.startDate)}),ie(de(a),"isRangeEnd",function(o){return a.props.startDate&&a.props.endDate&&_i(Lo(Wr(),o),a.props.endDate)}),ie(de(a),"isInRange",function(o){return ug(o,a.props.startDate,a.props.endDate)}),ie(de(a),"isInSelectingRange",function(o){var i=a.props,l=i.selectsStart,c=i.selectsEnd,d=i.selectsRange,u=i.startDate,h=i.endDate;return!(!(l||c||d)||!a.selectingDate())&&(l&&h?ug(o,a.selectingDate(),h):(c&&u||!(!d||!u||h))&&ug(o,u,a.selectingDate()))}),ie(de(a),"isSelectingRangeStart",function(o){if(!a.isInSelectingRange(o))return!1;var i=a.props,l=i.startDate,c=i.selectsStart,d=Lo(Wr(),o);return _i(d,c?a.selectingDate():l)}),ie(de(a),"isSelectingRangeEnd",function(o){if(!a.isInSelectingRange(o))return!1;var i=a.props,l=i.endDate,c=i.selectsEnd,d=i.selectsRange,u=Lo(Wr(),o);return _i(u,c||d?a.selectingDate():l)}),ie(de(a),"isKeyboardSelected",function(o){var i=tu(Lo(a.props.date,o));return!a.props.disabledKeyboardNavigation&&!a.props.inline&&!Vr(i,tu(a.props.selected))&&Vr(i,tu(a.props.preSelection))}),ie(de(a),"onYearClick",function(o,i){var l=a.props.date;a.handleYearClick(tu(Lo(l,i)),o)}),ie(de(a),"onYearKeyDown",function(o,i){var l=o.key;if(!a.props.disabledKeyboardNavigation)switch(l){case"Enter":a.onYearClick(o,i),a.props.setPreSelection(a.props.selected);break;case"ArrowRight":a.handleYearNavigation(i+1,dd(a.props.preSelection,1));break;case"ArrowLeft":a.handleYearNavigation(i-1,qu(a.props.preSelection,1))}}),ie(de(a),"getYearClassNames",function(o){var i=a.props,l=i.minDate,c=i.maxDate,d=i.selected,u=i.excludeDates,h=i.includeDates,p=i.filterDate;return ds("react-datepicker__year-text",{"react-datepicker__year-text--selected":o===br(d),"react-datepicker__year-text--disabled":(l||c||u||h||p)&&J_(o,a.props),"react-datepicker__year-text--keyboard-selected":a.isKeyboardSelected(o),"react-datepicker__year-text--range-start":a.isRangeStart(o),"react-datepicker__year-text--range-end":a.isRangeEnd(o),"react-datepicker__year-text--in-range":a.isInRange(o),"react-datepicker__year-text--in-selecting-range":a.isInSelectingRange(o),"react-datepicker__year-text--selecting-range-start":a.isSelectingRangeStart(o),"react-datepicker__year-text--selecting-range-end":a.isSelectingRangeEnd(o),"react-datepicker__year-text--today":a.isCurrentYear(o)})}),ie(de(a),"getYearTabIndex",function(o){return a.props.disabledKeyboardNavigation?"-1":o===br(a.props.preSelection)?"0":"-1"}),ie(de(a),"getYearContainerClassNames",function(){var o=a.props,i=o.selectingDate,l=o.selectsStart,c=o.selectsEnd,d=o.selectsRange;return ds("react-datepicker__year",{"react-datepicker__year--selecting-range":i&&(l||c||d)})}),ie(de(a),"getYearContent",function(o){return a.props.renderYearContent?a.props.renderYearContent(o):o}),a}return Zn(r,[{key:"render",value:function(){for(var s=this,a=[],o=this.props,i=o.date,l=o.yearItemNumber,c=o.onYearMouseEnter,d=o.onYearMouseLeave,u=Wc(i,l),h=u.startPeriod,p=u.endPeriod,g=function(m){a.push(Te.createElement("div",{ref:s.YEAR_REFS[m-h],onClick:function(v){s.onYearClick(v,m)},onKeyDown:function(v){s.onYearKeyDown(v,m)},tabIndex:s.getYearTabIndex(m),className:s.getYearClassNames(m),onMouseEnter:function(v){return c(v,m)},onMouseLeave:function(v){return d(v,m)},key:m,"aria-current":s.isCurrentYear(m)?"date":void 0},s.getYearContent(m)))},f=h;f<=p;f++)g(f);return Te.createElement("div",{className:this.getYearContainerClassNames()},Te.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.clearSelectingDate},a))}}]),r}(),eA=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"onTimeChange",function(o){a.setState({time:o});var i=a.props.date,l=i instanceof Date&&!isNaN(i)?i:new Date;l.setHours(o.split(":")[0]),l.setMinutes(o.split(":")[1]),a.props.onChange(l)}),ie(de(a),"renderTimeInput",function(){var o=a.state.time,i=a.props,l=i.date,c=i.timeString,d=i.customTimeInput;return d?Te.cloneElement(d,{date:l,value:o,onChange:a.onTimeChange}):Te.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",required:!0,value:o,onChange:function(u){a.onTimeChange(u.target.value||c)}})}),a.state={time:a.props.timeString},a}return Zn(r,[{key:"render",value:function(){return Te.createElement("div",{className:"react-datepicker__input-time-container"},Te.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Te.createElement("div",{className:"react-datepicker-time__input-container"},Te.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.timeString!==a.time?{time:s.timeString}:null}}]),r}();function tA(n){var t=n.className,r=n.children,s=n.showPopperArrow,a=n.arrowProps,o=a===void 0?{}:a;return Te.createElement("div",{className:t},s&&Te.createElement("div",gd({className:"react-datepicker__triangle"},o)),r)}var rA=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],nA=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"handleClickOutside",function(o){a.props.onClickOutside(o)}),ie(de(a),"setClickOutsideRef",function(){return a.containerRef.current}),ie(de(a),"handleDropdownFocus",function(o){(function(){var i=((arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).className||"").split(/\s+/);return rA.some(function(l){return i.indexOf(l)>=0})})(o.target)&&a.props.onDropdownFocus()}),ie(de(a),"getDateInView",function(){var o=a.props,i=o.preSelection,l=o.selected,c=o.openToDate,d=X_(a.props),u=Q_(a.props),h=Wr(),p=c||l||i;return p||(d&&Si(h,d)?d:u&&Vo(h,u)?u:h)}),ie(de(a),"increaseMonth",function(){a.setState(function(o){var i=o.date;return{date:Va(i,1)}},function(){return a.handleMonthChange(a.state.date)})}),ie(de(a),"decreaseMonth",function(){a.setState(function(o){var i=o.date;return{date:ud(i,1)}},function(){return a.handleMonthChange(a.state.date)})}),ie(de(a),"handleDayClick",function(o,i,l){a.props.onSelect(o,i,l),a.props.setPreSelection&&a.props.setPreSelection(o)}),ie(de(a),"handleDayMouseEnter",function(o){a.setState({selectingDate:o}),a.props.onDayMouseEnter&&a.props.onDayMouseEnter(o)}),ie(de(a),"handleMonthMouseLeave",function(){a.setState({selectingDate:null}),a.props.onMonthMouseLeave&&a.props.onMonthMouseLeave()}),ie(de(a),"handleYearMouseEnter",function(o,i){a.setState({selectingDate:Lo(Wr(),i)}),a.props.onYearMouseEnter&&a.props.onYearMouseEnter(o,i)}),ie(de(a),"handleYearMouseLeave",function(o,i){a.props.onYearMouseLeave&&a.props.onYearMouseLeave(o,i)}),ie(de(a),"handleYearChange",function(o){a.props.onYearChange&&(a.props.onYearChange(o),a.setState({isRenderAriaLiveMessage:!0})),a.props.adjustDateOnChange&&(a.props.onSelect&&a.props.onSelect(o),a.props.setOpen&&a.props.setOpen(!0)),a.props.setPreSelection&&a.props.setPreSelection(o)}),ie(de(a),"handleMonthChange",function(o){a.handleCustomMonthChange(o),a.props.adjustDateOnChange&&(a.props.onSelect&&a.props.onSelect(o),a.props.setOpen&&a.props.setOpen(!0)),a.props.setPreSelection&&a.props.setPreSelection(o)}),ie(de(a),"handleCustomMonthChange",function(o){a.props.onMonthChange&&(a.props.onMonthChange(o),a.setState({isRenderAriaLiveMessage:!0}))}),ie(de(a),"handleMonthYearChange",function(o){a.handleYearChange(o),a.handleMonthChange(o)}),ie(de(a),"changeYear",function(o){a.setState(function(i){var l=i.date;return{date:Lo(l,o)}},function(){return a.handleYearChange(a.state.date)})}),ie(de(a),"changeMonth",function(o){a.setState(function(i){var l=i.date;return{date:Rs(l,o)}},function(){return a.handleMonthChange(a.state.date)})}),ie(de(a),"changeMonthYear",function(o){a.setState(function(i){var l=i.date;return{date:Lo(Rs(l,ws(o)),br(o))}},function(){return a.handleMonthYearChange(a.state.date)})}),ie(de(a),"header",function(){var o=vo(arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.state.date,a.props.locale,a.props.calendarStartDay),i=[];return a.props.showWeekNumbers&&i.push(Te.createElement("div",{key:"W",className:"react-datepicker__day-name"},a.props.weekLabel||"#")),i.concat([0,1,2,3,4,5,6].map(function(l){var c=jd(o,l),d=a.formatWeekday(c,a.props.locale),u=a.props.weekDayClassName?a.props.weekDayClassName(c):void 0;return Te.createElement("div",{key:l,className:ds("react-datepicker__day-name",u)},d)}))}),ie(de(a),"formatWeekday",function(o,i){return a.props.formatWeekDay?function(l,c,d){return c(ln(l,"EEEE",d))}(o,a.props.formatWeekDay,i):a.props.useWeekdaysShort?function(l,c){return ln(l,"EEE",c)}(o,i):function(l,c){return ln(l,"EEEEEE",c)}(o,i)}),ie(de(a),"decreaseYear",function(){a.setState(function(o){var i=o.date;return{date:qu(i,a.props.showYearPicker?a.props.yearItemNumber:1)}},function(){return a.handleYearChange(a.state.date)})}),ie(de(a),"clearSelectingDate",function(){a.setState({selectingDate:null})}),ie(de(a),"renderPreviousButton",function(){if(!a.props.renderCustomHeader){var o;switch(!0){case a.props.showMonthYearPicker:o=aw(a.state.date,a.props);break;case a.props.showYearPicker:o=function(b){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=w.minDate,j=w.yearItemNumber,S=j===void 0?yu:j,_=Wc(tu(qu(b,S)),S).endPeriod,C=x&&br(x);return C&&C>_||!1}(a.state.date,a.props);break;default:o=nw(a.state.date,a.props)}if((a.props.forceShowMonthNavigation||a.props.showDisabledMonthNavigation||!o)&&!a.props.showTimeSelectOnly){var i=["react-datepicker__navigation","react-datepicker__navigation--previous"],l=a.decreaseMonth;(a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker)&&(l=a.decreaseYear),o&&a.props.showDisabledMonthNavigation&&(i.push("react-datepicker__navigation--previous--disabled"),l=null);var c=a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker,d=a.props,u=d.previousMonthButtonLabel,h=d.previousYearButtonLabel,p=a.props,g=p.previousMonthAriaLabel,f=g===void 0?typeof u=="string"?u:"Previous Month":g,m=p.previousYearAriaLabel,v=m===void 0?typeof h=="string"?h:"Previous Year":m;return Te.createElement("button",{type:"button",className:i.join(" "),onClick:l,onKeyDown:a.props.handleOnKeyDown,"aria-label":c?v:f},Te.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},c?a.props.previousYearButtonLabel:a.props.previousMonthButtonLabel))}}}),ie(de(a),"increaseYear",function(){a.setState(function(o){var i=o.date;return{date:dd(i,a.props.showYearPicker?a.props.yearItemNumber:1)}},function(){return a.handleYearChange(a.state.date)})}),ie(de(a),"renderNextButton",function(){if(!a.props.renderCustomHeader){var o;switch(!0){case a.props.showMonthYearPicker:o=ow(a.state.date,a.props);break;case a.props.showYearPicker:o=function(b){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=w.maxDate,j=w.yearItemNumber,S=j===void 0?yu:j,_=Wc(dd(b,S),S).startPeriod,C=x&&br(x);return C&&C<_||!1}(a.state.date,a.props);break;default:o=sw(a.state.date,a.props)}if((a.props.forceShowMonthNavigation||a.props.showDisabledMonthNavigation||!o)&&!a.props.showTimeSelectOnly){var i=["react-datepicker__navigation","react-datepicker__navigation--next"];a.props.showTimeSelect&&i.push("react-datepicker__navigation--next--with-time"),a.props.todayButton&&i.push("react-datepicker__navigation--next--with-today-button");var l=a.increaseMonth;(a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker)&&(l=a.increaseYear),o&&a.props.showDisabledMonthNavigation&&(i.push("react-datepicker__navigation--next--disabled"),l=null);var c=a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker,d=a.props,u=d.nextMonthButtonLabel,h=d.nextYearButtonLabel,p=a.props,g=p.nextMonthAriaLabel,f=g===void 0?typeof u=="string"?u:"Next Month":g,m=p.nextYearAriaLabel,v=m===void 0?typeof h=="string"?h:"Next Year":m;return Te.createElement("button",{type:"button",className:i.join(" "),onClick:l,onKeyDown:a.props.handleOnKeyDown,"aria-label":c?v:f},Te.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},c?a.props.nextYearButtonLabel:a.props.nextMonthButtonLabel))}}}),ie(de(a),"renderCurrentMonth",function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a.state.date,i=["react-datepicker__current-month"];return a.props.showYearDropdown&&i.push("react-datepicker__current-month--hasYearDropdown"),a.props.showMonthDropdown&&i.push("react-datepicker__current-month--hasMonthDropdown"),a.props.showMonthYearDropdown&&i.push("react-datepicker__current-month--hasMonthYearDropdown"),Te.createElement("div",{className:i.join(" ")},ln(o,a.props.dateFormat,a.props.locale))}),ie(de(a),"renderYearDropdown",function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(a.props.showYearDropdown&&!o)return Te.createElement(UR,{adjustDateOnChange:a.props.adjustDateOnChange,date:a.state.date,onSelect:a.props.onSelect,setOpen:a.props.setOpen,dropdownMode:a.props.dropdownMode,onChange:a.changeYear,minDate:a.props.minDate,maxDate:a.props.maxDate,year:br(a.state.date),scrollableYearDropdown:a.props.scrollableYearDropdown,yearDropdownItemNumber:a.props.yearDropdownItemNumber})}),ie(de(a),"renderMonthDropdown",function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(a.props.showMonthDropdown&&!o)return Te.createElement(HR,{dropdownMode:a.props.dropdownMode,locale:a.props.locale,onChange:a.changeMonth,month:ws(a.state.date),useShortMonthInDropdown:a.props.useShortMonthInDropdown})}),ie(de(a),"renderMonthYearDropdown",function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(a.props.showMonthYearDropdown&&!o)return Te.createElement(VR,{dropdownMode:a.props.dropdownMode,locale:a.props.locale,dateFormat:a.props.dateFormat,onChange:a.changeMonthYear,minDate:a.props.minDate,maxDate:a.props.maxDate,date:a.state.date,scrollableMonthYearDropdown:a.props.scrollableMonthYearDropdown})}),ie(de(a),"handleTodayButtonClick",function(o){a.props.onSelect(Z1(),o),a.props.setPreSelection&&a.props.setPreSelection(Z1())}),ie(de(a),"renderTodayButton",function(){if(a.props.todayButton&&!a.props.showTimeSelectOnly)return Te.createElement("div",{className:"react-datepicker__today-button",onClick:function(o){return a.handleTodayButtonClick(o)}},a.props.todayButton)}),ie(de(a),"renderDefaultHeader",function(o){var i=o.monthDate,l=o.i;return Te.createElement("div",{className:"react-datepicker__header ".concat(a.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},a.renderCurrentMonth(i),Te.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(a.props.dropdownMode),onFocus:a.handleDropdownFocus},a.renderMonthDropdown(l!==0),a.renderMonthYearDropdown(l!==0),a.renderYearDropdown(l!==0)),Te.createElement("div",{className:"react-datepicker__day-names"},a.header(i)))}),ie(de(a),"renderCustomHeader",function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=o.monthDate,l=o.i;if(a.props.showTimeSelect&&!a.state.monthContainer||a.props.showTimeSelectOnly)return null;var c=nw(a.state.date,a.props),d=sw(a.state.date,a.props),u=aw(a.state.date,a.props),h=ow(a.state.date,a.props),p=!a.props.showMonthYearPicker&&!a.props.showQuarterYearPicker&&!a.props.showYearPicker;return Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:a.props.onDropdownFocus},a.props.renderCustomHeader(ym(ym({},a.state),{},{customHeaderCount:l,monthDate:i,changeMonth:a.changeMonth,changeYear:a.changeYear,decreaseMonth:a.decreaseMonth,increaseMonth:a.increaseMonth,decreaseYear:a.decreaseYear,increaseYear:a.increaseYear,prevMonthButtonDisabled:c,nextMonthButtonDisabled:d,prevYearButtonDisabled:u,nextYearButtonDisabled:h})),p&&Te.createElement("div",{className:"react-datepicker__day-names"},a.header(i)))}),ie(de(a),"renderYearHeader",function(){var o=a.state.date,i=a.props,l=i.showYearPicker,c=Wc(o,i.yearItemNumber),d=c.startPeriod,u=c.endPeriod;return Te.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},l?"".concat(d," - ").concat(u):br(o))}),ie(de(a),"renderHeader",function(o){switch(!0){case a.props.renderCustomHeader!==void 0:return a.renderCustomHeader(o);case(a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker):return a.renderYearHeader(o);default:return a.renderDefaultHeader(o)}}),ie(de(a),"renderMonths",function(){var o;if(!a.props.showTimeSelectOnly&&!a.props.showYearPicker){for(var i=[],l=a.props.showPreviousMonths?a.props.monthsShown-1:0,c=ud(a.state.date,l),d=(o=a.props.monthSelectedIn)!==null&&o!==void 0?o:l,u=0;u<a.props.monthsShown;++u){var h=Va(c,u-d+l),p="month-".concat(u),g=u<a.props.monthsShown-1,f=u>0;i.push(Te.createElement("div",{key:p,ref:function(m){a.monthContainer=m},className:"react-datepicker__month-container"},a.renderHeader({monthDate:h,i:u}),Te.createElement(QR,{chooseDayAriaLabelPrefix:a.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:a.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:a.props.weekAriaLabelPrefix,ariaLabelPrefix:a.props.monthAriaLabelPrefix,onChange:a.changeMonthYear,day:h,dayClassName:a.props.dayClassName,calendarStartDay:a.props.calendarStartDay,monthClassName:a.props.monthClassName,onDayClick:a.handleDayClick,handleOnKeyDown:a.props.handleOnDayKeyDown,onDayMouseEnter:a.handleDayMouseEnter,onMouseLeave:a.handleMonthMouseLeave,onWeekSelect:a.props.onWeekSelect,orderInDisplay:u,formatWeekNumber:a.props.formatWeekNumber,locale:a.props.locale,minDate:a.props.minDate,maxDate:a.props.maxDate,excludeDates:a.props.excludeDates,excludeDateIntervals:a.props.excludeDateIntervals,highlightDates:a.props.highlightDates,holidays:a.props.holidays,selectingDate:a.state.selectingDate,includeDates:a.props.includeDates,includeDateIntervals:a.props.includeDateIntervals,inline:a.props.inline,shouldFocusDayInline:a.props.shouldFocusDayInline,fixedHeight:a.props.fixedHeight,filterDate:a.props.filterDate,preSelection:a.props.preSelection,setPreSelection:a.props.setPreSelection,selected:a.props.selected,selectsStart:a.props.selectsStart,selectsEnd:a.props.selectsEnd,selectsRange:a.props.selectsRange,selectsDisabledDaysInRange:a.props.selectsDisabledDaysInRange,showWeekNumbers:a.props.showWeekNumbers,startDate:a.props.startDate,endDate:a.props.endDate,peekNextMonth:a.props.peekNextMonth,setOpen:a.props.setOpen,shouldCloseOnSelect:a.props.shouldCloseOnSelect,renderDayContents:a.props.renderDayContents,renderMonthContent:a.props.renderMonthContent,renderQuarterContent:a.props.renderQuarterContent,renderYearContent:a.props.renderYearContent,disabledKeyboardNavigation:a.props.disabledKeyboardNavigation,showMonthYearPicker:a.props.showMonthYearPicker,showFullMonthYearPicker:a.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:a.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:a.props.showFourColumnMonthYearPicker,showYearPicker:a.props.showYearPicker,showQuarterYearPicker:a.props.showQuarterYearPicker,showWeekPicker:a.props.showWeekPicker,isInputFocused:a.props.isInputFocused,containerRef:a.containerRef,monthShowsDuplicateDaysEnd:g,monthShowsDuplicateDaysStart:f})))}return i}}),ie(de(a),"renderYears",function(){if(!a.props.showTimeSelectOnly)return a.props.showYearPicker?Te.createElement("div",{className:"react-datepicker__year--container"},a.renderHeader(),Te.createElement(ZR,gd({onDayClick:a.handleDayClick,selectingDate:a.state.selectingDate,clearSelectingDate:a.clearSelectingDate,date:a.state.date},a.props,{onYearMouseEnter:a.handleYearMouseEnter,onYearMouseLeave:a.handleYearMouseLeave}))):void 0}),ie(de(a),"renderTimeSection",function(){if(a.props.showTimeSelect&&(a.state.monthContainer||a.props.showTimeSelectOnly))return Te.createElement(rk,{selected:a.props.selected,openToDate:a.props.openToDate,onChange:a.props.onTimeChange,timeClassName:a.props.timeClassName,format:a.props.timeFormat,includeTimes:a.props.includeTimes,intervals:a.props.timeIntervals,minTime:a.props.minTime,maxTime:a.props.maxTime,excludeTimes:a.props.excludeTimes,filterTime:a.props.filterTime,timeCaption:a.props.timeCaption,todayButton:a.props.todayButton,showMonthDropdown:a.props.showMonthDropdown,showMonthYearDropdown:a.props.showMonthYearDropdown,showYearDropdown:a.props.showYearDropdown,withPortal:a.props.withPortal,monthRef:a.state.monthContainer,injectTimes:a.props.injectTimes,locale:a.props.locale,handleOnKeyDown:a.props.handleOnKeyDown,showTimeSelectOnly:a.props.showTimeSelectOnly})}),ie(de(a),"renderInputTimeSection",function(){var o=new Date(a.props.selected),i=pi(o)&&a.props.selected?"".concat(lw(o.getHours()),":").concat(lw(o.getMinutes())):"";if(a.props.showTimeInput)return Te.createElement(eA,{date:o,timeString:i,timeInputLabel:a.props.timeInputLabel,onChange:a.props.onTimeChange,customTimeInput:a.props.customTimeInput})}),ie(de(a),"renderAriaLiveRegion",function(){var o,i=Wc(a.state.date,a.props.yearItemNumber),l=i.startPeriod,c=i.endPeriod;return o=a.props.showYearPicker?"".concat(l," - ").concat(c):a.props.showMonthYearPicker||a.props.showQuarterYearPicker?br(a.state.date):"".concat(bb(ws(a.state.date),a.props.locale)," ").concat(br(a.state.date)),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},a.state.isRenderAriaLiveMessage&&o)}),ie(de(a),"renderChildren",function(){if(a.props.children)return Te.createElement("div",{className:"react-datepicker__children-container"},a.props.children)}),a.containerRef=Te.createRef(),a.state={date:a.getDateInView(),selectingDate:null,monthContainer:null,isRenderAriaLiveMessage:!1},a}return Zn(r,[{key:"componentDidMount",value:function(){var s=this;this.props.showTimeSelect&&(this.assignMonthContainer=void s.setState({monthContainer:s.monthContainer}))}},{key:"componentDidUpdate",value:function(s){var a=this;if(!this.props.preSelection||Vr(this.props.preSelection,s.preSelection)&&this.props.monthSelectedIn===s.monthSelectedIn)this.props.openToDate&&!Vr(this.props.openToDate,s.openToDate)&&this.setState({date:this.props.openToDate});else{var o=!Ua(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return o&&a.handleCustomMonthChange(a.state.date)})}}},{key:"render",value:function(){var s=this.props.container||tA;return Te.createElement("div",{style:{display:"contents"},ref:this.containerRef},Te.createElement(s,{className:ds("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showPopperArrow:this.props.showPopperArrow,arrowProps:this.props.arrowProps},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren()))}}],[{key:"defaultProps",get:function(){return{onDropdownFocus:function(){},monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",customTimeInput:null,yearItemNumber:yu}}}]),r}(),sA=function(n){var t=n.icon,r=n.className,s=r===void 0?"":r,a=n.onClick,o="react-datepicker__calendar-icon";return Te.isValidElement(t)?Te.cloneElement(t,{className:"".concat(t.props.className||""," ").concat(o," ").concat(s),onClick:function(i){typeof t.props.onClick=="function"&&t.props.onClick(i),typeof a=="function"&&a(i)}}):typeof t=="string"?Te.createElement("i",{className:"".concat(o," ").concat(t," ").concat(s),"aria-hidden":"true",onClick:a}):Te.createElement("svg",{className:"".concat(o," ").concat(s),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Te.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},nk=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),(a=t.call(this,s)).el=document.createElement("div"),a}return Zn(r,[{key:"componentDidMount",value:function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){this.portalRoot.removeChild(this.el)}},{key:"render",value:function(){return yh.createPortal(this.props.children,this.el)}}]),r}(),aA=function(n){return!n.disabled&&n.tabIndex!==-1},sk=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"getTabChildren",function(){return Array.prototype.slice.call(a.tabLoopRef.current.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(aA)}),ie(de(a),"handleFocusStart",function(){var o=a.getTabChildren();o&&o.length>1&&o[o.length-1].focus()}),ie(de(a),"handleFocusEnd",function(){var o=a.getTabChildren();o&&o.length>1&&o[0].focus()}),a.tabLoopRef=Te.createRef(),a}return Zn(r,[{key:"render",value:function(){return this.props.enableTabLoop?Te.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Te.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:"0",onFocus:this.handleFocusStart}),this.props.children,Te.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:"0",onFocus:this.handleFocusEnd})):this.props.children}}],[{key:"defaultProps",get:function(){return{enableTabLoop:!0}}}]),r}(),oA=function(n){es(r,Te.Component);var t=ts(r);function r(){return Qn(this,r),t.apply(this,arguments)}return Zn(r,[{key:"render",value:function(){var s,a=this.props,o=a.className,i=a.wrapperClassName,l=a.hidePopper,c=a.popperComponent,d=a.popperModifiers,u=a.popperPlacement,h=a.popperProps,p=a.targetComponent,g=a.enableTabLoop,f=a.popperOnKeyDown,m=a.portalId,v=a.portalHost;if(!l){var b=ds("react-datepicker-popper",o);s=Te.createElement(ER,gd({modifiers:d,placement:u},h),function(x){var j=x.ref,S=x.style,_=x.placement,C=x.arrowProps;return Te.createElement(sk,{enableTabLoop:g},Te.createElement("div",{ref:j,style:S,className:b,"data-placement":_,onKeyDown:f},Te.cloneElement(c,{arrowProps:C})))})}this.props.popperContainer&&(s=Te.createElement(this.props.popperContainer,{},s)),m&&!l&&(s=Te.createElement(nk,{portalId:m,portalHost:v},s));var w=ds("react-datepicker-wrapper",i);return Te.createElement(hE,{className:"react-datepicker-manager"},Te.createElement(IR,null,function(x){var j=x.ref;return Te.createElement("div",{ref:j,className:w},p)}),s)}}],[{key:"defaultProps",get:function(){return{hidePopper:!0,popperModifiers:[],popperProps:{},popperPlacement:"bottom-start"}}}]),r}(),uw="react-datepicker-ignore-onclickoutside",iA=of(nA),mg="Date input not valid.",wb=function(n){es(r,Te.Component);var t=ts(r);function r(s){var a;return Qn(this,r),ie(de(a=t.call(this,s)),"getPreSelection",function(){return a.props.openToDate?a.props.openToDate:a.props.selectsEnd&&a.props.startDate?a.props.startDate:a.props.selectsStart&&a.props.endDate?a.props.endDate:Wr()}),ie(de(a),"modifyHolidays",function(){var o;return(o=a.props.holidays)===null||o===void 0?void 0:o.reduce(function(i,l){var c=new Date(l.date);return Uu(c)?[].concat(Ju(i),[ym(ym({},l),{},{date:c})]):i},[])}),ie(de(a),"calcInitialState",function(){var o,i=a.getPreSelection(),l=X_(a.props),c=Q_(a.props),d=l&&Si(i,yo(l))?l:c&&Vo(i,ax(c))?c:i;return{open:a.props.startOpen||!1,preventFocus:!1,preSelection:(o=a.props.selectsRange?a.props.startDate:a.props.selected)!==null&&o!==void 0?o:d,highlightDates:iw(a.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1}}),ie(de(a),"clearPreventFocusTimeout",function(){a.preventFocusTimeout&&clearTimeout(a.preventFocusTimeout)}),ie(de(a),"setFocus",function(){a.input&&a.input.focus&&a.input.focus({preventScroll:!0})}),ie(de(a),"setBlur",function(){a.input&&a.input.blur&&a.input.blur(),a.cancelFocusInput()}),ie(de(a),"setOpen",function(o){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];a.setState({open:o,preSelection:o&&a.state.open?a.state.preSelection:a.calcInitialState().preSelection,lastPreSelectChange:fg},function(){o||a.setState(function(l){return{focused:!!i&&l.focused}},function(){!i&&a.setBlur(),a.setState({inputValue:null})})})}),ie(de(a),"inputOk",function(){return sf(a.state.preSelection)}),ie(de(a),"isCalendarOpen",function(){return a.props.open===void 0?a.state.open&&!a.props.disabled&&!a.props.readOnly:a.props.open}),ie(de(a),"handleFocus",function(o){a.state.preventFocus||(a.props.onFocus(o),a.props.preventOpenOnFocus||a.props.readOnly||a.setOpen(!0)),a.setState({focused:!0})}),ie(de(a),"sendFocusBackToInput",function(){a.preventFocusTimeout&&a.clearPreventFocusTimeout(),a.setState({preventFocus:!0},function(){a.preventFocusTimeout=setTimeout(function(){a.setFocus(),a.setState({preventFocus:!1})})})}),ie(de(a),"cancelFocusInput",function(){clearTimeout(a.inputFocusTimeout),a.inputFocusTimeout=null}),ie(de(a),"deferFocusInput",function(){a.cancelFocusInput(),a.inputFocusTimeout=setTimeout(function(){return a.setFocus()},1)}),ie(de(a),"handleDropdownFocus",function(){a.cancelFocusInput()}),ie(de(a),"handleBlur",function(o){(!a.state.open||a.props.withPortal||a.props.showTimeInput)&&a.props.onBlur(o),a.setState({focused:!1})}),ie(de(a),"handleCalendarClickOutside",function(o){a.props.inline||a.setOpen(!1),a.props.onClickOutside(o),a.props.withPortal&&o.preventDefault()}),ie(de(a),"handleChange",function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];var c=i[0];if(!a.props.onChangeRaw||(a.props.onChangeRaw.apply(de(a),i),typeof c.isDefaultPrevented=="function"&&!c.isDefaultPrevented())){a.setState({inputValue:c.target.value,lastPreSelectChange:lA});var d,u,h,p,g,f,m,v,b=(d=c.target.value,u=a.props.dateFormat,h=a.props.locale,p=a.props.strictParsing,g=a.props.minDate,f=null,m=Ii(h)||Ii(Al()),v=!0,Array.isArray(u)?(u.forEach(function(w){var x=og(d,w,new Date,{locale:m});p&&(v=pi(x,g)&&d===ln(x,w,h)),pi(x,g)&&v&&(f=x)}),f):(f=og(d,u,new Date,{locale:m}),p?v=pi(f)&&d===ln(f,u,h):pi(f)||(u=u.match(LR).map(function(w){var x=w[0];return x==="p"||x==="P"?m?(0,$R[x])(w,m.formatLong):x:w}).join(""),d.length>0&&(f=og(d,u.slice(0,d.length),new Date)),pi(f)||(f=new Date(d))),pi(f)&&v?f:null));a.props.showTimeSelectOnly&&a.props.selected&&b&&!Vr(b,a.props.selected)&&(b=DR(a.props.selected,{hours:xo(b),minutes:go(b),seconds:T1(b)})),!b&&c.target.value||(a.props.showWeekPicker&&(b=vo(b,a.props.locale,a.props.calendarStartDay)),a.setSelected(b,c,!0))}}),ie(de(a),"handleSelect",function(o,i,l){if(a.props.shouldCloseOnSelect&&!a.props.showTimeSelect&&a.sendFocusBackToInput(),a.props.onChangeRaw&&a.props.onChangeRaw(i),a.props.showWeekPicker&&(o=vo(o,a.props.locale,a.props.calendarStartDay)),a.setSelected(o,i,!1,l),a.props.showDateSelect&&a.setState({isRenderAriaLiveMessage:!0}),!a.props.shouldCloseOnSelect||a.props.showTimeSelect)a.setPreSelection(o);else if(!a.props.inline){a.props.selectsRange||a.setOpen(!1);var c=a.props,d=c.startDate,u=c.endDate;!d||u||Si(o,d)||a.setOpen(!1)}}),ie(de(a),"setSelected",function(o,i,l,c){var d=o;if(a.props.showYearPicker){if(d!==null&&J_(br(d),a.props))return}else if(a.props.showMonthYearPicker){if(d!==null&&K_(d,a.props))return}else if(d!==null&&cf(d,a.props))return;var u=a.props,h=u.onChange,p=u.selectsRange,g=u.startDate,f=u.endDate;if(!Sl(a.props.selected,d)||a.props.allowSameDay||p)if(d!==null&&(!a.props.selected||l&&(a.props.showTimeSelect||a.props.showTimeSelectOnly||a.props.showTimeInput)||(d=X1(d,{hour:xo(a.props.selected),minute:go(a.props.selected),second:T1(a.props.selected)})),a.props.inline||a.setState({preSelection:d}),a.props.focusSelectedMonth||a.setState({monthSelectedIn:c})),p){var m=g&&!f,v=g&&f;!g&&!f?h([d,null],i):m&&(Si(d,g)?h([d,null],i):h([g,d],i)),v&&h([d,null],i)}else h(d,i);l||(a.props.onSelect(d,i),a.setState({inputValue:null}))}),ie(de(a),"setPreSelection",function(o){var i=a.props.minDate!==void 0,l=a.props.maxDate!==void 0,c=!0;if(o){a.props.showWeekPicker&&(o=vo(o,a.props.locale,a.props.calendarStartDay));var d=yo(o);if(i&&l)c=Ep(o,a.props.minDate,a.props.maxDate);else if(i){var u=yo(a.props.minDate);c=Vo(o,u)||Sl(d,u)}else if(l){var h=ax(a.props.maxDate);c=Si(o,h)||Sl(d,h)}}c&&a.setState({preSelection:o})}),ie(de(a),"toggleCalendar",function(){a.setOpen(!a.state.open)}),ie(de(a),"handleTimeChange",function(o){var i=a.props.selected?a.props.selected:a.getPreSelection(),l=a.props.selected?o:X1(i,{hour:xo(o),minute:go(o)});a.setState({preSelection:l}),a.props.onChange(l),a.props.shouldCloseOnSelect&&(a.sendFocusBackToInput(),a.setOpen(!1)),a.props.showTimeInput&&a.setOpen(!0),(a.props.showTimeSelectOnly||a.props.showTimeSelect)&&a.setState({isRenderAriaLiveMessage:!0}),a.setState({inputValue:null})}),ie(de(a),"onInputClick",function(){a.props.disabled||a.props.readOnly||a.setOpen(!0),a.props.onInputClick()}),ie(de(a),"onInputKeyDown",function(o){a.props.onKeyDown(o);var i=o.key;if(a.state.open||a.props.inline||a.props.preventOpenOnFocus){if(a.state.open){if(i==="ArrowDown"||i==="ArrowUp"){o.preventDefault();var l=a.props.showWeekPicker&&a.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',c=a.calendar.componentNode&&a.calendar.componentNode.querySelector(l);return void(c&&c.focus({preventScroll:!0}))}var d=Wr(a.state.preSelection);i==="Enter"?(o.preventDefault(),a.inputOk()&&a.state.lastPreSelectChange===fg?(a.handleSelect(d,o),!a.props.shouldCloseOnSelect&&a.setPreSelection(d)):a.setOpen(!1)):i==="Escape"?(o.preventDefault(),a.sendFocusBackToInput(),a.setOpen(!1)):i==="Tab"&&a.setOpen(!1),a.inputOk()||a.props.onInputError({code:1,msg:mg})}}else i!=="ArrowDown"&&i!=="ArrowUp"&&i!=="Enter"||a.onInputClick()}),ie(de(a),"onPortalKeyDown",function(o){o.key==="Escape"&&(o.preventDefault(),a.setState({preventFocus:!0},function(){a.setOpen(!1),setTimeout(function(){a.setFocus(),a.setState({preventFocus:!1})})}))}),ie(de(a),"onDayKeyDown",function(o){a.props.onKeyDown(o);var i=o.key,l=Wr(a.state.preSelection);if(i==="Enter")o.preventDefault(),a.handleSelect(l,o),!a.props.shouldCloseOnSelect&&a.setPreSelection(l);else if(i==="Escape")o.preventDefault(),a.setOpen(!1),a.inputOk()||a.props.onInputError({code:1,msg:mg});else if(!a.props.disabledKeyboardNavigation){var c;switch(i){case"ArrowLeft":c=a.props.showWeekPicker?N1(l,1):TP(l,1);break;case"ArrowRight":c=a.props.showWeekPicker?hm(l,1):jd(l,1);break;case"ArrowUp":c=N1(l,1);break;case"ArrowDown":c=hm(l,1);break;case"PageUp":c=ud(l,1);break;case"PageDown":c=Va(l,1);break;case"Home":c=qu(l,1);break;case"End":c=dd(l,1);break;default:c=null}if(!c)return void(a.props.onInputError&&a.props.onInputError({code:1,msg:mg}));if(o.preventDefault(),a.setState({lastPreSelectChange:fg}),a.props.adjustDateOnChange&&a.setSelected(c),a.setPreSelection(c),a.props.inline){var d=ws(l),u=ws(c),h=br(l),p=br(c);d!==u||h!==p?a.setState({shouldFocusDayInline:!0}):a.setState({shouldFocusDayInline:!1})}}}),ie(de(a),"onPopperKeyDown",function(o){o.key==="Escape"&&(o.preventDefault(),a.sendFocusBackToInput())}),ie(de(a),"onClearClick",function(o){o&&o.preventDefault&&o.preventDefault(),a.sendFocusBackToInput(),a.props.selectsRange?a.props.onChange([null,null],o):a.props.onChange(null,o),a.setState({inputValue:null})}),ie(de(a),"clear",function(){a.onClearClick()}),ie(de(a),"onScroll",function(o){typeof a.props.closeOnScroll=="boolean"&&a.props.closeOnScroll?o.target!==document&&o.target!==document.documentElement&&o.target!==document.body||a.setOpen(!1):typeof a.props.closeOnScroll=="function"&&a.props.closeOnScroll(o)&&a.setOpen(!1)}),ie(de(a),"renderCalendar",function(){return a.props.inline||a.isCalendarOpen()?Te.createElement(iA,{ref:function(o){a.calendar=o},locale:a.props.locale,calendarStartDay:a.props.calendarStartDay,chooseDayAriaLabelPrefix:a.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:a.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:a.props.weekAriaLabelPrefix,monthAriaLabelPrefix:a.props.monthAriaLabelPrefix,adjustDateOnChange:a.props.adjustDateOnChange,setOpen:a.setOpen,shouldCloseOnSelect:a.props.shouldCloseOnSelect,dateFormat:a.props.dateFormatCalendar,useWeekdaysShort:a.props.useWeekdaysShort,formatWeekDay:a.props.formatWeekDay,dropdownMode:a.props.dropdownMode,selected:a.props.selected,preSelection:a.state.preSelection,onSelect:a.handleSelect,onWeekSelect:a.props.onWeekSelect,openToDate:a.props.openToDate,minDate:a.props.minDate,maxDate:a.props.maxDate,selectsStart:a.props.selectsStart,selectsEnd:a.props.selectsEnd,selectsRange:a.props.selectsRange,startDate:a.props.startDate,endDate:a.props.endDate,excludeDates:a.props.excludeDates,excludeDateIntervals:a.props.excludeDateIntervals,filterDate:a.props.filterDate,onClickOutside:a.handleCalendarClickOutside,formatWeekNumber:a.props.formatWeekNumber,highlightDates:a.state.highlightDates,holidays:OR(a.modifyHolidays()),includeDates:a.props.includeDates,includeDateIntervals:a.props.includeDateIntervals,includeTimes:a.props.includeTimes,injectTimes:a.props.injectTimes,inline:a.props.inline,shouldFocusDayInline:a.state.shouldFocusDayInline,peekNextMonth:a.props.peekNextMonth,showMonthDropdown:a.props.showMonthDropdown,showPreviousMonths:a.props.showPreviousMonths,useShortMonthInDropdown:a.props.useShortMonthInDropdown,showMonthYearDropdown:a.props.showMonthYearDropdown,showWeekNumbers:a.props.showWeekNumbers,showYearDropdown:a.props.showYearDropdown,withPortal:a.props.withPortal,forceShowMonthNavigation:a.props.forceShowMonthNavigation,showDisabledMonthNavigation:a.props.showDisabledMonthNavigation,scrollableYearDropdown:a.props.scrollableYearDropdown,scrollableMonthYearDropdown:a.props.scrollableMonthYearDropdown,todayButton:a.props.todayButton,weekLabel:a.props.weekLabel,outsideClickIgnoreClass:uw,fixedHeight:a.props.fixedHeight,monthsShown:a.props.monthsShown,monthSelectedIn:a.state.monthSelectedIn,onDropdownFocus:a.handleDropdownFocus,onMonthChange:a.props.onMonthChange,onYearChange:a.props.onYearChange,dayClassName:a.props.dayClassName,weekDayClassName:a.props.weekDayClassName,monthClassName:a.props.monthClassName,timeClassName:a.props.timeClassName,showDateSelect:a.props.showDateSelect,showTimeSelect:a.props.showTimeSelect,showTimeSelectOnly:a.props.showTimeSelectOnly,onTimeChange:a.handleTimeChange,timeFormat:a.props.timeFormat,timeIntervals:a.props.timeIntervals,minTime:a.props.minTime,maxTime:a.props.maxTime,excludeTimes:a.props.excludeTimes,filterTime:a.props.filterTime,timeCaption:a.props.timeCaption,className:a.props.calendarClassName,container:a.props.calendarContainer,yearItemNumber:a.props.yearItemNumber,yearDropdownItemNumber:a.props.yearDropdownItemNumber,previousMonthAriaLabel:a.props.previousMonthAriaLabel,previousMonthButtonLabel:a.props.previousMonthButtonLabel,nextMonthAriaLabel:a.props.nextMonthAriaLabel,nextMonthButtonLabel:a.props.nextMonthButtonLabel,previousYearAriaLabel:a.props.previousYearAriaLabel,previousYearButtonLabel:a.props.previousYearButtonLabel,nextYearAriaLabel:a.props.nextYearAriaLabel,nextYearButtonLabel:a.props.nextYearButtonLabel,timeInputLabel:a.props.timeInputLabel,disabledKeyboardNavigation:a.props.disabledKeyboardNavigation,renderCustomHeader:a.props.renderCustomHeader,popperProps:a.props.popperProps,renderDayContents:a.props.renderDayContents,renderMonthContent:a.props.renderMonthContent,renderQuarterContent:a.props.renderQuarterContent,renderYearContent:a.props.renderYearContent,onDayMouseEnter:a.props.onDayMouseEnter,onMonthMouseLeave:a.props.onMonthMouseLeave,onYearMouseEnter:a.props.onYearMouseEnter,onYearMouseLeave:a.props.onYearMouseLeave,selectsDisabledDaysInRange:a.props.selectsDisabledDaysInRange,showTimeInput:a.props.showTimeInput,showMonthYearPicker:a.props.showMonthYearPicker,showFullMonthYearPicker:a.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:a.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:a.props.showFourColumnMonthYearPicker,showYearPicker:a.props.showYearPicker,showQuarterYearPicker:a.props.showQuarterYearPicker,showWeekPicker:a.props.showWeekPicker,showPopperArrow:a.props.showPopperArrow,excludeScrollbar:a.props.excludeScrollbar,handleOnKeyDown:a.props.onKeyDown,handleOnDayKeyDown:a.onDayKeyDown,isInputFocused:a.state.focused,customTimeInput:a.props.customTimeInput,setPreSelection:a.setPreSelection},a.props.children):null}),ie(de(a),"renderAriaLiveRegion",function(){var o,i=a.props,l=i.dateFormat,c=i.locale,d=a.props.showTimeInput||a.props.showTimeSelect?"PPPPp":"PPPP";return o=a.props.selectsRange?"Selected start date: ".concat(so(a.props.startDate,{dateFormat:d,locale:c}),". ").concat(a.props.endDate?"End date: "+so(a.props.endDate,{dateFormat:d,locale:c}):""):a.props.showTimeSelectOnly?"Selected time: ".concat(so(a.props.selected,{dateFormat:l,locale:c})):a.props.showYearPicker?"Selected year: ".concat(so(a.props.selected,{dateFormat:"yyyy",locale:c})):a.props.showMonthYearPicker?"Selected month: ".concat(so(a.props.selected,{dateFormat:"MMMM yyyy",locale:c})):a.props.showQuarterYearPicker?"Selected quarter: ".concat(so(a.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):"Selected date: ".concat(so(a.props.selected,{dateFormat:d,locale:c})),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},o)}),ie(de(a),"renderDateInput",function(){var o,i=ds(a.props.className,ie({},uw,a.state.open)),l=a.props.customInput||Te.createElement("input",{type:"text"}),c=a.props.customInputRef||"ref",d=typeof a.props.value=="string"?a.props.value:typeof a.state.inputValue=="string"?a.state.inputValue:a.props.selectsRange?function(u,h,p){if(!u)return"";var g=so(u,p),f=h?so(h,p):"";return"".concat(g," - ").concat(f)}(a.props.startDate,a.props.endDate,a.props):so(a.props.selected,a.props);return Te.cloneElement(l,(ie(ie(ie(ie(ie(ie(ie(ie(ie(ie(o={},c,function(u){a.input=u}),"value",d),"onBlur",a.handleBlur),"onChange",a.handleChange),"onClick",a.onInputClick),"onFocus",a.handleFocus),"onKeyDown",a.onInputKeyDown),"id",a.props.id),"name",a.props.name),"form",a.props.form),ie(ie(ie(ie(ie(ie(ie(ie(ie(ie(o,"autoFocus",a.props.autoFocus),"placeholder",a.props.placeholderText),"disabled",a.props.disabled),"autoComplete",a.props.autoComplete),"className",ds(l.props.className,i)),"title",a.props.title),"readOnly",a.props.readOnly),"required",a.props.required),"tabIndex",a.props.tabIndex),"aria-describedby",a.props.ariaDescribedBy),ie(ie(ie(o,"aria-invalid",a.props.ariaInvalid),"aria-labelledby",a.props.ariaLabelledBy),"aria-required",a.props.ariaRequired)))}),ie(de(a),"renderClearButton",function(){var o=a.props,i=o.isClearable,l=o.disabled,c=o.selected,d=o.startDate,u=o.endDate,h=o.clearButtonTitle,p=o.clearButtonClassName,g=p===void 0?"":p,f=o.ariaLabelClose,m=f===void 0?"Close":f;return!i||c==null&&d==null&&u==null?null:Te.createElement("button",{type:"button",className:ds("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":m,onClick:a.onClearClick,title:h,tabIndex:-1})}),a.state=a.calcInitialState(),a.preventFocusTimeout=null,a}return Zn(r,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll,!0)}},{key:"componentDidUpdate",value:function(s,a){var o,i;s.inline&&(o=s.selected,i=this.props.selected,o&&i?ws(o)!==ws(i)||br(o)!==br(i):o!==i)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&s.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),s.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:iw(this.props.highlightDates)}),a.focused||Sl(s.selected,this.props.selected)||this.setState({inputValue:null}),a.open!==this.state.open&&(a.open===!1&&this.state.open===!0&&this.props.onCalendarOpen(),a.open===!0&&this.state.open===!1&&this.props.onCalendarClose())}},{key:"componentWillUnmount",value:function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0)}},{key:"renderInputContainer",value:function(){var s=this.props,a=s.showIcon,o=s.icon,i=s.calendarIconClassname,l=s.toggleCalendarOnIconClick,c=this.state.open;return Te.createElement("div",{className:"react-datepicker__input-container".concat(a?" react-datepicker__view-calendar-icon":"")},a&&Te.createElement(sA,gd({icon:o,className:"".concat(i," ").concat(c&&"react-datepicker-ignore-onclickoutside")},l?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())}},{key:"render",value:function(){var s=this.renderCalendar();if(this.props.inline)return s;if(this.props.withPortal){var a=this.state.open?Te.createElement(sk,{enableTabLoop:this.props.enableTabLoop},Te.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},s)):null;return this.state.open&&this.props.portalId&&(a=Te.createElement(nk,{portalId:this.props.portalId,portalHost:this.props.portalHost},a)),Te.createElement("div",null,this.renderInputContainer(),a)}return Te.createElement(oA,{className:this.props.popperClassName,wrapperClassName:this.props.wrapperClassName,hidePopper:!this.isCalendarOpen(),portalId:this.props.portalId,portalHost:this.props.portalHost,popperModifiers:this.props.popperModifiers,targetComponent:this.renderInputContainer(),popperContainer:this.props.popperContainer,popperComponent:s,popperPlacement:this.props.popperPlacement,popperProps:this.props.popperProps,popperOnKeyDown:this.onPopperKeyDown,enableTabLoop:this.props.enableTabLoop})}}],[{key:"defaultProps",get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",onChange:function(){},disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",onFocus:function(){},onBlur:function(){},onKeyDown:function(){},onInputClick:function(){},onSelect:function(){},onClickOutside:function(){},onMonthChange:function(){},onCalendarOpen:function(){},onCalendarClose:function(){},preventOpenOnFocus:!1,onYearChange:function(){},onInputError:function(){},monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:yu,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1}}}]),r}(),lA="input",fg="navigate";function hw(n){if(!n||typeof n!="string"||!n.match(/\d/))return{h:0,m:0};const[t,r]=n.trim().split(/\s+/);let[s,a]=t.split(":").map(Number);return r&&r.toLowerCase()==="pm"&&s!==12&&(s+=12),r&&r.toLowerCase()==="am"&&s===12&&(s=0),{h:s,m:a}}function cA(n,t,r=30){const s=hw(n),a=hw(t),o=[];let i=new Date(0,0,0,s.h,s.m);const l=new Date(0,0,0,a.h,a.m);for(;i<=l;){const c=i.getHours(),d=i.getMinutes();let u=(c%12||12)+":"+(d<10?"0":"")+d+(c<12?" AM":" PM");o.push(u),i=new Date(i.getTime()+r*6e4)}return o}function dA({proposal:n,open:t,onClose:r,onSubmit:s,senderPlayer:a,phase:o,selectedDivision:i}){var z;const[l,c]=y.useState(new Date),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState(""),[m,v]=y.useState(""),[b,w]=y.useState(""),[x,j]=y.useState(""),[S,_]=y.useState("");y.useEffect(()=>{if(n&&t){if(n.date){const[$,W,Y]=n.date.split("-");c(new Date(parseInt($),parseInt(W)-1,parseInt(Y)))}u(""),p(""),f(n.location||""),v(n.gameType||"8 Ball"),w(n.raceLength||(o==="scheduled"||o==="challenge"?5:7)),j("")}},[n,t,o]),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][l.getDay()];const M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()],E=((z=a==null?void 0:a.availability)==null?void 0:z[M])||[],P=["6:00 PM - 8:00 PM","8:00 PM - 10:00 PM","10:00 PM - 12:00 AM"],D=E.length>0?E:P,T=a!=null&&a.locations?a.locations.split(/\r?\n/).map($=>$.trim()).filter(Boolean):[],A=y.useMemo(()=>{if(!d)return[];const $=d.replace(/[]/g,"-").replace(/\s*-\s*/g," - ").trim();if(!$.includes(" - "))return[];let[W,Y]=$.split(" - ").map(Q=>k(Q.trim()));return!W||!Y?[]:cA(W,Y,30)},[d]);function k($){let W=$.trim();W=W.replace(/(\d{1,2}):(\d{2})\s*(am|pm)/i,(Q,H,ue,J)=>`${parseInt(H,10)}:${ue} ${J.toUpperCase()}`),W=W.replace(/^(\d{1,2})(\d{2})(am|pm)$/i,(Q,H,ue,J)=>`${parseInt(H,10)}:${ue} ${J.toUpperCase()}`),W=W.replace(/^(\d{1,2})(am|pm)$/i,(Q,H,ue)=>`${parseInt(H,10)}:00 ${ue.toUpperCase()}`),W=W.replace(/(am|pm)$/i," $1"),W=W.replace(/(am|pm)$/i,Q=>Q.toUpperCase());const Y=W.match(/^(\d{1,2}):(\d{2}) (AM|PM)$/i);if(Y){const Q=Y[1],H=Y[2],ue=Y[3].toUpperCase();return`${Q}:${H} ${ue}`}return W}function R($){if(!$)return"";const W=new Date($),Y=String(W.getMonth()+1).padStart(2,"0"),Q=String(W.getDate()).padStart(2,"0"),H=W.getFullYear();return`${Y}-${Q}-${H}`}const U=$=>{if($.preventDefault(),!l||!h||!g){_("Please fill in all required fields.");return}_(""),s({date:R(l),time:h,location:g,gameType:m,raceLength:b,note:x})};return!t||!n?null:e.jsx(Uo,{open:t,onClose:r,title:" Counter Proposal",maxWidth:"500px",children:e.jsxs("form",{onSubmit:U,style:{textAlign:"left"},children:[e.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.15rem",margin:"0 0 1rem 0",color:"#fff",textAlign:"center"},children:["To: ",n.senderName||"Opponent"]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Date:"}),e.jsx(wb,{selected:l,onChange:$=>c($),dateFormat:"MM-dd-yyyy",className:"counter-proposal-date-input",required:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Time Block:"}),e.jsxs("select",{value:d,onChange:$=>{u($.target.value),p("")},required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select time block"}),D.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Start Time:"}),e.jsxs("select",{value:h,onChange:$=>p($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select..."}),A.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Location:"}),e.jsxs("select",{value:g,onChange:$=>f($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select location"}),T.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Game Type:"}),e.jsxs("select",{value:m,onChange:$=>v($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"8 Ball",children:"8 Ball"}),e.jsx("option",{value:"9 Ball",children:"9 Ball"}),e.jsx("option",{value:"10 Ball",children:"10 Ball"}),e.jsx("option",{value:"Mixed",children:"Mixed"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Race Length:"}),e.jsx("select",{value:b,onChange:$=>w(Number($.target.value)),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:(()=>o==="scheduled"||o==="challenge"?e.jsx("option",{value:5,children:"5"}):[...Array(13)].map(($,W)=>{const Y=W+3;return e.jsx("option",{value:Y,children:Y},Y)}))()})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Note (optional):"}),e.jsx("textarea",{value:x,onChange:$=>j($.target.value),placeholder:"Add a note explaining your counter proposal...",rows:3,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px",resize:"vertical"}})]}),S&&e.jsx("div",{style:{color:"#e53e3e",marginBottom:"1rem"},children:S}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"submit",style:{background:"#e53e3e",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px"},children:"Submit Counter"}),e.jsx("button",{type:"button",onClick:r,style:{background:"#6c757d",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px"},children:"Cancel"})]})]})})}const Xu={_origin:"https://api.emailjs.com"},uA=(n,t="https://api.emailjs.com")=>{Xu._userID=n,Xu._origin=t},ak=(n,t,r)=>{if(!n)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class pw{constructor(t){this.status=t.status,this.text=t.responseText}}const ok=(n,t,r={})=>new Promise((s,a)=>{const o=new XMLHttpRequest;o.addEventListener("load",({target:i})=>{const l=new pw(i);l.status===200||l.text==="OK"?s(l):a(l)}),o.addEventListener("error",({target:i})=>{a(new pw(i))}),o.open("POST",Xu._origin+n,!0),Object.keys(r).forEach(i=>{o.setRequestHeader(i,r[i])}),o.send(t)}),hA=(n,t,r,s)=>{const a=s||Xu._userID;return ak(a,n,t),ok("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:a,service_id:n,template_id:t,template_params:r}),{"Content-type":"application/json"})},pA=n=>{let t;if(typeof n=="string"?t=document.querySelector(n):t=n,!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return t},mA=(n,t,r,s)=>{const a=s||Xu._userID,o=pA(r);ak(a,n,t);const i=new FormData(o);return i.append("lib_version","3.2.0"),i.append("service_id",n),i.append("template_id",t),i.append("user_id",a),ok("/api/v1.0/email/send-form",i)},uf={init:uA,send:hA,sendForm:mA};function mw(n,t){var r=n.getFullYear()-t.getFullYear()||n.getMonth()-t.getMonth()||n.getDate()-t.getDate()||n.getHours()-t.getHours()||n.getMinutes()-t.getMinutes()||n.getSeconds()-t.getSeconds()||n.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function fA(n,t){bt(2,arguments);var r=Pt(n),s=Pt(t),a=mw(r,s),o=Math.abs(Hu(r,s));r.setDate(r.getDate()-a*o);var i=+(mw(r,s)===-a),l=a*(o-i);return l===0?0:l}function gA(n,t){return bt(2,arguments),Pt(n).getTime()-Pt(t).getTime()}var fw={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},xA="trunc";function yA(n){return n?fw[n]:fw[xA]}function bA(n,t,r){bt(2,arguments);var s=gA(n,t)/af;return yA(r==null?void 0:r.roundingMethod)(s)}function vA({to_email:n,to_name:t,day:r,date:s,time:a,location:o,proposal_note:i,confirmation_note:l,confirmed_by:c,gameType:d,raceLength:u}){return uf.send("service_l5q2047","template_dtc43h8",{to_email:n,to_name:t,day:r,date:s,time:a,location:o,proposal_note:i,confirmation_note:l,confirmed_by:c,gameType:d,raceLength:u},"g6vqrOs_Jb6LL1VCZ")}function wA({text:n,query:t}){return t?n.split(new RegExp(`(${t})`,"gi")).map((s,a)=>s.toLowerCase()===t.toLowerCase()?e.jsx("mark",{children:s},a):s):e.jsx(e.Fragment,{children:n})}const ik="https://atlasbackend-bnng.onrender.com";function jA(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function SA(){const[n]=sb(),[t,r]=y.useState(!1),[s,a]=y.useState(""),[o,i]=y.useState(!1),c=n.get("action")==="counter",d=n.get("from"),u=n.get("to"),h=n.get("day"),p=n.get("date"),g=n.get("time"),f=n.get("location"),m=n.get("proposerEmail"),v=n.get("note"),b=n.get("gameType"),w=n.get("raceLength"),x=n.get("proposalId");y.useEffect(()=>{c&&i(!0)},[c]);const j=()=>{console.log("CONFIRM BUTTON CLICKED");const S=`Hi ${d},

Your match is CONFIRMED for ${h}, ${p} at ${g} (${f}).

Game Type: ${b||"N/A"}
Race to: ${w||"N/A"}

Confirmed by: ${u}
${v?`

Original note from your opponent:
"${v}"
`:""}
${s?`

Your reply note:
"${s}"
`:""}

Good luck and have fun!`;vA({to_email:m,to_name:d,day:h,date:p,time:g,location:f,message:S,confirmed_by:u,proposal_note:v||"",confirmation_note:s||"",gameType:b||"",raceLength:w||""}),x?fetch(`${ik}/api/proposals/${x}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"confirmed",note:s})}).then(C=>{if(!C.ok)throw new Error("Failed to confirm proposal");console.log("Proposal confirmed successfully"),r(!0)}).catch(C=>{console.error("Error confirming proposal:",C),alert("Failed to confirm proposal: "+C.message)}):(console.log("No proposalId provided - showing confirmation modal"),r(!0))};return e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"},children:e.jsxs("div",{className:"draggable-modal",style:{background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:window.innerWidth<=400?"0":"1.2rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:window.innerWidth<=400?"100vw":"auto",maxWidth:window.innerWidth<=400?"100vw":"480px",minWidth:0,margin:window.innerWidth<=400?"0":"0 auto",left:0,right:0,animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:"1.5rem 2rem 1rem 2rem",position:"relative",fontFamily:"inherit",boxSizing:"border-box",textAlign:"center",marginTop:"100px",maxHeight:"85vh",overflowY:"auto"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{onClick:()=>window.location.href="/#/dashboard",style:{position:"absolute",top:"-0.5rem",right:"-0.5rem",background:"#333",color:"#fff",border:"1px solid #666",borderRadius:"50%",width:"2rem",height:"2rem",fontSize:"1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s, border-color 0.2s",zIndex:10},onMouseEnter:S=>{S.target.style.background="#e53e3e",S.target.style.borderColor="#fff"},onMouseLeave:S=>{S.target.style.background="#333",S.target.style.borderColor="#666"},children:""}),e.jsxs("h1",{style:{marginBottom:"1rem",fontSize:"1.4rem",fontWeight:"bold",letterSpacing:"0.01em",color:"#ff0000"},children:[" Front Range Pool League",e.jsx("br",{}),"Confirm Match"]})]}),e.jsx("p",{style:{marginBottom:"1rem",fontSize:"0.95rem",color:"#faf6f6",textAlign:"center"},children:"You are about to confirm this match. Your opponent will be notified by email and the match will be added to your app calendar!"}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"0.8rem",background:"#1a1a1a",color:"#faf6f6",borderRadius:8,padding:"0.4rem 0.5rem",border:"1px solid #ff0000"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"you",children:""})," ",e.jsx("strong",{children:"You:"})," ",u||"N/A"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"opponent",children:""})," ",e.jsx("strong",{children:"Opponent:"})," ",d||"N/A"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"calendar",children:""})," ",e.jsx("strong",{children:"Day:"})," ",h||"N/A"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"date",children:""})," ",e.jsx("strong",{children:"Date:"})," ",jA(p)]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"clock",children:""})," ",e.jsx("strong",{children:"Time:"})," ",g||"N/A"]}),b&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx(c_,{gameType:b,size:16})," ",e.jsx("strong",{children:"Game Type:"})," ",b]}),w&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"race",children:""})," ",e.jsx("strong",{children:"Race to:"})," ",w]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.7em",marginBottom:"0.7em",fontSize:"1rem"},children:[e.jsx("span",{role:"img","aria-label":"location",children:""})," ",e.jsx("strong",{children:"Location:"})," ",f||"N/A"]})]}),v&&e.jsxs("div",{style:{margin:"12px 0 0 0",padding:"0.6rem 0.8rem",background:"#2a2a2a",borderLeft:"3px solid #ffb300",borderRadius:4,color:"#ffb300",fontSize:"0.98rem",textAlign:"left"},children:[e.jsx("span",{role:"img","aria-label":"note",children:""})," ",e.jsx("strong",{children:"Note from opponent:"}),e.jsx("br",{}),v]}),e.jsxs("div",{style:{margin:"1rem 0 0.2rem 0",textAlign:"left"},children:[e.jsx("label",{htmlFor:"note",style:{fontWeight:500,color:"#faf6f6",marginBottom:"0.2rem",display:"block"},children:" Add a note (optional):"}),e.jsx("textarea",{id:"note",value:s,onChange:S=>a(S.target.value),rows:2,placeholder:"Write a message to your opponent",style:{width:"100%",minHeight:"54px",borderRadius:7,border:"1px solid #666",padding:"0.6em 0.8em",fontSize:"1rem",marginTop:"0.2rem",resize:"vertical",background:"#1a1a1a",color:"#faf6f6",boxSizing:"border-box",transition:"border 0.2s"},onFocus:S=>S.target.style.border="1.5px solid #ff0000",onBlur:S=>S.target.style.border="1px solid #666"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",marginTop:"1rem",flexWrap:"wrap"},children:[e.jsx("button",{style:{background:"#ff0000",color:"#fff",border:"none",borderRadius:8,padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px",transition:"background 0.18s, color 0.18s, border 0.18s, box-shadow 0.18s",boxShadow:"0 2px 6px #0001"},onMouseEnter:S=>S.target.style.background="#c90000",onMouseLeave:S=>S.target.style.background="#ff0000",onClick:j,children:" Confirm Match"}),e.jsx("button",{style:{background:"#fff",color:"#ff0000",border:"2px solid #ff0000",borderRadius:8,padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px",transition:"background 0.18s, color 0.18s, border 0.18s, box-shadow 0.18s",boxShadow:"0 2px 6px #0001"},onMouseEnter:S=>{S.target.style.background="#ff0000",S.target.style.color="#fff"},onMouseLeave:S=>{S.target.style.background="#fff",S.target.style.color="#ff0000"},onClick:()=>i(!0),children:" Counter Propose"})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"1rem"},children:e.jsx("button",{onClick:()=>window.location.href="/#/dashboard",style:{background:"#333",color:"#fff",border:"1px solid #666",borderRadius:6,padding:"0.5rem 1rem",fontSize:"0.9rem",fontWeight:"500",cursor:"pointer",transition:"background 0.2s, border-color 0.2s"},onMouseEnter:S=>{S.target.style.background="#444",S.target.style.borderColor="#888"},onMouseLeave:S=>{S.target.style.background="#333",S.target.style.borderColor="#666"},children:" Go to Dashboard"})}),e.jsx(m8,{open:t,message:"Match confirmed! The opponent has been notified and the match has been added to your app calendar.",proposalNote:v,confirmationNote:s,gameType:b,raceLength:w,day:h,date:p,time:g,location:f,onClose:()=>r(!1)}),e.jsx(dA,{open:o,onClose:()=>i(!1),proposal:{senderName:d,receiverName:u,senderEmail:m,receiverEmail:"",date:p,time:g,location:f,message:v,gameType:b,raceLength:w,_id:x},onSubmit:S=>{console.log("Counter proposal submitted:",S),i(!1)},senderPlayer:{firstName:(u==null?void 0:u.split(" ")[0])||"",lastName:(u==null?void 0:u.split(" ").slice(1).join(" "))||"",email:""},phase:"scheduled",selectedDivision:""})]})})}const _A="_dashboardBg_1ubfn_35",kA="_floatingLogo_1ubfn_55",CA="_dashboardFrame_1ubfn_71",NA="_dashboardCard_1ubfn_103",TA="_fadeInUp_1ubfn_1",PA="_dashboardTitle_1ubfn_163",EA="_dashboardUserName_1ubfn_179",RA="_dashboardSection_1ubfn_199",AA="_newsUpdatesSection_1ubfn_223",MA="_dashboardSectionBox_1ubfn_231",IA="_dashboardSectionTitle_1ubfn_255",DA="_dashboardHelperText_1ubfn_273",$A="_matchesSection_1ubfn_289",LA="_dashboardList_1ubfn_313",BA="_matchCard_1ubfn_335",OA="_matchCardButton_1ubfn_381",zA="_matchCardOpponentLabel_1ubfn_433",FA="_matchCardOpponentName_1ubfn_435",WA="_matchCardDetail_1ubfn_437",UA="_dashboardActions_1ubfn_519",qA="_dashboardBtn_1ubfn_541",HA="_dashboardBtnPrimary_1ubfn_663",YA="_dashboardBtnSecondary_1ubfn_671",GA="_dashboardBtnSuccess_1ubfn_691",VA="_dashboardBtnWarning_1ubfn_711",KA="_dashboardBtnDanger_1ubfn_731",JA="_dashboardBtnSmall_1ubfn_753",XA="_dashboardBtnLarge_1ubfn_767",QA="_buttonRow_1ubfn_803",ZA="_errorBox_1ubfn_815",eM="_dashboardAdminBtn_1ubfn_835",tM="_dashboardLogoutBtn_1ubfn_871",rM="_dashboardNoteItem_1ubfn_909",nM="_simulationOuterWrapper_1ubfn_931",sM="_simulationContainer_1ubfn_947",aM="_modalOverlay_1ubfn_989",oM="_dashboardModalContent_1ubfn_1041",iM="_modalBounceIn_1ubfn_1",lM="_modalHeader_1ubfn_1097",cM="_modalTitle_1ubfn_1123",dM="_closeBtn_1ubfn_1141",uM="_modalFooter_1ubfn_1177",hM="_footerCloseBtn_1ubfn_1219",pM="_dashboardHighlight_1ubfn_1289",mM="_pulseGlow_1ubfn_1",fM="_dashboardSimulationBox_1ubfn_1381",gM="_proposalAlertButton_1ubfn_1465",xM="_proposalAlertRow_1ubfn_1479",yM="_newsUpdatesHeader_1ubfn_1705",bM="_poolTableContainer_1ubfn_1827",vM="_modalDetailsSnazzy_1ubfn_1949",wM="_modalDetailRowSnazzy_1ubfn_1957",jM="_gameTypeIcon_1ubfn_1967",SM="_iframeWrapper_1ubfn_1985",_M="_modalIframe_1ubfn_2007",kM="_proposalModalContent_1ubfn_2031",CM="_proposalModalTitle_1ubfn_2069",NM="_proposalModalCloseBtn_1ubfn_2091",TM="_proposalCardButton_1ubfn_2133",PM="_proposalCardLabel_1ubfn_2171",EM="_proposalCardMessage_1ubfn_2183",RM="_smallShowMoreBtn_1ubfn_2193",AM="_counterProposalOverlay_1ubfn_2229",MM="_proposalList_1ubfn_2279",IM="_proposalCard_1ubfn_2133",DM="_proposalCardBtn_1ubfn_2293",$M="_proposalCardName_1ubfn_2329",LM="_emptyMsg_1ubfn_2337",BM="_matchCardContentWrapper_1ubfn_2429",OM="_matchCardDoneBtn_1ubfn_2443",zM="_standingsModalContent_1ubfn_2495",FM="_standingsTableWrapper_1ubfn_2571",WM="_standingsTable_1ubfn_2571",UM="_inputField_1ubfn_2647",qM="_proposalModalHeaderBar_1ubfn_2695",HM="_phasePill_1ubfn_2713",YM="_divisionPill_1ubfn_2733",GM="_proposalModalToRow_1ubfn_2749",VM="_toOpponentLabel_1ubfn_2763",KM="_toOpponentName_1ubfn_2775",JM="_proposalModalDayRow_1ubfn_2785",XM="_dayLabel_1ubfn_2799",QM="_dayValue_1ubfn_2811",ZM="_proposalModalFieldRow_1ubfn_2821",eI="_fieldLabel_1ubfn_2831",tI="_datePill_1ubfn_2849",rI="_proposalModalButtonRow_1ubfn_2875",nI="_root_1ubfn_1",sI="_challengeStatsContainer_1ubfn_3207",aI="_challengeStatsHeader_1ubfn_3223",oI="_challengeStatsGrid_1ubfn_3231",iI="_challengeStatCard_1ubfn_3245",lI="_challengeStatHeader_1ubfn_3269",cI="_challengeProgressBar_1ubfn_3287",dI="_challengeProgressFill_1ubfn_3305",uI="_challengeStatDetails_1ubfn_3315",hI="_challengeStatusSummary_1ubfn_3335",pI="_mobileMatchesOverlay_1ubfn_3579",mI="_countersRow_1ubfn_3587",fI="_counterBox_1ubfn_3599",gI="_scheduleMatchBtn_1ubfn_3607",xI="_noMatchesText_1ubfn_3753",yI="_dashboardButton_1ubfn_3955",bI="_dashboardButtonSmall_1ubfn_3969",vI="_dashboardButtonLarge_1ubfn_3981",wI="_dashboardGrid_1ubfn_3993",jI="_dashboardFlexRow_1ubfn_4003",SI="_dashboardStats_1ubfn_4025",_I="_dashboardStat_1ubfn_4025",kI="_dashboardStatValue_1ubfn_4045",CI="_dashboardStatLabel_1ubfn_4053",NI="_dashboardText_1ubfn_4225",TI="_dashboardTextSmall_1ubfn_4235",PI="_dashboardSpacing_1ubfn_4247",EI="_dashboardSpacingLarge_1ubfn_4255",RI="_matchManager_1ubfn_4573",AI="_matchStats_1ubfn_4587",MI="_statsGrid_1ubfn_4617",II="_statItem_1ubfn_4629",DI="_statNumber_1ubfn_4645",$I="_statLabel_1ubfn_4661",LI="_matchSection_1ubfn_4675",BI="_noMatches_1ubfn_3753",OI="_matchList_1ubfn_4719",zI="_completedMatch_1ubfn_4759",FI="_matchHeader_1ubfn_4777",WI="_matchStatus_1ubfn_4791",UI="_matchDate_1ubfn_4809",qI="_matchPlayers_1ubfn_4819",HI="_player1_1ubfn_4837",YI="_player2_1ubfn_4837",GI="_winner_1ubfn_4851",VI="_vs_1ubfn_4863",KI="_matchDetails_1ubfn_4873",JI="_location_1ubfn_4891",XI="_type_1ubfn_4891",QI="_matchResult_1ubfn_4903",ZI="_score_1ubfn_4921",eD="_matchNotes_1ubfn_4931",tD="_notesLabel_1ubfn_4943",rD="_notesText_1ubfn_4957",nD="_matchActions_1ubfn_4969",sD="_actionButton_1ubfn_4985",aD="_cancelButton_1ubfn_5021",oD="_modal_1ubfn_989",iD="_formGroup_1ubfn_5105",lD="_modalActions_1ubfn_5177",cD="_loading_1ubfn_5257",dD="_mobileCard_1ubfn_5373",uD="_mobileCardElevated_1ubfn_5403",hD="_mobileCardOutlined_1ubfn_5413",pD="_mobileButton_1ubfn_5425",mD="_mobileButtonSecondary_1ubfn_5503",fD="_mobileButtonSuccess_1ubfn_5523",gD="_mobileButtonWarning_1ubfn_5543",xD="_mobileButtonDanger_1ubfn_5563",yD="_mobileButtonSmall_1ubfn_5583",bD="_mobileButtonLarge_1ubfn_5595",vD="_mobileButtonFullWidth_1ubfn_5607",wD="_mobileList_1ubfn_5617",jD="_mobileListItem_1ubfn_5629",SD="_mobileNavigation_1ubfn_5671",_D="_mobileActionSheetOverlay_1ubfn_5693",kD="_fadeIn_1ubfn_1",CD="_mobileActionSheet_1ubfn_5693",ND="_slideUp_1ubfn_1",TD="_mobileSwipeableCard_1ubfn_5747",PD="_mobilePullToRefresh_1ubfn_5803",ED="_mobileDashboard_1ubfn_5815",RD="_mobileLoadingOverlay_1ubfn_6039",AD="_mobileErrorContainer_1ubfn_6069",MD="_mobileErrorIcon_1ubfn_6091",ID="_mobileErrorMessage_1ubfn_6103",DD="_mobileSuccessContainer_1ubfn_6119",$D="_mobileSuccessIcon_1ubfn_6141",LD="_mobileSuccessMessage_1ubfn_6153",BD="_mobileInfoContainer_1ubfn_6169",OD="_mobileInfoIcon_1ubfn_6191",zD="_mobileInfoMessage_1ubfn_6203",FD="_loadingOverlay_1ubfn_6349",WD="_loadingSpinner_1ubfn_6377",UD="_spin_1ubfn_1",qD="_loadingText_1ubfn_6405",HD="_skeletonLoader_1ubfn_6423",YD="_skeletonLine_1ubfn_6437",GD="_shimmer_1ubfn_1",VD="_errorContainer_1ubfn_6477",KD="_errorIcon_1ubfn_6499",JD="_errorMessage_1ubfn_6511",XD="_errorAction_1ubfn_6525",QD="_successContainer_1ubfn_6561",ZD="_successIcon_1ubfn_6583",e$="_successMessage_1ubfn_6595",t$="_infoContainer_1ubfn_6615",r$="_infoIcon_1ubfn_6637",n$="_infoMessage_1ubfn_6649",s$="_srOnly_1ubfn_6705",a$="_slideInLeft_1ubfn_1",o$="_slideInRight_1ubfn_1",Ke={dashboardBg:_A,floatingLogo:kA,dashboardFrame:CA,dashboardCard:NA,fadeInUp:TA,dashboardTitle:PA,dashboardUserName:EA,dashboardSection:RA,newsUpdatesSection:AA,dashboardSectionBox:MA,dashboardSectionTitle:IA,dashboardHelperText:DA,matchesSection:$A,dashboardList:LA,matchCard:BA,matchCardButton:OA,matchCardOpponentLabel:zA,matchCardOpponentName:FA,matchCardDetail:WA,dashboardActions:UA,dashboardBtn:qA,dashboardBtnPrimary:HA,dashboardBtnSecondary:YA,dashboardBtnSuccess:GA,dashboardBtnWarning:VA,dashboardBtnDanger:KA,dashboardBtnSmall:JA,dashboardBtnLarge:XA,buttonRow:QA,errorBox:ZA,dashboardAdminBtn:eM,dashboardLogoutBtn:tM,dashboardNoteItem:rM,simulationOuterWrapper:nM,simulationContainer:sM,modalOverlay:aM,dashboardModalContent:oM,modalBounceIn:iM,modalHeader:lM,modalTitle:cM,closeBtn:dM,modalFooter:uM,footerCloseBtn:hM,dashboardHighlight:pM,pulseGlow:mM,dashboardSimulationBox:fM,proposalAlertButton:gM,proposalAlertRow:xM,newsUpdatesHeader:yM,poolTableContainer:bM,modalDetailsSnazzy:vM,modalDetailRowSnazzy:wM,gameTypeIcon:jM,iframeWrapper:SM,modalIframe:_M,proposalModalContent:kM,proposalModalTitle:CM,proposalModalCloseBtn:NM,proposalCardButton:TM,proposalCardLabel:PM,proposalCardMessage:EM,smallShowMoreBtn:RM,counterProposalOverlay:AM,proposalList:MM,proposalCard:IM,proposalCardBtn:DM,proposalCardName:$M,emptyMsg:LM,matchCardContentWrapper:BM,matchCardDoneBtn:OM,standingsModalContent:zM,standingsTableWrapper:FM,standingsTable:WM,inputField:UM,proposalModalHeaderBar:qM,phasePill:HM,divisionPill:YM,proposalModalToRow:GM,toOpponentLabel:VM,toOpponentName:KM,proposalModalDayRow:JM,dayLabel:XM,dayValue:QM,proposalModalFieldRow:ZM,fieldLabel:eI,datePill:tI,proposalModalButtonRow:rI,root:nI,challengeStatsContainer:sI,challengeStatsHeader:aI,challengeStatsGrid:oI,challengeStatCard:iI,challengeStatHeader:lI,challengeProgressBar:cI,challengeProgressFill:dI,challengeStatDetails:uI,challengeStatusSummary:hI,mobileMatchesOverlay:pI,countersRow:mI,counterBox:fI,scheduleMatchBtn:gI,noMatchesText:xI,dashboardButton:yI,dashboardButtonSmall:bI,dashboardButtonLarge:vI,dashboardGrid:wI,dashboardFlexRow:jI,dashboardStats:SI,dashboardStat:_I,dashboardStatValue:kI,dashboardStatLabel:CI,dashboardText:NI,dashboardTextSmall:TI,dashboardSpacing:PI,dashboardSpacingLarge:EI,matchManager:RI,matchStats:AI,statsGrid:MI,statItem:II,statNumber:DI,statLabel:$I,matchSection:LI,noMatches:BI,matchList:OI,completedMatch:zI,matchHeader:FI,matchStatus:WI,matchDate:UI,matchPlayers:qI,player1:HI,player2:YI,winner:GI,vs:VI,matchDetails:KI,location:JI,type:XI,matchResult:QI,score:ZI,matchNotes:eD,notesLabel:tD,notesText:rD,matchActions:nD,actionButton:sD,cancelButton:aD,modal:oD,formGroup:iD,modalActions:lD,loading:cD,mobileCard:dD,mobileCardElevated:uD,mobileCardOutlined:hD,mobileButton:pD,mobileButtonSecondary:mD,mobileButtonSuccess:fD,mobileButtonWarning:gD,mobileButtonDanger:xD,mobileButtonSmall:yD,mobileButtonLarge:bD,mobileButtonFullWidth:vD,mobileList:wD,mobileListItem:jD,mobileNavigation:SD,mobileActionSheetOverlay:_D,fadeIn:kD,mobileActionSheet:CD,slideUp:ND,mobileSwipeableCard:TD,mobilePullToRefresh:PD,mobileDashboard:ED,mobileLoadingOverlay:RD,mobileErrorContainer:AD,mobileErrorIcon:MD,mobileErrorMessage:ID,mobileSuccessContainer:DD,mobileSuccessIcon:$D,mobileSuccessMessage:LD,mobileInfoContainer:BD,mobileInfoIcon:OD,mobileInfoMessage:zD,loadingOverlay:FD,loadingSpinner:WD,spin:UD,loadingText:qD,skeletonLoader:HD,skeletonLine:YD,shimmer:GD,errorContainer:VD,errorIcon:KD,errorMessage:JD,errorAction:XD,successContainer:QD,successIcon:ZD,successMessage:e$,infoContainer:t$,infoIcon:r$,infoMessage:n$,srOnly:s$,slideInLeft:a$,slideInRight:o$},Qu="/assets/tenball-c626129a.svg",wm="/assets/nineball-545f1e90.svg",jm="/assets/8ball-35eff270.svg",i$="/assets/cueball-dc05310a.svg",l$="_pinLoginBg_1hrzk_8",c$="_pinLoginFrame_1hrzk_21",d$="_gameMode_1hrzk_36",u$="_pinLoginCard_1hrzk_43",h$="_simulationOuterWrapper_1hrzk_58",p$="_simulationContainer_1hrzk_67",m$="_tableImg_1hrzk_87",f$="_pinLoginTitle_1hrzk_102",g$="_pinLoginSubtitle_1hrzk_111",x$="_pinLoginLock_1hrzk_118",y$="_pinInput_1hrzk_124",b$="_pinLoginBtn_1hrzk_148",v$="_signupBtn_1hrzk_174",w$="_pinLoginError_1hrzk_200",j$="_pinBallImg_1hrzk_212",S$="_glow_1hrzk_225",_$="_cueBall_1hrzk_221",k$="_glow1_1hrzk_225",C$="_glow2_1hrzk_226",N$="_glow3_1hrzk_227",T$={pinLoginBg:l$,pinLoginFrame:c$,gameMode:d$,pinLoginCard:u$,simulationOuterWrapper:h$,simulationContainer:p$,tableImg:m$,pinLoginTitle:f$,pinLoginSubtitle:g$,pinLoginLock:x$,pinInput:y$,pinLoginBtn:b$,signupBtn:v$,pinLoginError:w$,pinBallImg:j$,glow:S$,cueBall:_$,glow1:k$,glow2:C$,glow3:N$},P$="/assets/logo-38c98395.png",E$="/PredatorTable.png",R$=[{key:"cue",src:i$,alt:"Cue Ball"},{key:"8",src:jm,alt:"8 Ball"},{key:"9",src:wm,alt:"9 Ball"},{key:"10",src:Qu,alt:"10 Ball"}],lk=600,ck=300,qr=15,ma=qr/2;function A$(n,t,r,s=1){const a=r*s,o=t.x-n.x,i=t.y-n.y,l=Math.sqrt(o*o+i*i);if(l===0||l>=a)return;const c=a-l+.01,d=o/l,u=i/l;n.x-=d*(c/2),n.y-=u*(c/2),t.x+=d*(c/2),t.y+=u*(c/2);const h=n.vx-t.vx,p=n.vy-t.vy,f=-(h*d+p*u)||.01;n.vx+=f*d,n.vy+=f*u,t.vx-=f*d,t.vy-=f*u,n.isMoving=!0,t.isMoving=!0}function M$(n=lk,t=ck,r=1){const s=n/r,a=t/r;return[{x:0,y:0},{x:s,y:0},{x:0,y:a},{x:s,y:a},{x:s/2,y:0},{x:s/2,y:a}]}function Zu({isRotated:n=!1}){console.log("PoolSimulation isRotated:",n);const t=y.useRef(null),r=y.useRef(null),s=y.useRef({cue:Te.createRef(),8:Te.createRef(),9:Te.createRef(),10:Te.createRef()}),a=y.useRef({}),o=y.useRef({}),i=y.useRef(null),l=y.useRef(null),c=y.useRef(0),d=y.useRef(1),[u,h]=y.useState(!1);function p(){Object.keys(a.current).forEach(w=>{o.current[w]={x:a.current[w].x,y:a.current[w].y}})}function g(){const w=t.current;if(!w)return;const x=w.offsetWidth,j=w.offsetHeight,S=x/d.current,_=j/d.current,C=S*.25,N=_/2,M=qr*.87,E=qr*.5;function P(){return(Math.random()-.5)*1}a.current={8:{ref:s.current[8],x:C+P(),y:N+P(),vx:0,vy:0,isMoving:!1,visible:!0},9:{ref:s.current[9],x:C-M+P(),y:N-E+P(),vx:0,vy:0,isMoving:!1,visible:!0},10:{ref:s.current[10],x:C-M+P(),y:N+E+P(),vx:0,vy:0,isMoving:!1,visible:!0},cue:{ref:s.current.cue,x:S*.85,y:_/2,vx:0,vy:0,isMoving:!1,visible:!0}},Object.values(a.current).forEach(D=>{D.ref.current&&(D.ref.current.style.opacity=1)}),p()}function f(){g(),c.current=0,setTimeout(()=>{m()},1e3)}y.useEffect(()=>{if(t.current&&!u){const w=t.current,x=w.offsetWidth,j=w.offsetHeight;if(window.innerWidth<=768)x<350||j<250?d.current=.4:x<400||j<300?d.current=.45:d.current=.5;else{const _=x/lk,C=j/ck;d.current=Math.min(_,C)}g(),setTimeout(()=>{m()},1e3),h(!0)}return()=>{cancelAnimationFrame(i.current),clearTimeout(l.current)}},[u]);function m(){if(!a.current.cue||a.current.cue.isMoving)return;const w=a.current.cue;if(c.current+=1,c.current===1){a.current[8];const x=a.current[9],j=t.current;if(!j)return;const S=j.offsetWidth,_=j.offsetHeight,C=S/d.current,N=_/d.current,M=C*.85,E=N*.5;w.x=M,w.y=E;const P=x.x+(Math.random()-.5)*qr*.3,D=x.y+(Math.random()-.5)*qr*.3,T=P-w.x,A=D-w.y,k=Math.atan2(A,T)+(Math.random()-.5)*(Math.PI/45),R=18+Math.random()*3;w.vx=Math.cos(k)*R,w.vy=Math.sin(k)*R,w.isMoving=!0,b();return}v()}function v(){var R;const w=["8","9","10"],x=w.find(U=>{var z;return(z=a.current[U])==null?void 0:z.visible});if(!x)return;const j=a.current.cue,S=a.current[x],_=t.current;if(!_)return;const C=_.offsetWidth,N=_.offsetHeight;C/d.current,N/d.current;const M=M$(C,N,d.current);let E=null,P=1/0;for(const U of M){U.x-S.x,U.y-S.y;let z=U.x,$=U.y;const W=z-S.x,Y=$-S.y,Q=Math.hypot(W,Y),H=S.x-W/Q*qr,ue=S.y-Y/Q*qr;let J=!0;for(const me of w)if(me!==x&&(R=a.current[me])!=null&&R.visible){const Ce=a.current[me];if(Math.abs((ue-j.y)*Ce.x-(H-j.x)*Ce.y+H*j.y-ue*j.x)/Math.hypot(H-j.x,ue-j.y)<qr*.6){J=!1;break}}if(!J)continue;const be=Math.hypot(j.x-H,j.y-ue),Ae=Math.hypot(S.x-U.x,S.y-U.y);let O=be*.05;O+=Ae*.02,be<qr*3?O*=.01:be<qr*6?O*=.1:be<qr*10&&(O*=.3);const oe=w.find(me=>{var Ce;return me!==x&&((Ce=a.current[me])==null?void 0:Ce.visible)});if(oe){const me=a.current[oe],Ce=H+(H-j.x)*.3,ve=ue+(ue-j.y)*.3;Math.hypot(Ce-me.x,ve-me.y)<qr*8&&(O*=.5)}O+=Math.random()*.2,O<P&&(P=O,E={ghostX:H,ghostY:ue,targetToPocket:Ae,cueToGhost:be,pocket:U})}if(!E){const U=Math.atan2(S.y-j.y,S.x-j.x),z=Math.hypot(S.x-j.x,S.y-j.y);E={ghostX:j.x+Math.cos(U)*z*.7,ghostY:j.y+Math.sin(U)*z*.7,targetToPocket:1e3,cueToGhost:z}}const D=E.ghostX-j.x,T=E.ghostY-j.y,A=Math.hypot(D,T);let k;A<qr*2?k=3:A<qr*4?k=4:A<qr*8?k=5:A<qr*12?k=6:k=7,E.targetToPocket>qr*6&&(k+=1),k+=(Math.random()-.5)*.3,k=Math.max(2,Math.min(8,k)),j.vx=D/A*k,j.vy=T/A*k,j.isMoving=!0,b()}function b(){const j=t.current;if(!j)return;const S=j.offsetWidth,_=j.offsetHeight,C=ma*3.5,N=ma*4.5,M=C,E=S/d.current-N,P=C,D=_/d.current-C;function T(){for(let A=0;A<16;A++){Object.entries(a.current).forEach(([R,U])=>{if(!U.visible)return;let z=U.x+U.vx/16,$=U.y+U.vy/16;const W=t.current;if(W){const Y=W.offsetWidth,Q=W.offsetHeight,H=Y/d.current,ue=Q/d.current;[{x:0,y:0},{x:H,y:0},{x:0,y:ue},{x:H,y:ue},{x:H/2,y:0},{x:H/2,y:ue}].some(Ae=>Math.hypot(z-Ae.x,$-Ae.y)<qr*4)?(console.log(`Ball ${R} pocketed! Position: (${z.toFixed(1)}, ${$.toFixed(1)})`),U.isMoving=!1,U.visible=!1,U.ref.current&&(U.ref.current.style.opacity=0)):(z<M+ma?(U.x=M+ma,U.vx=Math.abs(U.vx)*.75):z>E-ma?(U.x=E-ma,U.vx=-Math.abs(U.vx)*.75):U.x=z,$<P+ma?(U.y=P+ma,U.vy=Math.abs(U.vy)*.75):$>D-ma?(U.y=D-ma,U.vy=-Math.abs(U.vy)*.75):U.y=$,U.vx*=Math.pow(.99,1/16),U.vy*=Math.pow(.99,1/16))}U.isMoving&&Math.abs(U.vx)<.03&&Math.abs(U.vy)<.03&&(U.vx=0,U.vy=0,U.isMoving=!1)});const k=Object.keys(a.current);for(let R=0;R<k.length;R++)for(let U=R+1;U<k.length;U++){const z=a.current[k[R]],$=a.current[k[U]];!z.visible||!$.visible||A$(z,$,qr,d.current)}}if(Object.entries(a.current).forEach(([A,k])=>{if(k.ref.current&&k.visible){const R=k.x*d.current-ma*d.current,U=k.y*d.current-ma*d.current,z=qr*d.current,$=window.innerWidth<=768;let W=S-z,Y=_-z;$&&(W=Math.max(0,S-z-5),Y=Math.max(0,_-z-5)),k.ref.current.style.left=Math.max(0,Math.min(R,W))+"px",k.ref.current.style.top=Math.max(0,Math.min(U,Y))+"px",k.ref.current.style.width=z+"px",k.ref.current.style.height=z+"px",k.ref.current.style.opacity=1}}),!a.current.cue.visible){if(Object.values(a.current).some(W=>W.isMoving)){i.current=requestAnimationFrame(T);return}const A=t.current;if(!A)return;const k=A.offsetWidth,R=A.offsetHeight,U=k/d.current,z=R/d.current,$=["8","9","10"].filter(W=>{var Y;return(Y=a.current[W])==null?void 0:Y.visible});if($.length>0){const W=$[0],Y=a.current[W],Q=(Math.random()-.5)*qr*2,H=(Math.random()-.5)*qr*2;a.current.cue.x=Y.x+Q,a.current.cue.y=Y.y+H}else a.current.cue.x=U*.5,a.current.cue.y=z*.5;a.current.cue.vx=0,a.current.cue.vy=0,a.current.cue.isMoving=!1,a.current.cue.visible=!0,a.current.cue.ref.current&&(a.current.cue.ref.current.style.opacity=1),setTimeout(()=>{v()},1500);return}if(!a.current[10].visible){setTimeout(()=>{f()},1200);return}Object.values(a.current).some(A=>A.isMoving)?i.current=requestAnimationFrame(T):l.current||(l.current=setTimeout(()=>{l.current=null,v()},2e3))}i.current=requestAnimationFrame(T)}return e.jsxs("div",{ref:t,"data-pool-container":!0,style:{width:"100%",height:"100%",position:"relative",background:"linear-gradient(180deg, #1a1a1a 0%, #000000 100%)",zIndex:0,boxShadow:"inset 0 0 50px rgba(0,0,0,0.8)",pointerEvents:"none"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"radial-gradient(ellipse 1200px 800px at center 60px, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.04) 20%, rgba(255,255,255,0.02) 40%, rgba(255,255,255,0.01) 60%, transparent 80%)",zIndex:3,pointerEvents:"none"}}),e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"radial-gradient(circle 800px at center 40px, rgba(255,255,255,0.02) 0%, transparent 70%)",zIndex:3,pointerEvents:"none"}}),e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"radial-gradient(circle 800px at center 40px, rgba(255,255,255,0.02) 0%, transparent 70%)",zIndex:3,pointerEvents:"none"}}),e.jsx("img",{ref:r,src:E$,alt:"Pool Table",style:{width:"100%",height:"100%",display:"block",objectFit:"fill",position:"absolute",top:1,left:0,zIndex:1,pointerEvents:"none",opacity:1,filter:"opacity(1) contrast(1.3) brightness(1.25) saturate(1.1)",boxShadow:"inset 0 0 30px rgba(0,0,0,0.3)",transform:n?"rotate(90deg)":"none",transformOrigin:"center center"},onLoad:()=>{console.log("Table image loaded, isRotated:",n,"transform:",n?"rotate(90deg)":"none")}}),e.jsx("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",userSelect:"none",zIndex:2},children:e.jsx("img",{src:P$,alt:"League Logo",style:{position:"absolute",left:"50%",top:"50%",width:"30.5%",height:"auto",transform:n?"translate(-50%, -50%) rotate(-90deg)":"translate(-50%, -50%)",objectFit:"contain",zIndex:2,opacity:.25,filter:"drop-shadow(0 1px 4px rgba(0,0,0,0.3))",pointerEvents:"none",userSelect:"none"}})}),R$.map(w=>{var x,j;return e.jsxs(Te.Fragment,{children:[e.jsx("img",{src:w.src,alt:w.alt,ref:s.current[w.key],className:T$.pinBallImg,style:{position:"absolute",left:0,top:0,width:qr,height:qr,zIndex:10,opacity:((x=a.current[w.key])==null?void 0:x.visible)===!1?0:1,transition:"none",pointerEvents:"none",filter:"opacity(1) contrast(1.3) brightness(1.2) saturate(1.1) drop-shadow(0 2px 4px rgba(0,0,0,0.3))",borderRadius:"50%",transform:n?"rotate(-90deg)":"none",transformOrigin:"center center"}}),e.jsx("div",{style:{position:"absolute",left:3,top:3,width:qr-6,height:qr-6,borderRadius:"50%",background:"radial-gradient(ellipse 8px 4px at 30% 30%, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.1) 50%, transparent 100%)",zIndex:11,opacity:((j=a.current[w.key])==null?void 0:j.visible)===!1?0:.8,pointerEvents:"none"}})]},w.key)})]})}function dk({aspectWidth:n,aspectHeight:t,children:r}){const s=y.useRef(null),[a,o]=y.useState(.6);return y.useEffect(()=>{if(s.current){const{width:i,height:l}=s.current.getBoundingClientRect(),c=Math.min(i/n,l/t);o(c)}},[n,t]),e.jsx("div",{ref:s,style:{width:"100%",height:"100%",position:"relative",overflow:"visible",contain:"layout style paint"},children:e.jsx("div",{style:{width:n,height:t,transform:`translate(-50%, -50%) scale(${a})`,transformOrigin:"center center",position:"absolute",top:"50%",left:"50%",pointerEvents:"none"},children:r})})}function It({open:n,onClose:t,children:r,title:s="Modal",maxWidth:a="800px",maxHeight:o=null,className:i="",borderColor:l="#e53e3e",textColor:c="#fff",glowColor:d="#e53e3e",style:u={},zIndex:h=1e5,containerSelector:p=null}){const[g,f]=y.useState({x:0,y:0}),[m,v]=y.useState(!1),[b,w]=y.useState(window.innerWidth<=768),x=y.useRef({x:0,y:0});y.useEffect(()=>{n&&(console.log(" Modal opening - resetting drag position to center"),f({x:0,y:0}))},[n]),y.useEffect(()=>{const P=()=>{w(window.innerWidth<=768)};return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]);const j=P=>{v(!0),x.current={x:P.clientX-g.x,y:P.clientY-g.y},document.body.style.userSelect="none"},S=P=>{m&&f({x:P.clientX-x.current.x,y:P.clientY-x.current.y})},_=()=>{v(!1),document.body.style.userSelect=""};y.useEffect(()=>(m?(window.addEventListener("mousemove",S),window.addEventListener("mouseup",_)):(window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",_)),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",_)}),[m]);const[C,N]=y.useState(null);if(y.useEffect(()=>{if(n&&p){const P=document.querySelector(p);if(P){const D=()=>{const T=P.getBoundingClientRect();N({top:T.top,left:T.left,width:T.width,height:T.height})};return D(),window.addEventListener("resize",D),window.addEventListener("scroll",D,!0),()=>{window.removeEventListener("resize",D),window.removeEventListener("scroll",D,!0)}}}else N(null)},[n,p]),console.log(" DraggableModal: open prop is:",n),!n)return console.log(" DraggableModal: Not rendering because open is false"),null;console.log(" DraggableModal: Rendering modal because open is true");const M=C?{position:"fixed",top:`${C.top}px`,left:`${C.left}px`,width:`${C.width}px`,height:`${C.height}px`,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",padding:b?"10px":"20px",zIndex:h,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"}:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",padding:b?"10px":"20px",zIndex:h,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"},E=e.jsxs("div",{className:"modal-overlay",onClick:t,style:M,children:[e.jsxs("div",{className:`draggable-modal ${i}`,style:{transform:window.innerWidth<=768?"translate(-50%, -50%)":`translate(-50%, -50%) translate(${g.x}px, ${g.y}px)`,cursor:m?"grabbing":"default",background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:`2px solid ${l}`,borderRadius:window.innerWidth<=768?"0.5rem":"1.2rem",boxShadow:`0 0 32px ${d}, 0 0 40px rgba(0,0,0,0.85)`,width:window.innerWidth<=768?"95vw":(u.width||"800px")+" !important",maxWidth:window.innerWidth<=768?"95vw":u.maxWidth||a,minWidth:window.innerWidth<=768?"320px":"800px",maxHeight:window.innerWidth<=768?"90vh":u.maxHeight||o||"90vh",margin:"0",left:"50%",top:"50%",position:"fixed",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,fontFamily:"inherit",boxSizing:"border-box",height:u.height||o||(window.innerWidth<=768,"auto"),display:"flex",flexDirection:"column",...u},onClick:P=>P.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":s,tabIndex:-1,children:[e.jsxs("div",{className:"modal-header",onMouseDown:j,style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",background:l,padding:window.innerWidth<=768?"0.3rem 0.5rem":"0.4rem 0.6rem",borderTopLeftRadius:window.innerWidth<=768?"0.5rem":"1.2rem",borderTopRightRadius:window.innerWidth<=768?"0.5rem":"1.2rem",position:"relative",cursor:"grab",userSelect:"none",gap:window.innerWidth<=768?"0.3rem":"0.4rem"},children:[e.jsx("span",{className:"modal-accent-bar",style:{position:"absolute",left:0,top:0,width:"100%",height:"5px",background:`linear-gradient(90deg, #fff0 0%, ${l} 60%, #fff0 100%)`,borderTopLeftRadius:window.innerWidth<=768?"0.5rem":"1.2rem",borderTopRightRadius:window.innerWidth<=768?"0.5rem":"1.2rem",pointerEvents:"none"}}),e.jsx("h2",{className:"modal-title",style:{margin:0,fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0,color:c},children:s}),e.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close",style:{background:"none",border:"none",color:"#fff",fontSize:window.innerWidth<=768?"1.2em":"1.5em",fontWeight:"bold",cursor:"pointer",zIndex:10,alignSelf:"flex-start",marginTop:"0",lineHeight:1,transition:"color 0.2s, transform 0.2s",padding:0,marginLeft:"1rem"},onMouseEnter:P=>{P.target.style.color="#ffd6d6",P.target.style.transform="scale(1.2) rotate(10deg)"},onMouseLeave:P=>{P.target.style.color="#fff",P.target.style.transform="scale(1) rotate(0deg)"},children:""})]}),e.jsx("div",{className:"modal-content",style:{flex:"1 1 auto",minHeight:0,overflowY:"auto",padding:window.innerWidth<=768?"0.6rem 0.8rem 0.4rem 0.8rem":"0.8rem 1rem 0.6rem 1rem",background:"none"},children:r})]}),e.jsx("style",{children:`
        @keyframes modalBounceIn {
          0% { opacity: 0; transform: scale(0.95) translateY(-40px);}
          70% { opacity: 1; transform: scale(1.02) translateY(8px);}
          100% { opacity: 1; transform: scale(1) translateY(0);}
        }
        
        /* Force content to fill modal width */
        .draggable-modal form,
        .draggable-modal > div,
        .modal-content > * {
          width: 100% !important;
          max-width: 100% !important;
          box-sizing: border-box !important;
        }
        
        @media (max-width: 768px) {
          .modal-overlay {
            padding: 20px !important;
            align-items: center !important;
            justify-content: center !important;
          }
          .draggable-modal {
            max-width: 95vw !important;
            border-radius: 0.5rem !important;
            height: auto !important;
            max-height: 90vh !important;
            margin: 0 !important;
            left: 50% !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
            position: fixed !important;
          }
          .modal-header {
            padding: 0.5rem 0.5rem 0.3rem 0.5rem !important;
          }
          .modal-content {
            padding: 0.8rem 0.6rem 0.6rem 0.6rem !important;
            flex: 1 1 auto !important;
            min-height: 0 !important;
            overflow-y: auto !important;
            max-height: calc(90vh - 60px) !important;
          }
        }
        
        @media (max-width: 480px) {
          .modal-overlay {
            padding: 15px !important;
            align-items: center !important;
            justify-content: center !important;
          }
          .draggable-modal {
            max-width: 98vw !important;
            border-radius: 0.3rem !important;
            height: auto !important;
            max-height: 95vh !important;
            margin: 0 !important;
            left: 50% !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
            position: fixed !important;
          }
          .modal-content {
            max-height: calc(95vh - 50px) !important;
          }
          .modal-header {
            padding: 0.4rem 0.4rem 0.2rem 0.4rem !important;
          }
          .modal-content {
            padding: 0.6rem 0.5rem 0.5rem 0.5rem !important;
          }
        }
        /* Custom scrollbar for modal-content */
        .modal-content::-webkit-scrollbar {
          width: 10px;
        }
        .modal-content::-webkit-scrollbar-thumb {
          background: ${l};
          border-radius: 6px;
        }
        .modal-content::-webkit-scrollbar-track {
          background: #232323;
          border-radius: 6px;
        }
        .modal-content {
          scrollbar-width: thin;
          scrollbar-color: ${l} #232323;
        }
      `})]});return xr.createPortal(E,document.body)}function I$({open:n,onClose:t,standingsUrl:r}){const[s,a]=y.useState(!0);return n?e.jsxs(It,{open:n,onClose:t,title:" League Standings",maxWidth:"90vw",className:"standings-modal",children:[e.jsxs("div",{style:{height:"70vh",width:"100%",position:"relative"},children:[s&&e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,color:"#e53e3e",fontSize:"1.2rem",fontWeight:"bold"},children:"Loading standings..."}),e.jsx("iframe",{src:r,style:{width:"100%",height:"100%",border:"none",borderRadius:"8px",background:"#fff"},title:"League Standings",onLoad:()=>a(!1)})]}),e.jsx("div",{style:{marginTop:"1rem",textAlign:"center",color:"#888",fontSize:"0.9rem"},children:"Front Range Pool League"})]}):null}const Ie="https://atlasbackend-bnng.onrender.com";function D$({open:n,onClose:t,playerName:r,playerLastName:s,selectedDivision:a}){y.useState([]);const[o,i]=y.useState(!0),[l,c]=y.useState(null),[d,u]=y.useState(null),[h,p]=y.useState([]),g=`${r} ${s}`;return y.useEffect(()=>{if(!n||!a)return;async function f(){try{i(!0),c(null);const m=a.replace(/[^A-Za-z0-9]/g,"_"),v=`${Ie}/static/standings_${m}.json`,b=await fetch(v);if(!b.ok)throw new Error(`Failed to fetch standings: ${b.status}`);const w=await b.json(),x=w.findIndex(j=>j.name&&j.name.toLowerCase().includes(g.toLowerCase()));if(x!==-1){u(x+1);const j=w.slice(x+1,x+5);p(j)}else c("Could not find user in standings")}catch(m){console.error("Error fetching standings:",m),c("Failed to load standings data")}finally{i(!1)}}f()},[n,a,g]),n?e.jsx("div",{className:Ke.modalOverlay,onClick:t,children:e.jsxs("div",{className:Ke.dashboardModalContent,onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:Ke.modalHeader,children:[e.jsx("h2",{className:Ke.modalTitle,children:" Potential Challengers"}),e.jsx("button",{className:Ke.closeBtn,onClick:t,children:""})]}),e.jsxs("div",{style:{padding:"20px",flex:1,overflowY:"auto",display:"flex",flexDirection:"column"},children:[e.jsx("p",{style:{margin:"0 0 20px 0",color:"#e0e0e0",fontSize:"0.9rem",fontStyle:"italic",textAlign:"center"},children:"Players ranked below you who could challenge you in Phase 2"}),o&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#888",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"10px"},children:""}),"Loading potential challengers..."]}),l&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#e53e3e",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"10px"},children:""}),l]}),!o&&!l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"8px",padding:"15px",marginBottom:"20px",border:"1px solid rgba(255,255,255,0.1)",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#ffffff",fontSize:"1.1rem",fontWeight:"bold",marginBottom:"5px"},children:["Your Position: #",d]}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:g})]}),e.jsxs("div",{style:{marginBottom:"20px",flex:1},children:[e.jsxs("h3",{style:{color:"#ffffff",fontSize:"1.2rem",marginBottom:"15px",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:["Potential Challengers (",h.length,")"]}),h.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#888",fontStyle:"italic"},children:"No players ranked below you found in standings"}):e.jsx("div",{style:{display:"grid",gap:"10px"},children:h.map((f,m)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"8px",padding:"15px",border:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"background-color 0.2s ease"},onMouseEnter:v=>v.target.style.backgroundColor="rgba(255,255,255,0.1)",onMouseLeave:v=>v.target.style.backgroundColor="rgba(255,255,255,0.05)",children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"bold",marginBottom:"5px"},children:["#",d+m+1," - ",f.name||"Unknown Player"]}),f.record&&e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.85rem"},children:["Record: ",f.record]}),f.points&&e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.85rem"},children:["Points: ",f.points]})]}),e.jsx("div",{style:{color:"#ff4444",fontSize:"1.5rem",marginLeft:"15px"},children:""})]},m))})]}),e.jsx("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"8px",padding:"15px",border:"1px solid rgba(255,255,255,0.1)",marginBottom:"20px"},children:e.jsxs("div",{style:{color:"#ffffff",fontSize:"0.9rem",textAlign:"center",lineHeight:"1.4"},children:[e.jsx("strong",{children:"Phase 2 Defense Rules:"}),e.jsx("br",{})," Players ranked below you can challenge you",e.jsx("br",{})," You must accept at least 2 defense challenges",e.jsx("br",{})," These are the players who could challenge you"]})})]})]})]})}):null}const $$="_modalOverlay_8evb8_7",L$="_modalContentSnazzy_8evb8_33",B$="_modalBounceIn_8evb8_1",O$="_modalHeaderSnazzy_8evb8_69",z$="_modalAccentBar_8evb8_89",F$="_modalTitleSnazzy_8evb8_107",W$="_modalCloseBtnSnazzy_8evb8_131",U$="_modalDetailsSnazzy_8evb8_173",q$="_modalDetailRowSnazzy_8evb8_189",H$="_modalDetailIcon_8evb8_217",Y$="_modalDetailLabelSnazzy_8evb8_229",G$="_modalDetailValueSnazzy_8evb8_243",V$="_modalOpponentName_8evb8_263",K$="_modalVs_8evb8_277",J$="_gameTypeIcon_8evb8_293",X$="_markCompletedBtn_8evb8_365",Q$="_modalActionBtn_8evb8_397",lr={modalOverlay:$$,modalContentSnazzy:L$,modalBounceIn:B$,modalHeaderSnazzy:O$,modalAccentBar:z$,modalTitleSnazzy:F$,modalCloseBtnSnazzy:W$,modalDetailsSnazzy:U$,modalDetailRowSnazzy:q$,modalDetailIcon:H$,modalDetailLabelSnazzy:Y$,modalDetailValueSnazzy:G$,modalOpponentName:V$,modalVs:K$,gameTypeIcon:J$,markCompletedBtn:X$,modalActionBtn:Q$},Z$="modulepreload",eL=function(n){return"/"+n},gw={},_a=function(t,r,s){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=eL(o),o in gw)return;gw[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!s)for(let u=a.length-1;u>=0;u--){const h=a[u];if(h.href===o&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":Z$,i||(d.as="script",d.crossOrigin=""),d.href=o,document.head.appendChild(d),i)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function hf(n,t){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(r[s[a]]=n[s[a]]);return r}function tL(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})}const rL=n=>n?(...t)=>n(...t):(...t)=>fetch(...t);let jb=class extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}},nL=class extends jb{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},xw=class extends jb{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},yw=class extends jb{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}};var mx;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(mx||(mx={}));let sL=class{constructor(t,{headers:r={},customFetch:s,region:a=mx.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=rL(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return tL(this,arguments,void 0,function*(r,s={}){var a;let o,i;try{const{headers:l,method:c,body:d,signal:u,timeout:h}=s;let p={},{region:g}=s;g||(g=this.region);const f=new URL(`${this.url}/${r}`);g&&g!=="any"&&(p["x-region"]=g,f.searchParams.set("forceFunctionRegion",g));let m;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",m=d):typeof d=="string"?(p["Content-Type"]="text/plain",m=d):typeof FormData<"u"&&d instanceof FormData?m=d:(p["Content-Type"]="application/json",m=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?m=JSON.stringify(d):m=d;let v=u;h&&(i=new AbortController,o=setTimeout(()=>i.abort(),h),u?(v=i.signal,u.addEventListener("abort",()=>i.abort())):v=i.signal);const b=yield this.fetch(f.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:m,signal:v}).catch(S=>{throw new nL(S)}),w=b.headers.get("x-relay-error");if(w&&w==="true")throw new xw(b);if(!b.ok)throw new yw(b);let x=((a=b.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),j;return x==="application/json"?j=yield b.json():x==="application/octet-stream"||x==="application/pdf"?j=yield b.blob():x==="text/event-stream"?j=b:x==="multipart/form-data"?j=yield b.formData():j=yield b.text(),{data:j,error:null,response:b}}catch(l){return{data:null,error:l,response:l instanceof yw||l instanceof xw?l.context:void 0}}finally{o&&clearTimeout(o)}})}};var aL=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},oL=class{constructor(t){var r,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(s=t.isMaybeSingle)!==null&&s!==void 0?s:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let l=null,c=null,d=null,u=i.status,h=i.statusText;if(i.ok){var p,g;if(s.method!=="HEAD"){var f;const w=await i.text();w===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((f=s.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?c=w:c=JSON.parse(w))}const v=(p=s.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),b=(g=i.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");v&&b&&b.length>1&&(d=parseInt(b[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,u=406,h="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var m;const v=await i.text();try{l=JSON.parse(v),Array.isArray(l)&&i.status===404&&(c=[],l=null,u=200,h="OK")}catch{i.status===404&&v===""?(u=204,h="No Content"):l={message:v}}if(l&&s.isMaybeSingle&&(!(l==null||(m=l.details)===null||m===void 0)&&m.includes("0 rows"))&&(l=null,u=200,h="OK"),l&&s.shouldThrowOnError)throw new aL(l)}return{error:l,data:c,count:d,status:u,statusText:h}});return this.shouldThrowOnError||(o=o.catch(i=>{var l;let c="";const d=i==null?void 0:i.cause;if(d){var u,h,p,g;const m=(u=d==null?void 0:d.message)!==null&&u!==void 0?u:"",v=(h=d==null?void 0:d.code)!==null&&h!==void 0?h:"";c=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,c+=`

Caused by: ${(g=d==null?void 0:d.name)!==null&&g!==void 0?g:"Error"}: ${m}`,v&&(c+=` (${v})`),d!=null&&d.stack&&(c+=`
${d.stack}`)}else{var f;c=(f=i==null?void 0:i.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(t,r)}returns(){return this}overrideTypes(){return this}},iL=class extends oL{select(t){let r=!1;const s=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:s,foreignTable:a,referencedTable:o=a}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:s=!1,buffers:a=!1,wal:o=!1,format:i="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,s?"settings":null,a?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const bw=new RegExp("[,()]");var Sc=class extends iL{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}regexMatch(t,r){return this.url.searchParams.append(t,`match.${r}`),this}regexIMatch(t,r){return this.url.searchParams.append(t,`imatch.${r}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}isDistinct(t,r){return this.url.searchParams.append(t,`isdistinct.${r}`),this}in(t,r){const s=Array.from(new Set(r)).map(a=>typeof a=="string"&&bw.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}notIn(t,r){const s=Array.from(new Set(r)).map(a=>typeof a=="string"&&bw.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`not.in.(${s})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:s,type:a}={}){let o="";a==="plain"?o="pl":a==="phrase"?o="ph":a==="websearch"&&(o="w");const i=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${o}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(t,r,s){return this.url.searchParams.append(t,`not.${r}.${s}`),this}or(t,{foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,s){return this.url.searchParams.append(t,`${r}.${s}`),this}},lL=class{constructor(t,{headers:r={},schema:s,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=s,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,r){const{head:s=!1,count:a}=r??{},o=s?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(u=>/\s/.test(u)&&!i?"":(u==='"'&&(i=!i),u)).join(""),{url:c,headers:d}=this.cloneRequestState();return c.searchParams.set("select",l),a&&d.append("Prefer",`count=${a}`),new Sc({method:o,url:c,headers:d,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:s=!0}={}){var a;const o="POST",{url:i,headers:l}=this.cloneRequestState();if(r&&l.append("Prefer",`count=${r}`),s||l.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);i.searchParams.set("columns",d.join(","))}}return new Sc({method:o,url:i,headers:l,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:s=!1,count:a,defaultToNull:o=!0}={}){var i;const l="POST",{url:c,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),r!==void 0&&c.searchParams.set("on_conflict",r),a&&d.append("Prefer",`count=${a}`),o||d.append("Prefer","missing=default"),Array.isArray(t)){const u=t.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(u.length>0){const h=[...new Set(u)].map(p=>`"${p}"`);c.searchParams.set("columns",h.join(","))}}return new Sc({method:l,url:c,headers:d,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var s;const a="PATCH",{url:o,headers:i}=this.cloneRequestState();return r&&i.append("Prefer",`count=${r}`),new Sc({method:a,url:o,headers:i,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:t}={}){var r;const s="DELETE",{url:a,headers:o}=this.cloneRequestState();return t&&o.append("Prefer",`count=${t}`),new Sc({method:s,url:a,headers:o,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}},cL=class uk{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new lL(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new uk(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:o}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;const u=g=>g!==null&&typeof g=="object"&&(!Array.isArray(g)||g.some(u)),h=s&&Object.values(r).some(u);h?(l="POST",d=r):s||a?(l=s?"HEAD":"GET",Object.entries(r).filter(([g,f])=>f!==void 0).map(([g,f])=>[g,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([g,f])=>{c.searchParams.append(g,f)})):(l="POST",d=r);const p=new Headers(this.headers);return h?p.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&p.set("Prefer",`count=${o}`),new Sc({method:l,url:c,headers:p,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};let dL=class{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const a=s.node,o=parseInt(a.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}};const uL="2.90.1",hL=`realtime-js/${uL}`,hk="1.0.0",pL="2.0.0",vw=hk,fx=1e4,mL=1e3,fL=100;var mi;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(mi||(mi={}));var Hn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Hn||(Hn={}));var za;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(za||(za={}));var gx;(function(n){n.websocket="websocket"})(gx||(gx={}));var gl;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(gl||(gl={}));let gL=class{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},i=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,r,s){var a,o;const i=t.topic,l=(a=t.ref)!==null&&a!==void 0?a:"",c=(o=t.join_ref)!==null&&o!==void 0?o:"",d=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+d.length+h.length,g=new ArrayBuffer(this.HEADER_LENGTH+p);let f=new DataView(g),m=0;f.setUint8(m++,this.KINDS.userBroadcastPush),f.setUint8(m++,c.length),f.setUint8(m++,l.length),f.setUint8(m++,i.length),f.setUint8(m++,d.length),f.setUint8(m++,h.length),f.setUint8(m++,r),Array.from(c,b=>f.setUint8(m++,b.charCodeAt(0))),Array.from(l,b=>f.setUint8(m++,b.charCodeAt(0))),Array.from(i,b=>f.setUint8(m++,b.charCodeAt(0))),Array.from(d,b=>f.setUint8(m++,b.charCodeAt(0))),Array.from(h,b=>f.setUint8(m++,b.charCodeAt(0)));var v=new Uint8Array(g.byteLength+s.byteLength);return v.set(new Uint8Array(g),0),v.set(new Uint8Array(s),g.byteLength),v.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,o,i,l,c]=s;return r({join_ref:a,ref:o,topic:i,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),a=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,s){const a=r.getUint8(1),o=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const d=s.decode(t.slice(c,c+a));c=c+a;const u=s.decode(t.slice(c,c+o));c=c+o;const h=s.decode(t.slice(c,c+i));c=c+i;const p=t.slice(c,t.byteLength),g=l===this.JSON_ENCODING?JSON.parse(s.decode(p)):p,f={type:this.BROADCAST_EVENT,event:u,payload:g};return i>0&&(f.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:f}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}},pk=class{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Hr;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Hr||(Hr={}));const ww=(n,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((o,i)=>(o[i]=xL(i,n,t,a),o),{}):{}},xL=(n,t,r,s)=>{const a=t.find(l=>l.name===n),o=a==null?void 0:a.type,i=r[n];return o&&!s.includes(o)?mk(o,i):xx(i)},mk=(n,t)=>{if(n.charAt(0)==="_"){const r=n.slice(1,n.length);return wL(t,r)}switch(n){case Hr.bool:return yL(t);case Hr.float4:case Hr.float8:case Hr.int2:case Hr.int4:case Hr.int8:case Hr.numeric:case Hr.oid:return bL(t);case Hr.json:case Hr.jsonb:return vL(t);case Hr.timestamp:return jL(t);case Hr.abstime:case Hr.date:case Hr.daterange:case Hr.int4range:case Hr.int8range:case Hr.money:case Hr.reltime:case Hr.text:case Hr.time:case Hr.timestamptz:case Hr.timetz:case Hr.tsrange:case Hr.tstzrange:return xx(t);default:return xx(t)}},xx=n=>n,yL=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},bL=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},vL=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},wL=(n,t)=>{if(typeof n!="string")return n;const r=n.length-1,s=n[r];if(n[0]==="{"&&s==="}"){let o;const i=n.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>mk(t,l))}return n},jL=n=>typeof n=="string"?n.replace(" ","T"):n,fk=n=>{const t=new URL(n);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};let gg=class{constructor(t,r,s={},a=fx){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var jw;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(jw||(jw={}));let SL=class Rp{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rp.syncState(this.state,a,o,i),this.pendingDiffs.forEach(c=>{this.state=Rp.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Rp.syncDiff(this.state,a,o,i),l())}),this.onJoin((a,o,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:i})}),this.onLeave((a,o,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const o=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(o,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const h=o[d];if(h){const p=u.map(v=>v.presence_ref),g=h.map(v=>v.presence_ref),f=u.filter(v=>g.indexOf(v.presence_ref)<0),m=h.filter(v=>p.indexOf(v.presence_ref)<0);f.length>0&&(l[d]=f),m.length>0&&(c[d]=m)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:c},s,a)}static syncDiff(t,r,s,a){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(o,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const h=t[l].map(g=>g.presence_ref),p=u.filter(g=>h.indexOf(g.presence_ref)<0);t[l].unshift(...p)}s(l,u,c)}),this.map(i,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Sw;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Sw||(Sw={}));var bu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(bu||(bu={}));var Io;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Io||(Io={}));let _L=class ru{constructor(t,r={config:{}},s){var a,o;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Hn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new gg(this,za.join,this.params,this.timeout),this.rejoinTimer=new pk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Hn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Hn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(za.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new SL(this),this.broadcastEndpointURL=fk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Hn.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[bu.PRESENCE]&&this.bindings[bu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,h={},p={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>t==null?void 0:t(Io.CHANNEL_ERROR,g)),this._onClose(()=>t==null?void 0:t(Io.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var f;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){t==null||t(Io.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(f=m==null?void 0:m.length)!==null&&f!==void 0?f:0,b=[];for(let w=0;w<v;w++){const x=m[w],{filter:{event:j,schema:S,table:_,filter:C}}=x,N=g&&g[w];if(N&&N.event===j&&ru.isFilterValueEqual(N.schema,S)&&ru.isFilterValueEqual(N.table,_)&&ru.isFilterValueEqual(N.filter,C))b.push(Object.assign(Object.assign({},x),{id:N.id}));else{this.unsubscribe(),this.state=Hn.errored,t==null||t(Io.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(Io.SUBSCRIBED);return}}).receive("error",g=>{this.state=Hn.errored,t==null||t(Io.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Io.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Hn.joined&&t===bu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:i}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Hn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(za.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new gg(this,za.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Hn.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,o=setTimeout(()=>a.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(o),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new gg(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>fL){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,o;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=za;if(s&&[l,c,d,u].indexOf(i)>=0&&s!==this._joinRef())return;let p=this._onMessage(i,r,s);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(g=>{var f,m,v;return((f=g.filter)===null||f===void 0?void 0:f.event)==="*"||((v=(m=g.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(g=>g.callback(p,s)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var f,m,v,b,w,x,j,S;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const _=g.id,C=(f=g.filter)===null||f===void 0?void 0:f.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))&&(!(!((b=g.filter)===null||b===void 0)&&b.table)||g.filter.table===((w=r.data)===null||w===void 0?void 0:w.table))}else{const _=(j=(x=g==null?void 0:g.filter)===null||x===void 0?void 0:x.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return _==="*"||_===((S=r==null?void 0:r.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof p=="object"&&"ids"in p){const f=p.data,{schema:m,table:v,commit_timestamp:b,type:w,errors:x}=f;p=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:b,eventType:w,new:{},old:{},errors:x}),this._getPayloadRecords(f))}g.callback(p,s)})}_isClosed(){return this.state===Hn.closed}_isJoined(){return this.state===Hn.joined}_isJoining(){return this.state===Hn.joining}_isLeaving(){return this.state===Hn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),o={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&ru.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(za.close,{},t)}_onError(t){this._on(za.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ww(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ww(t.columns,t.old_record)),r}};const xg=()=>{},Kh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},kL=[1e3,2e3,5e3,1e4],CL=1e4,NL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let TL=class{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fx,this.transport=null,this.heartbeatIntervalMs=Kh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=xg,this.ref=0,this.reconnectTimer=null,this.vsn=vw,this.logger=xg,this.conn=null,this.sendBuffer=[],this.serializer=new gL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...o)=>a(...o):(...o)=>fetch(...o),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${gx.websocket}`,this.httpEndpoint=fk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=dL.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case mi.connecting:return gl.Connecting;case mi.open:return gl.Open;case mi.closing:return gl.Closing;default:return gl.Closed}}isConnected(){return this.connectionState()===gl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(o=>o.topic===s);if(a)return a;{const o=new _L(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:s,payload:a,ref:o}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${o})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(mL,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Kh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",d)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:a,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${s} ${a} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(a,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===mi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===mi.open||this.conn.readyState===mi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(za.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([NL],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const o={access_token:r,version:hL};r&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(za.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new pk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Kh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,o,i,l,c,d,u,h,p,g;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:fx,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Kh.HEARTBEAT_INTERVAL,this.worker=(o=t==null?void 0:t.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:xg,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:vw,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t==null?void 0:t.reconnectAfterMs)!==null&&d!==void 0?d:f=>kL[f-1]||CL,this.vsn){case hk:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(f,m)=>m(JSON.stringify(f)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(f,m)=>m(JSON.parse(f));break;case pL:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(g=t==null?void 0:t.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}};var eh=class extends Error{constructor(n,t){var r;super(n),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function PL(n,t,r){const s=new URL(t,n);if(r)for(const[a,o]of Object.entries(r))o!==void 0&&s.searchParams.set(a,o);return s.toString()}async function EL(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function RL(n){const t=n.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:o,headers:i}){const l=PL(n.baseUrl,s,a),c=await EL(n.auth),d=await t(l,{method:r,headers:{...o?{"Content-Type":"application/json"}:{},...c,...i},body:o?JSON.stringify(o):void 0}),u=await d.text(),h=(d.headers.get("content-type")||"").includes("application/json"),p=h&&u?JSON.parse(u):u;if(!d.ok){const g=h?p:void 0,f=g==null?void 0:g.error;throw new eh((f==null?void 0:f.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:f==null?void 0:f.type,icebergCode:f==null?void 0:f.code,details:g})}return{status:d.status,headers:d.headers,data:p}}}}function Jh(n){return n.join("")}var AL=class{constructor(n,t=""){this.client=n,this.prefix=t}async listNamespaces(n){const t=n?{parent:Jh(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(n,t){const r={namespace:n.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Jh(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Jh(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Jh(n.namespace)}`}),!0}catch(t){if(t instanceof eh&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(n,t){try{return await this.createNamespace(n,t)}catch(r){if(r instanceof eh&&r.status===409)return;throw r}}};function ic(n){return n.join("")}var ML=class{constructor(n,t="",r){this.client=n,this.prefix=t,this.accessDelegation=r}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables`})).data.identifiers}async createTable(n,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(n,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables/${n.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(n,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(n){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables/${n.name}`,headers:t})).data.metadata}async tableExists(n){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ic(n.namespace)}/tables/${n.name}`,headers:t}),!0}catch(r){if(r instanceof eh&&r.status===404)return!1;throw r}}async createTableIfNotExists(n,t){try{return await this.createTable(n,t)}catch(r){if(r instanceof eh&&r.status===409)return await this.loadTable({namespace:n.namespace,name:t.name});throw r}}},IL=class{constructor(n){var s;let t="v1";n.catalogName&&(t+=`/${n.catalogName}`);const r=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=RL({baseUrl:r,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(s=n.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new AL(this.client,t),this.tableOps=new ML(this.client,t,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,t){return this.namespaceOps.createNamespace(n,t)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,t){return this.tableOps.createTable(n,t)}async updateTable(n,t){return this.tableOps.updateTable(n,t)}async dropTable(n,t){await this.tableOps.dropTable(n,t)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,t){return this.namespaceOps.createNamespaceIfNotExists(n,t)}async createTableIfNotExists(n,t){return this.tableOps.createTableIfNotExists(n,t)}},pf=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function pn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var DL=class extends pf{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},yx=class extends pf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}};const Sb=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),$L=()=>Response,bx=n=>{if(Array.isArray(n))return n.map(r=>bx(r));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[a]=bx(s)}),t},LL=n=>{if(typeof n!="object"||n===null)return!1;const t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},BL=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function th(n){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(n)}function OL(n,t){if(th(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(th(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function zL(n){var t=OL(n,"string");return th(t)=="symbol"?t:t+""}function FL(n,t,r){return(t=zL(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _w(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function er(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_w(Object(r),!0).forEach(function(s){FL(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):_w(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}const yg=n=>{var t;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(t=n.error)===null||t===void 0?void 0:t.message)||JSON.stringify(n)},WL=async(n,t,r)=>{n instanceof await $L()&&!(r!=null&&r.noResolveJson)?n.json().then(s=>{const a=n.status||500,o=(s==null?void 0:s.statusCode)||a+"";t(new DL(yg(s),a,o))}).catch(s=>{t(new yx(yg(s),s))}):t(new yx(yg(n),n))},UL=(n,t,r,s)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"||!s?a:(LL(s)?(a.headers=er({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,t!=null&&t.duplex&&(a.duplex=t.duplex),er(er({},a),r))};async function Sh(n,t,r,s,a,o){return new Promise((i,l)=>{n(r,UL(t,s,a,o)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>WL(c,l,s))})}async function rh(n,t,r,s){return Sh(n,"GET",t,r,s)}async function Ba(n,t,r,s,a){return Sh(n,"POST",t,s,a,r)}async function vx(n,t,r,s,a){return Sh(n,"PUT",t,s,a,r)}async function qL(n,t,r,s){return Sh(n,"HEAD",t,er(er({},r),{},{noResolveJson:!0}),s)}async function _b(n,t,r,s,a){return Sh(n,"DELETE",t,s,a,r)}var HL=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}}};let gk;gk=Symbol.toStringTag;var YL=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[gk]="BlobDownloadBuilder",this.promise=null}asStream(){return new HL(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}}};const GL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var VL=class{constructor(t,r={},s,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=Sb(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,r,s,a){var o=this;try{let i;const l=er(er({},kw),a);let c=er(er({},o.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",o.encodeMetadata(d)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.has("cacheControl")||i.append("cacheControl",l.cacheControl),d&&!i.has("metadata")&&i.append("metadata",o.encodeMetadata(d))):(i=s,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=o.toBase64(o.encodeMetadata(d))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!l.duplex&&(l.duplex="half")),a!=null&&a.headers&&(c=er(er({},c),a.headers));const u=o._removeEmptyFolders(r),h=o._getFinalPath(u),p=await(t=="PUT"?vx:Ba)(o.fetch,`${o.url}/object/${h}`,i,er({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:u,id:p.Id,fullPath:p.Key},error:null}}catch(i){if(o.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}}async upload(t,r,s){return this.uploadOrUpdate("POST",t,r,s)}async uploadToSignedUrl(t,r,s,a){var o=this;const i=o._removeEmptyFolders(t),l=o._getFinalPath(i),c=new URL(o.url+`/object/upload/sign/${l}`);c.searchParams.set("token",r);try{let d;const u=er({upsert:kw.upsert},a),h=er(er({},o.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",u.cacheControl)):(d=s,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType),{data:{path:i,fullPath:(await vx(o.fetch,c.toString(),d,{headers:h})).Key},error:null}}catch(d){if(o.shouldThrowOnError)throw d;if(pn(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(t,r){var s=this;try{let a=s._getFinalPath(t);const o=er({},s.headers);r!=null&&r.upsert&&(o["x-upsert"]="true");const i=await Ba(s.fetch,`${s.url}/object/upload/sign/${a}`,{},{headers:o}),l=new URL(s.url+i.url),c=l.searchParams.get("token");if(!c)throw new pf("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:c},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(pn(a))return{data:null,error:a};throw a}}async update(t,r,s){return this.uploadOrUpdate("PUT",t,r,s)}async move(t,r,s){var a=this;try{return{data:await Ba(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:a.headers}),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(pn(o))return{data:null,error:o};throw o}}async copy(t,r,s){var a=this;try{return{data:{path:(await Ba(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:a.headers})).Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(pn(o))return{data:null,error:o};throw o}}async createSignedUrl(t,r,s){var a=this;try{let o=a._getFinalPath(t),i=await Ba(a.fetch,`${a.url}/object/sign/${o}`,er({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:a.headers});const l=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${a.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(pn(o))return{data:null,error:o};throw o}}async createSignedUrls(t,r,s){var a=this;try{const o=await Ba(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:r,paths:t},{headers:a.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:o.map(l=>er(er({},l),{},{signedUrl:l.signedURL?encodeURI(`${a.url}${l.signedURL}${i}`):null})),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(pn(o))return{data:null,error:o};throw o}}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"",i=this._getFinalPath(t),l=()=>rh(this.fetch,`${this.url}/${s}/${i}${o}`,{headers:this.headers,noResolveJson:!0});return new YL(l,this.shouldThrowOnError)}async info(t){var r=this;const s=r._getFinalPath(t);try{return{data:bx(await rh(r.fetch,`${r.url}/object/info/${s}`,{headers:r.headers})),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(pn(a))return{data:null,error:a};throw a}}async exists(t){var r=this;const s=r._getFinalPath(t);try{return await qL(r.fetch,`${r.url}/object/${s}`,{headers:r.headers}),{data:!0,error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(pn(a)&&a instanceof yx){const o=a.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:a}}throw a}}getPublicUrl(t,r){const s=this._getFinalPath(t),a=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&a.push(o);const i=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${c}`)}}}async remove(t){var r=this;try{return{data:await _b(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}}async list(t,r,s){var a=this;try{const o=er(er(er({},GL),r),{},{prefix:t||""});return{data:await Ba(a.fetch,`${a.url}/object/list/${a.bucketId}`,o,{headers:a.headers},s),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(pn(o))return{data:null,error:o};throw o}}async listV2(t,r){var s=this;try{const a=er({},t);return{data:await Ba(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(pn(a))return{data:null,error:a};throw a}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}};const xk="2.90.1",yk={"X-Client-Info":`storage-js/${xk}`};var KL=class{constructor(t,r={},s,a){this.shouldThrowOnError=!1;const o=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=er(er({},yk),r),this.fetch=Sb(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var r=this;try{const s=r.listBucketOptionsToQueryString(t);return{data:await rh(r.fetch,`${r.url}/bucket${s}`,{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}}async getBucket(t){var r=this;try{return{data:await rh(r.fetch,`${r.url}/bucket/${t}`,{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}}async createBucket(t,r={public:!1}){var s=this;try{return{data:await Ba(s.fetch,`${s.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(pn(a))return{data:null,error:a};throw a}}async updateBucket(t,r){var s=this;try{return{data:await vx(s.fetch,`${s.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(pn(a))return{data:null,error:a};throw a}}async emptyBucket(t){var r=this;try{return{data:await Ba(r.fetch,`${r.url}/bucket/${t}/empty`,{},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}}async deleteBucket(t){var r=this;try{return{data:await _b(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},JL=class{constructor(n,t={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=er(er({},yk),t),this.fetch=Sb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var t=this;try{return{data:await Ba(t.fetch,`${t.url}/bucket`,{name:n},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}}async listBuckets(n){var t=this;try{const r=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&r.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&r.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&r.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&r.set("sortOrder",n.sortOrder),n!=null&&n.search&&r.set("search",n.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await rh(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}}async deleteBucket(n){var t=this;try{return{data:await _b(t.fetch,`${t.url}/bucket/${n}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}}from(n){var t=this;if(!BL(n))throw new pf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new IL({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(a,o){const i=a[o];return typeof i!="function"?i:async(...l)=>{try{return{data:await i.apply(a,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}};const kb={"X-Client-Info":`storage-js/${xk}`,"Content-Type":"application/json"};var bk=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function na(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var bg=class extends bk{constructor(n,t,r){super(n),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},XL=class extends bk{constructor(n,t){super(n),this.name="StorageVectorsUnknownError",this.originalError=t}};const Cb=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),QL=n=>{if(typeof n!="object"||n===null)return!1;const t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Cw=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ZL=async(n,t,r)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(r!=null&&r.noResolveJson)){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const i=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";t(new bg(Cw(o),s,i))}).catch(()=>{const o=s+"";t(new bg(a.statusText||`HTTP ${s} error`,s,o))});else{const o=s+"";t(new bg(a.statusText||`HTTP ${s} error`,s,o))}}else t(new XL(Cw(n),n))},eB=(n,t,r,s)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"||!s?a:(QL(s)?(a.headers=er({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,er(er({},a),r))};async function tB(n,t,r,s,a,o){return new Promise((i,l)=>{n(r,eB(t,s,a,o)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>ZL(c,l,s))})}async function sa(n,t,r,s,a){return tB(n,"POST",t,s,a,r)}var rB=class{constructor(n,t={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=er(er({},kb),t),this.fetch=Cb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/CreateIndex`,n,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async getIndex(n,t){var r=this;try{return{data:await sa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:n,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(na(s))return{data:null,error:s};throw s}}async listIndexes(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/ListIndexes`,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async deleteIndex(n,t){var r=this;try{return{data:await sa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:n,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(na(s))return{data:null,error:s};throw s}}},nB=class{constructor(n,t={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=er(er({},kb),t),this.fetch=Cb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var t=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await sa(t.fetch,`${t.url}/PutVectors`,n,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async getVectors(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/GetVectors`,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async listVectors(n){var t=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await sa(t.fetch,`${t.url}/ListVectors`,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async queryVectors(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/QueryVectors`,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async deleteVectors(n){var t=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await sa(t.fetch,`${t.url}/DeleteVectors`,n,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}},sB=class{constructor(n,t={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=er(er({},kb),t),this.fetch=Cb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async getBucket(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:n},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async listBuckets(n={}){var t=this;try{return{data:await sa(t.fetch,`${t.url}/ListVectorBuckets`,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}async deleteBucket(n){var t=this;try{return{data:await sa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(na(r))return{data:null,error:r};throw r}}},aB=class extends sB{constructor(n,t={}){super(n,t.headers||{},t.fetch)}from(n){return new oB(this.url,this.headers,n,this.fetch)}async createBucket(n){var t=()=>super.createBucket,r=this;return t().call(r,n)}async getBucket(n){var t=()=>super.getBucket,r=this;return t().call(r,n)}async listBuckets(n={}){var t=()=>super.listBuckets,r=this;return t().call(r,n)}async deleteBucket(n){var t=()=>super.deleteBucket,r=this;return t().call(r,n)}},oB=class extends rB{constructor(n,t,r,s){super(n,t,s),this.vectorBucketName=r}async createIndex(n){var t=()=>super.createIndex,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(n={}){var t=()=>super.listIndexes,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(n){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,n)}async deleteIndex(n){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,n)}index(n){return new iB(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},iB=class extends nB{constructor(n,t,r,s,a){super(n,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(n){var t=()=>super.putVectors,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(n){var t=()=>super.getVectors,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(n={}){var t=()=>super.listVectors,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(n){var t=()=>super.queryVectors,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(n){var t=()=>super.deleteVectors,r=this;return t().call(r,er(er({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},lB=class extends KL{constructor(t,r={},s,a){super(t,r,s,a)}from(t){return new VL(this.url,this.headers,t,this.fetch)}get vectors(){return new aB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new JL(this.url+"/iceberg",this.headers,this.fetch)}};const vk="2.90.1",_c=30*1e3,wx=3,vg=wx*_c,cB="http://localhost:9999",dB="supabase.auth.token",uB={"X-Client-Info":`gotrue-js/${vk}`},jx="X-Supabase-Api-Version",wk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},hB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,pB=10*60*1e3;let nh=class extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}};function Ut(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}let mB=class extends nh{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}};function fB(n){return Ut(n)&&n.name==="AuthApiError"}let xl=class extends nh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}},Qo=class extends nh{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}},Zs=class extends Qo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function gB(n){return Ut(n)&&n.name==="AuthSessionMissingError"}let lc=class extends Qo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Xh=class extends Qo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},Qh=class extends Qo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function xB(n){return Ut(n)&&n.name==="AuthImplicitGrantRedirectError"}let Nw=class extends Qo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};class yB extends Qo{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}let Sx=class extends Qo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}};function wg(n){return Ut(n)&&n.name==="AuthRetryableFetchError"}let Tw=class extends Qo{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}},_x=class extends Qo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};const Sm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pw=` 	
\r=`.split(""),bB=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<Pw.length;t+=1)n[Pw[t].charCodeAt(0)]=-2;for(let t=0;t<Sm.length;t+=1)n[Sm[t].charCodeAt(0)]=t;return n})();function Ew(n,t,r){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Sm[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Sm[s]),t.queuedBits-=6}}function jk(n,t,r){const s=bB[n];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Rw(n){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=i=>{jB(i,s,r)};for(let i=0;i<n.length;i+=1)jk(n.charCodeAt(i),a,o);return t.join("")}function vB(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function wB(n,t){for(let r=0;r<n.length;r+=1){let s=n.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(n.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}vB(s,t)}}function jB(n,t,r){if(t.utf8seq===0){if(n<=127){r(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Jc(n){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<n.length;a+=1)jk(n.charCodeAt(a),r,s);return new Uint8Array(t)}function SB(n){const t=[];return wB(n,r=>t.push(r)),new Uint8Array(t)}function _l(n){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return n.forEach(a=>Ew(a,r,s)),Ew(null,r,s),t.join("")}function _B(n){return Math.round(Date.now()/1e3)+n}function kB(){return Symbol("auth-callback")}const os=()=>typeof window<"u"&&typeof document<"u",tl={tested:!1,writable:!1},Sk=()=>{if(!os())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(tl.tested)return tl.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),tl.tested=!0,tl.writable=!0}catch{tl.tested=!0,tl.writable=!1}return tl.writable};function CB(n){const t={},r=new URL(n);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,o)=>{t[o]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const _k=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),NB=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",kc=async(n,t,r)=>{await n.setItem(t,JSON.stringify(r))},rl=async(n,t)=>{const r=await n.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ss=async(n,t)=>{await n.removeItem(t)};let kk=class Ck{constructor(){this.promise=new Ck.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}};kk.promiseConstructor=Promise;function jg(n){const t=n.split(".");if(t.length!==3)throw new _x("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!hB.test(t[s]))throw new _x("JWT not in base64url format");return{header:JSON.parse(Rw(t[0])),payload:JSON.parse(Rw(t[1])),signature:Jc(t[2]),raw:{header:t[0],payload:t[1]}}}async function TB(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function PB(n,t){return new Promise((s,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await n(o);if(!t(o,null,i)){s(i);return}}catch(i){if(!t(o,i)){a(i);return}}})()})}function EB(n){return("0"+n.toString(16)).substr(-2)}function RB(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let o=0;o<56;o++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,EB).join("")}async function AB(n){const r=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function MB(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const r=await AB(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function cc(n,t,r=!1){const s=RB();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await kc(n,`${t}-code-verifier`,a);const o=await MB(s);return[o,s===o?"plain":"s256"]}const IB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function DB(n){const t=n.headers.get(jx);if(!t||!t.match(IB))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function $B(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function LB(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const BB=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function dc(n){if(!BB.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sg(){const n={};return new Proxy(n,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function OB(n,t){return new Proxy(n,{get:(r,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,a)}})}function Aw(n){return JSON.parse(JSON.stringify(n))}const ul=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),zB=[502,503,504];async function Mw(n){var t;if(!NB(n))throw new Sx(ul(n),0);if(zB.includes(n.status))throw new Sx(ul(n),n.status);let r;try{r=await n.json()}catch(o){throw new xl(ul(o),o)}let s;const a=DB(n);if(a&&a.getTime()>=wk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Tw(ul(r),n.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Zs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new Tw(ul(r),n.status,r.weak_password.reasons);throw new mB(ul(r),n.status||500,s)}const FB=(n,t,r,s)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Zt(n,t,r,s){var a;const o=Object.assign({},s==null?void 0:s.headers);o[jx]||(o[jx]=wk["2024-01-01"].name),s!=null&&s.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const i=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await WB(n,t,r+l,{headers:o,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function WB(n,t,r,s,a,o){const i=FB(t,s,a,o);let l;try{l=await n(r,Object.assign({},i))}catch(c){throw console.error(c),new Sx(ul(c),0)}if(l.ok||await Mw(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Mw(c)}}function Da(n){var t;let r=null;HB(n)&&(r=Object.assign({},n),n.expires_at||(r.expires_at=_B(n.expires_in)));const s=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:r,user:s},error:null}}function Iw(n){const t=Da(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=n.weak_password),t}function yi(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function UB(n){return{data:n,error:null}}function qB(n){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o}=n,i=hf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function Dw(n){return n}function HB(n){return n.access_token&&n.refresh_token&&n.expires_in}const _g=["global","local","others"];let YB=class{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=_k(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=_g[0]){if(_g.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${_g.join(", ")}`);try{return await Zt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ut(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Zt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:yi})}catch(s){if(Ut(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=hf(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Zt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:qB,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ut(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Zt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:yi})}catch(r){if(Ut(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Zt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Dw});if(u.error)throw u.error;const h=await u.json(),p=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);d[`${v}Page`]=m}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Ut(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){dc(t);try{return await Zt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:yi})}catch(r){if(Ut(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){dc(t);try{return await Zt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:yi})}catch(s){if(Ut(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){dc(t);try{return await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:yi})}catch(s){if(Ut(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){dc(t.userId);try{const{data:r,error:s}=await Zt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(Ut(r))return{data:null,error:r};throw r}}async _deleteFactor(t){dc(t.userId),dc(t.id);try{return{data:await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Zt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Dw});if(u.error)throw u.error;const h=await u.json(),p=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);d[`${v}Page`]=m}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Ut(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await Zt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ut(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Zt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ut(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Zt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ut(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Zt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ut(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Zt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ut(r))return{data:null,error:r};throw r}}};function $w(n={}){return{getItem:t=>n[t]||null,setItem:(t,r)=>{n[t]=r},removeItem:t=>{delete n[t]}}}const uc={debug:!!(globalThis&&Sk()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};let Nk=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},GB=class extends Nk{};async function VB(n,t,r){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),uc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await r()}finally{uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(t===0)throw uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new GB(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(uc.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function KB(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Tk(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function JB(n){return parseInt(n,16)}function XB(n){const t=new TextEncoder().encode(n);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function QB(n){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:o=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:h,version:p}=n;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=n.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const g=Tk(n.address),f=u?`${u}://${s}`:s,m=n.statement?`${n.statement}
`:"",v=`${f} wants you to sign in with your Ethereum account:
${g}

${m}`;let b=`URI: ${h}
Version: ${p}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(a&&(b+=`
Expiration Time: ${a.toISOString()}`),l&&(b+=`
Not Before: ${l.toISOString()}`),c&&(b+=`
Request ID: ${c}`),d){let w=`
Resources:`;for(const x of d){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);w+=`
- ${x}`}b+=w}return`${v}
${b}`}let Dn=class extends Error{constructor({message:t,code:r,cause:s,name:a}){var o;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=a??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}},_m=class extends Dn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}};function ZB({error:n,options:t}){var r,s,a;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Dn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(t.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Dn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Dn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Dn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Dn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Dn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Dn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(Pk(i)){if(o.rp.id!==i)return new Dn({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Dn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Dn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Dn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Dn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function eO({error:n,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Dn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const s=window.location.hostname;if(Pk(s)){if(r.rpId!==s)return new Dn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Dn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Dn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Dn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}let tO=class{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}};const rO=new tO;function nO(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:t,user:r,excludeCredentials:s}=n,a=hf(n,["challenge","user","excludeCredentials"]),o=Jc(t).buffer,i=Object.assign(Object.assign({},r),{id:Jc(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:o,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Jc(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function sO(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:t,allowCredentials:r}=n,s=hf(n,["challenge","allowCredentials"]),a=Jc(t).buffer,o=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Jc(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function aO(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n;return{id:n.id,rawId:n.id,response:{attestationObject:_l(new Uint8Array(n.response.attestationObject)),clientDataJSON:_l(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function oO(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n,s=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:_l(new Uint8Array(a.authenticatorData)),clientDataJSON:_l(new Uint8Array(a.clientDataJSON)),signature:_l(new Uint8Array(a.signature)),userHandle:a.userHandle?_l(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Pk(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Lw(){var n,t;return!!(os()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function iO(n){try{const t=await navigator.credentials.create(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new _m("Browser returned unexpected credential type",t)}:{data:null,error:new _m("Empty credential response",t)}}catch(t){return{data:null,error:ZB({error:t,options:n})}}}async function lO(n){try{const t=await navigator.credentials.get(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new _m("Browser returned unexpected credential type",t)}:{data:null,error:new _m("Empty credential response",t)}}catch(t){return{data:null,error:eO({error:t,options:n})}}}const cO={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},dO={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function km(...n){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of n)if(a)for(const o in a){const i=a[o];if(i!==void 0)if(Array.isArray(i))s[o]=i;else if(r(i))s[o]=i;else if(t(i)){const l=s[o];t(l)?s[o]=km(l,i):s[o]=km(i)}else s[o]=i}return s}function uO(n,t){return km(cO,n,t||{})}function hO(n,t){return km(dO,n,t||{})}let pO=class{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},o){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=a??rO.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=uO(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:h}=await iO({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=hO(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:h}=await lO(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return Ut(i)?{data:null,error:i}:{data:null,error:new xl("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new nh("rpId is required for WebAuthn authentication")};try{if(!Lw())return{data:null,error:new xl("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:o});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Ut(i)?{data:null,error:i}:{data:null,error:new xl("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new nh("rpId is required for WebAuthn registration")};try{if(!Lw())return{data:null,error:new xl("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return Ut(i)?{data:null,error:i}:{data:null,error:new xl("Unexpected error in register",i)}}}};KB();const mO={url:cB,storageKey:dB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:uB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Bw(n,t,r){return await r()}const hc={};let Ek=class kx{get jwks(){var t,r;return(r=(t=hc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){hc[this.storageKey]=Object.assign(Object.assign({},hc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=hc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){hc[this.storageKey]=Object.assign(Object.assign({},hc[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},mO),t);if(this.storageKey=o.storageKey,this.instanceID=(r=kx.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,kx.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&os()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new YB({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=_k(o.fetch),this.lock=o.lock||Bw,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&os()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=VB:this.lock=Bw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new pO(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Sk()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$w(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=$w(this.memoryStorage)),os()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${vk}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(os()&&(r=CB(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),os()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),xB(o)){const c=(t=o.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:i,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ut(r)?this._returnResult({error:r}):this._returnResult({error:new xl("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const o=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Da}),{data:i,error:l}=o;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(t){var r,s,a;try{let o;if("email"in t){const{email:u,password:h,options:p}=t;let g=null,f=null;this.flowType==="pkce"&&([g,f]=await cc(this.storage,this.storageKey)),o=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:f},xform:Da})}else if("phone"in t){const{phone:u,password:h,options:p}=t;o=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Da})}else throw new Xh("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return await ss(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:i,options:l}=t;r=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Iw})}else if("phone"in t){const{phone:o,password:i,options:l}=t;r=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Iw})}else throw new Xh("You must provide either an email or phone number and a password");const{data:s,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const o=new lc;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,a,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,o,i,l,c,d,u,h,p;let g,f;if("message"in t)g=t.message,f=t.signature;else{const{chain:m,wallet:v,statement:b,options:w}=t;let x;if(os())if(typeof v=="object")x=v;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")x=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=v}const j=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),S=await x.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=Tk(S[0]);let C=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!C){const M=await x.request({method:"eth_chainId"});C=JB(M)}const N={domain:j.host,address:_,statement:b,uri:j.href,version:"1",chainId:C,nonce:(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.resources};g=QB(N),f=await x.request({method:"personal_sign",params:[XB(g),_]})}try{const{data:m,error:v}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:f},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Da});if(v)throw v;if(!m||!m.session||!m.user){const b=new lc;return this._returnResult({data:{user:null,session:null},error:b})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(Ut(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,s,a,o,i,l,c,d,u,h,p,g;let f,m;if("message"in t)f=t.message,m=t.signature;else{const{chain:v,wallet:b,statement:w,options:x}=t;let j;if(os())if(typeof b=="object")j=b;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))j=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=b}const S=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const _=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let C;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")C=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)C=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)f=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${S.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(s=x==null?void 0:x.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x==null?void 0:x.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const _=await j.signMessage(new TextEncoder().encode(f),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=_}}try{const{data:v,error:b}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:_l(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Da});if(b)throw b;if(!v||!v.session||!v.user){const w=new lc;return this._returnResult({data:{user:null,session:null},error:w})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:b})}catch(v){if(Ut(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await rl(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new yB;const{data:o,error:i}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Da});if(await ss(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!o||!o.session||!o.user){const l=new lc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:i})}catch(o){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:o,nonce:i}=t,l=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Da}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new lc;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,a,o,i;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await cc(this.storage,this.storageKey));const{error:h}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new Xh("You must provide either an email or phone number.")}catch(l){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,s;try{let a,o;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await Zt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:Da});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(Ut(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,s,a,o,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await cc(this.storage,this.storageKey));const d=await Zt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:UB});return!((o=d.data)===null||o===void 0)&&o.url&&os()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Zs;const{error:a}=await Zt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Ut(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:o}=t,{error:i}=await Zt(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:s,type:a,options:o}=t,{data:i,error:l}=await Zt(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new Xh("You must provide either an email or phone number and a type")}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await rl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<vg:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await rl(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Sg()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=OB(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:yi}):await this._useSession(async r=>{var s,a,o;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Zs}:await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:yi})})}catch(r){if(Ut(r))return gB(r)&&(await this._removeSession(),await ss(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:o}=s;if(o)throw o;if(!a.session)throw new Zs;const i=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await cc(this.storage,this.storageKey));const{data:d,error:u}=await Zt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:yi});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Zs;const r=Date.now()/1e3;let s=r,a=!0,o=null;const{payload:i}=jg(t.access_token);if(i.exp&&(s=i.exp,a=s<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(Ut(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new Zs;const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!os())throw new Qh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Qh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Nw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Nw("No code detected.");const{data:w,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=t;if(!o||!l||!i||!d)throw new Qh("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let p=u+h;c&&(p=parseInt(c));const g=p-u;g*1e3<=_c&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const f=p-h;u-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,p,u):u-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,p,u);const{data:m,error:v}=await this._getUser(o);if(v)throw v;const b={provider_token:s,provider_refresh_token:a,access_token:o,expires_in:h,expires_at:p,refresh_token:i,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:t.type},error:null})}catch(s){if(Ut(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await rl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({error:o});const i=(s=a.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(fB(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await ss(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=kB(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:o},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await cc(this.storage,this.storageKey,!0));try{return await Zt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async o=>{var i,l,c,d,u;const{data:h,error:p}=o;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Zt(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return os()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Ut(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:o}}=r;if(a)throw a;const{options:i,provider:l,token:c,access_token:d,nonce:u}=t,h=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o==null?void 0:o.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Da}),{data:p,error:g}=h;return g?this._returnResult({data:{user:null,session:null},error:g}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new lc}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:g}))}catch(a){if(await ss(this.storage,`${this.storageKey}-code-verifier`),Ut(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:i}=r;if(i)throw i;return await Zt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await PB(async a=>(a>0&&await TB(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Zt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Da})),(a,o)=>{const i=200*Math.pow(2,a);return o&&wg(o)&&Date.now()+i-s<_c})}catch(s){if(this._debug(r,"error",s),Ut(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),os()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await rl(this.storage,this.storageKey);if(a&&this.userStorage){let i=await rl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await kc(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Sg()}else if(a&&!a.user&&!a.user){const i=await rl(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await ss(this.storage,this.storageKey+"-user"),await kc(this.storage,this.storageKey,a)):a.user=Sg()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const o=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<vg;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${vg}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),wg(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(a.access_token);!l&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Zs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new kk;const{data:o,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!o.session)throw new Zs;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(a,"error",o),Ut(o)){const i={data:null,error:o};return wg(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ss(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await kc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const o=Aw(a);await kc(this.storage,this.storageKey,o)}else{const a=Aw(r);await kc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ss(this.storage,this.storageKey),await ss(this.storage,this.storageKey+"-code-verifier"),await ss(this.storage,this.storageKey+"-user"),this.userStorage&&await ss(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&os()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),_c);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/_c);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${_c}ms, refresh threshold is ${wx} ticks`),a<=wx&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Nk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!os()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,i]=await cc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const o=new URLSearchParams(s.queryParams);a.push(o.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;return o?this._returnResult({data:null,error:o}):await Zt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await Zt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?aO(t.webauthn.credential_response):oO(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await Zt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=await Zt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:nO(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:sO(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=jg(s.access_token);let i=null;o.aal&&(i=o.aal);let l=i;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=o.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?await Zt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Zs})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new Zs});const i=await Zt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&os()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Ut(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new Zs});const i=await Zt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&os()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(Ut(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Zt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Zs})})}catch(t){if(Ut(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?(await Zt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Zs})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+pB>a)return s;const{data:o,error:i}=await Zt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,s=o.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:g,error:f}=await this.getSession();if(f||!g.session)return this._returnResult({data:null,error:f});s=g.session.access_token}const{header:a,payload:o,signature:i,raw:{header:l,payload:c}}=jg(s);r!=null&&r.allowExpired||$B(o.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:o,header:a,signature:i},error:null}}const u=LB(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,SB(`${l}.${c}`)))throw new _x("Invalid JWT signature");return{data:{claims:o,header:a,signature:i},error:null}}catch(s){if(Ut(s))return this._returnResult({data:null,error:s});throw s}}};Ek.nextInstanceID={};const fO=Ek,gO="2.90.1";let nu="";typeof Deno<"u"?nu="deno":typeof document<"u"?nu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nu="react-native":nu="node";const xO={"X-Client-Info":`supabase-js-${nu}/${gO}`},yO={headers:xO},bO={schema:"public"},vO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wO={};function sh(n){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(n)}function jO(n,t){if(sh(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(sh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function SO(n){var t=jO(n,"string");return sh(t)=="symbol"?t:t+""}function _O(n,t,r){return(t=SO(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function Ow(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function jn(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ow(Object(r),!0).forEach(function(s){_O(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Ow(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}const kO=n=>n?(...t)=>n(...t):(...t)=>fetch(...t),CO=()=>Headers,NO=(n,t,r)=>{const s=kO(r),a=CO();return async(o,i)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:n;let d=new a(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(o,jn(jn({},i),{},{headers:d}))}};function TO(n){return n.endsWith("/")?n:n+"/"}function PO(n,t){var r,s;const{db:a,auth:o,realtime:i,global:l}=n,{db:c,auth:d,realtime:u,global:h}=t,p={db:jn(jn({},c),a),auth:jn(jn({},d),o),realtime:jn(jn({},u),i),storage:{},global:jn(jn(jn({},h),l),{},{headers:jn(jn({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}function EO(n){const t=n==null?void 0:n.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(TO(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var RO=class extends fO{constructor(t){super(t)}},AO=class{constructor(t,r,s){var a,o;this.supabaseUrl=t,this.supabaseKey=r;const i=EO(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:bO,realtime:wO,auth:jn(jn({},vO),{},{storageKey:l}),global:yO},d=PO(s??{},c);if(this.storageKey=(a=d.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(o=d.global.headers)!==null&&o!==void 0?o:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=d.auth)!==null&&u!==void 0?u:{},this.headers,d.global.fetch)}this.fetch=NO(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(jn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new cL(new URL("rest/v1",i).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new lB(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new sL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,r,s;if(t.accessToken)return await t.accessToken();const{data:a}=await t.auth.getSession();return(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:o,storageKey:i,flowType:l,lock:c,debug:d,throwOnError:u},h,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new RO({url:this.authUrl.href,headers:jn(jn({},g),h),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:o,flowType:l,lock:c,debug:d,throwOnError:u,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new TL(this.realtimeUrl.href,jn(jn({},t),{},{params:jn(jn({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const MO=(n,t,r)=>new AO(n,t,r);function IO(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const t=n.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}IO()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Rk="https://vzsbiixeonfmyvjqzvxc.supabase.co",DO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ6c2JpaXhlb25mbXl2anF6dnhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4ODAzODYsImV4cCI6MjA3NTQ1NjM4Nn0.yGrcfXHsiqEsSMDmIWaDKpNwjIlGYxadk0_FEM4ITUE",$O=`${Rk}/functions/v1`,K=MO(Rk,DO);let LO=class{constructor(){this.currentUser=null}setCurrentUser(t){this.currentUser=t}async getLadders(){try{const{data:t,error:r}=await K.from("ladders").select("*").eq("is_active",!0).order("name");if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching ladders:",t),{success:!1,error:t.message}}}async getLadderPlayers(t){try{const{data:r,error:s}=await K.from("ladder_profiles").select(`
          *,
          users (
            id,
            email,
            first_name,
            last_name
          )
        `).eq("ladder_id",t).eq("is_active",!0).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder players:",r),{success:!1,error:r.message}}}async getLadderPlayersByName(t){try{const{data:r,error:s}=await K.from("ladder_profiles").select(`
          *,
          users (
            id,
            email,
            first_name,
            last_name
          )
        `).eq("ladder_name",t).eq("is_active",!0).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder players by name:",r),{success:!1,error:r.message}}}async getLadderMatches(t,r={}){try{let s=K.from("matches").select(`
          *,
          challenger:users!matches_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!matches_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t);r.status&&(s=s.eq("status",r.status)),r.playerId&&(s=s.or(`challenger_id.eq.${r.playerId},defender_id.eq.${r.playerId}`)),r.limit&&(s=s.limit(r.limit)),s=s.order("created_at",{ascending:!1});const{data:a,error:o}=await s;if(o)throw o;return{success:!0,data:a}}catch(s){return console.error("Error fetching ladder matches:",s),{success:!1,error:s.message}}}async getLadderChallenges(t){try{const{data:r,error:s}=await K.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t).eq("status","pending").order("created_at");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder challenges:",r),{success:!1,error:r.message}}}async getLadderPositions(t){try{const{data:r,error:s}=await K.from("ladder_positions").select(`
          *,
          user:users!ladder_positions_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder positions:",r),{success:!1,error:r.message}}}async getUsers(){try{const{data:t,error:r}=await K.from("users").select("*").order("first_name");if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching users:",t),{success:!1,error:t.message}}}async getLeagueProfiles(){try{const{data:t,error:r}=await K.from("league_profiles").select(`
          *,
          user:users!league_profiles_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `);if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching league profiles:",t),{success:!1,error:t.message}}}async createMatch(t){try{const{data:r,error:s}=await K.from("matches").insert([t]).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error creating match:",r),{success:!1,error:r.message}}}async updateMatch(t,r){try{const{data:s,error:a}=await K.from("matches").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating match:",s),{success:!1,error:s.message}}}async deleteMatch(t){try{const{error:r}=await K.from("matches").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting match:",r),{success:!1,error:r.message}}}async createChallenge(t){try{const r=await this.getUserByEmail(t.challengerEmail),s=await this.getUserByEmail(t.defenderEmail);if(!r.success||!s.success)throw new Error("Could not find challenger or defender user");const a=r.data.id,o=s.data.id,{data:i}=await K.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",a).limit(1).single(),{data:l}=await K.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",o).limit(1).single(),c={challenger_id:a,challenger_name:`${r.data.first_name} ${r.data.last_name}`,challenger_position:(i==null?void 0:i.position)||null,defender_id:o,defender_name:`${s.data.first_name} ${s.data.last_name}`,defender_position:(l==null?void 0:l.position)||null,ladder_id:null,status:"pending",proposed_date:t.preferredDates&&t.preferredDates.length>0?t.preferredDates[0]:null,proposed_location:t.location||"Legends Brews & Cues",match_format:t.raceLength?`race-to-${t.raceLength}`:"race-to-5",handicap:0,expires_at:new Date(Date.now()+7*24*60*60*1e3).toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:d,error:u}=await K.from("challenges").insert([c]).select().single();if(u)throw u;return{success:!0,data:d}}catch(r){return console.error("Error creating challenge:",r),{success:!1,error:r.message}}}async updateChallenge(t,r){try{const{data:s,error:a}=await K.from("challenges").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating challenge:",s),{success:!1,error:s.message}}}async updateLadderPosition(t,r,s){try{const{data:a,error:o}=await K.from("ladder_positions").update(s).eq("user_id",t).eq("ladder_id",r).select().single();if(o)throw o;return{success:!0,data:a}}catch(a){return console.error("Error updating ladder position:",a),{success:!1,error:a.message}}}async updateLadderProfile(t,r,s){try{const{data:a,error:o}=await K.from("ladder_profiles").update(s).eq("user_id",t).eq("ladder_id",r).select().single();if(o)throw o;return{success:!0,data:a}}catch(a){return console.error("Error updating ladder profile:",a),{success:!1,error:a.message}}}async getUserByEmail(t){try{const{data:r,error:s}=await K.from("users").select("*").eq("email",t).single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching user by email:",r),{success:!1,error:r.message}}}async createUser(t){try{const{data:r,error:s}=await K.from("users").insert([t]).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error creating user:",r),{success:!1,error:r.message}}}async updateUser(t,r){try{const{data:s,error:a}=await K.from("users").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating user:",s),{success:!1,error:s.message}}}async deleteUser(t){try{const{error:r}=await K.from("users").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting user:",r),{success:!1,error:r.message}}}async getPendingChallenges(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:[]};const s=r.data.id,{data:a,error:o}=await K.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("defender_id",s).eq("status","pending").order("created_at");if(o)throw o;return{success:!0,data:a||[]}}catch(r){return console.error("Error fetching pending challenges:",r),{success:!1,error:r.message}}}async getSentChallenges(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:[]};const s=r.data.id,{data:a,error:o}=await K.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("challenger_id",s).eq("status","pending").order("created_at");if(o)throw o;return{success:!0,data:a||[]}}catch(r){return console.error("Error fetching sent challenges:",r),{success:!1,error:r.message}}}async getPlayerProfileData(t,r="ladder"){try{const s=await this.getUserByEmail(t);if(!s.success)return{success:!1,error:"User not found"};const a=s.data,o=a.id,{data:i,error:l}=await K.from("ladder_profiles").select("*").eq("user_id",o).maybeSingle(),{data:c,error:d}=await K.from("league_profiles").select("*").eq("user_id",o).maybeSingle();return{success:!0,data:{user:a,ladderProfile:i||null,leagueProfile:c||null,hasLadderProfile:!!i,hasLeagueProfile:!!c}}}catch(s){return console.error("Error fetching player profile data:",s),{success:!1,error:s.message}}}async getPlayerGracePeriodStatus(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}};const{data:s}=await K.from("ladder_profiles").select("immunity_until, vacation_until, vacation_mode").eq("user_id",r.data.id).maybeSingle();if(!s)return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}};const a=new Date,o=s.immunity_until?new Date(s.immunity_until):null,i=s.vacation_until?new Date(s.vacation_until):null,l=o&&o>a,c=s.vacation_mode&&i&&i>a;return{success:!0,data:{inGracePeriod:l||c,gracePeriodEnd:l?o:c?i:null,immunityUntil:s.immunity_until,vacationUntil:s.vacation_until,vacationMode:s.vacation_mode}}}catch(r){return console.error("Error fetching grace period status:",r),{success:!1,error:r.message}}}async getPlayerDeclineStatus(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,declineStatus:{availableDeclines:0,canDecline:!1,nextResetDate:null,daysUntilNextReset:0}};const{data:s}=await K.from("ladder_profiles").select("decline_count, last_decline_date").eq("user_id",r.data.id).maybeSingle();if(!s)return{success:!0,declineStatus:{availableDeclines:0,canDecline:!1,nextResetDate:null,daysUntilNextReset:0}};const a=2,o=new Date,i=s.last_decline_date?new Date(s.last_decline_date):null;let l=s.decline_count||0;i&&(i.getMonth()===o.getMonth()&&i.getFullYear()===o.getFullYear()||(l=0));const c=Math.max(0,a-l),d=new Date(o.getFullYear(),o.getMonth()+1,1),u=Math.ceil((d-o)/(1e3*60*60*24));return{success:!0,declineStatus:{availableDeclines:c,canDecline:c>0,declineCount:l,lastDeclineDate:s.last_decline_date,nextResetDate:d.toISOString(),daysUntilNextReset:u}}}catch(r){return console.error("Error fetching decline status:",r),{success:!1,error:r.message}}}async getFastTrackStatus(t){try{return{success:!0,data:{isFastTrack:!1,fastTrackUntil:null}}}catch(r){return console.error("Error fetching fast track status:",r),{success:!1,error:r.message}}}async submitFastTrackPlayerChoice(t,r){try{console.log(" Submitting Fast Track player choice:",{playerEmail:t,choice:r});const s=await this.getUserByEmail(t);if(!s.success)throw new Error("User not found");const a=s.data.id,{data:o,error:i}=await K.from("ladder_profiles").select("*").eq("user_id",a).single();if(i)throw i;if(!o)throw new Error("Player profile not found");if(r==="stay")return console.log(" Player chose to stay on current ladder"),{success:!0,message:"You will remain on your current ladder",choice:"stay"};if(r==="move_down"){const l=o.ladder_name;let c=null;if(l==="500-549"?c="499-under":l==="550-599"?c="500-549":l==="600-plus"&&(c="550-599"),!c)throw new Error("Cannot move down from current ladder");await K.from("ladder_profiles").delete().eq("user_id",a).eq("ladder_name",l);const{data:d}=await K.from("ladder_profiles").select("user_id, position").eq("ladder_name",l).gt("position",o.position).order("position",{ascending:!0});if(d&&d.length>0){const f=d.map(m=>({user_id:m.user_id,ladder_name:l,position:m.position-1}));for(const m of f)await K.from("ladder_profiles").update({position:m.position}).eq("user_id",m.user_id).eq("ladder_name",m.ladder_name)}const{data:u}=await K.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1),h=u&&u.length>0?u[0].position+1:1,p=new Date;p.setDate(p.getDate()+28);const{error:g}=await K.from("ladder_profiles").insert({user_id:a,ladder_name:c,position:h,wins:o.wins||0,losses:o.losses||0,total_matches:o.total_matches||0,is_active:!0,fast_track_challenges:2,fast_track_until:p.toISOString(),fargo_rate:o.fargo_rate});if(g)throw g;return console.log(" Player moved down with Fast Track privileges:",{from:l,to:c,position:h,fastTrackChallenges:2,expiresAt:p}),{success:!0,message:`You have been moved to the ${c} ladder with 2 Fast Track challenges`,choice:"move_down",newLadder:c,newPosition:h,fastTrackChallenges:2,fastTrackExpiration:p.toISOString()}}else throw new Error("Invalid choice")}catch(s){return console.error("Error submitting Fast Track player choice:",s),{success:!1,error:s.message}}}async startFastTrackGracePeriod(t){try{console.log(" Starting Fast Track grace period for:",t);const r=await this.getUserByEmail(t);if(!r.success)throw new Error("User not found");const s=r.data.id,{data:a,error:o}=await K.from("ladder_profiles").select("*").eq("user_id",s).single();if(o)throw o;if(!a)throw new Error("Player profile not found");const i=new Date;i.setDate(i.getDate()+14);const{error:l}=await K.from("ladder_profiles").update({grace_period_start:new Date().toISOString(),grace_period_end:i.toISOString()}).eq("user_id",s).eq("ladder_name",a.ladder_name);if(l)throw l;return console.log(" Grace period started:",{userId:s,ladder:a.ladder_name,startDate:new Date().toISOString(),endDate:i.toISOString(),daysRemaining:14}),{success:!0,message:"Grace period started successfully! You have 14 days to maintain your rating.",gracePeriodStart:new Date().toISOString(),gracePeriodEnd:i.toISOString(),daysRemaining:14}}catch(r){return console.error("Error starting Fast Track grace period:",r),{success:!1,error:r.message}}}async getFastTrackGracePeriod(t){try{return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}}}catch(r){return console.error("Error fetching fast track grace period:",r),{success:!1,error:r.message}}}async getPlayerLastMatch(t){try{const r=await this.getUserByEmail(t);if(!r.success||!r.data)return{success:!1,error:"User not found"};const s=r.data.id,{data:a,error:o}=await K.from("matches").select("*").or(`winner_id.eq.${s},loser_id.eq.${s}`).eq("status","completed").order("match_date",{ascending:!1}).limit(1);if(o)throw o;if(!a||a.length===0)return{success:!0,data:null};const i=a[0];return{success:!0,data:{result:i.winner_id===s?"W":"L",opponent:i.winner_id===s?i.loser_name:i.winner_name,date:i.match_date,venue:i.location||"Unknown",matchType:"challenge",playerRole:i.winner_id===s?"winner":"loser",score:i.score||"N/A",id:i.id,status:i.status||"scheduled",match_date:i.match_date,location:i.location,verified_by:i.verified_by,verified_at:i.verified_at,notes:i.notes}}}catch(r){return console.error("Error fetching player last match:",r),{success:!1,error:r.message}}}async getPlayerMatchHistory(t,r=10){try{const s=await this.getUserByEmail(t);if(!s.success||!s.data)return{success:!1,error:"User not found"};const a=s.data.id,{data:o,error:i}=await K.from("matches").select("*").or(`winner_id.eq.${a},loser_id.eq.${a}`).eq("status","completed").order("match_date",{ascending:!1}).limit(r);if(i)throw i;return{success:!0,data:o.map(c=>({result:c.winner_id===a?"W":"L",opponent:c.winner_id===a?c.loser_name:c.winner_name,date:c.match_date,venue:c.location||"Unknown",matchType:"challenge",playerRole:c.winner_id===a?"winner":"loser",score:c.score||"N/A",id:c.id,status:c.status||"scheduled",match_date:c.match_date,location:c.location,verified_by:c.verified_by,verified_at:c.verified_at,notes:c.notes,positionBefore:c.winner_position||c.loser_position,positionAfter:null}))}}catch(s){return console.error("Error fetching player match history:",s),{success:!1,error:s.message}}}async acceptChallenge(t,r){try{const{data:s,error:a}=await K.from("challenges").update({status:"accepted",proposed_date:r.selectedDate||null,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error accepting challenge:",s),{success:!1,error:s.message}}}async declineChallenge(t,r){try{const{data:s,error:a}=await K.from("challenges").update({status:"declined",updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;if(r.defenderEmail){const o=await this.getUserByEmail(r.defenderEmail);if(o.success&&o.data){const{data:i}=await K.from("ladder_profiles").select("decline_count").eq("user_id",o.data.id).limit(1),l=i&&i.length>0&&i[0].decline_count||0;await K.from("ladder_profiles").update({decline_count:l+1,last_decline_date:new Date().toISOString()}).eq("user_id",o.data.id)}}return{success:!0,data:s}}catch(s){return console.error("Error declining challenge:",s),{success:!1,error:s.message}}}async counterProposeChallenge(t,r){try{const{data:s,error:a}=await K.from("challenges").update({status:"counter-proposed",proposed_date:r.preferredDates&&r.preferredDates.length>0?r.preferredDates[0]:null,proposed_location:r.location||null,match_format:r.raceLength?`race-to-${r.raceLength}`:null,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error submitting counter-proposal:",s),{success:!1,error:s.message}}}async reportMatchResult(t){try{const r=await this.getUserByEmail(t.winnerEmail),s=await this.getUserByEmail(t.loserEmail);if(!r.success||!s.success)throw new Error("Could not find winner or loser user");const a=r.data.id,o=s.data.id,i={league_id:null,ladder_id:null,challenge_id:t.challengeId||null,winner_id:a,winner_name:`${r.data.first_name} ${r.data.last_name}`,winner_position:t.winnerPosition||null,loser_id:o,loser_name:`${s.data.first_name} ${s.data.last_name}`,loser_position:t.loserPosition||null,score:t.score||null,match_date:t.matchDate||new Date().toISOString(),location:t.location||"Legends Brews & Cues",verified_by:t.verifiedBy||null,verified_at:t.verifiedAt||null,notes:t.notes||null,created_at:new Date().toISOString()},{data:l,error:c}=await K.from("matches").insert([i]).select().single();if(c)throw c;await this.updatePlayerStats(a,{wins:1}),await this.updatePlayerStats(o,{losses:1}),t.challengeId&&await this.updateChallenge(t.challengeId,{status:"completed",updated_at:new Date().toISOString()});try{await(await _a(()=>import("./emailNotificationService-3e5482ec.js"),[])).default.sendMatchCompleted({loserEmail:t.loserEmail,loserName:`${s.data.first_name} ${s.data.last_name}`,winnerName:`${r.data.first_name} ${r.data.last_name}`,matchDate:t.matchDate,location:t.location,score:t.score,ladderName:t.ladderName,newPosition:t.loserPosition}),console.log(" Match completed emails sent")}catch(d){console.error("Failed to send match completed email:",d)}return{success:!0,data:l}}catch(r){return console.error("Error reporting match result:",r),{success:!1,error:r.message}}}async updatePlayerStats(t,r){try{const{data:s}=await K.from("ladder_profiles").select("wins, losses, total_matches").eq("user_id",t).limit(1).single();if(!s)throw new Error("Player profile not found");const a={wins:(s.wins||0)+(r.wins||0),losses:(s.losses||0)+(r.losses||0),total_matches:(s.total_matches||0)+1},{data:o,error:i}=await K.from("ladder_profiles").update(a).eq("user_id",t).select().single();if(i)throw i;return{success:!0,data:o}}catch(s){return console.error("Error updating player stats:",s),{success:!1,error:s.message}}}async getUserProfileData(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!1,error:"User not found"};const s=r.data,{data:a}=await K.from("ladder_profiles").select("*").eq("user_id",s.id).maybeSingle(),{data:o}=await K.from("league_profiles").select("*").eq("user_id",s.id).maybeSingle();return{success:!0,data:{user:s,profile:{email:s.email,firstName:s.first_name,lastName:s.last_name,phone:s.phone,locations:s.locations||"",availability:s.availability||{},divisions:[],ladderInfo:a?{ladderName:a.ladder_name,position:a.position,wins:a.wins,losses:a.losses,fargoRate:a.fargo_rate}:null,leagueInfo:o?{division:o.division,skillLevel:o.skill_level}:null}}}}catch(r){return console.error("Error fetching user profile data:",r),{success:!1,error:r.message}}}async updateUserProfile(t,r){try{const s=await this.getUserByEmail(t);if(!s.success)return{success:!1,error:"User not found"};const a=s.data.id,o={};if(r.firstName&&(o.first_name=r.firstName),r.lastName&&(o.last_name=r.lastName),r.phone!==void 0&&(o.phone=r.phone),r.locations!==void 0&&(o.locations=r.locations),r.availability!==void 0&&(o.availability=r.availability),Object.keys(o).length>0){const{error:i}=await K.from("users").update(o).eq("id",a);if(i)throw i}return{success:!0,data:{message:"Profile updated successfully"}}}catch(s){return console.error("Error updating user profile:",s),{success:!1,error:s.message}}}async getLocations(){try{return{success:!0,data:[{name:"Legends Brews & Cues"},{name:"Rack'em Billiards"},{name:"Pastime Lounge"},{name:"Murray Street Darts"},{name:"My House"}]}}catch(t){return console.error("Error fetching locations:",t),{success:!1,error:t.message}}}async getAvailableMatches(t){try{const r=t.trim().toLowerCase(),{data:s,error:a}=await K.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `);if(a)throw a;const o=s.filter(c=>{const d=`${c.users.first_name} ${c.users.last_name}`.toLowerCase(),u=c.users.first_name.toLowerCase(),h=c.users.last_name.toLowerCase(),p=(c.users.email||"").toLowerCase();return d.includes(r)||u.includes(r)||h.includes(r)||p.includes(r)});if(!o||o.length===0)return{success:!1,message:"Player not found. Please check the name and try again."};if(o.length>1)return{success:!0,multipleMatches:!0,playerOptions:o.map(d=>({_id:d.id,fullName:`${d.users.first_name} ${d.users.last_name}`,position:d.position,ladderName:d.ladder_name,fargoRate:d.fargo_rate||"N/A"}))};const i=o[0],l=await this.getPlayerAvailableMatches(i);return{success:!0,player:{_id:i.id,name:`${i.users.first_name} ${i.users.last_name}`,email:i.users.email,phone:i.users.phone,position:i.position,ladderName:i.ladder_name,fargoRate:i.fargo_rate},availableMatches:l}}catch(r){return console.error("Error getting available matches:",r),{success:!1,error:r.message}}}async getPlayerAvailableMatches(t){try{const r=[],{data:s,error:a}=await K.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `).eq("ladder_name",t.ladder_name).lt("position",t.position).gte("position",Math.max(1,t.position-4)).order("position",{ascending:!0});if(a)throw a;s.forEach(l=>{r.push({defenderName:`${l.users.first_name} ${l.users.last_name}`,defenderEmail:l.users.email,defenderPhone:l.users.phone,defenderPosition:l.position,ladderName:l.ladder_name,matchType:"challenge",color:"#2196F3",icon:"",reason:`Challenge match - Position #${l.position}`})});const{data:o,error:i}=await K.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `).eq("ladder_name",t.ladder_name).gt("position",t.position).lte("position",t.position+5).order("position",{ascending:!0});if(i)throw i;return o.forEach(l=>{r.push({defenderName:`${l.users.first_name} ${l.users.last_name}`,defenderEmail:l.users.email,defenderPhone:l.users.phone,defenderPosition:l.position,ladderName:l.ladder_name,matchType:"smackdown",color:"#FF5722",icon:"",reason:`SmackDown - Position #${l.position}`})}),r}catch(r){return console.error("Error getting player available matches:",r),[]}}async submitMatchSchedulingRequest(t){try{const{data:r,error:s}=await K.from("match_scheduling_requests").insert({challenger_name:t.challengerName,challenger_email:t.challengerEmail,challenger_phone:t.challengerPhone,defender_name:t.defenderName,defender_email:t.defenderEmail,defender_phone:t.defenderPhone,preferred_date:t.preferredDate,preferred_time:t.preferredTime,location:t.location,game_type:t.gameType,race_length:t.raceLength,notes:t.notes,match_type:t.matchType,status:t.status||"pending_approval",submitted_at:t.submittedAt||new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error submitting match scheduling request:",r),{success:!1,error:r.message}}}async getPendingMatchSchedulingRequests(){try{const{data:t,error:r}=await K.from("match_scheduling_requests").select("*").eq("status","pending_approval").order("submitted_at",{ascending:!1});if(r)throw r;return{success:!0,requests:t||[]}}catch(t){return console.error("Error getting pending match scheduling requests:",t),{success:!1,error:t.message}}}async getScheduledMatches(t=null){try{let r=K.from("matches").select(`
          *,
          winner:users!matches_winner_id_fkey(id, first_name, last_name, email),
          loser:users!matches_loser_id_fkey(id, first_name, last_name, email)
        `).eq("status","scheduled");t&&(r=r.eq("ladder_id",t));const{data:s,error:a}=await r.order("match_date",{ascending:!0});if(a)throw a;return{success:!0,matches:(s||[]).map(i=>{const l=i.winner,c=i.loser,d=p=>{if(!p)return{firstName:"",lastName:""};const g=p.trim().split(" ");return{firstName:g[0]||"",lastName:g.slice(1).join(" ")||""}},u=l?null:d(i.winner_name),h=c?null:d(i.loser_name);return{...i,scheduledDate:i.match_date||i.scheduled_date||i.scheduledDate,raceLength:i.race_length||i.raceLength,gameType:i.game_type||i.gameType,tableSize:i.table_size||i.tableSize,matchType:i.match_type||i.matchType||"challenge",venue:i.location||i.venue,player1:l?{id:l.id,firstName:l.first_name,lastName:l.last_name,email:l.email,_id:l.id}:i.winner_name?{id:i.winner_id,firstName:u.firstName,lastName:u.lastName,email:null,_id:i.winner_id}:null,player2:c?{id:c.id,firstName:c.first_name,lastName:c.last_name,email:c.email,_id:c.id}:i.loser_name?{id:i.loser_id,firstName:h.firstName,lastName:h.lastName,email:null,_id:i.loser_id}:null,winner:l,loser:c,match_date:i.match_date,race_length:i.race_length,game_type:i.game_type,table_size:i.table_size,match_type:i.match_type,winner_name:i.winner_name,loser_name:i.loser_name}})}}catch(r){return console.error("Error getting scheduled matches:",r),{success:!1,error:r.message}}}async getScheduledMatchesForLadder(t){try{if(!t)return console.warn("getScheduledMatchesForLadder called without ladderName"),{success:!0,matches:[]};const{data:r,error:s}=await K.from("ladder_profiles").select("user_id").eq("ladder_name",t);if(s)throw s;const a=r.map(l=>l.user_id);if(a.length===0)return{success:!0,matches:[]};const{data:o,error:i}=await K.from("matches").select("*").in("status",["scheduled","completed"]).or(`winner_id.in.(${a.join(",")}),loser_id.in.(${a.join(",")})`).order("match_date",{ascending:!0});if(i)throw i;return{success:!0,matches:o||[]}}catch(r){return console.error("Error getting scheduled matches for ladder:",r),{success:!1,error:r.message}}}async getAllMatchesForLadder(t){try{if(!t)return console.warn("getAllMatchesForLadder called without ladderName"),{success:!0,matches:[]};const{data:r,error:s}=await K.from("ladder_profiles").select("user_id").eq("ladder_name",t);if(s)throw s;const a=r.map(m=>m.user_id);if(a.length===0)return{success:!0,matches:[]};const{data:o,error:i}=await K.from("matches").select("*").or(`winner_id.in.(${a.join(",")}),loser_id.in.(${a.join(",")})`).order("match_date",{ascending:!1});if(i)throw i;const l=new Set;(o||[]).forEach(m=>{m.winner_id&&l.add(m.winner_id),m.loser_id&&l.add(m.loser_id),m.challenger_id&&l.add(m.challenger_id),m.defender_id&&l.add(m.defender_id)});const{data:c,error:d}=await K.from("users").select("id, first_name, last_name").in("id",Array.from(l));if(d)throw d;const{data:u,error:h}=await K.from("ladder_profiles").select("user_id, position").eq("ladder_name",t);if(h)throw h;const p=new Map,g=new Map;return(c||[]).forEach(m=>{p.set(m.id,`${m.first_name} ${m.last_name}`)}),(u||[]).forEach(m=>{g.set(m.user_id,m.position)}),{success:!0,matches:(o||[]).map(m=>{const v=g.get(m.winner_id),b=g.get(m.loser_id);return{...m,winner_name:m.winner_name||p.get(m.winner_id)||"N/A",loser_name:m.loser_name||p.get(m.loser_id)||"N/A",challenger_name:m.challenger_name||p.get(m.challenger_id)||"N/A",defender_name:m.defender_name||p.get(m.defender_id)||"N/A",winner_position:v,loser_position:b}})}}catch(r){return console.error("Error getting all matches for ladder:",r),{success:!1,error:r.message}}}async getRecentMatchesForPlayer(t,r=5){try{if(!t)return console.warn("getRecentMatchesForPlayer called without playerId"),{success:!0,matches:[]};const{data:s,error:a}=await K.from("matches").select("*").or(`winner_id.eq.${t},loser_id.eq.${t}`).eq("status","completed").order("match_date",{ascending:!1}).limit(r);if(a)throw a;return{success:!0,matches:s||[]}}catch(s){return console.error("Error getting recent matches for player:",s),{success:!1,error:s.message}}}async getAllPlayerMatches(t,r=["499-under","500-549","550-plus"]){try{if(!t)return console.warn("getAllPlayerMatches called without playerEmail"),{success:!0,matches:[]};console.log(" Getting matches for player:",t,"across ladders:",r);const s=new Set;for(const b of r){const{data:w,error:x}=await K.from("ladder_profiles").select("user_id").eq("ladder_name",b);if(x){console.error(`Error fetching players from ${b}:`,x);continue}w.forEach(j=>s.add(j.user_id))}if(s.size===0)return{success:!0,matches:[]};const{data:a,error:o}=await K.from("users").select("id, first_name, last_name, email").eq("email",t.toLowerCase());if(o)throw o;if(!a||a.length===0)return console.log(" No user found with email:",t),{success:!0,matches:[]};const i=a[0].id,{data:l,error:c}=await K.from("matches").select("*").or(`winner_id.eq.${i},loser_id.eq.${i}`).in("winner_id",Array.from(s)).in("loser_id",Array.from(s)).order("match_date",{ascending:!1});if(c)throw c;const d=new Set;l.forEach(b=>{b.winner_id&&d.add(b.winner_id),b.loser_id&&d.add(b.loser_id),b.challenger_id&&d.add(b.challenger_id),b.defender_id&&d.add(b.defender_id)});const{data:u,error:h}=await K.from("users").select("id, first_name, last_name, email").in("id",Array.from(d));if(h)throw h;const p=new Map;u.forEach(b=>{p.set(b.id,{firstName:b.first_name,lastName:b.last_name,email:b.email})});const{data:g,error:f}=await K.from("ladder_profiles").select("user_id, ladder_name, position").in("ladder_name",r);if(f)throw f;const m=new Map;g.forEach(b=>{m.set(`${b.user_id}_${b.ladder_name}`,b.position)});const v=l.map(b=>{const w=p.get(b.winner_id),x=p.get(b.loser_id),j=p.get(b.challenger_id),S=p.get(b.defender_id);let _="unknown";for(const C of r)if(m.has(`${b.winner_id}_${C}`)||m.has(`${b.loser_id}_${C}`)){_=C;break}return{...b,_id:b.id,player1:w?{firstName:w.firstName,lastName:w.lastName,email:w.email,id:b.winner_id}:null,player2:x?{firstName:x.firstName,lastName:x.lastName,email:x.email,id:b.loser_id}:null,challenger:j?{firstName:j.firstName,lastName:j.lastName,email:j.email,id:b.challenger_id}:null,defender:S?{firstName:S.firstName,lastName:S.lastName,email:S.email,id:b.defender_id}:null,ladderName:_,ladderDisplayName:_==="499-under"?"499 & Under":_==="500-549"?"500-549":_==="550-plus"?"550+":_,matchType:b.match_type,status:b.status,matchDate:b.match_date,scheduledDate:b.scheduled_date,location:b.location,notes:b.notes,score:b.score}});return console.log(" Transformed matches for player:",v.length),{success:!0,matches:v}}catch(s){return console.error("Error getting all player matches:",s),{success:!1,error:s.message}}}async getScheduledMatchesForPlayer(t,r){try{if(!t||!r)return console.warn("getScheduledMatchesForPlayer called without playerEmail or ladderName"),{success:!0,matches:[]};console.log(" Getting scheduled matches for player:",t,"on ladder:",r);const{data:s,error:a}=await K.from("users").select("id, first_name, last_name, email").eq("email",t.toLowerCase());if(a)throw a;if(!s||s.length===0)return console.log(" No user found with email:",t),{success:!0,matches:[]};const o=s[0].id,{data:i,error:l}=await K.from("ladder_profiles").select("user_id").eq("ladder_name",r);if(l)throw l;const c=i.map(w=>w.user_id);if(c.length===0)return{success:!0,matches:[]};const{data:d,error:u}=await K.from("matches").select("*").eq("status","scheduled").or(`winner_id.eq.${o},loser_id.eq.${o}`).in("winner_id",c).in("loser_id",c),h=(d==null?void 0:d.filter(w=>!w.ladder_id||w.ladder_id===r))||[];h.sort((w,x)=>{const j=w.match_date?new Date(w.match_date):new Date(0),S=x.match_date?new Date(x.match_date):new Date(0);return j-S});const p=h;if(u)throw u;const g=new Set;d.forEach(w=>{w.winner_id&&g.add(w.winner_id),w.loser_id&&g.add(w.loser_id),w.challenger_id&&g.add(w.challenger_id),w.defender_id&&g.add(w.defender_id)});const{data:f,error:m}=await K.from("users").select("id, first_name, last_name, email").in("id",Array.from(g));if(m)throw m;const v=new Map;f.forEach(w=>{v.set(w.id,{firstName:w.first_name,lastName:w.last_name,email:w.email,id:w.id})});const b=d.map(w=>{const x=v.get(w.winner_id),j=v.get(w.loser_id),S=v.get(w.challenger_id),_=v.get(w.defender_id),C=M=>{if(!M)return"";const E=new Date(M),P=E.getFullYear(),D=String(E.getMonth()+1).padStart(2,"0"),T=String(E.getDate()).padStart(2,"0");return`${P}-${D}-${T}`},N=w.match_date||w.scheduled_date||w.scheduledDate;return console.log(" Transforming match date:",{match_id:w.id,match_date:w.match_date,scheduled_date:w.scheduled_date,selected:N,formatted:C(N)}),{_id:w.id,senderName:x?`${x.firstName} ${x.lastName}`:"Unknown",receiverName:j?`${j.firstName} ${j.lastName}`:"Unknown",senderId:w.winner_id,receiverId:w.loser_id,date:C(N),match_date:w.match_date,scheduled_date:w.scheduled_date,scheduledDate:N,time:N?new Date(N).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",location:w.location||"TBD",status:w.status,createdAt:w.created_at||new Date().toISOString(),matchFormat:w.game_type||"9-ball",raceLength:w.race_length||"7",player1:x?{firstName:x.firstName,lastName:x.lastName,email:x.email,_id:x.id}:null,player2:j?{firstName:j.firstName,lastName:j.lastName,email:j.email,_id:j.id}:null,challenger:S?{firstName:S.firstName,lastName:S.lastName,email:S.email,_id:S.id}:null,defender:_?{firstName:_.firstName,lastName:_.lastName,email:_.email,_id:_.id}:null,scheduledDate:w.scheduled_date,matchType:w.match_type}});return console.log(" Transformed scheduled matches for player:",b.length),{success:!0,matches:b}}catch(s){return console.error("Error getting scheduled matches for player:",s),{success:!1,error:s.message}}}async createScheduledMatch(t){var r;try{let s=null,a=null;const o=3;for(let h=1;h<=o;h++){console.log(` Authentication check attempt ${h}/${o}`);const{data:p,error:g}=await K.auth.getSession();if(!g&&(p!=null&&p.session)){a=p.session,s=p.session.user,console.log(" Session found:",s.id);break}else{console.log(` No session on attempt ${h}, error:`,g);const{data:{user:f},error:m}=await K.auth.getUser();if(!m&&f){s=f,console.log(" User found via getUser:",s.id);break}else console.log(` No user on attempt ${h}, error:`,m),h<o&&await new Promise(v=>setTimeout(v,1e3*h))}}if(!s){console.error(" Authentication error - no session or user after retries"),await new Promise(p=>setTimeout(p,2e3));const{data:h}=await K.auth.getSession();if((r=h==null?void 0:h.session)!=null&&r.user)s=h.session.user,console.log(" Session found on final retry:",s.id);else throw new Error("User not authenticated. Please log in again. If you just logged in, please wait a moment and try again.")}console.log(" Looking up user IDs for:",{challengerEmail:t.challengerEmail,defenderEmail:t.defenderEmail});const i=await this.getUserIdByEmail(t.challengerEmail),l=await this.getUserIdByEmail(t.defenderEmail);if(console.log(" User IDs found:",{challengerId:i,defenderId:l}),!i||!l)throw new Error("Could not find user IDs for challenger or defender");const c={ladder_id:t.ladderName,winner_id:i,winner_name:t.challengerName,winner_position:t.challengerPosition,loser_id:l,loser_name:t.defenderName,loser_position:t.defenderPosition,score:null,match_date:t.preferredDate,location:t.location,match_type:t.matchType,game_type:t.gameType,race_length:t.raceLength,notes:t.notes,status:"scheduled"};console.log(" Attempting to insert match:",c);const{data:d,error:u}=await K.from("matches").insert(c).select().single();if(u)throw console.error(" Supabase insert error:",u),console.error(" Error code:",u.code),console.error(" Error message:",u.message),console.error(" Error details:",u.details),console.error(" Error hint:",u.hint),u;return console.log(" Match created successfully:",d),{success:!0,data:d}}catch(s){console.error(" Error creating scheduled match:",s);const a=s.message||s.toString();return console.error(" Full error object:",s),{success:!1,error:a}}}async getUserIdByEmail(t){try{let r=null;const{data:s,error:a}=await K.auth.getSession();if(!a&&(s!=null&&s.session))r=s.session.user;else{const{data:{user:l},error:c}=await K.auth.getUser();if(!c&&l)r=l;else throw console.error(" Not authenticated when getting user ID:",{sessionError:a,authError:c}),new Error("User not authenticated")}if(!r)throw new Error("User not authenticated");console.log(" Looking up user ID for email:",t);const{data:o,error:i}=await K.from("users").select("id").eq("email",t).single();if(i)throw console.error(" Error querying users table:",i),console.error(" Error code:",i.code),console.error(" Error message:",i.message),i;return console.log(" Found user ID:",o==null?void 0:o.id),o==null?void 0:o.id}catch(r){return console.error(" Error getting user ID by email:",r),null}}async getAllUsersForAdmin(){try{const{data:t,error:r}=await K.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses,
            is_active
          ),
          league_profiles (
            id,
            division,
            divisions,
            total_matches,
            wins,
            losses
          )
        `).order("created_at",{ascending:!1});if(r)throw r;return{success:!0,users:t||[]}}catch(t){return console.error("Error getting all users for admin:",t),{success:!1,error:t.message}}}async searchUsersForAdmin(t){try{const r=t.trim().toLowerCase(),{data:s,error:a}=await K.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses,
            is_active
          ),
          league_profiles (
            id,
            division,
            divisions,
            total_matches,
            wins,
            losses
          )
        `).order("created_at",{ascending:!1});if(a)throw a;return{success:!0,users:s.filter(i=>{const l=(i.first_name||"").toLowerCase(),c=(i.last_name||"").toLowerCase(),d=(i.email||"").toLowerCase(),u=`${l} ${c}`.toLowerCase();return l.includes(r)||c.includes(r)||d.includes(r)||u.includes(r)})||[]}}catch(r){return console.error("Error searching users for admin:",r),{success:!1,error:r.message}}}async getAdminUserData(t){var r,s;try{const{data:a,error:o}=await K.from("users").select(`
          *,
          ladder_profiles (*),
          league_profiles (*)
        `).eq("id",t).single();if(o)throw o;return{success:!0,user:a,ladderProfile:((r=a.ladder_profiles)==null?void 0:r[0])||null,leagueProfile:((s=a.league_profiles)==null?void 0:s[0])||null}}catch(a){return console.error("Error getting admin user data:",a),{success:!1,error:a.message}}}async updateAdminUser(t,r){try{const{data:s,error:a}=await K.from("users").update({first_name:r.firstName,last_name:r.lastName,email:r.email,phone:r.phone,is_active:r.isActive,is_approved:r.isApproved,is_admin:r.isAdmin,locations:r.locations,availability:r.availability}).eq("id",t).select().single();if(a)throw a;return{success:!0,user:s}}catch(s){return console.error("Error updating admin user:",s),{success:!1,error:s.message}}}async deleteAdminUser(t){try{const{error:r}=await K.from("users").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting admin user:",r),{success:!1,error:r.message}}}async getPendingUsers(){try{const{data:t,error:r}=await K.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position
          )
        `).eq("is_pending_approval",!0).order("created_at",{ascending:!1});if(r)throw r;return{success:!0,users:t||[]}}catch(t){return console.error("Error getting pending users:",t),{success:!1,error:t.message}}}async isOAuthUser(t){try{return!1}catch(r){return console.error("Error checking OAuth user:",r),!1}}async approveUser(t){try{const{data:r,error:s}=await K.from("users").update({is_pending_approval:!1,is_approved:!0,is_active:!0,approval_date:new Date().toISOString()}).eq("id",t).select().single();if(s)throw s;let a=!1;try{const o=r}catch{console.log("Could not check OAuth status, defaulting to password reset")}return{success:!0,user:r,isOAuthUser:a}}catch(r){return console.error("Error approving user:",r),{success:!1,error:r.message}}}async rejectUser(t){try{const{data:r,error:s}=await K.from("users").update({is_pending_approval:!1,is_approved:!1,is_active:!1}).eq("id",t).select().single();if(s)throw s;return{success:!0,user:r}}catch(r){return console.error("Error rejecting user:",r),{success:!1,error:r.message}}}async getAdminStats(){try{const[t,r,s,a]=await Promise.all([K.from("users").select("*",{count:"exact",head:!0}),K.from("ladders").select("*",{count:"exact",head:!0}),K.from("matches").select("*",{count:"exact",head:!0}),K.from("challenges").select("*",{count:"exact",head:!0})]),[o,i,l]=await Promise.all([K.from("users").select("*",{count:"exact",head:!0}).eq("is_pending_approval",!0),K.from("users").select("*",{count:"exact",head:!0}).eq("is_active",!0),K.from("users").select("*",{count:"exact",head:!0}).eq("is_admin",!0)]);return{success:!0,stats:{totalUsers:t.count||0,pendingUsers:o.count||0,activeUsers:i.count||0,adminUsers:l.count||0,totalLadders:r.count||0,totalMatches:s.count||0,totalChallenges:a.count||0}}}catch(t){return console.error("Error getting admin stats:",t),{success:!1,error:t.message}}}async getLadderApplications(){try{const{data:t,error:r}=await K.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            is_active,
            fargo_rate
          )
        `).eq("is_pending_approval",!0).order("created_at",{ascending:!1});if(r)throw r;const{data:s,error:a}=await K.from("ladder_profiles").select(`
          *,
          users (*)
        `).eq("is_active",!1).order("created_at",{ascending:!1});a&&console.warn("Could not fetch ladder_profiles pending:",a);const o=c=>{var d,u,h,p,g,f,m,v,b,w,x;return{...c,firstName:c.first_name||((d=c.users)==null?void 0:d.first_name),lastName:c.last_name||((u=c.users)==null?void 0:u.last_name),phone:c.phone||((h=c.users)==null?void 0:h.phone),experience:c.experience||((p=c.users)==null?void 0:p.experience),fargoRate:((f=(g=c.ladder_profiles)==null?void 0:g[0])==null?void 0:f.fargo_rate)??c.fargo_rate??((m=c.users)==null?void 0:m.fargo_rate),currentLeague:c.currentLeague||((v=c.users)==null?void 0:v.currentLeague),currentRanking:c.currentRanking||((b=c.users)==null?void 0:b.currentRanking),payNow:c.payNow??((w=c.users)==null?void 0:w.payNow),paymentMethod:c.paymentMethod||((x=c.users)==null?void 0:x.paymentMethod),status:c.status||(c.is_pending_approval?"pending":"approved")}},i=new Map;for(const c of t||[])i.set(c.id,o(c));if(s&&s.length>0)for(const c of s){const d=c.user_id;if(i.has(d))continue;const u=c.users||{};!u||!u.email||i.set(d,o({id:d,...u,first_name:u.first_name,last_name:u.last_name,email:u.email,ladder_profiles:[{id:c.id,ladder_name:c.ladder_name,position:c.position,is_active:c.is_active,fargo_rate:c.fargo_rate}],is_pending_approval:u.is_pending_approval??!0,status:"pending"}))}const l=Array.from(i.values());return console.log(" Raw applications data from Supabase:",l.length,"applications"),{success:!0,applications:l}}catch(t){return console.error("Error getting ladder applications:",t),{success:!1,error:t.message}}}async addUserToLadder(t,r,s=null){try{const{data:a}=await K.from("ladder_profiles").select("*").eq("user_id",t).eq("ladder_name",r).single();if(!s){const{data:i}=await K.from("ladder_profiles").select("position").eq("ladder_name",r).eq("is_active",!0).not("position","is",null).lt("position",900).order("position",{ascending:!1}).limit(1);s=(i&&i.length>0?i[0].position:0)+1}let o;if(a){const{data:i,error:l}=await K.from("ladder_profiles").update({position:s,is_active:!0}).eq("user_id",t).eq("ladder_name",r).select().single();if(l)throw l;o=i}else{const{data:i,error:l}=await K.from("ladder_profiles").insert({user_id:t,ladder_name:r,position:s,wins:0,losses:0,total_matches:0,is_active:!0}).select().single();if(l)throw l;o=i}return await K.from("users").update({is_pending_approval:!1,is_approved:!0,is_active:!0}).eq("id",t),{success:!0,ladderProfile:o}}catch(a){return console.error("Error adding user to ladder:",a),{success:!1,error:a.message}}}async reportForfeit(t){try{const{data:r,error:s}=await K.from("forfeit_requests").insert({match_id:t.matchId,reported_by:t.reportedBy,no_show_player:t.noShowPlayer,message:t.message,photo_proof:t.photoProof,status:"pending",created_at:new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,forfeitRequest:r}}catch(r){return console.error("Error reporting forfeit:",r),{success:!1,error:r.message}}}async getPendingForfeitRequests(){try{const{data:t,error:r}=await K.from("forfeit_requests").select(`
          *,
          match:matches (
            id,
            winner_name,
            loser_name,
            match_date,
            location
          ),
          reporter:users!forfeit_requests_reported_by_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          no_show_user:users!forfeit_requests_no_show_player_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("status","pending").order("created_at",{ascending:!1});if(r)throw r;return{success:!0,requests:t||[]}}catch(t){return console.error("Error getting pending forfeit requests:",t),{success:!1,error:t.message}}}async approveForfeitRequest(t,r,s){try{const{data:a,error:o}=await K.from("forfeit_requests").select("*").eq("id",t).single();if(o)throw o;const{error:i}=await K.from("forfeit_requests").update({status:"approved",admin_notes:r,reviewed_by:s,reviewed_at:new Date().toISOString()}).eq("id",t);if(i)throw i;if(a.penalty_applied){const{data:l,error:c}=await K.from("ladder_profiles").select("*").eq("user_id",a.no_show_player).single();if(!c&&l){const d=Math.min(l.position+3,999);await K.from("ladder_profiles").update({position:d,updated_at:new Date().toISOString()}).eq("id",l.id)}}return{success:!0}}catch(a){return console.error("Error approving forfeit request:",a),{success:!1,error:a.message}}}async denyForfeitRequest(t,r,s){try{const{error:a}=await K.from("forfeit_requests").update({status:"denied",admin_notes:r,reviewed_by:s,reviewed_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0}}catch(a){return console.error("Error denying forfeit request:",a),{success:!1,error:a.message}}}async getPlayerForfeitHistory(t){try{const{data:r,error:s}=await K.from("forfeit_requests").select(`
          *,
          match:matches (
            id,
            winner_name,
            loser_name,
            match_date,
            location
          ),
          reporter:users!forfeit_requests_reported_by_fkey (
            id,
            first_name,
            last_name
          )
        `).eq("no_show_player",t).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,forfeits:r||[]}}catch(r){return console.error("Error getting player forfeit history:",r),{success:!1,error:r.message}}}async getPlayerPayments(t,r=null){try{let s=K.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("user_id",t).order("payment_date",{ascending:!1});r&&(s=s.eq("session",r));const{data:a,error:o}=await s;if(o)throw o;return{success:!0,payments:a||[]}}catch(s){return console.error("Error getting player payments:",s),{success:!1,error:s.message}}}async getDivisionPayments(t,r=null){try{const{data:s,error:a}=await K.from("users").select("id, first_name, last_name, email").contains("divisions",[t]);if(a)throw a;const o=s.map(u=>u.id);let i=K.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).in("user_id",o).order("payment_date",{ascending:!1});r&&(i=i.eq("session",r));const{data:l,error:c}=await i;if(c)throw c;const d={totalPlayers:s.length,totalPayments:(l==null?void 0:l.length)||0,totalAmount:(l==null?void 0:l.reduce((u,h)=>u+(h.amount||0),0))||0,pendingPayments:(l==null?void 0:l.filter(u=>u.status==="pending").length)||0,paidPlayers:new Set(l==null?void 0:l.filter(u=>u.status==="completed").map(u=>u.user_id)).size||0};return{success:!0,payments:l||[],summary:d}}catch(s){return console.error("Error getting division payments:",s),{success:!1,error:s.message}}}async recordPayment(t){try{const{data:r,error:s}=await K.from("payments").insert({user_id:t.playerId||t.userId,amount:parseFloat(t.amount),payment_type:t.paymentType||"weekly_dues",payment_method:t.paymentMethod||"cash",session:t.session,division:t.division,week_number:t.weekNumber,reference_number:t.referenceNumber,location:t.location,notes:t.notes,status:"completed",payment_date:t.dueDate||new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,payment:r}}catch(r){return console.error("Error recording payment:",r),{success:!1,error:r.message}}}async getPendingPayments(){try{const{data:t,error:r}=await K.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("status","pending").order("created_at",{ascending:!1});if(r)throw r;const s={total:(t==null?void 0:t.length)||0,matchFees:(t==null?void 0:t.filter(a=>a.payment_type==="match_fee").length)||0,memberships:(t==null?void 0:t.filter(a=>a.payment_type==="membership").length)||0,creditsPurchases:(t==null?void 0:t.filter(a=>a.payment_type==="credits_purchase").length)||0,weeklyDues:(t==null?void 0:t.filter(a=>a.payment_type==="weekly_dues").length)||0};return{success:!0,pendingPayments:t||[],stats:s}}catch(t){return console.error("Error getting pending payments:",t),{success:!1,error:t.message}}}async verifyPayment(t,r,s=""){try{const{data:a,error:o}=await K.from("payments").update({status:r?"completed":"rejected",admin_notes:s,verified_at:new Date().toISOString(),verified_by:"admin"}).eq("id",t).select().single();if(o)throw o;return{success:!0,payment:a}}catch(a){return console.error("Error verifying payment:",a),{success:!1,error:a.message}}}async checkMatchEligibility(t,r=null){try{let s=K.from("payments").select("*").eq("user_id",t).eq("status","completed");r&&(s=s.eq("session",r));const{data:a,error:o}=await s;if(o)throw o;const i=a==null?void 0:a.find(d=>d.payment_type==="registration_fee"),l=a==null?void 0:a.filter(d=>d.payment_type==="weekly_dues");return{success:!0,eligibility:{canPlayMatches:!!(i&&l&&l.length>0),hasRegistrationFee:!!i,weeklyDuesPaid:(l==null?void 0:l.length)||0,totalPaid:(a==null?void 0:a.reduce((d,u)=>d+(u.amount||0),0))||0}}}catch(s){return console.error("Error checking match eligibility:",s),{success:!1,error:s.message}}}async recordWeeklyDues(t,r,s){try{const{data:a,error:o}=await K.from("users").select("id").contains("divisions",[t]);if(o)throw o;const i=a.map(d=>({user_id:d.id,amount:10,payment_type:"weekly_dues",payment_method:"pending",session:r,division:t,week_number:s,status:"pending",payment_date:new Date().toISOString()})),{data:l,error:c}=await K.from("payments").insert(i);if(c)throw c;return{success:!0,recordsCreated:i.length}}catch(a){return console.error("Error recording weekly dues:",a),{success:!1,error:a.message}}}async applyLateFees(t,r){try{const{data:s,error:a}=await K.from("payments").select("*").eq("division",t).eq("session",r).eq("status","pending").lt("payment_date",new Date(Date.now()-6048e5).toISOString());if(a)throw a;const o=s.map(i=>({user_id:i.user_id,amount:5,payment_type:"late_fee",payment_method:"system",session:r,division:t,notes:`Late fee for overdue payment - Week ${i.week_number}`,status:"pending",payment_date:new Date().toISOString()}));if(o.length>0){const{error:i}=await K.from("payments").insert(o);if(i)throw i}return{success:!0,lateFeesApplied:o.length}}catch(s){return console.error("Error applying late fees:",s),{success:!1,error:s.message}}}async getRecentCompletedMatches(t=10,r=null){try{let s=K.from("matches").select(`
          *,
          winner:users!matches_winner_id_fkey(first_name, last_name),
          loser:users!matches_loser_id_fkey(first_name, last_name)
        `).not("score","is",null).order("match_date",{ascending:!1}).limit(t);r&&r.length>0&&(s=s.or(`ladder_id.in.(${r.join(",")}),ladder_id.is.null`));const{data:a,error:o}=await s;if(o)throw o;return{success:!0,matches:a.map(l=>{var c,d,u,h,p,g,f,m,v,b,w,x;return{_id:l.id,winner:{_id:l.winner_id,firstName:((c=l.winner)==null?void 0:c.first_name)||((d=l.winner_name)==null?void 0:d.split(" ")[0])||"Unknown",lastName:((u=l.winner)==null?void 0:u.last_name)||((h=l.winner_name)==null?void 0:h.split(" ").slice(1).join(" "))||""},player1:{_id:l.winner_id,firstName:((p=l.winner)==null?void 0:p.first_name)||((g=l.winner_name)==null?void 0:g.split(" ")[0])||"Unknown",lastName:((f=l.winner)==null?void 0:f.last_name)||((m=l.winner_name)==null?void 0:m.split(" ").slice(1).join(" "))||""},player2:{_id:l.loser_id,firstName:((v=l.loser)==null?void 0:v.first_name)||((b=l.loser_name)==null?void 0:b.split(" ")[0])||"Unknown",lastName:((w=l.loser)==null?void 0:w.last_name)||((x=l.loser_name)==null?void 0:x.split(" ").slice(1).join(" "))||""},completedDate:l.match_date,gameType:l.game_type||"9-Ball",raceLength:l.race_length||"7",score:l.score||"N/A",ladderName:l.ladder_id,ladderDisplayName:l.ladder_id==="499-under"?"499 & Under":l.ladder_id==="500-549"?"500-549":l.ladder_id==="550-plus"?"550+":l.ladder_id}})}}catch(s){return console.error("Error getting recent completed matches:",s),{success:!1,error:s.message,matches:[]}}}async getPrizePoolData(t){try{console.log(" Supabase: Getting prize pool data for ladder:",t);const{data:r,error:s}=await K.from("matches").select("ladder_id").not("ladder_id","is",null);if(!s){const v=[...new Set(r.map(b=>b.ladder_id))];console.log(" Supabase: Available ladder_ids in matches:",v),console.log(" Supabase: Searching for ladder_id:",t),console.log(" Supabase: Does it match?",v.includes(t))}const a=new Date;a.setMonth(a.getMonth()-2),console.log(" Supabase: Looking for matches since:",a.toISOString());const{data:o,error:i}=await K.from("matches").select("status, ladder_id, match_date").eq("ladder_id",t);if(!i){const v=[...new Set(o.map(w=>w.status))];console.log(" Supabase: Available statuses for",t,":",v),console.log(" Supabase: Total matches for this ladder:",o.length);const b=o.filter(w=>w.status==="completed");console.log(" Supabase: Completed matches (all time):",b.length),b.length>0&&console.log(" Supabase: Completed match dates:",b.map(w=>w.match_date))}const{data:l,error:c}=await K.from("matches").select("id, score, match_date, ladder_id, status").eq("ladder_id",t).eq("status","completed").gte("match_date",a.toISOString());if(c)throw c;console.log(" Supabase: Found COMPLETED matches in last 2 months:",(l==null?void 0:l.length)||0,l);const d=(l==null?void 0:l.length)||0,u=d*3,h=new Date,p=h.getMonth(),g=Math.floor(p/2)*2,f=new Date(h.getFullYear(),g+2,1),m={success:!0,data:{currentPrizePool:u,totalMatches:d,nextDistribution:f.toISOString(),isEstimated:!1}};return console.log(" Supabase: Returning prize pool data:",m),m}catch(r){return console.error("Error getting prize pool data:",r),{success:!1,error:r.message}}}async getPrizePoolHistory(t){try{return{success:!0,data:[]}}catch(r){return console.error("Error getting prize pool history:",r),{success:!1,error:r.message}}}async getPrizePoolWinners(t){try{return{success:!0,data:[]}}catch(r){return console.error("Error getting prize pool winners:",r),{success:!1,error:r.message}}}async checkExistingPlayer(t,r,s=null){try{let a=K.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses
          ),
          league_profiles (
            id,
            division
          )
        `).ilike("first_name",t).ilike("last_name",r);const{data:o,error:i}=await a;if(i)throw i;let l=null;if(s){const{data:c}=await K.from("users").select("*").eq("email",s).maybeSingle();l=c}return{success:!0,hasExistingPlayers:o.length>0||!!l,foundPlayers:o,emailMatch:l,hasUnifiedAccount:!!l,showPlayerSelection:o.length>1,hasPartialMatch:o.length===1&&!l}}catch(a){return console.error("Error checking existing player:",a),{success:!1,error:a.message}}}async createNewPlayerSignup(t){var r,s,a,o,i;try{const{data:l,error:c}=await K.from("users").select("id, email, is_approved, is_active").eq("email",t.email.toLowerCase()).maybeSingle();if(c&&c.code!=="PGRST116")throw c;if(l)return{success:!1,error:"An account with this email already exists. Please use the login page or contact admin if you need help accessing your account."};const d=t.password&&t.password.length>=8?t.password:Math.random().toString(36).slice(-8)+"Aa1!",{data:u,error:h}=await K.auth.signUp({email:t.email.toLowerCase(),password:d,options:{emailRedirectTo:`${window.location.origin}/#/confirm-email`,data:{first_name:t.firstName,last_name:t.lastName}}});let p=!1;if(h){const b=((r=h.message)==null?void 0:r.toLowerCase())||"",w=h.code||"";if(b.includes("user already registered")||b.includes("email already exists")||b.includes("already registered")||w==="signup_disabled"||w==="user_already_exists")return{success:!1,error:"An account with this email already exists. Please use the login page or contact admin if you need help accessing your account."};if(b.includes("rate limit")||b.includes("too many")||b.includes("email"))console.warn(" Supabase email rate limit reached:",h.message),p=!0;else{let x=h.message;return b.includes("password")?x="Password requirements not met. Please contact admin for assistance.":b.includes("invalid")&&(x="Invalid email address. Please check your email and try again."),{success:!1,error:x}}}if(!u.user)throw p?new Error("Account creation may have been affected by email rate limits. Please try again in an hour or contact admin."):new Error("Failed to create user account");console.log(" Signup response (full):",JSON.stringify({user:{email:(s=u.user)==null?void 0:s.email,id:(a=u.user)==null?void 0:a.id,email_confirmed_at:(o=u.user)==null?void 0:o.email_confirmed_at,created_at:(i=u.user)==null?void 0:i.created_at},session:u.session?"Session created (email confirmation disabled)":"No session (email confirmation required)",needsConfirmation:!u.session,rateLimitReached:p,error:(h==null?void 0:h.message)||null},null,2)),u.session?console.warn(" Email confirmation appears to be DISABLED in Supabase settings. User can log in immediately."):u.user&&!u.user.email_confirmed_at?(console.log(" Email confirmation is ENABLED. User will receive confirmation email."),console.log(" Check email inbox for confirmation link.")):console.log(" User email already confirmed or confirmation disabled.");const{data:g,error:f}=await K.from("users").insert({id:u.user.id,email:t.email,first_name:t.firstName,last_name:t.lastName,phone:t.phone,is_pending_approval:!0,is_approved:!1,is_active:!1,created_at:new Date().toISOString()}).select().single();if(f)throw f;t.joinLadder&&await K.from("ladder_profiles").insert({user_id:u.user.id,ladder_name:t.ladderName||"499-under",position:999,fargo_rate:t.fargoRate||400,wins:0,losses:0,total_matches:0,is_active:!1});const m=t.password&&t.password.length>=8;let v="Signup successful! ";return p?(v+=" Due to email rate limits, your confirmation email may be delayed. ",v+="Your account has been created and is pending admin approval. ",v+=m?"You can log in with your email and password once approved (may take up to an hour).":"You'll receive a password setup email once approved (may take up to an hour due to rate limits)."):u.session?(v+="Your account has been created. It is pending admin approval. ",v+=m?"You can log in with your email and password once approved.":"You'll receive a password setup email once approved."):(v+="Please check your email and click the confirmation link. ",v+="After confirming your email, your account will be pending admin approval. ",v+=m?"You can then log in with your email and password once approved.":"You'll receive a password setup email once approved."),{success:!0,user:g,message:v,rateLimitReached:p}}catch(l){return console.error("Error creating new player signup:",l),{success:!1,error:l.message}}}async searchLadderPlayer(t,r){var s;try{const{data:a,error:o}=await K.from("ladder_profiles").select(`
          *,
          users!inner (
            id,
            first_name,
            last_name,
            email,
            is_approved,
            is_active
          )
        `).ilike("users.first_name",`%${t}%`).ilike("users.last_name",`%${r}%`);if(o)throw o;if(!a||a.length===0)return{success:!1,error:'No ladder player found with that name. Please check your spelling or choose "New User" instead.'};const i=`${t} ${r}`.toLowerCase(),c=a.find(g=>{var m,v;return`${((m=g.users)==null?void 0:m.first_name)||""} ${((v=g.users)==null?void 0:v.last_name)||""}`.toLowerCase()===i})||a[0],d=c.users,u=(d==null?void 0:d.email)&&(d.email.includes("@ladder.local")||d.email.includes("@example.com")||d.email.includes("placeholder")),h=(d==null?void 0:d.email)&&!u,p=h&&d.email.toLowerCase()===((s=claimData==null?void 0:claimData.email)==null?void 0:s.toLowerCase());return{success:!0,player:{_id:c.id,id:c.id,firstName:d.first_name,lastName:d.last_name,email:d.email,position:c.position,ladderName:c.ladder_name,fargoRate:c.fargo_rate,isClaimed:h,isClaimedBySamePerson:p,userId:d.id}}}catch(a){return console.error("Error searching ladder player:",a),{success:!1,error:a.message}}}async claimLadderPosition(t){var r;try{const s=await this.searchLadderPlayer(t.firstName,t.lastName);if(!s.success)return s;const a=s.player;if(a.isClaimed&&!a.isClaimedBySamePerson)return{success:!1,error:"This position has already been claimed by another player. Please contact admin if you believe this is an error."};if(a.isClaimedBySamePerson)return{success:!1,error:"You have already claimed this position. Please use the login page or contact admin if you need help accessing your account."};const{data:o,error:i}=await K.from("ladder_profiles").select("*, users(*)").eq("id",a.id).single();if(i)throw i;if(!o)throw new Error("Ladder position not found.");const l=o.users,c=(l==null?void 0:l.email)&&(l.email.includes("@ladder.local")||l.email.includes("@example.com")||l.email.includes("placeholder")),{data:d,error:u}=await K.from("users").select("id, email, is_approved, is_active").eq("email",t.email.toLowerCase()).maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(d&&!c)return d.id===l.id?{success:!1,error:"You have already claimed this position. Please use the login page or contact admin if you need help accessing your account."}:{success:!1,error:'This email is already registered. Please log in or use "Forgot Password".'};const h=o.user_id,p=Math.random().toString(36).slice(-8)+"Aa1!",{data:g,error:f}=await K.auth.signUp({email:t.email.toLowerCase(),password:p,options:{emailRedirectTo:`${window.location.origin}/#/confirm-email`,data:{first_name:t.firstName,last_name:t.lastName}}});if(f){const j=((r=f.message)==null?void 0:r.toLowerCase())||"",S=f.code||"";return j.includes("user already registered")||j.includes("email already exists")||j.includes("already registered")||S==="user_already_exists"?{success:!1,error:'This email is already registered. Please log in or use "Forgot Password".'}:{success:!1,error:f.message||"Failed to create account. Please try again."}}if(!(g!=null&&g.user))return{success:!1,error:"Failed to create user account. Please try again."};const m=g.user.id;c&&h&&h!==m&&await K.from("users").delete().eq("id",h);const{data:v,error:b}=await K.from("users").upsert({id:m,email:t.email.toLowerCase(),first_name:t.firstName,last_name:t.lastName,phone:t.phone||null,is_pending_approval:!0,is_approved:!1,is_active:!1,claim_message:t.message||null,created_at:new Date().toISOString()},{onConflict:"id"}).select().single();if(b)throw b;const{error:w}=await K.from("ladder_profiles").update({user_id:m}).eq("id",o.id);if(w)throw w;let x=" Claim submitted! ";return g.session?(x+="Your account has been created. It is pending admin approval. ",x+="You'll receive a password setup email once approved."):(x+="Please check your email and click the confirmation link. ",x+="After confirming your email, your claim will be pending admin approval. ",x+="You'll receive a password setup email once approved."),{success:!0,user:v,message:x}}catch(s){return console.error("Error claiming ladder position:",s),{success:!1,error:s.message}}}async claimLadderPositionWithOAuth(t){var r,s;try{const{data:a,error:o}=await K.from("ladder_profiles").select(`
          *,
          users!inner (id, first_name, last_name, email)
        `).ilike("users.first_name",`%${t.firstName}%`).ilike("users.last_name",`%${t.lastName}%`);if(o)throw o;const i=`${(t.firstName||"").trim()} ${(t.lastName||"").trim()}`.toLowerCase(),l=(a==null?void 0:a.find(f=>{var v,b;return`${((v=f.users)==null?void 0:v.first_name)||""} ${((b=f.users)==null?void 0:b.last_name)||""}`.trim().toLowerCase()===i}))||(a==null?void 0:a[0]);if(!l)throw new Error("Ladder position not found. Please check the spelling of your name.");const c=((r=l.users)==null?void 0:r.email)&&(l.users.email.includes("@ladder.local")||l.users.email.includes("@example.com"));if(((s=l.users)==null?void 0:s.email)&&!c&&l.users.email!==t.email)throw new Error("This position is already claimed by another email. If this is you, please contact admin.");c&&l.user_id!==t.userId&&await K.from("users").delete().eq("id",l.user_id);const{data:u}=await K.from("users").select("is_approved, is_active, is_admin").eq("id",t.userId).single(),h=u&&(u.is_admin===!0||u.is_admin==="true"||u.is_admin===1||u.is_approved===!0&&u.is_active===!0),p={phone:t.phone||null,claim_message:t.message||null};h||(p.is_pending_approval=!0,p.is_approved=!1,p.is_active=!1);const{error:g}=await K.from("users").update(p).eq("id",t.userId);if(g)throw g;return await K.from("ladder_profiles").update({user_id:t.userId}).eq("id",l.id),{success:!0,message:" Position claimed successfully! Your account is pending admin approval."}}catch(a){return console.error("Error claiming ladder position with OAuth:",a),{success:!1,error:a.message}}}async getPaymentStatus(t){var s,a,o,i,l,c;const r={hasMembership:!1,status:"inactive",isPromotionalPeriod:!1};try{const{data:d,error:u}=await K.from("payment_status").select("*").eq("email",t).single();if(u){if(u.code==="PGRST116")return d||r;if(u.code==="PGRST205"||u.code==="PGRST301"||(s=u.message)!=null&&s.includes("404")||(a=u.message)!=null&&a.includes("not find")||(o=u.message)!=null&&o.includes("payment_status"))return r;throw u}return d||r}catch(d){return(d==null?void 0:d.code)==="PGRST205"||(d==null?void 0:d.code)==="PGRST301"||((i=d==null?void 0:d.message)==null?void 0:i.includes("404"))||((l=d==null?void 0:d.message)==null?void 0:l.includes("payment_status"))||((c=d==null?void 0:d.message)==null?void 0:c.includes("not find"))||console.error("Error fetching payment status:",d),r}}async updateMatchStatus(t,r,s=null,a=null,o=null,i=null){try{const{data:l,error:c}=await K.from("matches").select("id, status, winner_id, winner_name, loser_id, loser_name, score, notes, match_date, match_type, game_type, race_length, location, created_at, challenge_id, league_id, ladder_id, winner_position, loser_position, verified_by, verified_at").eq("id",t).single();if(c)throw c;console.log(" Current match from database:",l);const d={status:r};if(r==="completed"&&s){const m=s.winnerId,v=l.winner_id,b=l.loser_id;if(console.log(" Match update logic:",{selectedWinnerId:m,currentPlayer1Id:v,currentPlayer2Id:b,currentPlayer1Name:l.winner_name,currentPlayer2Name:l.loser_name,needsSwap:m===b}),m===b)l.loser_id&&(d.winner_id=l.loser_id),l.loser_name&&(d.winner_name=String(l.loser_name)),l.winner_id&&(d.loser_id=l.winner_id),l.winner_name&&(d.loser_name=String(l.winner_name)),console.log(" Swapping: Selected winner was in loser field, moving to winner field");else if(m===v)l.winner_id&&(d.winner_id=l.winner_id),l.winner_name&&(d.winner_name=String(l.winner_name)),l.loser_id&&(d.loser_id=l.loser_id),l.loser_name&&(d.loser_name=String(l.loser_name)),console.log(" Selected winner already in winner field - no swap needed");else throw console.error(" Selected winner ID does not match either player!",{selectedWinnerId:m,currentPlayer1Id:v,currentPlayer2Id:b}),new Error("Selected winner does not match either player in the match");if(i)try{const w=new Date(i);isNaN(w.getTime())||(d.match_date=w.toISOString())}catch(w){console.error(" Invalid date format:",i,w)}a!=null&&a!==""&&(d.score=String(a)),o!=null&&o!==""&&(d.notes=String(o))}const u={};for(const[m,v]of Object.entries(d))v!=null&&m!=="updated_at"&&(u[m]=v);console.log(" Sending update to Supabase:",u),console.log(" Update data JSON stringified:",JSON.stringify(u));const{error:h}=await K.from("matches").update(u).eq("id",t);if(h)throw console.error(" Supabase update error details:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;console.log(" Update successful, fetching updated match...");let p=null;const{data:g,error:f}=await K.from("matches").select("id, status, winner_id, winner_name, loser_id, loser_name, score, notes, match_date, match_type, game_type, race_length, location, created_at, challenge_id, league_id, ladder_id, winner_position, loser_position, verified_by, verified_at").eq("id",t).maybeSingle();if(f){console.warn(" Could not fetch updated match, but update was successful:",{message:f.message,details:f.details,hint:f.hint,code:f.code});const{updated_at:m,...v}=l||{};p={...v,...u,id:t},console.log(" Using constructed match data:",p)}else p=g,console.log(" Successfully fetched updated match:",p);if(r==="completed"&&p){console.log(" Match completed - starting ladder updates..."),console.log(" Match data:",{winner_id:p.winner_id,loser_id:p.loser_id,match_type:p.match_type});const m=String(p.winner_id),v=String(p.loser_id);console.log(" Looking up ladder profiles with IDs:",{winnerId:m,loserId:v});const{data:b,error:w}=await K.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",m).maybeSingle(),{data:x,error:j}=await K.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",v).maybeSingle();if(console.log(" Ladder profile lookup:",{winnerProfile:b,winnerProfileError:w,loserProfile:x,loserProfileError:j}),!b||!x){console.error(" Could not find ladder profiles for position updates",{winnerFound:!!b,loserFound:!!x,winnerId:p.winner_id,loserId:p.loser_id});try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success&&console.log(" Winner stats updated (no profile found for positions)")}catch(_){console.error(" Error updating winner stats (no profile):",_)}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success&&console.log(" Loser stats updated (no profile found for positions)")}catch(_){console.error(" Error updating loser stats (no profile):",_)}return{success:!0,data:p}}if(b.ladder_name!==x.ladder_name){console.log(" Players on different ladders - no position updates",{winnerLadder:b.ladder_name,loserLadder:x.ladder_name});try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success&&console.log(" Winner stats updated (different ladders)")}catch(_){console.error(" Error updating winner stats (different ladders):",_)}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success&&console.log(" Loser stats updated (different ladders)")}catch(_){console.error(" Error updating loser stats (different ladders):",_)}return{success:!0,data:p}}try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success?console.log(" Winner stats updated successfully"):console.error(" Winner stats update returned failure:",_)}catch(_){console.error(" Error updating winner stats:",_),console.error(" Match was completed but winner stats may not have been updated")}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success?console.log(" Loser stats updated successfully"):console.error(" Loser stats update returned failure:",_)}catch(_){console.error(" Error updating loser stats:",_),console.error(" Match was completed but loser stats may not have been updated")}const S=p.match_type||"challenge";console.log(` Updating ladder positions for match type: ${S}`),console.log(`   Winner: ${b.user_id} at position #${b.position}`),console.log(`   Loser: ${x.user_id} at position #${x.position}`);try{const _=await this.updateLadderPositions(S,p.winner_id,p.loser_id,b,x);console.log(" Position update result:",_)}catch(_){console.error(" Error updating ladder positions:",_)}try{const{error:_}=await K.from("ladder_profiles").update({immunity_until:new Date(Date.now()+6048e5).toISOString()}).eq("user_id",p.winner_id);_?console.error(" Error setting immunity:",_):console.log(" Immunity set for winner")}catch(_){console.error(" Error setting immunity:",_)}}return{success:!0,data:p}}catch(l){return console.error("Error updating match status:",l),{success:!1,error:l.message}}}async updateLadderPositions(t,r,s,a,o){try{const i=a.position,l=o.position,c=a.ladder_name;if(console.log(` Processing position updates for ${t} match`),console.log(`   Winner: #${i}, Loser: #${l}`),t==="fast-track"||t==="reverse-fast-track")if(i>l){console.log(` Fast Track: Challenger won! Winner inserting at position #${l}`),console.log(`   Winner at #${i}, Defender at #${l}`),console.log(" Calling reindexLadder with:",[{userId:r,newPosition:l},{userId:s,newPosition:l+1}]);try{await this.reindexLadder(c,[{userId:r,newPosition:l},{userId:s,newPosition:l+1}]),console.log(" reindexLadder completed successfully")}catch(d){throw console.error(" reindexLadder failed:",d),d}console.log(` Fast Track complete: Winner inserted at #${l}, Defender moved to #${l+1}`)}else console.log(" Fast Track: Defender won - no position changes needed");else if(t==="smackdown")if(i<l){console.log(" SmackDown: Challenger won - applying full ladder re-index"),console.log(`   Challenger at #${i}, Defender at #${l}`);const d=Math.max(i-2,2),u=l+3;console.log(`   Target: Challenger #${i}#${d}, Defender #${l}#${u}`),await this.reindexLadder(c,[{userId:r,newPosition:d},{userId:s,newPosition:u}]),console.log(" SmackDown complete with full re-index")}else{console.log(" SmackDown: Challenger lost - swapping positions"),await this.swapPositions(r,s,i,l);const d=new Date(Date.now()+7*24*60*60*1e3);await K.from("ladder_profiles").update({smackback_eligible_until:d.toISOString()}).eq("user_id",r),console.log(` SmackBack eligibility granted to defender until ${d.toLocaleDateString()}`)}else t==="smackback"?i>1?(console.log(" SmackBack: Moving winner to 1st place with full re-index"),console.log(`   Winner currently at #${i}`),await this.reindexLadder(c,[{userId:r,newPosition:1}]),await K.from("ladder_profiles").update({smackback_eligible_until:null}).eq("user_id",r),console.log(" SmackBack complete: Winner now at #1, eligibility cleared")):(console.log(" SmackBack: Defender wins, no position change"),await K.from("ladder_profiles").update({smackback_eligible_until:null}).eq("user_id",s)):i>l?(console.log(" Challenge: Challenger won - swapping positions"),await this.swapPositions(r,s,i,l)):console.log(" Challenge: Defender wins, no position change");return{success:!0}}catch(i){return console.error("Error updating ladder positions:",i),{success:!1,error:i.message}}}async swapPositions(t,r,s,a){console.log(` Swapping positions: Player1 (#${s})  Player2 (#${a})`);const{error:o}=await K.from("ladder_profiles").update({position:a}).eq("user_id",t);if(o)throw console.error(" Error updating player1 position:",o),o;const{error:i}=await K.from("ladder_profiles").update({position:s}).eq("user_id",r);if(i)throw console.error(" Error updating player2 position:",i),i;console.log(` Positions swapped: #${s}  #${a}`)}async reindexLadder(t,r){try{console.log(" Starting full ladder re-index");const{data:s}=await K.from("ladder_profiles").select("user_id, position").eq("ladder_name",t).order("position");if(!s||s.length===0){console.log("No players found for re-indexing");return}const a=[];for(const c of s){const d=r.find(u=>u.userId===c.user_id);if(d){const u=d.newPosition>s.length?999:d.newPosition;a.push({userId:c.user_id,oldPosition:c.position,targetPosition:d.newPosition,sortValue:u}),console.log(`   Player moving: #${c.position}  #${d.newPosition} (sortValue: ${u})`)}else a.push({userId:c.user_id,oldPosition:c.position,targetPosition:null,sortValue:c.position+.5})}a.sort((c,d)=>c.sortValue-d.sortValue);for(let c=0;c<a.length;c++)a[c].targetPosition&&console.log(`   #${c+1}: Player (was #${a[c].oldPosition}, targeted #${a[c].targetPosition})`);const o=a.map((c,d)=>K.from("ladder_profiles").update({position:d+1}).eq("user_id",c.userId));console.log(` Executing ${o.length} position updates...`);const i=await Promise.all(o),l=i.filter(c=>c.error);if(l.length>0)throw console.error(" Errors in position updates:",l),new Error(`Failed to update ${l.length} positions`);console.log(` All ${i.length} position updates completed successfully`),console.log(" Ladder re-index complete")}catch(s){throw console.error("Error re-indexing ladder:",s),s}}async updatePlayerMatchStats(t,r){try{const s=String(t);console.log(` Updating player match stats for user: ${s}, isWin: ${r}`);const{data:a,error:o}=await K.from("ladder_profiles").select("wins, losses, total_matches, user_id").eq("user_id",s).maybeSingle();if(o)throw console.error(" Error fetching player profile for stats update:",o),new Error(`Failed to fetch profile: ${o.message}`);if(!a)throw console.error(` No ladder profile found for user_id: ${s}`),new Error(`No ladder profile found for user: ${s}`);console.log(` Current stats for user ${s}:`,{wins:a.wins,losses:a.losses,total_matches:a.total_matches});const i=a.wins||0,l=a.losses||0,c=a.total_matches||0,d={wins:r?i+1:i,losses:r?l:l+1,total_matches:c+1};console.log(` New stats for user ${s}:`,d);const{error:u,data:h}=await K.from("ladder_profiles").update(d).eq("user_id",s).select();if(u)throw console.error(" Error updating stats in database:",u),new Error(`Failed to update stats: ${u.message}`);return console.log(` Successfully updated stats for user ${s}`),{success:!0}}catch(s){throw console.error(" Error updating player match stats:",s),s}}async deleteMatch(t){try{const{error:r}=await K.from("matches").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting match:",r),{success:!1,error:r.message}}}async updateMatch(t,r){try{const{data:s,error:a}=await K.from("matches").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating match:",s),{success:!1,error:s.message}}}async checkSmackBackEligibility(t){try{const{data:r,error:s}=await K.from("ladder_profiles").select("smackback_eligible_until").eq("user_id",t).single();if(s)throw s;if(!r||!r.smackback_eligible_until)return{eligible:!1,reason:"No SmackBack eligibility"};const a=new Date(r.smackback_eligible_until),o=new Date;if(o>a)return{eligible:!1,reason:"SmackBack eligibility expired"};const i=Math.ceil((a-o)/(1e3*60*60*24));return{eligible:!0,eligibleUntil:a,daysRemaining:i}}catch(r){return console.error("Error checking SmackBack eligibility:",r),{eligible:!1,reason:"Error checking eligibility"}}}async createMatch(t){try{if(t.matchType==="smackback"){const h=await this.checkSmackBackEligibility(t.player1Id);if(!h.eligible)return console.log(` SmackBack validation failed: ${h.reason}`),{success:!1,error:`SmackBack not allowed: ${h.reason}. Defender must have won a SmackDown within the last 7 days.`};console.log(` SmackBack eligibility verified (${h.daysRemaining} days remaining)`)}const r=await this.getUserById(t.player1Id),s=await this.getUserById(t.player2Id);if(!r.success||!s.success)throw new Error("Could not find player information");const a=`${r.data.first_name} ${r.data.last_name}`,o=`${s.data.first_name} ${s.data.last_name}`,{data:{user:i},error:l}=await K.auth.getUser();if(l||!i)throw console.error(" Authentication error:",l),new Error("User not authenticated. Please log in again.");console.log(" User authenticated:",i.id);const c={ladder_id:t.ladderName,winner_id:t.player1Id,winner_name:a,loser_id:t.player2Id,loser_name:o,match_date:t.matchDate,location:t.location||null,notes:t.notes||null,race_length:t.raceLength||5,game_type:t.gameType||"9-ball",match_type:t.matchType||"challenge",status:"scheduled"};console.log(" Attempting to insert match:",c);const{data:d,error:u}=await K.from("matches").insert(c).select().single();if(u)throw console.error(" Supabase insert error:",u),console.error(" Error code:",u.code),console.error(" Error message:",u.message),console.error(" Error details:",u.details),console.error(" Error hint:",u.hint),u;return console.log(" Match created successfully:",d),{success:!0,data:d}}catch(r){console.error(" Error creating match:",r);const s=r.message||r.toString();return console.error(" Full error:",r),{success:!1,error:s}}}async getScheduledMatches(t=null){try{let r=K.from("matches").select("*").in("status",["scheduled","completed"]).order("match_date",{ascending:!0});t&&(r=r.eq("ladder_id",t));const{data:s,error:a}=await r;if(a)throw a;return{success:!0,matches:s||[]}}catch(r){return console.error("Error fetching scheduled matches:",r),{success:!1,matches:[],error:r.message}}}async registerPlayer(t){try{const{firstName:r,lastName:s,email:a,phone:o,fargoRate:i,location:l,isActive:c,ladderName:d}=t;let{data:u,error:h}=await K.from("users").select("id").eq("email",a).single(),p;if(h&&h.code!=="PGRST116")throw h;if(u){const{data:m}=await K.from("ladder_profiles").select("*").eq("user_id",u.id).eq("ladder_name",d).single();if(m)return{success:!1,error:"Player is already registered on this ladder"};p=u.id}else{const{data:m,error:v}=await K.from("users").insert({first_name:r,last_name:s,email:a,phone:o||null,is_active:!1,is_pending_approval:!0}).select().single();if(v)throw v;p=m.id}const{data:g,error:f}=await K.from("ladder_profiles").insert({user_id:p,ladder_name:d,position:null,wins:0,losses:0,total_matches:0,is_active:!1,fargo_rate:i?parseInt(i):null}).select().single();if(f)throw f;return{success:!0,message:"Application submitted successfully! Awaiting admin approval.",data:g}}catch(r){return console.error("Error registering player:",r),{success:!1,error:r.message}}}async quickAddPlayerToLadder(t){try{const{firstName:r,lastName:s,email:a,phone:o,fargoRate:i,location:l,ladderName:c,position:d,notes:u}=t;let{data:h,error:p}=await K.from("users").select("id").eq("email",a).single(),g;if(p&&p.code!=="PGRST116")throw p;if(h)g=h.id;else{const{data:w,error:x}=await K.from("users").insert({first_name:r,last_name:s,email:a,phone:o||null}).select().single();if(x)throw x;g=w.id}const{data:f}=await K.from("ladder_profiles").select("*").eq("user_id",g).eq("ladder_name",c).single();if(f)return{success:!1,error:"Player is already on this ladder"};let m=d?parseInt(d):null;if(m)await K.from("ladder_profiles").update({position:K.rpc("increment",{x:1})}).eq("ladder_name",c).gte("position",m);else{const{data:w}=await K.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1);m=(w&&w.length>0?w[0].position:0)+1}const{data:v,error:b}=await K.from("ladder_profiles").insert({user_id:g,ladder_name:c,position:m,wins:0,losses:0,total_matches:0,is_active:!0,fargo_rate:i?parseInt(i):null}).select().single();if(b)throw b;return{success:!0,message:`Player added to ${c} ladder at position #${m}`,data:v}}catch(r){return console.error("Error quick adding player:",r),{success:!1,error:r.message}}}async updatePlayer(t,r){try{const{email:s,firstName:a,lastName:o,fargoRate:i,position:l,ladderName:c,isActive:d,sanctioned:u,sanctionYear:h,lmsName:p,currentLadderName:g}=r,f={};if(a&&(f.first_name=a),o&&(f.last_name=o),s&&(f.email=s),Object.keys(f).length>0){const{error:v}=await K.from("users").update(f).eq("id",t);if(v)throw v}if(console.log(` Debug updatePlayer: ladderName=${c}, currentLadderName=${g}`),c&&g&&c!==g){console.log(` Transferring player from ${g} to ${c}`);const{data:v}=await K.from("ladder_profiles").select("*").eq("user_id",t).eq("ladder_name",g).single();if(v){console.log(" Current profile found:",v);const{error:b}=await K.from("ladder_profiles").delete().eq("user_id",t).eq("ladder_name",g);if(b)throw b;console.log(` Deleted from old ladder: ${g}`),v.position&&await K.from("ladder_profiles").update({position:K.rpc("decrement",{x:1})}).eq("ladder_name",g).gt("position",v.position);const{data:w}=await K.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1),j=(w&&w.length>0?w[0].position:0)+1,S={user_id:t,ladder_name:c,position:j,wins:v.wins||0,losses:v.losses||0,total_matches:v.total_matches||0,is_active:d!==void 0?d:v.is_active,fargo_rate:i!==void 0?i?parseInt(i):null:v.fargo_rate,sanctioned:u!==void 0?u:v.sanctioned,sanction_year:h!==void 0?h:v.sanction_year,lms_name:p!==void 0?p:v.lms_name};console.log(" Creating new profile with data:",S);const{data:_,error:C}=await K.from("ladder_profiles").insert(S).select().single();if(C)throw console.error(" Error creating new profile:",C),C;return console.log(" Successfully created new profile:",_),{success:!0,message:`Player transferred from ${g} to ${c} successfully`}}else throw console.error(` Current profile not found for user ${t} on ladder ${g}`),new Error(`Player profile not found on ${g} ladder`)}const m={};if(d!==void 0&&(m.is_active=d),i!==void 0&&(m.fargo_rate=i?parseInt(i):null),l!==void 0&&(m.position=l?parseInt(l):null),u!==void 0&&(m.sanctioned=u),h!==void 0&&(m.sanction_year=h),p!==void 0&&(m.lms_name=p),Object.keys(m).length>0&&c){const{error:v}=await K.from("ladder_profiles").update(m).eq("user_id",t).eq("ladder_name",c);if(v)throw v}return{success:!0,message:"Player updated successfully"}}catch(s){return console.error("Error updating player:",s),{success:!1,error:s.message,message:s.message}}}async removePlayerFromLadder(t,r){try{const{data:s,error:a}=await K.from("users").select("id").eq("email",t).single();if(a)throw a;if(!s)return{success:!1,error:"User not found",message:"User not found"};const{data:o}=await K.from("ladder_profiles").select("position").eq("user_id",s.id).eq("ladder_name",r).single(),{error:i}=await K.from("ladder_profiles").delete().eq("user_id",s.id).eq("ladder_name",r);if(i)throw i;if(o!=null&&o.position){const{data:l,error:c}=await K.from("ladder_profiles").select("id, position").eq("ladder_name",r).gt("position",o.position).order("position",{ascending:!0});if(!c&&l){for(const d of l)await K.from("ladder_profiles").update({position:d.position-1}).eq("id",d.id);console.log(` Renumbered ${l.length} players to fill the gap`)}}return{success:!0,message:"Player removed from ladder successfully"}}catch(s){return console.error("Error removing player from ladder:",s),{success:!1,error:s.message,message:s.message}}}};const mt=new LO;class BO{constructor(){this.backendUrl=Ie,this.currentAdmin=null,this._authenticated=!1}async authenticateAdmin(t,r){try{console.log(" Authenticating admin:",t);const s=await fetch(`${this.backendUrl}/api/platform/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,pin:r})});if(!s.ok){const o=await s.json();throw new Error(o.message||"Authentication failed")}const a=await s.json();if(a.success&&a.admin)return this.currentAdmin=a.admin,this._authenticated=!0,localStorage.setItem("adminData",JSON.stringify(a.admin)),localStorage.setItem("isAdminAuthenticated","true"),a.token&&(localStorage.setItem("authToken",a.token),console.log(" JWT token stored for unified authentication")),console.log(" Admin authenticated:",a.admin.email,"Role:",a.admin.role),a.admin;throw new Error("Invalid response from server")}catch(s){throw console.error(" Admin authentication failed:",s),this.currentAdmin=null,this._authenticated=!1,s}}async isSuperAdmin(t,r){try{const s=await this.authenticateAdmin(t,r);return s&&s.role==="super_admin"}catch(s){return console.log(" User is not a super admin:",s.message),!1}}async isAdmin(t,r){try{console.log(" Checking admin status for:",t),console.log(" UserPin received:",r);const s=await mt.getUserByEmail(t);if(console.log(" Supabase query result:",s),s.success&&s.data){const a=s.data.is_admin===!0;return console.log(" Admin check result:",{email:t,isAdmin:a,isAdminValue:s.data.is_admin,isAdminType:typeof s.data.is_admin,userData:s.data}),a}else return console.log(" User not found in Supabase:",s.error),!1}catch(s){return console.log(" Admin check failed:",s.message),!1}}getCurrentAdmin(){if(this.currentAdmin)return this.currentAdmin;const t=localStorage.getItem("adminData"),r=localStorage.getItem("isAdminAuthenticated")==="true";if(t&&r)try{return this.currentAdmin=JSON.parse(t),this._authenticated=!0,this.currentAdmin}catch(s){console.error("Error parsing stored admin data:",s),this.logout()}return null}hasPermission(t){const r=this.getCurrentAdmin();return!r||!r.permissions?!1:r.permissions[t]===!0}isSuperAdminRole(){const t=this.getCurrentAdmin();return t&&t.role==="super_admin"}logout(){this.currentAdmin=null,this._authenticated=!1,localStorage.removeItem("adminData"),localStorage.removeItem("isAdminAuthenticated"),localStorage.removeItem("authToken"),console.log(" Admin logged out")}isAuthenticated(){return this._authenticated&&this.getCurrentAdmin()!==null}}const Bi=new BO,zw="/assets/ball9-2871736f.jpg",Fw="/assets/ball10-34ff6420.jpg";function Nb({open:n,onClose:t,player1:r,player2:s,onSelect:a}){return n?e.jsxs(It,{open:n,onClose:t,title:"Who won?",maxWidth:"340px",children:[e.jsx("div",{style:{textAlign:"center",marginBottom:18,color:"#fff",fontSize:"1.1em"},children:"Please select the winner:"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,alignItems:"center"},children:[e.jsx("button",{style:{background:"#23232a",color:"#28a745",border:"2px solid #28a745",borderRadius:8,padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",minWidth:"160px"},onClick:()=>a(r),children:r}),e.jsx("button",{style:{background:"#23232a",color:"#e53e3e",border:"2px solid #e53e3e",borderRadius:8,padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",minWidth:"160px"},onClick:()=>a(s),children:s})]}),e.jsx("button",{style:{marginTop:24,background:"#6c757d",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px",display:"block",marginLeft:"auto",marginRight:"auto"},onClick:t,children:"Cancel"})]}):null}const OO=Ie;class Tn{static async request(t,r={}){const s=`${OO}${t}`,a={headers:{"Content-Type":"application/json",Accept:"application/json",...r.headers},signal:AbortSignal.timeout(3e4),credentials:"include",mode:"cors",...r},o=3;let i;for(let l=1;l<=o;l++)try{console.log(`API Request (attempt ${l}): ${s}`);const c=await fetch(s,a);if(!c.ok)throw new Error(`API Error: ${c.status} - ${c.statusText}`);const d=await c.json();return console.log(`API Success: ${s}`),d}catch(c){if(i=c,console.warn(`API Request failed (attempt ${l}/${o}): ${s}`,c),c.message.includes("400")||c.message.includes("401")||c.message.includes("403")||c.message.includes("404"))break;if(l<o){const d=Math.min(1e3*Math.pow(2,l-1),5e3);await new Promise(u=>setTimeout(u,d))}}throw console.error(`API Request failed after ${o} attempts: ${s}`,i),i}static get(t){return this.request(t)}static post(t,r){return this.request(t,{method:"POST",body:JSON.stringify(r)})}static patch(t,r){return this.request(t,{method:"PATCH",body:JSON.stringify(r)})}static delete(t){return this.request(t,{method:"DELETE"})}static async testConnection(){try{const t=await this.get("/health");return console.log("Backend connection test successful:",t),!0}catch(t){return console.error("Backend connection test failed:",t),!1}}}const ra={async getPendingProposals(n,t){return Tn.get(`/api/proposals/by-name?receiverName=${encodeURIComponent(n)}&division=${encodeURIComponent(t)}`)},async getSentProposals(n,t){return Tn.get(`/api/proposals/by-sender?senderName=${encodeURIComponent(n)}&division=${encodeURIComponent(t)}`)},async updateProposalStatus(n,t,r){return Tn.patch(`/api/proposals/${n}/status`,{status:t,note:r})},async createProposal(n){return Tn.post("/api/proposals",n)},async counterProposal(n,t){return Tn.patch(`/api/proposals/${n}/counter`,t)},async markCompleted(n,t,r,s){return Tn.patch(`/api/matches/completed/${n}`,{winner:t,markedByName:r,markedByEmail:s})},async cancelProposal(n){return Tn.post(`/api/proposals/${n}/cancel`)},async getAllProposals(n){const t=n?`?division=${encodeURIComponent(n)}`:"";return Tn.get(`/api/proposals/debug-list${t}`)}};function zO(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function FO({open:n,onClose:t,match:r,onCompleted:s,userPin:a,onMatchUpdated:o,senderName:i,senderEmail:l}){const[c,d]=y.useState({x:0,y:0}),[u,h]=y.useState(!1),p=y.useRef({x:0,y:0}),g=T=>{h(!0),p.current={x:T.clientX-c.x,y:T.clientY-c.y},document.body.style.userSelect="none"},f=T=>{u&&d({x:T.clientX-p.current.x,y:T.clientY-p.current.y})},m=()=>{h(!1),document.body.style.userSelect=""};y.useEffect(()=>(u?(window.addEventListener("mousemove",f),window.addEventListener("mouseup",m)):(window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}),[u]);const[v,b]=y.useState(!1),[w,x]=y.useState(!1),[j,S]=y.useState({player1:"",player2:""}),[_,C]=y.useState(r);y.useEffect(()=>{C(r)},[r]);const N=()=>{let T=r.player||r.senderName,A=r.opponent||r.receiverName;S({player1:T,player2:A}),x(!0)},M=async T=>{x(!1),b(!0);const A=i&&i.trim()?i:_.player||_.senderName||"Unknown",k=l&&l.trim()?l:_.senderEmail||"unknown@example.com";console.log("Marking winner with:",{winner:T,markedByName:A,markedByEmail:k});try{const R=await ra.markCompleted(_._id,T,A,k);R&&R.proposal?(C(R.proposal),o&&o(R.proposal)):(C({..._,winner:T}),o&&o({..._,winner:T})),s&&s(_._id)}catch{alert("Failed to mark as completed.")}b(!1)};if(!n||!_)return null;let E=new Date,P="",D="";if(_.date&&_.time){const[T,A,k]=_.date.split("-"),R=`${T}-${A.padStart(2,"0")}-${k.padStart(2,"0")}`;let U=_.time.trim().toUpperCase(),[z,$]=U.split(" "),[W,Y]=z.split(":").map(Number);$==="PM"&&W<12&&(W+=12),$==="AM"&&W===12&&(W=0);const Q=W.toString().padStart(2,"0"),H=(Y||0).toString().padStart(2,"0"),ue=`${Q}:${H}`;E=new Date(`${R}T${ue}:00`),P=zO(_.date),D=E.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})}return e.jsx("div",{className:lr.modalOverlay,onClick:t,children:e.jsxs("div",{className:lr.modalContentSnazzy,style:{transform:`translate(${c.x}px, ${c.y}px)`,cursor:u?"grabbing":"default"},onClick:T=>T.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Match Details",tabIndex:-1,children:[e.jsx("button",{className:lr.modalCloseBtnSnazzy,onClick:t,"aria-label":"Close",children:""}),e.jsxs("div",{className:lr.modalHeaderSnazzy,onMouseDown:g,style:{cursor:"grab",userSelect:"none"},children:[e.jsx("span",{className:lr.modalAccentBar}),e.jsx("h2",{className:lr.modalTitleSnazzy,children:" Match Details"})]}),e.jsxs("div",{className:lr.modalDetailsSnazzy,children:[e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[e.jsx("span",{className:lr.modalDetailIcon,children:""}),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Players:"}),e.jsxs("span",{className:lr.modalDetailValueSnazzy,children:[e.jsx("span",{className:lr.modalOpponentName,children:_.player||_.senderName}),e.jsx("span",{className:lr.modalVs,children:"vs"}),e.jsx("span",{className:lr.modalOpponentName,children:_.opponent||_.receiverName})]})]}),e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[e.jsx("span",{className:lr.modalDetailIcon,children:""}),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Date:"}),e.jsx("span",{className:lr.modalDetailValueSnazzy,children:P})]}),e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[e.jsx("span",{className:lr.modalDetailIcon,children:""}),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Time:"}),e.jsx("span",{className:lr.modalDetailValueSnazzy,children:D})]}),e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[e.jsx("span",{className:lr.modalDetailIcon,children:""}),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Location:"}),e.jsx("span",{className:lr.modalDetailValueSnazzy,children:_.location})]}),_.gameType&&e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[WO(_.gameType),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Game Type:"}),e.jsx("span",{className:lr.modalDetailValueSnazzy,children:_.gameType})]}),_.raceLength&&e.jsxs("div",{className:lr.modalDetailRowSnazzy,children:[e.jsx("span",{className:lr.modalDetailIcon,children:""}),e.jsx("span",{className:lr.modalDetailLabelSnazzy,children:"Race to:"}),e.jsx("span",{className:lr.modalDetailValueSnazzy,children:_.raceLength})]}),_.winner&&e.jsxs("div",{style:{color:"#ffd700",fontWeight:700,marginTop:6,fontSize:"1em"},children:[" Winner: ",_.winner,Bi.getCurrentAdmin()&&_.winnerChangedByName&&e.jsxs("span",{style:{color:"#aaa",fontWeight:400,fontSize:"0.95em",marginLeft:8},children:["(marked by ",_.winnerChangedByName,_.winnerChangedAt?` on ${new Date(_.winnerChangedAt).toLocaleString()}`:"",")"]})]})]}),!_.completed&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:lr.modalActionBtn,onClick:N,disabled:v,style:{marginTop:16,minWidth:180},type:"button",children:v?"Marking...":"Mark as Completed"}),e.jsx(Nb,{open:w,onClose:()=>x(!1),player1:j.player1,player2:j.player2,onSelect:M})]})]})})}function WO(n){if(!n)return e.jsx("span",{className:lr.modalDetailIcon,children:""});const t=n.trim().toLowerCase();return t==="8 ball"||t==="8-ball"||t==="8ball"?e.jsx("img",{src:jm,alt:"8 Ball",className:lr.gameTypeIcon}):t==="9 ball"||t==="9-ball"||t==="9ball"?e.jsx("img",{src:zw,alt:"9 Ball",className:lr.gameTypeIcon}):t==="10 ball"||t==="10-ball"||t==="10ball"?e.jsx("img",{src:Fw,alt:"10 Ball",className:lr.gameTypeIcon}):t==="mixed"||t==="mixed games"?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:jm,alt:"8 Ball",className:lr.gameTypeIcon}),e.jsx("img",{src:zw,alt:"9 Ball",className:lr.gameTypeIcon}),e.jsx("img",{src:Fw,alt:"10 Ball",className:lr.gameTypeIcon})]}):e.jsx("span",{className:lr.modalDetailIcon,children:""})}const UO="_modalOverlay_1gl2k_19",qO="_proposalListModalContent_1gl2k_39",HO="_modalBounceIn_1gl2k_1",YO="_proposalModalTitle_1gl2k_79",GO="_proposalModalCloseBtn_1gl2k_101",VO="_proposalList_1gl2k_39",KO="_proposalCardButton_1gl2k_169",JO="_proposalCardLabel_1gl2k_211",XO="_proposalCardMessage_1gl2k_223",QO="_modalContent_1gl2k_277",ZO="_confirmDialogOverlay_1gl2k_319",e9="_confirmDialogBox_1gl2k_345",as={modalOverlay:UO,proposalListModalContent:qO,modalBounceIn:HO,proposalModalTitle:YO,proposalModalCloseBtn:GO,proposalList:VO,proposalCardButton:KO,proposalCardLabel:JO,proposalCardMessage:XO,modalContent:QO,confirmDialogOverlay:ZO,confirmDialogBox:e9};function Ww(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function t9(n){if(!n)return"N/A";if(n.includes(":")&&n.length===5){const[t,r]=n.split(":"),s=parseInt(t),a=s>=12?"PM":"AM";return`${s===0?12:s>12?s-12:s}:${r} ${a}`}return n}function Uw({proposals:n,onSelect:t,onClose:r,type:s="received",isAdmin:a=!1,senderEmail:o,senderName:i,onProposalUpdated:l}){console.log("Proposals:",n);const[c,d]=y.useState(null),[u,h]=y.useState(!1),[p,g]=y.useState(""),[f,m]=y.useState(n),[v,b]=y.useState("all"),w=n.filter(k=>k.isCounter),x=n.filter(k=>!k.isCounter),j=v==="counter"?w:x,[S,_]=y.useState(!1),[C,N]=y.useState(null),[M,E]=y.useState({player1:"",player2:""}),[P,D]=y.useState(!1),T=async k=>{h(!0),g("");try{await ra.cancelProposal(k),m(R=>R.filter(U=>U._id!==k)),d(null)}catch{g("Failed to cancel proposal. Please try again.")}finally{h(!1)}},A=s==="completed"?f:n;return e.jsxs(It,{open:!0,onClose:r,title:s==="completed"?"Completed Matches":s==="sent"?"Matches You Proposed":"Pending Match Proposals",maxWidth:"600px",children:[e.jsxs("div",{className:as.modalContent,style:{position:"relative",maxHeight:"none",overflowY:"visible"},children:[s!=="completed"&&e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16},children:[e.jsxs("button",{onClick:()=>b("all"),style:{background:v==="all"?"#e53e3e":"#333",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",boxShadow:v==="all"?"0 2px 8px #e53e3e44":"none",position:"relative"},children:["All Proposals (",x.length,")",x.length>0&&e.jsx("span",{style:{background:"#fff",color:"#e53e3e",borderRadius:"50%",padding:"2px 8px",fontSize:"0.85em",fontWeight:"bold",marginLeft:8,position:"absolute",top:"-8px",right:"-12px",minWidth:24,textAlign:"center",boxShadow:"0 1px 4px #0002"},children:x.length})]}),e.jsxs("button",{onClick:()=>b("counter"),style:{background:v==="counter"?"#ff9800":"#333",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",boxShadow:v==="counter"?"0 2px 8px #ff980044":"none",position:"relative"},children:["Counter Proposals (",w.length,")",w.length>0&&e.jsx("span",{style:{background:"#fff",color:"#ff9800",borderRadius:"50%",padding:"2px 8px",fontSize:"0.85em",fontWeight:"bold",marginLeft:8,position:"absolute",top:"-8px",right:"-12px",minWidth:24,textAlign:"center",boxShadow:"0 1px 4px #0002"},children:w.length})]})]}),e.jsx("ul",{className:as.proposalList,style:{listStyle:"none",padding:0,margin:0},children:s==="completed"?A.map(k=>e.jsx("li",{style:{position:"relative",marginBottom:12},children:e.jsxs("div",{className:as.proposalCardButton,style:{cursor:"default",background:"#23232a",color:"#28a745",border:"2px solid #28a745",borderRadius:8,padding:"1rem",fontWeight:600},children:[e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Opponent:"})," ",k.opponent||k.receiverName||k.senderName]}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Date:"})," ",Ww(k.date),"  ",e.jsx("span",{className:as.proposalCardLabel,children:"Time:"})," ",k.time]}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Location:"})," ",k.location]}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Game Type:"})," ",k.gameType]}),k.winner&&e.jsxs("div",{style:{color:"#ffd700",fontWeight:700,marginTop:6,fontSize:"1em"},children:[" Winner: ",k.winner,a&&k.winnerChangedByName&&e.jsxs("span",{style:{color:"#aaa",fontWeight:400,fontSize:"0.95em",marginLeft:8},children:["(marked by ",k.winnerChangedByName,k.winnerChangedAt?` on ${new Date(k.winnerChangedAt).toLocaleString()}`:"",")"]})]}),a&&e.jsx("button",{style:{marginTop:10,background:"#444",color:"#fff",border:"1px solid #ffd700",borderRadius:6,padding:"4px 12px",fontWeight:600,cursor:"pointer",fontSize:"0.95em",display:"inline-block"},disabled:P,onClick:()=>{const R=k.player||k.senderName,U=k.opponent||k.receiverName;N(k),E({player1:R,player2:U}),_(!0)},type:"button",children:P?"Saving...":k.winner?"Edit Winner":"Set Winner"})]})},k._id)):j.map(k=>e.jsxs("li",{style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>t(k),className:as.proposalCardButton,children:[e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:s==="sent"?"To:":"From:"}),s==="sent"?k.receiverName:k.senderName,k.isCounter&&e.jsx("span",{style:{background:"#ff9800",color:"#fff",borderRadius:"6px",padding:"2px 8px",fontSize:"0.85em",marginLeft:"8px",fontWeight:"bold",display:"inline-block"},children:"Counter Proposal"})]}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Date:"})," ",Ww(k.date),"  ",e.jsx("span",{className:as.proposalCardLabel,children:"Time:"})," ",t9(k.time)]}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Location:"})," ",k.location]}),e.jsx("div",{className:as.proposalCardMessage,children:k.message}),e.jsxs("div",{children:[e.jsx("span",{className:as.proposalCardLabel,children:"Status:"}),e.jsx("span",{style:{color:k.status==="pending"?"#d32f2f":k.status==="countered"?"#fbc02d":"#388e3c"},children:k.status})]})]}),s==="sent"&&k.status==="pending"&&e.jsx("button",{className:as.cancelProposalBtn,style:{position:"absolute",top:10,right:10},onClick:R=>{R.stopPropagation(),d(k._id)},disabled:u,children:"Cancel"})]},k._id))}),j.length===0&&e.jsx("div",{style:{color:"#ffecb3",textAlign:"center",marginTop:16},children:"Nothing to see here."}),c&&e.jsxs("div",{className:as.confirmDialogBox,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1001,background:"#222",color:"#fff",borderRadius:"10px",padding:"2rem 2.5rem",boxShadow:"0 4px 32px #000a",maxWidth:"90vw",minWidth:"260px",textAlign:"center",border:"2px solid #e53e3e"},children:[e.jsx("p",{children:"Are you sure you want to cancel this proposal?"}),e.jsx("button",{onClick:()=>T(c),disabled:u,style:{marginRight:12},children:u?"Cancelling...":"Yes, Cancel"}),e.jsx("button",{onClick:()=>d(null),disabled:u,children:"No, Go Back"}),p&&e.jsx("div",{style:{color:"red",marginTop:8},children:p})]})]}),e.jsx(Nb,{open:S,onClose:()=>_(!1),player1:M.player1,player2:M.player2,onSelect:async k=>{if(C){D(!0);try{const R=await ra.markCompleted(C._id,k,i,o),U=R&&R.proposal?R.proposal:{...C,winner:k,winnerChangedByName:i,winnerChangedByEmail:o,winnerChangedAt:new Date().toISOString()};m(z=>z.map($=>$._id===C._id?U:$)),l&&l(U),_(!1)}catch{alert("Failed to update winner.")}D(!1)}}})]})}const r9="_confirmMatchCard_7heot_7",n9="_confirmMatchTitle_7heot_31",s9="_redTitle_7heot_45",a9="_confirmMatchDetails_7heot_55",o9="_detailRow_7heot_65",i9="_proposalNote_7heot_85",l9="_noteSection_7heot_109",c9="_noteLabel_7heot_119",d9="_noteTextarea_7heot_133",u9="_confirmBtn_7heot_173",h9="_counterProposalOverlay_7heot_277",p9="_modalContent_7heot_297",m9="_modalBounceIn_7heot_1",nn={confirmMatchCard:r9,confirmMatchTitle:n9,redTitle:s9,confirmMatchDetails:a9,detailRow:o9,proposalNote:i9,noteSection:l9,noteLabel:c9,noteTextarea:d9,confirmBtn:u9,counterProposalOverlay:h9,modalContent:p9,modalBounceIn:m9};function Tb({gameType:n,size:t=22}){const r={"8 Ball":{emoji:""},"9 Ball":{color:"#FFD700",number:9},"10 Ball":{color:"#2196F3",number:10}};if(n==="8 Ball")return e.jsx("span",{role:"img","aria-label":"8-ball",style:{fontSize:t,verticalAlign:"middle",marginRight:4},children:r["8 Ball"].emoji});const{color:s,number:a}=r[n]||{};return!s||!a?null:e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:t,height:t,borderRadius:"50%",background:s,color:"#222",fontWeight:"bold",fontSize:t*.65,border:"2px solid #fff",boxShadow:"0 1px 2px #0003",marginRight:4,verticalAlign:"middle"},"aria-label":`${a}-ball`,children:a})}function f9(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function g9({proposal:n,phase:t,userNote:r,setUserNote:s,onConfirm:a,onClose:o,onCounterPropose:i,showNote:l=!0,confirmLabel:c=" Confirm Match",currentUserName:d,currentUserEmail:u}){if(!n)return null;const{senderName:h,receiverName:p,senderEmail:g,receiverEmail:f,day:m,date:v,time:b,location:w,gameType:x,raceLength:j,message:S,proposalNote:_}=n,C=u&&g&&u.toLowerCase()===g.toLowerCase()||d&&h&&d.toLowerCase()===h.toLowerCase();return e.jsxs("div",{className:nn.confirmMatchCard,children:[e.jsx("h1",{className:nn.confirmMatchTitle,children:e.jsx("span",{className:nn.redTitle,children:" Confirm Match"})}),e.jsxs("div",{className:nn.confirmMatchDetails,children:[e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"You:"})," ",p||n.to||"N/A"]}),e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Opponent:"})," ",h||n.from||"N/A"]}),m&&e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Day:"})," ",m]}),e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Date:"})," ",f9(v)]}),e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Time:"})," ",b||"N/A"]}),e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Location:"})," ",w||"N/A"]}),x&&e.jsxs("div",{className:nn.detailRow,children:[e.jsx(Tb,{gameType:x,size:16}),e.jsx("strong",{className:nn.redTitle,children:"Game Type:"})," ",x]}),j&&e.jsxs("div",{className:nn.detailRow,children:[e.jsx("strong",{className:nn.redTitle,children:"Race to:"})," ",j]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginTop:18,justifyContent:"center",paddingBottom:8,width:"100%",boxSizing:"border-box"},children:C?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"#888",fontWeight:500,fontSize:"1.1em"},children:"You proposed this match. You can edit or message, but only your opponent can confirm/counter/cancel."}),e.jsx("button",{className:nn.confirmBtn,style:{background:"#aaa",minWidth:120,marginLeft:16},onClick:o,children:"OK"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:nn.confirmBtn,style:{minWidth:120},onClick:a,children:c}),i&&e.jsx("button",{className:nn.confirmBtn,style:{background:"#fff",color:"#d32f2f",border:"1.5px solid #d32f2f",minWidth:120},onClick:i,type:"button",children:"Counter-Propose"}),e.jsx("button",{className:nn.confirmBtn,style:{background:"#aaa",minWidth:120},onClick:o,children:"Close"})]})})]})]})}function qw(n){if(!n||typeof n!="string"||!n.match(/\d/))return{h:0,m:0};const[t,r]=n.trim().split(/\s+/);let[s,a]=t.split(":").map(Number);return r&&r.toLowerCase()==="pm"&&s!==12&&(s+=12),r&&r.toLowerCase()==="am"&&s===12&&(s=0),{h:s,m:a}}function Pb(n,t,r=30){const s=qw(n),a=qw(t),o=[];let i=new Date(0,0,0,s.h,s.m);const l=new Date(0,0,0,a.h,a.m);for(;i<=l;){const c=i.getHours(),d=i.getMinutes();let u=(c%12||12)+":"+(d<10?"0":"")+d+(c<12?" AM":" PM");o.push(u),i=new Date(i.getTime()+r*6e4)}return o}function x9(n){const t={Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6},r=new Date,s=r.getDay();let o=(t[n]-s+7)%7;o===0&&(o=7);const i=new Date(r);return i.setDate(r.getDate()+o),i}function y9({proposal:n,open:t,onClose:r,onSubmit:s,senderPlayer:a,phase:o,selectedDivision:i}){var z;const[l,c]=y.useState(new Date),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState(""),[m,v]=y.useState(""),[b,w]=y.useState(""),[x,j]=y.useState(""),[S,_]=y.useState("");y.useEffect(()=>{if(n&&t){if(n.date){const[$,W,Y]=n.date.split("-");c(new Date(parseInt($),parseInt(W)-1,parseInt(Y)))}u(""),p(""),f(n.location||""),v(n.gameType||"8 Ball"),w(n.raceLength||(o==="scheduled"||o==="challenge"?5:7)),j("")}},[n,t,o]),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][l.getDay()];const M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()],E=((z=a==null?void 0:a.availability)==null?void 0:z[M])||[],P=["6:00 PM - 8:00 PM","8:00 PM - 10:00 PM","10:00 PM - 12:00 AM"],D=E.length>0?E:P,T=a!=null&&a.locations?a.locations.split(/\r?\n/).map($=>$.trim()).filter(Boolean):[],A=y.useMemo(()=>{if(!d)return[];const $=d.replace(/[]/g,"-").replace(/\s*-\s*/g," - ").trim();if(!$.includes(" - "))return[];let[W,Y]=$.split(" - ").map(Q=>k(Q.trim()));return!W||!Y?[]:Pb(W,Y,30)},[d]);function k($){let W=$.trim();W=W.replace(/(\d{1,2}):(\d{2})\s*(am|pm)/i,(Q,H,ue,J)=>`${parseInt(H,10)}:${ue} ${J.toUpperCase()}`),W=W.replace(/^(\d{1,2})(\d{2})(am|pm)$/i,(Q,H,ue,J)=>`${parseInt(H,10)}:${ue} ${J.toUpperCase()}`),W=W.replace(/^(\d{1,2})(am|pm)$/i,(Q,H,ue)=>`${parseInt(H,10)}:00 ${ue.toUpperCase()}`),W=W.replace(/(am|pm)$/i," $1"),W=W.replace(/(am|pm)$/i,Q=>Q.toUpperCase());const Y=W.match(/^(\d{1,2}):(\d{2}) (AM|PM)$/i);if(Y){const Q=Y[1],H=Y[2],ue=Y[3].toUpperCase();return`${Q}:${H} ${ue}`}return W}function R($){if(!$)return"";const W=new Date($),Y=String(W.getMonth()+1).padStart(2,"0"),Q=String(W.getDate()).padStart(2,"0"),H=W.getFullYear();return`${Y}-${Q}-${H}`}const U=$=>{if($.preventDefault(),!l||!h||!g){_("Please fill in all required fields.");return}_(""),s({date:R(l),time:h,location:g,gameType:m,raceLength:b,note:x})};return!t||!n?null:e.jsx(It,{open:t,onClose:r,title:" Counter Proposal",maxWidth:"500px",children:e.jsxs("form",{onSubmit:U,style:{textAlign:"left"},children:[e.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.15rem",margin:"0 0 1rem 0",color:"#fff",textAlign:"center"},children:["To: ",n.senderName||"Opponent"]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Date:"}),e.jsx(wb,{selected:l,onChange:$=>c($),dateFormat:"MM-dd-yyyy",className:"counter-proposal-date-input",required:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Time Block:"}),e.jsxs("select",{value:d,onChange:$=>{u($.target.value),p("")},required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select time block"}),D.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Start Time:"}),e.jsxs("select",{value:h,onChange:$=>p($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select..."}),A.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Location:"}),e.jsxs("select",{value:g,onChange:$=>f($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select location"}),T.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Game Type:"}),e.jsxs("select",{value:m,onChange:$=>v($.target.value),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:[e.jsx("option",{value:"8 Ball",children:"8 Ball"}),e.jsx("option",{value:"9 Ball",children:"9 Ball"}),e.jsx("option",{value:"10 Ball",children:"10 Ball"}),e.jsx("option",{value:"Mixed",children:"Mixed"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Race Length:"}),e.jsx("select",{value:b,onChange:$=>w(Number($.target.value)),required:!0,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:(()=>o==="scheduled"||o==="challenge"?e.jsx("option",{value:5,children:"5"}):[...Array(13)].map(($,W)=>{const Y=W+3;return e.jsx("option",{value:Y,children:Y},Y)}))()})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#e53e3e",fontWeight:"bold"},children:"Note (optional):"}),e.jsx("textarea",{value:x,onChange:$=>j($.target.value),placeholder:"Add a note explaining your counter proposal...",rows:3,style:{width:"100%",padding:"0.5rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"4px",resize:"vertical"}})]}),S&&e.jsx("div",{style:{color:"#e53e3e",marginBottom:"1rem"},children:S}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"submit",style:{background:"#e53e3e",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px"},children:"Submit Counter"}),e.jsx("button",{type:"button",onClick:r,style:{background:"#6c757d",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",minWidth:"120px"},children:"Cancel"})]})]})})}function Cx(n){const t={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},r={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]};return n&&n.split(/\r?\n/).forEach(s=>{const a=s.match(/Day:\s*(\w+),\s*Available From:\s*([\w:]+),\s*Available Until:\s*([\w: ]+)/i);if(a){const[o,i,l,c]=a,d=t[i];d&&r[d].push(`${l} - ${c}`)}}),r}function Ak({open:n,onClose:t,opponents:r,onOpponentClick:s,phase:a,selectedCalendarDate:o,smartMatchMode:i=!1,allPlayers:l=[]}){if(!n)return null;const c=o?r.filter(d=>{if(!d.player||!d.player.availability)return!1;const h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][o.getDay()],p=d.player.availability;return p[h]&&p[h].length>0}):r;return e.jsx(It,{open:n,onClose:t,title:i?` Smart Match - Select Opponent${o?` (${o.toLocaleDateString()})`:""}`:` Select Opponent - ${a==="scheduled"||a==="offseason"?"Phase 1":"Phase 2"}${o?` (${o.toLocaleDateString()})`:""}`,maxWidth:"500px",children:e.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:c.length===0?e.jsx("p",{style:{color:"#888",textAlign:"center",fontStyle:"italic"},children:o?`No opponents available for ${o.toLocaleDateString()} (${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()]}).`:"No opponents available for scheduling at this time."}):e.jsx("div",{style:{display:"grid",gap:"8px"},children:c.map((d,u)=>e.jsx("button",{onClick:()=>s(d.player&&d.player.name?d.player.name:d.opponentName),style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"8px",padding:"1rem",fontSize:"1.1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:h=>{h.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",h.target.style.transform="translateY(-2px)",h.target.style.boxShadow="0 4px 12px rgba(229, 62, 62, 0.3)"},onMouseLeave:h=>{h.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",h.target.style.transform="translateY(0)",h.target.style.boxShadow="none"},children:d.player&&d.player.name?d.player.name:d.opponentName},d.player&&d.player.email||`${d.opponentName}-${u}`||`opponent-${u}`))})})})}function mf({player:n,onClose:t,senderEmail:r,onProposeMatch:s,selectedDivision:a,phase:o}){if(!n)return null;const[i,l]=y.useState(!1),[c,d]=y.useState(10);return y.useEffect(()=>{let u;return i&&(d(10),u=setInterval(()=>{d(h=>h<=1?(clearInterval(u),l(!1),10):h-1)},1e3)),()=>clearInterval(u)},[i]),e.jsx(It,{open:!0,onClose:t,title:` ${n.name||`${n.firstName} ${n.lastName}`}`,maxWidth:"600px",children:e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#888",marginBottom:"1.5rem",textAlign:"center"},children:o==="scheduled"?"Phase 1 (Scheduled)":o==="challenge"?"Phase 2 (Challenge)":o}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"0.5rem",fontSize:"1.1rem",textAlign:"center"},children:"Preferred Locations:"}),e.jsx("div",{style:{color:"#fff",textAlign:"center",maxWidth:"100%",overflow:"hidden"},children:n.locations?(()=>{const u=n.locations.split(/\r?\n/).filter(Boolean);return e.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"8px",padding:"8px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",maxWidth:"100%"},children:u.map((h,p)=>e.jsxs("span",{style:{background:"rgba(229, 62, 62, 0.2)",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"0.85rem",border:"1px solid rgba(229, 62, 62, 0.3)",whiteSpace:"nowrap",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block"},title:h,children:[" ",h]},h+p))})})():"No locations specified"})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"0.5rem",fontSize:"1.1rem",textAlign:"center"},children:"Availability:"}),e.jsx("div",{style:{color:"#fff",fontSize:"0.9rem",marginBottom:"1rem",textAlign:"center",fontStyle:"italic"},children:"Pick a timeblock within a day to schedule a match with this opponent."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:["Mon","Tue","Wed"].map(u=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"#e53e3e",fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9rem"},children:u}),!n.availability||!n.availability[u]||n.availability[u].length===0?e.jsx("div",{style:{color:"#666",fontSize:"0.8rem",padding:"0.5rem",background:"#222",borderRadius:"4px"},children:""}):(n.availability[u]||[]).map((h,p)=>e.jsx("div",{onClick:()=>{s&&s(u,h,o,a)},style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"1px solid #e53e3e",borderRadius:"6px",padding:"0.5rem",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s ease",marginBottom:"0.5rem"},onMouseEnter:g=>{g.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",g.target.style.transform="translateY(-1px)",g.target.style.boxShadow="0 2px 8px rgba(229, 62, 62, 0.3)"},onMouseLeave:g=>{g.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",g.target.style.transform="translateY(0)",g.target.style.boxShadow="none"},tabIndex:0,role:"button","aria-label":`Propose match on ${u} at ${h}`,onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&s&&s(u,h,o,a)},children:h},p))]},u))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:["Thu","Fri","Sat"].map(u=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"#e53e3e",fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9rem"},children:u}),!n.availability||!n.availability[u]||n.availability[u].length===0?e.jsx("div",{style:{color:"#666",fontSize:"0.8rem",padding:"0.5rem",background:"#222",borderRadius:"4px"},children:""}):(n.availability[u]||[]).map((h,p)=>e.jsx("div",{onClick:()=>{s&&s(u,h,o,a)},style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"1px solid #e53e3e",borderRadius:"6px",padding:"0.5rem",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s ease",marginBottom:"0.5rem"},onMouseEnter:g=>{g.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",g.target.style.transform="translateY(-1px)",g.target.style.boxShadow="0 2px 8px rgba(229, 62, 62, 0.3)"},onMouseLeave:g=>{g.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",g.target.style.transform="translateY(0)",g.target.style.boxShadow="none"},tabIndex:0,role:"button","aria-label":`Propose match on ${u} at ${h}`,onKeyPress:g=>{(g.key==="Enter"||g.key===" ")&&s&&s(u,h,o,a)},children:h},p))]},u))})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"0.5rem",fontSize:"1.1rem",textAlign:"center"},children:"Contact Information:"}),e.jsx("div",{style:{color:"#fff",textAlign:"center"},children:i?e.jsxs("div",{style:{background:"rgba(229, 62, 62, 0.1)",border:"1px solid #e53e3e",borderRadius:"6px",padding:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Email:"})," ",n.email||"Not provided"]}),n.phone&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Phone:"})," ",n.phone]}),n.text&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Text:"})," ",n.text]}),n.preferredContacts&&n.preferredContacts.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Preferred Contact:"})," ",n.preferredContacts.join(", ")]}),e.jsxs("div",{style:{color:"#ffc107",fontSize:"0.9rem",marginTop:"0.5rem"},children:["Auto-hiding in ",c," seconds..."]})]}):e.jsx("button",{onClick:()=>l(!0),style:{background:"#e53e3e",color:"#fff",border:"none",borderRadius:"6px",padding:"0.7rem 1.5rem",fontSize:"1rem",fontWeight:"bold",cursor:"pointer"},children:"Show Contact Info"})})]})]})})}function b9(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function v9({open:n,message:t,gameType:r,raceLength:s,day:a,date:o,time:i,location:l,proposalNote:c,confirmationNote:d,phase:u,onClose:h}){if(!n)return null;const p=typeof window<"u"&&window.innerWidth<=500,g=p?"100%":"240px",f=p?"90vw":"240px",m=p?"100%":"220px";return e.jsx(It,{open:n,onClose:h,title:"Proposal Sent!",maxWidth:f,width:g,children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{background:"#222",color:"#fff",borderRadius:6,padding:"0.6rem 0.7rem 0.6rem 0.7rem",margin:"0 auto 0.7rem auto",fontWeight:600,fontSize:"0.97rem",textAlign:"center",maxWidth:"220px",width:"100%",wordBreak:"break-word",whiteSpace:"pre-line"},children:t}),e.jsxs("div",{style:{background:"#f8f8f8",color:"#222",borderRadius:8,padding:p?"0.4rem 0.2rem":"0.5rem 0.5rem",margin:"0.7rem auto 0.7rem auto",textAlign:"center",fontSize:p?"0.92rem":"0.95rem",border:"1px solid #ff0000",maxWidth:m,width:"100%"},children:[e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Phase:"})," ",u==="scheduled"?"Phase 1 (Scheduled)":u==="challenge"?"Phase 2 (challenge)":u]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Game Type:"})," ",e.jsx(Tb,{gameType:r,size:16})," ",r]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Race to:"})," ",s]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Day:"})," ",a]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Date:"})," ",b9(o)]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Time:"})," ",i]}),e.jsxs("div",{style:{marginBottom:6},children:[e.jsx("strong",{children:"Location:"})," ",l]}),c&&e.jsxs("div",{style:{marginTop:12,padding:"0.5rem 0.7rem",background:"#fffbe6",borderLeft:"3px solid #ffb300",borderRadius:4,color:"#a36c00",fontSize:"0.97rem"},children:[e.jsx("strong",{children:"Opponent's note:"})," ",c]}),d&&e.jsxs("div",{style:{marginTop:10,padding:"0.5rem 0.7rem",background:"#e6fff0",borderLeft:"3px solid #00b36b",borderRadius:4,color:"#006b3c",fontSize:"0.97rem"},children:[e.jsx("strong",{children:"Your note:"})," ",d]})]}),e.jsx("button",{style:{marginTop:"1.8rem",background:"#ff0000",color:"#fff",border:"none",borderRadius:"8px",padding:"0.7rem 1.5rem",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer"},onClick:h,children:"Close"})]})})}function w9({to_email:n,to_name:t,from_name:r,from_email:s,day:a,date:o,time:i,location:l,note:c,gameType:d,raceLength:u,proposalId:h}){if(!n||n==="undefined")return alert("Recipient email is missing. Cannot send proposal."),Promise.reject(new Error("Recipient email is missing."));if(!s||s==="undefined")return alert("Your email is missing. Cannot send proposal."),Promise.reject(new Error("Sender email is missing."));const p=As(A_(o),"MM-dd-yyyy"),f=Object.entries({from:r,to:t,day:a,date:p,time:i,location:l,note:c,proposerEmail:s,gameType:d,raceLength:u,proposalId:h}).map(([w,x])=>`${w}=${encodeURIComponent(x)}`).join("&"),m="https://newapp-1-ic1v.onrender.com",v=`${m}/#/confirm-match?${f}`,b=`${m}/#/confirm-match?${f}`;return uf.send("service_l5q2047","template_xu0tl3i",{to_email:n,to_name:t,from_name:r,day:a,date:p,time:i,location:l,note:c,gameType:d,raceLength:u,confirm_link:v,counter_propose_link:b},"g6vqrOs_Jb6LL1VCZ")}function j9({to_email:n,to_name:t,division:r,daysUntilDeadline:s,completedMatches:a,totalRequiredMatches:o,deadlineDate:i,remainingMatches:l}){if(!n||n==="undefined")return console.error("Recipient email is missing. Cannot send deadline reminder."),Promise.reject(new Error("Recipient email is missing."));const c=Math.round(a/o*100),d=s<=1?"CRITICAL":s<=3?"URGENT":s<=7?"WARNING":"REMINDER";return uf.send("service_l5q2047","template_xbpnbge",{to_email:n,to_name:t,division:r,days_until_deadline:s,completed_matches:a,total_required_matches:o,progress_percentage:c,deadline_date:i,remaining_matches:l,urgency_level:d,app_url:"https://newapp-1-ic1v.onrender.com"},"g6vqrOs_Jb6LL1VCZ")}function S9({to_email:n,to_name:t,registrationId:r,registrationDate:s,registrationFee:a,paymentMethods:o=[],additionalInstructions:i="",contactInfo:l={}}){if(!n||n==="undefined")return console.error("Recipient email is missing. Cannot send payment instructions."),Promise.reject(new Error("Recipient email is missing."));const c=o.length>0?o.map((u,h)=>{let p=u.instructions;return u.key==="venmo"&&u.username?p=`Send payment to @${u.username}`:u.key==="cashapp"&&u.username?p=`Send payment to $${u.username}`:u.key==="paypal"&&u.email?p=`Send payment to ${u.email}`:u.key==="creditCard"&&u.paymentLink?p=`Pay securely online: ${u.paymentLink}`:u.key==="applePay"&&u.paymentLink?p=`Pay with Apple Pay: ${u.paymentLink}`:u.key==="googlePay"&&u.paymentLink?p=`Pay with Google Pay: ${u.paymentLink}`:u.key==="check"&&u.payeeName&&(p=`Make check payable to ${u.payeeName}`),`${h+1}. **${u.displayName}:** ${p}`}).join(`
`):"1. **Cash:** Pay in person to league administrator",d=l&&(l.email||l.phone||l.name)?`

**For payment questions, contact:**
${l.name?`Name: ${l.name}
`:""}${l.email?`Email: ${l.email}
`:""}${l.phone?`Phone: ${l.phone}`:""}`:"";return uf.send("service_l5q2047","template_payment_instructions",{to_email:n,to_name:t,registration_id:r,registration_date:s,registration_fee:a,payment_instructions:`
        **League Registration Payment Instructions**
        
        Registration Fee: $${a}
        Registration ID: ${r}
        
        **Payment Methods:**
${c}
        
        ${i?`
**Additional Instructions:**
${i}
`:""}
        
        **Important Notes:**
         Include your Registration ID (${r}) in payment notes
         Payment must be completed within 7 days
         Your PIN will be sent once payment is confirmed
         Contact league admin if you have payment issues${d}
        
        **Next Steps:**
        1. Complete payment using one of the methods above
        2. Wait for payment confirmation email
        3. You'll receive your unique PIN and full access
      `,app_url:"https://newapp-1-ic1v.onrender.com"},"g6vqrOs_Jb6LL1VCZ")}const _9="_modalIn_1wgqu_1",k9="_opponentName_1wgqu_479",sn={"match-proposal-overlay":"_match-proposal-overlay_1wgqu_27","match-proposal-content":"_match-proposal-content_1wgqu_49",modalIn:_9,"match-proposal-close":"_match-proposal-close_1wgqu_101","match-proposal-title":"_match-proposal-title_1wgqu_135","match-proposal-row":"_match-proposal-row_1wgqu_155","match-proposal-select":"_match-proposal-select_1wgqu_177","match-proposal-location-select":"_match-proposal-location-select_1wgqu_179","match-proposal-textarea":"_match-proposal-textarea_1wgqu_225","match-proposal-datepicker":"_match-proposal-datepicker_1wgqu_277","react-datepicker__input-container":"_react-datepicker__input-container_1wgqu_277","match-proposal-date-highlight":"_match-proposal-date-highlight_1wgqu_309","match-proposal-date-input":"_match-proposal-date-input_1wgqu_339","match-proposal-send-btn":"_match-proposal-send-btn_1wgqu_365","match-proposal-day-row":"_match-proposal-day-row_1wgqu_431","match-proposal-day-label":"_match-proposal-day-label_1wgqu_447","match-proposal-day-value":"_match-proposal-day-value_1wgqu_449",opponentName:k9,"match-proposal-division":"_match-proposal-division_1wgqu_493","match-proposal-phase":"_match-proposal-phase_1wgqu_493","match-proposal-label-red":"_match-proposal-label-red_1wgqu_501"};var C9=E9,po=[],Hw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Zh=0,N9=Hw.length;Zh<N9;++Zh)po[Zh]=Hw[Zh];function T9(n){return po[n>>18&63]+po[n>>12&63]+po[n>>6&63]+po[n&63]}function P9(n,t,r){for(var s,a=[],o=t;o<r;o+=3)s=(n[o]<<16&16711680)+(n[o+1]<<8&65280)+(n[o+2]&255),a.push(T9(s));return a.join("")}function E9(n){for(var t,r=n.length,s=r%3,a=[],o=16383,i=0,l=r-s;i<l;i+=o)a.push(P9(n,i,i+o>l?l:i+o));return s===1?(t=n[r-1],a.push(po[t>>2]+po[t<<4&63]+"==")):s===2&&(t=(n[r-2]<<8)+n[r-1],a.push(po[t>>10]+po[t>>4&63]+po[t<<2&63]+"=")),a.join("")}function Yw(n,t,r,s,a,o,i){try{var l=n[o](i),c=l.value}catch(d){return void r(d)}l.done?t(c):Promise.resolve(c).then(s,a)}function pe(n){return function(){var t=this,r=arguments;return new Promise(function(s,a){var o=n.apply(t,r);function i(c){Yw(o,s,a,i,l,"next",c)}function l(c){Yw(o,s,a,i,l,"throw",c)}i(void 0)})}}var Mk={exports:{}},Ik={exports:{}};(function(n){function t(r){"@babel/helpers - typeof";return n.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},n.exports.__esModule=!0,n.exports.default=n.exports,t(r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(Ik);var R9=Ik.exports;(function(n){var t=R9.default;function r(){n.exports=r=function(){return a},n.exports.__esModule=!0,n.exports.default=n.exports;var s,a={},o=Object.prototype,i=o.hasOwnProperty,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function h(T,A,k,R){Object.defineProperty(T,A,{value:k,enumerable:!R,configurable:!R,writable:!R})}try{h({},"")}catch{h=function(k,R,U){return k[R]=U}}function p(T,A,k,R){var U=A&&A.prototype instanceof m?A:m,z=Object.create(U.prototype);return h(z,"_invoke",function($,W,Y){var Q=1;return function(H,ue){if(Q===3)throw Error("Generator is already running");if(Q===4){if(H==="throw")throw ue;return{value:s,done:!0}}for(Y.method=H,Y.arg=ue;;){var J=Y.delegate;if(J){var be=N(J,Y);if(be){if(be===f)continue;return be}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(Q===1)throw Q=4,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);Q=3;var Ae=g($,W,Y);if(Ae.type==="normal"){if(Q=Y.done?4:2,Ae.arg===f)continue;return{value:Ae.arg,done:Y.done}}Ae.type==="throw"&&(Q=4,Y.method="throw",Y.arg=Ae.arg)}}}(T,k,new P(R||[])),!0),z}function g(T,A,k){try{return{type:"normal",arg:T.call(A,k)}}catch(R){return{type:"throw",arg:R}}}a.wrap=p;var f={};function m(){}function v(){}function b(){}var w={};h(w,c,function(){return this});var x=Object.getPrototypeOf,j=x&&x(x(D([])));j&&j!==o&&i.call(j,c)&&(w=j);var S=b.prototype=m.prototype=Object.create(w);function _(T){["next","throw","return"].forEach(function(A){h(T,A,function(k){return this._invoke(A,k)})})}function C(T,A){function k(U,z,$,W){var Y=g(T[U],T,z);if(Y.type!=="throw"){var Q=Y.arg,H=Q.value;return H&&t(H)=="object"&&i.call(H,"__await")?A.resolve(H.__await).then(function(ue){k("next",ue,$,W)},function(ue){k("throw",ue,$,W)}):A.resolve(H).then(function(ue){Q.value=ue,$(Q)},function(ue){return k("throw",ue,$,W)})}W(Y.arg)}var R;h(this,"_invoke",function(U,z){function $(){return new A(function(W,Y){k(U,z,W,Y)})}return R=R?R.then($,$):$()},!0)}function N(T,A){var k=A.method,R=T.i[k];if(R===s)return A.delegate=null,k==="throw"&&T.i.return&&(A.method="return",A.arg=s,N(T,A),A.method==="throw")||k!=="return"&&(A.method="throw",A.arg=new TypeError("The iterator does not provide a '"+k+"' method")),f;var U=g(R,T.i,A.arg);if(U.type==="throw")return A.method="throw",A.arg=U.arg,A.delegate=null,f;var z=U.arg;return z?z.done?(A[T.r]=z.value,A.next=T.n,A.method!=="return"&&(A.method="next",A.arg=s),A.delegate=null,f):z:(A.method="throw",A.arg=new TypeError("iterator result is not an object"),A.delegate=null,f)}function M(T){this.tryEntries.push(T)}function E(T){var A=T[4]||{};A.type="normal",A.arg=s,T[4]=A}function P(T){this.tryEntries=[[-1]],T.forEach(M,this),this.reset(!0)}function D(T){if(T!=null){var A=T[c];if(A)return A.call(T);if(typeof T.next=="function")return T;if(!isNaN(T.length)){var k=-1,R=function U(){for(;++k<T.length;)if(i.call(T,k))return U.value=T[k],U.done=!1,U;return U.value=s,U.done=!0,U};return R.next=R}}throw new TypeError(t(T)+" is not iterable")}return v.prototype=b,h(S,"constructor",b),h(b,"constructor",v),h(b,u,v.displayName="GeneratorFunction"),a.isGeneratorFunction=function(T){var A=typeof T=="function"&&T.constructor;return!!A&&(A===v||(A.displayName||A.name)==="GeneratorFunction")},a.mark=function(T){return Object.setPrototypeOf?Object.setPrototypeOf(T,b):(T.__proto__=b,h(T,u,"GeneratorFunction")),T.prototype=Object.create(S),T},a.awrap=function(T){return{__await:T}},_(C.prototype),h(C.prototype,d,function(){return this}),a.AsyncIterator=C,a.async=function(T,A,k,R,U){U===void 0&&(U=Promise);var z=new C(p(T,A,k,R),U);return a.isGeneratorFunction(A)?z:z.next().then(function($){return $.done?$.value:z.next()})},_(S),h(S,u,"Generator"),h(S,c,function(){return this}),h(S,"toString",function(){return"[object Generator]"}),a.keys=function(T){var A=Object(T),k=[];for(var R in A)k.unshift(R);return function U(){for(;k.length;)if((R=k.pop())in A)return U.value=R,U.done=!1,U;return U.done=!0,U}},a.values=D,P.prototype={constructor:P,reset:function(A){if(this.prev=this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(E),!A)for(var k in this)k.charAt(0)==="t"&&i.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=s)},stop:function(){this.done=!0;var A=this.tryEntries[0][4];if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var k=this;function R(H){$.type="throw",$.arg=A,k.next=H}for(var U=k.tryEntries.length-1;U>=0;--U){var z=this.tryEntries[U],$=z[4],W=this.prev,Y=z[1],Q=z[2];if(z[0]===-1)return R("end"),!1;if(!Y&&!Q)throw Error("try statement without catch or finally");if(z[0]!=null&&z[0]<=W){if(W<Y)return this.method="next",this.arg=s,R(Y),!0;if(W<Q)return R(Q),!1}}},abrupt:function(A,k){for(var R=this.tryEntries.length-1;R>=0;--R){var U=this.tryEntries[R];if(U[0]>-1&&U[0]<=this.prev&&this.prev<U[2]){var z=U;break}}z&&(A==="break"||A==="continue")&&z[0]<=k&&k<=z[2]&&(z=null);var $=z?z[4]:{};return $.type=A,$.arg=k,z?(this.method="next",this.next=z[2],f):this.complete($)},complete:function(A,k){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&k&&(this.next=k),f},finish:function(A){for(var k=this.tryEntries.length-1;k>=0;--k){var R=this.tryEntries[k];if(R[2]===A)return this.complete(R[4],R[3]),E(R),f}},catch:function(A){for(var k=this.tryEntries.length-1;k>=0;--k){var R=this.tryEntries[k];if(R[0]===A){var U=R[4];if(U.type==="throw"){var z=U.arg;E(R)}return z}}throw Error("illegal catch attempt")},delegateYield:function(A,k,R){return this.delegate={i:D(A),r:k,n:R},this.method==="next"&&(this.arg=s),f}},a}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports})(Mk);var A9=Mk.exports,Ap=A9(),M9=Ap;try{regeneratorRuntime=Ap}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Ap:Function("r","regeneratorRuntime = r")(Ap)}const L=Jo(M9);function I9(n){if(Array.isArray(n))return n}function D9(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,a,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(s=o.call(r)).done)&&(l.push(s.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}function $9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ql(n,t){return I9(n)||D9(n,t)||ib(n,t)||$9()}function ah(){return ah=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(n[s]=r[s])}return n},ah.apply(null,arguments)}function L9(n,t){if(n==null)return{};var r={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(t.indexOf(s)!==-1)continue;r[s]=n[s]}return r}function oh(n,t){if(n==null)return{};var r,s,a=L9(n,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(s=0;s<o.length;s++)r=o[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(n,r)&&(a[r]=n[r])}return a}function B9(n){if(Array.isArray(n))return ox(n)}function O9(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function z9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Or(n){return B9(n)||O9(n)||ib(n)||z9()}function Dk(n,t){return function(){return n.apply(t,arguments)}}const{toString:F9}=Object.prototype,{getPrototypeOf:Eb}=Object,{iterator:ff,toStringTag:$k}=Symbol,gf=(n=>t=>{const r=F9.call(t);return n[r]||(n[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ka=n=>(n=n.toLowerCase(),t=>gf(t)===n),xf=n=>t=>typeof t===n,{isArray:Sd}=Array,ih=xf("undefined");function W9(n){return n!==null&&!ih(n)&&n.constructor!==null&&!ih(n.constructor)&&Ks(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Lk=Ka("ArrayBuffer");function U9(n){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(n):t=n&&n.buffer&&Lk(n.buffer),t}const q9=xf("string"),Ks=xf("function"),Bk=xf("number"),yf=n=>n!==null&&typeof n=="object",H9=n=>n===!0||n===!1,Mp=n=>{if(gf(n)!=="object")return!1;const t=Eb(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!($k in n)&&!(ff in n)},Y9=Ka("Date"),G9=Ka("File"),V9=Ka("Blob"),K9=Ka("FileList"),J9=n=>yf(n)&&Ks(n.pipe),X9=n=>{let t;return n&&(typeof FormData=="function"&&n instanceof FormData||Ks(n.append)&&((t=gf(n))==="formdata"||t==="object"&&Ks(n.toString)&&n.toString()==="[object FormData]"))},Q9=Ka("URLSearchParams"),[Z9,e7,t7,r7]=["ReadableStream","Request","Response","Headers"].map(Ka),n7=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _h(n,t,{allOwnKeys:r=!1}={}){if(n===null||typeof n>"u")return;let s,a;if(typeof n!="object"&&(n=[n]),Sd(n))for(s=0,a=n.length;s<a;s++)t.call(null,n[s],s,n);else{const o=r?Object.getOwnPropertyNames(n):Object.keys(n),i=o.length;let l;for(s=0;s<i;s++)l=o[s],t.call(null,n[l],l,n)}}function Ok(n,t){t=t.toLowerCase();const r=Object.keys(n);let s=r.length,a;for(;s-- >0;)if(a=r[s],t===a.toLowerCase())return a;return null}const kl=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),zk=n=>!ih(n)&&n!==kl;function Nx(){const{caseless:n}=zk(this)&&this||{},t={},r=(s,a)=>{const o=n&&Ok(t,a)||a;Mp(t[o])&&Mp(s)?t[o]=Nx(t[o],s):Mp(s)?t[o]=Nx({},s):Sd(s)?t[o]=s.slice():t[o]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&_h(arguments[s],r);return t}const s7=(n,t,r,{allOwnKeys:s}={})=>(_h(t,(a,o)=>{r&&Ks(a)?n[o]=Dk(a,r):n[o]=a},{allOwnKeys:s}),n),a7=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),o7=(n,t,r,s)=>{n.prototype=Object.create(t.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:t.prototype}),r&&Object.assign(n.prototype,r)},i7=(n,t,r,s)=>{let a,o,i;const l={};if(t=t||{},n==null)return t;do{for(a=Object.getOwnPropertyNames(n),o=a.length;o-- >0;)i=a[o],(!s||s(i,n,t))&&!l[i]&&(t[i]=n[i],l[i]=!0);n=r!==!1&&Eb(n)}while(n&&(!r||r(n,t))&&n!==Object.prototype);return t},l7=(n,t,r)=>{n=String(n),(r===void 0||r>n.length)&&(r=n.length),r-=t.length;const s=n.indexOf(t,r);return s!==-1&&s===r},c7=n=>{if(!n)return null;if(Sd(n))return n;let t=n.length;if(!Bk(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=n[t];return r},d7=(n=>t=>n&&t instanceof n)(typeof Uint8Array<"u"&&Eb(Uint8Array)),u7=(n,t)=>{const s=(n&&n[ff]).call(n);let a;for(;(a=s.next())&&!a.done;){const o=a.value;t.call(n,o[0],o[1])}},h7=(n,t)=>{let r;const s=[];for(;(r=n.exec(t))!==null;)s.push(r);return s},p7=Ka("HTMLFormElement"),m7=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,a){return s.toUpperCase()+a}),Gw=(({hasOwnProperty:n})=>(t,r)=>n.call(t,r))(Object.prototype),f7=Ka("RegExp"),Fk=(n,t)=>{const r=Object.getOwnPropertyDescriptors(n),s={};_h(r,(a,o)=>{let i;(i=t(a,o,n))!==!1&&(s[o]=i||a)}),Object.defineProperties(n,s)},g7=n=>{Fk(n,(t,r)=>{if(Ks(n)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=n[r];if(Ks(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},x7=(n,t)=>{const r={},s=a=>{a.forEach(o=>{r[o]=!0})};return Sd(n)?s(n):s(String(n).split(t)),r},y7=()=>{},b7=(n,t)=>n!=null&&Number.isFinite(n=+n)?n:t;function v7(n){return!!(n&&Ks(n.append)&&n[$k]==="FormData"&&n[ff])}const w7=n=>{const t=new Array(10),r=(s,a)=>{if(yf(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[a]=s;const o=Sd(s)?[]:{};return _h(s,(i,l)=>{const c=r(i,a+1);!ih(c)&&(o[l]=c)}),t[a]=void 0,o}}return s};return r(n,0)},j7=Ka("AsyncFunction"),S7=n=>n&&(yf(n)||Ks(n))&&Ks(n.then)&&Ks(n.catch),Wk=((n,t)=>n?setImmediate:t?((r,s)=>(kl.addEventListener("message",({source:a,data:o})=>{a===kl&&o===r&&s.length&&s.shift()()},!1),a=>{s.push(a),kl.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ks(kl.postMessage)),_7=typeof queueMicrotask<"u"?queueMicrotask.bind(kl):typeof process<"u"&&process.nextTick||Wk,k7=n=>n!=null&&Ks(n[ff]),ze={isArray:Sd,isArrayBuffer:Lk,isBuffer:W9,isFormData:X9,isArrayBufferView:U9,isString:q9,isNumber:Bk,isBoolean:H9,isObject:yf,isPlainObject:Mp,isReadableStream:Z9,isRequest:e7,isResponse:t7,isHeaders:r7,isUndefined:ih,isDate:Y9,isFile:G9,isBlob:V9,isRegExp:f7,isFunction:Ks,isStream:J9,isURLSearchParams:Q9,isTypedArray:d7,isFileList:K9,forEach:_h,merge:Nx,extend:s7,trim:n7,stripBOM:a7,inherits:o7,toFlatObject:i7,kindOf:gf,kindOfTest:Ka,endsWith:l7,toArray:c7,forEachEntry:u7,matchAll:h7,isHTMLForm:p7,hasOwnProperty:Gw,hasOwnProp:Gw,reduceDescriptors:Fk,freezeMethods:g7,toObjectSet:x7,toCamelCase:m7,noop:y7,toFiniteNumber:b7,findKey:Ok,global:kl,isContextDefined:zk,isSpecCompliantForm:v7,toJSONObject:w7,isAsyncFn:j7,isThenable:S7,setImmediate:Wk,asap:_7,isIterable:k7};function cr(n,t,r,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}ze.inherits(cr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ze.toJSONObject(this.config),code:this.code,status:this.status}}});const Uk=cr.prototype,qk={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{qk[n]={value:n}});Object.defineProperties(cr,qk);Object.defineProperty(Uk,"isAxiosError",{value:!0});cr.from=(n,t,r,s,a,o)=>{const i=Object.create(Uk);return ze.toFlatObject(n,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),cr.call(i,n.message,t,r,s,a),i.cause=n,i.name=n.name,o&&Object.assign(i,o),i};const C7=null;function Tx(n){return ze.isPlainObject(n)||ze.isArray(n)}function Hk(n){return ze.endsWith(n,"[]")?n.slice(0,-2):n}function Vw(n,t,r){return n?n.concat(t).map(function(a,o){return a=Hk(a),!r&&o?"["+a+"]":a}).join(r?".":""):t}function N7(n){return ze.isArray(n)&&!n.some(Tx)}const T7=ze.toFlatObject(ze,{},null,function(t){return/^is[A-Z]/.test(t)});function bf(n,t,r){if(!ze.isObject(n))throw new TypeError("target must be an object");t=t||new FormData,r=ze.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,v){return!ze.isUndefined(v[m])});const s=r.metaTokens,a=r.visitor||u,o=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&ze.isSpecCompliantForm(t);if(!ze.isFunction(a))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(ze.isDate(f))return f.toISOString();if(!c&&ze.isBlob(f))throw new cr("Blob is not supported. Use a Buffer instead.");return ze.isArrayBuffer(f)||ze.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,m,v){let b=f;if(f&&!v&&typeof f=="object"){if(ze.endsWith(m,"{}"))m=s?m:m.slice(0,-2),f=JSON.stringify(f);else if(ze.isArray(f)&&N7(f)||(ze.isFileList(f)||ze.endsWith(m,"[]"))&&(b=ze.toArray(f)))return m=Hk(m),b.forEach(function(x,j){!(ze.isUndefined(x)||x===null)&&t.append(i===!0?Vw([m],j,o):i===null?m:m+"[]",d(x))}),!1}return Tx(f)?!0:(t.append(Vw(v,m,o),d(f)),!1)}const h=[],p=Object.assign(T7,{defaultVisitor:u,convertValue:d,isVisitable:Tx});function g(f,m){if(!ze.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(f),ze.forEach(f,function(b,w){(!(ze.isUndefined(b)||b===null)&&a.call(t,b,ze.isString(w)?w.trim():w,m,p))===!0&&g(b,m?m.concat(w):[w])}),h.pop()}}if(!ze.isObject(n))throw new TypeError("data must be an object");return g(n),t}function Kw(n){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Rb(n,t){this._pairs=[],n&&bf(n,this,t)}const Yk=Rb.prototype;Yk.append=function(t,r){this._pairs.push([t,r])};Yk.toString=function(t){const r=t?function(s){return t.call(this,s,Kw)}:Kw;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function P7(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gk(n,t,r){if(!t)return n;const s=r&&r.encode||P7;ze.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let o;if(a?o=a(t,r):o=ze.isURLSearchParams(t)?t.toString():new Rb(t,r).toString(s),o){const i=n.indexOf("#");i!==-1&&(n=n.slice(0,i)),n+=(n.indexOf("?")===-1?"?":"&")+o}return n}class E7{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ze.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Jw=E7,Vk={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},R7=typeof URLSearchParams<"u"?URLSearchParams:Rb,A7=typeof FormData<"u"?FormData:null,M7=typeof Blob<"u"?Blob:null,I7={isBrowser:!0,classes:{URLSearchParams:R7,FormData:A7,Blob:M7},protocols:["http","https","file","blob","url","data"]},Ab=typeof window<"u"&&typeof document<"u",Px=typeof navigator=="object"&&navigator||void 0,D7=Ab&&(!Px||["ReactNative","NativeScript","NS"].indexOf(Px.product)<0),$7=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),L7=Ab&&window.location.href||"http://localhost",B7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ab,hasStandardBrowserEnv:D7,hasStandardBrowserWebWorkerEnv:$7,navigator:Px,origin:L7},Symbol.toStringTag,{value:"Module"})),js={...B7,...I7};function O7(n,t){return bf(n,new js.classes.URLSearchParams,Object.assign({visitor:function(r,s,a,o){return js.isNode&&ze.isBuffer(r)?(this.append(s,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function z7(n){return ze.matchAll(/\w+|\[(\w*)]/g,n).map(t=>t[0]==="[]"?"":t[1]||t[0])}function F7(n){const t={},r=Object.keys(n);let s;const a=r.length;let o;for(s=0;s<a;s++)o=r[s],t[o]=n[o];return t}function Kk(n){function t(r,s,a,o){let i=r[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=o>=r.length;return i=!i&&ze.isArray(a)?a.length:i,c?(ze.hasOwnProp(a,i)?a[i]=[a[i],s]:a[i]=s,!l):((!a[i]||!ze.isObject(a[i]))&&(a[i]=[]),t(r,s,a[i],o)&&ze.isArray(a[i])&&(a[i]=F7(a[i])),!l)}if(ze.isFormData(n)&&ze.isFunction(n.entries)){const r={};return ze.forEachEntry(n,(s,a)=>{t(z7(s),a,r,0)}),r}return null}function W7(n,t,r){if(ze.isString(n))try{return(t||JSON.parse)(n),ze.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(n)}const Mb={transitional:Vk,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",a=s.indexOf("application/json")>-1,o=ze.isObject(t);if(o&&ze.isHTMLForm(t)&&(t=new FormData(t)),ze.isFormData(t))return a?JSON.stringify(Kk(t)):t;if(ze.isArrayBuffer(t)||ze.isBuffer(t)||ze.isStream(t)||ze.isFile(t)||ze.isBlob(t)||ze.isReadableStream(t))return t;if(ze.isArrayBufferView(t))return t.buffer;if(ze.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return O7(t,this.formSerializer).toString();if((l=ze.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return bf(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return o||a?(r.setContentType("application/json",!1),W7(t)):t}],transformResponse:[function(t){const r=this.transitional||Mb.transitional,s=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ze.isResponse(t)||ze.isReadableStream(t))return t;if(t&&ze.isString(t)&&(s&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?cr.from(l,cr.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:js.classes.FormData,Blob:js.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ze.forEach(["delete","get","head","post","put","patch"],n=>{Mb.headers[n]={}});const Ib=Mb,U7=ze.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),q7=n=>{const t={};let r,s,a;return n&&n.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),s=i.substring(a+1).trim(),!(!r||t[r]&&U7[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},Xw=Symbol("internals");function zd(n){return n&&String(n).trim().toLowerCase()}function Ip(n){return n===!1||n==null?n:ze.isArray(n)?n.map(Ip):String(n)}function H7(n){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(n);)t[s[1]]=s[2];return t}const Y7=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function kg(n,t,r,s,a){if(ze.isFunction(s))return s.call(this,t,r);if(a&&(t=r),!!ze.isString(t)){if(ze.isString(s))return t.indexOf(s)!==-1;if(ze.isRegExp(s))return s.test(t)}}function G7(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function V7(n,t){const r=ze.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+r,{value:function(a,o,i){return this[s].call(this,t,a,o,i)},configurable:!0})})}class vf{constructor(t){t&&this.set(t)}set(t,r,s){const a=this;function o(l,c,d){const u=zd(c);if(!u)throw new Error("header name must be a non-empty string");const h=ze.findKey(a,u);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=Ip(l))}const i=(l,c)=>ze.forEach(l,(d,u)=>o(d,u,c));if(ze.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(ze.isString(t)&&(t=t.trim())&&!Y7(t))i(q7(t),r);else if(ze.isObject(t)&&ze.isIterable(t)){let l={},c,d;for(const u of t){if(!ze.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?ze.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}i(l,r)}else t!=null&&o(r,t,s);return this}get(t,r){if(t=zd(t),t){const s=ze.findKey(this,t);if(s){const a=this[s];if(!r)return a;if(r===!0)return H7(a);if(ze.isFunction(r))return r.call(this,a,s);if(ze.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zd(t),t){const s=ze.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||kg(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let a=!1;function o(i){if(i=zd(i),i){const l=ze.findKey(s,i);l&&(!r||kg(s,s[l],l,r))&&(delete s[l],a=!0)}}return ze.isArray(t)?t.forEach(o):o(t),a}clear(t){const r=Object.keys(this);let s=r.length,a=!1;for(;s--;){const o=r[s];(!t||kg(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const r=this,s={};return ze.forEach(this,(a,o)=>{const i=ze.findKey(s,o);if(i){r[i]=Ip(a),delete r[o];return}const l=t?G7(o):String(o).trim();l!==o&&delete r[o],r[l]=Ip(a),s[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ze.forEach(this,(s,a)=>{s!=null&&s!==!1&&(r[a]=t&&ze.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Xw]=this[Xw]={accessors:{}}).accessors,a=this.prototype;function o(i){const l=zd(i);s[l]||(V7(a,i),s[l]=!0)}return ze.isArray(t)?t.forEach(o):o(t),this}}vf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ze.reduceDescriptors(vf.prototype,({value:n},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(s){this[r]=s}}});ze.freezeMethods(vf);const Ya=vf;function Cg(n,t){const r=this||Ib,s=t||r,a=Ya.from(s.headers);let o=s.data;return ze.forEach(n,function(l){o=l.call(r,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function Jk(n){return!!(n&&n.__CANCEL__)}function _d(n,t,r){cr.call(this,n??"canceled",cr.ERR_CANCELED,t,r),this.name="CanceledError"}ze.inherits(_d,cr,{__CANCEL__:!0});function Xk(n,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?n(r):t(new cr("Request failed with status code "+r.status,[cr.ERR_BAD_REQUEST,cr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function K7(n){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return t&&t[1]||""}function J7(n,t){n=n||10;const r=new Array(n),s=new Array(n);let a=0,o=0,i;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=s[o];i||(i=d),r[a]=c,s[a]=d;let h=o,p=0;for(;h!==a;)p+=r[h++],h=h%n;if(a=(a+1)%n,a===o&&(o=(o+1)%n),d-i<t)return;const g=u&&d-u;return g?Math.round(p*1e3/g):void 0}}function X7(n,t){let r=0,s=1e3/t,a,o;const i=(d,u=Date.now())=>{r=u,a=null,o&&(clearTimeout(o),o=null),n.apply(null,d)};return[(...d)=>{const u=Date.now(),h=u-r;h>=s?i(d,u):(a=d,o||(o=setTimeout(()=>{o=null,i(a)},s-h)))},()=>a&&i(a)]}const Cm=(n,t,r=3)=>{let s=0;const a=J7(50,250);return X7(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,c=i-s,d=a(c),u=i<=l;s=i;const h={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-i)/d:void 0,event:o,lengthComputable:l!=null,[t?"download":"upload"]:!0};n(h)},r)},Qw=(n,t)=>{const r=n!=null;return[s=>t[0]({lengthComputable:r,total:n,loaded:s}),t[1]]},Zw=n=>(...t)=>ze.asap(()=>n(...t)),Q7=js.hasStandardBrowserEnv?((n,t)=>r=>(r=new URL(r,js.origin),n.protocol===r.protocol&&n.host===r.host&&(t||n.port===r.port)))(new URL(js.origin),js.navigator&&/(msie|trident)/i.test(js.navigator.userAgent)):()=>!0,Z7=js.hasStandardBrowserEnv?{write(n,t,r,s,a,o){const i=[n+"="+encodeURIComponent(t)];ze.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),ze.isString(s)&&i.push("path="+s),ze.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(n){const t=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ez(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function tz(n,t){return t?n.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):n}function Qk(n,t,r){let s=!ez(t);return n&&(s||r==!1)?tz(n,t):t}const ej=n=>n instanceof Ya?{...n}:n;function Ul(n,t){t=t||{};const r={};function s(d,u,h,p){return ze.isPlainObject(d)&&ze.isPlainObject(u)?ze.merge.call({caseless:p},d,u):ze.isPlainObject(u)?ze.merge({},u):ze.isArray(u)?u.slice():u}function a(d,u,h,p){if(ze.isUndefined(u)){if(!ze.isUndefined(d))return s(void 0,d,h,p)}else return s(d,u,h,p)}function o(d,u){if(!ze.isUndefined(u))return s(void 0,u)}function i(d,u){if(ze.isUndefined(u)){if(!ze.isUndefined(d))return s(void 0,d)}else return s(void 0,u)}function l(d,u,h){if(h in t)return s(d,u);if(h in n)return s(void 0,d)}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,u,h)=>a(ej(d),ej(u),h,!0)};return ze.forEach(Object.keys(Object.assign({},n,t)),function(u){const h=c[u]||a,p=h(n[u],t[u],u);ze.isUndefined(p)&&h!==l||(r[u]=p)}),r}const Zk=n=>{const t=Ul({},n);let{data:r,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:l}=t;t.headers=i=Ya.from(i),t.url=Gk(Qk(t.baseURL,t.url,t.allowAbsoluteUrls),n.params,n.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(ze.isFormData(r)){if(js.hasStandardBrowserEnv||js.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...u]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...u].join("; "))}}if(js.hasStandardBrowserEnv&&(s&&ze.isFunction(s)&&(s=s(t)),s||s!==!1&&Q7(t.url))){const d=a&&o&&Z7.read(o);d&&i.set(a,d)}return t},rz=typeof XMLHttpRequest<"u",nz=rz&&function(n){return new Promise(function(r,s){const a=Zk(n);let o=a.data;const i=Ya.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,h,p,g,f;function m(){g&&g(),f&&f(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let v=new XMLHttpRequest;v.open(a.method.toUpperCase(),a.url,!0),v.timeout=a.timeout;function b(){if(!v)return;const x=Ya.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),S={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:n,request:v};Xk(function(C){r(C),m()},function(C){s(C),m()},S),v=null}"onloadend"in v?v.onloadend=b:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(b)},v.onabort=function(){v&&(s(new cr("Request aborted",cr.ECONNABORTED,n,v)),v=null)},v.onerror=function(){s(new cr("Network Error",cr.ERR_NETWORK,n,v)),v=null},v.ontimeout=function(){let j=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const S=a.transitional||Vk;a.timeoutErrorMessage&&(j=a.timeoutErrorMessage),s(new cr(j,S.clarifyTimeoutError?cr.ETIMEDOUT:cr.ECONNABORTED,n,v)),v=null},o===void 0&&i.setContentType(null),"setRequestHeader"in v&&ze.forEach(i.toJSON(),function(j,S){v.setRequestHeader(S,j)}),ze.isUndefined(a.withCredentials)||(v.withCredentials=!!a.withCredentials),l&&l!=="json"&&(v.responseType=a.responseType),d&&([p,f]=Cm(d,!0),v.addEventListener("progress",p)),c&&v.upload&&([h,g]=Cm(c),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",g)),(a.cancelToken||a.signal)&&(u=x=>{v&&(s(!x||x.type?new _d(null,n,v):x),v.abort(),v=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const w=K7(a.url);if(w&&js.protocols.indexOf(w)===-1){s(new cr("Unsupported protocol "+w+":",cr.ERR_BAD_REQUEST,n));return}v.send(o||null)})},sz=(n,t)=>{const{length:r}=n=n?n.filter(Boolean):[];if(t||r){let s=new AbortController,a;const o=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;s.abort(u instanceof cr?u:new _d(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,o(new cr(`timeout ${t} of ms exceeded`,cr.ETIMEDOUT))},t);const l=()=>{n&&(i&&clearTimeout(i),i=null,n.forEach(d=>{d.unsubscribe?d.unsubscribe(o):d.removeEventListener("abort",o)}),n=null)};n.forEach(d=>d.addEventListener("abort",o));const{signal:c}=s;return c.unsubscribe=()=>ze.asap(l),c}},az=sz,oz=function*(n,t){let r=n.byteLength;if(!t||r<t){yield n;return}let s=0,a;for(;s<r;)a=s+t,yield n.slice(s,a),s=a},iz=async function*(n,t){for await(const r of lz(n))yield*oz(r,t)},lz=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const t=n.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},tj=(n,t,r,s)=>{const a=iz(n,t);let o=0,i,l=c=>{i||(i=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let h=u.byteLength;if(r){let p=o+=h;r(p)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},wf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",eC=wf&&typeof ReadableStream=="function",cz=wf&&(typeof TextEncoder=="function"?(n=>t=>n.encode(t))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),tC=(n,...t)=>{try{return!!n(...t)}catch{return!1}},dz=eC&&tC(()=>{let n=!1;const t=new Request(js.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!t}),rj=64*1024,Ex=eC&&tC(()=>ze.isReadableStream(new Response("").body)),Nm={stream:Ex&&(n=>n.body)};wf&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Nm[t]&&(Nm[t]=ze.isFunction(n[t])?r=>r[t]():(r,s)=>{throw new cr(`Response type '${t}' is not supported`,cr.ERR_NOT_SUPPORT,s)})})})(new Response);const uz=async n=>{if(n==null)return 0;if(ze.isBlob(n))return n.size;if(ze.isSpecCompliantForm(n))return(await new Request(js.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(ze.isArrayBufferView(n)||ze.isArrayBuffer(n))return n.byteLength;if(ze.isURLSearchParams(n)&&(n=n+""),ze.isString(n))return(await cz(n)).byteLength},hz=async(n,t)=>{const r=ze.toFiniteNumber(n.getContentLength());return r??uz(t)},pz=wf&&(async n=>{let{url:t,method:r,data:s,signal:a,cancelToken:o,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:p}=Zk(n);d=d?(d+"").toLowerCase():"text";let g=az([a,o&&o.toAbortSignal()],i),f;const m=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&dz&&r!=="get"&&r!=="head"&&(v=await hz(u,s))!==0){let S=new Request(t,{method:"POST",body:s,duplex:"half"}),_;if(ze.isFormData(s)&&(_=S.headers.get("content-type"))&&u.setContentType(_),S.body){const[C,N]=Qw(v,Cm(Zw(c)));s=tj(S.body,rj,C,N)}}ze.isString(h)||(h=h?"include":"omit");const b="credentials"in Request.prototype;f=new Request(t,{...p,signal:g,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:b?h:void 0});let w=await fetch(f);const x=Ex&&(d==="stream"||d==="response");if(Ex&&(l||x&&m)){const S={};["status","statusText","headers"].forEach(M=>{S[M]=w[M]});const _=ze.toFiniteNumber(w.headers.get("content-length")),[C,N]=l&&Qw(_,Cm(Zw(l),!0))||[];w=new Response(tj(w.body,rj,C,()=>{N&&N(),m&&m()}),S)}d=d||"text";let j=await Nm[ze.findKey(Nm,d)||"text"](w,n);return!x&&m&&m(),await new Promise((S,_)=>{Xk(S,_,{data:j,headers:Ya.from(w.headers),status:w.status,statusText:w.statusText,config:n,request:f})})}catch(b){throw m&&m(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new cr("Network Error",cr.ERR_NETWORK,n,f),{cause:b.cause||b}):cr.from(b,b&&b.code,n,f)}}),Rx={http:C7,xhr:nz,fetch:pz};ze.forEach(Rx,(n,t)=>{if(n){try{Object.defineProperty(n,"name",{value:t})}catch{}Object.defineProperty(n,"adapterName",{value:t})}});const nj=n=>`- ${n}`,mz=n=>ze.isFunction(n)||n===null||n===!1,rC={getAdapter:n=>{n=ze.isArray(n)?n:[n];const{length:t}=n;let r,s;const a={};for(let o=0;o<t;o++){r=n[o];let i;if(s=r,!mz(r)&&(s=Rx[(i=String(r)).toLowerCase()],s===void 0))throw new cr(`Unknown adapter '${i}'`);if(s)break;a[i||"#"+o]=s}if(!s){const o=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?o.length>1?`since :
`+o.map(nj).join(`
`):" "+nj(o[0]):"as no adapter specified";throw new cr("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:Rx};function Ng(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new _d(null,n)}function sj(n){return Ng(n),n.headers=Ya.from(n.headers),n.data=Cg.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),rC.getAdapter(n.adapter||Ib.adapter)(n).then(function(s){return Ng(n),s.data=Cg.call(n,n.transformResponse,s),s.headers=Ya.from(s.headers),s},function(s){return Jk(s)||(Ng(n),s&&s.response&&(s.response.data=Cg.call(n,n.transformResponse,s.response),s.response.headers=Ya.from(s.response.headers))),Promise.reject(s)})}const nC="1.9.0",jf={};["object","boolean","number","function","string","symbol"].forEach((n,t)=>{jf[n]=function(s){return typeof s===n||"a"+(t<1?"n ":" ")+n}});const aj={};jf.transitional=function(t,r,s){function a(o,i){return"[Axios v"+nC+"] Transitional option '"+o+"'"+i+(s?". "+s:"")}return(o,i,l)=>{if(t===!1)throw new cr(a(i," has been removed"+(r?" in "+r:"")),cr.ERR_DEPRECATED);return r&&!aj[i]&&(aj[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(o,i,l):!0}};jf.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function fz(n,t,r){if(typeof n!="object")throw new cr("options must be an object",cr.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let a=s.length;for(;a-- >0;){const o=s[a],i=t[o];if(i){const l=n[o],c=l===void 0||i(l,o,n);if(c!==!0)throw new cr("option "+o+" must be "+c,cr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new cr("Unknown option "+o,cr.ERR_BAD_OPTION)}}const Dp={assertOptions:fz,validators:jf},ao=Dp.validators;class Tm{constructor(t){this.defaults=t||{},this.interceptors={request:new Jw,response:new Jw}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ul(this.defaults,r);const{transitional:s,paramsSerializer:a,headers:o}=r;s!==void 0&&Dp.assertOptions(s,{silentJSONParsing:ao.transitional(ao.boolean),forcedJSONParsing:ao.transitional(ao.boolean),clarifyTimeoutError:ao.transitional(ao.boolean)},!1),a!=null&&(ze.isFunction(a)?r.paramsSerializer={serialize:a}:Dp.assertOptions(a,{encode:ao.function,serialize:ao.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Dp.assertOptions(r,{baseUrl:ao.spelling("baseURL"),withXsrfToken:ao.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&ze.merge(o.common,o[r.method]);o&&ze.forEach(["delete","get","head","post","put","patch","common"],f=>{delete o[f]}),r.headers=Ya.concat(i,o);const l=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const d=[];this.interceptors.response.forEach(function(m){d.push(m.fulfilled,m.rejected)});let u,h=0,p;if(!c){const f=[sj.bind(this),void 0];for(f.unshift.apply(f,l),f.push.apply(f,d),p=f.length,u=Promise.resolve(r);h<p;)u=u.then(f[h++],f[h++]);return u}p=l.length;let g=r;for(h=0;h<p;){const f=l[h++],m=l[h++];try{g=f(g)}catch(v){m.call(this,v);break}}try{u=sj.call(this,g)}catch(f){return Promise.reject(f)}for(h=0,p=d.length;h<p;)u=u.then(d[h++],d[h++]);return u}getUri(t){t=Ul(this.defaults,t);const r=Qk(t.baseURL,t.url,t.allowAbsoluteUrls);return Gk(r,t.params,t.paramsSerializer)}}ze.forEach(["delete","get","head","options"],function(t){Tm.prototype[t]=function(r,s){return this.request(Ul(s||{},{method:t,url:r,data:(s||{}).data}))}});ze.forEach(["post","put","patch"],function(t){function r(s){return function(o,i,l){return this.request(Ul(l||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}Tm.prototype[t]=r(),Tm.prototype[t+"Form"]=r(!0)});const $p=Tm;class Db{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const s=this;this.promise.then(a=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](a);s._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(l=>{s.subscribe(l),o=l}).then(a);return i.cancel=function(){s.unsubscribe(o)},i},t(function(o,i,l){s.reason||(s.reason=new _d(o,i,l),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Db(function(a){t=a}),cancel:t}}}const gz=Db;function xz(n){return function(r){return n.apply(null,r)}}function yz(n){return ze.isObject(n)&&n.isAxiosError===!0}const Ax={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ax).forEach(([n,t])=>{Ax[t]=n});const bz=Ax;function sC(n){const t=new $p(n),r=Dk($p.prototype.request,t);return ze.extend(r,$p.prototype,t,{allOwnKeys:!0}),ze.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return sC(Ul(n,a))},r}const zn=sC(Ib);zn.Axios=$p;zn.CanceledError=_d;zn.CancelToken=gz;zn.isCancel=Jk;zn.VERSION=nC;zn.toFormData=bf;zn.AxiosError=cr;zn.Cancel=zn.CanceledError;zn.all=function(t){return Promise.all(t)};zn.spread=xz;zn.isAxiosError=yz;zn.mergeConfig=Ul;zn.AxiosHeaders=Ya;zn.formToJSON=n=>Kk(ze.isHTMLForm(n)?new FormData(n):n);zn.getAdapter=rC.getAdapter;zn.HttpStatusCode=bz;zn.default=zn;const Pm=zn;var vz=typeof self=="object"?self.FormData:window.FormData;const wz=Jo(vz);var Cc=null;typeof WebSocket<"u"?Cc=WebSocket:typeof MozWebSocket<"u"?Cc=MozWebSocket:typeof Is<"u"?Cc=Is.WebSocket||Is.MozWebSocket:typeof window<"u"?Cc=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Cc=self.WebSocket||self.MozWebSocket);var jz=Cc;const Sz=Jo(jz);function _z(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function kz(n,t,r){if(lb())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,t);var a=new(n.bind.apply(n,s));return r&&Gu(a,r.prototype),a}function Mx(n){var t=typeof Map=="function"?new Map:void 0;return Mx=function(s){if(s===null||!_z(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(s))return t.get(s);t.set(s,a)}function a(){return kz(s,arguments,Fl(this).constructor)}return a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Gu(a,s)},Mx(n)}function Ix(n){return typeof n=="string"}function oj(n,t){return!!t&&Ix(n)}function Cz(n,t){var r=[];if(Ix(n)&&oj(n,t)){for(var s=0,a=n.length;s<a;s++)if(n.charAt(s)){var o=n.charAt(s),i=t(o,s,n);r[s]=i}}else if(!Ix(n)&&!oj(n,t)){for(var l=0,c=n.length;l<c;l++)if(l in n){var d=n[l],u=t(d,l,n);r[l]=u}}return r}var Nz=function(t){return C9(new Uint8Array(Cz(t,function(r){return r.charCodeAt(0)})))},Tz=function(t){var r={},s=String.fromCharCode,a=t.length,o,i=0,l,c,d=0,u,h="",p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=0;o<64;o++)r[p.charAt(o)]=o;for(c=0;c<a;c++)for(l=r[t.charAt(c)],i=(i<<6)+l,d+=6;d>=8;)((u=i>>>(d-=8)&255)||c<a-2)&&(h+=s(u));return h},ij=function(){function n(t,r,s){Vt(this,n),q(this,"id",void 0),q(this,"data",void 0),q(this,"client",void 0),this.client=t,this.id=r,this.data=s}return sr(n,[{key:"create",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c,d,u,h,p,g,f,m,v,b;return L.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return v={id:this.id,message_template:(a=this.data)===null||a===void 0?void 0:a.message_template,segment_ids:(o=this.data)===null||o===void 0?void 0:o.segment_ids,sender_id:(i=this.data)===null||i===void 0?void 0:i.sender_id,sender_mode:(l=this.data)===null||l===void 0?void 0:l.sender_mode,channel_template:(c=this.data)===null||c===void 0?void 0:c.channel_template,create_channels:(d=this.data)===null||d===void 0?void 0:d.create_channels,show_channels:(u=this.data)===null||u===void 0?void 0:u.show_channels,description:(h=this.data)===null||h===void 0?void 0:h.description,name:(p=this.data)===null||p===void 0?void 0:p.name,skip_push:(g=this.data)===null||g===void 0?void 0:g.skip_push,skip_webhook:(f=this.data)===null||f===void 0?void 0:f.skip_webhook,user_ids:(m=this.data)===null||m===void 0?void 0:m.user_ids},x.next=3,this.client.createCampaign(v);case 3:return b=x.sent,this.id=b.campaign.id,this.data=b.campaign,x.abrupt("return",b);case 7:case"end":return x.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"verifyCampaignId",value:function(){if(!this.id)throw new Error("Campaign id is missing. Either create the campaign using campaign.create() or set the id during instantiation - const campaign = client.campaign(id)")}},{key:"start",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifyCampaignId(),i.next=3,this.client.startCampaign(this.id,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"update",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifyCampaignId(),i.abrupt("return",this.client.updateCampaign(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"delete",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.verifyCampaignId(),o.next=3,this.client.deleteCampaign(this.id);case 3:return o.abrupt("return",o.sent);case 4:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"stop",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.verifyCampaignId(),o.abrupt("return",this.client.stopCampaign(this.id));case 2:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"get",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifyCampaignId(),i.abrupt("return",this.client.getCampaign(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()}]),n}(),Pz=null;function lj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function lh(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):lj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function aC(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=Ez(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(c){function d(u){return c.apply(this,arguments)}return d.toString=function(){return c.toString()},d}(function(c){throw c}),f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(c){function d(u){return c.apply(this,arguments)}return d.toString=function(){return c.toString()},d}(function(c){i=!0,l=c}),f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function Ez(n,t){if(n){if(typeof n=="string")return cj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cj(n,t)}}function cj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function Rz(n,t){n.then().catch(function(r){console.warn("failed to do ".concat(t,", ran into error: "),r)})}var Ml=function(t){return new Promise(function(r){return setTimeout(r,t)})};function Dx(n){return n&&(Object.prototype.toString.call(n)==="[object Function]"||typeof n=="function"||n instanceof Function)}var su={TOKEN_EXPIRED:40,WS_CLOSED_SUCCESS:1e3};function Az(n){return n!==null&&_n(n)==="object"&&(n.readable||typeof n._read=="function")}function Mz(n){return n!=null&&n.constructor!=null&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function Iz(n){return typeof window<"u"&&"File"in window&&n instanceof File}function Dz(n){return typeof window<"u"&&"Blob"in window&&n instanceof Blob}function $z(n){var t={channel_mutes:!0,devices:!0,mutes:!0,total_unread_count:!0,unread_channels:!0,unread_count:!0,unread_threads:!0,invisible:!0,privacy_settings:!0,roles:!0,push_preferences:!0};return t[n]}function Lz(n,t,r){var s=new wz;return Az(n)||Mz(n)||Iz(n)||Dz(n)?t?s.append("file",n,t):s.append("file",n):s.append("file",{uri:n,name:t||n.split("/").reverse()[0],contentType:r||void 0,type:r||void 0}),s}function ys(n){var t=[],r=Array.isArray(n)?n:[n],s=aC(r),a;try{for(s.s();!(a=s.n()).done;){var o=a.value,i=Object.entries(o);i.length>1&&console.warn("client._buildSort() - multiple fields in a single sort object detected. Object's field order is not guaranteed");for(var l=0,c=i;l<c.length;l++){var d=Ql(c[l],2),u=d[0],h=d[1];t.push({field:u,direction:h})}}}catch(p){s.e(p)}finally{s.f()}return t}function Em(n){var t=Math.min(500+n*2e3,25e3),r=Math.min(Math.max(250,(n-1)*2e3),25e3);return Math.floor(Math.random()*(t-r)+r)}function Uc(){return Bz()}function Fd(n){for(var t="",r=0;r<n.length;r++)t+=n[r].toString(16).padStart(2,"0");return t}function Bz(){var n=Fz(16);return n[6]=n[6]&15|64,n[8]=n[8]&191|128,Fd(n.subarray(0,4))+"-"+Fd(n.subarray(4,6))+"-"+Fd(n.subarray(6,8))+"-"+Fd(n.subarray(8,10))+"-"+Fd(n.subarray(10,16))}function Oz(n){for(var t=Math.pow(2,8*n.byteLength/n.length),r=0;r<n.length;r++)n[r]=Math.random()*t}var zz=function(){var n;return typeof crypto<"u"&&typeof((n=crypto)===null||n===void 0?void 0:n.getRandomValues)<"u"?crypto.getRandomValues.bind(crypto):typeof msCrypto<"u"?msCrypto.getRandomValues.bind(msCrypto):Oz}();function Fz(n){var t=new Uint8Array(n);return zz(t),t}function Wz(n){var t={};if(!n)return t;try{Object.getOwnPropertyNames(n).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(n,r)})}catch{return{error:"failed to serialize the error"}}return t}function Uz(){var n=typeof navigator<"u"?navigator:typeof window<"u"&&window.navigator?window.navigator:void 0;return n?typeof n.onLine!="boolean"?!0:n.onLine:(console.warn("isOnline failed to access window.navigator and assume browser is online"),!0)}function oC(n){typeof window<"u"&&window.addEventListener&&(window.addEventListener("offline",n),window.addEventListener("online",n))}function iC(n){typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("offline",n),window.removeEventListener("online",n))}var qz=function(t){var r=[];for(var s in t)t[s]!==void 0&&(Array.isArray(t[s])||_n(t[s])==="object"?r.push("".concat(s,"=").concat(encodeURIComponent(JSON.stringify(t[s])))):r.push("".concat(s,"=").concat(encodeURIComponent(t[s]))));return r.join("&")};function fi(n){return lh(lh({},n),{},{__html:n.html,pinned_at:n.pinned_at?new Date(n.pinned_at):null,created_at:n.created_at?new Date(n.created_at):new Date,updated_at:n.updated_at?new Date(n.updated_at):new Date,deleted_at:n.deleted_at?new Date(n.deleted_at):null,status:n.status||"received",reaction_groups:Hz(n.reaction_groups,n.reaction_counts,n.reaction_scores)})}var lC=function(t){var r=t.needle,s=t.sortedArray,a=t.selectKey,o=t.selectValueToCompare,i=o===void 0?function(w){return w}:o,l=t.sortDirection,c=l===void 0?"ascending":l;if(!s.length)return 0;for(var d=0,u=s.length-1,h=0,p=function(){h=Math.round((d+u)/2)},g=i(r);d<=u;){p();var f=i(s[h]);c==="ascending"&&g<f||c==="descending"&&g>=f?u=h-1:d=h+1}if(a){for(var m=a(r),v=c==="ascending"?-1:1,b=d+v;0<=b&&b<s.length&&i(s[b])===g;b+=v)if(a(s[b])===m)return b}return d};function cC(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"created_at",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=a||r,i=Or(n);if(r&&(i=i.filter(function(u){return!(u.id&&t.id===u.id)})),i.length===0&&o)return i.concat(t);if(i.length===0)return i;var l=t[s].getTime(),c=i.at(-1)[s].getTime()<l;if(c&&o)return i.concat(t);if(c)return i;var d=lC({needle:t,sortedArray:i,sortDirection:"ascending",selectValueToCompare:function(h){return h[s].getTime()},selectKey:function(h){return h.id}});return!r&&t.id&&i[d]&&t.id===i[d].id?(i[d]=t,i):(o&&i.splice(d,0,t),i)}function Hz(n,t,r){if(n)return n;if(t&&r){for(var s={},a=0,o=Object.keys(t);a<o.length;a++){var i=o[a];s[i]={count:t[i],sum_scores:r[i]}}return s}return null}var dC=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=s.leading,o=a===void 0?!0:a,i=s.trailing,l=i===void 0?!1:i,c=null,d=null;return function(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];if(c){l&&(d=h);return}o&&t.apply(void 0,h);var g=function f(){if(d){t.apply(void 0,Or(d)),d=null,c=setTimeout(f,r);return}c=null};c=setTimeout(g,r)}},Yz=function(t,r){return r.split(".").reduce(function(s,a){if(s&&_n(s)==="object"&&a in s)return s[a]},t)},Gz=function(t,r){if(!Array.isArray(t))return[];var s=new Set;return t.filter(function(a){var o=typeof r=="function"?r(a):Yz(a,r);return s.has(o)?!1:(s.add(o),!0)})};function Vz(n,t){for(var r=0,s=n.length-1;r<=s;){var a=Math.floor((r+s)/2),o=n[a].created_at;if(!o){r+=1;continue}var i=new Date(o);if(i.getTime()===t.getTime())return a;i.getTime()<t.getTime()?r=a+1:s=a-1}return r}var Kz=function(t){var r=t.parentSet,s=t.requestedPageSize,a=t.returnedPage,o=t.messagePaginationOptions,i=lh({},r.pagination);if(!(o!=null&&o.created_at_around))return i;var l,c,d,u,h=new Date(o.created_at_around),p=[a[0],a.slice(-1)[0]],g=p[0],f=p[1],m=!!(g!=null&&g.created_at)&&new Date(g.created_at)>h,v=!!(f!=null&&f.created_at)&&new Date(f.created_at)<h,b=s>r.messages.length&&s>a.length,w=(s>r.messages.length||r.messages.length>=a.length)&&s>a.length;if(m)l=!1,d=!0,b&&(c=!1,u=!0);else if(v)c=!1,u=!0,b&&(l=!1,d=!0);else if(w)c=l=!1,d=u=!0;else{var x,j,S=(g==null?void 0:g.id)&&g.id===((x=r.messages[0])===null||x===void 0?void 0:x.id),_=(f==null?void 0:f.id)&&f.id===((j=r.messages.slice(-1)[0])===null||j===void 0?void 0:j.id);d=S,u=_;var C=Math.floor(a.length/2),N=Vz(a,h);N!==-1&&(l=C<=N,c=C>=N)}return d&&typeof l<"u"&&(i.hasPrev=l),u&&typeof c<"u"&&(i.hasNext=c),i},Jz=function(t){var r,s,a=t.parentSet,o=t.requestedPageSize,i=t.returnedPage,l=t.messagePaginationOptions,c=lh({},a.pagination),d=l||{},u=d.id_around;if(!u)return c;var h,p,g=[i[0],i.slice(-1)[0]],f=g[0],m=g[1],v=(f==null?void 0:f.id)===((r=a.messages[0])===null||r===void 0?void 0:r.id),b=(m==null?void 0:m.id)===((s=a.messages.slice(-1)[0])===null||s===void 0?void 0:s.id),w=v,x=b,j=Math.floor(i.length/2),S=(o>a.messages.length||a.messages.length>=i.length)&&o>i.length;if(S)p=h=!1,w=x=!0;else if(i[j])if(i[j].id===u)h=p=!0;else{var _,C=[i.slice(0,j),i.slice(j)];h=p=!0;for(var N=0;N<C.length;N++)_=C[N].find(function(M){return M.id===u}),_&&N===0&&(h=!1),_&&N===1&&(p=!1)}else return c;return w&&typeof h<"u"&&(c.hasPrev=h),x&&typeof p<"u"&&(c.hasNext=p),c},Xz=function(t){var r,s,a=t.parentSet,o=t.requestedPageSize,i=t.returnedPage,l=t.messagePaginationOptions,c=lh({},a.pagination),d,u,h=[i[0],i.slice(-1)[0]],p=h[0],g=h[1],f=(p==null?void 0:p.id)&&p.id===((r=a.messages[0])===null||r===void 0?void 0:r.id),m=(g==null?void 0:g.id)&&g.id===((s=a.messages.slice(-1)[0])===null||s===void 0?void 0:s.id),v=l&&(l.created_at_after_or_equal||l.created_at_after||l.id_gt||l.id_gte),b=typeof l>"u"?!0:l.created_at_before_or_equal||l.created_at_before||l.id_lt||l.id_lte||l.offset,w=!v&&!b&&!(l!=null&&l.id_around)&&!(l!=null&&l.created_at_around),x=i.length>=o;(typeof b<"u"||w)&&(d=x),typeof v<"u"&&(u=x);var j=i.length===0;return(f||j)&&typeof d<"u"&&(c.hasPrev=d),(m||j)&&typeof u<"u"&&(c.hasNext=u),c},uC=function(t){var r,s;if(t.parentSet.messages.length<t.returnedPage.length){var a;return(a=t.logger)===null||a===void 0||a.call(t,"error","Corrupted message set state: parent set size < returned page size"),t.parentSet.pagination}return(r=t.messagePaginationOptions)!==null&&r!==void 0&&r.created_at_around?Kz(t):(s=t.messagePaginationOptions)!==null&&s!==void 0&&s.id_around?Jz(t):Xz(t)},ep={},Tg=function(){var n=pe(L.mark(function t(r){var s,a,o,i,l,c,d,u,h;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(s=r.channel,a=r.client,o=r.id,i=r.members,l=r.options,c=r.type,!(!s&&!c)){g.next=3;break}throw new Error("Channel or channel type have to be provided to query a channel.");case 3:if(d=s||a.channel(c,o,{members:i}),u=d.id?d.cid:i&&i.length?$b(d.type,i):void 0,u){g.next=7;break}throw new Error("Channel ID or channel members array have to be provided to query a channel.");case 7:if(h=ep[u],!h){g.next=13;break}return g.next=11,h;case 11:g.next=20;break;case 13:return g.prev=13,ep[u]=d.watch(l),g.next=17,ep[u];case 17:return g.prev=17,delete ep[u],g.finish(17);case 20:return g.abrupt("return",d);case 21:case"end":return g.stop()}},t,null,[[13,,17,20]])}));return function(r){return n.apply(this,arguments)}}(),$b=function(t,r){if(r){var s=Or(r).sort().join(",");if(s)return"".concat(t,":!members-").concat(s)}},Rm=function(t){if(!t)return!1;var r=t.state.membership;return!!(r!=null&&r.pinned_at)},tp=function(t){if(!t)return!1;var r=t.state.membership;return!!(r!=null&&r.archived_at)},rp=function(t){return t?typeof t.archived=="boolean":!1},hC=function(t){var r,s,a=t.atIndex,o=t.sort,i=t.targetKey;if(!o)return null;var l=null;if(Array.isArray(o)){var c;l=(c=o[a])!==null&&c!==void 0?c:null}else{var d=0;for(var u in o){if(d!==a){d++;continue}if(u!==i)return null;l=o;break}}return(r=(s=l)===null||s===void 0?void 0:s[i])!==null&&r!==void 0?r:null},$x=function(t){var r=Qz({sort:t});return typeof r!="number"?!1:Math.abs(r)===1},Qz=function(t){var r=t.sort;return hC({atIndex:0,sort:r,targetKey:"pinned_at"})},pC=function(t){var r=t.channels,s=null,a=aC(r),o;try{for(a.s();!(o=a.n()).done;){var i=o.value;if(!Rm(i))break;typeof s=="number"?s++:s=0}}catch(l){a.e(l)}finally{a.f()}return s},np=function(t){var r=t.channels,s=t.channelToMove,a=t.channelToMoveIndexWithinChannels,o=t.sort,i=a??r.findIndex(function(g){return g.cid===s.cid}),l=i>=0,c=i===0,d=$x(o),u=Rm(s);if(c||d&&u)return r;var h=Or(r);l&&h.splice(i,1);var p=null;return d&&(p=pC({channels:h})),h.splice(typeof p=="number"?p+1:0,0,s),h},Zz=25,eF=100,Pg={hasNext:!1,hasPrev:!1};function dj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function oo(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):dj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var tF=function(){function n(t){var r=this,s;Vt(this,n),q(this,"_channel",void 0),q(this,"watcher_count",void 0),q(this,"typing",void 0),q(this,"read",void 0),q(this,"pinnedMessages",void 0),q(this,"pending_messages",void 0),q(this,"threads",void 0),q(this,"mutedUsers",void 0),q(this,"watchers",void 0),q(this,"members",void 0),q(this,"unreadCount",void 0),q(this,"membership",void 0),q(this,"last_message_at",void 0),q(this,"isUpToDate",void 0),q(this,"messageSets",[]),q(this,"formatMessage",function(a){return fi(a)}),q(this,"setIsUpToDate",function(a){r.isUpToDate=a}),q(this,"removeMessageFromArray",function(a,o){var i=a.filter(function(l){return!(l.id&&o.id&&l.id===o.id)});return{removed:i.length<a.length,result:i}}),q(this,"updateUserMessages",function(a){var o=function(c,d){for(var u=0;u<c.length;u++){var h,p=c[u];((h=p.user)===null||h===void 0?void 0:h.id)===d.id&&(c[u]=oo(oo({},p),{},{user:d}))}};r.messageSets.forEach(function(l){return o(l.messages,a)});for(var i in r.threads)o(r.threads[i],a);o(r.pinnedMessages,a)}),q(this,"deleteUserMessages",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=function(d,u){for(var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=0;p<d.length;p++){var g,f=d[p];((g=f.user)===null||g===void 0?void 0:g.id)===u.id&&(h?d[p]={cid:f.cid,created_at:f.created_at,deleted_at:u.deleted_at,id:f.id,latest_reactions:[],mentioned_users:[],own_reactions:[],parent_id:f.parent_id,reply_count:f.reply_count,status:f.status,thread_participants:f.thread_participants,type:"deleted",updated_at:f.updated_at,user:f.user}:d[p]=oo(oo({},f),{},{type:"deleted",deleted_at:u.deleted_at?new Date(u.deleted_at):null}))}};r.messageSets.forEach(function(c){return i(c.messages,a,o)});for(var l in r.threads)i(r.threads[l],a,o);i(r.pinnedMessages,a,o)}),this._channel=t,this.watcher_count=0,this.typing={},this.read={},this.initMessages(),this.pinnedMessages=[],this.pending_messages=[],this.threads={},this.mutedUsers=[],this.watchers={},this.members={},this.membership={},this.unreadCount=0,this.isUpToDate=!0,this.last_message_at=(t==null||(s=t.state)===null||s===void 0?void 0:s.last_message_at)!=null?new Date(t.state.last_message_at):null}return sr(n,[{key:"messages",get:function(){var r;return((r=this.messageSets.find(function(s){return s.isCurrent}))===null||r===void 0?void 0:r.messages)||[]},set:function(r){var s=this.messageSets.findIndex(function(a){return a.isCurrent});this.messageSets[s].messages=r}},{key:"latestMessages",get:function(){var r;return((r=this.messageSets.find(function(s){return s.isLatest}))===null||r===void 0?void 0:r.messages)||[]},set:function(r){var s=this.messageSets.findIndex(function(a){return a.isLatest});this.messageSets[s].messages=r}},{key:"messagePagination",get:function(){var r;return((r=this.messageSets.find(function(s){return s.isCurrent}))===null||r===void 0?void 0:r.pagination)||Pg}},{key:"addMessageSorted",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"latest";return this.addMessagesSorted([r],s,!1,a,o)}},{key:"addMessagesSorted",value:function(r){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"current",l=this.findTargetMessageSet(r,o,i),c=l.messagesToAdd,d=l.targetMessageSetIndex,u=0;u<c.length;u+=1){var h=c[u].shadowed;if(!h){var p=c[u].created_at instanceof Date,g=void 0;if(p)g=c[u];else{var f;g=this.formatMessage(c[u]),g.user&&(f=this._channel)!==null&&f!==void 0&&f.cid&&this._channel.getClient().state.updateUserReference(g.user,this._channel.cid),a&&g.id&&this.threads[g.id]&&delete this.threads[g.id],this.last_message_at||(this.last_message_at=new Date(g.created_at.getTime())),g.created_at.getTime()>this.last_message_at.getTime()&&(this.last_message_at=new Date(g.created_at.getTime()))}var m=g.parent_id;if((!m||g.show_in_channel)&&d!==-1&&(this.messageSets[d].messages=this._addToMessageList(this.messageSets[d].messages,g,s,"created_at",o)),m&&!a){var v=this.threads[m]||[];this.threads[m]=this._addToMessageList(v,g,s,"created_at",o)}}}return{messageSet:this.messageSets[d]}}},{key:"addPinnedMessages",value:function(r){for(var s=0;s<r.length;s+=1)this.addPinnedMessage(r[s])}},{key:"addPinnedMessage",value:function(r){this.pinnedMessages=this._addToMessageList(this.pinnedMessages,this.formatMessage(r),!1,"pinned_at")}},{key:"removePinnedMessage",value:function(r){var s=this.removeMessageFromArray(this.pinnedMessages,r),a=s.result;this.pinnedMessages=a}},{key:"addReaction",value:function(r,s,a){var o=this;if(s){var i=s;return this._updateMessage(s,function(l){return i.own_reactions=o._addOwnReactionToMessage(l.own_reactions,r,a),o.formatMessage(i)}),i}}},{key:"_addOwnReactionToMessage",value:function(r,s,a){return a?r=[]:r=this._removeOwnReactionFromMessage(r,s),r=r||[],this._channel.getClient().userID===s.user_id&&r.push(s),r}},{key:"_removeOwnReactionFromMessage",value:function(r,s){return r&&r.filter(function(a){return a.user_id!==s.user_id||a.type!==s.type})}},{key:"removeReaction",value:function(r,s){var a=this;if(s){var o=s;return this._updateMessage(s,function(i){return o.own_reactions=a._removeOwnReactionFromMessage(i.own_reactions,r),a.formatMessage(o)}),o}}},{key:"_updateQuotedMessageReferences",value:function(r){var s=this,a=r.message,o=r.remove,i=function(d){var u,h;return oo(oo({},d),{},{created_at:d.created_at.toISOString(),pinned_at:(u=d.pinned_at)===null||u===void 0?void 0:u.toISOString(),updated_at:(h=d.updated_at)===null||h===void 0?void 0:h.toISOString()})},l=function(d){var u=d.reduce(function(h,p){return p.quoted_message_id===a.id&&h.push(oo(oo({},i(p)),{},{quoted_message:o?oo(oo({},a),{},{attachments:[]}):a})),h},[]);s.addMessagesSorted(u,!0)};a.parent_id?a.parent_id&&this.threads[a.parent_id]&&l(this.threads[a.parent_id]):this.messageSets.forEach(function(c){return l(c.messages)})}},{key:"removeQuotedMessageReferences",value:function(r){this._updateQuotedMessageReferences({message:r,remove:!0})}},{key:"_updateMessage",value:function(r,s){var a=r.parent_id,o=r.show_in_channel,i=r.pinned;if(a&&this.threads[a]){var l=this.threads[a],c=l.findIndex(function(p){return p.id===r.id});c!==-1&&(l[c]=s(l[c]),this.threads[a]=l)}if(!o&&!a||o){var d=this.findMessageSetIndex(r);if(d!==-1){var u=this.messageSets[d].messages.findIndex(function(p){return p.id===r.id});u!==-1&&(this.messageSets[d].messages[u]=s(this.messageSets[d].messages[u]))}}if(i){var h=this.pinnedMessages.findIndex(function(p){return p.id===r.id});h!==-1&&(this.pinnedMessages[h]=s(this.pinnedMessages[h]))}}},{key:"_addToMessageList",value:function(r,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"created_at",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return cC(r,s,a,o,i)}},{key:"removeMessage",value:function(r){var s=!1;if(r.parent_id&&this.threads[r.parent_id]){var a=this.removeMessageFromArray(this.threads[r.parent_id],r),o=a.removed,i=a.result;this.threads[r.parent_id]=i,s=o}else{var l,c=(l=r.messageSetIndex)!==null&&l!==void 0?l:this.findMessageSetIndex(r);if(c!==-1){var d=this.removeMessageFromArray(this.messageSets[c].messages,r),u=d.removed,h=d.result;this.messageSets[c].messages=h,s=u}}return s}},{key:"filterErrorMessages",value:function(){var r=this.latestMessages.filter(function(s){return s.type!=="error"});this.latestMessages=r}},{key:"clean",value:function(){for(var r=new Date,s=0,a=Object.entries(this.typing);s<a.length;s++){var o=Ql(a[s],2),i=o[0],l=o[1],c=typeof l.received_at=="string"?new Date(l.received_at):l.received_at||new Date;r.getTime()-c.getTime()>7e3&&(delete this.typing[i],this._channel.getClient().dispatchEvent({cid:this._channel.cid,type:"typing.stop",user:{id:i}}))}}},{key:"clearMessages",value:function(){this.initMessages(),this.pinnedMessages=[]}},{key:"initMessages",value:function(){this.messageSets=[{messages:[],isLatest:!0,isCurrent:!0,pagination:Pg}]}},{key:"loadMessageIntoState",value:function(){var t=pe(L.mark(function s(a,o){var i,l,c,d,u,h,p=arguments;return L.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l=p.length>2&&p[2]!==void 0?p[2]:25,d=!1,u=!1,h=o||a,a!=="latest"){f.next=10;break}if(this.messages!==this.latestMessages){f.next=7;break}return f.abrupt("return");case 7:c=this.messageSets.findIndex(function(m){return m.isLatest}),f.next=11;break;case 10:c=this.findMessageSetIndex({id:h});case 11:if(c!==-1&&(this.switchToMessageSet(c),d=!0),u=!o||!!((i=this.threads[o])!==null&&i!==void 0&&i.find(function(m){return m.id===a})),!(d&&u)){f.next=15;break}return f.abrupt("return");case 15:if(d){f.next=18;break}return f.next=18,this._channel.query({messages:{id_around:h,limit:l}},"new");case 18:if(!(!u&&o)){f.next=21;break}return f.next=21,this._channel.getReplies(o,{id_around:a,limit:l});case 21:c=this.findMessageSetIndex({id:h}),c!==-1&&this.switchToMessageSet(c);case 23:case"end":return f.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"findMessage",value:function(r,s){if(s){var a=this.threads[s];return a?a.find(function(i){return i.id===r}):void 0}var o=this.findMessageSetIndex({id:r});if(o!==-1)return this.messageSets[o].messages.find(function(i){return i.id===r})}},{key:"switchToMessageSet",value:function(r){var s=this.messageSets.find(function(a){return a.isCurrent});s&&(s.isCurrent=!1,this.messageSets[r].isCurrent=!0)}},{key:"areMessageSetsOverlap",value:function(r,s){return r.some(function(a){return s.find(function(o){return a.id===o.id})})}},{key:"findMessageSetIndex",value:function(r){return this.messageSets.findIndex(function(s){return!!s.messages.find(function(a){return a.id===r.id})})}},{key:"findTargetMessageSet",value:function(r){var s=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"current",i=r,l;if(a){var c=this.messageSets.map(function(f,m){return m}).filter(function(f){return s.areMessageSetsOverlap(s.messageSets[f].messages,r)});switch(o){case"new":c.length>0?l=c[0]:r.some(function(f){return!f.parent_id})&&(this.messageSets.push({messages:[],isCurrent:!1,isLatest:!1,pagination:Pg}),l=this.messageSets.length-1);break;case"current":l=this.messageSets.findIndex(function(f){return f.isCurrent});break;case"latest":l=this.messageSets.findIndex(function(f){return f.isLatest});break;default:l=-1}var d=c.splice(0,1)[0],u=Or(c);if(d!==void 0&&d!==l&&u.push(l),u.length>0){var h=this.messageSets[d],p=this.messageSets.filter(function(f,m){return u.indexOf(m)!==-1});p.forEach(function(f){h.isLatest=h.isLatest||f.isLatest,h.isCurrent=h.isCurrent||f.isCurrent,h.pagination.hasPrev=f.messages[0].created_at<h.messages[0].created_at?f.pagination.hasPrev:h.pagination.hasPrev,h.pagination.hasNext=h.messages.slice(-1)[0].created_at<f.messages.slice(-1)[0].created_at?f.pagination.hasNext:h.pagination.hasNext,i=[].concat(Or(i),Or(f.messages))}),p.forEach(function(f){return s.messageSets.splice(s.messageSets.indexOf(f),1)});var g=this.messageSets.findIndex(function(f){return s.areMessageSetsOverlap(f.messages,r)});l=g}}else l=this.findMessageSetIndex(r[0]);return{targetMessageSetIndex:l,messagesToAdd:i}}}]),n}();function Eg(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=rF(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(d){i=!0,l=d},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function rF(n,t){if(n){if(typeof n=="string")return uj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uj(n,t)}}function uj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function hj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function zt(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):hj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var Rg=function(){function n(t,r,s,a){var o=this;Vt(this,n),q(this,"_client",void 0),q(this,"type",void 0),q(this,"id",void 0),q(this,"data",void 0),q(this,"_data",void 0),q(this,"cid",void 0),q(this,"listeners",void 0),q(this,"state",void 0),q(this,"initialized",void 0),q(this,"offlineMode",void 0),q(this,"lastKeyStroke",void 0),q(this,"lastTypingEvent",void 0),q(this,"isTyping",void 0),q(this,"disconnected",void 0),q(this,"push_preferences",void 0),q(this,"create",function(){var c=pe(L.mark(function d(u){var h;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return h=zt(zt({},u),{},{watch:!1,state:!1,presence:!1}),g.next=3,o.query(h,"latest");case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),q(this,"_callChannelListeners",function(c){var d=o,u=[];d.listeners.all&&u.push.apply(u,Or(d.listeners.all)),d.listeners[c.type]&&u.push.apply(u,Or(d.listeners[c.type]));for(var h=0,p=u;h<p.length;h++){var g=p[h];typeof g!="string"&&g(c)}}),q(this,"_channelURL",function(){if(!o.id)throw new Error("channel id is not defined");return"".concat(o.getClient().baseURL,"/channels/").concat(encodeURIComponent(o.type),"/").concat(encodeURIComponent(o.id))});var i=/^[\w_-]+$/,l=/^[\w!_-]+$/;if(!i.test(r))throw new Error("Invalid chat type ".concat(r,', letters, numbers and "_-" are allowed'));if(typeof s=="string"&&!l.test(s))throw new Error("Invalid chat id ".concat(s,', letters, numbers and "!-_" are allowed'));this._client=t,this.type=r,this.id=s,this.data=a,this._data=zt({},a),this.cid="".concat(r,":").concat(s),this.listeners={},this.state=new tF(this),this.initialized=!1,this.offlineMode=!1,this.lastTypingEvent=null,this.isTyping=!1,this.disconnected=!1}return sr(n,[{key:"getClient",value:function(){if(this.disconnected===!0)throw Error("You can't use a channel after client.disconnect() was called");return this._client}},{key:"getConfig",value:function(){var r=this.getClient();return r.configs[this.cid]}},{key:"sendMessage",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getClient().post(this._channelURL()+"/message",zt({message:a},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"sendFile",value:function(r,s,a,o){return this.getClient().sendFile("".concat(this._channelURL(),"/file"),r,s,a,o)}},{key:"sendImage",value:function(r,s,a,o){return this.getClient().sendFile("".concat(this._channelURL(),"/image"),r,s,a,o)}},{key:"deleteFile",value:function(r){return this.getClient().delete("".concat(this._channelURL(),"/file"),{url:r})}},{key:"deleteImage",value:function(r){return this.getClient().delete("".concat(this._channelURL(),"/image"),{url:r})}},{key:"sendEvent",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this._checkInitialized(),i.next=3,this.getClient().post(this._channelURL()+"/event",{event:a});case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"search",value:function(){var t=pe(L.mark(function s(a){var o,i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(o=l.length>1&&l[1]!==void 0?l[1]:{},!(o.offset&&o.next)){d.next=3;break}throw Error("Cannot specify offset with next");case 3:if(i=zt(zt({filter_conditions:{cid:this.cid}},o),{},{sort:o.sort?ys(o.sort):void 0}),typeof a!="string"){d.next=8;break}i.query=a,d.next=13;break;case 8:if(_n(a)!=="object"){d.next=12;break}i.message_filter_conditions=a,d.next=13;break;case 12:throw Error("Invalid type ".concat(_n(a)," for query parameter"));case 13:return d.next=15,this.getClient().wsPromise;case 15:return d.next=17,this.getClient().get(this.getClient().baseURL+"/search",{payload:i});case 17:return d.abrupt("return",d.sent);case 18:case"end":return d.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryMembers",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u,h=arguments;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return i=h.length>1&&h[1]!==void 0?h[1]:[],l=h.length>2&&h[2]!==void 0?h[2]:{},d=this.type,this.id?c=this.id:(o=this.data)!==null&&o!==void 0&&o.members&&Array.isArray(this.data.members)&&(u=this.data.members),g.next=6,this.getClient().get(this.getClient().baseURL+"/members",{payload:zt({type:d,id:c,members:u,sort:ys(i),filter_conditions:a},l)});case 6:return g.abrupt("return",g.sent);case 7:case"end":return g.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"updateMemberPartial",value:function(){var t=pe(L.mark(function s(a,o){var i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=new URL("".concat(this._channelURL(),"/member")),o!=null&&o.userId&&i.searchParams.append("user_id",o.userId),c.next=4,this.getClient().patch(i.toString(),a);case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"partialUpdateMember",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a){l.next=2;break}throw Error("Please specify the user id");case 2:return l.next=4,this.getClient().patch(this._channelURL()+"/member/".concat(encodeURIComponent(a)),o);case 4:return l.abrupt("return",l.sent);case 5:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"sendReaction",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a){c.next=2;break}throw Error("Message id is missing");case 2:if(!(!o||Object.keys(o).length===0)){c.next=4;break}throw Error("Reaction object is missing");case 4:return c.next=6,this.getClient().post(this.getClient().baseURL+"/messages/".concat(encodeURIComponent(a),"/reaction"),zt({reaction:o},i));case 6:return c.abrupt("return",c.sent);case 7:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"deleteReaction",value:function(r,s,a){if(this._checkInitialized(),!s||!r)throw Error("Deleting a reaction requires specifying both the message and reaction type");var o=this.getClient().baseURL+"/messages/".concat(encodeURIComponent(r),"/reaction/").concat(encodeURIComponent(s));return a?this.getClient().delete(o,{user_id:a}):this.getClient().delete(o,{})}},{key:"update",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=c.length>0&&c[0]!==void 0?c[0]:{},o=c.length>1?c[1]:void 0,i=c.length>2?c[2]:void 0,l=["config","cid","created_by","id","member_count","type","created_at","updated_at","last_message_at","own_capabilities"],l.forEach(function(h){delete a[h]}),u.next=7,this._update(zt({message:o,data:a},i));case 7:return u.abrupt("return",u.sent);case 8:case"end":return u.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"updatePartial",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.getClient().patch(this._channelURL(),a);case 2:return l=u.sent,c=Or(l.channel.own_capabilities||[]).sort().join()!==Or(Array.isArray((o=this.data)===null||o===void 0?void 0:o.own_capabilities)?(i=this.data)===null||i===void 0?void 0:i.own_capabilities:[]).sort().join(),this.data=l.channel,c&&this.getClient().dispatchEvent({type:"capabilities.changed",cid:this.cid,own_capabilities:l.channel.own_capabilities}),u.abrupt("return",l);case 7:case"end":return u.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"enableSlowMode",value:function(){var t=pe(L.mark(function s(a){var o;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getClient().post(this._channelURL(),{cooldown:a});case 2:return o=l.sent,this.data=o.channel,l.abrupt("return",o);case 5:case"end":return l.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"disableSlowMode",value:function(){var t=pe(L.mark(function s(){var a;return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getClient().post(this._channelURL(),{cooldown:0});case 2:return a=i.sent,this.data=a.channel,i.abrupt("return",a);case 5:case"end":return i.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"delete",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.getClient().delete(this._channelURL(),zt({},a));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"truncate",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.getClient().post(this._channelURL()+"/truncate",a);case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"acceptInvite",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this._update(zt({accept_invite:!0},a));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"rejectInvite",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this._update(zt({reject_invite:!0},a));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"addMembers",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({add_members:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"addModerators",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({add_moderators:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"assignRoles",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({assign_roles:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"inviteMembers",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({invites:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"removeMembers",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({remove_members:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"demoteModerators",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this._update(zt({demote_moderators:a,message:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"_update",value:function(){var t=pe(L.mark(function s(a){var o;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.getClient().post(this._channelURL(),a);case 2:return o=l.sent,this.data=o.channel,l.abrupt("return",o);case 5:case"end":return l.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"mute",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.getClient().post(this.getClient().baseURL+"/moderation/mute/channel",zt({channel_cid:this.cid},a));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"unmute",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.getClient().post(this.getClient().baseURL+"/moderation/unmute/channel",zt({channel_cid:this.cid},a));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"archive",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=c.length>0&&c[0]!==void 0?c[0]:{},o=this.getClient(),i=a.user_id||o.userID,i){u.next=5;break}throw Error("A user_id is required for archiving a channel");case 5:return u.next=7,this.partialUpdateMember(i,{set:{archived:!0}});case 7:return l=u.sent,u.abrupt("return",l.channel_member);case 9:case"end":return u.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"unarchive",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=c.length>0&&c[0]!==void 0?c[0]:{},o=this.getClient(),i=a.user_id||o.userID,i){u.next=5;break}throw Error("A user_id is required for unarchiving a channel");case 5:return u.next=7,this.partialUpdateMember(i,{set:{archived:!1}});case 7:return l=u.sent,u.abrupt("return",l.channel_member);case 9:case"end":return u.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"pin",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=c.length>0&&c[0]!==void 0?c[0]:{},o=this.getClient(),i=a.user_id||o.userID,i){u.next=5;break}throw new Error("A user_id is required for pinning a channel");case 5:return u.next=7,this.partialUpdateMember(i,{set:{pinned:!0}});case 7:return l=u.sent,u.abrupt("return",l.channel_member);case 9:case"end":return u.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"unpin",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=c.length>0&&c[0]!==void 0?c[0]:{},o=this.getClient(),i=a.user_id||o.userID,i){u.next=5;break}throw new Error("A user_id is required for unpinning a channel");case 5:return u.next=7,this.partialUpdateMember(i,{set:{pinned:!1}});case 7:return l=u.sent,u.abrupt("return",l.channel_member);case 9:case"end":return u.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"muteStatus",value:function(){return this._checkInitialized(),this.getClient()._muteStatus(this.cid)}},{key:"sendAction",value:function(r,s){if(this._checkInitialized(),!r)throw Error("Message id is missing");return this.getClient().post(this.getClient().baseURL+"/messages/".concat(encodeURIComponent(r),"/action"),{message_id:r,form_data:s,id:this.id,type:this.type})}},{key:"keystroke",value:function(){var t=pe(L.mark(function s(a,o){var i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this._isTypingIndicatorsEnabled()){d.next=2;break}return d.abrupt("return");case 2:if(i=new Date,l=this.lastTypingEvent&&i.getTime()-this.lastTypingEvent.getTime(),this.lastKeyStroke=i,this.isTyping=!0,!(l===null||l>2e3)){d.next=10;break}return this.lastTypingEvent=new Date,d.next=10,this.sendEvent(zt({type:"typing.start",parent_id:a},o||{}));case 10:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"updateAIState",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.sendEvent(zt(zt({},i),{},{type:"ai_indicator.update",message_id:a,ai_state:o}));case 3:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"clearAIIndicator",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.sendEvent({type:"ai_indicator.clear"});case 2:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"stopAIResponse",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.sendEvent({type:"ai_indicator.stop"});case 2:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"stopTyping",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._isTypingIndicatorsEnabled()){l.next=2;break}return l.abrupt("return");case 2:return this.lastTypingEvent=null,this.isTyping=!1,l.next=6,this.sendEvent(zt({type:"typing.stop",parent_id:a},o||{}));case 6:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"_isTypingIndicatorsEnabled",value:function(){var r,s,a,o,i;return(r=this.getConfig())!==null&&r!==void 0&&r.typing_events?(s=(a=this.getClient().user)===null||a===void 0||(o=a.privacy_settings)===null||o===void 0||(i=o.typing_indicators)===null||i===void 0?void 0:i.enabled)!==null&&s!==void 0?s:!0:!1}},{key:"lastMessage",value:function(){var r=this.state.latestMessages.length-5;r<0&&(r=0);var s=this.state.latestMessages.length+1,a=this.state.latestMessages.slice(r,s);return a.sort(function(o,i){return i.created_at.getTime()-o.created_at.getTime()}),a[0]}},{key:"markRead",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=i.length>0&&i[0]!==void 0?i[0]:{},this._checkInitialized(),!(!((a=this.getConfig())!==null&&a!==void 0&&a.read_events)&&!this.getClient()._isUsingServerAuth())){c.next=4;break}return c.abrupt("return",Promise.resolve(null));case 4:return c.next=6,this.getClient().post(this._channelURL()+"/read",zt({},o));case 6:return c.abrupt("return",c.sent);case 7:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"markUnread",value:function(){var t=pe(L.mark(function s(a){var o;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._checkInitialized(),!(!((o=this.getConfig())!==null&&o!==void 0&&o.read_events)&&!this.getClient()._isUsingServerAuth())){l.next=3;break}return l.abrupt("return",Promise.resolve(null));case 3:return l.next=5,this.getClient().post(this._channelURL()+"/unread",zt({},a));case 5:return l.abrupt("return",l.sent);case 6:case"end":return l.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"clean",value:function(){if(this.lastKeyStroke){var r=new Date,s=r.getTime()-this.lastKeyStroke.getTime();s>1e3&&this.isTyping&&Rz(this.stopTyping(),"stop typing event")}this.state.clean()}},{key:"watch",value:function(){var t=pe(L.mark(function s(a){var o,i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o={state:!0,watch:!0,presence:!1},d.next=3,this.getClient().wsPromise;case 3:return this.getClient()._hasConnectionID()||(o.watch=!1),i=zt(zt({},o),a),d.next=7,this.query(i,"latest");case 7:return l=d.sent,this.initialized=!0,this.data=l.channel,this._client.logger("info","channel:watch() - started watching channel ".concat(this.cid),{tags:["channel"],channel:this}),d.abrupt("return",l);case 12:case"end":return d.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"stopWatching",value:function(){var t=pe(L.mark(function s(){var a;return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getClient().post(this._channelURL()+"/stop-watching",{});case 2:return a=i.sent,this._client.logger("info","channel:watch() - stopped watching channel ".concat(this.cid),{tags:["channel"],channel:this}),i.abrupt("return",a);case 5:case"end":return i.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"getReplies",value:function(){var t=pe(L.mark(function s(a,o,i){var l,c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return l=i?ys(i):void 0,u.next=3,this.getClient().get(this.getClient().baseURL+"/messages/".concat(encodeURIComponent(a),"/replies"),zt({sort:l},o));case 3:return c=u.sent,c.messages&&this.state.addMessagesSorted(c.messages),u.abrupt("return",c);case 6:case"end":return u.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"getPinnedMessages",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:[],c.next=3,this.getClient().get(this._channelURL()+"/pinned_messages",{payload:zt(zt({},a),{},{sort:ys(o)})});case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getReactions",value:function(r,s){return this.getClient().get(this.getClient().baseURL+"/messages/".concat(encodeURIComponent(r),"/reactions"),zt({},s))}},{key:"getMessagesById",value:function(r){return this.getClient().get(this._channelURL()+"/messages",{ids:r.join(",")})}},{key:"lastRead",value:function(){var r=this.getClient(),s=r.userID;if(s)return this.state.read[s]?this.state.read[s].last_read:null}},{key:"_countMessageAsUnread",value:function(r){var s,a,o,i;return!(r.shadowed||r.silent||r.parent_id&&!r.show_in_channel||((s=r.user)===null||s===void 0?void 0:s.id)===this.getClient().userID||(a=r.user)!==null&&a!==void 0&&a.id&&this.getClient().userMuteStatus(r.user.id)||Array.isArray((o=this.data)===null||o===void 0?void 0:o.own_capabilities)&&!((i=this.data)!==null&&i!==void 0&&i.own_capabilities.includes("read-events"))||this.muteStatus().muted)}},{key:"countUnread",value:function(r){if(!r)return this.state.unreadCount;for(var s=0,a=0;a<this.state.latestMessages.length;a+=1){var o=this.state.latestMessages[a];o.created_at>r&&this._countMessageAsUnread(o)&&s++}return s}},{key:"countUnreadMentions",value:function(){for(var r=this.lastRead(),s=this.getClient().userID,a=0,o=0;o<this.state.latestMessages.length;o+=1){var i,l=this.state.latestMessages[o];this._countMessageAsUnread(l)&&(!r||l.created_at>r)&&(i=l.mentioned_users)!==null&&i!==void 0&&i.some(function(c){return c.id===s})&&a++}return a}},{key:"query",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u,h,p,g,f,m,v=arguments;return L.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return d=v.length>1&&v[1]!==void 0?v[1]:"current",w.next=3,this.getClient().wsPromise;case 3:return u="".concat(this.getClient().baseURL,"/channels/").concat(encodeURIComponent(this.type)),this.id&&(u+="/".concat(encodeURIComponent(this.id))),w.next=7,this.getClient().post(u+"/query",zt({data:this._data,state:!0},a));case 7:return h=w.sent,this.id||(this.id=h.channel.id,this.cid=h.channel.cid,p=$b(this.type,h.members.map(function(x){var j;return x.user_id||((j=x.user)===null||j===void 0?void 0:j.id)||""})),p&&p in this.getClient().activeChannels&&delete this.getClient().activeChannels[p],!(this.cid in this.getClient().activeChannels)&&this.getClient()._cacheEnabled()&&(this.getClient().activeChannels[this.cid]=this)),this.getClient()._addChannelConfig(h.channel),g=this._initializeState(h,d),f=g.messageSet,f.pagination=zt(zt({},f.pagination),uC({parentSet:f,messagePaginationOptions:a==null?void 0:a.messages,requestedPageSize:(o=a==null||(i=a.messages)===null||i===void 0?void 0:i.limit)!==null&&o!==void 0?o:eF,returnedPage:h.messages,logger:this.getClient().logger})),this.getClient().polls.hydratePollCache(h.messages,!0),m=Or(h.channel.own_capabilities||[]).sort().join()!==Or(Array.isArray((l=this.data)===null||l===void 0?void 0:l.own_capabilities)?(c=this.data)===null||c===void 0?void 0:c.own_capabilities:[]).sort().join(),this.data=h.channel,this.offlineMode=!1,m&&this.getClient().dispatchEvent({type:"capabilities.changed",cid:this.cid,own_capabilities:h.channel.own_capabilities}),this.getClient().dispatchEvent({type:"channels.queried",queriedChannels:{channels:[h],isLatestMessageSet:f.isLatest}}),w.abrupt("return",h);case 19:case"end":return w.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"banUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this._checkInitialized(),l.next=3,this.getClient().banUser(a,zt(zt({},o),{},{type:this.type,id:this.id}));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"hide",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:null,o=i.length>1&&i[1]!==void 0?i[1]:!1,this._checkInitialized(),c.next=5,this.getClient().post("".concat(this._channelURL(),"/hide"),{user_id:a,clear_history:o});case 5:return c.abrupt("return",c.sent);case 6:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"show",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:null,this._checkInitialized(),l.next=4,this.getClient().post("".concat(this._channelURL(),"/show"),{user_id:a});case 4:return l.abrupt("return",l.sent);case 5:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"unbanUser",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this._checkInitialized(),i.next=3,this.getClient().unbanUser(a,{type:this.type,id:this.id});case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"shadowBan",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this._checkInitialized(),l.next=3,this.getClient().shadowBan(a,zt(zt({},o),{},{type:this.type,id:this.id}));case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"removeShadowBan",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this._checkInitialized(),i.next=3,this.getClient().removeShadowBan(a,{type:this.type,id:this.id});case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"createCall",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getClient().post(this._channelURL()+"/call",a);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"vote",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getClient().castPollVote(a,o,i);case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"removeVote",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getClient().removePollVote(a,o,i);case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"createDraft",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getClient().post(this._channelURL()+"/draft",{message:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"deleteDraft",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=a.parent_id,c.next=3,this.getClient().delete(this._channelURL()+"/draft",{parent_id:o});case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"getDraft",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=a.parent_id,c.next=3,this.getClient().get(this._channelURL()+"/draft",{parent_id:o});case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"on",value:function(r,s){var a=this,o=s?r:"all",i=s||r;return o in this.listeners||(this.listeners[o]=[]),this._client.logger("info","Attaching listener for ".concat(o," event on channel ").concat(this.cid),{tags:["event","channel"],channel:this}),this.listeners[o].push(i),{unsubscribe:function(){a._client.logger("info","Removing listener for ".concat(o," event from channel ").concat(a.cid),{tags:["event","channel"],channel:a}),a.listeners[o]=a.listeners[o].filter(function(c){return c!==i})}}}},{key:"off",value:function(r,s){var a=s?r:"all",o=s||r;a in this.listeners||(this.listeners[a]=[]),this._client.logger("info","Removing listener for ".concat(a," event from channel ").concat(this.cid),{tags:["event","channel"],channel:this}),this.listeners[a]=this.listeners[a].filter(function(i){return i!==o})}},{key:"_handleChannelEvent",value:function(r){var s,a,o,i,l,c,d,u,h,p,g,f=this;this._client.logger("info","channel:_handleChannelEvent - Received event of type { ".concat(r.type," } on ").concat(this.cid),{tags:["event","channel"],channel:this});var m=f.state;switch(r.type){case"typing.start":(s=r.user)!==null&&s!==void 0&&s.id&&(m.typing[r.user.id]=r);break;case"typing.stop":(a=r.user)!==null&&a!==void 0&&a.id&&delete m.typing[r.user.id];break;case"message.read":if((o=r.user)!==null&&o!==void 0&&o.id&&r.created_at){var v,b;m.read[r.user.id]={last_read:new Date(r.created_at),last_read_message_id:r.last_read_message_id,user:r.user,unread_messages:0},((v=r.user)===null||v===void 0?void 0:v.id)===((b=this.getClient().user)===null||b===void 0?void 0:b.id)&&(m.unreadCount=0)}break;case"user.watching.start":case"user.updated":(i=r.user)!==null&&i!==void 0&&i.id&&(m.watchers[r.user.id]=r.user);break;case"user.watching.stop":(l=r.user)!==null&&l!==void 0&&l.id&&delete m.watchers[r.user.id];break;case"message.deleted":r.message&&(this._extendEventWithOwnReactions(r),r.hard_delete?m.removeMessage(r.message):m.addMessageSorted(r.message,!1,!1),m.removeQuotedMessageReferences(r.message),r.message.pinned&&m.removePinnedMessage(r.message));break;case"message.new":if(r.message){var w,x,j,S=((w=r.user)===null||w===void 0?void 0:w.id)===((x=this.getClient().user)===null||x===void 0?void 0:x.id),_=r.message.parent_id&&!r.message.show_in_channel;(this.state.isUpToDate||_)&&m.addMessageSorted(r.message,S),r.message.pinned&&m.addPinnedMessage(r.message);var C=S||_;if(C)break;if((j=r.user)!==null&&j!==void 0&&j.id)for(var N in m.read)N===r.user.id?m.read[r.user.id]={last_read:new Date(r.created_at),user:r.user,unread_messages:0}:m.read[N].unread_messages+=1;this._countMessageAsUnread(r.message)&&(m.unreadCount=m.unreadCount+1)}break;case"message.updated":case"message.undeleted":r.message&&(this._extendEventWithOwnReactions(r),m.addMessageSorted(r.message,!1,!1),m._updateQuotedMessageReferences({message:r.message}),r.message.pinned?m.addPinnedMessage(r.message):m.removePinnedMessage(r.message));break;case"channel.truncated":if((c=r.channel)!==null&&c!==void 0&&c.truncated_at){var M=+new Date(r.channel.truncated_at);m.messageSets.forEach(function(O,oe){O.messages.forEach(function(me){var Ce=me.created_at,ve=me.id;M>+Ce&&m.removeMessage({id:ve,messageSetIndex:oe})})}),m.pinnedMessages.forEach(function(O){var oe=O.id,me=O.created_at;M>+me&&m.removePinnedMessage({id:oe})})}else m.clearMessages();m.unreadCount=0,r.message&&(m.addMessageSorted(r.message),r.message.pinned&&m.addPinnedMessage(r.message));break;case"member.added":case"member.updated":{var E,P=zt({},r.member);P.pinned_at===null&&delete P.pinned_at,P.archived_at===null&&delete P.archived_at,P!=null&&P.user&&(m.members=zt(zt({},m.members),{},q({},P.user.id,P)));var D=this.getClient().userID;typeof D=="string"&&typeof(P==null||(E=P.user)===null||E===void 0?void 0:E.id)=="string"&&P.user.id===D&&(m.membership=P);break}case"member.removed":if((d=r.user)!==null&&d!==void 0&&d.id){var T=zt({},m.members);delete T[r.user.id],m.members=T}break;case"notification.mark_unread":{var A,k,R,U=((A=r.user)===null||A===void 0?void 0:A.id)===((k=this.getClient().user)===null||k===void 0?void 0:k.id);if(!(U&&r.user))break;var z=(R=r.unread_messages)!==null&&R!==void 0?R:0;m.read[r.user.id]={first_unread_message_id:r.first_unread_message_id,last_read:new Date(r.last_read_at),last_read_message_id:r.last_read_message_id,user:r.user,unread_messages:z},m.unreadCount=z;break}case"channel.updated":if(r.channel){var $,W,Y,Q,H,ue,J,be,Ae=(($=r.channel)===null||$===void 0?void 0:$.frozen)!==void 0&&r.channel.frozen!==((W=f.data)===null||W===void 0?void 0:W.frozen);Ae&&this.query({state:!1,messages:{limit:0},watchers:{limit:0}}),f.data=zt(zt({},r.channel),{},{hidden:(Y=(Q=r.channel)===null||Q===void 0?void 0:Q.hidden)!==null&&Y!==void 0?Y:(H=f.data)===null||H===void 0?void 0:H.hidden,own_capabilities:(ue=(J=r.channel)===null||J===void 0?void 0:J.own_capabilities)!==null&&ue!==void 0?ue:(be=f.data)===null||be===void 0?void 0:be.own_capabilities})}break;case"reaction.new":r.message&&r.reaction&&(r.message=m.addReaction(r.reaction,r.message));break;case"reaction.deleted":r.reaction&&(r.message=m.removeReaction(r.reaction,r.message));break;case"reaction.updated":r.reaction&&(r.message=m.addReaction(r.reaction,r.message,!0));break;case"channel.hidden":f.data=zt(zt({},f.data),{},{hidden:!0}),r.clear_history&&m.clearMessages();break;case"channel.visible":f.data=zt(zt({},f.data),{},{hidden:!1});break;case"user.banned":if(!((u=r.user)!==null&&u!==void 0&&u.id))break;m.members[r.user.id]=zt(zt({},m.members[r.user.id]||{}),{},{shadow_banned:!!r.shadow,banned:!r.shadow,user:zt(zt({},((h=m.members[r.user.id])===null||h===void 0?void 0:h.user)||{}),r.user)});break;case"user.unbanned":if(!((p=r.user)!==null&&p!==void 0&&p.id))break;m.members[r.user.id]=zt(zt({},m.members[r.user.id]||{}),{},{shadow_banned:!1,banned:!1,user:zt(zt({},((g=m.members[r.user.id])===null||g===void 0?void 0:g.user)||{}),r.user)});break}r.watcher_count!==void 0&&(f.state.watcher_count=r.watcher_count)}},{key:"_checkInitialized",value:function(){if(!this.initialized&&!this.offlineMode&&!this.getClient()._isUsingServerAuth())throw Error("Channel ".concat(this.cid," hasn't been initialized yet. Make sure to call .watch() and wait for it to resolve"))}},{key:"_initializeState",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"latest",a=this.getClient(),o=a.state,i=a.user,l=a.userID;if(r.members){this._hydrateMembers({members:r.members});var c=Eg(r.members),d;try{for(c.s();!(d=c.n()).done;){var u=d.value;u.user&&o.updateUserReference(u.user,this.cid)}}catch(_){c.e(_)}finally{c.f()}}this.state.membership=r.membership||{};var h=r.messages||[];this.state.messages||this.state.initMessages();var p=this.state.addMessagesSorted(h,!1,!0,!0,s),g=p.messageSet;if(this.state.pinnedMessages||(this.state.pinnedMessages=[]),this.state.addPinnedMessages(r.pinned_messages||[]),r.pending_messages&&(this.state.pending_messages=r.pending_messages),r.watcher_count!==void 0&&(this.state.watcher_count=r.watcher_count),r.watchers){var f=Eg(r.watchers),m;try{for(f.s();!(m=f.n()).done;){var v=m.value;v&&(o.updateUserReference(v,this.cid),this.state.watchers[v.id]=v)}}catch(_){f.e(_)}finally{f.f()}}if(l!=null){var b=this.state.last_message_at||new Date;i&&(this.state.read[i.id]={user:i,last_read:b,unread_messages:0})}if(r.read){var w=Eg(r.read),x;try{for(w.s();!(x=w.n()).done;){var j,S=x.value;this.state.read[S.user.id]={last_read:new Date(S.last_read),last_read_message_id:S.last_read_message_id,unread_messages:(j=S.unread_messages)!==null&&j!==void 0?j:0,user:S.user},S.user.id===(i==null?void 0:i.id)&&(this.state.unreadCount=this.state.read[S.user.id].unread_messages)}}catch(_){w.e(_)}finally{w.f()}}return{messageSet:g}}},{key:"_extendEventWithOwnReactions",value:function(r){if(r.message){var s=this.state.findMessage(r.message.id,r.message.parent_id);s&&(r.message.own_reactions=s.own_reactions)}}},{key:"_hydrateMembers",value:function(r){var s=r.members,a=r.overrideCurrentState,o=a===void 0?!0:a,i=s.reduce(function(l,c){return c.user&&(l[c.user.id]=c),l},{});o?this.state.members=i:!o&&s.length&&(this.state.members=zt(zt({},this.state.members),i))}},{key:"_disconnect",value:function(){this._client.logger("info","channel:disconnect() - Disconnecting the channel ".concat(this.cid),{tags:["connection","channel"],channel:this}),this.disconnected=!0,this.state.setIsUpToDate(!1)}}]),n}();function nF(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=sF(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(d){i=!0,l=d},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function sF(n,t){if(n){if(typeof n=="string")return pj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pj(n,t)}}function pj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}var mj=function(){function n(t){var r=t.client;Vt(this,n),q(this,"client",void 0),q(this,"users",void 0),q(this,"userChannelReferences",void 0),this.client=r,this.users={},this.userChannelReferences={}}return sr(n,[{key:"updateUsers",value:function(r){var s=nF(r),a;try{for(s.s();!(a=s.n()).done;){var o=a.value;this.updateUser(o)}}catch(i){s.e(i)}finally{s.f()}}},{key:"updateUser",value:function(r){r!=null&&this.client._cacheEnabled()&&(this.users[r.id]=r)}},{key:"updateUserReference",value:function(r,s){r==null||!this.client._cacheEnabled()||(this.updateUser(r),this.userChannelReferences[r.id]||(this.userChannelReferences[r.id]={}),this.userChannelReferences[r.id][s]=!0)}},{key:"deleteAllChannelReference",value:function(r){for(var s in this.userChannelReferences)delete this.userChannelReferences[s][r]}}]),n}();function fj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function gj(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):fj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var aF=function n(){Vt(this,n),q(this,"connectionStartTimestamp",void 0),q(this,"wsConsecutiveFailures",void 0),q(this,"wsTotalFailures",void 0),q(this,"instanceClientId",void 0),this.connectionStartTimestamp=null,this.wsTotalFailures=0,this.wsConsecutiveFailures=0,this.instanceClientId=Uc()},au=function(){var n=pe(L.mark(function t(r,s){var a,o;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:a=3,o=0;case 2:if(!(o<a)){l.next=17;break}return l.prev=3,l.next=6,Pm.post("https://chat-insights.getstream.io/insights/".concat(r),s);case 6:l.next=13;break;case 8:return l.prev=8,l.t0=l.catch(3),l.next=12,Ml((o+1)*3e3);case 12:return l.abrupt("continue",14);case 13:return l.abrupt("break",17);case 14:o++,l.next=2;break;case 17:case"end":return l.stop()}},t,null,[[3,8]])}));return function(r,s){return n.apply(this,arguments)}}();function oF(n,t){return gj(gj({},t),mC(n))}function mC(n){var t,r,s,a=n.client;return{ready_state:(t=n.ws)===null||t===void 0?void 0:t.readyState,url:n._buildUrl(),api_key:a.key,start_ts:a.insightMetrics.connectionStartTimestamp,end_ts:new Date().getTime(),auth_type:a.getAuthType(),token:a.tokenManager.token,user_id:a.userID,user_details:a._user,device:a.options.device,client_id:n.connectionID,ws_details:n.ws,ws_consecutive_failures:a.insightMetrics.wsConsecutiveFailures,ws_total_failures:a.insightMetrics.wsTotalFailures,request_id:n.requestID,online:typeof navigator<"u"?(r=navigator)===null||r===void 0?void 0:r.onLine:null,user_agent:typeof navigator<"u"?(s=navigator)===null||s===void 0?void 0:s.userAgent:null,instance_client_id:a.insightMetrics.instanceClientId}}function iF(n){return mC(n)}function xj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function lF(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):xj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var cF=function(t){return t.code!==void 0},dF=function(t){return t.error!==void 0},uF=function(){function n(t){var r=this,s=t.client;Vt(this,n),q(this,"client",void 0),q(this,"connectionID",void 0),q(this,"connectionOpen",void 0),q(this,"consecutiveFailures",void 0),q(this,"pingInterval",void 0),q(this,"healthCheckTimeoutRef",void 0),q(this,"isConnecting",void 0),q(this,"isDisconnected",void 0),q(this,"isHealthy",void 0),q(this,"isResolved",void 0),q(this,"lastEvent",void 0),q(this,"connectionCheckTimeout",void 0),q(this,"connectionCheckTimeoutRef",void 0),q(this,"rejectPromise",void 0),q(this,"requestID",void 0),q(this,"resolvePromise",void 0),q(this,"totalFailures",void 0),q(this,"ws",void 0),q(this,"wsID",void 0),q(this,"_buildUrl",function(){var a=r.client._buildWSPayload(r.requestID),o=r.client.tokenManager.getToken(),i=r.client.options.wsUrlParams,l=new URLSearchParams(i);return l.set("json",a),l.set("api_key",r.client.key),l.set("authorization","".concat(o)),l.set("stream-auth-type",r.client.getAuthType()),l.set("X-Stream-Client",r.client.getUserAgent()),"".concat(r.client.wsBaseURL,"/connect?").concat(l.toString())}),q(this,"onlineStatusChanged",function(a){a.type==="offline"?(r._log("onlineStatusChanged() - Status changing to offline"),r._setHealth(!1)):a.type==="online"&&(r._log("onlineStatusChanged() - Status changing to online. isHealthy: ".concat(r.isHealthy)),r.isHealthy||r._reconnect({interval:10}))}),q(this,"onopen",function(a){r.wsID===a&&r._log("onopen() - onopen callback",{wsID:a})}),q(this,"onmessage",function(a,o){if(r.wsID===a){r._log("onmessage() - onmessage callback",{event:o,wsID:a});var i=typeof o.data=="string"?JSON.parse(o.data):null;if(!r.isResolved&&i){var l;if(r.isResolved=!0,i.error){var c;(c=r.rejectPromise)===null||c===void 0||c.call(r,r._errorFromWSEvent(i,!1));return}(l=r.resolvePromise)===null||l===void 0||l.call(r,i),r._setHealth(!0)}r.lastEvent=new Date,i&&i.type==="health.check"&&r.scheduleNextPing(),r.client.handleEvent(o),r.scheduleConnectionCheck()}}),q(this,"onclose",function(a,o){if(r.wsID===a)if(r._log("onclose() - onclose callback - "+o.code,{event:o,wsID:a}),o.code===su.WS_CLOSED_SUCCESS){var i,l=new Error("WS connection reject with error ".concat(o.reason));l.reason=o.reason,l.code=o.code,l.wasClean=o.wasClean,l.target=o.target,(i=r.rejectPromise)===null||i===void 0||i.call(r,l),r._log("onclose() - WS connection reject with error ".concat(o.reason),{event:o})}else{var c;r.consecutiveFailures+=1,r.totalFailures+=1,r._setHealth(!1),r.isConnecting=!1,(c=r.rejectPromise)===null||c===void 0||c.call(r,r._errorFromWSEvent(o)),r._log("onclose() - WS connection closed. Calling reconnect ...",{event:o}),r._reconnect()}}),q(this,"onerror",function(a,o){var i;r.wsID===a&&(r.consecutiveFailures+=1,r.totalFailures+=1,r._setHealth(!1),r.isConnecting=!1,(i=r.rejectPromise)===null||i===void 0||i.call(r,r._errorFromWSEvent(o)),r._log("onerror() - WS connection resulted into error",{event:o}),r._reconnect())}),q(this,"_setHealth",function(a){if(a!==r.isHealthy){if(r.isHealthy=a,r.isHealthy){r.client.dispatchEvent({type:"connection.changed",online:r.isHealthy});return}setTimeout(function(){r.isHealthy||r.client.dispatchEvent({type:"connection.changed",online:r.isHealthy})},5e3)}}),q(this,"_errorFromWSEvent",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i,l,c;cF(a)&&(i=a.code,l="unknown",c=a.reason),dF(a)&&(i=a.error.code,l=a.error.StatusCode,c=a.error.message),r._log("_errorFromWSEvent() - WS failed with code ".concat(i),{event:a},"warn");var d=new Error("WS failed with code ".concat(i," and reason - ").concat(c));return d.code=i,d.StatusCode=l,d.isWSFailure=o,d}),q(this,"_setupConnectionPromise",function(){r.isResolved=!1,r.connectionOpen=new Promise(function(a,o){r.resolvePromise=a,r.rejectPromise=o})}),q(this,"scheduleNextPing",function(){r.healthCheckTimeoutRef&&clearTimeout(r.healthCheckTimeoutRef),r.healthCheckTimeoutRef=setTimeout(function(){var a=[{type:"health.check",client_id:r.client.clientID}];try{var o;(o=r.ws)===null||o===void 0||o.send(JSON.stringify(a))}catch{}},r.pingInterval)}),q(this,"scheduleConnectionCheck",function(){r.connectionCheckTimeoutRef&&clearTimeout(r.connectionCheckTimeoutRef),r.connectionCheckTimeoutRef=setTimeout(function(){var a=new Date;r.lastEvent&&a.getTime()-r.lastEvent.getTime()>r.connectionCheckTimeout&&(r._log("scheduleConnectionCheck - going to reconnect"),r._setHealth(!1),r._reconnect())},r.connectionCheckTimeout)}),this.client=s,this.consecutiveFailures=0,this.totalFailures=0,this.isConnecting=!1,this.isDisconnected=!1,this.isResolved=!1,this.isHealthy=!1,this.wsID=1,this.lastEvent=null,this.pingInterval=25*1e3,this.connectionCheckTimeout=this.pingInterval+10*1e3,oC(this.onlineStatusChanged)}return sr(n,[{key:"_log",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"info";this.client.logger(a,"connection:"+r,lF({tags:["connection"]},s))}},{key:"setClient",value:function(r){this.client=r}},{key:"connect",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=i.length>0&&i[0]!==void 0?i[0]:15e3,!this.isConnecting){c.next=3;break}throw Error("You've called connect twice, can only attempt 1 connection at the time");case 3:return this.isDisconnected=!1,c.prev=4,c.next=7,this._connect();case 7:o=c.sent,this.consecutiveFailures=0,this._log("connect() - Established ws connection with healthcheck: ".concat(o)),c.next=23;break;case 12:if(c.prev=12,c.t0=c.catch(4),this.isHealthy=!1,this.consecutiveFailures+=1,!(c.t0.code===su.TOKEN_EXPIRED&&!this.client.tokenManager.isStatic())){c.next=21;break}this._log("connect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0}),c.next=23;break;case 21:if(c.t0.isWSFailure){c.next=23;break}throw new Error(JSON.stringify({code:c.t0.code,StatusCode:c.t0.StatusCode,message:c.t0.message,isWSFailure:c.t0.isWSFailure}));case 23:return c.next=25,this._waitForHealthy(a);case 25:return c.abrupt("return",c.sent);case 26:case"end":return c.stop()}},s,this,[[4,12]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"_waitForHealthy",value:function(){var t=pe(L.mark(function s(){var a=this,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>0&&i[0]!==void 0?i[0]:15e3,c.abrupt("return",Promise.race([pe(L.mark(function d(){var u,h;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:u=50,h=0;case 2:if(!(h<=o)){g.next=18;break}return g.prev=3,g.next=6,a.connectionOpen;case 6:return g.abrupt("return",g.sent);case 9:if(g.prev=9,g.t0=g.catch(3),h!==o){g.next=13;break}throw new Error(JSON.stringify({code:g.t0.code,StatusCode:g.t0.StatusCode,message:g.t0.message,isWSFailure:g.t0.isWSFailure}));case 13:return g.next=15,Ml(u);case 15:h+=u,g.next=2;break;case 18:case"end":return g.stop()}},d,null,[[3,9]])}))(),pe(L.mark(function d(){return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,Ml(o);case 2:throw a.isConnecting=!1,new Error(JSON.stringify({code:"",StatusCode:"",message:"initial WS connection could not be established",isWSFailure:!0}));case 4:case"end":return h.stop()}},d)}))()]));case 2:case"end":return c.stop()}},s)}));function r(){return t.apply(this,arguments)}return r}()},{key:"disconnect",value:function(r){var s=this;this._log("disconnect() - Closing the websocket connection for wsID ".concat(this.wsID)),this.wsID+=1,this.isConnecting=!1,this.isDisconnected=!0,this.healthCheckTimeoutRef&&clearInterval(this.healthCheckTimeoutRef),this.connectionCheckTimeoutRef&&clearInterval(this.connectionCheckTimeoutRef),iC(this.onlineStatusChanged),this.isHealthy=!1,this.ws&&this.ws.removeAllListeners&&this.ws.removeAllListeners();var a,o=this.ws;return o&&o.close&&o.readyState===o.OPEN?(a=new Promise(function(i){var l=function(d){s._log("disconnect() - resolving isClosedPromise ".concat(d?"with":"without"," close frame"),{event:d}),i()};o.onclose=l,setTimeout(l,r??1e3)}),this._log("disconnect() - Manually closed connection by calling client.disconnect()"),o.close(su.WS_CLOSED_SUCCESS,"Manually closed connection by calling client.disconnect()")):(this._log("disconnect() - ws connection doesn't exist or it is already closed."),a=Promise.resolve()),delete this.ws,a}},{key:"_connect",value:function(){var t=pe(L.mark(function s(){var a,o,i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(this.isConnecting||this.isDisconnected&&this.client.options.enableWSFallback)){d.next=2;break}return d.abrupt("return");case 2:return this.isConnecting=!0,this.requestID=Uc(),this.client.insightMetrics.connectionStartTimestamp=new Date().getTime(),a=!1,d.prev=6,this._log("_connect() - waiting for token"),d.next=10,this.client.tokenManager.tokenReady();case 10:a=!0,d.next=15;break;case 13:d.prev=13,d.t0=d.catch(6);case 15:if(d.prev=15,a){d.next=20;break}return this._log("_connect() - tokenProvider failed before, so going to retry"),d.next=20,this.client.tokenManager.loadToken();case 20:return this._setupConnectionPromise(),o=this._buildUrl(),this._log("_connect() - Connecting to ".concat(o),{wsURL:o,requestID:this.requestID}),this.ws=new Sz(o),this.ws.onopen=this.onopen.bind(this,this.wsID),this.ws.onclose=this.onclose.bind(this,this.wsID),this.ws.onerror=this.onerror.bind(this,this.wsID),this.ws.onmessage=this.onmessage.bind(this,this.wsID),d.next=30,this.connectionOpen;case 30:if(i=d.sent,this.isConnecting=!1,!i){d.next=36;break}return this.connectionID=i.connection_id,this.client.insightMetrics.wsConsecutiveFailures>0&&this.client.options.enableInsights&&(au("ws_success_after_failure",iF(this)),this.client.insightMetrics.wsConsecutiveFailures=0),d.abrupt("return",i);case 36:d.next=44;break;case 38:throw d.prev=38,d.t1=d.catch(15),this.isConnecting=!1,this._log("_connect() - Error - ",d.t1),this.client.options.enableInsights&&(this.client.insightMetrics.wsConsecutiveFailures++,this.client.insightMetrics.wsTotalFailures++,l=oF(this,Wz(d.t1)),au==null||au("ws_fatal",l)),d.t1;case 44:case"end":return d.stop()}},s,this,[[6,13],[15,38]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"_reconnect",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=i.length>0&&i[0]!==void 0?i[0]:{},this._log("_reconnect() - Initiating the reconnect"),!(this.isConnecting||this.isHealthy)){c.next=5;break}return this._log("_reconnect() - Abort (1) since already connecting or healthy"),c.abrupt("return");case 5:return o=a.interval,o||(o=Em(this.consecutiveFailures)),c.next=9,Ml(o);case 9:if(!(this.isConnecting||this.isHealthy)){c.next=12;break}return this._log("_reconnect() - Abort (2) since already connecting or healthy"),c.abrupt("return");case 12:if(!(this.isDisconnected&&this.client.options.enableWSFallback)){c.next=15;break}return this._log("_reconnect() - Abort (3) since disconnect() is called"),c.abrupt("return");case 15:if(this._log("_reconnect() - Destroying current WS connection"),this._destroyCurrentWSConnection(),!a.refreshToken){c.next=20;break}return c.next=20,this.client.tokenManager.loadToken();case 20:return c.prev=20,c.next=23,this._connect();case 23:return this._log("_reconnect() - Waiting for recoverCallBack"),c.next=26,this.client.recoverState();case 26:this._log("_reconnect() - Finished recoverCallBack"),this.consecutiveFailures=0,c.next=38;break;case 30:if(c.prev=30,c.t0=c.catch(20),this.isHealthy=!1,this.consecutiveFailures+=1,!(c.t0.code===su.TOKEN_EXPIRED&&!this.client.tokenManager.isStatic())){c.next=37;break}return this._log("_reconnect() - WS failure due to expired token, so going to try to reload token and reconnect"),c.abrupt("return",this._reconnect({refreshToken:!0}));case 37:c.t0.isWSFailure&&(this._log("_reconnect() - WS failure, so going to try to reconnect"),this._reconnect());case 38:this._log("_reconnect() - == END ==");case 39:case"end":return c.stop()}},s,this,[[20,30]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"_destroyCurrentWSConnection",value:function(){this.wsID+=1;try{var r,s;this===null||this===void 0||(r=this.ws)===null||r===void 0||r.removeAllListeners(),this===null||this===void 0||(s=this.ws)===null||s===void 0||s.close()}catch{}}}]),n}(),hF=null,yj=null;function bj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function pF(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):bj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function fC(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};throw typeof t!="string"?new TypeError("userId should be a string"):(pF({user_id:t},r),Error("Unable to find jwt crypto, if you are getting this error is probably because you are trying to generate tokens on browser or React Native (or other environment where crypto functions are not available). Please Note: token should only be generated server-side."))}function vj(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r={server:!0},s=ah({algorithm:"HS256",noTimestamp:!0},t);return hF.sign(r,n,s)}function mF(n){var t=n.split(".");if(t.length!==3)return"";var r=t[1],s=Tz(r),a=JSON.parse(s);return a.user_id}function fF(n){return["eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",Nz(JSON.stringify({user_id:n})),"devtoken"].join(".")}function gF(n,t,r){var s=Buffer.from(t,"utf8"),a=yj.createHmac("sha256",s).update(n).digest("hex");try{return yj.timingSafeEqual(Buffer.from(a),Buffer.from(r))}catch{return!1}}var xF=function n(t){var r=this;Vt(this,n),q(this,"loadTokenPromise",void 0),q(this,"type",void 0),q(this,"secret",void 0),q(this,"token",void 0),q(this,"tokenProvider",void 0),q(this,"user",void 0),q(this,"setTokenOrProvider",function(){var s=pe(L.mark(function a(o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return r.validateToken(o,i),r.user=i,Dx(o)&&(r.tokenProvider=o,r.type="provider"),typeof o=="string"&&(r.token=o,r.type="static"),!o&&r.user&&r.secret&&(r.token=fC(r.secret,i.id,{},{}),r.type="static"),c.next=7,r.loadToken();case 7:case"end":return c.stop()}},a)}));return function(a,o){return s.apply(this,arguments)}}()),q(this,"reset",function(){r.token=void 0,r.tokenProvider=void 0,r.type="static",r.user=void 0,r.loadTokenPromise=null}),q(this,"validateToken",function(s,a){if(!(a&&a.anon&&!s)){if(!r.secret&&!s)throw new Error("User token can not be empty");if(s&&typeof s!="string"&&!Dx(s))throw new Error("user token should either be a string or a function");if(typeof s=="string"){if(a.anon&&s==="")return;var o=mF(s);if(s!=null&&(o==null||o===""||o!==a.id))throw new Error("userToken does not have a user_id or is not matching with user.id")}}}),q(this,"tokenReady",function(){return r.loadTokenPromise}),q(this,"loadToken",function(){return r.loadTokenPromise=new Promise(function(){var s=pe(L.mark(function a(o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r.type!=="static"){c.next=2;break}return c.abrupt("return",o(r.token));case 2:if(!(r.tokenProvider&&typeof r.tokenProvider!="string")){c.next=13;break}return c.prev=3,c.next=6,r.tokenProvider();case 6:r.token=c.sent,c.next=12;break;case 9:return c.prev=9,c.t0=c.catch(3),c.abrupt("return",i(new Error("Call to tokenProvider failed with message: ".concat(c.t0))));case 12:o(r.token);case 13:case"end":return c.stop()}},a,null,[[3,9]])}));return function(a,o){return s.apply(this,arguments)}}()),r.loadTokenPromise}),q(this,"getToken",function(){if(r.token||r.user&&r.user.anon&&!r.token)return r.token;if(r.secret)return vj(r.secret);throw new Error("Both secret and user tokens are not set. Either client.connectUser wasn't called or client.disconnect was called")}),q(this,"isStatic",function(){return r.type==="static"}),this.loadTokenPromise=null,t&&(this.secret=t),this.type="static",this.secret&&(this.token=vj(this.secret))},yF={"-1":{name:"InternalSystemError",retryable:!0},2:{name:"AccessKeyError",retryable:!1},3:{name:"AuthenticationFailedError",retryable:!0},4:{name:"InputError",retryable:!1},6:{name:"DuplicateUsernameError",retryable:!1},9:{name:"RateLimitError",retryable:!0},16:{name:"DoesNotExistError",retryable:!1},17:{name:"NotAllowedError",retryable:!1},18:{name:"EventNotSupportedError",retryable:!1},19:{name:"ChannelFeatureNotSupportedError",retryable:!1},20:{name:"MessageTooLongError",retryable:!1},21:{name:"MultipleNestingLevelError",retryable:!1},22:{name:"PayloadTooBigError",retryable:!1},23:{name:"RequestTimeoutError",retryable:!0},24:{name:"MaxHeaderSizeExceededError",retryable:!1},40:{name:"AuthErrorTokenExpired",retryable:!1},41:{name:"AuthErrorTokenNotValidYet",retryable:!1},42:{name:"AuthErrorTokenUsedBeforeIssuedAt",retryable:!1},43:{name:"AuthErrorTokenSignatureInvalid",retryable:!1},44:{name:"CustomCommandEndpointMissingError",retryable:!1},45:{name:"CustomCommandEndpointCallError",retryable:!0},46:{name:"ConnectionIDNotFoundError",retryable:!1},60:{name:"CoolDownError",retryable:!0},69:{name:"ErrWrongRegion",retryable:!1},70:{name:"ErrQueryChannelPermissions",retryable:!1},71:{name:"ErrTooManyConnections",retryable:!0},99:{name:"AppSuspendedError",retryable:!1}};function bF(n){return n.code!==void 0}function wj(n){if(!n.code)return!1;var t=yF["".concat(n.code)];return t?t.retryable:!1}function vF(n){return n.code===46}function wF(n){if(typeof n.isWSFailure=="boolean")return n.isWSFailure;try{return JSON.parse(n.message).isWSFailure}catch{return!1}}function jF(n){return!n.status||n.status<200||300<=n.status}function jj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Ag(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):jj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var Yn;(function(n){n.Closed="CLOSED",n.Connected="CONNECTED",n.Connecting="CONNECTING",n.Disconnected="DISCONNECTED",n.Init="INIT"})(Yn||(Yn={}));var SF=function(){function n(t){var r=this,s=t.client;Vt(this,n),q(this,"client",void 0),q(this,"state",void 0),q(this,"consecutiveFailures",void 0),q(this,"connectionID",void 0),q(this,"cancelToken",void 0),q(this,"_onlineStatusChanged",function(a){if(r._log("_onlineStatusChanged() - ".concat(a.type)),a.type==="offline"){var o;r._setState(Yn.Closed),(o=r.cancelToken)===null||o===void 0||o.cancel("disconnect() is called"),r.cancelToken=void 0;return}a.type==="online"&&r.state===Yn.Closed&&r.connect(!0)}),q(this,"_req",function(){var a=pe(L.mark(function o(i,l,c){var d,u;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return!r.cancelToken&&!i.close&&(r.cancelToken=Pm.CancelToken.source()),p.prev=1,p.next=4,r.client.doAxiosRequest("get",r.client.baseURL.replace(":3030",":8900")+"/longpoll",void 0,{config:Ag(Ag({},l),{},{cancelToken:(d=r.cancelToken)===null||d===void 0?void 0:d.token}),params:i});case 4:return u=p.sent,r.consecutiveFailures=0,p.abrupt("return",u);case 9:if(p.prev=9,p.t0=p.catch(1),r.consecutiveFailures+=1,!(c&&wj(p.t0))){p.next=17;break}return r._log("_req() - Retryable error, retrying request"),p.next=16,Ml(Em(r.consecutiveFailures));case 16:return p.abrupt("return",r._req(i,l,c));case 17:throw p.t0;case 18:case"end":return p.stop()}},o,null,[[1,9]])}));return function(o,i,l){return a.apply(this,arguments)}}()),q(this,"_poll",pe(L.mark(function a(){var o,i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(r.state!==Yn.Connected){d.next=25;break}return d.prev=1,d.next=4,r._req({},{timeout:3e4},!0);case 4:if(i=d.sent,(o=i.events)!==null&&o!==void 0&&o.length)for(l=0;l<i.events.length;l++)r.client.dispatchEvent(i.events[l]);d.next=23;break;case 8:if(d.prev=8,d.t0=d.catch(1),!Pm.isCancel(d.t0)){d.next=13;break}return r._log("_poll() - axios canceled request"),d.abrupt("return");case 13:if(!vF(d.t0)){d.next=18;break}return r._log("_poll() - ConnectionID error, connecting without ID..."),r._setState(Yn.Disconnected),r.connect(!0),d.abrupt("return");case 18:if(!(bF(d.t0)&&!wj(d.t0))){d.next=21;break}return r._setState(Yn.Closed),d.abrupt("return");case 21:return d.next=23,Ml(Em(r.consecutiveFailures));case 23:d.next=0;break;case 25:case"end":return d.stop()}},a,null,[[1,8]])}))),q(this,"connect",pe(L.mark(function a(){var o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o=c.length>0&&c[0]!==void 0?c[0]:!1,r.state!==Yn.Connecting){u.next=4;break}return r._log("connect() - connecting already in progress",{reconnect:o},"warn"),u.abrupt("return");case 4:if(r.state!==Yn.Connected){u.next=7;break}return r._log("connect() - already connected and polling",{reconnect:o},"warn"),u.abrupt("return");case 7:return r._setState(Yn.Connecting),r.connectionID=void 0,u.prev=9,u.next=12,r._req({json:r.client._buildWSPayload()},{timeout:8e3},o);case 12:return i=u.sent,l=i.event,r._setState(Yn.Connected),r.connectionID=l.connection_id,r.client.dispatchEvent(l),r._poll(),o&&r.client.recoverState(),u.abrupt("return",l);case 22:throw u.prev=22,u.t0=u.catch(9),r._setState(Yn.Closed),u.t0;case 26:case"end":return u.stop()}},a,null,[[9,22]])}))),q(this,"isHealthy",function(){return!!r.connectionID&&r.state===Yn.Connected}),q(this,"disconnect",pe(L.mark(function a(){var o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i=c.length>0&&c[0]!==void 0?c[0]:2e3,iC(r._onlineStatusChanged),r._setState(Yn.Disconnected),(o=r.cancelToken)===null||o===void 0||o.cancel("disconnect() is called"),r.cancelToken=void 0,l=r.connectionID,r.connectionID=void 0,u.prev=7,u.next=10,r._req({close:!0,connection_id:l},{timeout:i},!1);case 10:r._log("disconnect() - Closed connectionID"),u.next=16;break;case 13:u.prev=13,u.t0=u.catch(7),r._log("disconnect() - Failed",{err:u.t0},"error");case 16:case"end":return u.stop()}},a,null,[[7,13]])}))),this.client=s,this.state=Yn.Init,this.consecutiveFailures=0,oC(this._onlineStatusChanged)}return sr(n,[{key:"_log",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"info";this.client.logger(a,"WSConnectionFallback:"+r,Ag({tags:["connection_fallback","connection"]},s))}},{key:"_setState",value:function(r){this._log("_setState() - ".concat(r)),this.state===Yn.Connecting&&r===Yn.Connected&&this.client.dispatchEvent({type:"connection.changed",online:!0}),(r===Yn.Closed||r===Yn.Disconnected)&&this.client.dispatchEvent({type:"connection.changed",online:!1}),this.state=r}}]),n}(),Sj=function(){function n(t,r,s,a){Vt(this,n),q(this,"type",void 0),q(this,"id",void 0),q(this,"client",void 0),q(this,"data",void 0),this.client=t,this.type=r,this.id=s,this.data=a}return sr(n,[{key:"create",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c,d;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return d={name:(a=this.data)===null||a===void 0?void 0:a.name,filter:(o=this.data)===null||o===void 0?void 0:o.filter,description:(i=this.data)===null||i===void 0?void 0:i.description,all_sender_channels:(l=this.data)===null||l===void 0?void 0:l.all_sender_channels,all_users:(c=this.data)===null||c===void 0?void 0:c.all_users},h.abrupt("return",this.client.createSegment(this.type,this.id,d));case 2:case"end":return h.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"verifySegmentId",value:function(){if(!this.id)throw new Error("Segment id is missing. Either create the segment using segment.create() or set the id during instantiation - const segment = client.segment(id)")}},{key:"get",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.verifySegmentId(),o.abrupt("return",this.client.getSegment(this.id));case 2:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"update",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifySegmentId(),i.abrupt("return",this.client.updateSegment(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"addTargets",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifySegmentId(),i.abrupt("return",this.client.addSegmentTargets(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"removeTargets",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifySegmentId(),i.abrupt("return",this.client.removeSegmentTargets(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"delete",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.verifySegmentId(),o.abrupt("return",this.client.deleteSegment(this.id));case 2:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"targetExists",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.verifySegmentId(),i.abrupt("return",this.client.segmentTargetExists(this.id,a));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryTargets",value:function(){var t=pe(L.mark(function s(){var a,o,i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=l.length>0&&l[0]!==void 0?l[0]:{},o=l.length>1&&l[1]!==void 0?l[1]:[],i=l.length>2&&l[2]!==void 0?l[2]:{},this.verifySegmentId(),d.abrupt("return",this.client.querySegmentTargets(this.id,a,o,i));case 5:case"end":return d.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()}]),n}();function _F(n){var t=kF();return function(){var s=Fl(n),a;if(t){var o=Fl(this).constructor;a=Reflect.construct(s,arguments,o)}else a=s.apply(this,arguments);return C_(this,a)}}function kF(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var CF=function(n){_r(r,n);var t=_F(r);function r(){var s;Vt(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return s=t.call.apply(t,[this].concat(o)),q(Et(s),"code",void 0),q(Et(s),"response",void 0),q(Et(s),"status",void 0),s}return r}(Mx(Error)),_j;(function(n){n.anonymous="anonymous",n.public="public"})(_j||(_j={}));function kj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Cj(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):kj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var gC=function(t){return typeof t=="function"},kh=function n(t){var r=this;Vt(this,n),this.value=t,q(this,"handlerSet",new Set),q(this,"next",function(s){var a=gC(s)?s(r.value):s;if(a!==r.value){var o=r.value;r.value=a,r.handlerSet.forEach(function(i){return i(r.value,o)})}}),q(this,"partialNext",function(s){return r.next(function(a){return Cj(Cj({},a),s)})}),q(this,"getLatestValue",function(){return r.value}),q(this,"subscribe",function(s){return s(r.value,void 0),r.handlerSet.add(s),function(){r.handlerSet.delete(s)}}),q(this,"subscribeWithSelector",function(s,a){var o,i=function(c){var d=s(c),u=!o;Array.isArray(d)&&n.logCount>0&&(console.warn("[StreamChat]: The API of our StateStore has changed. Instead of returning an array in the selector, please return a named object of properties."),n.logCount--);for(var h in o)if(o[h]!==d[h]){u=!0;break}if(u){var p=o;o=d,a(d,p)}};return r.subscribe(i)})};q(kh,"logCount",5);var NF=["limit","sort"];function Nj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Xr(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Nj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var Mg=50,TF=[{created_at:-1}],PF=1e3,EF={channel:!0,channel_cid:!0,created_at:!0,created_by_user_id:!0,parent_message_id:!0,title:!0,updated_at:!0,latest_replies:!0,active_participant_count:!0,deleted_at:!0,last_message_at:!0,participant_count:!0,reply_count:!0,read:!0,thread_participants:!0,created_by:!0,parent_message:!0},Tj=function(t){var r={};for(var s in t)if(!EF[s]){var a=s;r[a]=t[a]}return r},Pj=function(){function n(t){var r=this,s,a,o=t.client,i=t.threadData;Vt(this,n),q(this,"state",void 0),q(this,"id",void 0),q(this,"client",void 0),q(this,"unsubscribeFunctions",new Set),q(this,"failedRepliesMap",new Map),q(this,"activate",function(){r.state.partialNext({active:!0})}),q(this,"deactivate",function(){r.state.partialNext({active:!1})}),q(this,"reload",pe(L.mark(function d(){var u;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!r.state.getLatestValue().isLoading){p.next=2;break}return p.abrupt("return");case 2:return r.state.partialNext({isLoading:!0}),p.prev=3,p.next=6,r.client.getThread(r.id,{watch:!0});case 6:u=p.sent,r.hydrateState(u);case 8:return p.prev=8,r.state.partialNext({isLoading:!1}),p.finish(8);case 11:case"end":return p.stop()}},d,null,[[3,,8,11]])}))),q(this,"hydrateState",function(d){if(d!==r){if(d.id!==r.id)throw new Error("Cannot hydrate thread state with using thread's state");var u=d.state.getLatestValue(),h=u.read,p=u.replyCount,g=u.replies,f=u.parentMessage,m=u.participants,v=u.createdAt,b=u.deletedAt,w=u.updatedAt,x=Array.from(r.failedRepliesMap.values());r.state.partialNext({read:h,replyCount:p,replies:x.length?g.concat(x):g,parentMessage:f,participants:m,createdAt:v,deletedAt:b,updatedAt:w,isStateStale:!1})}}),q(this,"registerSubscriptions",function(){r.unsubscribeFunctions.size||(r.unsubscribeFunctions.add(r.subscribeThreadUpdated()),r.unsubscribeFunctions.add(r.subscribeMarkActiveThreadRead()),r.unsubscribeFunctions.add(r.subscribeReloadActiveStaleThread()),r.unsubscribeFunctions.add(r.subscribeMarkThreadStale()),r.unsubscribeFunctions.add(r.subscribeNewReplies()),r.unsubscribeFunctions.add(r.subscribeRepliesRead()),r.unsubscribeFunctions.add(r.subscribeMessageDeleted()),r.unsubscribeFunctions.add(r.subscribeMessageUpdated()))}),q(this,"subscribeThreadUpdated",function(){return r.client.on("thread.updated",function(d){if(!(!d.thread||d.thread.parent_message_id!==r.id)){var u=d.thread;r.state.partialNext({title:u.title,updatedAt:new Date(u.updated_at),deletedAt:u.deleted_at?new Date(u.deleted_at):null,custom:Tj(u)})}}).unsubscribe}),q(this,"subscribeMarkActiveThreadRead",function(){return r.state.subscribeWithSelector(function(d){return{active:d.active,unreadMessageCount:Ej(r.client.userID)(d)}},function(d){var u=d.active,h=d.unreadMessageCount;!u||!h||r.throttledMarkAsRead()})}),q(this,"subscribeReloadActiveStaleThread",function(){return r.state.subscribeWithSelector(function(d){return{active:d.active,isStateStale:d.isStateStale}},function(d){var u=d.active,h=d.isStateStale;u&&h&&r.reload()})}),q(this,"subscribeMarkThreadStale",function(){return r.client.on("user.watching.stop",function(d){var u,h,p=r.state.getLatestValue(),g=p.channel;!r.client.userID||r.client.userID!==((u=d.user)===null||u===void 0?void 0:u.id)||((h=d.channel)===null||h===void 0?void 0:h.cid)!==g.cid||r.state.partialNext({isStateStale:!0})}).unsubscribe}),q(this,"subscribeNewReplies",function(){return r.client.on("message.new",function(d){var u,h;if(!(!r.client.userID||((u=d.message)===null||u===void 0?void 0:u.parent_id)!==r.id)){var p=((h=d.message.user)===null||h===void 0?void 0:h.id)===r.client.userID,g=r.state.getLatestValue(),f=g.active,m=g.read;r.upsertReplyLocally({message:d.message,timestampChanged:p}),f&&r.throttledMarkAsRead();for(var v={},b=0,w=Object.keys(m);b<w.length;b++){var x=w[b],j=m[x];if(j){var S,_=j;x===((S=d.user)===null||S===void 0?void 0:S.id)?_=Xr(Xr({},_),{},{lastReadAt:d.created_at?new Date(d.created_at):new Date,user:d.user,unreadMessageCount:0}):f&&x===r.client.userID||(_=Xr(Xr({},_),{},{unreadMessageCount:j.unreadMessageCount+1})),v[x]=_}}r.state.partialNext({read:v})}}).unsubscribe}),q(this,"subscribeRepliesRead",function(){return r.client.on("message.read",function(d){if(!(!d.user||!d.created_at||!d.thread)&&d.thread.parent_message_id===r.id){var u=d.user.id,h=d.created_at,p=d.user;r.state.next(function(g){return Xr(Xr({},g),{},{read:Xr(Xr({},g.read),{},q({},u,{lastReadAt:new Date(h),user:p,lastReadMessageId:d.last_read_message_id,unreadMessageCount:0}))})})}}).unsubscribe}),q(this,"subscribeMessageDeleted",function(){return r.client.on("message.deleted",function(d){d.message&&(d.message.parent_id===r.id&&(d.hard_delete?r.deleteReplyLocally({message:d.message}):r.upsertReplyLocally({message:d.message})),d.message.id===r.id&&r.updateParentMessageLocally({message:d.message}))}).unsubscribe}),q(this,"subscribeMessageUpdated",function(){var d=["message.updated","reaction.new","reaction.deleted","reaction.updated"],u=d.map(function(h){return r.client.on(h,function(p){p.message&&r.updateParentMessageOrReplyLocally(p.message)}).unsubscribe});return function(){return u.forEach(function(h){return h()})}}),q(this,"unregisterSubscriptions",function(){r.unsubscribeFunctions.forEach(function(d){return d()}),r.unsubscribeFunctions.clear()}),q(this,"deleteReplyLocally",function(d){var u,h=d.message,p=r.state.getLatestValue(),g=p.replies,f=lC({needle:fi(h),sortedArray:g,sortDirection:"ascending",selectValueToCompare:function(b){return b.created_at.getTime()},selectKey:function(b){return b.id}});if(((u=g[f])===null||u===void 0?void 0:u.id)===h.id){var m=Or(g);m.splice(f,1),r.state.partialNext({replies:m})}}),q(this,"upsertReplyLocally",function(d){var u=d.message,h=d.timestampChanged,p=h===void 0?!1:h;if(u.parent_id!==r.id)throw new Error("Reply does not belong to this thread");var g=fi(u);u.status==="failed"?r.failedRepliesMap.set(g.id,g):r.failedRepliesMap.has(u.id)&&r.failedRepliesMap.delete(u.id),r.state.next(function(f){return Xr(Xr({},f),{},{replies:cC(f.replies,g,p)})})}),q(this,"updateParentMessageLocally",function(d){var u=d.message;if(u.id!==r.id)throw new Error("Message does not belong to this thread");r.state.next(function(h){var p,g=fi(u);return Xr(Xr({},h),{},{deletedAt:g.deleted_at,parentMessage:g,replyCount:(p=u.reply_count)!==null&&p!==void 0?p:h.replyCount})})}),q(this,"updateParentMessageOrReplyLocally",function(d){d.parent_id===r.id&&r.upsertReplyLocally({message:d}),!d.parent_id&&d.id===r.id&&r.updateParentMessageLocally({message:d})}),q(this,"markAsRead",pe(L.mark(function d(){var u,h,p,g=arguments;return L.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(u=g.length>0&&g[0]!==void 0?g[0]:{},h=u.force,p=h===void 0?!1:h,!(r.ownUnreadCount===0&&!p)){m.next=3;break}return m.abrupt("return",null);case 3:return m.next=5,r.channel.markRead({thread_id:r.id});case 5:return m.abrupt("return",m.sent);case 6:case"end":return m.stop()}},d)}))),q(this,"throttledMarkAsRead",dC(function(){return r.markAsRead()},PF,{trailing:!0})),q(this,"queryReplies",function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=d.limit,h=u===void 0?Mg:u,p=d.sort,g=p===void 0?TF:p,f=oh(d,NF);return r.channel.getReplies(r.id,Xr({limit:h},f),g)}),q(this,"loadNextPage",function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=d.limit,h=u===void 0?Mg:u;return r.loadPage(h)}),q(this,"loadPrevPage",function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=d.limit,h=u===void 0?Mg:u;return r.loadPage(-h)}),q(this,"loadPage",function(){var d=pe(L.mark(function u(h){var p,g,f,m,v,b,w,x,j,S,_,C,N,M;return L.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(p=r.state.getLatestValue(),g=p.pagination,f=h>0?["isLoadingNext","nextCursor","push"]:["isLoadingPrev","prevCursor","unshift"],m=Ql(f,3),v=m[0],b=m[1],w=m[2],!(g[v]||g[b]===null)){P.next=4;break}return P.abrupt("return");case 4:return x=q({},h>0?"id_gt":"id_lt",g[b]),j=Math.abs(h),r.state.partialNext({pagination:Xr(Xr({},g),{},q({},v,!0))}),P.prev=7,P.next=10,r.queryReplies(Xr(Xr({},x),{},{limit:j}));case 10:C=P.sent,N=C.messages.map(fi),M=(S=(_=N.at(h>0?-1:0))===null||_===void 0?void 0:_.id)!==null&&S!==void 0?S:null,r.state.next(function(D){var T,A=D.replies;if(N.length>0){var k;A=Or(D.replies),(k=A)[w].apply(k,Or(N))}return Xr(Xr({},D),{},{replies:A,pagination:Xr(Xr({},D.pagination),{},(T={},q(T,b,C.messages.length<j?null:M),q(T,v,!1),T))})}),P.next=20;break;case 16:P.prev=16,P.t0=P.catch(7),r.client.logger("error",P.t0.message),r.state.next(function(D){return Xr(Xr({},D),{},{pagination:Xr(Xr({},D.pagination),{},q({},v,!1))})});case 20:case"end":return P.stop()}},u,null,[[7,16]])}));return function(u){return d.apply(this,arguments)}}());var l=o.channel(i.channel.type,i.channel.id,{name:i.channel.name});l._hydrateMembers({members:(s=i.channel.members)!==null&&s!==void 0?s:[],overrideCurrentState:!1});var c=o.userID?[{user:{id:o.userID},unread_messages:0,last_read:new Date().toISOString()}]:[];this.state=new kh({active:!1,isLoading:!1,isStateStale:!1,channel:l,createdAt:new Date(i.created_at),deletedAt:i.deleted_at?new Date(i.deleted_at):null,pagination:AF(i),parentMessage:fi(i.parent_message),participants:i.thread_participants,read:RF(!i.read||i.read.length===0?c:i.read),replies:i.latest_replies.map(fi),replyCount:(a=i.reply_count)!==null&&a!==void 0?a:0,updatedAt:i.updated_at?new Date(i.updated_at):null,title:i.title,custom:Tj(i)}),this.id=i.parent_message_id,this.client=o}return sr(n,[{key:"channel",get:function(){return this.state.getLatestValue().channel}},{key:"hasStaleState",get:function(){return this.state.getLatestValue().isStateStale}},{key:"ownUnreadCount",get:function(){return Ej(this.client.userID)(this.state.getLatestValue())}}]),n}(),RF=function(t){return t.reduce(function(r,s){var a;return r[s.user.id]={user:s.user,lastReadMessageId:s.last_read_message_id,unreadMessageCount:(a=s.unread_messages)!==null&&a!==void 0?a:0,lastReadAt:new Date(s.last_read)},r},{})},AF=function(t){var r,s,a=t.latest_replies.length===t.reply_count;return{nextCursor:null,prevCursor:a?null:(r=(s=t.latest_replies.at(0))===null||s===void 0?void 0:s.id)!==null&&r!==void 0?r:null,isLoadingNext:!1,isLoadingPrev:!1}},Ej=function(t){return function(r){var s;return t&&((s=r.read[t])===null||s===void 0?void 0:s.unreadMessageCount)||0}};function Rj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function nl(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Rj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var sp={user:"stream:user",message:"stream:chat:v1:message",userprofile:"stream:v1:user_profile"},MF=function(){function n(t){Vt(this,n),q(this,"client",void 0),this.client=t}return sr(n,[{key:"flagUser",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.abrupt("return",this.flag(sp.user,a,"",o,i));case 2:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"flagMessage",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.abrupt("return",this.flag(sp.message,a,"",o,i));case 2:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"flag",value:function(){var t=pe(L.mark(function s(a,o,i,l){var c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=d.length>4&&d[4]!==void 0?d[4]:{},h.next=3,this.client.post(this.client.baseURL+"/api/v2/moderation/flag",nl({entity_type:a,entity_id:o,entity_creator_id:i,reason:l},c));case 3:return h.abrupt("return",h.sent);case 4:case"end":return h.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"muteUser",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.client.post(this.client.baseURL+"/api/v2/moderation/mute",nl({target_ids:[a]},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"unmuteUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.client.post(this.client.baseURL+"/api/v2/moderation/unmute",nl({target_ids:[a]},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getUserModerationReport",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.client.get(this.client.baseURL+"/api/v2/moderation/user_report",nl({user_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryReviewQueue",value:function(){var t=pe(L.mark(function s(){var a,o,i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=l.length>0&&l[0]!==void 0?l[0]:{},o=l.length>1&&l[1]!==void 0?l[1]:[],i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=5,this.client.post(this.client.baseURL+"/api/v2/moderation/review_queue",nl({filter:a,sort:ys(o)},i));case 5:return d.abrupt("return",d.sent);case 6:case"end":return d.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"upsertConfig",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.client.post(this.client.baseURL+"/api/v2/moderation/config",a);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getConfig",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.client.get(this.client.baseURL+"/api/v2/moderation/config/"+a,o);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"deleteConfig",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.client.delete(this.client.baseURL+"/api/v2/moderation/config/"+a,o);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"queryConfigs",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.client.post(this.client.baseURL+"/api/v2/moderation/configs",nl({filter:a,sort:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"submitAction",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.client.post(this.client.baseURL+"/api/v2/moderation/submit_action",nl({action_type:a,item_id:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"check",value:function(){var t=pe(L.mark(function s(a,o,i,l,c,d){return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.client.post(this.client.baseURL+"/api/v2/moderation/check",{entity_type:a,entity_id:o,entity_creator_id:i,moderation_payload:l,config_key:c,options:d});case 2:return h.abrupt("return",h.sent);case 3:case"end":return h.stop()}},s,this)}));function r(s,a,o,i,l,c){return t.apply(this,arguments)}return r}()},{key:"checkUserProfile",value:function(){var t=pe(L.mark(function s(a,o){var i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(!o.username&&!o.image)){c.next=2;break}throw new Error("Either username or image must be provided");case 2:return i={},o.username&&(i.texts=[o.username]),o.image&&(i.images=[o.image]),c.next=7,this.check(sp.userprofile,a,a,i,"user_profile:default",{force_sync:!0,test_mode:!0});case 7:return c.abrupt("return",c.sent);case 8:case"end":return c.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"addCustomFlags",value:function(){var t=pe(L.mark(function s(a,o,i,l,c){return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.client.post(this.client.baseURL+"/api/v2/moderation/custom_check",{entity_type:a,entity_id:o,entity_creator_id:i,moderation_payload:l,flags:c});case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},s,this)}));function r(s,a,o,i,l){return t.apply(this,arguments)}return r}()},{key:"addCustomMessageFlags",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.addCustomFlags(sp.message,a,"",{},o);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()}]),n}();function IF(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=DF(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(d){i=!0,l=d},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function DF(n,t){if(n){if(typeof n=="string")return Aj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Aj(n,t)}}function Aj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function Mj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Fr(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Mj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var $F=1e3,Ij=25,Dj={active:!1,isThreadOrderStale:!1,threads:[],unreadThreadCount:0,unseenThreadIds:[],lastConnectionDropAt:null,pagination:{isLoading:!1,isLoadingNext:!1,nextCursor:null},ready:!1},LF=function(){function n(t){var r=this,s=t.client;Vt(this,n),q(this,"state",void 0),q(this,"client",void 0),q(this,"unsubscribeFunctions",new Set),q(this,"threadsByIdGetterCache",void 0),q(this,"resetState",function(){r.state.next(Dj)}),q(this,"activate",function(){r.state.partialNext({active:!0})}),q(this,"deactivate",function(){r.state.partialNext({active:!1})}),q(this,"registerSubscriptions",function(){r.unsubscribeFunctions.size||(r.unsubscribeFunctions.add(r.subscribeUnreadThreadsCountChange()),r.unsubscribeFunctions.add(r.subscribeManageThreadSubscriptions()),r.unsubscribeFunctions.add(r.subscribeReloadOnActivation()),r.unsubscribeFunctions.add(r.subscribeNewReplies()),r.unsubscribeFunctions.add(r.subscribeRecoverAfterConnectionDrop()),r.unsubscribeFunctions.add(r.subscribeChannelDeleted()))}),q(this,"subscribeUnreadThreadsCountChange",function(){var a,o=(a=r.client.user)!==null&&a!==void 0?a:{},i=o.unread_threads,l=i===void 0?0:i;r.state.partialNext({unreadThreadCount:l});var c=["health.check","notification.mark_read","notification.thread_message_new","notification.channel_deleted"].map(function(d){return r.client.on(d,function(u){var h,p=(h=u.me)!==null&&h!==void 0?h:u,g=p.unread_threads;typeof g=="number"&&r.state.partialNext({unreadThreadCount:g})}).unsubscribe});return function(){return c.forEach(function(d){return d()})}}),q(this,"subscribeChannelDeleted",function(){return r.client.on("notification.channel_deleted",function(a){var o=a.cid,i=r.state.getLatestValue(),l=i.threads,c=l.filter(function(d){return d.channel.cid!==o});r.state.partialNext({threads:c})}).unsubscribe}),q(this,"subscribeManageThreadSubscriptions",function(){return r.state.subscribeWithSelector(function(a){return{threads:a.threads}},function(a,o){var i=a.threads,l=o??{},c=l.threads,d=c===void 0?[]:c,u=d.filter(function(h){return h!==r.threadsById[h.id]});i.forEach(function(h){return h.registerSubscriptions()}),u.forEach(function(h){return h.unregisterSubscriptions()})})}),q(this,"subscribeReloadOnActivation",function(){return r.state.subscribeWithSelector(function(a){return{active:a.active}},function(a){var o=a.active;o&&r.reload()})}),q(this,"subscribeNewReplies",function(){return r.client.on("notification.thread_message_new",function(a){var o,i=(o=a.message)===null||o===void 0?void 0:o.parent_id;if(i){var l=r.state.getLatestValue(),c=l.unseenThreadIds,d=l.ready;d&&(r.threadsById[i]?r.state.partialNext({isThreadOrderStale:!0}):c.includes(i)||r.state.partialNext({unseenThreadIds:c.concat(i)}))}}).unsubscribe}),q(this,"subscribeRecoverAfterConnectionDrop",function(){var a=r.client.on("connection.changed",function(l){l.online===!1&&r.state.next(function(c){return c.lastConnectionDropAt?c:Fr(Fr({},c),{},{lastConnectionDropAt:new Date})})}).unsubscribe,o=dC(function(){var l=r.state.getLatestValue(),c=l.lastConnectionDropAt;c&&r.reload({force:!0})},$F,{trailing:!0}),i=r.client.on("connection.recovered",o).unsubscribe;return function(){a(),i()}}),q(this,"unregisterSubscriptions",function(){r.state.getLatestValue().threads.forEach(function(a){return a.unregisterSubscriptions()}),r.unsubscribeFunctions.forEach(function(a){return a()}),r.unsubscribeFunctions.clear()}),q(this,"reload",pe(L.mark(function a(){var o,i,l,c,d,u,h,p,g,f,m,v,b,w,x,j,S,_=arguments;return L.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(o=_.length>0&&_[0]!==void 0?_[0]:{},i=o.force,l=i===void 0?!1:i,c=r.state.getLatestValue(),d=c.threads,u=c.unseenThreadIds,h=c.isThreadOrderStale,p=c.pagination,g=c.ready,!p.isLoading){N.next=4;break}return N.abrupt("return");case 4:if(!(!l&&g&&!u.length&&!h)){N.next=6;break}return N.abrupt("return");case 6:return f=d.length+u.length,N.prev=7,r.state.next(function(M){return Fr(Fr({},M),{},{pagination:Fr(Fr({},M.pagination),{},{isLoading:!0})})}),N.next=11,r.queryThreads({limit:Math.min(f,Ij)||Ij});case 11:m=N.sent,v=r.threadsById,b=[],w=IF(m.threads);try{for(w.s();!(x=w.n()).done;)j=x.value,S=v[j.id],S?(b.push(S),S.hasStaleState&&S.hydrateState(j)):b.push(j)}catch(M){w.e(M)}finally{w.f()}r.state.next(function(M){var E;return Fr(Fr({},M),{},{threads:b,unseenThreadIds:[],isThreadOrderStale:!1,pagination:Fr(Fr({},M.pagination),{},{isLoading:!1,nextCursor:(E=m.next)!==null&&E!==void 0?E:null}),ready:!0})}),N.next=23;break;case 19:N.prev=19,N.t0=N.catch(7),r.client.logger("error",N.t0.message),r.state.next(function(M){return Fr(Fr({},M),{},{pagination:Fr(Fr({},M.pagination),{},{isLoading:!1})})});case 23:case"end":return N.stop()}},a,null,[[7,19]])}))),q(this,"queryThreads",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.client.queryThreads(Fr({limit:25,participant_limit:10,reply_limit:10,watch:!0},a))}),q(this,"loadNextPage",pe(L.mark(function a(){var o,i,l,c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o=d.length>0&&d[0]!==void 0?d[0]:{},i=r.state.getLatestValue(),l=i.pagination,!(l.isLoadingNext||!l.nextCursor)){h.next=4;break}return h.abrupt("return");case 4:return h.prev=4,r.state.partialNext({pagination:Fr(Fr({},l),{},{isLoadingNext:!0})}),h.next=8,r.queryThreads(Fr(Fr({},o),{},{next:l.nextCursor}));case 8:c=h.sent,r.state.next(function(p){var g;return Fr(Fr({},p),{},{threads:c.threads.length?p.threads.concat(c.threads):p.threads,pagination:Fr(Fr({},p.pagination),{},{nextCursor:(g=c.next)!==null&&g!==void 0?g:null,isLoadingNext:!1})})}),h.next=16;break;case 12:h.prev=12,h.t0=h.catch(4),r.client.logger("error",h.t0.message),r.state.next(function(p){return Fr(Fr({},p),{},{pagination:Fr(Fr({},p.pagination),{},{isLoadingNext:!1})})});case 16:case"end":return h.stop()}},a,null,[[4,12]])}))),this.client=s,this.state=new kh(Dj),this.threadsByIdGetterCache={threads:[],threadsById:{}}}return sr(n,[{key:"threadsById",get:function(){var r=this.state.getLatestValue(),s=r.threads;if(s===this.threadsByIdGetterCache.threads)return this.threadsByIdGetterCache.threadsById;var a=s.reduce(function(o,i){return o[i.id]=i,o},{});return this.threadsByIdGetterCache.threads=s,this.threadsByIdGetterCache.threadsById=a,a}}]),n}(),BF=["own_votes","id"],OF=["id"];function $j(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Ps(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$j(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):$j(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var zF=function(t){return t.type==="poll.updated"},FF=function(t){return t.type==="poll.closed"},WF=function(t){return t.type==="poll.vote_casted"},UF=function(t){return t.type==="poll.vote_changed"},qF=function(t){return t.type==="poll.vote_removed"},hl=function(t){return!!(t!=null&&t.answer_text)},Lj=function(){function n(t){var r=this,s=t.client,a=t.poll;Vt(this,n),q(this,"state",void 0),q(this,"id",void 0),q(this,"client",void 0),q(this,"unsubscribeFunctions",new Set),q(this,"getInitialStateFromPollResponse",function(o){var i,l=o.own_votes;o.id;var c=oh(o,BF),d=(i=l==null?void 0:l.reduce(function(p,g){return hl(g)?p.ownAnswer=g:p.ownVotes.push(g),p},{ownVotes:[]}))!==null&&i!==void 0?i:{ownVotes:[]},u=d.ownAnswer,h=d.ownVotes;return Ps(Ps({},c),{},{lastActivityAt:new Date,maxVotedOptionIds:Wd(c.vote_counts_by_option),ownAnswer:u,ownVotesByOptionId:HF(h)})}),q(this,"reinitializeState",function(o){r.state.partialNext(r.getInitialStateFromPollResponse(o))}),q(this,"handlePollUpdated",function(o){var i;if(!((i=o.poll)!==null&&i!==void 0&&i.id&&o.poll.id!==r.id)&&zF(o)){var l=YF(o.poll),c=oh(l,OF);r.state.partialNext(Ps(Ps({},c),{},{lastActivityAt:new Date(o.created_at)}))}}),q(this,"handlePollClosed",function(o){var i;(i=o.poll)!==null&&i!==void 0&&i.id&&o.poll.id!==r.id||FF(o)&&r.state.partialNext({is_closed:!0,lastActivityAt:new Date(o.created_at)})}),q(this,"handleVoteCasted",function(o){var i;if(!((i=o.poll)!==null&&i!==void 0&&i.id&&o.poll.id!==r.id)&&WF(o)){var l=r.data,c=o.poll_vote.user_id===r.client.userID,d=Or(l.latest_answers),u=l.ownAnswer,h=l.ownVotesByOptionId,p=l.maxVotedOptionIds;c&&(hl(o.poll_vote)?u=o.poll_vote:o.poll_vote.option_id&&(h[o.poll_vote.option_id]=o.poll_vote)),hl(o.poll_vote)?d=[o.poll_vote].concat(Or(d)):p=Wd(o.poll.vote_counts_by_option);var g=Ig(o.poll);r.state.partialNext(Ps(Ps({},g),{},{latest_answers:d,lastActivityAt:new Date(o.created_at),ownAnswer:u,ownVotesByOptionId:h,maxVotedOptionIds:p}))}}),q(this,"handleVoteChanged",function(o){var i;if(!((i=o.poll)!==null&&i!==void 0&&i.id&&o.poll.id!==r.id)&&UF(o)){var l=r.data,c=o.poll_vote.user_id===r.client.userID,d=Or(l.latest_answers),u=l.ownAnswer,h=l.ownVotesByOptionId,p=l.maxVotedOptionIds;if(c){if(hl(o.poll_vote))d=[o.poll_vote].concat(Or(d.filter(function(m){return m.id!==o.poll_vote.id}))),u=o.poll_vote;else if(o.poll_vote.option_id){var g;o.poll.enforce_unique_votes?h=q({},o.poll_vote.option_id,o.poll_vote):(h=Object.entries(h).reduce(function(m,v){var b=Ql(v,2),w=b[0],x=b[1];return w!==o.poll_vote.option_id&&x.id===o.poll_vote.id||(m[w]=x),m},{}),h[o.poll_vote.option_id]=o.poll_vote),((g=u)===null||g===void 0?void 0:g.id)===o.poll_vote.id&&(u=void 0),p=Wd(o.poll.vote_counts_by_option)}}else hl(o.poll_vote)?d=[o.poll_vote].concat(Or(d)):p=Wd(o.poll.vote_counts_by_option);var f=Ig(o.poll);r.state.partialNext(Ps(Ps({},f),{},{latest_answers:d,lastActivityAt:new Date(o.created_at),ownAnswer:u,ownVotesByOptionId:h,maxVotedOptionIds:p}))}}),q(this,"handleVoteRemoved",function(o){var i;if(!((i=o.poll)!==null&&i!==void 0&&i.id&&o.poll.id!==r.id)&&qF(o)){var l=r.data,c=o.poll_vote.user_id===r.client.userID,d=Or(l.latest_answers),u=l.ownAnswer,h=Ps({},l.ownVotesByOptionId),p=l.maxVotedOptionIds;hl(o.poll_vote)?(d=d.filter(function(f){return f.id!==o.poll_vote.id}),c&&(u=void 0)):(p=Wd(o.poll.vote_counts_by_option),c&&o.poll_vote.option_id&&delete h[o.poll_vote.option_id]);var g=Ig(o.poll);r.state.partialNext(Ps(Ps({},g),{},{latest_answers:d,lastActivityAt:new Date(o.created_at),ownAnswer:u,ownVotesByOptionId:h,maxVotedOptionIds:p}))}}),q(this,"query",function(){var o=pe(L.mark(function i(l){var c,d;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,r.client.getPoll(l);case 2:return c=h.sent,d=c.poll,r.state.partialNext(Ps(Ps({},d),{},{lastActivityAt:new Date})),h.abrupt("return",d);case 6:case"end":return h.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"update",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.updatePoll(Ps(Ps({},l),{},{id:r.id}));case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"partialUpdate",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.partialUpdatePoll(r.id,l);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"close",pe(L.mark(function o(){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.client.closePoll(r.id);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},o)}))),q(this,"delete",pe(L.mark(function o(){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.client.deletePoll(r.id);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},o)}))),q(this,"createOption",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.createPollOption(r.id,l);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"updateOption",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.updatePollOption(r.id,l);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"deleteOption",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.deletePollOption(r.id,l);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"castVote",function(){var o=pe(L.mark(function i(l,c){var d,u,h,p,g,f;return L.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(d=r.data,u=d.max_votes_allowed,h=d.ownVotesByOptionId,p=u&&u===Object.keys(h).length,!p){v.next=8;break}if(f=Object.values(h)[0],Object.values(h).slice(1).forEach(function(b){var w;(!((w=f)!==null&&w!==void 0&&w.created_at)||new Date(b.created_at)<new Date(f.created_at))&&(f=b)}),!((g=f)!==null&&g!==void 0&&g.id)){v.next=8;break}return v.next=8,r.removeVote(f.id,c);case 8:return v.next=10,r.client.castPollVote(c,r.id,{option_id:l});case 10:return v.abrupt("return",v.sent);case 11:case"end":return v.stop()}},i)}));return function(i,l){return o.apply(this,arguments)}}()),q(this,"removeVote",function(){var o=pe(L.mark(function i(l,c){return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.client.removePollVote(c,r.id,l);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)}));return function(i,l){return o.apply(this,arguments)}}()),q(this,"addAnswer",function(){var o=pe(L.mark(function i(l,c){return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.client.addPollAnswer(c,r.id,l);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)}));return function(i,l){return o.apply(this,arguments)}}()),q(this,"removeAnswer",function(){var o=pe(L.mark(function i(l,c){return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.client.removePollVote(c,r.id,l);case 2:return u.abrupt("return",u.sent);case 3:case"end":return u.stop()}},i)}));return function(i,l){return o.apply(this,arguments)}}()),q(this,"queryAnswers",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.queryPollAnswers(r.id,l.filter,l.sort,l.options);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),q(this,"queryOptionVotes",function(){var o=pe(L.mark(function i(l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.client.queryPollVotes(r.id,l.filter,l.sort,l.options);case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},i)}));return function(i){return o.apply(this,arguments)}}()),this.client=s,this.id=a.id,this.state=new kh(this.getInitialStateFromPollResponse(a))}return sr(n,[{key:"data",get:function(){return this.state.getLatestValue()}}]),n}();function Wd(n){for(var t=0,r=[],s=0,a=Object.entries(n??{});s<a.length;s++){var o=Ql(a[s],2),i=o[0],l=o[1];l>t?(r=[i],t=l):l===t&&r.push(i)}return r}function HF(n){return n?n.reduce(function(t,r){return hl(r)||!r.option_id||(t[r.option_id]=r),t},{}):{}}function YF(n){return{allow_answers:n.allow_answers,allow_user_suggested_options:n.allow_user_suggested_options,description:n.description,enforce_unique_vote:n.enforce_unique_vote,id:n.id,is_closed:n.is_closed,max_votes_allowed:n.max_votes_allowed,name:n.name,options:n.options,voting_visibility:n.voting_visibility}}function Ig(n){return{answers_count:n.answers_count,latest_votes_by_option:n.latest_votes_by_option,vote_count:n.vote_count,vote_counts_by_option:n.vote_counts_by_option}}function GF(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=VF(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(d){i=!0,l=d},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function VF(n,t){if(n){if(typeof n=="string")return Bj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bj(n,t)}}function Bj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}var KF=function(){function n(t){var r=this,s=t.client;Vt(this,n),q(this,"client",void 0),q(this,"pollCache",new Map),q(this,"unsubscribeFunctions",new Set),q(this,"fromState",function(a){return r.pollCache.get(a)}),q(this,"registerSubscriptions",function(){r.unsubscribeFunctions.size||(r.unsubscribeFunctions.add(r.subscribeMessageNew()),r.unsubscribeFunctions.add(r.subscribePollUpdated()),r.unsubscribeFunctions.add(r.subscribePollClosed()),r.unsubscribeFunctions.add(r.subscribeVoteCasted()),r.unsubscribeFunctions.add(r.subscribeVoteChanged()),r.unsubscribeFunctions.add(r.subscribeVoteRemoved()))}),q(this,"unregisterSubscriptions",function(){r.unsubscribeFunctions.forEach(function(a){return a()}),r.unsubscribeFunctions.clear()}),q(this,"createPoll",function(){var a=pe(L.mark(function o(i){var l,c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.client.createPoll(i);case 2:return l=u.sent,c=l.poll,u.abrupt("return",new Lj({client:r.client,poll:c}));case 5:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),q(this,"getPoll",function(){var a=pe(L.mark(function o(i){var l,c,d;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l=r.fromState(i),!l){h.next=4;break}return r.client.getPoll(i).then(function(p){var g=p.poll;return r.setOrOverwriteInCache(g,!0)}),h.abrupt("return",l);case 4:return h.next=6,r.client.getPoll(i);case 6:return c=h.sent,d=c.poll,r.setOrOverwriteInCache(d),h.abrupt("return",r.fromState(i));case 10:case"end":return h.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),q(this,"queryPolls",function(){var a=pe(L.mark(function o(i){var l,c,d,u,h,p,g=arguments;return L.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=g.length>1&&g[1]!==void 0?g[1]:[],c=g.length>2&&g[2]!==void 0?g[2]:{},m.next=4,r.client.queryPolls(i,l,c);case 4:return d=m.sent,u=d.polls,h=d.next,p=u.map(function(v){return r.setOrOverwriteInCache(v,!0),r.fromState(v.id)}),m.abrupt("return",{polls:p,next:h});case 9:case"end":return m.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),q(this,"hydratePollCache",function(a,o){var i=GF(a),l;try{for(i.s();!(l=i.n()).done;){var c=l.value;if(c.poll){var d=c.poll;r.setOrOverwriteInCache(d,o)}}}catch(u){i.e(u)}finally{i.f()}}),q(this,"setOrOverwriteInCache",function(a,o){if(r.client._cacheEnabled()){var i=r.fromState(a.id);if(i)o&&i.reinitializeState(a);else{var l=new Lj({client:r.client,poll:a});r.pollCache.set(l.id,l)}}}),q(this,"subscribePollUpdated",function(){return r.client.on("poll.updated",function(a){var o;if((o=a.poll)!==null&&o!==void 0&&o.id){var i;(i=r.fromState(a.poll.id))===null||i===void 0||i.handlePollUpdated(a)}}).unsubscribe}),q(this,"subscribePollClosed",function(){return r.client.on("poll.closed",function(a){var o;if((o=a.poll)!==null&&o!==void 0&&o.id){var i;(i=r.fromState(a.poll.id))===null||i===void 0||i.handlePollClosed(a)}}).unsubscribe}),q(this,"subscribeVoteCasted",function(){return r.client.on("poll.vote_casted",function(a){var o;if((o=a.poll)!==null&&o!==void 0&&o.id){var i;(i=r.fromState(a.poll.id))===null||i===void 0||i.handleVoteCasted(a)}}).unsubscribe}),q(this,"subscribeVoteChanged",function(){return r.client.on("poll.vote_changed",function(a){var o;if((o=a.poll)!==null&&o!==void 0&&o.id){var i;(i=r.fromState(a.poll.id))===null||i===void 0||i.handleVoteChanged(a)}}).unsubscribe}),q(this,"subscribeVoteRemoved",function(){return r.client.on("poll.vote_removed",function(a){var o;if((o=a.poll)!==null&&o!==void 0&&o.id){var i;(i=r.fromState(a.poll.id))===null||i===void 0||i.handleVoteRemoved(a)}}).unsubscribe}),q(this,"subscribeMessageNew",function(){return r.client.on("message.new",function(a){var o=a.message;if(o){var i=fi(o);r.hydratePollCache([i])}}).unsubscribe}),this.client=s}return sr(n,[{key:"data",get:function(){return this.pollCache}}]),n}();function Oj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Er(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Oj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}var zj={"channel.deleted":"channelDeletedHandler","channel.hidden":"channelHiddenHandler","channel.truncated":"channelTruncatedHandler","channel.updated":"channelUpdatedHandler","channel.visible":"channelVisibleHandler","message.new":"newMessageHandler","member.updated":"memberUpdatedHandler","notification.added_to_channel":"notificationAddedToChannelHandler","notification.message_new":"notificationNewMessageHandler","notification.removed_from_channel":"notificationRemovedFromChannelHandler"},JF={abortInFlightQuery:!1,allowNotLoadedChannelPromotionForEvent:{"channel.visible":!0,"message.new":!0,"notification.added_to_channel":!0,"notification.message_new":!0},lockChannelOrder:!1},Dg={limit:10,offset:0},XF=function n(t){var r=this,s=t.client,a=t.eventHandlerOverrides,o=a===void 0?{}:a,i=t.options,l=i===void 0?{}:i;Vt(this,n),q(this,"state",void 0),q(this,"client",void 0),q(this,"unsubscribeFunctions",new Set),q(this,"eventHandlers",new Map),q(this,"eventHandlerOverrides",new Map),q(this,"options",{}),q(this,"stateOptions",{}),q(this,"setChannels",function(c){r.state.next(function(d){var u=d.channels,h=gC(c)?c(u):c;return u===h?d:Er(Er({},d),{},{channels:h})})}),q(this,"setEventHandlerOverrides",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=Object.entries(c).reduce(function(u,h){var p=Ql(h,2),g=p[0],f=p[1];return f&&(u[g]=f),u},{});r.eventHandlerOverrides=new Map(Object.entries(d))}),q(this,"setOptions",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r.options=Er(Er({},JF),c)}),q(this,"queryChannels",function(){var c=pe(L.mark(function d(u){var h,p,g,f,m,v,b,w,x,j,S,_,C,N,M,E=arguments;return L.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(h=E.length>1&&E[1]!==void 0?E[1]:[],p=E.length>2&&E[2]!==void 0?E[2]:{},g=E.length>3&&E[3]!==void 0?E[3]:{},f=Er(Er({},Dg),p),m=f.offset,v=f.limit,b=r.state.getLatestValue(),w=b.pagination.isLoading,!(w&&!r.options.abortInFlightQuery)){D.next=7;break}return D.abrupt("return");case 7:return D.prev=7,r.stateOptions=g,r.state.next(function(T){return Er(Er({},T),{},{pagination:Er(Er({},T.pagination),{},{isLoading:!0,isLoadingNext:!1,filters:u,sort:h,options:p})})}),D.next=12,r.client.queryChannels(u,h,p,g);case 12:S=D.sent,_=m+((x=S==null?void 0:S.length)!==null&&x!==void 0?x:0),C=Er(Er({},p),{},{offset:_}),N=r.state.getLatestValue(),M=N.pagination,r.state.partialNext({channels:S,pagination:Er(Er({},M),{},{hasNext:((j=S==null?void 0:S.length)!==null&&j!==void 0?j:0)>=v,isLoading:!1,options:C}),initialized:!0}),D.next=24;break;case 19:throw D.prev=19,D.t0=D.catch(7),r.client.logger("error",D.t0.message),r.state.next(function(T){return Er(Er({},T),{},{pagination:Er(Er({},T.pagination),{},{isLoading:!1})})}),D.t0;case 24:case"end":return D.stop()}},d,null,[[7,19]])}));return function(d){return c.apply(this,arguments)}}()),q(this,"loadNext",pe(L.mark(function c(){var d,u,h,p,g,f,m,v,b,w,x,j,S,_,C,N,M,E;return L.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(d=r.state.getLatestValue(),u=d.pagination,h=d.initialized,p=u.filters,g=u.sort,f=u.options,m=u.isLoadingNext,v=u.hasNext,!(!h||m||!v)){D.next=4;break}return D.abrupt("return");case 4:return D.prev=4,x=Er(Er({},Dg),f),j=x.offset,S=x.limit,r.state.partialNext({pagination:Er(Er({},u),{},{isLoading:!1,isLoadingNext:!0})}),D.next=9,r.client.queryChannels(p,g,f,r.stateOptions);case 9:_=D.sent,C=r.state.getLatestValue(),N=C.channels,M=j+((b=_==null?void 0:_.length)!==null&&b!==void 0?b:0),E=Er(Er({},f),{},{offset:M}),r.state.partialNext({channels:Gz([].concat(Or(N||[]),Or(_)),"cid"),pagination:Er(Er({},u),{},{hasNext:((w=_==null?void 0:_.length)!==null&&w!==void 0?w:0)>=S,isLoading:!1,isLoadingNext:!1,options:E})}),D.next=21;break;case 16:throw D.prev=16,D.t0=D.catch(4),r.client.logger("error",D.t0.message),r.state.next(function(T){return Er(Er({},T),{},{pagination:Er(Er({},T.pagination),{},{isLoadingNext:!1})})}),D.t0;case 21:case"end":return D.stop()}},c,null,[[4,16]])}))),q(this,"notificationAddedToChannelHandler",function(){var c=pe(L.mark(function d(u){var h,p,g,f,m,v,b,w,x,j,S,_;return L.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(g=(h=u==null?void 0:u.channel)!==null&&h!==void 0?h:{},f=g.id,m=g.type,v=g.members,!(!m||!((p=r.options.allowNotLoadedChannelPromotionForEvent)!==null&&p!==void 0&&p["notification.added_to_channel"]))){N.next=3;break}return N.abrupt("return");case 3:return N.next=5,Tg({client:r.client,id:f,members:v==null?void 0:v.reduce(function(M,E){var P=E.user,D=E.user_id,T=D||(P==null?void 0:P.id);return T&&M.push(T),M},[]),type:m});case 5:if(b=N.sent,w=r.state.getLatestValue(),x=w.pagination,j=w.channels,j){N.next=9;break}return N.abrupt("return");case 9:S=x??{},_=S.sort,r.setChannels(np({channels:j,channelToMove:b,sort:_}));case 11:case"end":return N.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),q(this,"channelDeletedHandler",function(c){var d=r.state.getLatestValue(),u=d.channels;if(u){var h=Or(u),p=h.findIndex(function(g){var f;return g.cid===(c.cid||((f=c.channel)===null||f===void 0?void 0:f.cid))});p<0||(h.splice(p,1),r.setChannels(h))}}),q(this,"channelHiddenHandler",this.channelDeletedHandler),q(this,"newMessageHandler",function(c){var d,u=r.state.getLatestValue(),h=u.pagination,p=u.channels;if(p){var g=h??{},f=g.filters,m=g.sort,v=c.channel_type,b=c.channel_id;if(!(!v||!b)){var w=r.client.channel(v,b),x=p.indexOf(w),j=x>=0,S=Rm(w),_=tp(w),C=rp(f),N=$x(m);C&&_&&!f.archived||C&&!_&&f.archived||N&&S||r.options.lockChannelOrder||!j&&!((d=r.options.allowNotLoadedChannelPromotionForEvent)!==null&&d!==void 0&&d["message.new"])||r.setChannels(np({channels:p,channelToMove:w,channelToMoveIndexWithinChannels:x,sort:m}))}}}),q(this,"notificationNewMessageHandler",function(){var c=pe(L.mark(function d(u){var h,p,g,f,m,v,b,w,x,j,S,_,C,N;return L.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(g=(h=u==null?void 0:u.channel)!==null&&h!==void 0?h:{},f=g.id,m=g.type,!(!f||!m)){E.next=3;break}return E.abrupt("return");case 3:return E.next=5,Tg({client:r.client,id:f,type:m});case 5:if(v=E.sent,b=r.state.getLatestValue(),w=b.channels,x=b.pagination,j=x??{},S=j.filters,_=j.sort,C=rp(S),N=tp(v),!(!w||C&&N&&!S.archived||C&&!N&&S.archived||!((p=r.options.allowNotLoadedChannelPromotionForEvent)!==null&&p!==void 0&&p["notification.message_new"]))){E.next=12;break}return E.abrupt("return");case 12:r.setChannels(np({channels:w,channelToMove:v,sort:_}));case 13:case"end":return E.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),q(this,"channelVisibleHandler",function(){var c=pe(L.mark(function d(u){var h,p,g,f,m,v,b,w,x,j,S,_;return L.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(p=u.channel_type,g=u.channel_id,!(!p||!g)){N.next=3;break}return N.abrupt("return");case 3:return N.next=5,Tg({client:r.client,id:u.channel_id,type:u.channel_type});case 5:if(f=N.sent,m=r.state.getLatestValue(),v=m.channels,b=m.pagination,w=b??{},x=w.sort,j=w.filters,S=rp(j),_=tp(f),!(!v||S&&_&&!j.archived||S&&!_&&j.archived||!((h=r.options.allowNotLoadedChannelPromotionForEvent)!==null&&h!==void 0&&h["channel.visible"]))){N.next=12;break}return N.abrupt("return");case 12:r.setChannels(np({channels:v,channelToMove:f,sort:x}));case 13:case"end":return N.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),q(this,"notificationRemovedFromChannelHandler",this.channelDeletedHandler),q(this,"memberUpdatedHandler",function(c){var d,u=r.state.getLatestValue(),h=u.pagination,p=u.channels,g=h.filters,f=h.sort;if(!(!((d=c.member)!==null&&d!==void 0&&d.user)||c.member.user.id!==r.client.userID||!c.channel_type||!c.channel_id)){var m=c.channel_type,v=c.channel_id,b=$x(f),w=rp(g),x=hC({atIndex:0,sort:f,targetKey:"pinned_at"});if(!(!p||!b&&!w||r.options.lockChannelOrder)){var j=r.client.channel(m,v),S=p.indexOf(j),_=S>=0,C=Rm(j),N=tp(j),M=Or(p);if(_&&M.splice(S,1),w&&!N&&g!==null&&g!==void 0&&g.archived||w&&N&&!(g!=null&&g.archived)){r.setChannels(M);return}var E=null;(x===1||x===-1&&!C)&&(E=pC({channels:M}));var P=typeof E=="number"?E+1:0;p[P]!==j&&(M.splice(P,0,j),r.setChannels(M))}}}),q(this,"subscriptionOrOverride",function(c){var d=zj[c.type],u=r.eventHandlers.get(d),h=r.eventHandlerOverrides.get(d);if(h&&typeof h=="function"){h(r.setChannels,c);return}u&&typeof u=="function"&&u(c)}),q(this,"registerSubscriptions",function(){if(!r.unsubscribeFunctions.size)for(var c=0,d=Object.keys(zj);c<d.length;c++){var u=d[c];r.unsubscribeFunctions.add(r.client.on(u,r.subscriptionOrOverride).unsubscribe)}}),q(this,"unregisterSubscriptions",function(){r.unsubscribeFunctions.forEach(function(c){return c()}),r.unsubscribeFunctions.clear()}),this.client=s,this.state=new kh({channels:[],pagination:{isLoading:!1,isLoadingNext:!1,hasNext:!1,filters:{},sort:{},options:Dg},initialized:!1}),this.setEventHandlerOverrides(o),this.setOptions(l),this.eventHandlers=new Map(Object.entries({channelDeletedHandler:this.channelDeletedHandler,channelHiddenHandler:this.channelHiddenHandler,channelVisibleHandler:this.channelVisibleHandler,memberUpdatedHandler:this.memberUpdatedHandler,newMessageHandler:this.newMessageHandler,notificationAddedToChannelHandler:this.notificationAddedToChannelHandler,notificationNewMessageHandler:this.notificationNewMessageHandler,notificationRemovedFromChannelHandler:this.notificationRemovedFromChannelHandler}))},QF=["created_at","updated_at","last_active","online"],ZF=["params","headers"];function ap(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=eW(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,a=function(){};return{s:a,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,l;return{s:function(){r=r.call(n)},n:function(){var d=r.next();return o=d.done,d},e:function(d){i=!0,l=d},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(i)throw l}}}}function eW(n,t){if(n){if(typeof n=="string")return Fj(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fj(n,t)}}function Fj(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function Wj(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),r.push.apply(r,s)}return r}function Qe(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wj(Object(r),!0).forEach(function(s){q(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Wj(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function pc(n){return typeof n=="string"||n instanceof String}var Sf=function(){function n(t,r,s){var a=this,o;Vt(this,n),q(this,"_user",void 0),q(this,"activeChannels",void 0),q(this,"threads",void 0),q(this,"polls",void 0),q(this,"anonymous",void 0),q(this,"persistUserOnConnectionFailure",void 0),q(this,"axiosInstance",void 0),q(this,"baseURL",void 0),q(this,"browser",void 0),q(this,"cleaningIntervalRef",void 0),q(this,"clientID",void 0),q(this,"configs",void 0),q(this,"key",void 0),q(this,"listeners",void 0),q(this,"logger",void 0),q(this,"recoverStateOnReconnect",void 0),q(this,"moderation",void 0),q(this,"mutedChannels",void 0),q(this,"mutedUsers",void 0),q(this,"node",void 0),q(this,"options",void 0),q(this,"secret",void 0),q(this,"setUserPromise",void 0),q(this,"state",void 0),q(this,"tokenManager",void 0),q(this,"user",void 0),q(this,"userAgent",void 0),q(this,"userID",void 0),q(this,"wsBaseURL",void 0),q(this,"wsConnection",void 0),q(this,"wsFallback",void 0),q(this,"wsPromise",void 0),q(this,"consecutiveFailures",void 0),q(this,"insightMetrics",void 0),q(this,"defaultWSTimeoutWithFallback",void 0),q(this,"defaultWSTimeout",void 0),q(this,"sdkIdentifier",void 0),q(this,"deviceIdentifier",void 0),q(this,"nextRequestAbortController",null),q(this,"_getConnectionID",function(){var l,c;return((l=a.wsConnection)===null||l===void 0?void 0:l.connectionID)||((c=a.wsFallback)===null||c===void 0?void 0:c.connectionID)}),q(this,"_hasConnectionID",function(){return!!a._getConnectionID()}),q(this,"connectUser",function(){var l=pe(L.mark(function c(d,u){var h,p;return L.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(d.id){f.next=2;break}throw new Error('The "id" field on the user is missing');case 2:if(!(a.userID===d.id&&a.setUserPromise)){f.next=5;break}return console.warn("Consecutive calls to connectUser is detected, ideally you should only call this function once in your app."),f.abrupt("return",a.setUserPromise);case 5:if(!a.userID){f.next=7;break}throw new Error("Use client.disconnect() before trying to connect as a different user. connectUser was called twice.");case 7:return(a._isUsingServerAuth()||a.node)&&!a.options.allowServerSideConnect&&console.warn('Please do not use connectUser server side. connectUser impacts MAU and concurrent connection usage and thus your bill. If you have a valid use-case, add "allowServerSideConnect: true" to the client options to disable this warning.'),a.userID=d.id,a.anonymous=!1,h=a._setToken(d,u),a._setUser(d),p=a.openConnection(),a.setUserPromise=Promise.all([h,p]).then(function(m){return m[1]}),f.prev=14,f.next=17,a.setUserPromise;case 17:return f.abrupt("return",f.sent);case 20:throw f.prev=20,f.t0=f.catch(14),a.persistUserOnConnectionFailure?a.closeConnection():a.disconnectUser(),f.t0;case 24:case"end":return f.stop()}},c,null,[[14,20]])}));return function(c,d){return l.apply(this,arguments)}}()),q(this,"setUser",this.connectUser),q(this,"_setToken",function(l,c){return a.tokenManager.setTokenOrProvider(c,l)}),q(this,"closeConnection",function(){var l=pe(L.mark(function c(d){var u,h;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a.cleaningIntervalRef!=null&&(clearInterval(a.cleaningIntervalRef),a.cleaningIntervalRef=void 0),g.next=3,Promise.all([(u=a.wsConnection)===null||u===void 0?void 0:u.disconnect(d),(h=a.wsFallback)===null||h===void 0?void 0:h.disconnect(d)]);case 3:return g.abrupt("return",Promise.resolve());case 4:case"end":return g.stop()}},c)}));return function(c){return l.apply(this,arguments)}}()),q(this,"createChannelManager",function(l){var c=l.eventHandlerOverrides,d=c===void 0?{}:c,u=l.options,h=u===void 0?{}:u;return new XF({client:a,eventHandlerOverrides:d,options:h})}),q(this,"openConnection",pe(L.mark(function l(){var c,d,u;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(a.userID){p.next=2;break}throw Error("User is not set on client, use client.connectUser or client.connectAnonymousUser instead");case 2:if(!((c=a.wsConnection)!==null&&c!==void 0&&c.isConnecting&&a.wsPromise)){p.next=5;break}return a.logger("info","client:openConnection() - connection already in progress",{tags:["connection","client"]}),p.abrupt("return",a.wsPromise);case 5:if(!(((d=a.wsConnection)!==null&&d!==void 0&&d.isHealthy||(u=a.wsFallback)!==null&&u!==void 0&&u.isHealthy())&&a._hasConnectionID())){p.next=8;break}return a.logger("info","client:openConnection() - openConnection called twice, healthy connection already exists",{tags:["connection","client"]}),p.abrupt("return");case 8:return a.clientID="".concat(a.userID,"--").concat(Uc()),a.wsPromise=a.connect(),a._startCleaning(),p.abrupt("return",a.wsPromise);case 12:case"end":return p.stop()}},l)}))),q(this,"_setupConnection",this.openConnection),q(this,"_normalizeDate",function(l){if(l instanceof Date&&(l=l.toISOString()),l==="")throw new Error("Don't pass blank string for since, use null instead if resetting the token revoke");return l}),q(this,"disconnectUser",function(){var l=pe(L.mark(function c(d){var u,h,p,g;return L.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:for(a.logger("info","client:disconnect() - Disconnecting the client",{tags:["connection","client"]}),delete a.user,delete a._user,delete a.userID,a.anonymous=!1,u=a.closeConnection(d),h=0,p=Object.values(a.activeChannels);h<p.length;h++)g=p[h],g._disconnect();return a.activeChannels={},a.state=new mj({client:a}),a.threads.resetState(),setTimeout(a.tokenManager.reset),m.abrupt("return",u);case 12:case"end":return m.stop()}},c)}));return function(c){return l.apply(this,arguments)}}()),q(this,"disconnect",this.disconnectUser),q(this,"connectAnonymousUser",function(){(a._isUsingServerAuth()||a.node)&&!a.options.allowServerSideConnect&&console.warn('Please do not use connectUser server side. connectUser impacts MAU and concurrent connection usage and thus your bill. If you have a valid use-case, add "allowServerSideConnect: true" to the client options to disable this warning.'),a.anonymous=!0,a.userID=Uc();var l={id:a.userID,anon:!0};return a._setToken(l,""),a._setUser(l),a._setupConnection()}),q(this,"setAnonymousUser",this.connectAnonymousUser),q(this,"doAxiosRequest",function(){var l=pe(L.mark(function c(d,u,h){var p,g,f,m,v=arguments;return L.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return p=v.length>3&&v[3]!==void 0?v[3]:{},w.next=3,a.tokenManager.tokenReady();case 3:g=a._enrichAxiosOptions(p),w.prev=4,a._logApiRequest(d,u,h,g),w.t0=d,w.next=w.t0==="get"?9:w.t0==="delete"?13:w.t0==="post"?17:w.t0==="postForm"?21:w.t0==="put"?25:w.t0==="patch"?29:w.t0==="options"?33:37;break;case 9:return w.next=11,a.axiosInstance.get(u,g);case 11:return f=w.sent,w.abrupt("break",38);case 13:return w.next=15,a.axiosInstance.delete(u,g);case 15:return f=w.sent,w.abrupt("break",38);case 17:return w.next=19,a.axiosInstance.post(u,h,g);case 19:return f=w.sent,w.abrupt("break",38);case 21:return w.next=23,a.axiosInstance.postForm(u,h,g);case 23:return f=w.sent,w.abrupt("break",38);case 25:return w.next=27,a.axiosInstance.put(u,h,g);case 27:return f=w.sent,w.abrupt("break",38);case 29:return w.next=31,a.axiosInstance.patch(u,h,g);case 31:return f=w.sent,w.abrupt("break",38);case 33:return w.next=35,a.axiosInstance.options(u,g);case 35:return f=w.sent,w.abrupt("break",38);case 37:throw new Error("Invalid request type");case 38:return a._logApiResponse(d,u,f),a.consecutiveFailures=0,w.abrupt("return",a.handleResponse(f));case 43:if(w.prev=43,w.t1=w.catch(4),w.t1.client_request_id=(m=g.headers)===null||m===void 0?void 0:m["x-client-request-id"],a._logApiError(d,u,w.t1),a.consecutiveFailures+=1,!w.t1.response){w.next=60;break}if(!(w.t1.response.data.code===su.TOKEN_EXPIRED&&!a.tokenManager.isStatic())){w.next=57;break}if(!(a.consecutiveFailures>1)){w.next=53;break}return w.next=53,Ml(Em(a.consecutiveFailures));case 53:return a.tokenManager.loadToken(),w.next=56,a.doAxiosRequest(d,u,h,p);case 56:return w.abrupt("return",w.sent);case 57:return w.abrupt("return",a.handleResponse(w.t1.response));case 60:throw w.t1;case 61:case"end":return w.stop()}},c,null,[[4,43]])}));return function(c,d,u){return l.apply(this,arguments)}}()),q(this,"dispatchEvent",function(l){l.received_at||(l.received_at=new Date);var c=a._handleClientEvent(l),d=l.cid,u=d?a.activeChannels[d]:void 0;u&&u._handleChannelEvent(l),a._callClientListeners(l),u&&u._callChannelListeners(l),c.forEach(function(h){return h()})}),q(this,"handleEvent",function(l){var c=l.data,d=JSON.parse(c);a.dispatchEvent(d)}),q(this,"_updateMemberWatcherReferences",function(l){var c=a.state.userChannelReferences[l.id]||{};for(var d in c){var u=a.activeChannels[d];u!=null&&u.state&&(u.state.members[l.id]&&(u.state.members[l.id].user=l),u.state.watchers[l.id]&&(u.state.watchers[l.id]=l),u.state.read[l.id]&&(u.state.read[l.id].user=l))}}),q(this,"_updateUserReferences",this._updateMemberWatcherReferences),q(this,"_updateUserMessageReferences",function(l){var c=a.state.userChannelReferences[l.id]||{};for(var d in c){var u=a.activeChannels[d];if(u){var h=u.state;h==null||h.updateUserMessages(l)}}}),q(this,"_deleteUserMessageReference",function(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,d=a.state.userChannelReferences[l.id]||{};for(var u in d){var h=a.activeChannels[u];if(h){var p=h.state;p==null||p.deleteUserMessages(l,c)}}}),q(this,"_handleUserEvent",function(l){if(l.user){if(l.type==="user.presence.changed"||l.type==="user.updated"){if(l.user.id===a.userID){var c=Qe({},a.user||{}),d=Qe({},a._user||{});for(var u in a.user)u in l.user||$z(u)||(delete c[u],delete d[u]);for(var h in l.user)d&&h in d&&(d[h]=l.user[h]);a._user=Qe({},d),a.user=Qe(Qe({},c),l.user)}a.state.updateUser(l.user),a._updateMemberWatcherReferences(l.user)}l.type==="user.updated"&&a._updateUserMessageReferences(l.user),l.type==="user.deleted"&&l.user.deleted_at&&(l.mark_messages_deleted||l.hard_delete)&&a._deleteUserMessageReference(l.user,l.hard_delete)}}),q(this,"_callClientListeners",function(l){var c=a,d=[];c.listeners.all&&d.push.apply(d,Or(c.listeners.all)),c.listeners[l.type]&&d.push.apply(d,Or(c.listeners[l.type]));for(var u=0,h=d;u<h.length;u++){var p=h[u];p(l)}}),q(this,"recoverState",pe(L.mark(function l(){var c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a.logger("info","client:recoverState() - Start of recoverState with connectionID ".concat(a._getConnectionID()),{tags:["connection"]}),c=Object.keys(a.activeChannels),!(c.length&&a.recoverStateOnReconnect)){u.next=10;break}return a.logger("info","client:recoverState() - Start the querying of ".concat(c.length," channels"),{tags:["connection","client"]}),u.next=6,a.queryChannels({cid:{$in:c}},{last_message_at:-1},{limit:30});case 6:a.logger("info","client:recoverState() - Querying channels finished",{tags:["connection","client"]}),a.dispatchEvent({type:"connection.recovered"}),u.next=11;break;case 10:a.dispatchEvent({type:"connection.recovered"});case 11:a.wsPromise=Promise.resolve(),a.setUserPromise=Promise.resolve();case 13:case"end":return u.stop()}},l)}))),q(this,"getChannelByMembers",function(l,c){var d,u=((d=c.members)!==null&&d!==void 0?d:[]).map(function(b){var w;return typeof b=="string"?b:(w=b.user_id)!==null&&w!==void 0?w:""}),h=u.sort().join(","),p=$b(l,u);if(!p)throw Error("Please specify atleast one member when creating unique conversation");for(var g in a.activeChannels){var f=a.activeChannels[g];if(!f.disconnected){if(g===p)return f;if(g.indexOf("".concat(l,":!members-"))===0){var m=Object.keys(f.state.members).sort().join(",");if(m===h)return f}}}var v=new Rg(a,l,void 0,c);return a._cacheEnabled()&&(a.activeChannels[p]=v),v}),q(this,"getChannelById",function(l,c,d){if(typeof c=="string"&&~c.indexOf(":"))throw Error("Invalid channel id ".concat(c,", can't contain the : character"));var u="".concat(l,":").concat(c);if(u in a.activeChannels&&a.activeChannels[u]&&!a.activeChannels[u].disconnected){var h=a.activeChannels[u];return Object.keys(d).length>0&&(h.data=Qe(Qe({},h.data),d),h._data=Qe(Qe({},h._data),d)),h}var p=new Rg(a,l,c,d);return a._cacheEnabled()&&(a.activeChannels[p.cid]=p),p}),q(this,"updateUsers",this.upsertUsers),q(this,"updateUser",this.upsertUser),q(this,"_unblockMessage",this.unblockMessage),q(this,"markAllRead",this.markChannelsRead),q(this,"_isUsingServerAuth",function(){return!!a.secret}),q(this,"_cacheEnabled",function(){return!a._isUsingServerAuth()||!a.options.disableCache}),q(this,"_buildWSPayload",function(l){return JSON.stringify({user_id:a.userID,user_details:a._user,device:a.options.device,client_request_id:l})}),this.key=t,this.listeners={},this.state=new mj({client:this}),this.mutedChannels=[],this.mutedUsers=[],this.moderation=new MF(this),r&&pc(r)&&(this.secret=r);var i=s||(r&&!pc(r)?r:{});this.browser=typeof i.browser<"u"?i.browser:typeof window<"u",this.node=!this.browser,this.options=Qe({timeout:3e3,withCredentials:!1,warmUp:!1,recoverStateOnReconnect:!0,disableCache:!1,wsUrlParams:new URLSearchParams({})},i),this.node&&!this.options.httpsAgent&&(this.options.httpsAgent=new Pz.Agent({keepAlive:!0,keepAliveMsecs:3e3})),this.axiosInstance=Pm.create(this.options),this.setBaseURL(this.options.baseURL||"https://chat.stream-io-api.com"),typeof process<"u"&&"env"in process&&{}.STREAM_LOCAL_TEST_RUN&&this.setBaseURL("http://localhost:3030"),typeof process<"u"&&"env"in process&&{}.STREAM_LOCAL_TEST_HOST&&this.setBaseURL("http://"+{}.STREAM_LOCAL_TEST_HOST),this.wsConnection=null,this.wsPromise=null,this.setUserPromise=null,this.activeChannels={},this.configs={},this.anonymous=!1,this.persistUserOnConnectionFailure=(o=this.options)===null||o===void 0?void 0:o.persistUserOnConnectionFailure,this.tokenManager=new xF(this.secret),this.consecutiveFailures=0,this.insightMetrics=new aF,this.defaultWSTimeoutWithFallback=6*1e3,this.defaultWSTimeout=15*1e3,this.axiosInstance.defaults.paramsSerializer=qz,this.logger=Dx(i.logger)?i.logger:function(){return null},this.recoverStateOnReconnect=this.options.recoverStateOnReconnect,this.threads=new LF({client:this}),this.polls=new KF({client:this})}return sr(n,[{key:"devToken",value:function(r){return fF(r)}},{key:"getAuthType",value:function(){return this.anonymous?"anonymous":"jwt"}},{key:"setBaseURL",value:function(r){this.baseURL=r,this.wsBaseURL=this.baseURL.replace("http","ws").replace(":3030",":8800")}},{key:"_setUser",value:function(r){this.user=r,this.userID=r.id,this._user=Qe({},r)}},{key:"updateAppSettings",value:function(){var t=pe(L.mark(function s(a){var o;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o=a.apn_config,o!=null&&o.p12_cert&&(a=Qe(Qe({},a),{},{apn_config:Qe(Qe({},o),{},{p12_cert:Buffer.from(o.p12_cert).toString("base64")})})),l.next=4,this.patch(this.baseURL+"/app",a);case 4:return l.abrupt("return",l.sent);case 5:case"end":return l.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"revokeTokens",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.updateAppSettings({revoke_tokens_issued_before:this._normalizeDate(a)});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"revokeUserToken",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.revokeUsersToken([a],o);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"revokeUsersToken",value:function(){var t=pe(L.mark(function s(a,o){var i,l,c,d;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:o===void 0?o=new Date().toISOString():o=this._normalizeDate(o),i=[],l=ap(a);try{for(l.s();!(c=l.n()).done;)d=c.value,i.push({id:d,set:{revoke_tokens_issued_before:o}})}catch(p){l.e(p)}finally{l.f()}return h.next=6,this.partialUpdateUsers(i);case 6:return h.abrupt("return",h.sent);case 7:case"end":return h.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getAppSettings",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.get(this.baseURL+"/app");case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"testPushSettings",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/check_push",Qe(Qe(Qe(Qe(Qe(Qe(Qe({user_id:a},o.messageID?{message_id:o.messageID}:{}),o.apnTemplate?{apn_template:o.apnTemplate}:{}),o.firebaseTemplate?{firebase_template:o.firebaseTemplate}:{}),o.firebaseDataTemplate?{firebase_data_template:o.firebaseDataTemplate}:{}),o.skipDevices?{skip_devices:!0}:{}),o.pushProviderName?{push_provider_name:o.pushProviderName}:{}),o.pushProviderType?{push_provider_type:o.pushProviderType}:{}));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"testSQSSettings",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.post(this.baseURL+"/check_sqs",a);case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"testSNSSettings",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.post(this.baseURL+"/check_sns",a);case 3:return l.abrupt("return",l.sent);case 4:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"setGuestUser",value:function(){var t=pe(L.mark(function s(a){var o,i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.anonymous=!0,d.prev=1,d.next=4,this.post(this.baseURL+"/guest",{user:a});case 4:o=d.sent,d.next=11;break;case 7:throw d.prev=7,d.t0=d.catch(1),this.anonymous=!1,d.t0;case 11:return this.anonymous=!1,i=o.user,i.created_at,i.updated_at,i.last_active,i.online,l=oh(i,QF),d.next=15,this.connectUser(l,o.access_token);case 15:return d.abrupt("return",d.sent);case 16:case"end":return d.stop()}},s,this,[[1,7]])}));function r(s){return t.apply(this,arguments)}return r}()},{key:"createToken",value:function(r,s,a){if(this.secret==null)throw Error("tokens can only be created server-side using the API Secret");var o={};return s&&(o.exp=s),a&&(o.iat=a),fC(this.secret,r,o,{})}},{key:"on",value:function(r,s){var a=this,o=s?r:"all",i=s||r;return o in this.listeners||(this.listeners[o]=[]),this.logger("info","Attaching listener for ".concat(o," event"),{tags:["event","client"]}),this.listeners[o].push(i),{unsubscribe:function(){a.logger("info","Removing listener for ".concat(o," event"),{tags:["event","client"]}),a.listeners[o]=a.listeners[o].filter(function(c){return c!==i})}}}},{key:"off",value:function(r,s){var a=s?r:"all",o=s||r;a in this.listeners||(this.listeners[a]=[]),this.logger("info","Removing listener for ".concat(a," event"),{tags:["event","client"]}),this.listeners[a]=this.listeners[a].filter(function(i){return i!==o})}},{key:"_logApiRequest",value:function(r,s,a,o){this.logger("info","client: ".concat(r," - Request - ").concat(s),{tags:["api","api_request","client"],url:s,payload:a,config:o})}},{key:"_logApiResponse",value:function(r,s,a){this.logger("info","client:".concat(r," - Response - url: ").concat(s," > status ").concat(a.status),{tags:["api","api_response","client"],url:s,response:a})}},{key:"_logApiError",value:function(r,s,a){this.logger("error","client:".concat(r," - Error - url: ").concat(s),{tags:["api","api_response","client"],url:s,error:a})}},{key:"get",value:function(r,s){return this.doAxiosRequest("get",r,null,{params:s})}},{key:"put",value:function(r,s){return this.doAxiosRequest("put",r,s)}},{key:"post",value:function(r,s){return this.doAxiosRequest("post",r,s)}},{key:"patch",value:function(r,s){return this.doAxiosRequest("patch",r,s)}},{key:"delete",value:function(r,s){return this.doAxiosRequest("delete",r,null,{params:s})}},{key:"sendFile",value:function(r,s,a,o,i){var l=Lz(s,a,o||"multipart/form-data");return i!=null&&l.append("user",JSON.stringify(i)),this.doAxiosRequest("postForm",r,l,{headers:l.getHeaders?l.getHeaders():{},config:{timeout:0,maxContentLength:1/0,maxBodyLength:1/0}})}},{key:"errorFromResponse",value:function(r){var s;return s=new CF("StreamChat error HTTP code: ".concat(r.status)),r.data&&r.data.code&&(s=new Error("StreamChat error code ".concat(r.data.code,": ").concat(r.data.message)),s.code=r.data.code),s.response=r,s.status=r.status,s}},{key:"handleResponse",value:function(r){var s=r.data;if(jF(r))throw this.errorFromResponse(r);return s}},{key:"_handleClientEvent",value:function(r){var s,a,o=this,i=this,l=[];if(this.logger("info","client:_handleClientEvent - Received event of type { ".concat(r.type," }"),{tags:["event","client"],event:r}),(r.type==="user.presence.changed"||r.type==="user.updated"||r.type==="user.deleted")&&this._handleUserEvent(r),r.type==="health.check"&&r.me&&(i.user=r.me,i.state.updateUser(r.me),i.mutedChannels=r.me.channel_mutes,i.mutedUsers=r.me.mutes),r.channel&&r.type==="notification.message_new"&&this._addChannelConfig(r.channel),r.type==="notification.channel_mutes_updated"&&(s=r.me)!==null&&s!==void 0&&s.channel_mutes&&(this.mutedChannels=r.me.channel_mutes),r.type==="notification.mutes_updated"&&(a=r.me)!==null&&a!==void 0&&a.mutes&&(this.mutedUsers=r.me.mutes),r.type==="notification.mark_read"&&r.unread_channels===0){var c=Object.keys(this.activeChannels);c.forEach(function(u){return o.activeChannels[u].state.unreadCount=0})}if((r.type==="channel.deleted"||r.type==="notification.channel_deleted")&&r.cid){var d;i.state.deleteAllChannelReference(r.cid),(d=this.activeChannels[r.cid])===null||d===void 0||d._disconnect(),l.push(function(){r.cid&&delete o.activeChannels[r.cid]})}return l}},{key:"_muteStatus",value:function(r){for(var s,a=0;a<this.mutedChannels.length;a++){var o,i=this.mutedChannels[a];if(((o=i.channel)===null||o===void 0?void 0:o.cid)===r){s={muted:i.expires?new Date(i.expires).getTime()>new Date().getTime():!0,createdAt:i.created_at?new Date(i.created_at):new Date,expiresAt:i.expires?new Date(i.expires):null};break}}return s||{muted:!1,createdAt:null,expiresAt:null}}},{key:"connect",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(!this.userID||!this._user)){o.next=2;break}throw Error("Call connectUser or connectAnonymousUser before starting the connection");case 2:if(this.wsBaseURL){o.next=4;break}throw Error("Websocket base url not set");case 4:if(this.clientID){o.next=6;break}throw Error("clientID is not set");case 6:if(!this.wsConnection&&(this.options.warmUp||this.options.enableInsights)&&this._sayHi(),this.options.wsConnection&&this.node?(this.options.wsConnection.setClient(this),this.wsConnection=this.options.wsConnection):this.wsConnection=new uF({client:this}),o.prev=8,!this.wsFallback){o.next=13;break}return o.next=12,this.wsFallback.connect();case 12:return o.abrupt("return",o.sent);case 13:return o.next=15,this.wsConnection.connect(this.options.enableWSFallback?this.defaultWSTimeoutWithFallback:this.defaultWSTimeout);case 15:return o.abrupt("return",o.sent);case 18:if(o.prev=18,o.t0=o.catch(8),!(this.options.enableWSFallback&&wF(o.t0)&&Uz())){o.next=29;break}return this.logger("info","client:connect() - WS failed, fallback to longpoll",{tags:["connection","client"]}),this.dispatchEvent({type:"transport.changed",mode:"longpoll"}),this.wsConnection._destroyCurrentWSConnection(),this.wsConnection.disconnect().then(),this.wsFallback=new SF({client:this}),o.next=28,this.wsFallback.connect();case 28:return o.abrupt("return",o.sent);case 29:throw o.t0;case 30:case"end":return o.stop()}},s,this,[[8,18]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"_sayHi",value:function(){var r=this,s=Uc(),a={headers:{"x-client-request-id":s}};this.doAxiosRequest("get",this.baseURL+"/hi",null,a).catch(function(o){r.options.enableInsights&&au("http_hi_failed",{api_key:r.key,err:o,client_request_id:s})})}},{key:"queryUsers",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=d.length>1&&d[1]!==void 0?d[1]:[],i=d.length>2&&d[2]!==void 0?d[2]:{},l={presence:!1},h.next=5,this.wsPromise;case 5:return this._hasConnectionID()||(l.presence=!1),h.next=8,this.get(this.baseURL+"/users",{payload:Qe(Qe({filter_conditions:a,sort:ys(o)},l),i)});case 8:return c=h.sent,this.state.updateUsers(c.users),h.abrupt("return",c);case 11:case"end":return h.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryBannedUsers",value:function(){var t=pe(L.mark(function s(){var a,o,i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=l.length>0&&l[0]!==void 0?l[0]:{},o=l.length>1&&l[1]!==void 0?l[1]:[],i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=5,this.get(this.baseURL+"/query_banned_users",{payload:Qe({filter_conditions:a,sort:ys(o)},i)});case 5:return d.abrupt("return",d.sent);case 6:case"end":return d.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"queryMessageFlags",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=4,this.get(this.baseURL+"/moderation/flags/message",{payload:Qe({filter_conditions:a},o)});case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"queryChannels",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u,h=arguments;return L.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return o=h.length>1&&h[1]!==void 0?h[1]:[],i=h.length>2&&h[2]!==void 0?h[2]:{},l=h.length>3&&h[3]!==void 0?h[3]:{},c={state:!0,watch:!0,presence:!1},g.next=6,this.wsPromise;case 6:return this._hasConnectionID()||(c.watch=!1),d=Qe(Qe({filter_conditions:a,sort:ys(o)},c),i),g.next=10,this.post(this.baseURL+"/channels",d);case 10:return u=g.sent,this.dispatchEvent({type:"channels.queried",queriedChannels:{channels:u.channels,isLatestMessageSet:!0}}),g.abrupt("return",this.hydrateActiveChannels(u.channels,l,i));case 13:case"end":return g.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryReactions",value:function(){var t=pe(L.mark(function s(a,o){var i,l,c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return i=d.length>2&&d[2]!==void 0?d[2]:[],l=d.length>3&&d[3]!==void 0?d[3]:{},h.next=4,this.wsPromise;case 4:return c=Qe({filter:o,sort:ys(i)},l),h.next=7,this.post(this.baseURL+"/messages/"+encodeURIComponent(a)+"/reactions",c);case 7:return h.abrupt("return",h.sent);case 8:case"end":return h.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"hydrateActiveChannels",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=s.skipInitialization,i=s.offlineMode,l=i===void 0?!1:i,c=[],d=ap(r),u;try{for(d.s();!(u=d.n()).done;){var h=u.value;this._addChannelConfig(h.channel);var p=this.channel(h.channel.type,h.channel.id);p.data=h.channel,p.offlineMode=l,p.initialized=!l,p.push_preferences=h.push_preferences;var g=void 0;if(o===void 0){var f=p._initializeState(h,"latest"),m=f.messageSet;g=m}else if(!o.includes(h.channel.id)){p.state.clearMessages();var v=p._initializeState(h,"latest"),b=v.messageSet;g=b}g&&(g.pagination=Qe(Qe({},g.pagination),uC({parentSet:g,requestedPageSize:(a==null?void 0:a.message_limit)||Zz,returnedPage:h.messages,logger:this.logger})),this.polls.hydratePollCache(h.messages,!0)),c.push(p)}}catch(w){d.e(w)}finally{d.f()}return c}},{key:"search",value:function(){var t=pe(L.mark(function s(a,o){var i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(i=c.length>2&&c[2]!==void 0?c[2]:{},!(i.offset&&i.next)){u.next=3;break}throw Error("Cannot specify offset with next");case 3:if(l=Qe(Qe({filter_conditions:a},i),{},{sort:i.sort?ys(i.sort):void 0}),typeof o!="string"){u.next=8;break}l.query=o,u.next=13;break;case 8:if(_n(o)!=="object"){u.next=12;break}l.message_filter_conditions=o,u.next=13;break;case 12:throw Error("Invalid type ".concat(_n(o)," for query parameter"));case 13:return u.next=15,this.wsPromise;case 15:return u.next=17,this.get(this.baseURL+"/search",{payload:l});case 17:return u.abrupt("return",u.sent);case 18:case"end":return u.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"setLocalDevice",value:function(r){var s,a,o;if((s=this.wsConnection)!==null&&s!==void 0&&s.isConnecting&&this.wsPromise||((a=this.wsConnection)!==null&&a!==void 0&&a.isHealthy||(o=this.wsFallback)!==null&&o!==void 0&&o.isHealthy())&&this._hasConnectionID())throw new Error("you can only set device before opening a websocket connection");this.options.device=r}},{key:"addDevice",value:function(){var t=pe(L.mark(function s(a,o,i,l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.post(this.baseURL+"/devices",Qe(Qe({id:a,push_provider:o},i!=null?{user_id:i}:{}),l!=null?{push_provider_name:l}:{}));case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"getDevices",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get(this.baseURL+"/devices",a?{user_id:a}:{});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getUnreadCount",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get(this.baseURL+"/unread",a?{user_id:a}:{});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getUnreadCountBatch",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/unread_batch",{user_ids:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"setPushPreferences",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/push_preferences",{preferences:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"removeDevice",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.delete(this.baseURL+"/devices",Qe({id:a},o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getRateLimits",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=a||{},i=o.serverSide,l=o.web,c=o.android,d=o.ios,u=o.endpoints,p.abrupt("return",this.get(this.baseURL+"/rate_limits",{server_side:i,web:l,android:c,ios:d,endpoints:u?u.join(","):void 0}));case 2:case"end":return p.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_addChannelConfig",value:function(r){var s=r.cid,a=r.config;this._cacheEnabled()&&(this.configs[s]=a)}},{key:"channel",value:function(r,s){var a,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.userID&&!this._isUsingServerAuth())throw Error("Call connectUser or connectAnonymousUser before creating a channel");if(~r.indexOf(":"))throw Error("Invalid channel group ".concat(r,", can't contain the : character"));return s&&_n(s)==="object"?this.getChannelByMembers(r,s):!s&&_n(o)==="object"&&(a=o.members)!==null&&a!==void 0&&a.length?this.getChannelByMembers(r,o):s?this.getChannelById(r,s,o):new Rg(this,r,void 0,o)}},{key:"partialUpdateUser",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.partialUpdateUsers([a]);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"upsertUsers",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o={},i=ap(a),u.prev=2,i.s();case 4:if((l=i.n()).done){u.next=11;break}if(c=l.value,c.id){u.next=8;break}throw Error("User ID is required when updating a user");case 8:o[c.id]=c;case 9:u.next=4;break;case 11:u.next=16;break;case 13:u.prev=13,u.t0=u.catch(2),i.e(u.t0);case 16:return u.prev=16,i.f(),u.finish(16);case 19:return u.next=21,this.post(this.baseURL+"/users",{users:o});case 21:return u.abrupt("return",u.sent);case 22:case"end":return u.stop()}},s,this,[[2,13,16,19]])}));function r(s){return t.apply(this,arguments)}return r}()},{key:"upsertUser",value:function(r){return this.upsertUsers([r])}},{key:"partialUpdateUsers",value:function(){var t=pe(L.mark(function s(a){var o,i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=ap(a),d.prev=1,o.s();case 3:if((i=o.n()).done){d.next=9;break}if(l=i.value,l.id){d.next=7;break}throw Error("User ID is required when updating a user");case 7:d.next=3;break;case 9:d.next=14;break;case 11:d.prev=11,d.t0=d.catch(1),o.e(d.t0);case 14:return d.prev=14,o.f(),d.finish(14);case 17:return d.next=19,this.patch(this.baseURL+"/users",{users:a});case 19:return d.abrupt("return",d.sent);case 20:case"end":return d.stop()}},s,this,[[1,11,14,17]])}));function r(s){return t.apply(this,arguments)}return r}()},{key:"deleteUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.delete(this.baseURL+"/users/".concat(encodeURIComponent(a)),o);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"restoreUsers",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/users/restore",{user_ids:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"reactivateUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/".concat(encodeURIComponent(a),"/reactivate"),Qe({},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"reactivateUsers",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/reactivate",Qe({user_ids:a},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"deactivateUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/".concat(encodeURIComponent(a),"/deactivate"),Qe({},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"deactivateUsers",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/deactivate",Qe({user_ids:a},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"exportUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.get(this.baseURL+"/users/".concat(encodeURIComponent(a),"/export"),Qe({},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"banUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/moderation/ban",Qe({target_user_id:a},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"unbanUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.delete(this.baseURL+"/moderation/ban",Qe({target_user_id:a},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"shadowBan",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.banUser(a,Qe({shadow:!0},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"removeShadowBan",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.unbanUser(a,Qe({shadow:!0},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"blockUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/block",Qe({blocked_user_id:a},o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getBlockedUsers",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get(this.baseURL+"/users/block",Qe({},a?{user_id:a}:{}));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"unBlockUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/users/unblock",Qe({blocked_user_id:a},o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"muteUser",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.post(this.baseURL+"/moderation/mute",Qe(Qe({target_id:a},o?{user_id:o}:{}),i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"unmuteUser",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/moderation/unmute",Qe({target_id:a},o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"userMuteStatus",value:function(r){if(!this.user||!this.wsPromise)throw new Error("Make sure to await connectUser() first.");for(var s=0;s<this.mutedUsers.length;s+=1)if(this.mutedUsers[s].target.id===r)return!0;return!1}},{key:"flagMessage",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/moderation/flag",Qe({target_message_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"flagUser",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/moderation/flag",Qe({target_user_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"unflagMessage",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/moderation/unflag",Qe({target_message_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"unflagUser",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/moderation/unflag",Qe({target_user_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getCallToken",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/calls/".concat(encodeURIComponent(a)),Qe({},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_queryFlags",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=4,this.post(this.baseURL+"/moderation/flags",Qe({filter_conditions:a},o));case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"_queryFlagReports",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=4,this.post(this.baseURL+"/moderation/reports",Qe({filter_conditions:a},o));case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"_reviewFlagReport",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.patch(this.baseURL+"/moderation/reports/".concat(encodeURIComponent(a)),Qe({review_result:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"unblockMessage",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/moderation/unblock_message",Qe({target_message_id:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"markChannelsRead",value:function(){var t=pe(L.mark(function s(){var a,o=arguments;return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>0&&o[0]!==void 0?o[0]:{},l.next=3,this.post(this.baseURL+"/channels/read",Qe({},a));case 3:case"end":return l.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"createCommand",value:function(r){return this.post(this.baseURL+"/commands",r)}},{key:"getCommand",value:function(r){return this.get(this.baseURL+"/commands/".concat(encodeURIComponent(r)))}},{key:"updateCommand",value:function(r,s){return this.put(this.baseURL+"/commands/".concat(encodeURIComponent(r)),s)}},{key:"deleteCommand",value:function(r){return this.delete(this.baseURL+"/commands/".concat(encodeURIComponent(r)))}},{key:"listCommands",value:function(){return this.get(this.baseURL+"/commands")}},{key:"createChannelType",value:function(r){var s=ah({},{commands:["all"]},r);return this.post(this.baseURL+"/channeltypes",s)}},{key:"getChannelType",value:function(r){return this.get(this.baseURL+"/channeltypes/".concat(encodeURIComponent(r)))}},{key:"updateChannelType",value:function(r,s){return this.put(this.baseURL+"/channeltypes/".concat(encodeURIComponent(r)),s)}},{key:"deleteChannelType",value:function(r){return this.delete(this.baseURL+"/channeltypes/".concat(encodeURIComponent(r)))}},{key:"listChannelTypes",value:function(){return this.get(this.baseURL+"/channeltypes")}},{key:"translateMessage",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/messages/".concat(encodeURIComponent(a),"/translate"),{language:o});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"translate",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.post(this.baseURL+"/translate",{text:a,source_language:i,destination_language:o});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"_normalizeExpiration",value:function(r){var s=null;if(typeof r=="number"){var a=new Date;a.setSeconds(a.getSeconds()+r),s=a.toISOString()}else pc(r)?s=r:r instanceof Date&&(s=r.toISOString());return s}},{key:"_validateAndGetMessageId",value:function(r,s){var a;if(typeof r=="string")a=r;else{if(!r.id)throw Error(s);a=r.id}return a}},{key:"pinMessage",value:function(r,s,a,o){var i=this._validateAndGetMessageId(r,"Please specify the message id when calling unpinMessage");return this.partialUpdateMessage(i,{set:{pinned:!0,pin_expires:this._normalizeExpiration(s),pinned_at:this._normalizeExpiration(o)}},a)}},{key:"unpinMessage",value:function(r,s){var a=this._validateAndGetMessageId(r,"Please specify the message id when calling unpinMessage");return this.partialUpdateMessage(a,{set:{pinned:!1}},s)}},{key:"updateMessage",value:function(){var t=pe(L.mark(function s(a,o,i){var l,c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a.id){u.next=2;break}throw Error("Please specify the message id when calling updateMessage");case 2:return l=ah({},a),delete l.id,c=["command","created_at","html","latest_reactions","own_reactions","quoted_message","reaction_counts","reply_count","type","updated_at","user","pinned_at","__html"],c.forEach(function(h){l[h]!=null&&delete l[h]}),o!=null&&(pc(o)?l.user_id=o:l.user={id:o.id}),Array.isArray(l.mentioned_users)&&!pc(l.mentioned_users[0])&&(l.mentioned_users=l.mentioned_users.map(function(h){return h.id})),u.next=10,this.post(this.baseURL+"/messages/".concat(encodeURIComponent(a.id)),Qe({message:l},i));case 10:return u.abrupt("return",u.sent);case 11:case"end":return u.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"partialUpdateMessage",value:function(){var t=pe(L.mark(function s(a,o,i,l){var c;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a){u.next=2;break}throw Error("Please specify the message id when calling partialUpdateMessage");case 2:return c=i,i!=null&&pc(i)&&(c={id:i}),u.next=6,this.put(this.baseURL+"/messages/".concat(encodeURIComponent(a)),Qe(Qe(Qe({},o),l),{},{user:c}));case 6:return u.abrupt("return",u.sent);case 7:case"end":return u.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"deleteMessage",value:function(){var t=pe(L.mark(function s(a,o){var i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i={},o&&(i={hard:!0}),c.next=4,this.delete(this.baseURL+"/messages/".concat(encodeURIComponent(a)),i);case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"undeleteMessage",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/messages/".concat(encodeURIComponent(a),"/undelete"),{undeleted_by:o});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getMessage",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.get(this.baseURL+"/messages/".concat(encodeURIComponent(a)),Qe({},o));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"queryThreads",value:function(){var t=pe(L.mark(function s(){var a=this,o,i,l,c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=d.length>0&&d[0]!==void 0?d[0]:{},i=Qe({limit:10,participant_limit:10,reply_limit:3,watch:!0},o),l=Qe({},i),i.filter&&Object.keys(i.filter).length>0&&(l.filter=i.filter),i.sort&&(Array.isArray(i.sort)?i.sort.length>0:Object.keys(i.sort).length>0)&&(l.sort=ys(i.sort)),h.next=7,this.post("".concat(this.baseURL,"/threads"),l);case 7:return c=h.sent,h.abrupt("return",{threads:c.threads.map(function(p){return new Pj({client:a,threadData:p})}),next:c.next});case 9:case"end":return h.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"getThread",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o=c.length>1&&c[1]!==void 0?c[1]:{},a){u.next=3;break}throw Error("Please specify the messageId when calling getThread");case 3:return i=Qe({participant_limit:100,reply_limit:3,watch:!0},o),u.next=6,this.get("".concat(this.baseURL,"/threads/").concat(encodeURIComponent(a)),i);case 6:return l=u.sent,u.abrupt("return",new Pj({client:this,threadData:l.thread}));case 8:case"end":return u.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"partialUpdateThread",value:function(){var t=pe(L.mark(function s(a,o){var i,l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a){d.next=2;break}throw Error("Please specify the message id when calling partialUpdateThread");case 2:i=["created_at","id","last_message_at","type","updated_at","user","reply_count","participants","channel","custom"],d.t0=L.keys(Qe(Qe({},o.set),o.unset));case 4:if((d.t1=d.t0()).done){d.next=10;break}if(l=d.t1.value,!i.includes(l)){d.next=8;break}throw Error("You cannot set ".concat(l," field on Thread object. ").concat(l," is reserved for server-side use. Please omit ").concat(l," from your set object."));case 8:d.next=4;break;case 10:return d.next=12,this.patch("".concat(this.baseURL,"/threads/").concat(encodeURIComponent(a)),o);case 12:return d.abrupt("return",d.sent);case 13:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getUserAgent",value:function(){var r;if(this.userAgent)return this.userAgent;var s="8.60.0",a="",o="";this.sdkIdentifier?o="stream-chat-".concat(this.sdkIdentifier.name,"-v").concat(this.sdkIdentifier.version,"-llc-v").concat(s):o="stream-chat-js-v".concat(s,"-").concat(this.node?"node":"browser");var i=(r=this.deviceIdentifier)!==null&&r!==void 0?r:{},l=i.os,c=i.model;return[["os",l],["device_model",c],["client_bundle",a]].reduce(function(d,u){var h=Ql(u,2),p=h[0],g=h[1];return g&&g.length>0?d.concat("|".concat(p,"=").concat(g)):d},o)}},{key:"setUserAgent",value:function(r){this.userAgent=r}},{key:"_enrichAxiosOptions",value:function(){var r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{params:{},headers:{},config:{}},a=this._getToken(),o=a?{Authorization:a}:void 0,i=null;this.nextRequestAbortController!==null&&(i=this.nextRequestAbortController.signal,this.nextRequestAbortController=null),(r=s.headers)!==null&&r!==void 0&&r["x-client-request-id"]||(s.headers=Qe(Qe({},s.headers),{},{"x-client-request-id":Uc()}));var l=this.options.axiosRequestConfig||{},c=l.params,d=l.headers,u=oh(l,ZF);return Qe(Qe(Qe({params:Qe(Qe({user_id:this.userID,connection_id:this._getConnectionID(),api_key:this.key},s.params),c||{}),headers:Qe(Qe(Qe({},o),{},{"stream-auth-type":this.getAuthType(),"X-Stream-Client":this.getUserAgent()},s.headers),d||{})},i?{signal:i}:{}),s.config),u||{})}},{key:"_getToken",value:function(){return!this.tokenManager||this.anonymous?null:this.tokenManager.getToken()}},{key:"_startCleaning",value:function(){var r=this;this.cleaningIntervalRef==null&&(this.cleaningIntervalRef=setInterval(function(){for(var s=0,a=Object.values(r.activeChannels);s<a.length;s++){var o=a[s];o.clean()}},500))}},{key:"verifyWebhook",value:function(r,s){return!!this.secret&&gF(r,this.secret,s)}},{key:"getPermission",value:function(r){return this.get("".concat(this.baseURL,"/permissions/").concat(encodeURIComponent(r)))}},{key:"createPermission",value:function(r){return this.post("".concat(this.baseURL,"/permissions"),Qe({},r))}},{key:"updatePermission",value:function(r,s){return this.put("".concat(this.baseURL,"/permissions/").concat(encodeURIComponent(r)),Qe({},s))}},{key:"deletePermission",value:function(r){return this.delete("".concat(this.baseURL,"/permissions/").concat(encodeURIComponent(r)))}},{key:"listPermissions",value:function(){return this.get("".concat(this.baseURL,"/permissions"))}},{key:"createRole",value:function(r){return this.post("".concat(this.baseURL,"/roles"),{name:r})}},{key:"listRoles",value:function(){return this.get("".concat(this.baseURL,"/roles"))}},{key:"deleteRole",value:function(r){return this.delete("".concat(this.baseURL,"/roles/").concat(encodeURIComponent(r)))}},{key:"sync",value:function(r,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.post("".concat(this.baseURL,"/sync"),Qe({channel_cids:r,last_sync_at:s},a))}},{key:"sendUserCustomEvent",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post("".concat(this.baseURL,"/users/").concat(encodeURIComponent(a),"/event"),{event:o});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"createBlockList",value:function(r){return this.post("".concat(this.baseURL,"/blocklists"),r)}},{key:"listBlockLists",value:function(r){return this.get("".concat(this.baseURL,"/blocklists"),r)}},{key:"getBlockList",value:function(r,s){return this.get("".concat(this.baseURL,"/blocklists/").concat(encodeURIComponent(r)),s)}},{key:"updateBlockList",value:function(r,s){return this.put("".concat(this.baseURL,"/blocklists/").concat(encodeURIComponent(r)),s)}},{key:"deleteBlockList",value:function(r,s){return this.delete("".concat(this.baseURL,"/blocklists/").concat(encodeURIComponent(r)),s)}},{key:"exportChannels",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=Qe({channels:r},s);return this.post("".concat(this.baseURL,"/export_channels"),a)}},{key:"exportUsers",value:function(r){return this.post("".concat(this.baseURL,"/export/users"),r)}},{key:"exportChannel",value:function(r,s){return this.exportChannels([r],s)}},{key:"getExportChannelStatus",value:function(r){return this.get("".concat(this.baseURL,"/export_channels/").concat(encodeURIComponent(r)))}},{key:"campaign",value:function(r,s){return r&&_n(r)==="object"?new ij(this,null,r):new ij(this,r,s)}},{key:"segment",value:function(r,s,a){return typeof s=="string"?new Sj(this,r,s,a):new Sj(this,r,null,s)}},{key:"validateServerSideAuth",value:function(){if(!this.secret)throw new Error("Campaigns is a server-side only feature. Please initialize the client with a secret to use this feature.")}},{key:"createSegment",value:function(){var t=pe(L.mark(function s(a,o,i){var l;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.validateServerSideAuth(),l=Qe({id:o,type:a},i),d.abrupt("return",this.post(this.baseURL+"/segments",l));case 3:case"end":return d.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"createUserSegment",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.createSegment("user",a,o));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"createChannelSegment",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.createSegment("channel",a,o));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getSegment",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.validateServerSideAuth(),i.abrupt("return",this.get(this.baseURL+"/segments/".concat(encodeURIComponent(a))));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"updateSegment",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.put(this.baseURL+"/segments/".concat(encodeURIComponent(a)),o));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"addSegmentTargets",value:function(){var t=pe(L.mark(function s(a,o){var i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.validateServerSideAuth(),i={target_ids:o},c.abrupt("return",this.post(this.baseURL+"/segments/".concat(encodeURIComponent(a),"/addtargets"),i));case 3:case"end":return c.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"querySegmentTargets",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c=arguments;return L.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o=c.length>1&&c[1]!==void 0?c[1]:{},i=c.length>2&&c[2]!==void 0?c[2]:[],l=c.length>3&&c[3]!==void 0?c[3]:{},this.validateServerSideAuth(),u.abrupt("return",this.post(this.baseURL+"/segments/".concat(encodeURIComponent(a),"/targets/query"),Qe({filter:o||{},sort:i||[]},l)));case 5:case"end":return u.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"removeSegmentTargets",value:function(){var t=pe(L.mark(function s(a,o){var i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.validateServerSideAuth(),i={target_ids:o},c.abrupt("return",this.post(this.baseURL+"/segments/".concat(encodeURIComponent(a),"/deletetargets"),i));case 3:case"end":return c.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"querySegments",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},this.validateServerSideAuth(),d.abrupt("return",this.post(this.baseURL+"/segments/query",Qe({filter:a,sort:o},i)));case 3:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"deleteSegment",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.validateServerSideAuth(),i.abrupt("return",this.delete(this.baseURL+"/segments/".concat(encodeURIComponent(a))));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"segmentTargetExists",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.get(this.baseURL+"/segments/".concat(encodeURIComponent(a),"/target/").concat(encodeURIComponent(o))));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"createCampaign",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.validateServerSideAuth(),i.abrupt("return",this.post(this.baseURL+"/campaigns",Qe({},a)));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getCampaign",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.get(this.baseURL+"/campaigns/".concat(encodeURIComponent(a)),Qe({},o==null?void 0:o.users)));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"startCampaign",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.post(this.baseURL+"/campaigns/".concat(encodeURIComponent(a),"/start"),{scheduled_for:o==null?void 0:o.scheduledFor,stop_at:o==null?void 0:o.stopAt}));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"queryCampaigns",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.validateServerSideAuth(),c.next=3,this.post(this.baseURL+"/campaigns/query",Qe({filter:a,sort:o},i||{}));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"updateCampaign",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.validateServerSideAuth(),l.abrupt("return",this.put(this.baseURL+"/campaigns/".concat(encodeURIComponent(a)),o));case 2:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"deleteCampaign",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.validateServerSideAuth(),i.abrupt("return",this.delete(this.baseURL+"/campaigns/".concat(encodeURIComponent(a))));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"stopCampaign",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return this.validateServerSideAuth(),i.abrupt("return",this.post(this.baseURL+"/campaigns/".concat(encodeURIComponent(a),"/stop")));case 2:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"enrichURL",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this.get(this.baseURL+"/og",{url:a}));case 1:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"getTask",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this.get("".concat(this.baseURL,"/tasks/").concat(encodeURIComponent(a))));case 1:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"deleteChannels",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{},c.next=3,this.post(this.baseURL+"/channels/delete",Qe({cids:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"deleteUsers",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=i.length>1&&i[1]!==void 0?i[1]:{},!(typeof o.user<"u"&&!["soft","hard","pruning"].includes(o.user))){c.next=3;break}throw new Error("Invalid delete user options. user must be one of [soft hard pruning]");case 3:if(!(typeof o.conversations<"u"&&!["soft","hard"].includes(o.conversations))){c.next=5;break}throw new Error("Invalid delete user options. conversations must be one of [soft hard]");case 5:if(!(typeof o.messages<"u"&&!["soft","hard","pruning"].includes(o.messages))){c.next=7;break}throw new Error("Invalid delete user options. messages must be one of [soft hard pruning]");case 7:return c.next=9,this.post(this.baseURL+"/users/delete",Qe({user_ids:a},o));case 9:return c.abrupt("return",c.sent);case 10:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_createImportURL",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/import_urls",{filename:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_createImport",value:function(){var t=pe(L.mark(function s(a){var o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>1&&i[1]!==void 0?i[1]:{mode:"upsert"},c.next=3,this.post(this.baseURL+"/imports",Qe({path:a},o));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_getImport",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get(this.baseURL+"/imports/".concat(encodeURIComponent(a)));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"_listImports",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.get(this.baseURL+"/imports",a);case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"upsertPushProvider",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/push_providers",{push_provider:a});case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"deletePushProvider",value:function(){var t=pe(L.mark(function s(a){var o,i;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=a.type,i=a.name,c.next=3,this.delete(this.baseURL+"/push_providers/".concat(encodeURIComponent(o),"/").concat(encodeURIComponent(i)));case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"listPushProviders",value:function(){var t=pe(L.mark(function s(){return L.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.get(this.baseURL+"/push_providers");case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"createAbortControllerForNextRequest",value:function(){return this.nextRequestAbortController=new AbortController}},{key:"commitMessage",value:function(){var t=pe(L.mark(function s(a){return L.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.post(this.baseURL+"/messages/".concat(encodeURIComponent(a),"/commit"));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"createPoll",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.post(this.baseURL+"/polls",Qe(Qe({},a),o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"getPoll",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.get(this.baseURL+"/polls/".concat(encodeURIComponent(a)),o?{user_id:o}:{});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"updatePoll",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.put(this.baseURL+"/polls",Qe(Qe({},a),o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"partialUpdatePoll",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.patch(this.baseURL+"/polls/".concat(encodeURIComponent(a)),Qe(Qe({},o),i?{user_id:i}:{}));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"deletePoll",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.delete(this.baseURL+"/polls/".concat(encodeURIComponent(a)),Qe({},o?{user_id:o}:{}));case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"closePoll",value:function(){var t=pe(L.mark(function s(a,o){return L.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.partialUpdatePoll(a,{set:{is_closed:!0}},o));case 1:case"end":return l.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"createPollOption",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.post(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/options"),Qe(Qe({},o),i?{user_id:i}:{}));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"getPollOption",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.get(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(o)),i?{user_id:i}:{});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"updatePollOption",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.put(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/options"),Qe(Qe({},o),i?{user_id:i}:{}));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"deletePollOption",value:function(){var t=pe(L.mark(function s(a,o,i){return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.delete(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(o)),i?{user_id:i}:{});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},s,this)}));function r(s,a,o){return t.apply(this,arguments)}return r}()},{key:"castPollVote",value:function(){var t=pe(L.mark(function s(a,o,i,l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.post(this.baseURL+"/messages/".concat(encodeURIComponent(a),"/polls/").concat(encodeURIComponent(o),"/vote"),Qe({vote:i},l?{user_id:l}:{}));case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"addPollAnswer",value:function(){var t=pe(L.mark(function s(a,o,i,l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.castPollVote(a,o,{answer_text:i},l));case 1:case"end":return d.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"removePollVote",value:function(){var t=pe(L.mark(function s(a,o,i,l){return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.delete(this.baseURL+"/messages/".concat(encodeURIComponent(a),"/polls/").concat(encodeURIComponent(o),"/vote/").concat(encodeURIComponent(i)),Qe({},l?{user_id:l}:{}));case 2:return d.abrupt("return",d.sent);case 3:case"end":return d.stop()}},s,this)}));function r(s,a,o,i){return t.apply(this,arguments)}return r}()},{key:"queryPolls",value:function(){var t=pe(L.mark(function s(){var a,o,i,l,c,d=arguments;return L.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return a=d.length>0&&d[0]!==void 0?d[0]:{},o=d.length>1&&d[1]!==void 0?d[1]:[],i=d.length>2&&d[2]!==void 0?d[2]:{},l=d.length>3?d[3]:void 0,c=l?"?user_id=".concat(l):"",h.next=7,this.post(this.baseURL+"/polls/query".concat(c),Qe({filter:a,sort:ys(o)},i));case 7:return h.abrupt("return",h.sent);case 8:case"end":return h.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"queryPollVotes",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u=arguments;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=u.length>1&&u[1]!==void 0?u[1]:{},i=u.length>2&&u[2]!==void 0?u[2]:[],l=u.length>3&&u[3]!==void 0?u[3]:{},c=u.length>4?u[4]:void 0,d=c?"?user_id=".concat(c):"",p.next=7,this.post(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/votes").concat(d),Qe({filter:o,sort:ys(i)},l));case 7:return p.abrupt("return",p.sent);case 8:case"end":return p.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryPollAnswers",value:function(){var t=pe(L.mark(function s(a){var o,i,l,c,d,u=arguments;return L.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=u.length>1&&u[1]!==void 0?u[1]:{},i=u.length>2&&u[2]!==void 0?u[2]:[],l=u.length>3&&u[3]!==void 0?u[3]:{},c=u.length>4?u[4]:void 0,d=c?"?user_id=".concat(c):"",p.next=7,this.post(this.baseURL+"/polls/".concat(encodeURIComponent(a),"/votes").concat(d),Qe({filter:Qe(Qe({},o),{},{is_answer:!0}),sort:ys(i)},l));case 7:return p.abrupt("return",p.sent);case 8:case"end":return p.stop()}},s,this)}));function r(s){return t.apply(this,arguments)}return r}()},{key:"queryMessageHistory",value:function(){var t=pe(L.mark(function s(){var a,o,i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=l.length>0&&l[0]!==void 0?l[0]:{},o=l.length>1&&l[1]!==void 0?l[1]:[],i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=5,this.post(this.baseURL+"/messages/history",Qe({filter:a,sort:ys(o)},i));case 5:return d.abrupt("return",d.sent);case 6:case"end":return d.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"updateFlags",value:function(){var t=pe(L.mark(function s(a,o){var i,l=arguments;return L.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=l.length>2&&l[2]!==void 0?l[2]:{},d.next=3,this.post(this.baseURL+"/automod/v1/moderation/update_flags",Qe({message_ids:a,reviewed_by:o},i));case 3:return d.abrupt("return",d.sent);case 4:case"end":return d.stop()}},s,this)}));function r(s,a){return t.apply(this,arguments)}return r}()},{key:"queryDrafts",value:function(){var t=pe(L.mark(function s(){var a,o,i=arguments;return L.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.length>0&&i[0]!==void 0?i[0]:{},o=Qe(Qe({},a),{},{sort:a.sort?ys(a.sort):void 0}),c.next=4,this.post(this.baseURL+"/drafts/query",o);case 4:return c.abrupt("return",c.sent);case 5:case"end":return c.stop()}},s,this)}));function r(){return t.apply(this,arguments)}return r}()}],[{key:"getInstance",value:function(r,s,a){return n._instance||(typeof s=="string"?n._instance=new n(r,s,a):n._instance=new n(r,s)),n._instance}}]),n}();q(Sf,"_instance",void 0);var xC="Allow",tW="Deny",Lb=["*"],Bb=["*"],rW=999,nW=1,yC=function n(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Lb,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Bb,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:xC;Vt(this,n),q(this,"name",void 0),q(this,"action",void 0),q(this,"owner",void 0),q(this,"priority",void 0),q(this,"resources",void 0),q(this,"roles",void 0),this.name=t,this.action=i,this.owner=o,this.priority=r,this.resources=s,this.roles=a};new yC("Allow all",rW,Lb,Bb,!1,xC);new yC("Deny all",nW,Lb,Bb,!1,tW);const bC=(n,t)=>{const[r,s]=y.useState([]),[a,o]=y.useState([]),[i,l]=y.useState(!0),[c,d]=y.useState(null),[u,h]=y.useState(null),p=y.useRef(null),g=y.useRef(null),f=y.useCallback(async(b=!1)=>{g.current&&g.current.abort(),g.current=new AbortController;try{b||l(!0);const[w,x]=await Promise.all([ra.getPendingProposals(n,t),ra.getSentProposals(n,t)]);g.current.signal.aborted||(s(w.filter(j=>j.status==="pending")),o(x.filter(j=>["pending","countered"].includes(j.status))),d(null),h(new Date))}catch(w){if(w.name==="AbortError")return;d(w.message),b||(s([]),o([]))}finally{g.current.signal.aborted||l(!1)}},[n,t]);y.useEffect(()=>{if(n&&t)return f(),p.current=setInterval(()=>{f(!0)},3e4),()=>{p.current&&clearInterval(p.current),g.current&&g.current.abort()}},[n,t,f]);const m=y.useCallback(()=>{f()},[f]),v=y.useCallback((b,w="add")=>{w==="add"?o(x=>[b,...x]):w==="update"?(s(x=>x.map(j=>j._id===b._id?b:j)),o(x=>x.map(j=>j._id===b._id?b:j))):w==="remove"&&(s(x=>x.filter(j=>j._id!==b._id)),o(x=>x.filter(j=>j._id!==b._id))),h(new Date)},[]);return{pendingProposals:r,sentProposals:a,loading:i,error:c,lastUpdate:u,refetch:m,updateProposalLocally:v}},sW={}.VITE_STREAM_API_KEY,aW="frbcaplgmailcom";function oW(n){if(!n)return"";const t=new Date(n),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function Ud(n){if(!n)return"";const t=new Date(n),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${t.getFullYear()}-${r}-${s}`}function iW(n){let t=n.trim();t=t.replace(/(\d{1,2}):(\d{2})\s*(am|pm)/i,(s,a,o,i)=>`${parseInt(a,10)}:${o} ${i.toUpperCase()}`),t=t.replace(/^(\d{1,2})(\d{2})(am|pm)$/i,(s,a,o,i)=>`${parseInt(a,10)}:${o} ${i.toUpperCase()}`),t=t.replace(/^(\d{1,2})(am|pm)$/i,(s,a,o)=>`${parseInt(a,10)}:00 ${o.toUpperCase()}`),t=t.replace(/(am|pm)$/i," $1"),t=t.replace(/(am|pm)$/i,s=>s.toUpperCase());const r=t.match(/^(\d{1,2}):(\d{2}) (AM|PM)$/i);if(r){const s=r[1],a=r[2],o=r[3].toUpperCase(),i=`${s}:${a} ${o}`;return console.log("normalizeTimeString final:",i),i}return console.log("normalizeTimeString fallback:",t),t}function op(n){return n.replace(/[^a-zA-Z0-9]/g,"")}async function lW({senderEmail:n,senderName:t,receiverEmail:r,receiverName:s,matchName:a}){try{const o=Sf.getInstance(sW),i=await fetch(`${Ie}/token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:op(n)})}),{token:l}=await i.json();if(!l)throw new Error("Could not get chat token");o.userID||await o.connectUser({id:op(n),name:t},l);const c=Array.from(new Set([op(n),op(r),aW])),d=o.channel("messaging",{members:c,name:a});await d.create(),await d.sendMessage({text:"Chat created for your match proposal!"})}catch(o){console.error("Failed to create chat channel:",o),alert("Failed to create chat channel: "+o.message)}}const $g=`This is a BETA test match. Matches that are created, scheduled, and confirmed will NOT be played.

`,cW=n=>n.replace(/[]/g,"-").replace(/\s*-\s*/g," - ").trim();function _f({player:n,day:t,slot:r,onClose:s,senderName:a,senderEmail:o,onProposalComplete:i,selectedDivision:l,phase:c}){console.log("MatchProposalModal player prop:",n),console.log("MatchProposalModal phase prop:",c),console.log("MatchProposalModal slot prop:",r,JSON.stringify(r));const[d,u]=y.useState(r),[h,p]=y.useState(""),[g,f]=y.useState(""),[m,v]=y.useState(""),[b,w]=y.useState(!1),[x,j]=y.useState("8 Ball"),[S,_]=y.useState(c==="scheduled"||c==="challenge"?5:7),C=n.locations?n.locations.split(/\r?\n/).map($=>$.trim()).filter(Boolean):[],N=x9(t),[M,E]=y.useState(N),P=n.availability[t]||[],T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][M.getDay()],A=y.useMemo(()=>{if(!r)return[];const $=cW(r);if(console.log("DEBUG: normalized slot:",$),!$.includes(" - "))return[];let[W,Y]=$.split(" - ").map(H=>iW(H.trim()));if(console.log("DEBUG: blockStart:",W,"blockEnd:",Y),!W||!Y)return[];const Q=Pb(W,Y,30);return console.log("DEBUG: generated times:",Q),Q},[r]);y.useEffect(()=>{p("")},[r]);const{sentProposals:k}=bC(a,l);function R($){return k.some(W=>W.receiverName===($.player?`${$.player.firstName} ${$.player.lastName}`:$.opponentName)&&W.date===Ud(M)&&W.time===h&&W.location===g&&W.phase===c&&W.divisions&&W.divisions.includes(l)&&["pending","countered"].includes(W.status))}n.opponents&&n.opponents.filter($=>!R($));const U=()=>{if(!o||!n.email||!h||!g||!M){alert("Please fill in all required fields.");return}if(c==="scheduled"){const W=new Date,Y=new Date(M),Q=Math.ceil((Y-W)/(1e3*60*60*24));if(Q<0){alert(" You cannot schedule a match in the past.");return}if(Q<=2&&!window.confirm(` WARNING: This match is scheduled for ${Q} day(s) from now.

Phase 1 matches must be completed by the end of week 6. Scheduling this close to the deadline may not give enough time to complete the match.

Do you want to continue with this schedule?`))return}const $={senderEmail:o,senderName:a,receiverEmail:n.email,receiverName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,date:Ud(M),time:h,location:g,message:m,gameType:x,raceLength:S,phase:c,divisions:[l]};console.log("Proposal data to send:",$),fetch(`${Ie}/api/proposals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)}).then(W=>W.json()).then(W=>{if(console.log("Backend response:",W),W.error)throw new Error(W.error);if(lW({senderEmail:o,senderName:a,receiverEmail:n.email,receiverName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,matchName:`${a} vs ${n.firstName?`${n.firstName} ${n.lastName}`:n.name} - ${oW(M)}`}),w9({to_email:n.email,to_name:n.firstName?`${n.firstName} ${n.lastName}`:n.name,from_name:a,from_email:o,day:T,date:Ud(M),time:h,location:g,note:m,gameType:x,raceLength:S,proposalId:W.proposalId}),w(!0),i){const Y={_id:W.proposalId,senderEmail:o,senderName:a,receiverEmail:n.email,receiverName:n.firstName?`${n.firstName} ${n.lastName}`:n.name,date:Ud(M),time:h,location:g,message:m,gameType:x,raceLength:S,phase:c,divisions:[l],status:"pending",createdAt:new Date};i(Y)}}).catch(W=>{console.error("Failed to send proposal:",W),alert("Failed to send proposal: "+W.message)})},z=()=>{w(!1),s(),i&&i()};return e.jsxs(e.Fragment,{children:[e.jsx(It,{open:!0,onClose:s,title:e.jsx("span",{className:sn["match-proposal-title"],children:"Propose a Match - BETA"}),maxWidth:"500px",className:"proposal-modal",children:e.jsxs("div",{className:sn["match-proposal-content"],children:[e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginBottom:12},children:[e.jsx("div",{className:sn["match-proposal-phase"],children:e.jsxs("b",{children:[e.jsx("span",{style:{color:"#fff"},children:c==="scheduled"?"Phase 1:":c==="challenge"?"Phase 2:":""}),e.jsx("span",{className:sn["match-proposal-label-red"],style:{marginLeft:4},children:c==="scheduled"?"Scheduled Match Phase":c==="challenge"?"Challenge Phase":""})]})}),e.jsxs("div",{className:sn["match-proposal-division"],children:[e.jsx("b",{children:e.jsx("span",{style:{color:"#fff"},children:"Division:"})})," ",e.jsx("span",{className:sn["match-proposal-label-red"],children:l})]})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"To Opponent:"}),e.jsx("div",{className:sn.opponentName,style:{fontWeight:"bold",fontSize:"1.25rem",margin:"2px 0"},children:n.firstName?`${n.firstName} ${n.lastName}`:n.name}),e.jsx("span",{style:{color:"#fff",fontSize:"1rem"},children:"Day: "}),e.jsx("span",{className:sn["match-proposal-day-value"],style:{color:"#e53e3e",fontWeight:600},children:T})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Date:"}),e.jsx(wb,{selected:M,onChange:$=>E($),dateFormat:"MM-dd-yyyy",className:sn["match-proposal-date-input"],required:!0})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Time Block:"}),e.jsxs("select",{className:sn["match-proposal-select"],value:d,onChange:$=>u($.target.value),children:[e.jsx("option",{value:"",children:"Select time block"}),P.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Start Time:"}),e.jsxs("select",{className:sn["match-proposal-select"],value:h,onChange:$=>p($.target.value),children:[e.jsx("option",{value:"",children:"Select..."}),A.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Game Type:"}),e.jsxs("select",{className:sn["match-proposal-select"],value:x,onChange:$=>j($.target.value),children:[e.jsx("option",{value:"8 Ball",children:"8 Ball"}),e.jsx("option",{value:"9 Ball",children:"9 Ball"}),e.jsx("option",{value:"10 Ball",children:"10 Ball"}),e.jsx("option",{value:"Mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Race Length:"}),e.jsx("select",{className:sn["match-proposal-select"],value:S,onChange:$=>_(Number($.target.value)),children:(()=>c==="scheduled"||c==="challenge"?e.jsx("option",{value:5,children:"5"}):[...Array(13)].map(($,W)=>{const Y=W+3;return e.jsx("option",{value:Y,children:Y},Y)}))()})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Location:"}),e.jsxs("select",{className:sn["match-proposal-location-select"],value:g,onChange:$=>f($.target.value),children:[e.jsx("option",{value:"",children:"Select..."}),C.map(($,W)=>e.jsx("option",{value:$,children:$},W))]})]}),e.jsxs("div",{className:sn["match-proposal-row"],style:{marginBottom:10},children:[e.jsx("b",{children:"Message to Opponent:"}),e.jsx("textarea",{className:sn["match-proposal-textarea"],value:$g+m,onChange:$=>{const W=$.target.value;W.startsWith($g)?v(W.slice($g.length)):v("")},placeholder:"Add a comment to your opponent...",rows:5})]}),e.jsx("button",{className:sn["match-proposal-send-btn"],onClick:U,disabled:!h||!g,children:"Send Proposal"})]})}),b&&e.jsx(v9,{open:b,onClose:z,message:`Your match proposal has been sent to ${n.firstName?`${n.firstName} ${n.lastName}`:n.name}.
          They will receive an email notification and can respond through the app.`,phase:c,gameType:x,raceLength:S,day:T,date:Ud(M),time:h,location:g,proposalNote:m})]})}async function dW(n){try{if(!n)return console.warn("No division selected for standings"),[];const t=n.replace(/[^A-Za-z0-9]/g,"_"),r=`${Ie}/static/standings_${t}.json`,s=await fetch(r);if(!s.ok)throw new Error(`Failed to fetch standings: ${s.status}`);const a=await s.json();if(!Array.isArray(a))return console.error("Standings data is not an array:",a),[];const o=a.filter(i=>{if(!i||typeof i!="object")return console.warn("Invalid standings entry:",i),!1;if(!i.name||!i.rank)return console.warn("Standings entry missing name or rank:",i),!1;const l=parseInt(i.rank);return isNaN(l)||l<=0?(console.warn("Invalid rank in standings entry:",i),!1):!0});return console.log(`Loaded ${o.length} valid standings entries for division: ${n}`),o}catch(t){return console.error("Failed to load standings:",t),[]}}function xd(n,t){if(!t||typeof t!="string")return console.warn("getPlayerPosition: playerName is undefined or not a string:",t),null;const r=t.toLowerCase().trim(),s=n.find(a=>a.name&&a.name.toLowerCase().trim()===r);return s?parseInt(s.rank):null}function uW(n,t){return n.sort((r,s)=>{const a=r&&r.firstName&&r.lastName?`${r.firstName} ${r.lastName}`:"",o=s&&s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:"",i=xd(t,a),l=xd(t,o);return i!==null&&l!==null?i-l:i!==null&&l===null?-1:i===null&&l!==null?1:a.localeCompare(o)})}function hW(n,t,r){if(!t||t.length===0)return console.warn("No standings data available for Phase 2 filtering"),n;console.log("=== PHASE 2 FILTERING DEBUG ==="),console.log("Current player name:",r),console.log("Standings data:",t),console.log("All players from sheet:",n.map(o=>`${o.firstName} ${o.lastName}`));const s=xd(t,r);if(s===null)return console.warn(`Player ${r} not found in standings`),console.log("Available standings names:",t.map(o=>o.name)),n;console.log(`Phase 2 filtering: ${r} is at position ${s}`);const a=n.filter(o=>{if(!o||!o.firstName||!o.lastName)return console.warn("Player data incomplete, excluding from Phase 2 filtering:",o),!1;const i=`${o.firstName} ${o.lastName}`,l=xd(t,i);if(l===null)return console.warn(`Opponent ${i} not found in standings - excluding from Phase 2`),!1;const c=l-s,d=c<0&&c>=-4;return console.log(`${i} (${l}) - difference: ${c}, eligible: ${d}`),d});return console.log(`Phase 2 filtering complete: ${a.length} eligible opponents out of ${n.length} total players`),console.log("Eligible players:",a.map(o=>`${o.firstName} ${o.lastName}`)),console.log("=== END PHASE 2 DEBUG ==="),a}function Lx({onClose:n,excludeName:t,senderName:r,senderEmail:s,onProposalComplete:a,selectedDivision:o,phase:i}){const[l,c]=y.useState([]),[d,u]=y.useState(""),[h,p]=y.useState(!0),[g,f]=y.useState([]),[m,v]=y.useState("search"),[b,w]=y.useState(null),[x,j]=y.useState(null);y.useEffect(()=>{},[l]),y.useEffect(()=>{let N=!0;async function M(){try{const E=await dW(o);N&&f(E);const P=await fetch(`${Ie}/api/users/search?approved=true`);if(!P.ok)throw new Error("Failed to fetch players from database");const D=await P.json();if(!D.users||D.users.length===0){N&&c([]),p(!1);return}let T=D.users.map(A=>({firstName:A.firstName||"",lastName:A.lastName||"",email:A.email||"",phone:A.phone||"",locations:A.locations||"",availability:A.availability||{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},pin:A.pin||"",preferredContacts:A.preferredContacts||[],division:A.division||"",divisions:A.divisions||[]})).filter(A=>A.email&&A.firstName&&A.lastName&&A.isApproved&&`${A.firstName} ${A.lastName}`.toLowerCase()!==(t==null?void 0:t.toLowerCase()));i==="challenge"&&E.length>0?(console.log(" Phase value:",i),console.log(" Standings data length:",E.length),console.log(" Sender name:",r),T=hW(T,E,r),T=uW(T,E)):(console.log("   - phase === 'challenge':",i==="challenge"),console.log("   - standingsData.length > 0:",E.length>0),console.log("   - phase value:",i),console.log("   - standingsData length:",E.length)),N&&(c(T),setTimeout(()=>{},2e3))}catch(E){console.error("Error loading data:",E),N&&c([])}finally{N&&p(!1)}}return M(),()=>{N=!1}},[t,i,r,o]);const S=d.length>=3?l.filter(N=>`${N.firstName} ${N.lastName}`.toLowerCase().includes(d.toLowerCase())&&`${N.firstName} ${N.lastName}`.toLowerCase()!==(t==null?void 0:t.toLowerCase())):[],_=xd(g,r),C=e.jsxs(e.Fragment,{children:[m==="search"&&e.jsx(It,{open:!0,onClose:n,title:" Player Search",maxWidth:"500px",children:i==="challenge"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(229, 62, 62, 0.1)",border:"1px solid #e53e3e",borderRadius:"6px",padding:"1rem",marginBottom:"1.5rem",color:"#fff"},children:[e.jsx("strong",{children:"Phase 2 (Challenge):"})," You can only challenge players ranked 4 spots above in the standings.",e.jsx("br",{}),e.jsxs("span",{style:{fontSize:"1rem",color:"#fff",marginTop:8,display:"block"},children:[e.jsx("b",{children:"Your Position:"})," #",_??"N/A"]}),l.length>0&&e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",opacity:.9},children:[l.length," eligible opponent",l.length!==1?"s":""," available"]})]}),h?e.jsx("p",{style:{color:"#fff",textAlign:"center"},children:"Loading players..."}):e.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:l.length===0?e.jsx("p",{style:{color:"#888",textAlign:"center",fontStyle:"italic"},children:"No eligible opponents found within 4 spots above you in the standings."}):e.jsx("div",{style:{display:"grid",gap:"8px"},children:l.map((N,M)=>{const E=`${N.firstName} ${N.lastName}`,P=xd(g,E);return e.jsx("button",{onClick:()=>{w(N),v("availability")},style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"8px",padding:"1rem",fontSize:"1.1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:D=>{D.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",D.target.style.transform="translateY(-2px)",D.target.style.boxShadow="0 4px 12px rgba(229, 62, 62, 0.3)"},onMouseLeave:D=>{D.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",D.target.style.transform="translateY(0)",D.target.style.boxShadow="none"},children:e.jsxs("span",{style:{fontWeight:"bold",color:"#fff"},children:["#",P??"N/A"," ",E]})},M)})})})]}):e.jsxs(e.Fragment,{children:[d.length>=3&&S.length>0&&e.jsx("div",{style:{color:"#e53e3e",fontSize:"0.9rem",marginBottom:"1rem",textAlign:"center"},children:"Click opponent's name to see availability."}),e.jsx("input",{type:"text",placeholder:"Type at least 3 letters to search...",value:d,onChange:N=>u(N.target.value),autoFocus:!0,"aria-label":"Search for player",style:{width:"100%",padding:"0.75rem",background:"#333",color:"#fff",border:"1px solid #555",borderRadius:"6px",fontSize:"1rem",marginBottom:"1rem"}}),h?e.jsx("p",{style:{color:"#fff",textAlign:"center"},children:"Loading players..."}):e.jsx(e.Fragment,{children:d.length<3?e.jsx("p",{style:{color:"#888",textAlign:"center",fontStyle:"italic"},children:"Please enter at least 3 letters to search for a player."}):e.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:S.length===0?e.jsx("p",{style:{color:"#888",textAlign:"center",fontStyle:"italic"},children:"No players found."}):e.jsx("div",{style:{display:"grid",gap:"8px"},children:S.map((N,M)=>e.jsx("button",{onClick:()=>{w(N),v("availability")},style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"8px",padding:"1rem",fontSize:"1.1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left"},onMouseEnter:E=>{E.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",E.target.style.transform="translateY(-2px)",E.target.style.boxShadow="0 4px 12px rgba(229, 62, 62, 0.3)"},onMouseLeave:E=>{E.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",E.target.style.transform="translateY(0)",E.target.style.boxShadow="none"},children:e.jsx(wA,{text:`${N.firstName} ${N.lastName}`,query:d})},M))})})})]})}),m==="availability"&&b&&e.jsx(mf,{player:b,onClose:n,onProposeMatch:(N,M,E,P)=>{j({player:b,day:N,slot:M,phase:E,selectedDivision:P||o}),v("proposal")},phase:i,selectedDivision:o}),m==="proposal"&&x&&e.jsx(e.Fragment,{children:e.jsx(_f,{player:x.player,day:x.day,slot:x.slot,onClose:n,senderName:r,senderEmail:s,onProposalComplete:()=>{v("search"),j(null),w(null),a&&a(),n()},phase:x.phase,selectedDivision:x.selectedDivision||o})})]});return yh.createPortal(C,document.body)}function vC({size:n="medium",color:t="#e53e3e",text:r="Loading...",showText:s=!0,variant:a="default"}){const o={small:"16px",medium:"24px",large:"32px",xlarge:"48px"},i=o[n]||o.medium,l=()=>{switch(a){case"pulse":return e.jsx("div",{style:{width:i,height:i,borderRadius:"50%",background:t,animation:"pulse 1.5s ease-in-out infinite"}});case"dots":return e.jsx("div",{style:{display:"flex",gap:"4px"},children:[0,1,2].map(c=>e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:t,animation:"bounce 1.4s ease-in-out infinite both",animationDelay:`${c*.16}s`}},c))});case"bars":return e.jsx("div",{style:{display:"flex",gap:"2px"},children:[0,1,2,3,4].map(c=>e.jsx("div",{style:{width:"4px",height:"20px",background:t,animation:"bars 1.2s ease-in-out infinite",animationDelay:`${c*.1}s`}},c))});default:return e.jsx("div",{style:{width:i,height:i,border:"3px solid rgba(229, 62, 62, 0.2)",borderTop:`3px solid ${t}`,borderRadius:"50%",animation:"spin 1s linear infinite"}})}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px",padding:"20px"},children:[l(),s&&r&&e.jsx("div",{style:{color:t,fontSize:"0.9rem",fontWeight:"500",textAlign:"center",maxWidth:"200px"},children:r}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
          0%, 100% { 
            transform: scale(0.8);
            opacity: 0.5;
          }
          50% { 
            transform: scale(1);
            opacity: 1;
          }
        }
        
        @keyframes bounce {
          0%, 80%, 100% { 
            transform: scale(0);
          }
          40% { 
            transform: scale(1);
          }
        }
        
        @keyframes bars {
          0%, 40%, 100% { 
            transform: scaleY(0.4);
          }
          20% { 
            transform: scaleY(1);
          }
        }
      `})]})}function wC({loading:n,children:t,loadingText:r="Loading...",disabled:s=!1,variant:a="default",size:o="medium",...i}){const l={small:{padding:"8px 16px",fontSize:"0.875rem",minHeight:"36px"},medium:{padding:"12px 20px",fontSize:"1rem",minHeight:"48px"},large:{padding:"16px 24px",fontSize:"1.125rem",minHeight:"56px"}},c=l[o]||l.medium;return e.jsx("button",{...i,disabled:n||s,style:{...i.style,...c,position:"relative",opacity:n?.8:1,cursor:n?"not-allowed":"pointer",transition:"all 0.3s ease"},children:n?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx(vC,{size:"small",variant:a,showText:!1,color:"#fff"}),r]}):t})}function pW({lines:n=3,height:t="20px",width:r="100%",gap:s="8px",variant:a="default"}){const o=i=>{const c=i===n-1?"60%":r;switch(a){case"pulse":return e.jsx("div",{style:{height:t,width:c,background:"#444",borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}},i);case"shimmer":return e.jsx("div",{style:{height:t,width:c,background:"linear-gradient(90deg, #333 25%, #444 50%, #333 75%)",backgroundSize:"200% 100%",borderRadius:"4px",animation:"shimmer 1.5s infinite"}},i);default:return e.jsx("div",{style:{height:t,width:c,background:"#333",borderRadius:"4px",opacity:.7}},i)}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:s,padding:"16px"},children:[Array.from({length:n}).map((i,l)=>o(l)),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { 
            opacity: 0.7;
          }
          50% { 
            opacity: 1;
          }
        }
        
        @keyframes shimmer {
          0% { background-position: -200% 0; }
          100% { background-position: 200% 0; }
        }
      `})]})}function mW(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function fW({proposal:n,open:t,onClose:r,onEdit:s,onMessage:a}){if(y.useEffect(()=>{t&&setTimeout(()=>{window.dispatchEvent(new Event("resize"))},50)},[t]),!t||!n)return null;const{senderName:o,receiverName:i,day:l,date:c,time:d,location:u,gameType:h,raceLength:p,message:g,proposalNote:f}=n,m=window.innerWidth<=500,[v,b]=y.useState(!1),[w,x]=y.useState("");async function j(){b(!0),x("");try{if(!(await fetch(`${Ie}/api/proposals/${n._id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"confirmed"})})).ok)throw new Error("Failed to confirm proposal");r&&r()}catch(_){x(_.message||"Failed to confirm proposal")}finally{b(!1)}}const S=e.jsxs(It,{open:t,onClose:r,title:" Proposal Details",maxWidth:m?"99vw":"480px",children:[n.isCounter&&e.jsxs("div",{style:{color:"#ff9800",fontWeight:"bold",marginBottom:8,fontSize:"1.05em",textAlign:"center"},children:["This is a counter proposal from ",n.counteredBy||"your opponent"]}),e.jsxs("div",{style:{textAlign:"left",marginBottom:m?"0.7rem":"1.5rem",fontSize:m?"0.95rem":"1.05rem",padding:m?"0.2rem 0.2rem":void 0},children:[e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"You:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:o||"N/A"})]}),e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Opponent:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:i||"N/A"})]}),l&&e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Day:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:l})]}),e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Date:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:mW(c)})]}),e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Time:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:d||"N/A"})]}),e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Location:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:u||"N/A"})]}),h&&e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx(Tb,{gameType:h,size:m?12:16}),e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Game:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:h})]}),p&&e.jsxs("div",{className:Ke.modalDetailRowSnazzy,style:{padding:m?"0.2em 0.3em":void 0},children:[e.jsx("strong",{style:{color:"#e53e3e",minWidth:m?"80px":"120px",fontSize:m?"0.95em":void 0},children:"Race:"}),e.jsx("span",{style:{color:"#fff",marginLeft:m?"4px":"8px"},children:p})]}),f&&e.jsxs("div",{style:{margin:m?"8px 0 0 0":"16px 0 0 0",padding:m?"0.4rem 0.5rem":"0.8rem 1rem",background:"rgba(255, 193, 7, 0.1)",borderLeft:"3px solid #ffc107",borderRadius:"6px",color:"#ffc107",fontSize:m?"0.9rem":"0.95rem",textAlign:"left"},children:[e.jsx("span",{role:"img","aria-label":"note",children:""})," ",e.jsx("strong",{children:"Note:"}),e.jsx("br",{}),f]})]}),e.jsxs("div",{style:{display:"flex",gap:m?6:12,justifyContent:"center",marginTop:m?10:24,flexDirection:m?"column":"row",alignItems:m?"stretch":"center"},children:[s&&e.jsx("button",{className:Ke.dashboardBtn,onClick:s,style:{background:"#e53e3e",color:"#fff",minWidth:m?"90px":"120px",fontSize:m?"0.95em":void 0,padding:m?"0.5em 0.7em":void 0},children:"Edit"}),a&&e.jsx("button",{className:Ke.dashboardBtn,onClick:a,style:{background:"#007bff",color:"#fff",minWidth:m?"90px":"120px",fontSize:m?"0.95em":void 0,padding:m?"0.5em 0.7em":void 0},children:"Msg"}),n.isCounter&&n.status==="countered"&&e.jsx(wC,{className:Ke.dashboardBtn,onClick:j,loading:v,loadingText:"Confirming...",disabled:v,style:{background:"#43a047",color:"#fff",minWidth:m?"90px":"120px",fontSize:m?"0.95em":void 0,padding:m?"0.5em 0.7em":void 0},children:"Confirm"}),e.jsx("button",{className:Ke.dashboardBtn,onClick:r,style:{background:"#6c757d",color:"#fff",minWidth:m?"90px":"120px",fontSize:m?"0.95em":void 0,padding:m?"0.5em 0.7em":void 0},children:"Close"})]}),w&&e.jsx("div",{style:{color:"red",marginTop:8},children:w})]});return yh.createPortal(S,document.body)}function Lg(n){const t=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}function gW(n){const r=n.trim().replace(/\s+/g,"").toLowerCase().match(/^(\d{1,2})(:\d{2})?(am|pm)$/);if(r){const a=r[1],o=r[2]?r[2]:":00",i=r[3].toUpperCase();return`${a}${o} ${i}`}const s=n.trim().match(/^(\d{1,2})(:\d{2})?\s?(am|pm)$/i);if(s){const a=s[1],o=s[2]?s[2]:":00",i=s[3].toUpperCase();return`${a}${o} ${i}`}return n.trim()}const xW=n=>n.replace(/[]/g,"-").replace(/\s*-\s*/g," - ").trim();function yW({proposal:n,open:t,onClose:r,onSave:s,selectedDivision:a,phase:o,receiverPlayer:i}){var W;const[l,c]=y.useState(new Date),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState(""),[m,v]=y.useState(""),[b,w]=y.useState(""),[x,j]=y.useState(""),[S,_]=y.useState(""),[C,N]=y.useState(!1);y.useEffect(()=>{if(n&&t){if(n.date){const[Y,Q,H]=n.date.split("-");c(new Date(parseInt(Y),parseInt(Q)-1,parseInt(H)))}u(n.time||""),f(n.location||""),v(n.message||""),w(n.gameType||""),j(n.raceLength||"")}},[n,t]);const E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][l.getDay()],D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()],T=((W=i==null?void 0:i.availability)==null?void 0:W[D])||[];console.log("EditProposalModal - Receiver player:",i),console.log("EditProposalModal - Selected day short:",D),console.log("EditProposalModal - Opponent time blocks:",T);const A=["6:00 PM - 8:00 PM","8:00 PM - 10:00 PM","10:00 PM - 12:00 AM"],k=T.length>0?T:A;console.log("EditProposalModal - Available time blocks:",k);const R=!i&&t,U=Te.useMemo(()=>{if(!d)return console.log("EditProposalModal - No time selected:",d),[];console.log("EditProposalModal - Selected time block:",d);const Y=xW(d);if(console.log("EditProposalModal - Normalized slot:",Y),!Y.includes(" - "))return console.log("EditProposalModal - No dash found in normalized slot"),[];let[Q,H]=Y.split(" - ").map(J=>gW(J.trim()));if(console.log("EditProposalModal - Normalized times:",{blockStart:Q,blockEnd:H}),!Q||!H)return console.log("EditProposalModal - Failed to normalize times"),[];const ue=Pb(Q,H,30);return console.log("EditProposalModal - Generated start times:",ue),console.log("EditProposalModal - Times array length:",ue.length),ue},[d]);y.useEffect(()=>{p("")},[d]);const z=async()=>{if(!h||!g){_("Please fill in all required fields.");return}N(!0),_("");try{const Y=await fetch(`${Ie}/api/proposals/${n._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:Lg(l),time:h,location:g,message:m,gameType:b,raceLength:x,phase:o,divisions:[a]})}),Q=await Y.json();if(!Y.ok)throw new Error(Q.error||"Failed to update proposal");s&&s({...n,date:Lg(l),time:h,location:g,message:m,gameType:b,raceLength:x}),r()}catch(Y){_(Y.message||"Failed to update proposal")}finally{N(!1)}};if(!t||!n)return null;const $=e.jsx(It,{open:t,onClose:r,title:" Edit Proposal",maxWidth:"400px",children:e.jsxs("div",{className:Ke.proposalModalContent,style:{width:"100%",maxWidth:400,margin:"0 auto"},children:[e.jsxs("div",{className:Ke.proposalModalHeaderBar,children:[e.jsx("span",{className:Ke.phasePill,children:"Phase 1: Scheduled Match Phase"}),e.jsxs("span",{className:Ke.divisionPill,children:["Division: ",a||"N/A"]})]}),e.jsxs("div",{className:Ke.proposalModalToRow,children:[e.jsx("span",{className:Ke.toOpponentLabel,children:"To Opponent:"}),e.jsx("span",{className:Ke.toOpponentName,children:n.receiverName})]}),e.jsxs("div",{className:Ke.proposalModalDayRow,children:[e.jsx("span",{className:Ke.dayLabel,children:"Day:"}),e.jsx("span",{className:Ke.dayValue,children:E})]}),e.jsxs("div",{className:Ke.formGroup,style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("label",{htmlFor:"proposal-date",style:{marginBottom:4,textAlign:"center"},children:"Date"}),e.jsx("input",{id:"proposal-date",type:"date",value:Lg(l),onChange:Y=>{const[Q,H,ue]=Y.target.value.split("-");c(new Date(parseInt(Q),parseInt(H)-1,parseInt(ue)))},className:Ke.input,required:!0,style:{textAlign:"center"}})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Time Block:"}),R&&e.jsx("div",{style:{color:"#ff6b6b",fontSize:"0.9rem",marginBottom:"0.5rem"},children:" Opponent availability data not available. Using default time blocks."}),i&&T.length===0&&e.jsxs("div",{style:{color:"#ffa500",fontSize:"0.9rem",marginBottom:"0.5rem"},children:[" No availability for ",E,". Using default time blocks."]}),e.jsxs("select",{value:d,onChange:Y=>u(Y.target.value),className:Ke.inputField,children:[e.jsx("option",{value:"",children:"Select time block"}),k.map(Y=>e.jsx("option",{value:Y,children:Y},Y))]})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Start Time:"}),e.jsxs("select",{value:h,onChange:Y=>p(Y.target.value),className:Ke.inputField,children:[e.jsx("option",{value:"",children:"Select start time"}),U.map(Y=>e.jsx("option",{value:Y,children:Y},Y))]})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Game Type:"}),e.jsxs("select",{value:b,onChange:Y=>w(Y.target.value),className:Ke.inputField,children:[e.jsx("option",{value:"",children:"Select game type"}),e.jsx("option",{value:"8 Ball",children:"8 Ball"}),e.jsx("option",{value:"9 Ball",children:"9 Ball"}),e.jsx("option",{value:"10 Ball",children:"10 Ball"}),e.jsx("option",{value:"Mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Race Length:"}),e.jsxs("select",{value:x,onChange:Y=>j(Y.target.value),className:Ke.inputField,children:[e.jsx("option",{value:"",children:"Select race length"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"7",children:"7"}),e.jsx("option",{value:"9",children:"9"})]})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Location:"}),e.jsx("input",{type:"text",value:g,onChange:Y=>f(Y.target.value),placeholder:"Enter location",className:Ke.inputField})]}),e.jsxs("div",{className:Ke.proposalModalFieldRow,children:[e.jsx("span",{className:Ke.fieldLabel,children:"Message to Opponent:"}),e.jsx("textarea",{value:m,onChange:Y=>v(Y.target.value),placeholder:"Message to opponent",rows:3,className:Ke.inputField})]}),S&&e.jsx("div",{className:Ke.errorBox,children:S}),e.jsxs("div",{className:Ke.proposalModalButtonRow,children:[e.jsx("button",{className:Ke.dashboardBtn,onClick:z,disabled:C,style:{width:"48%"},children:C?"Saving...":"Save Changes"}),e.jsx("button",{className:Ke.dashboardBtn,onClick:r,disabled:C,style:{width:"48%"},children:"Cancel"})]})]})});return yh.createPortal($,document.body)}const bW="_container_akfoi_3",vW="_header_akfoi_23",wW="_headerButtons_akfoi_57",jW="_newChatButton_akfoi_69",SW="_closeButton_akfoi_101",_W="_content_akfoi_133",kW="_conversationsList_akfoi_147",CW="_loading_akfoi_181",NW="_emptyState_akfoi_193",TW="_startChatButton_akfoi_215",PW="_conversationItems_akfoi_245",EW="_conversationItem_akfoi_245",RW="_active_akfoi_283",AW="_conversationInfo_akfoi_293",MW="_conversationName_akfoi_303",IW="_lastMessage_akfoi_321",DW="_conversationMeta_akfoi_345",$W="_timestamp_akfoi_361",LW="_unreadBadge_akfoi_379",BW="_messagesArea_akfoi_407",OW="_messagesHeader_akfoi_421",zW="_messagesList_akfoi_447",FW="_messageItem_akfoi_465",WW="_myMessage_akfoi_475",UW="_theirMessage_akfoi_483",qW="_messageBubble_akfoi_491",HW="_messageContent_akfoi_527",YW="_messageTime_akfoi_539",GW="_readStatus_akfoi_563",VW="_noConversation_akfoi_571",KW="_messageInput_akfoi_591",JW="_sendButton_akfoi_647",XW="_modalOverlay_akfoi_693",QW="_modalContent_akfoi_719",ZW="_modalHeader_akfoi_741",eU="_playerList_akfoi_769",tU="_playerItem_akfoi_781",rU="_selected_akfoi_807",nU="_playerName_akfoi_817",sU="_playerEmail_akfoi_829",aU="_modalActions_akfoi_847",oU="_cancelButton_akfoi_861",iU="_startButton_akfoi_893",lU="_error_akfoi_939",cU="_slideIn_akfoi_1",fr={container:bW,header:vW,headerButtons:wW,newChatButton:jW,closeButton:SW,content:_W,conversationsList:kW,loading:CW,emptyState:NW,startChatButton:TW,conversationItems:PW,conversationItem:EW,active:RW,conversationInfo:AW,conversationName:MW,lastMessage:IW,conversationMeta:DW,timestamp:$W,unreadBadge:LW,messagesArea:BW,messagesHeader:OW,messagesList:zW,messageItem:FW,myMessage:WW,theirMessage:UW,messageBubble:qW,messageContent:HW,messageTime:YW,readStatus:GW,noConversation:VW,messageInput:KW,sendButton:JW,modalOverlay:XW,modalContent:QW,modalHeader:ZW,playerList:eU,playerItem:tU,selected:rU,playerName:nU,playerEmail:sU,modalActions:aU,cancelButton:oU,startButton:iU,error:lU,slideIn:cU};console.log("DirectMessagingModal BACKEND_URL in use:",Ie);function dU({userName:n,userEmail:t,userPin:r,selectedDivision:s,opponentEmails:a=[],onClose:o}){console.log("Opponent Emails:",a);const[i,l]=y.useState([]),[c,d]=y.useState(null),[u,h]=y.useState([]),[p,g]=y.useState(""),[f,m]=y.useState(!1),[v,b]=y.useState(!1),[w,x]=y.useState(""),[j,S]=y.useState([]),[_,C]=y.useState(!1),[N,M]=y.useState(null),E=y.useRef(null);y.useEffect(()=>{async function R(){try{const z=await(await fetch(`${Ie}/api/users`)).json();Array.isArray(z)&&S(z.filter($=>$.email!==t))}catch(U){console.error("Failed to load players:",U)}}R()},[t]),y.useEffect(()=>{async function R(){m(!0);try{const z=await(await fetch(`${Ie}/api/messages/conversations?user=${encodeURIComponent(t)}`)).json();console.log("Conversations fetch data:",z),Array.isArray(z)&&l(z)}catch(U){console.error("Failed to load conversations:",U),x("Failed to load conversations")}finally{m(!1)}}R()},[t]),y.useEffect(()=>{if(!c){h([]);return}async function R(){try{const z=await(await fetch(`${Ie}/api/messages?user1=${encodeURIComponent(t)}&user2=${encodeURIComponent(c.email)}`)).json();Array.isArray(z)&&(h(z),z.forEach($=>{$.receiverEmail===t&&!$.read&&fetch(`${Ie}/api/messages/${$._id}/read`,{method:"PUT"})}))}catch(U){console.error("Failed to load messages:",U),x("Failed to load messages")}}R()},[c,t]),y.useEffect(()=>{E.current&&E.current.scrollIntoView({behavior:"smooth"})},[u]);const P=async()=>{if(!p.trim()||!c)return;b(!0),x("");let R=c.email;if(!R){const U=j.find(z=>z.name===c.name&&z.email);U&&(R=U.email)}if(console.log("Sending message to:",R),!R){x("No email found for selected opponent."),b(!1);return}try{const U=await fetch(`${Ie}/api/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderEmail:t,receiverEmail:R,content:p})});if(console.log("Send response:",U),!U.ok)throw new Error("Failed to send message");g("");const $=await(await fetch(`${Ie}/api/messages?user1=${encodeURIComponent(t)}&user2=${encodeURIComponent(R)}`)).json();Array.isArray($)&&h($)}catch(U){x(U.message||"Failed to send message")}finally{b(!1)}},D=async()=>{N&&(d(N),C(!1),M(null))},T=R=>R.unreadCount||0,A=R=>{const U=new Date(R),$=(new Date-U)/(1e3*60*60);return $<24?U.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):$<48?"Yesterday":U.toLocaleDateString()},k=j.filter(R=>a.length>0?a.includes(R.name):s?Array.isArray(R.divisions)?R.divisions.includes(s):typeof R.divisions=="string"?R.divisions.split(",").map(U=>U.trim()).includes(s):!1:!0).sort((R,U)=>{const z=`${R.name||""}`.trim().toLowerCase(),$=`${U.name||""}`.trim().toLowerCase();return z.localeCompare($)});return e.jsxs("div",{className:fr.container,children:[e.jsxs("div",{className:fr.header,children:[e.jsx("h2",{children:"Direct Messages"}),e.jsxs("div",{className:fr.headerButtons,children:[e.jsx("button",{className:fr.newChatButton,onClick:()=>C(!0),type:"button",children:" New Chat"}),e.jsx("button",{className:fr.closeButton,onClick:o,type:"button",children:""})]})]}),e.jsxs("div",{className:fr.content,children:[e.jsxs("div",{className:fr.conversationsList,children:[e.jsx("h3",{children:"Conversations"}),f?e.jsx("div",{className:fr.loading,children:"Loading conversations..."}):i.length===0?e.jsxs("div",{className:fr.emptyState,children:[e.jsx("p",{children:"No conversations yet"}),e.jsx("button",{className:fr.startChatButton,onClick:()=>C(!0),type:"button",children:"Start a conversation"})]}):e.jsx("div",{className:fr.conversationItems,children:i.map(R=>e.jsxs("div",{className:`${fr.conversationItem} ${(c==null?void 0:c.email)===R.email?fr.active:""}`,onClick:()=>d(R),children:[e.jsxs("div",{className:fr.conversationInfo,children:[e.jsx("div",{className:fr.conversationName,children:R.name||R.email}),e.jsx("div",{className:fr.lastMessage,children:R.lastMessage||"No messages yet"})]}),e.jsxs("div",{className:fr.conversationMeta,children:[e.jsx("div",{className:fr.timestamp,children:R.lastMessageTime?A(R.lastMessageTime):""}),T(R)>0&&e.jsx("div",{className:fr.unreadBadge,children:T(R)})]})]},R.email))})]}),e.jsx("div",{className:fr.messagesArea,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:fr.messagesHeader,children:e.jsxs("h3",{children:["Chat with ",c.name||c.email]})}),e.jsxs("div",{className:fr.messagesList,children:[u.map(R=>e.jsx("div",{className:`${fr.messageItem} ${R.senderEmail===t?fr.myMessage:fr.theirMessage}`,children:e.jsxs("div",{className:fr.messageBubble,children:[e.jsx("div",{className:fr.messageContent,children:R.content}),e.jsxs("div",{className:fr.messageTime,children:[A(R.timestamp),R.senderEmail===t&&e.jsx("span",{className:fr.readStatus,children:R.read?"":""})]})]})},R._id)),e.jsx("div",{ref:E})]}),e.jsxs("div",{className:fr.messageInput,children:[e.jsx("input",{type:"text",value:p,onChange:R=>g(R.target.value),onKeyDown:R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),P())},placeholder:"Type a message...",disabled:v}),e.jsx("button",{onClick:P,disabled:v||!p.trim(),className:fr.sendButton,type:"button",children:"Send"})]})]}):e.jsx("div",{className:fr.noConversation,children:e.jsx("p",{children:"Select a conversation to start messaging"})})})]}),_&&e.jsxs(It,{open:_,onClose:()=>{C(!1),M(null)},title:"Start New Conversation",maxWidth:"400px",children:[e.jsx("button",{style:{position:"absolute",top:10,right:10,background:"none",border:"none",color:"#fff",fontSize:24,cursor:"pointer",zIndex:10001},onClick:()=>{C(!1),M(null)},"aria-label":"Close",type:"button",children:""}),e.jsx("div",{className:fr.playerList,children:k.map(R=>e.jsx("div",{className:`${fr.playerItem} ${(N==null?void 0:N.email)===R.email?fr.selected:""}`,onClick:()=>M(R),children:e.jsx("div",{className:fr.playerName,children:R.name?R.name:R.email})},R._id||R.email))}),e.jsxs("div",{className:fr.modalActions,children:[e.jsx("button",{onClick:()=>{C(!1),M(null)},className:fr.cancelButton,type:"button",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:!N,className:fr.startButton,type:"button",children:"Start Chat"})]})]}),w&&e.jsx("div",{className:fr.error,children:w})]})}const uU="_customChannelHeader_1kvzt_1",hU="_customChannelHeaderRow_1kvzt_17",pU="_customChannelHeaderLeft_1kvzt_31",mU="_customChannelHeaderIcon_1kvzt_51",fU="_customChannelHeaderTitle_1kvzt_61",gU="_customChannelHeaderDate_1kvzt_71",xU="_customChannelHeaderOnline_1kvzt_83",yU="_customChannelHeaderOnlineLabel_1kvzt_97",bU="_customChannelHeaderNone_1kvzt_109",vU="_customChannelHeaderAvatar_1kvzt_119",ni={customChannelHeader:uU,customChannelHeaderRow:hU,customChannelHeaderLeft:pU,customChannelHeaderIcon:mU,customChannelHeaderTitle:fU,customChannelHeaderDate:gU,customChannelHeaderOnline:xU,customChannelHeaderOnlineLabel:yU,customChannelHeaderNone:bU,customChannelHeaderAvatar:vU};function wU(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function jU(n){if(!n)return"";const t=n.trim().split(" ");if(t.length===1){const r=t[0].split(/[^a-zA-Z0-9]/).filter(Boolean);return r.length>1?(r[0][0]+r[1][0]).toUpperCase():t[0].slice(0,2).toUpperCase()}return(t[0][0]+t[t.length-1][0]).toUpperCase()}function SU({channel:n,currentUser:t}){var i,l,c;const r=((i=n==null?void 0:n.data)==null?void 0:i.name)||(n==null?void 0:n.id)||"General Chat",s=(l=n==null?void 0:n.data)==null?void 0:l.matchDate,a=t==null?void 0:t.id,o=(c=n==null?void 0:n.state)!=null&&c.members?Object.values(n.state.members).filter(d=>{var u,h;return((u=d.user)==null?void 0:u.online)||((h=d.user)==null?void 0:h.id)===a}).map(d=>{var u,h;return((u=d.user)==null?void 0:u.name)||((h=d.user)==null?void 0:h.id)}).filter(Boolean):[(t==null?void 0:t.name)||(t==null?void 0:t.id)].filter(Boolean);return e.jsx("div",{className:ni.customChannelHeader,style:{width:"100%",margin:"0",borderRadius:"0",marginTop:"0",marginBottom:"0"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.8em",fontSize:"1.1em",textAlign:"center",width:"100%"},children:[e.jsx("span",{className:ni.customChannelHeaderIcon,children:""}),e.jsxs("span",{style:{textAlign:"center"},children:["You're in the"," ",e.jsxs("span",{className:ni.customChannelHeaderTitle,children:['"',r,'"']})," ","channel."]}),s&&e.jsxs("span",{className:ni.customChannelHeaderDate,children:["Match Date: ",wU(s)]})]}),e.jsxs("div",{className:ni.customChannelHeaderOnline,children:[e.jsx("span",{className:ni.customChannelHeaderOnlineLabel,children:"Online:"}),o.length===0&&e.jsx("span",{className:ni.customChannelHeaderNone,children:"No one online"}),o.map(d=>e.jsx("span",{className:ni.customChannelHeaderAvatar,title:d,children:jU(d)},d))]})]})})}const jC={async getUser(n){return Tn.get(`/api/users/${encodeURIComponent(n)}`)},async syncUsers(){return Tn.post("/admin/sync-users")}};class _U{async getCurrentSeason(t){try{const r=await fetch(`${Ie}/api/seasons/current/${encodeURIComponent(t)}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error fetching current season:",r),null}}async getCurrentPhaseAndWeek(t){try{const r=await fetch(`${Ie}/api/seasons/phase/${encodeURIComponent(t)}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error fetching current phase and week:",r),{currentWeek:null,phase:"offseason",isActive:!1,season:null}}}async getAllSeasons(t){try{const r=await fetch(`${Ie}/api/seasons/${encodeURIComponent(t)}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error fetching all seasons:",r),[]}}isMatchWithinPhase1Deadline(t,r){if(!r||!r.phase1End)return!0;const s=new Date(t),a=new Date(r.phase1End);return s<=a}getDaysUntilPhase1Deadline(t){if(!t||!t.phase1End)return null;const r=new Date,a=new Date(t.phase1End)-r;return Math.ceil(a/(1e3*60*60*24))}hasPhase1DeadlinePassed(t){if(!t||!t.phase1End)return!1;const r=new Date,s=new Date(t.phase1End);return r>s}hasPhase2Started(t){if(!t||!t.phase2Start)return!1;const r=new Date,s=new Date(t.phase2Start);return r>=s}getDaysUntilPhase2Deadline(t){if(!t||!t.phase2End)return null;const r=new Date,a=new Date(t.phase2End)-r;return Math.ceil(a/(1e3*60*60*24))}hasPhase2DeadlinePassed(t){if(!t||!t.phase2End)return!1;const r=new Date,s=new Date(t.phase2End);return r>s}getCurrentPhaseFromDates(t){if(!t)return"offseason";const r=new Date,s=new Date(t.phase1Start),a=new Date(t.phase1End),o=new Date(t.phase2Start),i=new Date(t.phase2End);return r<s?"offseason":r>=s&&r<=a?"scheduled":r>=o&&r<=i?"challenge":r>i?"completed":"transition"}}const zo=new _U;function kU({userName:n,userEmail:t,userPin:r,onClose:s,fromChat:a=!1}){const[o,i]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(""),[h,p]=y.useState("scheduled"),[g,f]=y.useState(!1),[m,v]=y.useState(!1),[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState(null),[C,N]=y.useState(null),[M,E]=y.useState([]),[P,D]=y.useState([]),[T,A]=y.useState(!1);y.useEffect(()=>{t&&jC.getUser(t).then(Y=>{let Q=[];Array.isArray(Y.divisions)?Q=Y.divisions.map(H=>H.trim()).filter(Boolean):typeof Y.divisions=="string"?Q=Y.divisions.split(",").map(H=>H.trim()).filter(Boolean):Q=[],i(Q),c(!1)}).catch(()=>{i([]),c(!1)})},[t]);const k=async Y=>{A(!0);try{const Q=`schedule_${Y.replace(/[^A-Za-z0-9]/g,"_")}.json`,H=Date.now(),ue=`${Ie}/static/${Q}?t=${H}`,J=await fetch(ue,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!J.ok)throw new Error("Schedule not found");const be=await J.json();E(be);const Ae=await fetch(`${Ie}/api/users/search?approved=true&division=${encodeURIComponent(Y)}`,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!Ae.ok)throw new Error("Players not found");const O=await Ae.json();D(O.users||[])}catch(Q){console.error("Failed to load schedule data:",Q),E([]),D([])}finally{A(!1)}},R=async Y=>{u(Y);try{const Q=await zo.getCurrentPhaseAndWeek(Y),H=(Q==null?void 0:Q.phase)||"scheduled";p(H),H==="scheduled"||H==="offseason"?(await k(Y),f(!0)):v(!0)}catch(Q){console.error("Error fetching phase data:",Q),v(!0)}},U=()=>{if(!M.length||!P.length||!d)return[];const Y=`${n}`,Q=[];for(const J of M)if(J.player1&&J.player2&&!J.scheduled){const be=J.player1.trim(),Ae=J.player2.trim();(be.toLowerCase()===Y.toLowerCase()||Ae.toLowerCase()===Y.toLowerCase())&&Q.push(J)}const H=P.filter(J=>J.divisions&&J.divisions.includes(d));return Q.map(J=>{var O,oe;const be=J.player1&&J.player1.trim().toLowerCase()===Y.toLowerCase()?(O=J.player2)==null?void 0:O.trim():(oe=J.player1)==null?void 0:oe.trim();if(!be)return null;const Ae=H.find(me=>me.name&&me.name.trim().toLowerCase()===be.toLowerCase());return{match:J,player:Ae,opponentName:be}}).filter(Boolean)},z=async Y=>{const H=P.filter(ue=>ue.divisions&&ue.divisions.includes(d)).find(ue=>ue.name&&ue.name.trim().toLowerCase()===Y.trim().toLowerCase());if(!H){alert("Player data not found for: "+Y);return}if(!H.email){alert("This opponent does not have an email on file and cannot be proposed a match.");return}if(a){try{const ue=await fetch(`${Ie}/api/users/search?approved=true`);if(!ue.ok)throw new Error("Failed to fetch players from database");const be=(await ue.json()).users.find(Ae=>`${Ae.firstName} ${Ae.lastName}`.trim().toLowerCase()===Y.trim().toLowerCase());if(be){const Ae=typeof be.availability=="string"?Cx(be.availability):be.availability,O={...be,availability:Ae};_(O)}else _(H)}catch(ue){console.error("Error fetching detailed player data:",ue),_(H)}f(!1),w(!0)}else f(!1),v(!0)},$=(Y,Q,H,ue)=>{N({day:Y,slot:Q,phase:H,division:ue,opponent:S}),w(!1),j(!0)},W=()=>{f(!1),v(!1),w(!1),j(!1),_(null),N(null),u(""),s()};return l?e.jsx(It,{open:!0,onClose:s,title:"Loading Divisions...",maxWidth:"500px",children:e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx("p",{children:"Please wait while we load your divisions..."})})}):o.length===0?e.jsx(It,{open:!0,onClose:s,title:"No Divisions Found",maxWidth:"500px",children:e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("p",{children:"You are not registered for any divisions. Please contact an administrator."}),e.jsx("button",{onClick:s,style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"8px",padding:"0.8rem 1.5rem",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",marginTop:"1rem"},onMouseEnter:Y=>{Y.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",Y.target.style.transform="translateY(-2px)",Y.target.style.boxShadow="0 4px 12px rgba(229, 62, 62, 0.3)"},onMouseLeave:Y=>{Y.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",Y.target.style.transform="translateY(0)",Y.target.style.boxShadow="none"},children:"Close"})]})}):e.jsxs(e.Fragment,{children:[!g&&!m&&e.jsx(It,{open:!0,onClose:s,title:"Select Division",maxWidth:"500px",children:e.jsxs("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("p",{style:{color:"#fff",textAlign:"center",marginBottom:"1.5rem",fontSize:"1rem"},children:"Choose a division to schedule a match:"}),e.jsx("div",{style:{display:"grid",gap:"12px"},children:o.map(Y=>e.jsxs("button",{onClick:()=>R(Y),style:{background:"linear-gradient(135deg, #232323 0%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"8px",padding:"1rem 1.5rem",fontSize:"1.1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",textAlign:"left",display:"flex",alignItems:"center",gap:"0.5rem"},onMouseEnter:Q=>{Q.target.style.background="linear-gradient(135deg, #e53e3e 0%, #c00 100%)",Q.target.style.transform="translateY(-2px)",Q.target.style.boxShadow="0 4px 12px rgba(229, 62, 62, 0.3)"},onMouseLeave:Q=>{Q.target.style.background="linear-gradient(135deg, #232323 0%, #2a0909 100%)",Q.target.style.transform="translateY(0)",Q.target.style.boxShadow="none"},children:[" ",Y]},Y))})]})}),g&&(T?e.jsx(It,{open:!0,onClose:W,title:"Loading Opponents...",maxWidth:"500px",children:e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx("p",{children:"Please wait while we load your scheduled opponents..."})})}):e.jsx(Ak,{open:g,onClose:W,opponents:U(),onOpponentClick:z,phase:h})),m&&e.jsx(Lx,{onClose:W,excludeName:n,senderName:n,senderEmail:t,onProposalComplete:()=>{W()},selectedDivision:d,phase:h}),b&&S&&e.jsx(mf,{open:b,onClose:W,player:S,senderName:n,senderEmail:t,selectedDivision:d,onProposeMatch:$,phase:h}),x&&C&&e.jsx(_f,{open:x,onClose:W,player:C.opponent,day:C.day,slot:C.slot,senderName:n,senderEmail:t,selectedDivision:C.division,phase:C.phase,onProposalComplete:()=>{W()}})]})}const CU="_outerChatBg_whq3p_29",NU="_chatContainer_whq3p_85",TU="_topNavBar_whq3p_125",PU="_chatGreeting_whq3p_169",EU="_buttonRow_whq3p_193",RU="_topChatButton_whq3p_207",AU="_logoutWithTimer_whq3p_297",MU="_timerBox_whq3p_311",IU="_sectionHeader_whq3p_339",DU="_collapsed_whq3p_421",$U="_sectionContent_whq3p_455",LU="_expanded_whq3p_485",BU="_channelListRow_whq3p_499",OU="_announcements_whq3p_499",zU="_divisions_whq3p_509",FU="_gameButton_whq3p_561",WU="_mainChatArea_whq3p_597",UU="_mainChatWindow_whq3p_615",qU="_poolBackground_whq3p_675",HU="_chatContent_whq3p_749",YU="_sidebar_whq3p_763",GU="_hamburgerButton_whq3p_817",VU="_hamburgerIcon_whq3p_865",KU="_sidebarBackdrop_whq3p_875",JU="_closeSidebarButton_whq3p_901",XU="_mobileNavButtons_whq3p_949",QU="_mobileNavButton_whq3p_949",ZU="_mobileTimerBox_whq3p_1011",eq="_generalChannelRow_whq3p_1037",tq="_active_whq3p_1129",rq="_pulse_whq3p_1",nq="_channelListName_whq3p_1183",sq="_pinIcon_whq3p_1225",aq="_channelIcon_whq3p_1247",oq="_pinned_whq3p_1273",iq="_noPinnedChannels_whq3p_1283",lq="_noChannelsFound_whq3p_1285",cq="_sidebarSearch_whq3p_1307",dq="_channelListWrapper_whq3p_1387",uq="_customMessageUi_whq3p_1431",hq="_onlineDot_whq3p_1469",pq="_online_whq3p_1469",mq="_messageContent_whq3p_1525",fq="_messageUsername_whq3p_1543",gq="_messageText_whq3p_1563",xq="_loadingContainer_whq3p_1583",yq="_spinner_whq3p_1597",bq="_spin_whq3p_1597",vq="_open_whq3p_1739",wq="_messagesArea_whq3p_1981",jq="_messageInputContainer_whq3p_1989",Sq="_messageInput_whq3p_1989",_q="_sendButton_whq3p_2011",kq="_messageItem_whq3p_2151",Cq="_messageItemLeft_whq3p_2797",Nq="_messageItemRight_whq3p_2807",Tq="_messageListBackground_whq3p_2821",Pq="_poolTableImg_whq3p_2851",Eq="_poolTableSvg_whq3p_2853",Rq="_channelNamePreview_whq3p_2881",Aq="_messageHeader_whq3p_3825",Mq="_messageAuthor_whq3p_3839",Iq="_messageTime_whq3p_3853",Dq="_chatHeader_whq3p_4091",$q="_chatMessages_whq3p_4101",Lq="_message_whq3p_1525",Bq="_sent_whq3p_4207",Oq="_received_whq3p_4219",zq="_messageSender_whq3p_4273",Fq="_sending_whq3p_4797",Wq="_error_whq3p_4813",Uq="_typingIndicator_whq3p_4825",qq="_messageGroup_whq3p_4847",Hq="_scrollToBottom_whq3p_4925",nr={outerChatBg:CU,chatContainer:NU,topNavBar:TU,chatGreeting:PU,buttonRow:EU,topChatButton:RU,logoutWithTimer:AU,timerBox:MU,sectionHeader:IU,collapsed:DU,sectionContent:$U,expanded:LU,channelListRow:BU,announcements:OU,divisions:zU,"game-rooms":"_game-rooms_whq3p_519",gameButton:FU,mainChatArea:WU,mainChatWindow:UU,poolBackground:qU,chatContent:HU,sidebar:YU,hamburgerButton:GU,hamburgerIcon:VU,sidebarBackdrop:KU,closeSidebarButton:JU,mobileNavButtons:XU,mobileNavButton:QU,mobileTimerBox:ZU,generalChannelRow:eq,active:tq,pulse:rq,channelListName:nq,pinIcon:sq,channelIcon:aq,pinned:oq,noPinnedChannels:iq,noChannelsFound:lq,sidebarSearch:cq,channelListWrapper:dq,customMessageUi:uq,onlineDot:hq,online:pq,messageContent:mq,messageUsername:fq,messageText:gq,loadingContainer:xq,spinner:yq,spin:bq,"str-chat__send-button":"_str-chat__send-button_whq3p_1629",open:vq,messagesArea:wq,messageInputContainer:jq,messageInput:Sq,sendButton:_q,messageItem:kq,messageItemLeft:Cq,messageItemRight:Nq,messageListBackground:Tq,poolTableImg:Pq,poolTableSvg:Eq,"str-chat__main-panel":"_str-chat__main-panel_whq3p_2869",channelNamePreview:Rq,"str-chat":"_str-chat_whq3p_1629","str-chat__container":"_str-chat__container_whq3p_2933","str-chat__messenger":"_str-chat__messenger_whq3p_2943","str-chat__messenger--main":"_str-chat__messenger--main_whq3p_2953","str-chat__messenger--main-panel":"_str-chat__messenger--main-panel_whq3p_2963","str-chat__messenger--main-panel-inner":"_str-chat__messenger--main-panel-inner_whq3p_2973","str-chat__messenger--main-panel-inner-content":"_str-chat__messenger--main-panel-inner-content_whq3p_2983","str-chat__messenger--main-panel-inner-content-inner":"_str-chat__messenger--main-panel-inner-content-inner_whq3p_2993","str-chat__messenger--main-panel-inner-content-inner-inner":"_str-chat__messenger--main-panel-inner-content-inner-inner_whq3p_3003","str-chat__message-list":"_str-chat__message-list_whq3p_3015","str-chat__input-flat--wrapper":"_str-chat__input-flat--wrapper_whq3p_3025","str-chat__input-flat":"_str-chat__input-flat_whq3p_3025","str-chat__channel-header":"_str-chat__channel-header_whq3p_3047","str-chat__thread":"_str-chat__thread_whq3p_3059","str-chat__window":"_str-chat__window_whq3p_3071","str-chat__channel":"_str-chat__channel_whq3p_3047","str-chat__message":"_str-chat__message_whq3p_3015","str-chat__message-text":"_str-chat__message-text_whq3p_3145","str-chat__message-author":"_str-chat__message-author_whq3p_3159","str-chat__message-timestamp":"_str-chat__message-timestamp_whq3p_3175","str-chat__channel-header-title":"_str-chat__channel-header-title_whq3p_3323","str-chat__channel-header-info":"_str-chat__channel-header-info_whq3p_3345","str-chat__thread-header":"_str-chat__thread-header_whq3p_3365","str-chat__thread-start":"_str-chat__thread-start_whq3p_3377","str-chat__typing-indicator":"_str-chat__typing-indicator_whq3p_3397","str-chat__avatar":"_str-chat__avatar_whq3p_3415","str-chat__avatar-fallback":"_str-chat__avatar-fallback_whq3p_3425","str-chat__channel-list":"_str-chat__channel-list_whq3p_3459","str-chat__channel-list-messenger":"_str-chat__channel-list-messenger_whq3p_3469","str-chat__channel-preview-messenger":"_str-chat__channel-preview-messenger_whq3p_3477","str-chat__channel-preview-messenger--active":"_str-chat__channel-preview-messenger--active_whq3p_3505","str-chat__channel-preview-messenger--title":"_str-chat__channel-preview-messenger--title_whq3p_3517","str-chat__channel-preview-messenger--subtitle":"_str-chat__channel-preview-messenger--subtitle_whq3p_3529",messageHeader:Aq,messageAuthor:Mq,messageTime:Iq,chatHeader:Dq,chatMessages:$q,message:Lq,sent:Bq,received:Oq,messageSender:zq,sending:Fq,error:Wq,typingIndicator:Uq,messageGroup:qq,scrollToBottom:Hq},ch={}.VITE_STREAM_API_KEY||"nbvut8j4y6se";console.log(" Stream Chat API Key:",ch);console.log(" Environment variables:",{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1});ch?console.log(" VITE_STREAM_API_KEY is set:",ch):(console.error(" VITE_STREAM_API_KEY is not set!"),console.error(" Please check your .env file in the FrontEnd directory"));const Yq=Ie,Uj="general",Gq="announcements";let ip=!1;const Vq=["FRBCAPL TEST","Singles Test"],qj={GENERAL:"general",DIVISIONS:"divisions",ANNOUNCEMENTS:"announcements",GAME_ROOMS:"game-rooms"};function Hj(n){return n.toLowerCase().replace(/[^a-z0-9_-]/g,"")}const Kq=({channel:n})=>{var t;return e.jsx("div",{className:nr.channelNamePreview,children:((t=n.data)==null?void 0:t.name)||n.id})};function Jq(){return JSON.parse(localStorage.getItem("pinnedChannels")||"[]")}function Xq(n){localStorage.setItem("pinnedChannels",JSON.stringify(n))}const Qq=({pinned:n,onClick:t})=>e.jsx("span",{onClick:t,className:`${nr.pinIcon}${n?" "+nr.pinned:""}`,title:n?"Unpin channel":"Pin channel",children:n?"":""}),Bg=({children:n,icon:t,sectionKey:r,isCollapsed:s,onToggle:a})=>e.jsxs("div",{className:`${nr.sectionHeader} ${s?nr.collapsed:""}`,onClick:()=>a(r),children:[t&&e.jsx("span",{style:{marginRight:"8px"},children:t}),n]});function SC({userName:n,userEmail:t,userPin:r,channelId:s,onClose:a}){var Ae;const o=yn(),[i,l]=y.useState(!1),[c,d]=y.useState(null),[u,h]=y.useState(null),[p,g]=y.useState(null),[f,m]=y.useState({}),[v,b]=y.useState([]),[w,x]=y.useState(null),[j,S]=y.useState(Jq());y.useState(!1);const[_,C]=y.useState(!1),[N,M]=y.useState(1800),[E,P]=y.useState(""),[D,T]=y.useState([]),[A,k]=y.useState(""),[R,U]=y.useState(!0),[z,$]=y.useState({announcements:!1,divisions:!1,gameRooms:!1});y.useEffect(()=>{if(N<=0){W();return}const O=setInterval(()=>{M(oe=>oe-1)},1e3);return()=>clearInterval(O)},[N]),y.useEffect(()=>{if(ip)return;ip=!0;let O=Sf.getInstance(ch);console.log(" Using API key for Stream Chat client:",ch);let oe=!1,me=!0;async function Ce(){var ve,De,Oe,Ze;try{if(O.userID)try{await O.disconnectUser()}catch{}await new Promise(ne=>setTimeout(ne,300));const et=Hj(t),re=await fetch(`${Yq}/token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:et})}),{token:je,userId:V}=await re.json();if(await O.connectUser({id:V,name:n,email:t},je),oe=!0,!me)return;d(O);const Ee=O.channel("messaging",Uj,{name:"General Chat",description:"General discussion for all players"});let F=0,ae=!1;for(;F<3&&!ae;)try{await Ee.watch({limit:100}),ae=!0,console.log("Successfully loaded general channel with",((ve=Ee.state.messages)==null?void 0:ve.length)||0,"messages")}catch(ne){F++,console.log(`Retry ${F} for general channel:`,ne.message),F>=3?(console.error("Failed to load general channel after 3 retries, but continuing..."),ae=!0):await new Promise(ye=>setTimeout(ye,1e3))}const I=O.channel("messaging",Gq,{name:" Announcements",description:"Important announcements and updates"});try{await I.watch({limit:100}),console.log("Successfully loaded announcements channel with",((De=I.state.messages)==null?void 0:De.length)||0,"messages")}catch(ne){console.error("Error loading announcements channel:",ne)}const X={};for(const ne of Vq){const ye=Hj(ne),ot=O.channel("messaging",`division-${ye}`,{name:` ${ne}`,description:`Discussion for ${ne} players`,category:qj.DIVISIONS});try{await ot.watch({limit:100}),X[ne]=ot,console.log(`Successfully loaded division channel ${ne} with`,((Oe=ot.state.messages)==null?void 0:Oe.length)||0,"messages")}catch(lt){console.error(`Error loading division channel ${ne}:`,lt),X[ne]=ot}}const fe=[];for(let ne=1;ne<=5;ne++){const ye=`game-room-${ne}`,ot=O.channel("messaging",ye,{name:` Game Room ${ne}`,description:`Multiplayer game room ${ne} - for future online play`,category:qj.GAME_ROOMS});try{await ot.watch({limit:100}),fe.push(ot),console.log(`Successfully loaded game room ${ne} with`,((Ze=ot.state.messages)==null?void 0:Ze.length)||0,"messages")}catch(lt){console.error(`Error loading game room ${ne}:`,lt),fe.push(ot)}}me&&(console.log("Setting channels:",{general:Ee,announcements:I,divisions:Object.keys(X),gameRooms:fe.length}),h(Ee),g(I),m(X),b(fe),setTimeout(()=>{me&&(console.log("Setting general channel as active"),x(Ee),U(!1))},100))}catch(et){console.error("Error initializing chat:",et),me&&U(!1)}finally{ip=!1}}return Ce(),()=>{if(me=!1,O&&oe)try{O.disconnectUser()}catch{}ip=!1}},[t,n]),y.useEffect(()=>{Xq(j)},[j]),y.useEffect(()=>{var O;if(w){console.log("Channel changed to:",w.id,((O=w.state.messages)==null?void 0:O.length)||0,"messages");const oe=w.state.messages||[];T(oe);const me=ve=>{console.log("New message received in channel:",w.id);const De=w.state.messages||[];T([...De])},Ce=()=>{console.log("Channel state updated:",w.id);const ve=w.state.messages||[];T([...ve])};return w.on("message.new",me),w.on("message.updated",Ce),w.on("message.deleted",Ce),()=>{w.off("message.new",me),w.off("message.updated",Ce),w.off("message.deleted",Ce)}}else u&&!w?(console.log("Fallback: setting general channel"),x(u)):T([])},[w,u]);function W(){c&&c.disconnectUser(),localStorage.clear(),a?a():(o("/"),window.location.reload())}function Y(){C(!0)}const Q=async()=>{if(A.trim()&&w)try{const O=await w.sendMessage({text:A});k("")}catch(O){console.error("Error sending message:",O)}},H=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),Q())};if(R)return e.jsxs("div",{className:nr.loadingContainer,children:[e.jsx("div",{className:nr.spinner}),e.jsx("div",{children:"Loading chat...Please wait"})]});(Ae=c==null?void 0:c.user)==null||Ae.id;const ue=Math.floor(N/60),J=N%60,be=(O,oe=null)=>!O||!O.cid?null:e.jsxs("div",{className:`${nr.channelListRow} ${oe?nr[oe]:""} ${(w==null?void 0:w.id)===O.id?nr.active:""}`,onClick:()=>{x(O),l(!1)},children:[e.jsx("div",{className:nr.channelListName,children:e.jsx(Kq,{channel:O})}),e.jsx(Qq,{pinned:j.includes(O.id),onClick:me=>{me.stopPropagation();let Ce;j.includes(O.id)?Ce=j.filter(ve=>ve!==O.id):Ce=[...j,O.id],S(Ce)}})]},O.cid);return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:[e.jsxs("div",{style:{background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"1rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:"90vw",maxWidth:"1000px",height:"80vh",maxHeight:"600px",display:"flex",flexDirection:"column",position:"relative"},children:[e.jsx("button",{className:nr.hamburgerButton,onClick:()=>l(!0),"aria-label":"Open channel list",children:e.jsx("span",{className:nr.hamburgerIcon,children:""})}),i&&e.jsx("div",{className:nr.sidebarBackdrop,onClick:()=>l(!1)}),e.jsxs("div",{style:{padding:"1rem",borderBottom:"2px solid #e53e3e",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[e.jsxs("h2",{style:{margin:0,color:"#fff",fontSize:"1.5rem",fontWeight:"bold"},children:["League Chat - ",n]}),e.jsx("button",{onClick:a||(()=>o("/")),style:{position:"absolute",right:"1rem",background:"none",border:"none",color:"#fff",fontSize:"2rem",cursor:"pointer",padding:"0.5rem"},children:""})]}),e.jsxs("div",{style:{flex:1,display:"flex",minHeight:0},children:[e.jsxs("div",{style:{width:"250px",backgroundColor:"linear-gradient(180deg, #1a1a1a 0%, #2a2a2a 100%)",borderRight:"2px solid #e53e3e",overflowY:"auto",padding:"1rem",boxShadow:"inset -2px 0 8px rgba(0,0,0,0.3)"},children:[e.jsx("button",{className:nr.closeSidebarButton,onClick:()=>l(!1),"aria-label":"Close channel list",children:""}),e.jsxs("div",{className:nr.mobileNavButtons,children:[e.jsx("button",{className:nr.mobileNavButton,onClick:()=>{a?a():(o("/"),window.location.reload()),l(!1)},children:" Dashboard"}),e.jsx("button",{className:nr.mobileNavButton,onClick:()=>{Y(),l(!1)},children:" Schedule a Match"}),e.jsx("button",{className:nr.mobileNavButton,onClick:()=>{W(),l(!1)},children:" Logout"}),e.jsxs("div",{className:nr.mobileTimerBox,children:["Auto Logout: ",ue,":",J.toString().padStart(2,"0")]})]}),e.jsxs("div",{className:`${nr.generalChannelRow}${(w==null?void 0:w.id)===Uj||w===u?" "+nr.active:""}`,onClick:()=>{x(u),l(!1)},children:[e.jsx("span",{style:{marginRight:8},children:"#"})," General Chat"]}),e.jsx("div",{className:nr.sidebarSearch,children:e.jsx("input",{type:"text",placeholder:"Search channels...",value:E,onChange:O=>P(O.target.value)})}),e.jsxs("div",{className:nr.channelListWrapper,children:[e.jsx(Bg,{icon:"",sectionKey:"announcements",isCollapsed:z.announcements,onToggle:O=>$(oe=>({...oe,[O]:!oe[O]})),children:"Announcements"}),e.jsx("div",{className:`${nr.sectionContent} ${z.announcements?nr.collapsed:nr.expanded}`,children:p?be(p,"announcements"):e.jsx("div",{style:{padding:"8px",color:"#888",fontStyle:"italic"},children:"No announcements channel available"})}),e.jsx(Bg,{icon:"",sectionKey:"divisions",isCollapsed:z.divisions,onToggle:O=>$(oe=>({...oe,[O]:!oe[O]})),children:"Division Channels"}),e.jsx("div",{className:`${nr.sectionContent} ${z.divisions?nr.collapsed:nr.expanded}`,children:Object.values(f).length>0?Object.values(f).map(O=>be(O,"divisions")):e.jsx("div",{style:{padding:"8px",color:"#888",fontStyle:"italic"},children:"No division channels available"})}),e.jsx(Bg,{icon:"",sectionKey:"gameRooms",isCollapsed:z.gameRooms,onToggle:O=>$(oe=>({...oe,[O]:!oe[O]})),children:"Game Rooms"}),e.jsx("div",{className:`${nr.sectionContent} ${z.gameRooms?nr.collapsed:nr.expanded}`,children:v.length>0?v.map(O=>be(O,"game-rooms")):e.jsx("div",{style:{padding:"8px",color:"#888",fontStyle:"italic"},children:"No game room channels available"})}),e.jsxs("div",{className:`${nr.channelListRow} ${nr.gameButton}`,onClick:()=>{o("/tenball"),l(!1)},children:[e.jsx("span",{style:{marginRight:8},children:""}),"Play Pool Game"]})]})]}),e.jsxs("div",{className:nr.mainChatWindow,style:{flex:1,display:"flex",flexDirection:"column",position:"relative"},children:[e.jsx("div",{className:nr.poolBackground,children:e.jsx(Zu,{})}),e.jsx(SU,{channel:w,currentUser:c==null?void 0:c.user}),e.jsx("div",{className:nr.messagesArea,style:{flex:1,overflowY:"auto",paddingBottom:"80px"},children:D.map(O=>{var ve,De,Oe,Ze;const oe=(ve=O.user)==null?void 0:ve.id,me=(De=c==null?void 0:c.user)==null?void 0:De.id;let Ce=oe===me;if(!Ce&&oe&&me){const et=oe.split("_")[0];Ce=me.startsWith(et)}return e.jsxs("div",{className:`${nr.messageItem} ${Ce?nr.messageItemRight:nr.messageItemLeft}`,children:[e.jsxs("div",{className:nr.messageHeader,children:[e.jsx("span",{className:nr.messageAuthor,children:((Oe=O.user)==null?void 0:Oe.name)||((Ze=O.user)==null?void 0:Ze.id)}),e.jsx("span",{className:nr.messageTime,children:new Date(O.created_at).toLocaleTimeString()})]}),e.jsx("div",{className:nr.messageText,children:O.text})]},O.id)})}),e.jsxs("div",{className:nr.messageInputContainer,style:{position:"absolute",bottom:0,left:0,right:0,zIndex:10},children:[e.jsx("input",{type:"text",value:A,onChange:O=>k(O.target.value),onKeyPress:H,placeholder:"Type your message...",className:nr.messageInput}),e.jsx("button",{onClick:Q,className:nr.sendButton,disabled:!A.trim(),children:" Send"})]})]})]})]}),_&&e.jsx(kU,{userName:n,userEmail:t,userPin:r,onClose:()=>C(!1),fromChat:!0})]})}const Zq=({isMobile:n})=>e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.75)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:n?"12px":"16px",padding:n?"8px":"16px",margin:n?"-15px 0 0 0":"13px auto",width:n?"100%":"90%",maxWidth:n?"none":"1200px",boxShadow:"0 4px 16px rgba(0,0,0,0.3)",backdropFilter:"blur(4px)",height:n?"350px":"400px",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"relative",textAlign:"center",marginBottom:n?"0px":"4px",padding:n?"2px":"4px",borderRadius:"8px",background:"rgba(0, 0, 0, 0.6)",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",minHeight:n?"2.5rem":"3rem"},children:[e.jsx("div",{style:{display:"inline-block",width:n?"80px":"100px",height:n?"24px":"32px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"6px",animation:"shimmer 1.5s infinite",margin:"8px"}}),e.jsx("div",{style:{display:"inline-block",width:n?"60px":"80px",height:n?"20px":"28px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"6px",animation:"shimmer 1.5s infinite",margin:"8px"}})]}),e.jsx("div",{style:{width:n?"200px":"300px",height:n?"16px":"20px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"4px",animation:"shimmer 1.5s infinite",margin:"8px auto"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",marginTop:n?"20px":"30px",gap:n?"10px":"20px"},children:[e.jsx("div",{style:{width:n?"100px":"140px",height:n?"80px":"120px",background:"linear-gradient(90deg, rgba(0,255,0,0.1) 25%, rgba(0,255,0,0.2) 50%, rgba(0,255,0,0.1) 75%)",borderRadius:"12px",animation:"shimmer 1.5s infinite",border:"2px solid rgba(0,255,0,0.3)"}}),e.jsx("div",{style:{width:n?"80px":"140px",height:n?"60px":"100px",background:"linear-gradient(90deg, rgba(52,152,219,0.1) 25%, rgba(52,152,219,0.2) 50%, rgba(52,152,219,0.1) 75%)",borderRadius:"12px",animation:"shimmer 1.5s infinite",border:"2px solid rgba(52,152,219,0.3)"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"stretch",marginTop:n?"20px":"30px",gap:n?"6px":"12px",padding:n?"6px":"8px",borderRadius:"8px",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255,255,255,0.15)"},children:[e.jsx("div",{style:{flex:1,height:n?"70px":"80px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"8px",animation:"shimmer 1.5s infinite"}}),e.jsx("div",{style:{flex:1,height:n?"70px":"80px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"8px",animation:"shimmer 1.5s infinite"}}),e.jsx("div",{style:{flex:1,height:n?"70px":"80px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"8px",animation:"shimmer 1.5s infinite"}})]}),e.jsxs("div",{style:{display:"flex",gap:n?"8px":"12px",marginTop:n?"10px":"15px"},children:[e.jsx("div",{style:{flex:n?"0 0 140px":"0 0 200px",height:n?"80px":"100px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"8px",animation:"shimmer 1.5s infinite"}}),e.jsx("div",{style:{flex:1,height:n?"80px":"100px",background:"linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%)",borderRadius:"8px",animation:"shimmer 1.5s infinite"}})]}),e.jsx("style",{children:`
        @keyframes shimmer {
          0% {
            background-position: -200px 0;
          }
          100% {
            background-position: calc(200px + 100%) 0;
          }
        }
      `})]});function Og(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-");return`${i}-${l}-${o}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}const _C=({currentPhase:n,seasonData:t,completedMatches:r,totalRequiredMatches:s,playerName:a,playerLastName:o,selectedDivision:i,onOpenOpponentsModal:l,onOpenCompletedMatchesModal:c,onOpenStandingsModal:d,onOpenAllMatchesModal:u,pendingCount:h,sentCount:p,onOpenProposalListModal:g,onOpenSentProposalListModal:f,upcomingMatches:m,onMatchClick:v,isMobile:b,onOpenMessageCenter:w,currentUser:x,allPlayers:j,onSmartMatchClick:S,showPhase1Rules:_,setShowPhase1Rules:C,showPhase1Overview:N,setShowPhase1Overview:M,setPlayerStats:E,setTimeLeft:P,setDeadlineStatus:D,setPhase1EndDate:T,onOpenCalendar:A})=>{const k=()=>!a||!o?(console.warn("Phase1Tracker: Missing player name information"),!1):i?!r||!Array.isArray(r)?(console.warn("Phase1Tracker: Invalid completedMatches prop"),!1):typeof s!="number"||s<=0?(console.warn("Phase1Tracker: Invalid totalRequiredMatches prop"),!1):!0:(console.warn("Phase1Tracker: Missing selected division"),!1);y.useEffect(()=>{k()},[a,o,i,r,s]);const[R,U]=y.useState(null),[z,$]=y.useState([]),[W,Y]=y.useState(!1),[Q,H]=y.useState(!0);y.useState(new Date),y.useState(null);const[ue,J]=y.useState(null),[be,Ae]=y.useState("normal"),[O,oe]=y.useState(null),[me,Ce]=y.useState(null);y.useEffect(()=>{if(!i||n!=="scheduled"){J(null),P(null);return}const F=async()=>{try{const I=i.replace(/[^A-Za-z0-9]/g,"_"),X=Date.now(),fe=`${Ie}/static/schedule_${I}.json?t=${X}`,ne=await fetch(fe,{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!ne.ok){console.warn(`Failed to fetch schedule: ${ne.status} - ${ne.statusText}`);return}const ye=await ne.json();if(!Array.isArray(ye)||ye.length===0){console.warn("No schedule data available");return}const ot=ye.filter(ht=>ht.date).sort((ht,Je)=>new Date(ht.date)-new Date(Je.date));if(ot.length===0){console.warn("No valid matches found in schedule");return}const lt=Math.min(47,ot.length-1),tt=ot[lt];if(!tt||!tt.date){console.warn("Could not determine Phase 1 end date from schedule");return}const ge=new Date(tt.date);ge.setHours(23,59,59,999),oe(ge),T(ge);const xt=new Date;if(Vo(xt,ge)){const ht={days:0,hours:0,passed:!0};J(ht),P(ht),Ae("passed"),D("passed")}else{const ht=fA(ge,xt),Je=bA(ge,xt)%24,Pe={days:ht,hours:Je,passed:!1};J(Pe),P(Pe),ht<=0&&Je<=24?(Ae("critical"),D("critical")):ht<=2?(Ae("urgent"),D("urgent")):ht<=7?(Ae("warning"),D("warning")):(Ae("normal"),D("normal"))}}catch(I){console.error("Error calculating Phase 1 deadline from schedule:",I)}};F();const ae=setInterval(F,6e4);return()=>clearInterval(ae)},[i,n]),y.useEffect(()=>{n==="scheduled"&&i&&r&&(Oe(),Ze())},[n,i,r,s,z]),y.useEffect(()=>{i&&n==="scheduled"&&ve()},[i,n]);const ve=async()=>{try{if(Y(!0),!i){console.warn("No division selected for standings");return}const F=i.replace(/[^A-Za-z0-9]/g,"_"),ae=`${Ie}/static/standings_${F}.json`,I=await fetch(ae);if(!I.ok){console.warn(`Failed to fetch standings: ${I.status} - ${I.statusText}`);return}const X=await I.json();if(!Array.isArray(X)){console.error("Standings data is not an array:",X);return}const fe=X.filter(ne=>{if(!ne||typeof ne!="object")return console.warn("Invalid standings entry:",ne),!1;if(!ne.name||!ne.rank)return console.warn("Standings entry missing name or rank:",ne),!1;const ye=parseInt(ne.rank);return isNaN(ye)||ye<=0?(console.warn("Invalid rank in standings entry:",ne),!1):!0});$(fe)}catch(F){console.error("Failed to load standings:",F)}finally{Y(!1)}},De=(F,ae)=>{if(!F||F.length===0)return null;const I=ae.toLowerCase().trim(),X=F.find(fe=>fe.name.toLowerCase().trim()===I);return X?parseInt(X.rank):null},Oe=()=>{const F=r.length,ae=s-F,I={completedCount:F,remainingCount:ae,deadlinePassed:zo.hasPhase1DeadlinePassed(t)};U(I)},Ze=()=>{let F=0,ae=0;const I=`${a} ${o}`;r&&r.length>0&&r.forEach(ot=>{ot.winner===I?F++:ae++});const X=r&&r.length>0?Math.round(F/(F+ae)*100):0,fe=De(z,I);let ne="N/A";fe!==null?ne=`${fe}${et(fe)}`:r&&r.length>=1&&(X>=80?ne="1st-3rd":X>=60?ne="4th-6th":X>=40?ne="7th-9th":ne="10th+");const ye={wins:F,losses:ae,winRate:X,position:ne,actualPosition:fe};Ce(ye),E(ye)},et=F=>{const ae=F%10,I=F%100;return ae===1&&I!==11?"st":ae===2&&I!==12?"nd":ae===3&&I!==13?"rd":"th"};if(W||!ue||!R||n!=="scheduled")return e.jsx(Zq,{isMobile:b});const re=()=>be==="passed"?"#e74c3c":be==="critical"?"#ff6b6b":be==="urgent"?"#ff8800":be==="warning"?"#ffaa00":"#4CAF50",je=()=>{if(be==="passed")return" DEADLINE PASSED!";if(be==="critical"){const F=O?As(O,b?"MMM d":"MMM d, yyyy"):"";return` CRITICAL: ENDS in ${ue.hours} hours! (${F})`}else if(be==="urgent"){const F=O?As(O,b?"MMM d":"MMM d, yyyy"):"";return` URGENT: ENDS in ${ue.days} days! (${F})`}else if(be==="warning"){const F=O?As(O,b?"MMM d":"MMM d, yyyy"):"";return` WARNING: ENDS in ${ue.days} days. (${F})`}else{const F=O?As(O,b?"MMM d":"MMM d, yyyy"):"";return`ENDS in ${ue.days} days. (${F})`}},V=()=>Math.round(r.length/s*100),Ee=re();return e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(0, 0, 0, 0.85), rgba(20, 20, 20, 0.9), rgba(0, 0, 0, 0.85))",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:b?"16px":"20px",padding:b?"6px 10px 10px 10px":"10px 16px 16px 16px",margin:b?"-15px 0 0 0":"13px auto",width:b?"100%":"98%",maxWidth:b?"none":"1600px",boxShadow:"0 8px 32px rgba(0,0,0,0.4), 0 4px 16px rgba(255,255,255,0.1), inset 0 1px 0 rgba(255,255,255,0.1)",display:"flex",flexDirection:"column",justifyContent:"flex-start",backdropFilter:"blur(8px)",overflow:b?"auto":"hidden",maxHeight:b?"none":"35vh",height:b?Q?"350px":"60px":Q?"408px":"160px",transition:"height 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",transform:"none",touchAction:"none"},role:"presentation",tabIndex:"-1",children:[e.jsxs("div",{style:{position:"relative",textAlign:"center",marginBottom:b?"0px":"3px",padding:b?"2px":"3px",borderRadius:"12px",background:"linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(20, 20, 20, 0.8))",border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 4px 16px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)"},children:[e.jsxs("h3",{style:{margin:0,color:"#ffffff",fontSize:b?"0.6rem":"0.9rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:b?"3px":"5px",flexWrap:"wrap",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",letterSpacing:"0.5px",minHeight:b?"2rem":"2.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:b?"2px":"6px"},children:[be==="critical"&&"",be==="urgent"&&"",be==="warning"&&"",be==="passed"&&"",be==="normal"&&""]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:b?"3px":"6px"},children:[e.jsx("button",{onClick:F=>{F.stopPropagation(),console.log("Smart match button clicked in Phase1Tracker"),console.log("onSmartMatchClick function:",S),S?(console.log("Calling onSmartMatchClick"),S()):console.log("onSmartMatchClick is not defined")},"aria-label":"Open smart match making",role:"button",tabIndex:"0",style:{background:"linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1))",border:"1px solid rgba(255, 193, 7, 0.4)",color:"#ffffff",fontSize:b?"0.4rem":"0.7rem",fontWeight:"bold",padding:b?"6px 10px":"8px 14px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",boxShadow:"0 2px 8px rgba(255, 193, 7, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",zIndex:10},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 193, 7, 0.4), rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2))",F.target.style.transform="scale(1.02) translateY(-1px)",F.target.style.boxShadow="0 4px 12px rgba(255, 193, 7, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1))",F.target.style.transform="scale(1) translateY(0)",F.target.style.boxShadow="0 2px 8px rgba(255, 193, 7, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)"},children:" SMART MATCH"}),e.jsx("span",{onClick:F=>{F.stopPropagation(),M(!0)},style:{fontSize:b?"0.4rem":"0.7rem",background:`linear-gradient(135deg, ${Ee}, ${Ee}dd, ${Ee})`,padding:b?"6px 10px":"8px 14px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2), 0 0 10px rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:F=>{F.target.style.transform="scale(1.02) translateY(-1px)",F.target.style.boxShadow="0 6px 16px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.3), 0 0 15px rgba(255,255,255,0.2)"},onMouseLeave:F=>{F.target.style.transform="scale(1) translateY(0)",F.target.style.boxShadow="0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2), 0 0 10px rgba(255,255,255,0.1)"},title:"Click to view Phase 1 overview",role:"button",tabIndex:"0","aria-label":"Open Phase 1 overview",children:"PHASE 1"}),e.jsx("button",{onClick:F=>{F.stopPropagation(),C(!0)},"aria-label":"Open Phase 1 rules and information",role:"button",tabIndex:"0",style:{background:"linear-gradient(135deg, rgba(255, 68, 68, 0.3), rgba(255, 68, 68, 0.2), rgba(255, 68, 68, 0.1))",border:"1px solid rgba(255, 68, 68, 0.4)",color:"#ffffff",fontSize:b?"0.4rem":"0.7rem",fontWeight:"bold",padding:b?"6px 10px":"8px 14px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",boxShadow:"0 2px 8px rgba(255, 68, 68, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",zIndex:10},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 68, 68, 0.4), rgba(255, 68, 68, 0.3), rgba(255, 68, 68, 0.2))",F.target.style.transform="scale(1.02) translateY(-1px)",F.target.style.boxShadow="0 4px 12px rgba(255, 68, 68, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 68, 68, 0.3), rgba(255, 68, 68, 0.2), rgba(255, 68, 68, 0.1))",F.target.style.transform="scale(1) translateY(0)",F.target.style.boxShadow="0 2px 8px rgba(255, 68, 68, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)"},children:" RULES"})]})]}),e.jsx("div",{style:{color:"#ffffff",fontSize:b?"0.6rem":"0.8rem",lineHeight:"1.1",marginTop:"1px",marginBottom:b?"1px":"3px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center"},children:je()}),e.jsxs("div",{style:{position:b?"relative":"absolute",left:b?"auto":"15%",top:b?"auto":"50%",transform:b?"none":"translate(-50%, -50%)",cursor:"pointer",fontSize:b?"2rem":"2.8rem",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",minHeight:b?"80px":"120px",lineHeight:1,background:"linear-gradient(135deg, rgba(76, 175, 80, 0.35), rgba(76, 175, 80, 0.3), rgba(76, 175, 80, 0.25))",border:"1px solid rgba(76, 175, 80, 0.7)",padding:b?"3px":"5px",borderRadius:b?"10px":"16px",zIndex:1,boxShadow:"0 2px 8px rgba(76, 175, 80, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",minWidth:b?"60px":"90px",backdropFilter:"blur(8px)",margin:b?"8px auto":"0"},onClick:()=>{H(!0),A&&A()},"aria-label":"Open calendar to schedule matches by date",role:"button",tabIndex:"0",children:[e.jsx("div",{style:{fontSize:b?"0.4rem":"0.6rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:b?"8px":"12px",textAlign:"center"},children:"Today's Date"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1},children:[e.jsx("div",{style:{fontSize:b?"0.7rem":"1rem"},children:(()=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date().getDay()])()}),e.jsx("div",{style:{fontSize:b?"1rem":"1.8rem"},children:(()=>{const F=new Date,ae=String(F.getMonth()+1).padStart(2,"0"),I=String(F.getDate()).padStart(2,"0"),X=String(F.getFullYear()).slice(-2);return`${ae}/${I}/${X}`})()})]}),e.jsx("div",{style:{fontSize:b?"0.25rem":"0.6rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginTop:"auto",textAlign:"center",whiteSpace:"nowrap",background:"rgba(0, 0, 0, 0.7)",padding:b?"1px 2px":"2px 3px",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.3)"},children:b?"Schedule":"Click to Schedule Match by Date"})]}),e.jsxs("div",{style:{position:b?"relative":"absolute",right:b?"auto":"15%",top:b?"auto":"50%",transform:b?"none":"translate(50%, -50%)",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",lineHeight:1,background:"linear-gradient(135deg, rgba(52, 152, 219, 0.15), rgba(52, 152, 219, 0.1), rgba(52, 152, 219, 0.05))",border:"1px solid rgba(52, 152, 219, 0.3)",padding:b?"3px":"5px",borderRadius:b?"10px":"16px",zIndex:1,boxShadow:"0 2px 8px rgba(52, 152, 219, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",minWidth:b?"60px":"90px",minHeight:b?"80px":"120px",backdropFilter:"blur(8px)",margin:b?"8px auto":"0"},title:"Proposal management - view pending and sent proposals",onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.25), rgba(52, 152, 219, 0.2), rgba(52, 152, 219, 0.15))",F.currentTarget.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)",F.currentTarget.style.border="1px solid rgba(52, 152, 219, 0.5)",F.currentTarget.style.transform="translate(50%, -50%) scale(1.02)"},onMouseLeave:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.15), rgba(52, 152, 219, 0.1), rgba(52, 152, 219, 0.05))",F.currentTarget.style.boxShadow="0 2px 8px rgba(52, 152, 219, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",F.currentTarget.style.border="1px solid rgba(52, 152, 219, 0.3)",F.currentTarget.style.transform="translate(50%, -50%) scale(1)"},children:[e.jsx("div",{style:{fontSize:b?"0.5rem":"0.75rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginBottom:b?"3px":"6px",textAlign:"center",whiteSpace:"nowrap"},children:" Proposals"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:b?"2px":"4px",justifyContent:"center",width:"100%"},children:[e.jsxs("button",{onClick:F=>{F.stopPropagation(),g&&g()},style:{background:"rgba(255, 255, 255, 0.1)",color:"#ffffff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",padding:b?"2px 3px":"5px 7px",fontSize:b?"0.4rem":"0.65rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.3), rgba(52, 152, 219, 0.25), rgba(52, 152, 219, 0.2))",F.target.style.transform="translateY(-1px) scale(1.01)",F.target.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.4), inset 0 1px 0 rgba(255,255,255,0.2)"},onMouseLeave:F=>{F.target.style.background="rgba(255, 255, 255, 0.1)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"},children:[" ",h," waiting for you"]}),e.jsxs("button",{onClick:F=>{F.stopPropagation(),f&&f()},style:{background:"rgba(255, 255, 255, 0.1)",color:"#ffffff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",padding:b?"2px 3px":"5px 7px",fontSize:b?"0.4rem":"0.65rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.3), rgba(52, 152, 219, 0.25), rgba(52, 152, 219, 0.2))",F.target.style.transform="translateY(-1px) scale(1.01)",F.target.style.boxShadow="0 4px 12px rgba(52, 152, 219, 0.4), inset 0 1px 0 rgba(255,255,255,0.2)"},onMouseLeave:F=>{F.target.style.background="rgba(255, 255, 255, 0.1)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"},children:[" ",p," waiting for opponents"]})]})]}),e.jsxs("div",{style:{color:"#ffffff",fontSize:b?"0.65rem":"0.8rem",fontWeight:"bold",marginTop:b?"3px":"1px",marginBottom:b?"1px":"3px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",lineHeight:"1.1",textAlign:"center"},children:[r.length,"/",s," Matches Complete"]}),e.jsxs("div",{style:{color:"#ffffff",fontSize:b?"0.65rem":"0.8rem",fontWeight:"bold",marginTop:"1px",marginBottom:b?"3px":"1px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",lineHeight:"1.1",textAlign:"center"},children:[s-r.length," to Schedule"]}),e.jsx("div",{style:{textAlign:"center",marginTop:b?"2px":"4px"},children:e.jsx("button",{onClick:F=>{F.stopPropagation(),H(!Q)},style:{fontSize:b?"0.4rem":"0.8rem",color:"#ffffff",fontWeight:"bold",cursor:"pointer",padding:b?"1px 2px":"3px 6px",borderRadius:"6px",display:"inline-block",transition:"background-color 0.2s ease",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",background:"transparent",border:"none"},children:Q?"Hide Stats ":"Show Stats "})})]}),Q&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"stretch",marginBottom:b?"6px":"3px",gap:b?"4px":"8px",padding:b?"4px":"6px",borderRadius:"8px",background:"rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{onClick:F=>{F.stopPropagation(),l&&l()},style:{background:"rgba(0, 0, 0, 0.4)",padding:b?"4px":"6px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",flex:1,textAlign:"center",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:b?"60px":"70px"},onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.3))",F.currentTarget.style.transform="translateY(-2px) scale(1.02)",F.currentTarget.style.boxShadow="0 4px 16px rgba(76, 175, 80, 0.3), 0 2px 8px rgba(0,0,0,0.2)",F.currentTarget.style.border="1px solid rgba(76, 175, 80, 0.5)"},onMouseLeave:F=>{F.currentTarget.style.background="rgba(255,255,255,0.08)",F.currentTarget.style.transform="translateY(0) scale(1)",F.currentTarget.style.boxShadow="none",F.currentTarget.style.border="1px solid rgba(255,255,255,0.15)"},children:[e.jsx("div",{style:{fontSize:b?"0.5rem":"0.7rem",fontWeight:"bold",color:"#e0e0e0",marginBottom:b?"3px":"1px"},children:"Progress"}),e.jsxs("div",{style:{fontSize:b?"0.6rem":"0.8rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:b?"2px":"1px"},children:[r.length,"/",s]}),e.jsx("div",{style:{width:"100%",height:b?"2px":"5px",background:"rgba(255,255,255,0.15)",borderRadius:"3px",overflow:"hidden",marginBottom:"1px",boxShadow:"inset 0 1px 2px rgba(0,0,0,0.3)"},children:e.jsx("div",{style:{width:`${V()}%`,height:"100%",background:"linear-gradient(90deg, #4CAF50, #45a049, #4CAF50)",borderRadius:"3px",transition:"width 0.4s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 0 8px rgba(76, 175, 80, 0.5)",position:"relative"},children:e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:"shimmer 2s infinite"}})})}),e.jsx("div",{style:{fontSize:b?"0.45rem":"0.65rem",color:"#e0e0e0",fontStyle:"italic",textAlign:"center",fontWeight:"500"},children:"click to see opponents"})]}),e.jsxs("div",{onClick:F=>{F.stopPropagation(),c&&c()},style:{background:"rgba(0, 0, 0, 0.4)",padding:b?"3px":"6px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",flex:1,textAlign:"center",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"70px"},onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(33, 150, 243, 0.2), rgba(33, 150, 243, 0.3))",F.currentTarget.style.transform="translateY(-2px) scale(1.02)",F.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3), 0 2px 8px rgba(0,0,0,0.2)",F.currentTarget.style.border="1px solid rgba(33, 150, 243, 0.5)"},onMouseLeave:F=>{F.currentTarget.style.background="rgba(255,255,255,0.08)",F.currentTarget.style.transform="translateY(0) scale(1)",F.currentTarget.style.boxShadow="none",F.currentTarget.style.border="1px solid rgba(255,255,255,0.15)"},children:[e.jsx("div",{style:{fontSize:b?"0.3rem":"0.7rem",fontWeight:"bold",color:"#e0e0e0",marginBottom:"1px"},children:"Record"}),e.jsxs("div",{style:{fontSize:b?"0.4rem":"0.8rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:"1px"},children:[(me==null?void 0:me.wins)||0,"-",(me==null?void 0:me.losses)||0," (",(me==null?void 0:me.winRate)||0,"%)"]}),e.jsx("div",{style:{fontSize:b?"0.35rem":"0.65rem",color:"#e0e0e0",fontStyle:"italic",textAlign:"center",fontWeight:"500"},children:"click to see results"})]}),e.jsxs("div",{onClick:F=>{F.stopPropagation(),d&&d()},style:{background:"rgba(0, 0, 0, 0.4)",padding:b?"4px":"8px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",flex:1,textAlign:"center",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"80px"},onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.3))",F.currentTarget.style.transform="translateY(-2px) scale(1.02)",F.currentTarget.style.boxShadow="0 4px 16px rgba(156, 39, 176, 0.3), 0 2px 8px rgba(0,0,0,0.2)",F.currentTarget.style.border="1px solid rgba(156, 39, 176, 0.5)"},onMouseLeave:F=>{F.currentTarget.style.background="rgba(0, 0, 0, 0.4)",F.currentTarget.style.transform="translateY(0) scale(1)",F.currentTarget.style.boxShadow="none",F.currentTarget.style.border="1px solid rgba(255,255,255,0.15)"},children:[e.jsx("div",{style:{fontSize:b?"0.35rem":"0.8rem",fontWeight:"bold",color:"#e0e0e0",marginBottom:"1px"},children:"Position"}),e.jsx("div",{style:{fontSize:b?"0.4rem":"0.9rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:"1px"},children:W?"...":(me==null?void 0:me.position)||"N/A"}),e.jsx("div",{style:{fontSize:b?"0.35rem":"0.65rem",color:"#e0e0e0",fontStyle:"italic",textAlign:"center",fontWeight:"500"},children:"click to view standings"})]})]}),e.jsxs("div",{style:{display:"flex",gap:b?"6px":"10px",marginBottom:"3px"},children:[e.jsxs("div",{style:{flex:b?"0 0 120px":"0 0 180px",background:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:"3px",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",gap:"3px"},children:[e.jsxs("div",{style:{fontSize:b?"0.4rem":"0.8rem",color:"#ffffff",fontWeight:"bold",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:"1px"},children:[" ",b?"Messages":"Message Center"]}),e.jsxs("button",{onClick:F=>{F.stopPropagation(),w&&w("direct")},style:{background:"linear-gradient(135deg, #ff4444 0%, #cc3333 50%, #aa2222 100%)",color:"#ffffff",border:"none",borderRadius:"6px",padding:"3px 5px",fontSize:b?"0.5rem":"0.6rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(255, 68, 68, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #cc3333 0%, #aa2222 50%, #881111 100%)",F.target.style.transform="translateY(-2px) scale(1.02)",F.target.style.boxShadow="0 4px 12px rgba(255, 68, 68, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.6), inset 0 -1px 0 rgba(0, 0, 0, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #ff4444 0%, #cc3333 50%, #aa2222 100%)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(255, 68, 68, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)"},children:[" ",b?"DM":"Direct Messages"]}),e.jsxs("button",{onClick:F=>{F.stopPropagation(),w&&w("league")},style:{background:"linear-gradient(135deg, #00bcd4 0%, #0097a7 50%, #00695c 100%)",color:"#ffffff",border:"none",borderRadius:"6px",padding:"3px 5px",fontSize:b?"0.5rem":"0.6rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(0, 188, 212, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #0097a7 0%, #00695c 50%, #004d40 100%)",F.target.style.transform="translateY(-2px) scale(1.02)",F.target.style.boxShadow="0 4px 12px rgba(0, 188, 212, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.6), inset 0 -1px 0 rgba(0, 0, 0, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #00bcd4 0%, #0097a7 50%, #00695c 100%)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(0, 188, 212, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)"},children:[" ",b?"Chat":"League Chat"]})]}),e.jsxs("div",{onClick:F=>{F.stopPropagation(),u&&u()},style:{flex:"1",background:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:"3px",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(255, 68, 68, 0.15), rgba(255, 68, 68, 0.1), rgba(255, 68, 68, 0.05))",F.currentTarget.style.border="1px solid rgba(255, 68, 68, 0.4)",F.currentTarget.style.transform="translateY(-1px) scale(1.01)",F.currentTarget.style.boxShadow="0 4px 12px rgba(255, 68, 68, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)"},onMouseLeave:F=>{F.currentTarget.style.background="rgba(0, 0, 0, 0.4)",F.currentTarget.style.border="1px solid rgba(255,255,255,0.15)",F.currentTarget.style.transform="translateY(0) scale(1)",F.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)"},children:[e.jsx("div",{style:{fontSize:b?"0.5rem":"0.9rem",color:"#ff4444",fontWeight:"bold",marginBottom:"0px",textAlign:"center",cursor:"pointer",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",letterSpacing:"0.5px"},children:" Upcoming Matches"}),e.jsx("div",{style:{fontSize:b?"0.35rem":"0.65rem",color:"#e0e0e0",textAlign:"center",fontStyle:"italic",fontWeight:"500",marginTop:"0px",marginBottom:"0px",padding:"0px"},children:"click for match details"}),(()=>{const F=m;return F&&F.length>0?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1px",marginTop:"1px"},children:[F.slice(0,3).map((ae,I)=>e.jsx("div",{onClick:X=>{X.stopPropagation(),v&&ae&&v(ae)},style:{fontSize:b?"0.4rem":"0.7rem",color:"#ccc",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",padding:b?"1px 2px":"2px 3px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:X=>{X.target.style.color="#ffffff",X.target.style.background="rgba(255,255,255,0.1)"},onMouseLeave:X=>{X.target.style.color="#ccc",X.target.style.background="transparent"},children:(()=>{let X="",fe="";if(ae.type==="proposal"||ae.status==="confirmed")ae.senderName&&ae.receiverName&&(X=ae.senderName.trim().toLowerCase()===`${a} ${o}`.trim().toLowerCase()?ae.receiverName:ae.senderName),ae.date&&(fe=Og(ae.date));else if(ae.player1Id&&ae.player2Id&&(X=ae.player1Id.trim().toLowerCase()===`${a} ${o}`.trim().toLowerCase()?ae.player2Id:ae.player1Id),ae.scheduledDate){const ne=new Date(ae.scheduledDate);isNaN(ne.getTime())||(fe=Og(ne.toISOString().split("T")[0]))}else ae.date&&(fe=Og(ae.date));return X?fe?`vs ${X} (${fe})`:`vs ${X}`:"No matches"})()},I)),F.length>3&&e.jsxs("div",{style:{fontSize:b?"0.2rem":"0.5rem",color:"#888",textAlign:"center",fontStyle:"italic",padding:b?"0px":"1px"},children:["+",F.length-3," more"]})]}):e.jsx("div",{style:{fontSize:b?"0.35rem":"0.6rem",color:"#999",textAlign:"center"},children:"No matches"})})()]})]})]})]})},Yj={async validateChallenge(n,t,r,s=!1,a=null){return Tn.post("/api/challenges/validate",{senderName:n,receiverName:t,division:r,isRematch:s,originalChallengeId:a})},async validateDefenseAcceptance(n,t,r){return Tn.post("/api/challenges/validate-defense",{defenderName:n,challengerName:t,division:r})},async getChallengeStats(n,t){return Tn.get(`/api/challenges/stats/${encodeURIComponent(n)}/${encodeURIComponent(t)}`)},async getChallengeLimits(n,t){return Tn.get(`/api/challenges/limits/${encodeURIComponent(n)}/${encodeURIComponent(t)}`)},async getEligibleOpponents(n,t){return Tn.get(`/api/challenges/eligible-opponents/${encodeURIComponent(n)}/${encodeURIComponent(t)}`)},async getDivisionChallengeStats(n){return Tn.get(`/api/challenges/division-stats/${encodeURIComponent(n)}`)},async updateChallengeStats(n,t,r){return Tn.put(`/api/challenges/stats/${encodeURIComponent(n)}/${encodeURIComponent(t)}`,r)},async resetDivisionChallengeStats(n){return Tn.delete(`/api/challenges/division-stats/${encodeURIComponent(n)}`)}};function kC({isOpen:n,onClose:t,isMobile:r}){return n?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"10px"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #ff4444",borderRadius:"12px",width:r?"98%":"50%",maxWidth:"500px",height:r?"98%":"90vh",maxHeight:"800px",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#ffffff"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",padding:"20px",borderBottom:"2px solid #ff4444",flexShrink:0},children:[e.jsx("h2",{style:{margin:0,fontSize:r?"1.2rem":"1.5rem",color:"#ffffff",fontWeight:"bold",display:"flex",alignItems:"center",gap:"10px",textAlign:"center"},children:" Phase 2 Challenge Rules"}),e.jsx("button",{onClick:t,style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#ffffff",fontSize:"2rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease"},onMouseEnter:s=>s.target.style.backgroundColor="rgba(255,255,255,0.1)",onMouseLeave:s=>s.target.style.backgroundColor="transparent",children:""})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"25px",fontSize:r?"1rem":"1.1rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#ff4444",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Overview"}),e.jsx("p",{style:{margin:"0 0 15px 0",color:"#e0e0e0"},children:"Phase 2 is the challenge phase where players compete against each other based on standings from Phase 1."}),e.jsx("p",{children:"You must complete 2-4 total matches during this phase, as either a challenger or defender."})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#ff4444",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Match Requirements"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Total Matches:"})," 2-4 matches (minimum 2, maximum 4)"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Defenses:"})," If challenged, at least 2 defensive matches are required(you may accept more voluntarily). "]}),e.jsx("li",{children:e.jsx("p",{children:"If not challenged no defensive matches are required."})})]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Weekly Limit:"})," Only 1 match per week (as challenger or defender)"]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#ff4444",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Dynamic Challenge Limits"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"15px"},children:[e.jsx("p",{style:{margin:"0 0 10px 0",color:"#ffc107",fontWeight:"bold"},children:"Your challenge limit depends on how many times you've been challenged:"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"0 times challenged:"})," You can issue 4 challenges"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"1 time challenged:"})," You can issue 3 challenges"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"2 times challenged:"})," You can issue 2 challenges"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#ff4444",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Challenge Rules"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Standings Limit:"})," You can challenge players ranked up to 4 spots higher than you."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"One Challenge:"})," You may challenge the same opponent only once."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Rematch Rule:"})," If you lose a challenge as a defender, you may issue a rematch (if both remain eligible). Opponent is not required to accept the rematch if they have played the required 2 defensive matches."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Defense Priority:"})," If you receive multiple challenges in the same week, the lowest-ranked challenger has priority."]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#ff4444",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Defense Rules"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Required Defenses:"})," You must accept challenges until you've played at least 2 matches as a defender."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Defense Limit:"})," No player may be required to defend more than 2 times."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Voluntary Defenses:"})," You may accept additional defenses beyond the required 2."]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Declining Challenges:"})," After 2 defenses, declining further challenges is not a forfeit"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"15px",marginTop:"20px"},children:[e.jsx("h4",{style:{color:"#ff4444",fontSize:r?"1rem":"1.1rem",margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"8px"},children:" Important Notes"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0",fontSize:r?"0.85rem":"0.9rem"},children:[e.jsx("li",{style:{marginBottom:"5px"},children:"All challenges and responses must be recorded in the League Scheduling Hub"}),e.jsx("li",{style:{marginBottom:"5px"},children:"Any attempt to exploit rules or collude will be treated as a sportsmanship violation"}),e.jsx("li",{style:{marginBottom:"5px"},children:"Once you complete 4 matches, you may not accept or issue further challenges"})]})]})]}),e.jsx("div",{style:{textAlign:"center",padding:"20px",borderTop:"1px solid rgba(255,255,255,0.2)",flexShrink:0},children:e.jsx("button",{onClick:t,style:{background:"linear-gradient(135deg, #ff4444, #cc3333)",border:"none",color:"#ffffff",fontSize:r?"0.9rem":"1rem",fontWeight:"bold",padding:r?"10px 20px":"12px 25px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},onMouseEnter:s=>{s.target.style.transform="translateY(-2px)",s.target.style.boxShadow="0 6px 12px rgba(0,0,0,0.4)"},onMouseLeave:s=>{s.target.style.transform="translateY(0)",s.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},children:"Got It! "})})]})}):null}function eH({isOpen:n,onClose:t,phase1Stats:r,playerName:s,playerLastName:a,isMobile:o}){if(!n||!r)return null;const i=`${s} ${a}`;return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:1e3,padding:o?"10px":"20px",overflowY:"auto"},onClick:t,children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"3px solid #ff4444",borderRadius:o?"12px":"16px",padding:o?"20px":"30px",maxWidth:o?"90vw":"500px",width:"100%",maxHeight:o?"80vh":"70vh",overflowY:"auto",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",backdropFilter:"blur(5px)",position:"relative",marginTop:o?"20px":"40px",marginBottom:o?"20px":"40px"},onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:t,style:{position:"absolute",top:o?"10px":"15px",right:o?"10px":"15px",background:"linear-gradient(135deg, #ff4444, #cc3333)",border:"3px solid #ffffff",color:"#ffffff",fontSize:o?"1.2rem":"1.5rem",fontWeight:"bold",width:o?"35px":"40px",height:o?"35px":"40px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease",zIndex:1e3,boxShadow:"0 4px 8px rgba(0,0,0,0.5)",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},onMouseEnter:l=>{l.target.style.background="linear-gradient(135deg, #ff6666, #dd4444)",l.target.style.transform="scale(1.1)",l.target.style.boxShadow="0 6px 12px rgba(0,0,0,0.7)"},onMouseLeave:l=>{l.target.style.background="linear-gradient(135deg, #ff4444, #cc3333)",l.target.style.transform="scale(1)",l.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.5)"},children:""}),e.jsxs("div",{style:{textAlign:"center",marginBottom:o?"20px":"25px"},children:[e.jsx("h2",{style:{color:"#ffffff",fontSize:o?"1.2rem":"1.5rem",fontWeight:"bold",margin:"0 0 5px 0",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:" Phase 1 Results"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:o?"0.9rem":"1rem",fontStyle:"italic"},children:i})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:o?"12px":"16px",marginBottom:o?"20px":"25px"},children:[e.jsxs("div",{style:{padding:o?"15px":"20px",background:"rgba(255,255,255,0.1)",borderRadius:"8px",border:"2px solid rgba(255,255,255,0.2)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:o?"0.8rem":"1rem",color:"#e0e0e0",marginBottom:"8px",fontWeight:"bold"},children:"Record"}),e.jsxs("div",{style:{fontSize:o?"1.5rem":"2rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"5px"},children:[r.wins,"-",r.losses]}),e.jsxs("div",{style:{fontSize:o?"0.9rem":"1.1rem",color:"#e0e0e0",fontStyle:"italic"},children:[r.winRate,"% Win Rate"]})]}),e.jsxs("div",{style:{padding:o?"15px":"20px",background:"rgba(255,255,255,0.1)",borderRadius:"8px",border:"2px solid rgba(255,255,255,0.2)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:o?"0.8rem":"1rem",color:"#e0e0e0",marginBottom:"8px",fontWeight:"bold"},children:"Final Position"}),e.jsx("div",{style:{fontSize:o?"1.5rem":"2rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"5px"},children:r.position}),e.jsx("div",{style:{fontSize:o?"0.9rem":"1.1rem",color:"#e0e0e0",fontStyle:"italic"},children:"in Division"})]}),e.jsxs("div",{style:{padding:o?"15px":"20px",background:"rgba(255,255,255,0.1)",borderRadius:"8px",border:"2px solid rgba(255,255,255,0.2)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:o?"0.8rem":"1rem",color:"#e0e0e0",marginBottom:"8px",fontWeight:"bold"},children:"Matches Played"}),e.jsx("div",{style:{fontSize:o?"1.5rem":"2rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"5px"},children:r.totalMatches}),e.jsx("div",{style:{fontSize:o?"0.9rem":"1.1rem",color:"#e0e0e0",fontStyle:"italic"},children:"Total Games"})]})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",borderRadius:"8px",padding:o?"15px":"20px",border:"1px solid rgba(255,255,255,0.1)",marginBottom:o?"15px":"20px"},children:[e.jsx("h3",{style:{color:"#ffffff",fontSize:o?"1rem":"1.2rem",margin:"0 0 10px 0",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"Performance Summary"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:o?"0.85rem":"1rem",lineHeight:"1.5",textAlign:"center"},children:r.totalMatches===0?e.jsx("div",{children:"No matches completed in Phase 1"}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Win Rate:"})," ",r.winRate,"% (",r.wins," wins, ",r.losses," losses)"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Final Standing:"})," ",r.position," place"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total Matches:"})," ",r.totalMatches," games played"]})]})})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",borderRadius:"8px",padding:o?"15px":"20px",border:"2px solid rgba(255, 68, 68, 0.3)",textAlign:"center"},children:[e.jsx("div",{style:{color:"#ff4444",fontSize:o?"0.9rem":"1rem",fontWeight:"bold",marginBottom:"5px"},children:" Phase 2 Qualified"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:o?"0.8rem":"0.9rem"},children:"Ready for challenge matches and defenses"})]})]})})}function tH({playerName:n,playerLastName:t,selectedDivision:r,phase:s,isMobile:a,onOpenOpponentsModal:o,onOpenCompletedMatchesModal:i,onOpenStandingsModal:l,onOpenDefenseChallengersModal:c,onOpenAllMatchesModal:d,onOpenProposalListModal:u,onOpenSentProposalListModal:h,onOpenPlayerSearch:p,pendingCount:g=0,sentCount:f=0,upcomingMatches:m=[],onMatchClick:v,seasonData:b,completedMatches:w=[],standings:x=[]}){var V,Ee;const[j,S]=y.useState(null),[_,C]=y.useState(null),[N,M]=y.useState(!0),[E,P]=y.useState(null),[D,T]=y.useState(!0),[A,k]=y.useState(!1),[R,U]=y.useState(!1),[z,$]=y.useState(null),W=`${n} ${t}`,Y=()=>{let F=0,ae=0;w&&w.length>0&&w.forEach(lt=>{lt.winner===W?F++:ae++});const I=w&&w.length>0?Math.round(F/(F+ae)*100):0,X=(lt,tt)=>{if(!lt||lt.length===0)return null;const ge=tt.toLowerCase().trim(),xt=lt.find(ht=>ht.name.toLowerCase().trim()===ge);return xt?parseInt(xt.rank):null},fe=lt=>{const tt=lt%10,ge=lt%100;return tt===1&&ge!==11?"st":tt===2&&ge!==12?"nd":tt===3&&ge!==13?"rd":"th"},ne=X(x,W);let ye="N/A";ne!==null?ye=`${ne}${fe(ne)}`:w&&w.length>=1&&(I>=80?ye="1st-3rd":I>=60?ye="4th-6th":I>=40?ye="7th-9th":ye="10th+");const ot={wins:F,losses:ae,winRate:I,position:ye,totalMatches:w?w.length:0};console.log("Phase2Tracker - Calculated Phase 1 stats:",ot),$(ot)};y.useEffect(()=>{console.log("Phase2Tracker - Calculating Phase 1 stats:"),console.log("  completedMatches:",w),console.log("  standings:",x),console.log("  fullPlayerName:",W),Y()},[w,x,W]);const H=(()=>{if(console.log("Phase2Tracker - Received seasonData:",b),console.log("Phase2Tracker - seasonData.phase1End:",b==null?void 0:b.phase1End),!b||!b.phase1End)return console.log("Phase2Tracker - No seasonData or phase1End found"),{days:null,status:"no_deadline"};const F=new Date,ae=new Date(b.phase1End);if(console.log("Phase2Tracker - Date comparison:"),console.log("  now:",F.toISOString()),console.log("  phase1End:",ae.toISOString()),console.log("  nowTime:",F.getTime()),console.log("  phase1EndTime:",ae.getTime()),console.log("  isPhase1Active:",F<=ae),console.log("  currentDate:",F.toLocaleDateString()),console.log("  phase1EndDate:",ae.toLocaleDateString()),F<=ae)return console.log("Phase2Tracker - Phase 1 is still active, returning phase1_active status"),{days:null,status:"phase1_active"};const I=new Date(ae);I.setDate(I.getDate()+28);const X=I-F,fe=Math.ceil(X/(1e3*60*60*24));return console.log("Phase2Tracker - Phase 2 calculation:"),console.log("  phase2End:",I.toISOString()),console.log("  diffTime:",X),console.log("  diffDays:",fe),console.log("  status:",fe<0?"passed":fe<=1?"critical":fe<=3?"urgent":fe<=7?"warning":"normal"),fe<0?{days:Math.abs(fe),status:"passed"}:fe<=1?{days:fe,status:"critical"}:fe<=3?{days:fe,status:"urgent"}:fe<=7?{days:fe,status:"warning"}:{days:fe,status:"normal"}})();if(console.log("Phase2Tracker - Final deadlineStatus:",H),console.log("Phase2Tracker - Final deadlineStatus.status:",H==null?void 0:H.status),console.log("Phase2Tracker - Final deadlineStatus.days:",H==null?void 0:H.days),y.useEffect(()=>{if(!n||!t||!r||s!=="challenge"){M(!1);return}async function F(){try{M(!0),P(null);const[ae,I]=await Promise.all([Yj.getChallengeStats(W,r),Yj.getChallengeLimits(W,r)]);S(ae),C(I)}catch(ae){console.error("Error loading challenge data:",ae),P("Failed to load challenge statistics")}finally{M(!1)}}F()},[n,t,r,s,W]),s!=="challenge")return null;if(N)return e.jsx("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.7), rgba(26, 26, 26, 0.8))",border:"2px solid #ff4444",borderRadius:a?"8px":"12px",padding:a?"1px":"18px",margin:a?"-15px 0 0 0":"16px 0",boxShadow:"0 6px 20px rgba(0,0,0,0.3), 0 2px 8px rgba(0,0,0,0.2)",backdropFilter:"blur(2px)",textAlign:"center",color:"#888"},children:"Loading Phase 2 challenge statistics..."});if(E)return e.jsx("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.7), rgba(26, 26, 26, 0.8))",border:"2px solid #e53e3e",borderRadius:a?"8px":"12px",padding:a?"1px":"18px",margin:a?"-15px 0 0 0":"16px 0",boxShadow:"0 6px 20px rgba(0,0,0,0.3), 0 2px 8px rgba(0,0,0,0.2)",backdropFilter:"blur(2px)",textAlign:"center",color:"#e53e3e"},children:E});if(!j||!_)return null;const ue=j.matchesAsChallenger+j.requiredDefenses,J=2,be=4,Ae=ue>=J,O=ue>=be,me=(()=>{var ae;const F=((ae=_.dynamicLimits)==null?void 0:ae.timesChallenged)||0;return F===0?4:F===1?3:F===2?2:0})(),Ce=((V=_.dynamicLimits)==null?void 0:V.challengesIssued)||0,ve=me-Ce,De=j.requiredDefenses||0,Oe=()=>O?"completed":Ae?"active":ue>=1?"progressing":"ready",Ze=(F,ae)=>{const I=F/ae*100;return I>=90?"#e53e3e":I>=75?"#ffc107":"#28a745"},et=()=>{if(H.status==="phase1_active")return"#ffaa00";switch(Oe()){case"completed":return"#00aa00";case"active":return"#ff4444";case"progressing":return"#ff4444";case"ready":return"#ff4444";default:return"#ff4444"}},re=()=>{const F=Oe();if(H.status==="phase1_active")return` Phase 1 still active until ${b&&b.phase1End?As(new Date(b.phase1End),a?"MMM d":"MMM d, yyyy"):""}`;if(H.status==="passed")return" DEADLINE PASSED!";if(H.status==="critical"){const ae=new Date(b.phase1End),I=new Date(ae);I.setDate(I.getDate()+28);const X=As(I,a?"MMM d":"MMM d, yyyy");return` CRITICAL: ENDS in ${H.days} hours! (${X})`}else if(H.status==="urgent"){const ae=new Date(b.phase1End),I=new Date(ae);I.setDate(I.getDate()+28);const X=As(I,a?"MMM d":"MMM d, yyyy");return` URGENT: ENDS in ${H.days} days! (${X})`}else if(H.status==="warning"){const ae=new Date(b.phase1End),I=new Date(ae);I.setDate(I.getDate()+28);const X=As(I,a?"MMM d":"MMM d, yyyy");return` WARNING: ENDS in ${H.days} days. (${X})`}else if(H.status==="normal"){const ae=new Date(b.phase1End),I=new Date(ae);I.setDate(I.getDate()+28);const X=As(I,a?"MMM d":"MMM d, yyyy");return`ENDS in ${H.days} days. (${X})`}switch(F){case"completed":return" Phase 2 Complete! (4/4 matches)";case"active":return` Active in Phase 2! ${ue}/4 matches (min met)`;case"progressing":return` Phase 2 in progress! ${ue}/4 matches (need ${J-ue} more)`;case"ready":return" Ready for Phase 2! Need 2-4 challenge matches.";default:return"Phase 2 Challenge Status"}},je=et();return e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(0, 0, 0, 0.85), rgba(20, 20, 20, 0.9), rgba(0, 0, 0, 0.85))",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:a?"16px":"20px",padding:a?"6px":"12px",margin:a?"-15px 0 0 0":"13px auto",width:a?"100%":"98%",maxWidth:a?"none":"1600px",boxShadow:"0 8px 32px rgba(0,0,0,0.4), 0 4px 16px rgba(255,255,255,0.1), inset 0 1px 0 rgba(255,255,255,0.1)",cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"flex-start",backdropFilter:"blur(8px)",overflow:"auto",maxHeight:"none",height:a?D?"auto":"60px":D?"380px":"160px",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},onClick:()=>T(!D),onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),T(!D))},role:"button",tabIndex:"0","aria-label":D?"Collapse Phase 2 tracker":"Expand Phase 2 tracker",children:[e.jsxs("div",{style:{position:"relative",textAlign:"center",marginBottom:a?"0px":"4px",padding:a?"6px":"8px",borderRadius:"12px",background:"linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(20, 20, 20, 0.8))",border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 4px 16px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)"},children:[e.jsxs("h3",{style:{margin:0,color:"#ffffff",fontSize:a?"0.8rem":"1.1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:a?"4px":"6px",flexWrap:"wrap",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",letterSpacing:"0.5px",minHeight:a?"2.5rem":"3rem"},children:[e.jsx("button",{onClick:F=>{F.stopPropagation(),U(!0)},"aria-label":"View Phase 1 results",role:"button",tabIndex:"0",style:{background:"linear-gradient(135deg, #22c55e, #16a34a, #15803d)",border:"2px solid rgba(255,255,255,0.8)",color:"#ffffff",fontSize:a?"0.5rem":"0.8rem",fontWeight:"bold",padding:a?"6px 10px":"8px 14px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.4), inset 0 1px 0 rgba(255,255,255,0.3), 0 0 10px rgba(34, 197, 94, 0.2)",zIndex:10},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #4ade80, #22c55e, #16a34a)",F.target.style.transform="scale(1.05) translateY(-2px)",F.target.style.boxShadow="0 6px 16px rgba(34, 197, 94, 0.6), inset 0 1px 0 rgba(255,255,255,0.4), 0 0 15px rgba(34, 197, 94, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #22c55e, #16a34a, #15803d)",F.target.style.transform="scale(1) translateY(0)",F.target.style.boxShadow="0 4px 12px rgba(34, 197, 94, 0.4), inset 0 1px 0 rgba(255,255,255,0.3), 0 0 10px rgba(34, 197, 94, 0.2)"},children:" PHASE 1 RESULTS"}),e.jsx("span",{style:{fontSize:a?"0.9rem":"1.1rem",background:`linear-gradient(135deg, ${je}, ${je}dd, ${je})`,padding:a?"4px 8px":"6px 12px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2), 0 0 10px rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontWeight:"bold"},children:"Phase 2"}),e.jsx("button",{onClick:F=>{F.stopPropagation(),k(!0)},"aria-label":"Open Phase 2 rules and information",role:"button",tabIndex:"0",style:{background:"linear-gradient(135deg, #ff4444, #cc3333, #aa2222)",border:"2px solid rgba(255,255,255,0.8)",color:"#ffffff",fontSize:a?"0.5rem":"0.8rem",fontWeight:"bold",padding:a?"6px 10px":"8px 14px",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",boxShadow:"0 4px 12px rgba(255, 68, 68, 0.4), inset 0 1px 0 rgba(255,255,255,0.3), 0 0 10px rgba(255, 68, 68, 0.2)",zIndex:10},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #ff6666, #dd4444, #cc3333)",F.target.style.transform="scale(1.05) translateY(-2px)",F.target.style.boxShadow="0 6px 16px rgba(255, 68, 68, 0.6), inset 0 1px 0 rgba(255,255,255,0.4), 0 0 15px rgba(255, 68, 68, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #ff4444, #cc3333, #aa2222)",F.target.style.transform="scale(1) translateY(0)",F.target.style.boxShadow="0 4px 12px rgba(255, 68, 68, 0.4), inset 0 1px 0 rgba(255,255,255,0.3), 0 0 10px rgba(255, 68, 68, 0.2)"},children:" RULES"})]}),e.jsx("div",{style:{color:"#ffffff",fontSize:a?"0.7rem":"0.95rem",lineHeight:"1.1",marginTop:"2px",marginBottom:a?"2px":"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center"},children:re()}),e.jsxs("div",{style:{position:a?"relative":"absolute",left:a?"auto":"8%",top:a?"auto":"50%",transform:a?"none":"translate(-50%, -50%)",cursor:"pointer",fontSize:a?"2.5rem":"3.2rem",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",lineHeight:1,background:"linear-gradient(135deg, rgba(255, 68, 68, 0.25), rgba(220, 53, 69, 0.2), rgba(200, 35, 51, 0.15))",border:"2px solid rgba(255, 68, 68, 0.6)",padding:a?"4px":"6px",borderRadius:a?"12px":"18px",zIndex:1,boxShadow:"0 6px 20px rgba(255, 68, 68, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 0 20px rgba(255, 68, 68, 0.2)",minWidth:a?"60px":"80px",minHeight:a?"75px":"90px",backdropFilter:"blur(8px)",margin:a?"8px auto":"0"},onClick:F=>{F.stopPropagation(),T(!0),p&&p()},"aria-label":"Open player search to schedule Phase 2 matches",role:"button",tabIndex:"0",onMouseEnter:F=>{F.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)",F.currentTarget.style.background="rgba(255, 68, 68, 0.25)",F.currentTarget.style.boxShadow="0 4px 16px rgba(255, 68, 68, 0.5)",F.currentTarget.style.border="2px solid rgba(255, 68, 68, 0.6)"},onMouseLeave:F=>{F.currentTarget.style.transform="translate(-50%, -50%) scale(1)",F.currentTarget.style.background="rgba(255, 68, 68, 0.15)",F.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",F.currentTarget.style.border="1px solid rgba(255, 68, 68, 0.4)"},children:[e.jsx("div",{style:{fontSize:a?"0.35rem":"0.5rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:a?"6px":"8px",textAlign:"center"},children:"Today's Date"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1},children:[e.jsx("div",{style:{fontSize:a?"0.6rem":"0.85rem"},children:(()=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date().getDay()])()}),e.jsx("div",{style:{fontSize:a?"0.85rem":"1.4rem"},children:(()=>{const F=new Date,ae=String(F.getMonth()+1).padStart(2,"0"),I=String(F.getDate()).padStart(2,"0"),X=String(F.getFullYear()).slice(-2);return`${ae}/${I}/${X}`})()})]}),e.jsx("div",{style:{fontSize:a?"0.2rem":"0.45rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginTop:"auto",textAlign:"center",whiteSpace:"nowrap",background:"rgba(0, 0, 0, 0.7)",padding:a?"1px 2px":"2px 3px",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.3)"},children:a?"Schedule":"Click to Schedule Match by Date"})]}),e.jsxs("div",{style:{position:a?"relative":"absolute",right:a?"auto":"8%",top:a?"auto":"50%",transform:a?"none":"translate(50%, -50%)",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",lineHeight:1,background:"linear-gradient(135deg, rgba(52, 152, 219, 0.25), rgba(41, 128, 185, 0.2), rgba(30, 100, 150, 0.15))",border:"2px solid rgba(52, 152, 219, 0.6)",padding:a?"3px":"5px",borderRadius:a?"10px":"16px",zIndex:1,boxShadow:"0 6px 20px rgba(52, 152, 219, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 0 20px rgba(52, 152, 219, 0.2)",minWidth:a?"60px":"80px",minHeight:a?"75px":"90px",backdropFilter:"blur(8px)",margin:a?"8px auto":"0"},title:"Proposal management - view pending and sent proposals",onMouseEnter:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.3), rgba(41, 128, 185, 0.25))",F.currentTarget.style.boxShadow="0 6px 20px rgba(52, 152, 219, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.2)",F.currentTarget.style.border="2px solid rgba(52, 152, 219, 0.7)",F.currentTarget.style.transform="translate(50%, -50%) scale(1.02)"},onMouseLeave:F=>{F.currentTarget.style.background="linear-gradient(135deg, rgba(52, 152, 219, 0.2), rgba(41, 128, 185, 0.15))",F.currentTarget.style.boxShadow="0 4px 16px rgba(52, 152, 219, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)",F.currentTarget.style.border="2px solid rgba(52, 152, 219, 0.5)",F.currentTarget.style.transform="translate(50%, -50%) scale(1)"},children:[e.jsx("div",{style:{fontSize:a?"0.45rem":"0.65rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginBottom:a?"2px":"4px",textAlign:"center",whiteSpace:"nowrap"},children:" Proposals"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a?"2px":"4px",justifyContent:"center",width:"100%"},children:[e.jsxs("button",{onClick:F=>{F.stopPropagation(),u&&u()},style:{background:"linear-gradient(135deg, #d35400 0%, #e67e22 50%, #f39c12 100%)",color:"#ffffff",border:"none",borderRadius:"6px",padding:a?"1px 2px":"3px 4px",fontSize:a?"0.35rem":"0.55rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(211, 84, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #e67e22 0%, #f39c12 50%, #f1c40f 100%)",F.target.style.transform="translateY(-2px) scale(1.02)",F.target.style.boxShadow="0 4px 12px rgba(211, 84, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.6), inset 0 -1px 0 rgba(0, 0, 0, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #d35400 0%, #e67e22 50%, #f39c12 100%)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(211, 84, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)"},children:[" ",g," waiting for you"]}),e.jsxs("button",{onClick:F=>{F.stopPropagation(),h&&h()},style:{background:"linear-gradient(135deg, #1e8449 0%, #27ae60 50%, #2ecc71 100%)",color:"#ffffff",border:"none",borderRadius:"6px",padding:a?"1px 2px":"3px 4px",fontSize:a?"0.35rem":"0.55rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 6px rgba(30, 132, 73, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:"100%",textShadow:"1px 1px 2px rgba(0,0,0,0.5)",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, #27ae60 0%, #2ecc71 50%, #58d68d 100%)",F.target.style.transform="translateY(-2px) scale(1.02)",F.target.style.boxShadow="0 4px 12px rgba(30, 132, 73, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.6), inset 0 -1px 0 rgba(0, 0, 0, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, #1e8449 0%, #27ae60 50%, #2ecc71 100%)",F.target.style.transform="translateY(0) scale(1)",F.target.style.boxShadow="0 2px 6px rgba(30, 132, 73, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)"},children:[" ",f," waiting for opponents"]})]})]}),e.jsxs("div",{style:{color:"#ffffff",fontSize:a?"0.7rem":"0.9rem",fontWeight:"bold",marginTop:a?"4px":"2px",marginBottom:a?"2px":"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",lineHeight:"1.1",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",gap:a?"8px":"12px",flexWrap:"wrap"},children:[e.jsxs("span",{children:[" ",ue,"/4 Matches"]}),e.jsx("span",{children:""}),e.jsxs("span",{style:{color:ve>0?"#4ade80":"#ef4444"},children:[ve," Challenges Left"]}),e.jsx("span",{children:""}),e.jsx("span",{style:{color:Ae?"#4ade80":"#fbbf24"},children:Ae?"Min ":`${J-ue} to min`})]})]}),e.jsx("div",{style:{textAlign:"center",marginBottom:a?"0px":"4px"},children:e.jsx("div",{style:{fontSize:a?"0.5rem":"0.9rem",color:"#ffffff",fontWeight:"bold",cursor:"pointer",padding:a?"1px 3px":"4px 8px",borderRadius:"6px",display:"inline-block",transition:"background-color 0.2s ease",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},onMouseEnter:F=>F.target.style.backgroundColor=`${je}20`,onMouseLeave:F=>F.target.style.backgroundColor="transparent",children:D?"Hide Stats ":"Show Stats "})}),D&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:a?"0.3rem":"0.5rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:a?"0.4rem":"0.6rem",marginBottom:a?"0.3rem":"0.5rem"},children:[e.jsxs("div",{onClick:F=>{F.stopPropagation(),p&&p()},style:{padding:a?"0.4rem":"0.6rem",background:"linear-gradient(135deg, rgba(255, 68, 68, 0.15), rgba(59, 130, 246, 0.1))",borderRadius:"8px",border:"1px solid rgba(255, 68, 68, 0.3)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 68, 68, 0.25), rgba(59, 130, 246, 0.2))",F.target.style.transform="translateY(-2px)",F.target.style.boxShadow="0 4px 12px rgba(255, 68, 68, 0.3)"},onMouseLeave:F=>{F.target.style.background="linear-gradient(135deg, rgba(255, 68, 68, 0.15), rgba(59, 130, 246, 0.1))",F.target.style.transform="translateY(0)",F.target.style.boxShadow="none"},children:[e.jsx("div",{style:{fontSize:a?"0.5rem":"0.85rem",fontWeight:"bold",color:"#ff4444",marginBottom:a?"3px":"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:" Phase 2 Progress"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:a?"4px":"6px",fontSize:a?"0.4rem":"0.7rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginBottom:a?"3px":"4px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ff4444",fontSize:a?"0.35rem":"0.6rem"},children:"Challenges"}),e.jsxs("div",{children:[ue,"/4"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#3b82f6",fontSize:a?"0.35rem":"0.6rem"},children:"Defenses"}),e.jsxs("div",{children:[De,"/2"]})]})]}),e.jsx("div",{style:{width:"100%",height:a?"3px":"4px",background:"rgba(255,255,255,0.2)",borderRadius:"3px",overflow:"hidden",marginBottom:a?"2px":"3px",boxShadow:"inset 0 1px 2px rgba(0,0,0,0.3)"},children:e.jsx("div",{style:{width:`${ue/be*100}%`,height:"100%",background:`linear-gradient(90deg, ${Ze(ue,be)}, ${Ze(ue,be)}dd)`,borderRadius:"3px",transition:"width 0.4s ease",boxShadow:"0 0 4px rgba(255,255,255,0.3)"}})}),e.jsx("div",{style:{fontSize:a?"0.35rem":"0.7rem",color:Ae?"#4ade80":"#fbbf24",fontWeight:"bold",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:Ae?" Min met":`${J-ue} to min`})]}),e.jsxs("div",{style:{padding:a?"0.4rem":"0.6rem",background:"linear-gradient(135deg, rgba(168, 85, 247, 0.15), rgba(255, 193, 7, 0.1))",borderRadius:"8px",border:"1px solid rgba(168, 85, 247, 0.3)",textAlign:"center",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{fontSize:a?"0.5rem":"0.85rem",fontWeight:"bold",color:"#a855f7",marginBottom:a?"3px":"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:" Challenge Limits"}),e.jsxs("div",{style:{fontSize:a?"0.45rem":"1rem",color:"#ffffff",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",marginBottom:a?"3px":"4px"},children:[ve," remaining"]}),e.jsxs("div",{style:{fontSize:a?"0.35rem":"0.6rem",color:"#fbbf24",marginBottom:a?"2px":"3px"},children:[((Ee=_.dynamicLimits)==null?void 0:Ee.timesChallenged)||0," times challenged"]}),e.jsxs("div",{style:{fontSize:a?"0.35rem":"0.7rem",color:ve>0?"#4ade80":"#ef4444",fontWeight:"bold",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:[Ce," issued"]})]})]})}),e.jsxs("div",{style:{padding:a?"0.5rem":"0.8rem",background:"linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(22, 163, 74, 0.1))",border:"1px solid rgba(34, 197, 94, 0.4)",borderRadius:"8px",marginBottom:a?"0.4rem":"0.6rem",color:"#ffffff",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.2)"},children:[e.jsx("div",{style:{fontSize:a?"0.45rem":"0.8rem",fontWeight:"bold",color:"#22c55e",marginBottom:a?"0.3rem":"0.5rem",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:" Current Record & Standings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:a?"0.4rem":"0.6rem",fontSize:a?"0.4rem":"0.7rem",color:"#ffffff",textAlign:"center",lineHeight:a?"1.3":"1.4"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:a?"0.2rem":"0.3rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#22c55e",marginBottom:"2px"},children:"Wins"}),e.jsx("div",{style:{fontSize:a?"0.35rem":"0.6rem",fontWeight:"bold"},children:(z==null?void 0:z.wins)||0})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:a?"0.2rem":"0.3rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ef4444",marginBottom:"2px"},children:"Losses"}),e.jsx("div",{style:{fontSize:a?"0.35rem":"0.6rem",fontWeight:"bold"},children:(z==null?void 0:z.losses)||0})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:a?"0.2rem":"0.3rem",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#3b82f6",marginBottom:"2px"},children:"Win Rate"}),e.jsxs("div",{style:{fontSize:a?"0.35rem":"0.6rem",fontWeight:"bold"},children:[(z==null?void 0:z.winRate)||0,"%"]})]})]}),e.jsxs("div",{style:{marginTop:a?"0.3rem":"0.5rem",padding:a?"0.2rem":"0.3rem",background:"rgba(168, 85, 247, 0.2)",borderRadius:"4px",border:"1px solid rgba(168, 85, 247, 0.4)",textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#a855f7",marginBottom:"2px",fontSize:a?"0.35rem":"0.6rem"},children:"Current Standings Position"}),e.jsx("div",{style:{fontSize:a?"0.4rem":"0.7rem",fontWeight:"bold"},children:(z==null?void 0:z.position)||"N/A"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:a?"0.4rem":"0.6rem",marginBottom:a?"0.3rem":"0.5rem"},children:[e.jsxs("div",{style:{padding:a?"0.4rem":"0.6rem",background:"rgba(255,255,255,0.1)",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)",textAlign:"center",cursor:"pointer",transition:"background-color 0.2s ease"},onClick:F=>{F.stopPropagation(),p&&p()},onMouseEnter:F=>F.target.style.backgroundColor="rgba(255,255,255,0.15)",onMouseLeave:F=>F.target.style.backgroundColor="rgba(255,255,255,0.1)",children:[e.jsx("div",{style:{fontSize:a?"0.4rem":"0.7rem",fontWeight:"bold",color:"#e0e0e0",marginBottom:a?"1px":"2px"},children:" Schedule Match"}),e.jsxs("div",{style:{fontSize:a?"0.35rem":"0.8rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:a?"1px":"2px"},children:[j.eligibleOpponentsCount," available"]}),e.jsx("div",{style:{fontSize:a?"0.35rem":"0.65rem",color:"#e0e0e0",fontStyle:"italic",textAlign:"center",fontWeight:"500"},children:"click to schedule"})]}),e.jsxs("div",{style:{padding:a?"0.4rem":"0.6rem",background:"rgba(255,255,255,0.1)",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)",textAlign:"center",cursor:"pointer",transition:"background-color 0.2s ease"},onClick:F=>{F.stopPropagation(),d&&d()},onMouseEnter:F=>F.target.style.backgroundColor="rgba(255,255,255,0.15)",onMouseLeave:F=>F.target.style.backgroundColor="rgba(255,255,255,0.1)",children:[e.jsx("div",{style:{fontSize:a?"0.4rem":"0.7rem",fontWeight:"bold",color:"#e0e0e0",marginBottom:a?"1px":"2px"},children:" View Matches"}),e.jsxs("div",{style:{fontSize:a?"0.35rem":"0.8rem",color:"#ffffff",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginBottom:a?"1px":"2px"},children:[m.length," upcoming"]}),e.jsx("div",{style:{fontSize:a?"0.35rem":"0.65rem",color:"#e0e0e0",fontStyle:"italic",textAlign:"center",fontWeight:"500"},children:"click for details"})]})]}),m.length>0&&e.jsxs("div",{style:{marginBottom:a?"0.3rem":"0.5rem"},children:[e.jsx("div",{style:{fontSize:a?"0.4rem":"0.7rem",fontWeight:"bold",color:"#ffffff",marginBottom:a?"0.2rem":"0.4rem",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"Upcoming Matches"}),e.jsxs("div",{style:{maxHeight:a?"50px":"60px",overflowY:"auto",background:"rgba(0,0,0,0.3)",borderRadius:"4px",padding:a?"0.2rem":"0.4rem"},children:[m.slice(0,2).map((F,ae)=>{let I="";return F.senderName&&F.receiverName&&(I=F.senderName.trim().toLowerCase()===W.toLowerCase()?F.receiverName:F.senderName),e.jsxs("div",{style:{fontSize:a?"0.3rem":"0.6rem",color:"#ffffff",padding:a?"0.15rem 0.25rem":"0.25rem 0.4rem",marginBottom:a?"0.1rem":"0.15rem",background:"rgba(255,255,255,0.1)",borderRadius:"3px",cursor:"pointer",transition:"background-color 0.2s ease",textAlign:"center"},onClick:X=>{X.stopPropagation(),v&&v(F)},onMouseEnter:X=>X.target.style.backgroundColor="rgba(255,255,255,0.2)",onMouseLeave:X=>X.target.style.backgroundColor="rgba(255,255,255,0.1)",children:["VS ",I||"Unknown"," - ",F.date||"No Date"]},F._id||ae)}),m.length>2&&e.jsxs("div",{style:{fontSize:a?"0.3rem":"0.6rem",color:"#e0e0e0",textAlign:"center",fontStyle:"italic",padding:a?"0.15rem":"0.25rem"},children:["+",m.length-2," more..."]})]})]}),e.jsxs("div",{style:{padding:a?"0.4rem":"0.6rem",background:"linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(0,0,0,0.2))",borderRadius:"6px",border:"1px solid rgba(255, 193, 7, 0.3)",fontSize:a?"0.35rem":"0.65rem",color:"#ffffff",textAlign:"center",marginBottom:a?"0.3rem":"0.5rem"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffc107",marginBottom:"3px"},children:" Phase 2 Status"}),e.jsxs("div",{style:{fontSize:a?"0.3rem":"0.55rem",lineHeight:"1.3"},children:[Ae?e.jsxs("span",{style:{color:"#4ade80"},children:[" Minimum met (",ue,"/4 matches)"]}):e.jsxs("span",{style:{color:"#fbbf24"},children:[" Need ",J-ue," more to minimum"]}),ve>0&&e.jsxs("span",{style:{color:"#3b82f6"},children:["  Can challenge ",ve," more (max 4 spots higher)"]})]})]})]}),e.jsx(kC,{isOpen:A,onClose:()=>k(!1),isMobile:a}),e.jsx(eH,{isOpen:R,onClose:()=>U(!1),phase1Stats:z,playerName:n,playerLastName:t,isMobile:a})]})}const rH=({phase1EndDate:n,isMobile:t,currentMonth:r,onMonthChange:s,onOpenOpponentsModal:a,upcomingMatches:o,playerName:i,playerLastName:l,onDateSelect:c,onMatchClick:d})=>{const u=new Date,h=r.getMonth(),p=r.getFullYear(),g=new Date(p,h,1),m=new Date(p,h+1,0).getDate(),v=g.getDay(),b=[];for(let A=0;A<v;A++)b.push(null);for(let A=1;A<=m;A++)b.push(A);const w=b.length,x=7-w%7;for(let A=0;A<x;A++)b.push(null);const j=x>=3;console.log(`Calendar debug: totalCells=${w}, emptyCellsInLastRow=${x}, needsMoreMargin=${j}`);const S=A=>!n||!A?!1:A===n.getDate()&&h===n.getMonth()&&p===n.getFullYear(),_=A=>A===u.getDate()&&h===u.getMonth()&&p===u.getFullYear(),C=A=>A&&A<u.getDate()&&h===u.getMonth()&&p===u.getFullYear(),N=["January","February","March","April","May","June","July","August","September","October","November","December"],M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E=()=>{const A=new Date(p,h-1,1);s(A)},P=()=>{const A=new Date(p,h+1,1);s(A)},D=A=>{if(!A||!o)return[];const R=new Date(p,h,A).toISOString().split("T")[0];return o.filter(U=>{let z=null;if(U.scheduledDate){const $=new Date(U.scheduledDate);isNaN($.getTime())||(z=$.toISOString().split("T")[0])}else if(U.date){const $=U.date.split("-");if($.length===3){const[W,Y,Q]=$;z=`${Q}-${W.padStart(2,"0")}-${Y.padStart(2,"0")}`}}return z===R})},T=A=>D(A).length>0;return e.jsxs("div",{style:{color:"#ffffff"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:t?"2px":"4px"},children:[e.jsx("button",{onClick:E,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#ffffff",fontSize:t?"0.9rem":"1rem",cursor:"pointer",padding:t?"4px 6px":"6px 8px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:A=>A.target.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:A=>A.target.style.background="rgba(255, 255, 255, 0.1)",children:""}),e.jsxs("div",{style:{textAlign:"center",fontSize:t?"1rem":"1.2rem",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",width:"100%"},children:[N[h]," ",p]}),e.jsx("button",{onClick:P,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#ffffff",fontSize:t?"0.9rem":"1rem",cursor:"pointer",padding:t?"4px 6px":"6px 8px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:A=>A.target.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:A=>A.target.style.background="rgba(255, 255, 255, 0.1)",children:""})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0px",marginBottom:t?"2px":"3px"},children:M.map(A=>e.jsx("div",{style:{textAlign:"center",fontSize:t?"0.8rem":"0.9rem",fontWeight:"bold",color:"#cccccc",padding:t?"2px 1px":"3px 1px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:A},A))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0px",width:t?"450px":"800px",height:t?"280px":"400px",margin:"0 auto"},children:b.map((A,k)=>e.jsx("div",{onClick:()=>{if(A&&!T(A)&&c){const R=new Date(p,h,A);c(R)}},title:T(A)?D(A).map(R=>{let U="";return R.player1Id&&R.player2Id?U=R.player1Id.trim().toLowerCase()===`${i} ${l}`.trim().toLowerCase()?R.player2Id:R.player1Id:R.senderName&&R.receiverName&&(U=R.senderName.trim().toLowerCase()===`${i} ${l}`.trim().toLowerCase()?R.receiverName:R.senderName),`Click to view match details vs ${U}`}).join(", "):"Click to schedule match",style:{aspectRatio:"1.2",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",fontSize:t?"0.9rem":"1rem",fontWeight:"bold",borderRadius:"2px",cursor:A?"pointer":"default",background:A?S(A)?"#e74c3c":C(A)?"rgba(255,255,255,0.1)":"transparent":"transparent",border:A?S(A)?"1px solid #c0392b":_(A)?"2px solid #4CAF50":"1px solid rgba(255,255,255,0.1)":"none",color:A?S(A)||_(A)?"#ffffff":C(A)?"#888888":"#ffffff":"transparent",transition:"all 0.2s ease",padding:"2px"},onMouseEnter:R=>{A&&(R.target.style.transform="scale(1.05)",R.target.style.boxShadow="0 2px 8px rgba(255,255,255,0.2)")},onMouseLeave:R=>{A&&(R.target.style.transform="scale(1)",R.target.style.boxShadow="none")},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"space-between",width:"100%",height:"100%"},children:[e.jsx("span",{style:{fontSize:t?"0.8rem":"0.9rem",fontWeight:"bold",color:"inherit",textAlign:"right",padding:"1px"},children:A||""}),T(A)&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1px",padding:"1px",flex:1,justifyContent:"flex-end"},children:[(()=>D(A).slice(0,t?2:3).map((U,z)=>{let $="";U.player1Id&&U.player2Id?$=U.player1Id.trim().toLowerCase()===`${i} ${l}`.trim().toLowerCase()?U.player2Id:U.player1Id:U.senderName&&U.receiverName&&($=U.senderName.trim().toLowerCase()===`${i} ${l}`.trim().toLowerCase()?U.receiverName:U.senderName);const W=$.length>(t?8:10)?$.substring(0,t?8:10)+"...":$;return e.jsx("div",{style:{fontSize:t?"0.5rem":"0.6rem",color:"#4CAF50",fontWeight:"bold",textAlign:"center",cursor:"pointer",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",padding:"1px",borderRadius:"1px",background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",transition:"all 0.2s ease",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onMouseEnter:Y=>{Y.target.style.background="rgba(76, 175, 80, 0.3)",Y.target.style.transform="scale(1.05)"},onMouseLeave:Y=>{Y.target.style.background="rgba(76, 175, 80, 0.1)",Y.target.style.transform="scale(1)"},onClick:Y=>{Y.stopPropagation(),d&&d(U)},title:`Click to view match details vs ${$}`,children:W},U._id||z)}))(),(()=>{const R=D(A);return R.length>(t?2:3)?e.jsxs("div",{style:{fontSize:t?"0.4rem":"0.5rem",color:"#4CAF50",textAlign:"center",padding:"1px",fontStyle:"italic"},children:["+",R.length-(t?2:3)," more"]}):null})()]})]})},k))}),e.jsxs("div",{style:{marginTop:(()=>{const A=j?t?"60px":"80px":t?"20px":"24px";return console.log(`Legend margin: needsMoreMargin=${j}, isMobile=${t}, margin=${A}`),A})(),fontSize:t?"0.7rem":"0.8rem",display:"flex",flexDirection:"column",gap:"6px",padding:t?"12px":"16px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:t?"3px":"4px"},children:[e.jsx("div",{style:{width:t?"6px":"8px",height:t?"6px":"8px",background:"transparent",border:"1px solid #4CAF50",borderRadius:"1px"}}),e.jsx("span",{children:"Today (outline)"})]}),n&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:t?"3px":"4px"},children:[e.jsx("div",{style:{width:t?"6px":"8px",height:t?"6px":"8px",background:"#e74c3c",border:"1px solid #c0392b",borderRadius:"1px"}}),e.jsxs("span",{children:["Phase 1 Deadline (",As(n,"MMM d, yyyy"),")"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:t?"3px":"4px"},children:[e.jsx("div",{style:{width:t?"6px":"8px",height:t?"6px":"8px",background:"transparent",border:"1px solid #4CAF50",borderRadius:"50%",position:"relative"},children:e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"2px",height:"2px",background:"#4CAF50",borderRadius:"50%"}})}),e.jsx("span",{children:"Click scheduled opponent for match details"})]})]})]})},nH=({isOpen:n,onClose:t,isMobile:r,phase1EndDate:s,upcomingMatches:a,playerName:o,playerLastName:i,onOpenOpponentsModal:l,onMatchClick:c,onSmartMatchClick:d})=>{const[u,h]=y.useState(new Date);return n?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)",padding:"60px"},onClick:t,children:e.jsxs("div",{style:{background:r?"rgba(0, 0, 0, 0.9)":"linear-gradient(120deg, #232323 80%, #2a0909 100%)",border:r?"2px solid rgba(255, 255, 255, 0.3)":"2px solid #e53e3e",borderRadius:r?"16px":"1.2rem",padding:r?"12px":"0",width:r?"95%":"auto",maxWidth:r?"none":"700px",minWidth:r?"auto":"400px",boxShadow:r?"0 8px 32px rgba(0,0,0,0.6)":"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",backdropFilter:r?"blur(12px)":"none",maxHeight:r?"80%":"65vh",overflow:"auto",margin:r?"0":"0 auto",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",display:"flex",flexDirection:"column"},onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{style:{position:"relative",textAlign:"center",marginBottom:r?"12px":"0",padding:r?"8px":"1.1rem 1.5rem 0.7rem 1.5rem",borderRadius:r?"12px":"1.2rem 1.2rem 0 0",background:r?"rgba(0, 0, 0, 0.6)":"#e53e3e",border:r?"1px solid rgba(255,255,255,0.2)":"none",boxShadow:r?"0 4px 16px rgba(0,0,0,0.3)":"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:r?"default":"grab",userSelect:"none"},children:[!r&&e.jsx("span",{style:{position:"absolute",left:0,top:0,width:"100%",height:"5px",background:"linear-gradient(90deg, #fff0 0%, #e53e3e 60%, #fff0 100%)",borderTopLeftRadius:"1.2rem",borderTopRightRadius:"1.2rem",pointerEvents:"none"}}),e.jsx("h3",{style:{margin:0,color:"#ffffff",fontSize:r?"1.2rem":"1.3rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",textShadow:r?"2px 2px 4px rgba(0,0,0,0.8)":"0 1px 12px #000a",letterSpacing:r?"0.5px":"0.02em",wordBreak:"break-word",minWidth:0},children:e.jsx("span",{style:{fontSize:r?"1rem":"1.3rem",background:r?"linear-gradient(45deg, #4CAF50, #4CAF50dd)":"none",padding:r?"8px 16px":"0",borderRadius:r?"8px":"0",boxShadow:r?"0 4px 16px rgba(0,0,0,0.4)":"none"},children:" Phase 1 Calendar"})}),e.jsx("button",{onClick:t,style:{position:"absolute",right:r?"8px":"1.5rem",top:"50%",transform:"translateY(-50%)",background:r?"rgba(255, 255, 255, 0.1)":"none",border:r?"1px solid rgba(255, 255, 255, 0.3)":"none",color:"#ffffff",fontSize:r?"1.2rem":"2em",cursor:"pointer",padding:"0",width:r?"32px":"auto",height:r?"32px":"auto",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:r?"50%":"0",transition:"all 0.2s ease",fontWeight:"bold",lineHeight:1,zIndex:10},onMouseEnter:p=>{r?(p.target.style.background="rgba(255, 255, 255, 0.2)",p.target.style.transform="scale(1.1)"):p.target.style.color="#ffd6d6"},onMouseLeave:p=>{r?(p.target.style.background="rgba(255, 255, 255, 0.1)",p.target.style.transform="scale(1)"):p.target.style.color="#ffffff"},children:""})]}),e.jsxs("div",{style:{padding:r?"0":"0.8rem",flex:1,overflow:"auto",maxHeight:"calc(100vh - 200px)"},children:[e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.15)",border:"1px solid rgba(76, 175, 80, 0.4)",borderRadius:"12px",padding:r?"6px":"10px",marginBottom:r?"6px":"10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:r?"0.8rem":"1rem",color:"#ffffff",fontWeight:"bold",marginBottom:r?"3px":"4px",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:" Click any date to see opponents available for that day"}),e.jsx("div",{style:{fontSize:r?"0.7rem":"0.9rem",color:"#cccccc",fontStyle:"italic",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:" Or click the Progress meter on the home screen to see all available opponents"}),e.jsx("div",{style:{fontSize:r?"0.7rem":"0.9rem",color:"#cccccc",fontStyle:"italic",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",marginTop:r?"2px":"3px",marginBottom:r?"4px":"6px"},children:" Smart Match pairs you with assigned opponents based on matching availability"}),e.jsx("button",{onClick:()=>{console.log(" Calendar Modal: Smart Match button clicked"),d?(console.log(" Calendar Modal: Calling onSmartMatchClick"),d()):(console.log(" Calendar Modal: onSmartMatchClick is not defined"),alert("Smart Match functionality is not available. Please try again."))},style:{background:"linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1))",border:"1px solid rgba(255, 193, 7, 0.4)",color:"#ffffff",fontSize:r?"0.7rem":"0.8rem",fontWeight:"bold",cursor:"pointer",padding:r?"8px 12px":"10px 16px",borderRadius:"8px",transition:"all 0.3s ease",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",boxShadow:"0 2px 8px rgba(255, 193, 7, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",margin:"0 auto",zIndex:10},onMouseEnter:p=>{p.target.style.background="linear-gradient(135deg, rgba(255, 193, 7, 0.4), rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2))",p.target.style.transform="scale(1.02) translateY(-1px)",p.target.style.boxShadow="0 4px 12px rgba(255, 193, 7, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)"},onMouseLeave:p=>{p.target.style.background="linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1))",p.target.style.transform="scale(1)",p.target.style.boxShadow="0 2px 8px rgba(255, 193, 7, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)"},children:" Smart Match"})]}),e.jsx(rH,{phase1EndDate:s,isMobile:r,currentMonth:u,onMonthChange:h,onOpenOpponentsModal:l,upcomingMatches:a,playerName:o,playerLastName:i,onMatchClick:c,onDateSelect:p=>{console.log(" Calendar Modal: Date selected:",p),l?(console.log(" Calendar Modal: Calling onOpenOpponentsModal"),l(p)):console.log(" Calendar Modal: onOpenOpponentsModal is not defined")}})]})]})}):null},sH=({isOpen:n,onClose:t,match:r,onValidate:s,onReject:a})=>{const[o,i]=y.useState({actualDate:"",actualTime:"",actualLocation:"",winner:"",score:"",notes:"",witnesses:"",photos:null}),[l,c]=y.useState(!1);if(!n||!r)return null;const d=async h=>{h.preventDefault(),c(!0);try{if(!o.actualDate||!o.winner||!o.score){alert("Please fill in all required fields: Date, Winner, and Score");return}await s({matchId:r._id,...o}),t()}catch(p){console.error("Error validating match:",p),alert("Error validating match. Please try again.")}finally{c(!1)}},u=async()=>{if(window.confirm("Are you sure you want to reject this match completion? This will require the match to be replayed.")){c(!0);try{await a(r._id),t()}catch(h){console.error("Error rejecting match:",h),alert("Error rejecting match. Please try again.")}finally{c(!1)}}};return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#222",border:"2px solid #444",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{margin:0,color:"#fff"},children:" Match Validation"}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#aaa",fontSize:"24px",cursor:"pointer"},children:""})]}),e.jsxs("div",{style:{background:"#333",padding:"16px",borderRadius:"8px",marginBottom:"20px"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff"},children:"Match Details"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Players:"})," ",r.player1," vs ",r.player2]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled Date:"})," ",r.date]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",r.location]})]})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:["Actual Date Played * ",e.jsx("span",{style:{color:"#ff4444"},children:"Required"})]}),e.jsx("input",{type:"date",value:o.actualDate,onChange:h=>i({...o,actualDate:h.target.value}),style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"},required:!0})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:"Actual Time Played"}),e.jsx("input",{type:"time",value:o.actualTime,onChange:h=>i({...o,actualTime:h.target.value}),style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:"Actual Location"}),e.jsx("input",{type:"text",value:o.actualLocation,onChange:h=>i({...o,actualLocation:h.target.value}),placeholder:"Where was the match actually played?",style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:["Winner * ",e.jsx("span",{style:{color:"#ff4444"},children:"Required"})]}),e.jsxs("select",{value:o.winner,onChange:h=>i({...o,winner:h.target.value}),style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"},required:!0,children:[e.jsx("option",{value:"",children:"Select winner..."}),e.jsx("option",{value:r.player1,children:r.player1}),e.jsx("option",{value:r.player2,children:r.player2})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:["Final Score * ",e.jsx("span",{style:{color:"#ff4444"},children:"Required"})]}),e.jsx("input",{type:"text",value:o.score,onChange:h=>i({...o,score:h.target.value}),placeholder:"e.g., 7-3, 8-2, etc.",style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"},required:!0})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:"Witnesses (optional)"}),e.jsx("input",{type:"text",value:o.witnesses,onChange:h=>i({...o,witnesses:h.target.value}),placeholder:"Names of people who witnessed the match",style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff"},children:"Additional Notes"}),e.jsx("textarea",{value:o.notes,onChange:h=>i({...o,notes:h.target.value}),placeholder:"Any additional details about the match...",rows:"3",style:{width:"100%",padding:"8px",background:"#333",border:"1px solid #555",borderRadius:"4px",color:"#fff",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:u,disabled:l,style:{padding:"10px 16px",background:"#ff4444",border:"none",borderRadius:"6px",color:"#fff",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Rejecting...":"Reject Match"}),e.jsx("button",{type:"submit",disabled:l,style:{padding:"10px 16px",background:"#00aa00",border:"none",borderRadius:"6px",color:"#fff",cursor:l?"not-allowed":"pointer",opacity:l?.6:1},children:l?"Validating...":"Validate Match"})]})]})]})})};class aH extends Te.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){this.setState({error:t,errorInfo:r}),console.error("ErrorBoundary caught an error:",t,r)}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",margin:"10px",border:"1px solid #ff6b6b",borderRadius:"8px",backgroundColor:"#fff5f5",color:"#d63031"},children:[e.jsx("h3",{children:"Something went wrong."}),e.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),e.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),style:{marginTop:"10px",padding:"8px 16px",backgroundColor:"#ff6b6b",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Try again"})]}):this.props.children}}function CC({isOpen:n,onClose:t,isMobile:r}){return n?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"10px"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #4CAF50",borderRadius:"12px",width:r?"98%":"50%",maxWidth:"500px",height:r?"98%":"90vh",maxHeight:"800px",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#ffffff"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",padding:"20px",borderBottom:"2px solid #4CAF50",flexShrink:0},children:[e.jsx("h2",{style:{margin:0,fontSize:r?"1.2rem":"1.5rem",color:"#ffffff",fontWeight:"bold",display:"flex",alignItems:"center",gap:"10px",textAlign:"center"},children:" Phase 1 Scheduled Opponents Rules"}),e.jsx("button",{onClick:t,style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#ffffff",fontSize:"2rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease"},onMouseEnter:s=>s.target.style.backgroundColor="rgba(255,255,255,0.1)",onMouseLeave:s=>s.target.style.backgroundColor="transparent",children:""})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"25px",fontSize:r?"1rem":"1.1rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Overview"}),e.jsx("p",{style:{margin:"0 0 15px 0",color:"#e0e0e0"},children:"Phase 1 covers Weeks 1-6 where each player is assigned specific opponents to schedule and complete matches with."}),e.jsx("p",{style:{margin:"0 0 15px 0",color:"#e0e0e0"},children:"This phase focuses on completing your assigned matches with maximum scheduling flexibility."})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Opponent Assignment"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Assigned Opponents:"})," Each player is assigned 6 opponents at the start of the session"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Match Requirements:"})," You must complete 1 match against each of your 6 assigned opponents"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Total Matches:"})," 6 matches total during Phase 1"]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Scheduling Flexibility"}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"15px"},children:[e.jsx("p",{style:{margin:"0 0 10px 0",color:"#4CAF50",fontWeight:"bold"},children:"Maximum scheduling flexibility for your convenience:"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"Any Day:"})," Matches may be played on any day of the week"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"Any Time:"})," Matches may be played at any time that works for both players"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"Any Location:"})," Matches may be played at any safe, mutually agreed location"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Completion Deadline"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"15px"},children:[e.jsx("p",{style:{margin:"0 0 10px 0",color:"#ffc107",fontWeight:"bold"},children:"All Phase 1 matches must be completed by the end of Week 6"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"Deadline:"})," End of Week 6 (Sunday at 11:59 PM)"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"No Extensions:"})," Phase 1 deadline is firm and cannot be extended"]}),e.jsxs("li",{style:{marginBottom:"5px"},children:[e.jsx("strong",{children:"Impact:"})," Incomplete matches may affect your standings and Phase 2 eligibility"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Match Rules"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Standard Rules:"})," All matches use the official CSI rule book"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Scoring:"})," All scoring must be done with the BCAPL scoring app"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Payment:"})," Standard match payment and fees apply"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"FargoRate:"})," All matches are integrated with FargoRate for ratings"]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("h3",{style:{color:"#4CAF50",fontSize:r?"1.2rem":"1.4rem",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:" Scheduling Process"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Contact Opponents:"})," Reach out to your assigned opponents to schedule matches"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Mutual Agreement:"})," Both players must agree on date, time, and location"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Record Matches:"})," All scheduled matches must be recorded in the League Scheduling Hub"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Communication:"})," Use the message center to coordinate with opponents"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"15px",marginTop:"20px"},children:[e.jsx("h4",{style:{color:"#ff4444",fontSize:r?"1rem":"1.1rem",margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"8px"},children:" Important Notes"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#e0e0e0",fontSize:r?"0.85rem":"0.9rem"},children:[e.jsx("li",{style:{marginBottom:"5px"},children:"Phase 1 results determine your standings position for Phase 2 challenges"}),e.jsx("li",{style:{marginBottom:"5px"},children:"Incomplete matches may result in forfeits and affect your overall standings"}),e.jsx("li",{style:{marginBottom:"5px"},children:"All matches must be completed and recorded before Phase 2 begins"}),e.jsx("li",{style:{marginBottom:"5px"},children:"Use the calendar feature to track your scheduled matches and deadlines"})]})]})]}),e.jsx("div",{style:{textAlign:"center",padding:"20px",borderTop:"1px solid rgba(255,255,255,0.2)",flexShrink:0},children:e.jsx("button",{onClick:t,style:{background:"linear-gradient(135deg, #4CAF50, #45a049)",border:"none",color:"#ffffff",fontSize:r?"0.9rem":"1rem",fontWeight:"bold",padding:r?"10px 20px":"12px 25px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},onMouseEnter:s=>{s.target.style.transform="translateY(-2px)",s.target.style.boxShadow="0 6px 12px rgba(0,0,0,0.4)"},onMouseLeave:s=>{s.target.style.transform="translateY(0)",s.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},children:"Got It! "})})]})}):null}const oH=({isOpen:n,onClose:t,isMobile:r,playerName:s,playerLastName:a,completedMatches:o,totalRequiredMatches:i,playerStats:l,standings:c,timeLeft:d,deadlineStatus:u,phase1EndDate:h,allPlayers:p,selectedDivision:g})=>{const[f,m]=y.useState(null);y.useEffect(()=>{n&&p&&c&&v()},[n,p,c]);const v=()=>{if(!p||!c)return;const x=p.length,j=c.filter(E=>E.matchesCompleted&&E.matchesCompleted>0).length,S=c.reduce((E,P)=>E+(P.matchesCompleted||0),0),_=x*i,C=Math.round(S/_*100),N=Math.round(S/x/i*100),M=c.filter(E=>E.matchesCompleted>0).sort((E,P)=>{const D=(E.matchesCompleted||0)/i;return(P.matchesCompleted||0)/i-D}).slice(0,5);m({totalPlayers:x,playersWithMatches:j,totalMatchesCompleted:S,totalMatchesRequired:_,leagueProgress:C,avgCompletion:N,topPerformers:M})},b=()=>u==="passed"?"#e74c3c":u==="critical"?"#ff6b6b":u==="urgent"?"#ff8800":u==="warning"?"#ffaa00":"#4CAF50",w=()=>u==="passed"?"":u==="critical"?"":u==="urgent"||u==="warning"?"":"";return n?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},onClick:t,children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 20, 20, 0.95))",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:r?"8px":"12px",padding:r?"8px":"12px",width:r?"88%":"75%",maxWidth:r?"none":"800px",maxHeight:r?"75vh":"70vh",overflow:"auto",boxShadow:"0 8px 32px rgba(0,0,0,0.5), 0 4px 16px rgba(255,255,255,0.1)",backdropFilter:"blur(12px)"},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:r?"8px":"12px",paddingBottom:r?"6px":"8px",borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:r?"4px":"8px"},children:[e.jsx("div",{style:{fontSize:r?"1rem":"1.2rem",color:b()},children:w()}),e.jsx("h2",{style:{margin:0,color:"#ffffff",fontSize:r?"0.8rem":"1.1rem",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:"Phase 1 Overview"})]}),e.jsx("button",{onClick:t,style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)",color:"#ffffff",fontSize:r?"0.9rem":"1.1rem",cursor:"pointer",padding:r?"4px 8px":"6px 10px",borderRadius:"4px",transition:"all 0.2s ease",fontWeight:"bold"},onMouseEnter:x=>x.target.style.background="rgba(255,255,255,0.2)",onMouseLeave:x=>x.target.style.background="rgba(255,255,255,0.1)",children:"Close"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:r?"1fr":"1fr 1fr",gap:r?"8px":"12px"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:r?"8px":"12px",border:"1px solid rgba(255,255,255,0.15)"},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"Your Status"}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"6px":"8px",marginBottom:r?"6px":"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"600"},children:"Progress"}),e.jsxs("span",{style:{color:"#4CAF50",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold"},children:[o.length,"/",i]})]}),e.jsx("div",{style:{width:"100%",height:r?"6px":"8px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.round(o.length/i*100)}%`,height:"100%",background:`linear-gradient(90deg, ${b()}, ${b()}dd)`,borderRadius:"4px",transition:"width 0.4s ease"}})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:r?"6px":"8px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"6px",padding:r?"6px":"8px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#cccccc",fontSize:r?"0.6rem":"0.8rem",marginBottom:"3px"},children:"Record"}),e.jsxs("div",{style:{color:"#ffffff",fontSize:r?"0.8rem":"1rem",fontWeight:"bold"},children:[(l==null?void 0:l.wins)||0,"-",(l==null?void 0:l.losses)||0]}),e.jsxs("div",{style:{color:"#4CAF50",fontSize:r?"0.6rem":"0.8rem",fontWeight:"600"},children:[(l==null?void 0:l.winRate)||0,"%"]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"6px",padding:r?"6px":"8px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#cccccc",fontSize:r?"0.6rem":"0.8rem",marginBottom:"3px"},children:"Position"}),e.jsx("div",{style:{color:"#ffffff",fontSize:r?"0.8rem":"1rem",fontWeight:"bold"},children:(l==null?void 0:l.position)||"N/A"})]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"6px":"8px",marginTop:r?"6px":"8px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#cccccc",fontSize:r?"0.6rem":"0.8rem",marginBottom:"4px"},children:"Time Remaining"}),e.jsx("div",{style:{color:b(),fontSize:r?"0.8rem":"1rem",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:d!=null&&d.passed?"DEADLINE PASSED":(d==null?void 0:d.days)>0?`${d.days} days`:(d==null?void 0:d.hours)>0?`${d.hours} hours`:"Less than 1 hour"}),h&&e.jsxs("div",{style:{color:"#cccccc",fontSize:r?"0.5rem":"0.7rem",marginTop:"2px"},children:["Ends: ",As(h,"MMM d, yyyy")]})]})]}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:r?"8px":"12px",border:"1px solid rgba(255,255,255,0.15)"},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold",textAlign:"center",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"League Status"}),f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"6px":"8px",marginBottom:r?"6px":"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"600"},children:"League Progress"}),e.jsxs("span",{style:{color:"#4CAF50",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold"},children:[f.leagueProgress,"%"]})]}),e.jsx("div",{style:{width:"100%",height:r?"6px":"8px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${f.leagueProgress}%`,height:"100%",background:"linear-gradient(90deg, #4CAF50, #45a049)",borderRadius:"4px",transition:"width 0.4s ease"}})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:r?"4px":"6px",marginBottom:r?"6px":"8px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"4px":"6px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#cccccc",fontSize:r?"0.5rem":"0.7rem",marginBottom:"2px"},children:"Active Players"}),e.jsxs("div",{style:{color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold"},children:[f.playersWithMatches,"/",f.totalPlayers]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"4px":"6px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#cccccc",fontSize:r?"0.5rem":"0.7rem",marginBottom:"2px"},children:"Avg Completion"}),e.jsxs("div",{style:{color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"bold"},children:[f.avgCompletion,"%"]})]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"4px",padding:r?"6px":"8px"},children:[e.jsx("div",{style:{color:"#ffffff",fontSize:r?"0.7rem":"0.9rem",fontWeight:"600",marginBottom:"4px",textAlign:"center"},children:"Top Performers"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:f.topPerformers.map((x,j)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"rgba(255,255,255,0.03)",borderRadius:"4px"},children:[e.jsxs("span",{style:{color:"#ffffff",fontSize:r?"0.5rem":"0.7rem",fontWeight:j===0?"bold":"normal"},children:[j+1,". ",x.name]}),e.jsxs("span",{style:{color:"#4CAF50",fontSize:r?"0.5rem":"0.7rem",fontWeight:"600"},children:[Math.round(x.matchesCompleted/i*100),"%"]})]},j))})]})]}):e.jsx("div",{style:{color:"#cccccc",textAlign:"center",fontSize:r?"0.9rem":"1.1rem",padding:"20px"},children:"Loading league statistics..."})]})]}),e.jsxs("div",{style:{marginTop:r?"8px":"12px",paddingTop:r?"6px":"8px",borderTop:"1px solid rgba(255,255,255,0.2)",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#cccccc",fontSize:r?"0.5rem":"0.7rem",fontStyle:"italic",marginBottom:r?"8px":"12px"},children:["Phase 1 ends when all players complete ",i," matches or the deadline passes"]}),e.jsx("button",{onClick:t,style:{background:"linear-gradient(135deg, #4CAF50, #45a049)",border:"none",color:"#ffffff",fontSize:r?"0.8rem":"1rem",cursor:"pointer",padding:r?"8px 16px":"10px 20px",borderRadius:"6px",transition:"all 0.2s ease",fontWeight:"bold",boxShadow:"0 4px 8px rgba(0,0,0,0.3)",minWidth:r?"100px":"120px"},onMouseEnter:x=>x.target.style.transform="translateY(-2px)",onMouseLeave:x=>x.target.style.transform="translateY(0)",children:"Close Overview"})]})]})}):null},Gj={findOverlappingAvailability(n,t){try{console.log("Smart Match Debug - Parsing P1 availability:",n);let r;typeof n=="string"?r=Cx(n):typeof n=="object"&&n!==null?r=n:r={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},console.log("Smart Match Debug - Parsed P1 availability:",r),console.log("Smart Match Debug - Parsing P2 availability:",t);let s;typeof t=="string"?s=Cx(t):typeof t=="object"&&t!==null?s=t:s={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},console.log("Smart Match Debug - Parsed P2 availability:",s);const a={};return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].forEach(o=>{a[o]=[],r[o]&&s[o]&&(console.log(`Smart Match Debug - Checking ${o}: P1 slots:`,r[o],"P2 slots:",s[o]),r[o].forEach(i=>{s[o].forEach(l=>{const c=this.findTimeOverlap(i,l);c&&(a[o].push(c),console.log(`Smart Match Debug - Found overlap on ${o}:`,c))})}))}),console.log("Smart Match Debug - Final overlapping slots:",a),a}catch(r){return console.error("Error parsing availability:",r),{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]}}},findTimeOverlap(n,t){console.log("Smart Match Debug - Finding overlap between:",n,"and",t);const[r,s]=n.split(" - "),[a,o]=t.split(" - ");console.log("Smart Match Debug - Parsed times:",{start1:r,end1:s,start2:a,end2:o});const i=this.parseTime(r),l=this.parseTime(s),c=this.parseTime(a),d=this.parseTime(o);console.log("Smart Match Debug - Parsed minutes:",{start1Time:i,end1Time:l,start2Time:c,end2Time:d});const u=Math.max(i,c),h=Math.min(l,d);if(console.log("Smart Match Debug - Overlap calculation:",{overlapStart:u,overlapEnd:h}),u<h){const p=`${this.formatTime(u)} - ${this.formatTime(h)}`;return console.log("Smart Match Debug - Found overlap:",p),p}return console.log("Smart Match Debug - No overlap found"),null},parseTime(n){console.log("Smart Match Debug - Parsing time:",n);let t=n.trim().toLowerCase(),r="am";t.includes("pm")?(r="pm",t=t.replace("pm","")):t.includes("am")&&(r="am",t=t.replace("am",""));let s,a=0;t.includes(":")?[s,a]=t.split(":").map(Number):t.length<=2?(s=parseInt(t),a=0):(s=parseInt(t.slice(0,-2)),a=parseInt(t.slice(-2)));let o=s;r==="pm"&&s!==12&&(o+=12),r==="am"&&s===12&&(o=0);const i=o*60+a;return console.log("Smart Match Debug - Parsed time result:",{timeStr:n,hours:s,minutes:a,period:r,hour24:o,result:i}),i},formatTime(n){const t=Math.floor(n/60),r=n%60;let s="AM",a=t;return t>=12&&(s="PM",t>12&&(a=t-12)),a===0&&(a=12),`${a}:${r.toString().padStart(2,"0")} ${s}`},calculateConfidenceScore(n,t,r){let s=0;const a=Object.values(r).flat().length;s+=a*10;const o=Object.keys(r).filter(i=>r[i].length>0).length;if(s+=o*5,Object.values(r).flat().forEach(i=>{const[l,c]=i.split(" - "),d=this.parseTime(c)-this.parseTime(l);d>=120&&(s+=5),d>=180&&(s+=5)}),n.locations&&t.locations){const i=typeof n.locations=="string"?n.locations.split(`
`).map(d=>d.trim()).filter(Boolean):Array.isArray(n.locations)?n.locations:[],l=typeof t.locations=="string"?t.locations.split(`
`).map(d=>d.trim()).filter(Boolean):Array.isArray(t.locations)?t.locations:[],c=i.filter(d=>l.includes(d));s+=c.length*10}return Math.min(s,100)},findOptimalLocation(n,t){if(!n.locations||!t.locations)return null;const r=typeof n.locations=="string"?n.locations.split(`
`).map(o=>o.trim()).filter(Boolean):Array.isArray(n.locations)?n.locations:[],s=typeof t.locations=="string"?t.locations.split(`
`).map(o=>o.trim()).filter(Boolean):Array.isArray(t.locations)?t.locations:[],a=r.filter(o=>s.includes(o));return a.length>0?a[0]:null},checkForConflicts(n,t,r){const s=[];return r.forEach(a=>{(a.player1===n.firstName||a.player2===n.firstName||a.player1===t.firstName||a.player2===t.firstName)&&s.push(a)}),s},generateSuggestions(n,t,r=[]){console.log("Smart Match Debug - Player 1:",n),console.log("Smart Match Debug - Player 2:",t);const s=`Day: Monday, Available From: 6:00 PM, Available Until: 10:00 PM
Day: Tuesday, Available From: 6:00 PM, Available Until: 10:00 PM
Day: Wednesday, Available From: 6:00 PM, Available Until: 10:00 PM
Day: Thursday, Available From: 6:00 PM, Available Until: 10:00 PM
Day: Friday, Available From: 6:00 PM, Available Until: 10:00 PM
Day: Saturday, Available From: 2:00 PM, Available Until: 8:00 PM`,a=n.availability||s,o=t.availability||s;console.log("Smart Match Debug - P1 Availability:",a),console.log("Smart Match Debug - P2 Availability:",o);const i=this.findOverlappingAvailability(a,o);console.log("Smart Match Debug - Overlapping Slots:",i);const l=this.calculateConfidenceScore(n,t,i),c=this.findOptimalLocation(n,t),d=this.checkForConflicts(n,t,r),u=[];Object.entries(i).forEach(([g,f])=>{f.forEach(m=>{u.push({day:g,timeSlot:m,location:c,confidence:Math.min(l+f.length*2,100),player1:n.firstName,player2:t.firstName})})}),u.sort((g,f)=>f.confidence-g.confidence);const h=u.slice(0,3),p=!n.availability||!t.availability;return{suggestions:h,confidence:l,conflicts:d,message:h.length>0?`Found ${u.length} potential match times, showing top ${h.length}${p?" (using default availability)":""}`:"No overlapping availability found"}},generateQuickProposal(n,t,r){const s={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday",Sat:"Saturday",Sun:"Sunday"};return{player1:t.firstName,player2:r.firstName,proposedDate:s[n.day],proposedTime:n.timeSlot,proposedLocation:n.location||"TBD",confidence:n.confidence,message:`Smart Match Suggestion: ${s[n.day]} at ${n.timeSlot}${n.location?` at ${n.location}`:""}`}}},iH=({isOpen:n,onClose:t,player1:r,player2:s,upcomingMatches:a=[],isMobile:o=!1,selectedDivision:i,phase:l,senderName:c,senderEmail:d,onProposalComplete:u})=>{const[h,p]=y.useState([]),[g,f]=y.useState(!1),[m,v]=y.useState(null),[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState(null);y.useEffect(()=>{n&&r&&s&&C()},[n,r,s]);const C=async()=>{f(!0),p([]),v(null);try{await new Promise(T=>setTimeout(T,1e3));const D=Gj.generateSuggestions(r,s,a);p(D.suggestions),f(!1)}catch(D){console.error("Error generating suggestions:",D),f(!1)}},N=D=>{v(D);const T=Gj.generateQuickProposal(D,r,s);_({player:s,day:{Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"}[T.proposedDate]||T.proposedDate,slot:T.proposedTime,selectedDivision:i,phase:l,prefilledData:T}),j(!0)},M=()=>{p([]),v(null),t()},E=D=>D>=80?"#dc2626":D>=60?"#f59e0b":"#6b7280",P=D=>D>=80?"High":D>=60?"Medium":"Low";return n?e.jsx(It,{open:n,onClose:M,title:`Smart Match: ${r==null?void 0:r.firstName} vs ${s==null?void 0:s.firstName}`,isMobile:o,children:e.jsxs("div",{style:{padding:"20px",maxHeight:"70vh",overflowY:"auto",backgroundColor:"#1f2937",color:"#f9fafb"},children:[g&&e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx(vC,{}),e.jsx("p",{style:{marginTop:"16px",color:"#9ca3af"},children:"Analyzing availability and generating suggestions..."})]}),!g&&h.length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#9ca3af"},children:[e.jsx("h3",{style:{color:"#f9fafb"},children:"No Match Suggestions Found"}),e.jsx("p",{children:"No overlapping availability was found between the two players."}),e.jsx("p",{style:{fontSize:"14px",marginTop:"8px"},children:"Make sure both players have availability data in the system."}),e.jsxs("button",{onClick:()=>w(!0),style:{marginTop:"16px",padding:"10px 20px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",fontSize:"14px",transition:"all 0.3s ease"},onMouseEnter:D=>D.target.style.backgroundColor="#b91c1c",onMouseLeave:D=>D.target.style.backgroundColor="#dc2626",children:[" View ",s==null?void 0:s.firstName,"'s Availability & Send Proposal"]})]}),!g&&h.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"20px",textAlign:"center"},children:[e.jsxs("h3",{style:{margin:"0 0 8px 0",color:"#f9fafb"},children:["Found ",h.length," potential match times"]}),e.jsx("p",{style:{margin:0,color:"#9ca3af",fontSize:"14px"},children:"Select a suggestion below to create a match proposal"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:h.map((D,T)=>e.jsx("div",{style:{border:`2px solid ${m===D?"#dc2626":"#374151"}`,borderRadius:"8px",padding:"16px",cursor:"pointer",backgroundColor:"#374151",transition:"all 0.3s ease",boxShadow:m===D?"0 4px 12px rgba(220, 38, 38, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)"},onClick:()=>N(D),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:"0 0 8px 0",color:"#f9fafb",fontWeight:"600"},children:D.day==="Mon"?"Monday":D.day==="Tue"?"Tuesday":D.day==="Wed"?"Wednesday":D.day==="Thu"?"Thursday":D.day==="Fri"?"Friday":"Saturday"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:"16px",fontWeight:"500",color:"#e5e7eb"},children:D.timeSlot}),D.location&&e.jsxs("p",{style:{margin:0,color:"#9ca3af",fontSize:"14px"},children:[" ",D.location]})]}),e.jsxs("div",{style:{padding:"6px 12px",borderRadius:"6px",backgroundColor:E(D.confidence),color:"white",fontSize:"12px",fontWeight:"600",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:[P(D.confidence)," (",D.confidence,"%)"]})]})},T))})]}),e.jsxs("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"1px solid #374151",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>w(!0),style:{padding:"10px 20px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",fontSize:"14px",transition:"all 0.3s ease"},onMouseEnter:D=>D.target.style.backgroundColor="#b91c1c",onMouseLeave:D=>D.target.style.backgroundColor="#dc2626",children:[" View ",s==null?void 0:s.firstName,"'s Availability & Send Proposal"]}),e.jsx("button",{onClick:M,style:{padding:"10px 20px",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"6px",fontWeight:"500",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:D=>D.target.style.backgroundColor="#4b5563",onMouseLeave:D=>D.target.style.backgroundColor="#6b7280",children:"Close"})]}),b&&s&&e.jsx(mf,{onClose:()=>{w(!1)},player:s,onProposeMatch:(D,T)=>{_({player:s,day:D,slot:T,selectedDivision:i,phase:l}),j(!0),w(!1)},selectedDivision:i,phase:l}),x&&S&&e.jsx(_f,{player:S.player,day:S.day,slot:S.slot,selectedDivision:S.selectedDivision,phase:S.phase||l,onClose:()=>j(!1),senderName:c,senderEmail:d,onProposalComplete:()=>{j(!1),_(null),u&&u()}})]})}):null};function lH({isOpen:n,onClose:t,onSuccess:r,isMobile:s=!1,existingPlayer:a=null,isAdmin:o=!1}){const[i,l]=y.useState({firstName:"",lastName:"",email:"",phone:"",textNumber:"",preferredContacts:[],emergencyContactName:"",emergencyContactPhone:"",availability:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},locations:"",pin:"",paymentStatus:"pending",division:""}),[c,d]=y.useState(1),[u,h]=y.useState(!1),[p,g]=y.useState(""),[f,m]=y.useState(""),[v,b]=y.useState({}),[w,x]=y.useState([]),[j,S]=y.useState([]),[_,C]=y.useState(""),N=["10:00 AM - 12:00 PM","12:00 PM - 2:00 PM","2:00 PM - 4:00 PM","4:00 PM - 6:00 PM","6:00 PM - 8:00 PM","8:00 PM - 10:00 PM","10:00 PM - 12:00 AM","Other (specify)"],M=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],E=[{value:"email",label:"Email"},{value:"phone",label:"Phone Call"},{value:"text",label:"Text Message"}],P=async()=>{let J=0;const be=100;for(;J<be;){const Ae=Math.floor(1e3+Math.random()*9e3).toString();try{const O=await fetch(`${Ie}/api/users/check-pin/${Ae}`);if(O.ok&&!(await O.json()).exists)return Ae}catch(O){return console.error("Error checking PIN uniqueness:",O),Ae}J++}return Math.floor(1e3+Math.random()*9e3).toString()+Date.now().toString().slice(-1)};y.useEffect(()=>{D()},[]),y.useEffect(()=>{if(a&&(l({firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",phone:a.phone||"",textNumber:a.textNumber||"",preferredContacts:a.preferredContacts||[],emergencyContactName:a.emergencyContactName||"",emergencyContactPhone:a.emergencyContactPhone||"",availability:a.availability||{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},locations:a.locations||"",pin:a.pin||"",confirmPin:a.pin||"",division:a.division||""}),a.locations)){const J=a.locations.split(`
`).map(O=>O.trim()).filter(O=>O),be=[],Ae=[];J.forEach(O=>{w.some(me=>me.name===O)?be.push(O):Ae.push(O)}),S(be),C(Ae.join(`
`))}},[a,w]);const D=async()=>{try{const J=await mt.getLocations();J.success&&Array.isArray(J.data)&&x(J.data)}catch(J){console.error("Failed to load locations:",J)}},T=(J,be)=>{l(Ae=>({...Ae,[J]:be})),g("")},A=(J,be,Ae)=>{l(O=>({...O,availability:{...O.availability,[J]:Ae?[...O.availability[J],be]:O.availability[J].filter(oe=>oe!==be)}}))},k=(J,be,Ae)=>{l(O=>{const oe=O.availability[J];if(oe.includes("Other (specify)")&&be&&Ae){const Ce=`${be} - ${Ae}`,ve=oe.map(De=>De==="Other (specify)"?Ce:De);return{...O,availability:{...O.availability,[J]:ve}}}return O})},R=(J,be)=>{l(Ae=>({...Ae,preferredContacts:be?[...Ae.preferredContacts,J]:Ae.preferredContacts.filter(O=>O!==J)}))},U=(J,be)=>{S(Ae=>be?[...Ae,J]:Ae.filter(O=>O!==J))},z=J=>{C(J)},$=()=>{const J=[...j];if(_.trim()){const be=_.split(`
`).map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0);J.push(...be)}return J.join(`
`)},W=J=>{if(o)return null;switch(J){case 1:return i.firstName.trim()?i.lastName.trim()?i.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)?i.phone.trim()?null:"Phone number is required":"Valid email is required":"Email is required":"Last name is required":"First name is required";case 2:return Object.values(i.availability).some(O=>O.length>0)?null:"Please select at least one time slot";case 3:return $().trim()?null:"At least one location is required";case 4:return i.preferredContacts.length===0?"Please select at least one contact preference":null;case 5:return null;default:return null}},Y=()=>{const J=W(c);if(J){g(J);return}g(""),c<5?d(c+1):H()},Q=()=>{g(""),c>1&&d(c-1)},H=async()=>{var be;const J=W(c);if(J){g(J);return}h(!0),g("");try{const Ae=await P(),oe={...o?{firstName:i.firstName.trim()||"Test",lastName:i.lastName.trim()||"Player",email:i.email.trim()||`test${Date.now()}@example.com`,phone:i.phone.trim()||"555-1234",textNumber:i.textNumber||"",emergencyContactName:i.emergencyContactName||"",emergencyContactPhone:i.emergencyContactPhone||"",preferredContacts:i.preferredContacts.length>0?i.preferredContacts:["email"],availability:i.availability,locations:$()||"Test Location",pin:Ae,paymentStatus:"pending",division:"",notes:i.notes||"Created by admin for testing"}:{...i,pin:Ae,paymentStatus:"pending",division:""},confirmPin:void 0},me=a?`${Ie}/api/users/${a.id}/profile`:`${Ie}/api/users/register`,ve=await fetch(me,{method:a?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!ve.ok){const Oe=await ve.json();throw new Error(Oe.message||"Registration failed")}const De=await ve.json();if(!a&&!o)try{const Oe=await fetch(`${Ie}/api/payment-config/enabled-methods`);let Ze={enabledMethods:[],registrationFee:30,additionalInstructions:"",contactInfo:{}};Oe.ok&&(Ze=await Oe.json()),await S9({to_email:i.email,to_name:`${i.firstName} ${i.lastName}`,registrationId:((be=De.user)==null?void 0:be.id)||De.id||`REG-${Date.now()}`,registrationDate:new Date().toLocaleDateString(),registrationFee:Ze.registrationFee||30,paymentMethods:Ze.enabledMethods||[],additionalInstructions:Ze.additionalInstructions||"",contactInfo:Ze.contactInfo||{}}),console.log("Payment instructions email sent successfully")}catch(Oe){console.error("Failed to send payment instructions email:",Oe)}m(a?"Profile updated successfully!":o?"Test player created successfully!":"Registration submitted successfully! Payment instructions have been sent to your email."),setTimeout(()=>{r&&r(De),t()},1500)}catch(Ae){g(Ae.message||"An error occurred during registration")}finally{h(!1)}},ue=()=>{switch(c){case 1:return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center",fontSize:"20px"},children:"Personal Information"}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold",fontSize:"16px"},children:"First Name *"}),e.jsx("input",{type:"text",value:i.firstName,onChange:J=>T("firstName",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"18px"},placeholder:"Enter first name"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold",fontSize:"16px"},children:"Last Name *"}),e.jsx("input",{type:"text",value:i.lastName,onChange:J=>T("lastName",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"18px"},placeholder:"Enter last name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold",fontSize:"16px"},children:"Email Address *"}),e.jsx("input",{type:"email",value:i.email,onChange:J=>T("email",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"18px"},placeholder:"Enter email address"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold",fontSize:"16px"},children:"Phone Number *"}),e.jsx("input",{type:"tel",value:i.phone,onChange:J=>T("phone",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"18px"},placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold",fontSize:"16px"},children:"Text Number (if different)"}),e.jsx("input",{type:"tel",value:i.textNumber,onChange:J=>T("textNumber",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"18px"},placeholder:"Optional text number"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Emergency Contact Name"}),e.jsx("input",{type:"text",value:i.emergencyContactName,onChange:J=>T("emergencyContactName",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px"},placeholder:"Emergency contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Emergency Contact Phone"}),e.jsx("input",{type:"tel",value:i.emergencyContactPhone,onChange:J=>T("emergencyContactPhone",J.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px"},placeholder:"Emergency contact phone"})]})]})]})]});case 2:return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"15px",textAlign:"center",fontSize:"18px"},children:"Availability Schedule"}),e.jsx("p",{style:{color:"#ccc",textAlign:"center",marginBottom:"15px",fontSize:"14px"},children:"Select the time slots when you're available to play matches"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"repeat(2, 1fr)",gap:"10px",maxHeight:"50vh",overflowY:"auto"},children:M.map(J=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"8px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[e.jsx("h4",{style:{color:"#e53e3e",marginBottom:"6px",textAlign:"center",fontSize:"16px",fontWeight:"bold"},children:J==="Mon"?"Monday":J==="Tue"?"Tuesday":J==="Wed"?"Wednesday":J==="Thu"?"Thursday":J==="Fri"?"Friday":J==="Sat"?"Saturday":"Sunday"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"repeat(2, 1fr)",gap:"6px",justifyContent:"center",alignItems:"center",padding:"0 6px"},children:N.map(be=>{var Ae,O,oe,me;return e.jsxs("div",{children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 8px",borderRadius:"6px",background:i.availability[J].includes(be)?"rgba(229, 62, 62, 0.2)":"rgba(255,255,255,0.05)",border:i.availability[J].includes(be)?"1px solid #e53e3e":"1px solid rgba(255,255,255,0.1)",cursor:"pointer",transition:"all 0.2s ease",fontSize:"12px",width:"100%",minWidth:"110px",margin:"0 auto",boxShadow:i.availability[J].includes(be)?"0 2px 4px rgba(229, 62, 62, 0.3)":"0 1px 2px rgba(0,0,0,0.1)"},children:[e.jsx("input",{type:"checkbox",checked:i.availability[J].includes(be),onChange:Ce=>A(J,be,Ce.target.checked),style:{marginRight:"4px",transform:"scale(1)"}}),e.jsx("span",{style:{color:"#fff",fontSize:"12px"},children:be})]}),be==="Other (specify)"&&i.availability[J].includes(be)&&e.jsxs("div",{style:{marginTop:"6px",padding:"8px",background:"rgba(229, 62, 62, 0.1)",borderRadius:"4px",border:"1px solid rgba(229, 62, 62, 0.3)"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto 1fr",gap:"6px",alignItems:"center",marginBottom:"4px"},children:[e.jsxs("select",{value:((Ae=v[J])==null?void 0:Ae.start)||"",onChange:Ce=>{var De;const ve=Ce.target.value;b(Oe=>({...Oe,[J]:{...Oe[J],start:ve}})),k(J,ve,(De=v[J])==null?void 0:De.end)},style:{padding:"4px 6px",borderRadius:"3px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.3)",color:"#fff",fontSize:"14px",textAlign:"center"},children:[e.jsx("option",{value:"",children:"Start"}),e.jsx("option",{value:"6:00 AM",children:"6:00 AM"}),e.jsx("option",{value:"7:00 AM",children:"7:00 AM"}),e.jsx("option",{value:"8:00 AM",children:"8:00 AM"}),e.jsx("option",{value:"9:00 AM",children:"9:00 AM"}),e.jsx("option",{value:"10:00 AM",children:"10:00 AM"}),e.jsx("option",{value:"11:00 AM",children:"11:00 AM"}),e.jsx("option",{value:"12:00 PM",children:"12:00 PM"}),e.jsx("option",{value:"1:00 PM",children:"1:00 PM"}),e.jsx("option",{value:"2:00 PM",children:"2:00 PM"}),e.jsx("option",{value:"3:00 PM",children:"3:00 PM"}),e.jsx("option",{value:"4:00 PM",children:"4:00 PM"}),e.jsx("option",{value:"5:00 PM",children:"5:00 PM"}),e.jsx("option",{value:"6:00 PM",children:"6:00 PM"}),e.jsx("option",{value:"7:00 PM",children:"7:00 PM"}),e.jsx("option",{value:"8:00 PM",children:"8:00 PM"}),e.jsx("option",{value:"9:00 PM",children:"9:00 PM"}),e.jsx("option",{value:"10:00 PM",children:"10:00 PM"}),e.jsx("option",{value:"11:00 PM",children:"11:00 PM"}),e.jsx("option",{value:"12:00 AM",children:"12:00 AM"})]}),e.jsx("span",{style:{color:"#fff",fontSize:"11px"},children:"to"}),e.jsxs("select",{value:((O=v[J])==null?void 0:O.end)||"",onChange:Ce=>{var De;const ve=Ce.target.value;b(Oe=>({...Oe,[J]:{...Oe[J],end:ve}})),k(J,(De=v[J])==null?void 0:De.start,ve)},style:{padding:"4px 6px",borderRadius:"3px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.3)",color:"#fff",fontSize:"14px",textAlign:"center"},children:[e.jsx("option",{value:"",children:"End"}),e.jsx("option",{value:"6:00 AM",children:"6:00 AM"}),e.jsx("option",{value:"7:00 AM",children:"7:00 AM"}),e.jsx("option",{value:"8:00 AM",children:"8:00 AM"}),e.jsx("option",{value:"9:00 AM",children:"9:00 AM"}),e.jsx("option",{value:"10:00 AM",children:"10:00 AM"}),e.jsx("option",{value:"11:00 AM",children:"11:00 AM"}),e.jsx("option",{value:"12:00 PM",children:"12:00 PM"}),e.jsx("option",{value:"1:00 PM",children:"1:00 PM"}),e.jsx("option",{value:"2:00 PM",children:"2:00 PM"}),e.jsx("option",{value:"3:00 PM",children:"3:00 PM"}),e.jsx("option",{value:"4:00 PM",children:"4:00 PM"}),e.jsx("option",{value:"5:00 PM",children:"5:00 PM"}),e.jsx("option",{value:"6:00 PM",children:"6:00 PM"}),e.jsx("option",{value:"7:00 PM",children:"7:00 PM"}),e.jsx("option",{value:"8:00 PM",children:"8:00 PM"}),e.jsx("option",{value:"9:00 PM",children:"9:00 PM"}),e.jsx("option",{value:"10:00 PM",children:"10:00 PM"}),e.jsx("option",{value:"11:00 PM",children:"11:00 PM"}),e.jsx("option",{value:"12:00 AM",children:"12:00 AM"})]})]}),((oe=v[J])==null?void 0:oe.start)&&((me=v[J])==null?void 0:me.end)&&e.jsxs("div",{style:{fontSize:"10px",color:"#4CAF50",textAlign:"center",fontWeight:"bold"},children:[" Custom time set: ",v[J].start," - ",v[J].end]})]})]},be)})})]},J))})]});case 3:return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"15px",textAlign:"center"},children:"Playing Locations"}),e.jsx("p",{style:{color:"#ccc",textAlign:"center",marginBottom:"15px",fontSize:"13px"},children:"Select from predefined locations and/or add your own custom locations"}),w.length>0&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",color:"#fff",fontWeight:"bold",fontSize:"16px",textAlign:"center",width:"100%"},children:"Select from Available Locations:"}),e.jsx("div",{style:{display:"grid",gap:"3px",maxHeight:"180px",overflowY:"auto",padding:"6px",background:"rgba(0,0,0,0.3)",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)"},children:w.map(J=>e.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"4px 6px",borderRadius:"4px",background:j.includes(J.name)?"rgba(76, 175, 80, 0.2)":"rgba(255,255,255,0.05)",border:j.includes(J.name)?"1px solid #4CAF50":"1px solid rgba(255,255,255,0.1)",cursor:"pointer",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"checkbox",checked:j.includes(J.name),onChange:be=>U(J.name,be.target.checked),style:{marginRight:"6px",transform:"scale(1)"}}),e.jsxs("div",{style:{flex:1,textAlign:"center"},children:[e.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"15px",textAlign:"center"},children:J.name}),J.address&&e.jsxs("div",{style:{color:"#ccc",fontSize:"13px",marginTop:"1px",textAlign:"center"},children:[" ",J.address]}),J.notes&&e.jsxs("div",{style:{color:"#999",fontSize:"12px",marginTop:"1px",textAlign:"center"},children:[" ",J.notes]})]})]},J._id))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",color:"#fff",fontWeight:"bold",fontSize:"16px",textAlign:"center"},children:"Add Custom Locations (Optional):"}),e.jsx("textarea",{value:_,onChange:J=>z(J.target.value),style:{width:"100%",minHeight:"60px",padding:"8px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px",resize:"vertical"},placeholder:`Enter additional locations, one per line:
My Home Table
Friend's House
Local Bar`})]}),(j.length>0||_.trim())&&e.jsxs("div",{style:{marginTop:"10px",padding:"10px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)"},children:[e.jsx("h4",{style:{color:"#4CAF50",margin:"0 0 10px 0",fontSize:"14px",fontWeight:"bold"},children:" Your Selected Locations:"}),e.jsx("div",{style:{color:"#ccc",fontSize:"13px"},children:$().split(`
`).map((J,be)=>e.jsxs("div",{style:{marginBottom:"2px"},children:[" ",J]},be))})]}),e.jsx("div",{style:{marginTop:"10px",padding:"8px",background:"rgba(229, 62, 62, 0.1)",borderRadius:"6px"},children:e.jsxs("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:[e.jsx("strong",{children:"Tip:"})," Select from the predefined locations above, or add your own custom locations. These will be used to help match you with other players in your area."]})})]});case 4:return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center"},children:"Contact Preferences"}),e.jsx("p",{style:{color:"#ccc",textAlign:"center",marginBottom:"20px",fontSize:"14px"},children:"How would you prefer other players to contact you for match scheduling?"}),e.jsx("div",{style:{display:"grid",gap:"15px"},children:E.map(J=>e.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"15px",borderRadius:"8px",background:i.preferredContacts.includes(J.value)?"rgba(229, 62, 62, 0.2)":"rgba(255,255,255,0.05)",border:i.preferredContacts.includes(J.value)?"1px solid #e53e3e":"1px solid rgba(255,255,255,0.1)",cursor:"pointer",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"checkbox",checked:i.preferredContacts.includes(J.value),onChange:be=>R(J.value,be.target.checked),style:{marginRight:"12px",transform:"scale(1.2)"}}),e.jsx("span",{style:{color:"#fff",fontSize:"16px",fontWeight:"bold"},children:J.label})]},J.value))}),e.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid rgba(76, 175, 80, 0.3)"},children:e.jsxs("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:[e.jsx("strong",{children:"Note:"})," Your contact information will only be shared with players who are scheduling matches with you. You can change these preferences later in your profile settings."]})})]});case 5:return e.jsxs("div",{style:{padding:"10px"},children:[e.jsx("h3",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center"},children:"Registration & Payment"}),e.jsxs("div",{style:{display:"grid",gap:"20px"},children:[e.jsxs("div",{style:{padding:"15px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid rgba(76, 175, 80, 0.3)",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#4CAF50",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold"},children:" Your PIN will be auto-generated"}),e.jsx("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:"A unique 4-digit PIN will be automatically generated for you. You'll receive it after payment is confirmed."})]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(255, 193, 7, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 193, 7, 0.3)",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold"},children:" Division Assignment"}),e.jsx("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:"Your division will be assigned by league administrators based on your skill level and availability. You'll be notified once assigned."})]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(229, 62, 62, 0.1)",borderRadius:"8px",border:"1px solid rgba(229, 62, 62, 0.3)",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#e53e3e",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold"},children:" Payment Required"}),e.jsxs("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:["Registration fee: ",e.jsx("strong",{children:"$30"})," must be paid before you receive your PIN and can access the league system. Payment instructions will be sent to your email immediately after registration."]})]})]}),e.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"rgba(0, 123, 255, 0.1)",borderRadius:"8px",border:"1px solid rgba(0, 123, 255, 0.3)"},children:e.jsxs("p",{style:{color:"#ccc",fontSize:"14px",margin:0},children:[e.jsx("strong",{children:"Next Steps:"})," After registration, you'll receive payment instructions. Once payment is confirmed, you'll get your PIN and full access to the league system."]})})]});default:return null}};return n?e.jsxs(e.Fragment,{children:[e.jsxs(It,{open:n,onClose:t,title:a?"Edit Player Profile":o?"Admin: Test Player Registration":"Player Registration",maxWidth:s?"95vw":"800px",className:"player-registration-modal",children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.1)",height:"4px",position:"relative",marginBottom:"15px"},children:e.jsx("div",{style:{background:"linear-gradient(90deg, #e53e3e, #ff6b6b)",height:"100%",width:`${c/5*100}%`,transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{padding:"10px 15px",background:"rgba(0,0,0,0.8)",borderBottom:"1px solid rgba(255,255,255,0.1)",marginBottom:"15px",borderRadius:"6px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{color:"#fff",fontSize:"14px"},children:["Step ",c," of 5"]}),e.jsxs("span",{style:{color:"#e53e3e",fontSize:"14px",fontWeight:"bold"},children:[c===1&&"Personal Info",c===2&&"Availability",c===3&&"Locations",c===4&&"Contact Preferences",c===5&&"Registration & Payment"]})]}),o&&e.jsx("div",{style:{background:"rgba(255, 193, 7, 0.2)",border:"1px solid rgba(255, 193, 7, 0.5)",borderRadius:"4px",padding:"6px 10px",marginTop:"8px",textAlign:"center"},children:e.jsx("span",{style:{color:"#ffc107",fontSize:"12px",fontWeight:"bold"},children:" ADMIN MODE: Validation bypassed for testing"})})]}),e.jsx("div",{style:{marginBottom:"25px",maxHeight:"60vh",overflowY:"auto",paddingRight:"10px"},children:ue()}),p&&e.jsx("div",{style:{padding:"10px 15px",background:"rgba(229, 62, 62, 0.2)",border:"1px solid #e53e3e",color:"#ff6b6b",textAlign:"center",fontSize:"14px",borderRadius:"6px",marginBottom:"15px"},children:p}),f&&e.jsx("div",{style:{padding:"10px 15px",background:"rgba(76, 175, 80, 0.2)",border:"1px solid #4CAF50",color:"#4CAF50",textAlign:"center",fontSize:"14px",borderRadius:"6px",marginBottom:"15px"},children:f}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px"},children:[e.jsx("button",{onClick:c===1?t:Q,style:{padding:"12px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",flex:1},onMouseEnter:J=>{J.target.style.background="rgba(255,255,255,0.1)"},onMouseLeave:J=>{J.target.style.background="transparent"},children:c===1?"Cancel":"Previous"}),e.jsx("button",{onClick:Y,disabled:u,style:{padding:"12px 20px",borderRadius:"6px",border:"none",background:u?"#666":"#e53e3e",color:"#fff",cursor:u?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s ease",flex:1},onMouseEnter:J=>{u||(J.target.style.background="#ff6b6b")},onMouseLeave:J=>{u||(J.target.style.background="#e53e3e")},children:u?"Processing...":c===5?a?"Update Profile":"Complete Registration":"Next"})]})]}),e.jsx("style",{jsx:!0,children:`
               .player-registration-modal {
          max-height: 95vh !important;
          height: auto !important;
        }
        
        .player-registration-modal .draggable-modal {
          max-height: 95vh !important;
          height: auto !important;
        }
        
        .player-registration-modal .modal-content {
          max-height: 70vh !important;
          overflow-y: auto !important;
        }
       
       /* Custom scrollbar */
       .player-registration-modal .modal-content::-webkit-scrollbar {
         width: 6px;
       }
       
       .player-registration-modal .modal-content::-webkit-scrollbar-thumb {
         background: #e53e3e;
         border-radius: 3px;
       }
       
               .player-registration-modal .modal-content::-webkit-scrollbar-track {
          background: rgba(255,255,255,0.1);
          border-radius: 3px;
        }
        
                 /* Custom dropdown styling for dark theme */
         .player-registration-modal select option {
           background: #222 !important;
           color: #fff !important;
           border: none !important;
           font-size: 14px !important;
           padding: 4px 8px !important;
         }
        
        .player-registration-modal select:focus {
          outline: none !important;
          border-color: #e53e3e !important;
          box-shadow: 0 0 0 2px rgba(229, 62, 62, 0.2) !important;
        }
     `})]}):null}var NC={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vj=Te.createContext&&Te.createContext(NC),Di=globalThis&&globalThis.__assign||function(){return Di=Object.assign||function(n){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},Di.apply(this,arguments)},cH=globalThis&&globalThis.__rest||function(n,t){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(r[s[a]]=n[s[a]]);return r};function TC(n){return n&&n.map(function(t,r){return Te.createElement(t.tag,Di({key:r},t.attr),TC(t.child))})}function Jt(n){return function(t){return Te.createElement(dH,Di({attr:Di({},n.attr)},t),TC(n.child))}}function dH(n){var t=function(r){var s=n.attr,a=n.size,o=n.title,i=cH(n,["attr","size","title"]),l=a||r.size||"1em",c;return r.className&&(c=r.className),n.className&&(c=(c?c+" ":"")+n.className),Te.createElement("svg",Di({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,s,i,{className:c,style:Di(Di({color:n.color||r.color},r.style),n.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&Te.createElement("title",null,o),n.children)};return Vj!==void 0?Te.createElement(Vj.Consumer,null,function(r){return t(r)}):t(NC)}function uH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"}}]})(n)}function Am(n){return Jt({tag:"svg",attr:{viewBox:"0 0 488 512"},child:[{tag:"path",attr:{d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"}}]})(n)}function hH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M111.4 295.9c-3.5 19.2-17.4 108.7-21.5 134-.3 1.8-1 2.5-3 2.5H12.3c-7.6 0-13.1-6.6-12.1-13.9L58.8 46.6c1.5-9.6 10.1-16.9 20-16.9 152.3 0 165.1-3.7 204 11.4 60.1 23.3 65.6 79.5 44 140.3-21.5 62.6-72.5 89.5-140.1 90.3-43.4.7-69.5-7-75.3 24.2zM357.1 152c-1.8-1.3-2.5-1.8-3 1.3-2 11.4-5.1 22.5-8.8 33.6-39.9 113.8-150.5 103.9-204.5 103.9-6.1 0-10.1 3.3-10.9 9.4-22.6 140.4-27.1 169.7-27.1 169.7-1 7.1 3.5 12.9 10.6 12.9h63.5c8.6 0 15.7-6.3 17.4-14.9.7-5.4-1.1 6.1 14.4-91.3 4.6-22 14.3-19.7 29.3-19.7 71 0 126.4-28.8 142.9-112.3 6.5-34.8 4.6-71.4-23.8-92.6z"}}]})(n)}function zg(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"}}]})(n)}function Cl(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"}}]})(n)}function Oi(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"}}]})(n)}function Bx(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"}}]})(n)}function va(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(n)}function PC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}}]})(n)}function pH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}}]})(n)}function Ob(n){return Jt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}}]})(n)}function EC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}}]})(n)}function mH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"}}]})(n)}function RC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(n)}function Ox(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(n)}function zb(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"}}]})(n)}function Kj(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V256H0v176zm192-68c0-6.6 5.4-12 12-12h136c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-40zm-128 0c0-6.6 5.4-12 12-12h72c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM576 80v48H0V80c0-26.5 21.5-48 48-48h480c26.5 0 48 21.5 48 48z"}}]})(n)}function fH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 288 512"},child:[{tag:"path",attr:{d:"M209.2 233.4l-108-31.6C88.7 198.2 80 186.5 80 173.5c0-16.3 13.2-29.5 29.5-29.5h66.3c12.2 0 24.2 3.7 34.2 10.5 6.1 4.1 14.3 3.1 19.5-2l34.8-34c7.1-6.9 6.1-18.4-1.8-24.5C238 74.8 207.4 64.1 176 64V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48h-2.5C45.8 64-5.4 118.7.5 183.6c4.2 46.1 39.4 83.6 83.8 96.6l102.5 30c12.5 3.7 21.2 15.3 21.2 28.3 0 16.3-13.2 29.5-29.5 29.5h-66.3C100 368 88 364.3 78 357.5c-6.1-4.1-14.3-3.1-19.5 2l-34.8 34c-7.1 6.9-6.1 18.4 1.8 24.5 24.5 19.2 55.1 29.9 86.5 30v48c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-48.2c46.6-.9 90.3-28.6 105.7-72.7 21.5-61.6-14.6-124.8-72.5-141.7z"}}]})(n)}function gH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(n)}function Xc(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(n)}function kf(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"}}]})(n)}function Mm(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"}}]})(n)}function Jj(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"}}]})(n)}function xH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"}}]})(n)}function Il(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"}}]})(n)}function yH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"}}]})(n)}function AC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"}}]})(n)}function Fb(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}}]})(n)}function bH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"}}]})(n)}function vH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"}}]})(n)}function Qc(n){return Jt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"}}]})(n)}function wH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M272 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM160 480c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]})(n)}function jH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M621.16 54.46C582.37 38.19 543.55 32 504.75 32c-123.17-.01-246.33 62.34-369.5 62.34-30.89 0-61.76-3.92-92.65-13.72-3.47-1.1-6.95-1.62-10.35-1.62C15.04 79 0 92.32 0 110.81v317.26c0 12.63 7.23 24.6 18.84 29.46C57.63 473.81 96.45 480 135.25 480c123.17 0 246.34-62.35 369.51-62.35 30.89 0 61.76 3.92 92.65 13.72 3.47 1.1 6.95 1.62 10.35 1.62 17.21 0 32.25-13.32 32.25-31.81V83.93c-.01-12.64-7.24-24.6-18.85-29.47zM48 132.22c20.12 5.04 41.12 7.57 62.72 8.93C104.84 170.54 79 192.69 48 192.69v-60.47zm0 285v-47.78c34.37 0 62.18 27.27 63.71 61.4-22.53-1.81-43.59-6.31-63.71-13.62zM320 352c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 27.78c-17.52-4.39-35.71-6.85-54.32-8.44 5.87-26.08 27.5-45.88 54.32-49.28v57.72zm0-236.11c-30.89-3.91-54.86-29.7-55.81-61.55 19.54 2.17 38.09 6.23 55.81 12.66v48.89z"}}]})(n)}function SH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}}]})(n)}function Ms(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(n)}function _H(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"}}]})(n)}function pl(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(n)}function MC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"}}]})(n)}function kH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M480 160H32c-17.673 0-32-14.327-32-32V64c0-17.673 14.327-32 32-32h448c17.673 0 32 14.327 32 32v64c0 17.673-14.327 32-32 32zm-48-88c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24zm-64 0c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24zm112 248H32c-17.673 0-32-14.327-32-32v-64c0-17.673 14.327-32 32-32h448c17.673 0 32 14.327 32 32v64c0 17.673-14.327 32-32 32zm-48-88c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24zm-64 0c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24zm112 248H32c-17.673 0-32-14.327-32-32v-64c0-17.673 14.327-32 32-32h448c17.673 0 32 14.327 32 32v64c0 17.673-14.327 32-32 32zm-48-88c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24zm-64 0c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24z"}}]})(n)}function Xj(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"}}]})(n)}function xa(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}}]})(n)}function zx(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"}}]})(n)}function qd(n){return Jt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"}}]})(n)}function CH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(n)}function zi(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(n)}function ql(n){return Jt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 35.7 22.5 72.4 61.9 100.7 31.5 22.7 69.8 37.1 110 41.7C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6c40.3-4.6 78.6-19 110-41.7 39.3-28.3 61.9-65 61.9-100.7V88c0-13.3-10.7-24-24-24zM99.3 192.8C74.9 175.2 64 155.6 64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-15.1-5.2-29.2-12.4-41.7-21.4zM512 144c0 16.1-17.7 36.1-35.3 48.8-12.5 9-26.7 16.2-41.8 21.4 7-25 11.8-53.6 12.8-86.2H512v16z"}}]})(n)}function Fx(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z"}}]})(n)}function NH(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208H432c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(n)}function Zc(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(n)}function IC(n){return Jt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(n)}function So(n){return Jt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"}}]})(n)}function TH({activeTab:n,onTabChange:t,onQuickAction:r,pendingCount:s=0,sentCount:a=0,matchesCount:o=0}){const i=[{id:"overview",label:"Home",icon:e.jsx(AC,{}),badge:null},{id:"matches",label:"Matches",icon:e.jsx(Oi,{}),badge:o>0?o:null},{id:"proposals",label:"Proposals",icon:e.jsx(So,{}),badge:s>0?s:null},{id:"standings",label:"Standings",icon:e.jsx(ql,{}),badge:null},{id:"chat",label:"Chat",icon:e.jsx(zb,{}),badge:null}];return e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(24, 24, 27, 0.95)",backdropFilter:"blur(20px)",borderTop:"1px solid rgba(255, 255, 255, 0.1)",padding:"8px 0",zIndex:1e3,display:"flex",justifyContent:"space-around",alignItems:"center"},children:[i.map(l=>e.jsxs("button",{onClick:()=>t(l.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:n===l.id?"#e53e3e":"#888",padding:"8px 4px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",minHeight:"60px",minWidth:"60px",position:"relative"},onTouchStart:c=>{c.target.style.transform="scale(0.95)"},onTouchEnd:c=>{c.target.style.transform="scale(1)"},children:[e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"2px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.icon}),e.jsx("span",{style:{fontSize:"0.7rem",fontWeight:n===l.id?"600":"400",textAlign:"center"},children:l.label}),l.badge&&e.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",background:"#e53e3e",color:"#fff",borderRadius:"50%",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.6rem",fontWeight:"600",border:"2px solid rgba(24, 24, 27, 0.95)"},children:l.badge>99?"99+":l.badge})]},l.id)),e.jsx("button",{onClick:r,style:{position:"absolute",top:"-20px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, #e53e3e, #c53030)",color:"#fff",border:"none",borderRadius:"50%",width:"56px",height:"56px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",cursor:"pointer",boxShadow:"0 4px 16px rgba(229, 62, 62, 0.4)",transition:"all 0.2s ease",zIndex:1001},onTouchStart:l=>{l.target.style.transform="translateX(-50%) scale(0.95)"},onTouchEnd:l=>{l.target.style.transform="translateX(-50%) scale(1)"},children:e.jsx(Ms,{})})]})}function Fg({children:n,title:t,subtitle:r,onTap:s,onSwipeLeft:a,onSwipeRight:o,swipeThreshold:i=80,showSwipeActions:l=!0,className:c="",style:d={},...u}){const[h,p]=y.useState(!1),[g,f]=y.useState(0),[m,v]=y.useState(0),[b,w]=y.useState(null),x=y.useRef(null),j=N=>{f(N.touches[0].clientX),v(N.touches[0].clientX),p(!0),w(null)},S=N=>{if(!h)return;const M=N.touches[0].clientX;v(M);const E=M-g;Math.abs(E)>20&&w(E>0?"right":"left")},_=()=>{if(!h)return;const N=m-g;Math.abs(N)>i&&(N>0&&o?o():N<0&&a&&a()),p(!1),f(0),v(0),w(null)},C=()=>{!h&&s&&s()};return e.jsxs("div",{ref:x,className:`mobile-optimized-card ${c}`,onTouchStart:j,onTouchMove:S,onTouchEnd:_,onClick:C,style:{position:"relative",background:"linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.15)",padding:"16px",marginBottom:"12px",cursor:s?"pointer":"default",transition:h?"none":"all 0.3s ease",transform:h?`translateX(${m-g}px)`:"translateX(0)",touchAction:"pan-y",userSelect:"none",WebkitTapHighlightColor:"transparent",...d},...u,children:[l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",opacity:b==="right"?.8:0,transition:"opacity 0.2s ease",color:"#10b981",fontSize:"1.2rem"},children:e.jsx(Il,{})}),e.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",opacity:b==="left"?.8:0,transition:"opacity 0.2s ease",color:"#ef4444",fontSize:"1.2rem"},children:e.jsx(zi,{})})]}),(t||r)&&e.jsxs("div",{style:{marginBottom:"12px"},children:[t&&e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",color:"#fff",lineHeight:"1.3"},children:t}),r&&e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"0.85rem",color:"#ccc",opacity:.8,lineHeight:"1.4"},children:r})]}),e.jsx("div",{style:{position:"relative"},children:n}),s&&e.jsx("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",color:"#888",fontSize:"0.8rem",opacity:.6},children:e.jsx(Ob,{})}),e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"12px",background:b==="right"?"linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, transparent 50%)":b==="left"?"linear-gradient(90deg, transparent 50%, rgba(239, 68, 68, 0.1) 100%)":"transparent",opacity:Math.abs(m-g)/i,transition:"opacity 0.2s ease",pointerEvents:"none"}})]})}function Wg({children:n,variant:t="primary",size:r="medium",fullWidth:s=!1,icon:a,onClick:o,disabled:i=!1,loading:l=!1,className:c="",style:d={},...u}){const h=()=>{switch(t){case"primary":return{background:"linear-gradient(135deg, #e53e3e, #c53030)",color:"#fff",border:"none"};case"secondary":return{background:"rgba(255, 255, 255, 0.1)",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.2)"};case"danger":return{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"#fff",border:"none"};default:return{background:"linear-gradient(135deg, #e53e3e, #c53030)",color:"#fff",border:"none"}}},p=()=>{switch(r){case"small":return{padding:"8px 12px",fontSize:"0.8rem",minHeight:"36px"};case"medium":return{padding:"12px 16px",fontSize:"0.9rem",minHeight:"44px"};case"large":return{padding:"16px 20px",fontSize:"1rem",minHeight:"52px"};default:return{padding:"12px 16px",fontSize:"0.9rem",minHeight:"44px"}}};return e.jsx("button",{onClick:o,disabled:i||l,className:`mobile-action-button ${c}`,style:{...h(),...p(),width:s?"100%":"auto",borderRadius:"8px",cursor:i||l?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontWeight:"600",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",touchAction:"manipulation",WebkitTapHighlightColor:"transparent",opacity:i||l?.6:1,...d},onTouchStart:g=>{!i&&!l&&(g.target.style.transform="scale(0.98)")},onTouchEnd:g=>{!i&&!l&&(g.target.style.transform="scale(1)")},...u,children:l?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid currentColor",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Loading..."]}):e.jsxs(e.Fragment,{children:[a&&e.jsx("span",{children:a}),n]})})}function Po({title:n,subtitle:t,children:r,collapsible:s=!1,defaultCollapsed:a=!1,onToggle:o,className:i="",style:l={},...c}){const[d,u]=Te.useState(a),h=()=>{s&&(u(!d),o&&o(!d))};return e.jsxs("div",{className:`mobile-section ${i}`,style:{background:"rgba(255, 255, 255, 0.02)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.08)",padding:"16px",marginBottom:"16px",...l},...c,children:[(n||t)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:s&&!d?"12px":"0",cursor:s?"pointer":"default"},onClick:h,children:[e.jsxs("div",{style:{flex:1},children:[n&&e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",color:"#fff",lineHeight:"1.3"},children:n}),t&&e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"0.85rem",color:"#ccc",opacity:.8,lineHeight:"1.4"},children:t})]}),s&&e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",transition:"transform 0.2s ease",transform:d?"rotate(0deg)":"rotate(180deg)"},children:e.jsx(EC,{})})]}),e.jsx("div",{style:{display:s&&d?"none":"block",transition:"all 0.3s ease"},children:r})]})}function PH({children:n,columns:t=2,className:r="",style:s={}}){return e.jsx("div",{className:`mobile-stats-grid ${r}`,style:{display:"grid",gridTemplateColumns:`repeat(${t}, 1fr)`,gap:"12px",...s},children:n})}function lp({title:n,value:t,subtitle:r,icon:s,color:a="#e53e3e",onClick:o,className:i="",style:l={},...c}){return e.jsxs("div",{className:`mobile-stat-card ${i}`,onClick:o,style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"12px",textAlign:"center",cursor:o?"pointer":"default",transition:"all 0.2s ease",...l},onTouchStart:d=>{o&&(d.target.style.transform="scale(0.98)")},onTouchEnd:d=>{o&&(d.target.style.transform="scale(1)")},...c,children:[s&&e.jsx("div",{style:{fontSize:"1.5rem",color:a,marginBottom:"8px",display:"flex",justifyContent:"center"},children:s}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#fff",marginBottom:"4px",lineHeight:"1.2"},children:t}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#ccc",fontWeight:"500",marginBottom:r?"2px":"0"},children:n}),r&&e.jsx("div",{style:{fontSize:"0.7rem",color:"#888",lineHeight:"1.3"},children:r})]})}function Hd({children:n,emptyMessage:t="No items to display",loading:r=!1,className:s="",style:a={},...o}){return e.jsx("div",{className:`mobile-list ${s}`,style:{display:"flex",flexDirection:"column",gap:"8px",...a},...o,children:r?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#888",fontSize:"0.9rem"},children:"Loading..."}):n&&n.length>0?n:e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#888",fontSize:"0.9rem"},children:t})})}function Qj({children:n,onTap:t,onSwipeLeft:r,onSwipeRight:s,swipeThreshold:a=80,className:o="",style:i={},...l}){const[c,d]=Te.useState(!1),[u,h]=Te.useState(0),[p,g]=Te.useState(0),f=w=>{h(w.touches[0].clientX),g(w.touches[0].clientX),d(!0)},m=w=>{c&&g(w.touches[0].clientX)},v=()=>{if(!c)return;const w=p-u;Math.abs(w)>a&&(w>0&&s?s():w<0&&r&&r()),d(!1),h(0),g(0)},b=()=>{!c&&t&&t()};return e.jsx("div",{className:`mobile-list-item ${o}`,onClick:b,onTouchStart:f,onTouchMove:m,onTouchEnd:v,style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"12px",cursor:t?"pointer":"default",transition:c?"none":"all 0.2s ease",transform:c?`translateX(${p-u}px)`:"translateX(0)",touchAction:"pan-y",userSelect:"none",WebkitTapHighlightColor:"transparent",...i},...l,children:n})}function DC(){const[n,t]=y.useState(!1),[r,s]=y.useState(!1),[a,o]=y.useState(!1),[i,l]=y.useState({width:0,height:0}),[c,d]=y.useState(!1),[u,h]=y.useState("portrait"),p=y.useCallback(()=>{if(typeof window>"u")return!1;const w=window.innerWidth,x=window.innerHeight;l({width:w,height:x});const j=w>x;o(j),h(j?"landscape":"portrait");const S=(()=>{if(w<=768)return!0;if(typeof navigator<"u"){const _=navigator.userAgent.toLowerCase();if(["android","webos","iphone","ipad","ipod","blackberry","iemobile","opera mini","mobile"].some(N=>_.includes(N)))return!0}return"ontouchstart"in window||navigator.maxTouchPoints>0?w<=1024:!1})();t(S),s(w>768&&w<=1024),d("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),g={xs:480,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},f=y.useCallback(()=>{const w=i.width;return w<g.xs?"xs":w<g.sm?"sm":w<g.md?"md":w<g.lg?"lg":w<g.xl?"xl":"2xl"},[i.width]),m={spacing:{xs:n?"4px":"8px",sm:n?"8px":"12px",md:n?"12px":"16px",lg:n?"16px":"24px",xl:n?"24px":"32px"},sizes:{buttonHeight:n?"44px":"36px",inputHeight:n?"44px":"36px",iconSize:n?"1.2rem":"1rem",fontSize:{xs:n?"0.7rem":"0.75rem",sm:n?"0.8rem":"0.875rem",md:n?"0.9rem":"1rem",lg:n?"1rem":"1.125rem",xl:n?"1.1rem":"1.25rem"}},animations:{duration:n?"0.2s":"0.3s",easing:"ease-out",scale:n?.98:.95},styles:{card:{padding:n?"12px":"16px",borderRadius:n?"8px":"12px",marginBottom:n?"8px":"12px"},button:{padding:n?"12px 16px":"10px 20px",fontSize:n?"0.9rem":"1rem",minHeight:n?"44px":"36px"},input:{padding:n?"12px":"10px",fontSize:n?"16px":"14px",minHeight:n?"44px":"36px"}}},v={threshold:80,velocity:.3,calculateSwipe:(w,x,j,S)=>{const _=j-w,C=S-x,N=Math.sqrt(_*_+C*C),M=N/300;return{deltaX:_,deltaY:C,distance:N,velocity:M,direction:Math.abs(_)>Math.abs(C)?_>0?"right":"left":C>0?"down":"up",isHorizontal:Math.abs(_)>Math.abs(C),isValid:N>50&&M>v.velocity}},createSwipeHandler:(w,x,j,S)=>{let _=0,C=0;return{onTouchStart:N=>{_=N.touches[0].clientX,C=N.touches[0].clientY},onTouchEnd:N=>{const M=N.changedTouches[0].clientX,E=N.changedTouches[0].clientY,P=v.calculateSwipe(_,C,M,E);if(P.isValid)switch(P.direction){case"left":w&&w(P);break;case"right":x&&x(P);break;case"up":j&&j(P);break;case"down":S&&S(P);break}}}}},b={threshold:80,createPullToRefreshHandler:w=>{let x=0,j=0,S=!1;return{onTouchStart:_=>{window.scrollY===0&&(x=_.touches[0].clientY,S=!0)},onTouchMove:_=>{S&&window.scrollY===0&&(j=_.touches[0].clientY,j-x>0&&_.preventDefault())},onTouchEnd:async()=>{S&&(j-x>b.threshold&&await w(),S=!1,x=0,j=0)}}}};return y.useEffect(()=>{p();const w=()=>{p()},x=()=>{setTimeout(p,100)};return window.addEventListener("resize",w),window.addEventListener("orientationchange",x),()=>{window.removeEventListener("resize",w),window.removeEventListener("orientationchange",x)}},[p]),{isMobile:n,isTablet:r,isLandscape:a,screenSize:i,touchCapable:c,orientation:u,breakpoints:g,getBreakpoint:f,mobileUtils:m,swipeUtils:v,pullToRefreshUtils:b,isSmallScreen:i.width<g.md,isMediumScreen:i.width>=g.md&&i.width<g.lg,isLargeScreen:i.width>=g.lg,isIOS:typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),isAndroid:typeof navigator<"u"&&/Android/.test(navigator.userAgent),isSafari:typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),redetect:p}}function EH({playerName:n,playerLastName:t,pendingProposals:r=[],sentProposals:s=[],matches:a=[],notes:o=[],standings:i=[],schedule:l=[],proposalsLoading:c=!1,matchesLoading:d=!1,notesLoading:u=!1,seasonLoading:h=!1,standingsLoading:p=!1,scheduleLoading:g=!1,onTabChange:f,onQuickAction:m,onViewMatch:v,onViewProposal:b,onViewStandings:w,onViewSchedule:x,onViewProfile:j,onViewSettings:S,setShowMatchProposalModal:_,setShowUserProfileModal:C,setShowSettingsModal:N,className:M="",style:E={},...P}){const[D,T]=y.useState("overview"),{isMobile:A,mobileUtils:k,pullToRefreshUtils:R}=DC(),U=J=>{T(J),f&&f(J)},z=()=>{m?m():_(!0)},$=R.createPullToRefreshHandler(async()=>{window.location.reload()}),W=()=>e.jsxs("div",{style:{paddingBottom:"80px"},children:[e.jsx(Po,{title:`Hello, ${n} ${t}`,subtitle:"Your pool league dashboard",children:e.jsxs(PH,{columns:2,children:[e.jsx(lp,{title:"Pending",value:r.length,icon:e.jsx(So,{}),color:"#f59e0b",onClick:()=>U("proposals")}),e.jsx(lp,{title:"Matches",value:a.length,icon:e.jsx(Oi,{}),color:"#10b981",onClick:()=>U("matches")}),e.jsx(lp,{title:"Position",value:i.length>0?`#${i.findIndex(J=>J.playerName===`${n} ${t}`)+1}`:"N/A",subtitle:"in standings",icon:e.jsx(ql,{}),color:"#e53e3e",onClick:()=>U("standings")}),e.jsx(lp,{title:"Next Match",value:l.length>0?"Scheduled":"None",subtitle:l.length>0?l[0].date:"No upcoming matches",icon:e.jsx(RC,{}),color:"#8b5cf6",onClick:()=>U("schedule")})]})}),e.jsx(Po,{title:"Quick Actions",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsx(Wg,{variant:"primary",icon:e.jsx(Ms,{}),onClick:()=>_(!0),fullWidth:!0,children:"Create Match Proposal"}),e.jsx(Wg,{variant:"secondary",icon:e.jsx(IC,{}),onClick:()=>C(!0),fullWidth:!0,children:"View Profile"}),e.jsx(Wg,{variant:"secondary",icon:e.jsx(Ox,{}),onClick:()=>N(!0),fullWidth:!0,children:"Settings"})]})}),e.jsx(Po,{title:"Recent Activity",collapsible:!0,defaultCollapsed:!1,children:e.jsx(Hd,{emptyMessage:"No recent activity",children:o.slice(0,3).map((J,be)=>e.jsx(Qj,{onTap:()=>{},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#e53e3e",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff",fontWeight:"500",marginBottom:"2px"},children:J.title||"News Update"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#ccc",lineHeight:"1.3"},children:J.content||J.message})]})]})},be))})})]}),Y=()=>e.jsx("div",{style:{paddingBottom:"80px"},children:e.jsx(Po,{title:"Your Matches",subtitle:`${a.length} total matches`,children:e.jsx(Hd,{emptyMessage:"No matches found",loading:d,children:a.map((J,be)=>e.jsx(Fg,{title:`${J.playerName} vs ${J.opponent||"TBD"}`,subtitle:`${J.date}  ${J.location||"Location TBD"}`,onTap:()=>v&&v(J),onSwipeLeft:()=>{},onSwipeRight:()=>{},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"600",background:J.status==="completed"?"#10b981":J.status==="pending"?"#f59e0b":"#6b7280",color:"#fff"},children:J.status}),J.location&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#ccc",fontSize:"0.8rem"},children:[e.jsx(Qc,{}),J.location]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsx("div",{style:{color:"#ccc",fontSize:"0.8rem"},children:J.time||"Time TBD"})})]})},J._id||be))})})}),Q=()=>e.jsx("div",{style:{paddingBottom:"80px"},children:e.jsxs(Po,{title:"Match Proposals",subtitle:`${r.length} pending, ${s.length} sent`,children:[e.jsx(Po,{title:"Pending Proposals",subtitle:`${r.length} waiting for response`,collapsible:!0,defaultCollapsed:!1,children:e.jsx(Hd,{emptyMessage:"No pending proposals",loading:c,children:r.map((J,be)=>e.jsx(Fg,{title:`Proposal to ${J.recipientName}`,subtitle:`${J.date}  ${J.location||"Location TBD"}`,onTap:()=>b&&b(J),onSwipeLeft:()=>{},onSwipeRight:()=>{},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"600",background:"#f59e0b",color:"#fff"},children:"Pending"}),J.location&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#ccc",fontSize:"0.8rem"},children:[e.jsx(Qc,{}),J.location]})]}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.8rem"},children:J.time||"Time TBD"})]})},J._id||be))})}),e.jsx(Po,{title:"Sent Proposals",subtitle:`${s.length} proposals sent`,collapsible:!0,defaultCollapsed:!0,children:e.jsx(Hd,{emptyMessage:"No sent proposals",loading:c,children:s.map((J,be)=>e.jsx(Fg,{title:`Proposal to ${J.recipientName}`,subtitle:`${J.date}  ${J.location||"Location TBD"}`,onTap:()=>b&&b(J),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"600",background:J.status==="accepted"?"#10b981":J.status==="rejected"?"#ef4444":"#6b7280",color:"#fff"},children:J.status}),J.location&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#ccc",fontSize:"0.8rem"},children:[e.jsx(Qc,{}),J.location]})]}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.8rem"},children:J.time||"Time TBD"})]})},J._id||be))})})]})}),H=()=>e.jsx("div",{style:{paddingBottom:"80px"},children:e.jsx(Po,{title:"League Standings",subtitle:"Current season rankings",children:e.jsx(Hd,{emptyMessage:"No standings available",loading:p,children:i.map((J,be)=>e.jsx(Qj,{onTap:()=>w&&w(),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:be<3?"#fbbf24":"#6b7280",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:"600",flexShrink:0},children:be+1}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff",fontWeight:"500",marginBottom:"2px"},children:J.playerName}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#ccc"},children:[J.wins,"W - ",J.losses,"L  ",J.points," pts"]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#888",fontWeight:"600"},children:["#",be+1]})]})},J._id||be))})})}),ue=()=>e.jsx("div",{style:{paddingBottom:"80px"},children:e.jsx(Po,{title:"League Chat",subtitle:"Communicate with other players",children:e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px"},children:[e.jsx("div",{style:{fontSize:"3rem",color:"#888",marginBottom:"16px"},children:e.jsx(zb,{})}),e.jsx("div",{style:{fontSize:"1.1rem",color:"#fff",marginBottom:"8px"},children:"Chat Coming Soon"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#ccc"},children:"Direct messaging and league chat will be available soon"})]})})});return e.jsxs("div",{className:`mobile-dashboard ${M}`,style:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a1a 0%, #2d1b69 100%)",overflowX:"hidden",...E},...$,...P,children:[e.jsxs("div",{style:{padding:"16px"},children:[D==="overview"&&W(),D==="matches"&&Y(),D==="proposals"&&Q(),D==="standings"&&H(),D==="chat"&&ue()]}),e.jsx(TH,{activeTab:D,onTabChange:U,onQuickAction:z,pendingCount:r.length,sentCount:s.length,matchesCount:a.length})]})}const Im=async(n,t)=>{const r=await fetch(`${Ie}/api/matches/status/${encodeURIComponent(n)}/${t}`);if(!r.ok)throw new Error("Failed to fetch matches by status");return r.json()},RH=async(n,t,r,s="")=>{const a=await fetch(`${Ie}/api/matches/${n}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({winner:t,score:r,notes:s})});if(!a.ok){const o=await a.json();throw new Error(o.error||"Failed to complete match")}return a.json()},AH=async(n,t="")=>{const r=await fetch(`${Ie}/api/matches/${n}/cancel`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:t})});if(!r.ok){const s=await r.json();throw new Error(s.error||"Failed to cancel match")}return r.json()},MH=async n=>{const t=await fetch(`${Ie}/api/matches/stats/${encodeURIComponent(n)}`);if(!t.ok)throw new Error("Failed to fetch match statistics");return t.json()},IH=(n,t,r)=>{const[s,a]=y.useState([]),[o,i]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(null),[h,p]=y.useState(null),g=y.useRef(null),f=y.useRef(null),m=y.useCallback(async(w=!1)=>{f.current&&f.current.abort(),f.current=new AbortController;try{w||c(!0);const[x,j]=await Promise.all([Im(t,"scheduled"),Im(t,"completed")]),S=x.filter(N=>N.player1Id===n||N.player2Id===n).map(N=>{const M=N.player1Id===n,E=M?N.player1Id:N.player2Id,P=M?N.player2Id:N.player1Id,D=new Date(N.scheduledDate),T=D.toISOString().split("T")[0],A=D.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return{...N,player:E,opponent:P,senderName:N.player1Id,receiverName:N.player2Id,date:T,time:A,gameType:N.gameType||"8 ball",raceLength:N.raceLength||5,type:"scheduled"}}),_=j.filter(N=>N.player1Id===n||N.player2Id===n).map(N=>{const M=N.player1Id===n,E=M?N.player1Id:N.player2Id,P=M?N.player2Id:N.player1Id,D=new Date(N.scheduledDate),T=D.toISOString().split("T")[0],A=D.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return{...N,player:E,opponent:P,senderName:N.player1Id,receiverName:N.player2Id,date:T,time:A,gameType:N.gameType||"8 ball",raceLength:N.raceLength||5,type:"completed"}});let C=[];try{const N=await ra.getPendingProposals(n,t),M=await ra.getSentProposals(n,t);C=[...N,...M].filter(T=>T.status==="confirmed"&&(T.senderName===n||T.receiverName===n));const P=C.map(T=>{const A=T.senderName===n,k=A?T.senderName:T.receiverName,R=A?T.receiverName:T.senderName;return{_id:T._id,type:"proposal",status:"confirmed",player1Id:T.senderName,player2Id:T.receiverName,player:k,opponent:R,senderName:T.senderName,receiverName:T.receiverName,scheduledDate:T.date?new Date(T.date):new Date,date:T.date,time:T.time,location:T.location,message:T.message,gameType:T.gameType,raceLength:T.raceLength,completed:T.completed||!1,winner:T.winner||null}}),D=[...S,...P];D.sort((T,A)=>new Date(T.scheduledDate)-new Date(A.scheduledDate)),_.sort((T,A)=>new Date(A.completedDate)-new Date(T.completedDate)),f.current.signal.aborted||(a(D),i(_),u(null),p(new Date))}catch(N){console.warn("Error fetching confirmed proposals:",N),f.current.signal.aborted||(S.sort((M,E)=>new Date(M.scheduledDate)-new Date(E.scheduledDate)),_.sort((M,E)=>new Date(E.completedDate)-new Date(M.completedDate)),a(S),i(_),p(new Date))}}catch(x){if(x.name==="AbortError")return;console.error("Error fetching matches:",x),u(x.message),w||(a([]),i([]))}finally{f.current.signal.aborted||c(!1)}},[n,t,r]);y.useEffect(()=>{if(n&&t)return m(),g.current=setInterval(()=>{m(!0)},3e4),()=>{g.current&&clearInterval(g.current),f.current&&f.current.abort()}},[n,t,r,m]);const v=y.useCallback(()=>{m()},[m]),b=y.useCallback((w,x="add")=>{x==="add"?a(j=>[w,...j]):x==="update"?(a(j=>j.map(S=>S._id===w._id?w:S)),i(j=>j.map(S=>S._id===w._id?w:S))):x==="remove"&&(a(j=>j.filter(S=>S._id!==w._id)),i(j=>j.filter(S=>S._id!==w._id))),p(new Date)},[]);return{matches:s,completedMatches:o,scheduledConfirmedMatches:s,loading:l,error:d,lastUpdate:h,refetch:v,updateMatchLocally:b,markMatchCompleted:w=>{a(x=>x.filter(j=>j._id!==w._id)),i(x=>{const j={...w,completed:!0};return[...x,j]}),p(new Date)},updateCompletedMatch:w=>{i(x=>x.map(j=>j._id===w._id?w:j)),p(new Date)}}},DH=n=>{const[t,r]=y.useState(null),[s,a]=y.useState(null),[o,i]=y.useState(!0),[l,c]=y.useState(null),[d,u]=y.useState(null),h=y.useRef(null),p=y.useRef(null),g=y.useCallback(async(m=!1)=>{if(n){p.current&&p.current.abort(),p.current=new AbortController;try{m||i(!0),console.log("useSeasonData - Fetching season data for division:",n);const[v,b]=await Promise.all([zo.getCurrentSeason(n),zo.getCurrentPhaseAndWeek(n)]);console.log("useSeasonData - Season result:",v),console.log("useSeasonData - Phase result:",b),p.current.signal.aborted||(r((v==null?void 0:v.season)||null),a(b),c(null),u(new Date))}catch(v){if(v.name==="AbortError")return;console.error("Error fetching season data:",v),c(v.message),m||(r(null),a(null))}finally{p.current.signal.aborted||i(!1)}}},[n]);y.useEffect(()=>{if(n)return g(),h.current=setInterval(()=>{g(!0)},5*60*1e3),()=>{h.current&&clearInterval(h.current),p.current&&p.current.abort()}},[n,g]);const f=y.useCallback(()=>{g()},[g]);return{seasonData:t,currentPhaseInfo:s,loading:o,error:l,lastUpdate:d,refetch:f}},$H=n=>{const[t,r]=y.useState([]),[s,a]=y.useState(!0),[o,i]=y.useState(null),[l,c]=y.useState(null),d=y.useRef(null),u=y.useRef(null),h=y.useCallback(async(g=!1)=>{if(n){u.current&&u.current.abort(),u.current=new AbortController;try{g||a(!0);const f=n.replace(/[^A-Za-z0-9]/g,"_"),m=`${Ie}/static/standings_${f}.json`,v=await fetch(m,{signal:u.current.signal});if(!v.ok){console.warn(`Failed to fetch standings: ${v.status} - ${v.statusText}`),g||i(`Failed to fetch standings: ${v.status}`);return}const b=await v.json();if(!Array.isArray(b)){console.error("Standings data is not an array:",b),g||i("Invalid standings data format");return}const w=b.filter(x=>{if(!x||typeof x!="object")return console.warn("Invalid standings entry:",x),!1;if(!x.name||!x.rank)return console.warn("Standings entry missing name or rank:",x),!1;const j=parseInt(x.rank);return isNaN(j)||j<=0?(console.warn("Invalid rank in standings entry:",x),!1):!0});u.current.signal.aborted||(r(w),i(null),c(new Date))}catch(f){if(f.name==="AbortError")return;console.error("Failed to load standings:",f),i(f.message),g||r([])}finally{u.current.signal.aborted||a(!1)}}},[n]);y.useEffect(()=>{if(n)return h(),d.current=setInterval(()=>{h(!0)},10*60*1e3),()=>{d.current&&clearInterval(d.current),u.current&&u.current.abort()}},[n,h]);const p=y.useCallback(()=>{h()},[h]);return{standings:t,loading:s,error:o,lastUpdate:l,refetch:p}},Lp={async getAllNotes(){return Tn.get("/api/notes")},async createNote(n){return Tn.post("/api/notes",{text:n})},async deleteNote(n){return Tn.delete(`/api/notes/${n}`)}},LH=()=>{const[n,t]=y.useState([]),[r,s]=y.useState(!0),[a,o]=y.useState(null),[i,l]=y.useState(null),c=y.useRef(null),d=y.useRef(null),u=y.useCallback(async(g=!1)=>{d.current&&d.current.abort(),d.current=new AbortController;try{g||s(!0);const f=await Lp.getAllNotes();d.current.signal.aborted||(t(f),o(null),l(new Date))}catch(f){if(f.name==="AbortError")return;console.error("Error fetching notes:",f),o(f.message),g||t([])}finally{d.current.signal.aborted||s(!1)}},[]);y.useEffect(()=>(u(),c.current=setInterval(()=>{u(!0)},2*60*1e3),()=>{c.current&&clearInterval(c.current),d.current&&d.current.abort()}),[u]);const h=y.useCallback(()=>{u()},[u]),p=y.useCallback((g,f="add")=>{f==="add"?t(m=>[g,...m]):f==="update"?t(m=>m.map(v=>v._id===g._id?g:v)):f==="remove"&&t(m=>m.filter(v=>v._id!==g._id)),l(new Date)},[]);return{notes:n,loading:r,error:a,lastUpdate:i,refetch:h,updateNoteLocally:p}},BH=n=>{const[t,r]=y.useState([]),[s,a]=y.useState(!0),[o,i]=y.useState(null),[l,c]=y.useState(null),d=y.useRef(null),u=y.useRef(null),h=y.useCallback(async(g=!1)=>{if(!n){r([]);return}u.current&&u.current.abort(),u.current=new AbortController;try{g||a(!0);let f;n==="FRBCAPL TEST"?f="schedule_FRBCAPL_TEST.json":n==="Singles Test"?f="schedule_Singles_Test.json":f=`schedule_${n.replace(/[^A-Za-z0-9]/g,"_")}.json`;const m=`${Ie}/static/${f}`,v=await fetch(m,{signal:u.current.signal});if(!v.ok)throw new Error("Schedule not found");const b=await v.json();u.current.signal.aborted||(console.log("Schedule loaded for",n,":",b.length,"matches"),r(b),i(null),c(new Date))}catch(f){if(f.name==="AbortError")return;console.error("Failed to load schedule for",n,":",f),i(f.message),g||r([])}finally{u.current.signal.aborted||a(!1)}},[n]);y.useEffect(()=>{if(n)return h(),d.current=setInterval(()=>{h(!0)},15*60*1e3),()=>{d.current&&clearInterval(d.current),u.current&&u.current.abort()}},[n,h]);const p=y.useCallback(()=>{h()},[h]);return{scheduledMatches:t,loading:s,error:o,lastUpdate:l,refetch:p}};class OH{async checkAndSendDeadlineReminder(t,r,s){try{const a=await zo.getCurrentSeason(s);if(!(a!=null&&a.season)){console.log("No current season found for division:",s);return}const o=a.season,i=new Date,l=new Date(o.phase1End);if(i>l){console.log("Phase 1 deadline has passed, no reminder needed");return}const c=Math.ceil((l-i)/(1e3*60*60*24));if(!this.shouldSendReminder(c))return;const u=await this.getUserMatchStatus(r,s);await j9({to_email:t,to_name:r,division:s,daysUntilDeadline:c,completedMatches:u.completedCount,totalRequiredMatches:u.totalRequired,deadlineDate:As(l,"EEEE, MMMM d, yyyy"),remainingMatches:u.remainingCount}),console.log(`Deadline reminder sent to ${r} for ${s}`)}catch(a){console.error("Error sending deadline reminder:",a)}}shouldSendReminder(t){return[7,3,1,0].includes(t)}async getUserMatchStatus(t,r){try{return{completedCount:1,totalRequired:6,remainingCount:5}}catch(s){return console.error("Error getting user match status:",s),{completedCount:0,totalRequired:6,remainingCount:6}}}async sendBulkDeadlineReminders(t){try{console.log(`Sending bulk deadline reminders for ${t}`)}catch(r){console.error("Error sending bulk deadline reminders:",r)}}}const zH=new OH,FH={"FRBCAPL TEST":"https://lms.fargorate.com/PublicReport/LeagueReports?leagueId=e05896bb-b0f4-4a80-bf99-b2ca012ceaaa&divisionId=b345a437-3415-4765-b19a-b2f7014f2cfa","Singles Test":"https://lms.fargorate.com/PublicReport/LeagueReports?leagueId=e05896bb-b0f4-4a80-bf99-b2ca012ceaaa&divisionId=9058a0cc-3231-4118-bd91-b305006fe578"};ee.shape({name:ee.string.isRequired,description:ee.string,playerCount:ee.number,currentPhase:ee.string,totalMatches:ee.number,completedMatches:ee.number,startDate:ee.string,endDate:ee.string,status:ee.oneOf(["active","completed","pending","inactive"]),logo:ee.string,primaryColor:ee.string,secondaryColor:ee.string}).isRequired,ee.func,ee.bool,ee.bool,ee.bool,ee.node,ee.string,ee.object;ee.shape({name:ee.string.isRequired,email:ee.string,phone:ee.string,rank:ee.number,wins:ee.number,losses:ee.number,totalMatches:ee.number,winPercentage:ee.number,currentStreak:ee.number,bestStreak:ee.number,lastPlayed:ee.string,availability:ee.string,status:ee.oneOf(["active","inactive","suspended","pending"]),avatar:ee.string,primaryColor:ee.string,secondaryColor:ee.string,isOnline:ee.bool}).isRequired,ee.func,ee.bool,ee.bool,ee.bool,ee.node,ee.bool,ee.bool,ee.string,ee.object;ee.shape({id:ee.string.isRequired,player1:ee.string.isRequired,player2:ee.string.isRequired,player1Score:ee.number,player2Score:ee.number,status:ee.oneOf(["scheduled","in_progress","completed","cancelled"]),date:ee.string,time:ee.string,location:ee.string,division:ee.string,phase:ee.string,winner:ee.string,notes:ee.string,primaryColor:ee.string,secondaryColor:ee.string}).isRequired,ee.func,ee.bool,ee.bool,ee.node,ee.bool,ee.bool,ee.string,ee.object;const $C=({playerName:n,playerLastName:t,isMobile:r,userPin:s,playerEmail:a,proposalsLoading:o,matchesLoading:i,notesLoading:l,seasonLoading:c,standingsLoading:d,scheduleLoading:u,styles:h})=>{const p=o||i||l||c||d||u;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:r?"8px":"16px"},children:[e.jsxs("h1",{className:h.dashboardTitle,style:{fontSize:r?"1.6rem":"2rem",textAlign:"center",margin:0,transition:"all 0.2s ease"},children:["Hello,",e.jsxs("span",{className:h.dashboardUserName,style:{fontSize:r?"1.4rem":"1.8rem"},children:[n," ",t]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",marginTop:r?"4px":"8px",fontSize:r?"0.7rem":"0.8rem",color:"#888"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:p?"#f59e0b":"#10b981",animation:p?"pulse 2s infinite":"none"}}),e.jsx("span",{children:p?"Updating...":"Live"})]})]}),e.jsxs("div",{className:h.announcement,style:{fontSize:r?"0.75rem":"1rem",marginBottom:r?"8px":"16px"},children:[e.jsx("p",{children:"This is the BETA version. "}),"Matches that are created, scheduled, and confirmed will NOT be played.",e.jsx("br",{}),"This is for testing purposes only."]}),Bi.getCurrentAdmin()&&a!=="guest@frontrangepool.com"&&e.jsx("div",{style:{marginBottom:r?12:16,textAlign:"center"},children:e.jsxs("button",{onClick:()=>window.location.hash="#/tenball-tutorial",style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",color:"white",padding:r?"10px 16px":"12px 20px",borderRadius:"25px",cursor:"pointer",fontSize:r?"0.9rem":"1rem",fontWeight:"bold",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(76, 175, 80, 0.3)"},children:[e.jsx("img",{src:Qu,alt:"10-Ball",style:{width:"20px",height:"20px",marginRight:"8px",display:"inline-block",verticalAlign:"text-bottom"}}),"Play 10-Ball Tutorial & Learn Official CSI Rules"]})}),!r&&e.jsx("br",{})]})};$C.propTypes={playerName:ee.string.isRequired,playerLastName:ee.string.isRequired,isMobile:ee.bool.isRequired,userPin:ee.string,playerEmail:ee.string,proposalsLoading:ee.bool,matchesLoading:ee.bool,notesLoading:ee.bool,seasonLoading:ee.bool,standingsLoading:ee.bool,scheduleLoading:ee.bool,onProfileClick:ee.func,styles:ee.object.isRequired};const LC=({divisions:n,selectedDivision:t,onDivisionChange:r,isMobile:s})=>n.length===0?null:e.jsx("div",{style:{marginBottom:s?8:16,display:"flex",flexDirection:"column",alignItems:s?"flex-start":"center",gap:s?"8px":"12px"},children:e.jsx("div",{style:{display:"flex",flexDirection:s?"column":"row",alignItems:s?"flex-start":"center",gap:s?"4px":"12px",width:"100%"},children:e.jsxs("label",{style:{fontSize:s?"0.9rem":"1rem"},children:["Division:",n.length>1?e.jsx("select",{value:t,onChange:r,style:{fontSize:s?"0.9em":"1em",padding:s?6:4,borderRadius:4},children:n.map(a=>e.jsx("option",{value:a,children:a},a))}):e.jsx("span",{style:{fontWeight:600},children:n[0]})]})})});LC.propTypes={divisions:ee.arrayOf(ee.string).isRequired,selectedDivision:ee.string.isRequired,onDivisionChange:ee.func.isRequired,isMobile:ee.bool.isRequired};const BC=({isMobile:n,styles:t,effectivePhase:r,seasonData:s,completedMatches:a,totalRequiredMatches:o,playerName:i,playerLastName:l,selectedDivision:c,pendingCount:d,sentCount:u,filteredUpcomingMatches:h,currentUser:p,allPlayers:g,showPhase1Rules:f,setShowPhase1Rules:m,setShowPhase1Overview:v,setPlayerStats:b,setTimeLeft:w,setDeadlineStatus:x,setPhase1EndDate:j,onOpenOpponentsModal:S,onOpenCompletedMatchesModal:_,onOpenStandingsModal:C,onOpenDefenseChallengersModal:N,onOpenAllMatchesModal:M,onOpenProposalListModal:E,onOpenSentProposalListModal:P,onOpenPlayerSearch:D,onMatchClick:T,onSmartMatchClick:A,onOpenMessageCenter:k,onOpenCalendar:R,simulationRef:U,opponentsModalPortal:z})=>e.jsx("section",{className:`${t.dashboardSection} ${t.dashboardSectionBox} ${t.matchesSection}`,style:{position:"relative",overflow:"visible",backgroundColor:"rgba(0, 0, 0, .5)",minHeight:n?"650px":"570px",marginBottom:n?"16px":"36px",paddingBottom:"20px"},children:e.jsx("div",{style:{display:"flex",justifyContent:"center",width:"100%"},children:e.jsxs("div",{className:t.poolTableContainer,style:{marginBottom:n?"12px":"24px",position:"relative",width:"100%",maxWidth:n?"98%":"600px",height:n?"400px":"auto",display:"flex",justifyContent:"center",alignItems:"center"},children:[r==="scheduled"&&s&&e.jsx("div",{style:{position:"absolute",top:n?"50px":"35px",left:"0",right:"0",margin:"0 auto",zIndex:100,width:n?"95%":"90%",maxWidth:n?"500px":"1200px",height:n?"150px":"200px",pointerEvents:"auto"},children:e.jsx(aH,{children:e.jsx(_C,{currentPhase:r,seasonData:s,completedMatches:a,totalRequiredMatches:o,playerName:i,playerLastName:l,selectedDivision:c,onOpenOpponentsModal:S,onOpenCompletedMatchesModal:_,onOpenStandingsModal:C,onOpenAllMatchesModal:M,pendingCount:d,sentCount:u,onOpenProposalListModal:E,onOpenSentProposalListModal:P,upcomingMatches:h,onMatchClick:T,isMobile:n,onOpenMessageCenter:k,currentUser:p,allPlayers:g,onSmartMatchClick:A,showPhase1Rules:f,setShowPhase1Rules:m,showPhase1Overview:!1,setShowPhase1Overview:v,setPlayerStats:b,setTimeLeft:w,setDeadlineStatus:x,setPhase1EndDate:j,onOpenCalendar:R})})}),r==="challenge"&&e.jsx("div",{style:{position:"absolute",top:n?"50px":"35px",left:"0",right:"0",margin:"0 auto",zIndex:10,width:n?"95%":"90%",maxWidth:n?"500px":"1200px",height:n?"150px":"200px"},children:e.jsx(tH,{playerName:i,playerLastName:l,selectedDivision:c,phase:r,isMobile:n,onOpenOpponentsModal:S,onOpenCompletedMatchesModal:_,onOpenStandingsModal:C,onOpenDefenseChallengersModal:N,onOpenAllMatchesModal:M,pendingCount:d,sentCount:u,onOpenProposalListModal:E,onOpenSentProposalListModal:P,onOpenPlayerSearch:D,upcomingMatches:h,onMatchClick:T,seasonData:s,completedMatches:a,standings:[]})}),n?e.jsx("div",{className:t.simulationContainer,ref:U,style:{width:"100% !important",height:"400px !important",position:"relative",minWidth:"0 !important",maxWidth:"100% !important",minHeight:"400px !important",maxHeight:"400px !important",pointerEvents:r==="scheduled"?"none":"auto"},children:e.jsx(Zu,{isRotated:!0})}):e.jsx(dk,{aspectWidth:600,aspectHeight:300,children:e.jsx("div",{className:t.simulationContainer,ref:U,style:{width:"100%",height:"100%",position:"relative",pointerEvents:r==="scheduled"?"none":"auto"},children:e.jsx(Zu,{})})}),z]})})});BC.propTypes={isMobile:ee.bool.isRequired,styles:ee.object.isRequired,effectivePhase:ee.string.isRequired,seasonData:ee.object,completedMatches:ee.array,totalRequiredMatches:ee.number,playerName:ee.string.isRequired,playerLastName:ee.string.isRequired,selectedDivision:ee.string.isRequired,pendingCount:ee.number,sentCount:ee.number,filteredUpcomingMatches:ee.array,currentUser:ee.object,allPlayers:ee.array,showPhase1Rules:ee.bool,setShowPhase1Rules:ee.func,setShowPhase1Overview:ee.func,setPlayerStats:ee.func,setTimeLeft:ee.func,setDeadlineStatus:ee.func,setPhase1EndDate:ee.func,onOpenOpponentsModal:ee.func.isRequired,onOpenCompletedMatchesModal:ee.func.isRequired,onOpenStandingsModal:ee.func.isRequired,onOpenDefenseChallengersModal:ee.func.isRequired,onOpenAllMatchesModal:ee.func.isRequired,onOpenProposalListModal:ee.func.isRequired,onOpenSentProposalListModal:ee.func.isRequired,onOpenPlayerSearch:ee.func.isRequired,onMatchClick:ee.func.isRequired,onSmartMatchClick:ee.func.isRequired,onOpenMessageCenter:ee.func.isRequired,onOpenCalendar:ee.func.isRequired,simulationRef:ee.object,opponentsModalPortal:ee.node};const OC=({notes:n,notesLoading:t,noteError:r,userPin:s,onDeleteNote:a,onClearNotes:o,styles:i})=>e.jsxs("section",{className:`${i.dashboardSection} ${i.dashboardSectionBox} ${i.newsUpdatesSection}`,children:[e.jsx("h2",{className:i.dashboardSectionTitle,children:"News & Updates"}),t?e.jsx(pW,{lines:3,height:"16px"}):e.jsx("ul",{className:i.dashboardList,children:n.length===0?e.jsx("li",{className:i.dashboardNoteItem,children:"No news yet."}):n.map((l,c)=>e.jsxs("li",{className:i.dashboardNoteItem,children:[e.jsx("span",{style:{flex:1},children:l.text}),Bi.getCurrentAdmin()&&e.jsx("button",{onClick:()=>a(l._id),style:{background:"#e53935",color:"#fff",border:"none",borderRadius:4,padding:"2px 8px",cursor:"pointer",fontSize:"0.95em"},"aria-label":"Delete note",title:"Delete note",type:"button",children:"Delete"})]},l._id||c))}),Bi.getCurrentAdmin()&&n.length>0&&e.jsx("button",{style:{marginTop:10,background:"#444",color:"#fff",border:"none",borderRadius:5,padding:"4px 14px",cursor:"pointer",fontSize:"0.98em"},onClick:o,type:"button",children:"Clear All Notes"}),r&&e.jsxs("div",{style:{marginTop:10,padding:"10px",background:"#ffebee",color:"#c62828",border:"1px solid #ffcdd2",borderRadius:"4px",fontSize:"0.9em"},children:["Error: ",r]})]});OC.propTypes={notes:ee.array.isRequired,notesLoading:ee.bool.isRequired,noteError:ee.string,userPin:ee.string,onDeleteNote:ee.func.isRequired,onClearNotes:ee.func.isRequired,styles:ee.object.isRequired};const zC=({userPin:n,loadingPendingRegistrations:t,phaseOverride:r,selectedDivision:s,BACKEND_URL:a,styles:o,onShowRegistrationModal:i,onLoadPendingRegistrations:l,onSetPendingRegistrations:c,onShowPendingRegistrationsModal:d,onCreateTestRegistration:u,onShowNoteModal:h,onGoToAdmin:p,onGoToPlatformAdmin:g,isSuperAdmin:f,onActivatePhase2:m,onSetPhaseOverride:v,onRefreshSeasonData:b,onShowPendingClaimsModal:w})=>Bi.getCurrentAdmin()?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:o.dashboardAdminBtn,onClick:i,type:"button",style:{background:"#4CAF50"},children:"Register Player"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:async()=>{l(!0);try{const j=await fetch(`${a}/api/users/pending-registrations`);if(j.ok){const S=await j.json();c(S),d(!0)}else alert("Failed to load pending registrations")}catch{alert("Error loading pending registrations")}finally{l(!1)}},type:"button",style:{background:"#FF9800"},disabled:t,children:t?"Loading...":"Pending Registrations"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:u,type:"button",style:{background:"#9C27B0"},children:"Create Test Registration"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:h,type:"button",children:"Add Note"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:w,type:"button",style:{background:"#2196F3"},children:" Pending Claims"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:p,type:"button",children:"Admin"}),f()&&g&&e.jsx("button",{className:o.dashboardAdminBtn,onClick:g,type:"button",style:{background:"#8B4513"},children:"Platform Admin"}),e.jsx("button",{className:o.dashboardAdminBtn,onClick:async()=>{if(r==="challenge")v("scheduled");else try{const S=await(await fetch(`${a}/api/seasons/activate-phase2/${encodeURIComponent(s)}`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();S.success?(v("challenge"),alert(" Phase 2 activated successfully! The system will now allow Phase 2 challenges."),s&&b()):alert("Failed to activate Phase 2: "+S.error)}catch(j){alert("Error activating Phase 2: "+j.message)}},type:"button",children:r==="challenge"?"Switch to Phase 1 (Scheduled)":"Activate Phase 2 (Challenge)"}),r&&e.jsx("button",{className:o.dashboardAdminBtn,onClick:()=>v(null),type:"button",style:{background:"#888"},children:"Clear Phase Override"})]}):null;zC.propTypes={userPin:ee.string,loadingPendingRegistrations:ee.bool,phaseOverride:ee.string,selectedDivision:ee.string,BACKEND_URL:ee.string.isRequired,styles:ee.object.isRequired,onShowRegistrationModal:ee.func.isRequired,onLoadPendingRegistrations:ee.func.isRequired,onSetPendingRegistrations:ee.func.isRequired,onShowPendingRegistrationsModal:ee.func.isRequired,onCreateTestRegistration:ee.func.isRequired,onShowNoteModal:ee.func.isRequired,onGoToAdmin:ee.func.isRequired,onGoToPlatformAdmin:ee.func,isSuperAdmin:ee.func.isRequired,onActivatePhase2:ee.func.isRequired,onSetPhaseOverride:ee.func.isRequired,onRefreshSeasonData:ee.func.isRequired,onShowPendingClaimsModal:ee.func.isRequired};const WH=({onClose:n})=>{const[t,r]=y.useState([]),[s,a]=y.useState(!0),[o,i]=y.useState(""),[l,c]=y.useState(null),[d,u]=y.useState(""),[h,p]=y.useState(!1);y.useEffect(()=>{g()},[]);const g=async()=>{try{const b=await fetch(`${Ie}/api/auth/pending-claims`),w=await b.json();b.ok&&w.success?r(w.claims):i(w.message||"Error fetching pending claims")}catch(b){console.error("Fetch claims error:",b),i("Error fetching pending claims")}finally{a(!1)}},f=async b=>{if(!d.trim()){i("Please enter a PIN for the user");return}if(d.length<4){i("PIN must be at least 4 characters");return}p(!0),i("");try{const w=await fetch(`${Ie}/api/auth/approve-account-claim`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:b,pin:d})}),x=await w.json();w.ok&&x.success?(r(j=>j.filter(S=>S.id!==b)),c(null),u(""),alert("Account claim approved successfully!")):i(x.message||"Error approving claim")}catch(w){console.error("Approve error:",w),i("Error approving claim")}finally{p(!1)}},m=async b=>{if(confirm("Are you sure you want to reject this account claim? This action cannot be undone.")){p(!0),i("");try{const w=await fetch(`${Ie}/api/auth/reject-account-claim`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:b})}),x=await w.json();w.ok&&x.success?(r(j=>j.filter(S=>S.id!==b)),c(null),alert("Account claim rejected successfully!")):i(x.message||"Error rejecting claim")}catch(w){console.error("Reject error:",w),i("Error rejecting claim")}finally{p(!1)}}},v=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?e.jsx("div",{className:"pending-claims-overlay",children:e.jsx("div",{className:"pending-claims-modal",children:e.jsx("div",{className:"loading",children:"Loading pending claims..."})})}):e.jsx("div",{className:"pending-claims-overlay",children:e.jsxs("div",{className:"pending-claims-modal",children:[e.jsxs("div",{className:"pending-claims-header",children:[e.jsx("h2",{children:"Pending Account Claims"}),e.jsx("button",{className:"close-btn",onClick:n,children:""})]}),e.jsxs("div",{className:"pending-claims-content",children:[o&&e.jsx("div",{className:"error-message",children:o}),t.length===0?e.jsx("div",{className:"no-claims",children:e.jsx("p",{children:"No pending account claims"})}):e.jsx("div",{className:"claims-list",children:t.map(b=>e.jsxs("div",{className:"claim-item",children:[e.jsxs("div",{className:"claim-header",children:[e.jsxs("h3",{children:[b.firstName," ",b.lastName]}),e.jsx("span",{className:"claim-date",children:v(b.submittedAt)})]}),e.jsxs("div",{className:"claim-details",children:[e.jsxs("div",{className:"contact-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",b.email]}),b.phone&&e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",b.phone]})]}),b.ladderInfo&&e.jsxs("div",{className:"ladder-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ladder Position:"})," #",b.ladderInfo.position]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fargo Rate:"})," ",b.ladderInfo.fargoRate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Record:"})," ",b.ladderInfo.wins,"W - ",b.ladderInfo.losses,"L"]})]}),b.claimMessage&&e.jsxs("div",{className:"claim-message",children:[e.jsx("p",{children:e.jsx("strong",{children:"Message:"})}),e.jsx("p",{children:b.claimMessage})]})]}),e.jsxs("div",{className:"claim-actions",children:[e.jsx("button",{className:"approve-btn",onClick:()=>c(b),disabled:h,children:"Approve"}),e.jsx("button",{className:"reject-btn",onClick:()=>m(b.id),disabled:h,children:"Reject"})]})]},b.id))})]}),l&&e.jsx("div",{className:"approval-modal-overlay",children:e.jsxs("div",{className:"approval-modal",children:[e.jsxs("div",{className:"approval-modal-header",children:[e.jsxs("h3",{children:["Approve Account for ",l.firstName," ",l.lastName]}),e.jsx("button",{className:"close-btn",onClick:()=>c(null),children:""})]}),e.jsxs("div",{className:"approval-modal-content",children:[e.jsx("p",{children:"Set a PIN for this user:"}),e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",value:d,onChange:b=>u(b.target.value),placeholder:"Enter 4-digit PIN",maxLength:"4",pattern:"[0-9]*"})}),e.jsxs("div",{className:"approval-modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>{c(null),u("")},children:"Cancel"}),e.jsx("button",{className:"confirm-approve-btn",onClick:()=>f(l.id),disabled:h||d.length<4,children:h?"Approving...":"Approve Account"})]})]})]})})]})})},FC=({showPlayerSearch:n,showAdminPlayerSearch:t,showPlayerAvailability:r,showProposalModal:s,selectedOpponent:a,proposalData:o,fullName:i,senderEmail:l,selectedDivision:c,effectivePhase:d,playerName:u,playerLastName:h,onClosePlayerSearch:p,onCloseAdminPlayerSearch:g,onClosePlayerAvailability:f,onCloseProposalModal:m,onProposeMatch:v,onProposalComplete:b,onUpdateProposalLocally:w,onRefetchMatches:x,onRefetchProposals:j})=>e.jsxs(e.Fragment,{children:[n&&e.jsx(Lx,{onClose:p,excludeName:i,senderName:i,senderEmail:l,selectedDivision:c,phase:d,onProposalComplete:p}),t&&e.jsx(Lx,{onClose:g,excludeName:null,senderName:i,senderEmail:l,phase:d,onProposalComplete:g}),r&&a&&e.jsx(mf,{onClose:f,player:a,onProposeMatch:v,selectedDivision:c,phase:d}),s&&o&&e.jsx(_f,{player:o.player,day:o.day,slot:o.slot,selectedDivision:o.selectedDivision,phase:o.phase||d,onClose:m,senderName:`${u} ${h}`,senderEmail:l,onProposalComplete:S=>{m(),S&&w(S,"add"),x(),j()}})]});FC.propTypes={showPlayerSearch:ee.bool,showAdminPlayerSearch:ee.bool,showPlayerAvailability:ee.bool,showProposalModal:ee.bool,selectedOpponent:ee.object,proposalData:ee.object,fullName:ee.string.isRequired,senderEmail:ee.string.isRequired,selectedDivision:ee.string.isRequired,effectivePhase:ee.string.isRequired,playerName:ee.string.isRequired,playerLastName:ee.string.isRequired,onClosePlayerSearch:ee.func.isRequired,onCloseAdminPlayerSearch:ee.func.isRequired,onClosePlayerAvailability:ee.func.isRequired,onCloseProposalModal:ee.func.isRequired,onProposeMatch:ee.func.isRequired,onProposalComplete:ee.func.isRequired,onUpdateProposalLocally:ee.func.isRequired,onRefetchMatches:ee.func.isRequired,onRefetchProposals:ee.func.isRequired};const WC=({showStandings:n,showDefenseChallengers:t,modalOpen:r,showNoteModal:s,showProposalListModal:a,showSentProposalListModal:o,showCounterModal:i,showProposalDetailsModal:l,selectedMatch:c,selectedProposal:d,counterProposal:u,newNote:h,noteError:p,proposalNote:g,pendingProposals:f,sentProposals:m,players:v,STANDINGS_URLS:b,onCloseStandings:w,onCloseDefenseChallengers:x,onCloseModal:j,onCloseNoteModal:S,onCloseProposalListModal:_,onCloseSentProposalListModal:C,onCloseCounterModal:N,onCloseProposalDetailsModal:M,onAddNote:E,onUpdateNewNote:P,onSelectProposal:D,onSelectSentProposal:T,onConfirmProposal:A,onCounterPropose:k,onSubmitCounterProposal:R,onEditProposal:U,onDeleteProposal:z,onUpdateProposalLocally:$,onRefetchMatches:W,onRefetchProposals:Y,selectedDivision:Q,effectivePhase:H,userPin:ue,playerName:J,playerLastName:be,senderEmail:Ae,styles:O,proposalService:oe})=>e.jsxs(e.Fragment,{children:[e.jsx(I$,{open:n,onClose:w,standingsUrl:b[Q]}),e.jsx(D$,{open:t,onClose:x,playerName:J,playerLastName:be,selectedDivision:Q}),e.jsx(FO,{open:r,onClose:j,match:c,onCompleted:me=>$(me,"remove"),userPin:ue,onMatchUpdated:me=>$(me,"update"),senderName:`${J} ${be}`,senderEmail:Ae}),s&&e.jsx("div",{className:O.modalOverlay,style:{zIndex:99999},children:e.jsxs("div",{className:O.modalContent,style:{maxWidth:400,margin:"auto"},children:[e.jsx("h2",{children:"Add News/Note"}),e.jsx("textarea",{value:h,onChange:P,rows:4,style:{width:"100%",marginBottom:12,borderRadius:6,padding:8},placeholder:"Enter your note..."}),p&&e.jsx("div",{style:{color:"red",marginBottom:8},children:p}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:O.dashboardBtn,onClick:S,type:"button",children:"Cancel"}),e.jsx("button",{className:O.dashboardBtn,disabled:!h.trim(),onClick:E,type:"button",children:"Add Note"})]})]})}),a&&e.jsx(Uw,{proposals:f,onSelect:D,onClose:_,type:"received"}),o&&e.jsx(Uw,{proposals:m,onSelect:T,onClose:C,type:"sent"}),d&&!l&&e.jsx("div",{className:O.modalOverlay,children:e.jsx("div",{className:O.modalContent,style:{maxWidth:420,margin:"auto"},children:e.jsx(g9,{proposal:d,userNote:g,setUserNote:P,onConfirm:A,onClose:M,onCounterPropose:k,phase:H,currentUserName:`${J} ${be}`,currentUserEmail:Ae})})}),e.jsx(y9,{proposal:u,open:i,onClose:N,onSubmit:R,senderPlayer:v.find(me=>{var Ce,ve;return`${me.firstName} ${me.lastName}`.trim().toLowerCase()===((u==null?void 0:u.senderName)||"").trim().toLowerCase()||((Ce=me.email)==null?void 0:Ce.toLowerCase())===((ve=u==null?void 0:u.senderEmail)==null?void 0:ve.toLowerCase())}),phase:H,selectedDivision:Q}),d&&l&&e.jsx(fW,{proposal:d,open:l,onClose:M,onEdit:U,onDelete:z,phase:H,currentUserName:`${J} ${be}`,currentUserEmail:Ae})]});WC.propTypes={showStandings:ee.bool,showDefenseChallengers:ee.bool,modalOpen:ee.bool,showNoteModal:ee.bool,showProposalListModal:ee.bool,showSentProposalListModal:ee.bool,showCounterModal:ee.bool,showProposalDetailsModal:ee.bool,selectedMatch:ee.object,selectedProposal:ee.object,counterProposal:ee.object,newNote:ee.string,noteError:ee.string,proposalNote:ee.string,pendingProposals:ee.array,sentProposals:ee.array,players:ee.array,STANDINGS_URLS:ee.object.isRequired,onCloseStandings:ee.func.isRequired,onCloseDefenseChallengers:ee.func.isRequired,onCloseModal:ee.func.isRequired,onCloseNoteModal:ee.func.isRequired,onCloseProposalListModal:ee.func.isRequired,onCloseSentProposalListModal:ee.func.isRequired,onCloseCounterModal:ee.func.isRequired,onCloseProposalDetailsModal:ee.func.isRequired,onAddNote:ee.func.isRequired,onUpdateNewNote:ee.func.isRequired,onSelectProposal:ee.func.isRequired,onSelectSentProposal:ee.func.isRequired,onConfirmProposal:ee.func.isRequired,onCounterPropose:ee.func.isRequired,onSubmitCounterProposal:ee.func.isRequired,onEditProposal:ee.func.isRequired,onDeleteProposal:ee.func.isRequired,onUpdateProposalLocally:ee.func.isRequired,onRefetchMatches:ee.func.isRequired,onRefetchProposals:ee.func.isRequired,selectedDivision:ee.string.isRequired,effectivePhase:ee.string.isRequired,userPin:ee.string,playerName:ee.string.isRequired,playerLastName:ee.string.isRequired,senderEmail:ee.string.isRequired,styles:ee.object.isRequired,proposalService:ee.object.isRequired};const UH=({isOpen:n,onClose:t,currentLocations:r="",availableLocations:s=[],onSave:a})=>{const[o,i]=y.useState([]),[l,c]=y.useState(""),[d,u]=y.useState("");y.useEffect(()=>{if(n&&r){const S=r.split(`
`).filter(Boolean);console.log(" LocationSelectionModal: Initializing with currentLocations:",r),console.log(" Parsed locations array:",S),i(S)}else console.log(" LocationSelectionModal: No currentLocations, setting empty array"),i([]);c(""),u("")},[n,r]);const h=()=>{try{return o&&Array.isArray(o)?o.map(S=>String(S).trim()).filter(Boolean):!r||typeof r!="string"?[]:r.split(`
`).filter(Boolean).map(S=>String(S).trim())}catch(S){return console.error("Error parsing user locations:",S),[]}},p=()=>{try{if(!s||!Array.isArray(s))return[];const S=o.length>0?o:h();return s.filter(_=>typeof _!="string"?!1:!S.some(C=>typeof C!="string"?!1:C.trim().toLowerCase()===_.trim().toLowerCase()))}catch(S){return console.error("Error getting unselected locations:",S),[]}},g=S=>d.trim()?S.filter(_=>String(_).toLowerCase().includes(d.toLowerCase())):S,f=S=>{const _=String(S);console.log(" LocationSelectionModal: Toggling location:",_),i(C=>{const N=C.includes(_)?C.filter(M=>M!==_):[...C,_];return console.log(" LocationSelectionModal: Updated selectedLocations:",N),N})},m=()=>{if(l.trim()){const S=l.trim();o.includes(S)||i(_=>[..._,S]),c("")}},v=()=>{const S=o.join(`
`);console.log(" LocationSelectionModal: Saving locations..."),console.log(" selectedLocations state:",o),console.log(" locationsString being sent:",S),a(S),t()},b=S=>{S.key==="Enter"&&m()};if(!n)return null;const w=h(),x=p();g(w);const j=g(x);return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)",padding:"20px"},onClick:t,children:e.jsxs("div",{style:{transform:"translate(0px, 0px)",cursor:"default",background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"1rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:"auto",maxWidth:"850px",minWidth:"700px",margin:"0 auto",left:0,right:0,animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,position:"relative",fontFamily:"inherit",boxSizing:"border-box",textAlign:"center",maxHeight:"85vh",overflowY:"auto"},onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#e53e3e",padding:"0.8rem 1rem 0.6rem 1rem",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",position:"relative",cursor:"grab",userSelect:"none",gap:"0.8rem"},children:[e.jsx("span",{style:{position:"absolute",left:0,top:0,width:"100%",height:"4px",background:"linear-gradient(90deg, #fff0 0%, #e53e3e 60%, #fff0 100%)",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",pointerEvents:"none"}}),e.jsx("h2",{style:{margin:0,fontSize:"1rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",color:"#fff",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0},children:" Select Your Locations"}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#fff",fontSize:"1.5rem",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"background-color 0.2s",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",minWidth:"24px",zIndex:3},onMouseEnter:S=>S.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",onMouseLeave:S=>S.target.style.backgroundColor="transparent",children:""})]}),e.jsxs("div",{style:{padding:"0.5rem",overflowY:"auto",maxHeight:"calc(75vh - 80px)"},children:[e.jsx("div",{style:{marginBottom:"8px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("input",{type:"text",placeholder:" Search locations...",value:d,onChange:S=>u(S.target.value),style:{flex:1,padding:"8px 10px",borderRadius:"6px",border:"1px solid #333",backgroundColor:"#2a2a2a",color:"#fff",fontSize:"14px"}}),e.jsx("span",{style:{color:"#888",fontSize:"0.8rem",whiteSpace:"nowrap"},children:d?`${j.length} of ${x.length}`:`${x.length} total`}),d&&e.jsx("button",{onClick:()=>u(""),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #555",backgroundColor:"transparent",color:"#888",cursor:"pointer",fontSize:"0.75rem"},children:"Clear"})]})}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("div",{style:{color:"#ffc107",fontSize:"0.9rem",fontWeight:"bold",marginBottom:"6px",textAlign:"left"},children:" Add Custom Location:"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{type:"text",placeholder:"Type a custom location name...",value:l,onChange:S=>c(S.target.value),onKeyPress:b,style:{flex:1,padding:"6px 8px",borderRadius:"6px",border:"1px solid #333",backgroundColor:"#2a2a2a",color:"#fff",fontSize:"14px"}}),e.jsx("button",{onClick:m,disabled:!l.trim(),style:{padding:"6px 10px",borderRadius:"6px",border:"none",backgroundColor:l.trim()?"#dc3545":"#555",color:"#fff",cursor:l.trim()?"pointer":"not-allowed",fontSize:"14px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Add"})]})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{color:"#4CAF50",fontSize:"0.9rem",fontWeight:"bold",marginBottom:"6px",textAlign:"left"},children:[" Selected (",o.length,")"]}),e.jsx("div",{style:{maxHeight:"120px",overflowY:"auto",padding:"6px",backgroundColor:"rgba(76, 175, 80, 0.05)",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.2)"},children:o.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"4px"},children:o.map((S,_)=>e.jsxs("div",{onClick:()=>f(S),style:{cursor:"pointer",padding:"4px 8px",borderRadius:"4px",background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.4)",color:"#4CAF50",fontSize:"0.75rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center",transition:"all 0.2s ease"},onMouseEnter:C=>{C.target.style.background="rgba(76, 175, 80, 0.3)",C.target.style.transform="scale(1.02)"},onMouseLeave:C=>{C.target.style.background="rgba(76, 175, 80, 0.2)",C.target.style.transform="scale(1)"},children:[" ",String(S)]},_))}):e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",textAlign:"center",fontStyle:"italic",padding:"8px"},children:"No locations selected"})})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{color:"#ffc107",fontSize:"0.9rem",fontWeight:"bold",marginBottom:"6px",textAlign:"left"},children:[" Available (",j.length,")"]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"6px",backgroundColor:"rgba(255, 193, 7, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 193, 7, 0.2)"},children:j.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"4px"},children:j.map((S,_)=>e.jsxs("div",{onClick:()=>f(S),style:{cursor:"pointer",padding:"4px 8px",borderRadius:"4px",background:o.includes(S)?"rgba(255, 193, 7, 0.3)":"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.4)",color:"#ffc107",fontSize:"0.75rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center",transition:"all 0.2s ease"},onMouseEnter:C=>{o.includes(S)||(C.target.style.background="rgba(255, 193, 7, 0.2)",C.target.style.transform="scale(1.02)")},onMouseLeave:C=>{o.includes(S)||(C.target.style.background="rgba(255, 193, 7, 0.1)",C.target.style.transform="scale(1)")},children:[o.includes(S)?" ":"",String(S)]},_))}):e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",textAlign:"center",fontStyle:"italic",padding:"8px"},children:d?"No locations match your search":"No available locations to add"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"8px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("button",{onClick:t,style:{padding:"8px 16px",borderRadius:"6px",border:"1px solid #555",backgroundColor:"transparent",color:"#888",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),e.jsx("button",{onClick:v,style:{padding:"8px 16px",borderRadius:"6px",border:"none",backgroundColor:"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Save Locations"})]})]})]})})},Eo={async signIn(n,t){return await K.auth.signInWithPassword({email:n,password:t})},async getUserProfile(n){try{const{data:t,error:r}=await K.from("users").select("*").eq("id",n).single();if(r&&r.code==="42P17"){console.log("RLS recursion detected, trying alternative query...");const{data:s,error:a}=await K.from("users").select("id, email, first_name, last_name, created_at").eq("id",n).single();return{data:s,error:a}}return{data:t,error:r}}catch(t){return console.error("Error in getUserProfile:",t),{data:null,error:t}}},async getLeagueProfile(n){const{data:t,error:r}=await K.from("league_profiles").select("*").eq("user_id",n).maybeSingle();return{data:t,error:r}},async getLadderProfile(n){const{data:t,error:r}=await K.from("ladder_profiles").select("*").eq("user_id",n).maybeSingle();return{data:t,error:r}},async signOut(){return await K.auth.signOut()}};let qH=class{constructor(){this.currentUser=null,this.isAuthenticated=!1}async signIn(t,r){var s,a;try{console.log(" Supabase sign in attempt for:",t);const{data:o,error:i}=await Eo.signIn(t,r);if(i)return console.error(" Supabase sign in error:",i.message),{success:!1,message:this.getErrorMessage(i)};if(o.user){console.log(" Supabase sign in successful:",t);const l={id:o.user.id,email:o.user.email,first_name:((s=o.user.user_metadata)==null?void 0:s.first_name)||"User",last_name:((a=o.user.user_metadata)==null?void 0:a.last_name)||"Name",created_at:o.user.created_at};return this.currentUser={...l,leagueProfile:null,ladderProfile:null},this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:"user"}}return{success:!1,message:"Authentication failed"}}catch(o){return console.error(" Supabase authentication error:",o),{success:!1,message:"Authentication failed. Please try again."}}}async signOut(){try{const{error:t}=await Eo.signOut();return t?(console.error(" Supabase sign out error:",t),{success:!1,message:t.message}):(this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),console.log(" Supabase sign out successful"),{success:!0})}catch(t){return console.error(" Sign out error:",t),{success:!1,message:t.message}}}async checkAuthStatus(){try{const{data:{session:t}}=await K.auth.getSession();if(t!=null&&t.user){const s=await Eo.getUserProfile(t.user.id);if(s.data){const[a,o]=await Promise.all([Eo.getLeagueProfile(t.user.id),Eo.getLadderProfile(t.user.id)]);return this.currentUser={...s.data,leagueProfile:a.data,ladderProfile:o.data},this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:this.determineUserType(a.data,o.data)}}}const r=localStorage.getItem("supabaseAuth");if(r){const s=JSON.parse(r);return this.currentUser=s.user,this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:s.userType}}return this.isAuthenticated=!1,{success:!1}}catch(t){return console.error(" Auth status check error:",t),this.isAuthenticated=!1,{success:!1}}}getCurrentUser(){return this.currentUser}isUserAuthenticated(){return this.isAuthenticated}determineUserType(t,r){return t&&r?"both":t?"league":r?"ladder":"user"}getErrorMessage(t){switch(t.message){case"Invalid login credentials":return"Invalid email or password. Please try again.";case"Email not confirmed":return"Please check your email and click the confirmation link.";case"Too many requests":return"Too many login attempts. Please wait a moment and try again.";default:return t.message||"Login failed. Please try again."}}storeAuthData(t,r){const s={user:t,userType:r,timestamp:Date.now()};localStorage.setItem("supabaseAuth",JSON.stringify(s)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("userData",JSON.stringify(t))}async resetPassword(t){try{console.log(" Requesting password reset for:",t);const r=`${window.location.origin}/#/reset-password`;console.log(" Password reset redirect URL:",r);const{data:s,error:a}=await K.auth.resetPasswordForEmail(t,{redirectTo:r});return a?(console.error(" Password reset error:",a),console.error(" Error details:",JSON.stringify(a,null,2)),{error:a,message:a.message||"Failed to send password reset email. Check if SMTP is configured in Supabase."}):(console.log(" Password reset email sent successfully"),{success:!0,data:s,message:"Password reset email sent! Check your inbox."})}catch(r){return console.error(" Password reset exception:",r),{error:r,message:r.message||"Failed to send password reset email."}}}async addAlternateLogin(t,r){try{const{data:{session:s}}=await K.auth.getSession();if(!(s!=null&&s.access_token))return{success:!1,message:"You must be logged in to add an alternate login."};const a=await fetch(`${$O}/add-alternate-login`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({password:r})}),o=await a.json();return a.ok?{success:!0,message:o.message}:{success:!1,message:o.error||"Failed to add alternate login."}}catch(s){return console.error(" Add alternate login error:",s),{success:!1,message:"Failed to add alternate login. Please try again."}}}async signInWithOAuth(t,r={}){try{console.log(` Signing in with ${t}...`),console.log(" Clearing existing session before OAuth..."),await K.auth.signOut(),this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),localStorage.removeItem("userFirstName"),localStorage.removeItem("userLastName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userPin"),localStorage.removeItem("userToken"),localStorage.removeItem("userType");const s=`${window.location.origin}/#/auth/callback`,a=typeof window<"u"&&window.self!==window.top;console.log(" OAuth redirectTo (must be in Supabase URL Configuration):",s),a&&console.log(" In iframe  using iframe origin for Google:",window.location.origin);const{data:o,error:i}=await K.auth.signInWithOAuth({provider:t,options:{redirectTo:s,queryParams:{access_type:"offline",prompt:"consent"}}});return i?(console.error(` ${t} OAuth error:`,i),{success:!1,message:i.message||`Failed to sign in with ${t}.`}):(o!=null&&o.url&&(a?window.top.location.href=o.url:window.location.href=o.url),{success:!0,message:`Redirecting to ${t}...`})}catch(s){return console.error(` ${t} OAuth exception:`,s),{success:!1,message:`Failed to sign in with ${t}.`}}}async handleOAuthCallback(){var t,r,s;try{console.log(" Processing OAuth callback, checking for session..."),console.log(" Current URL hash:",window.location.hash);const{data:a}=await K.auth.getSession();(t=a==null?void 0:a.session)!=null&&t.user?console.log(" Already have a valid session, skipping signOut"):(console.log(" Clearing any existing session before processing OAuth callback..."),await K.auth.signOut(),this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),localStorage.removeItem("userFirstName"),localStorage.removeItem("userLastName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userPin"),localStorage.removeItem("userToken"),localStorage.removeItem("userType"));const o=window.location.hash;console.log(" Full URL hash:",o);const i=o.split("#"),l=i[i.length-1];if(l&&l.includes("access_token")){const u=new URLSearchParams(l),h=u.get("access_token"),p=u.get("refresh_token");if(console.log(" Found tokens in URL hash:",{accessToken:h?"Found":"Missing",refreshToken:p?"Found":"Missing"}),h&&p){const{data:g,error:f}=await K.auth.setSession({access_token:h,refresh_token:p});if(f)return console.error(" Error setting session from tokens:",f),{success:!1,message:f.message||"Failed to establish session from OAuth tokens."};if((r=g==null?void 0:g.session)!=null&&r.user)return console.log(" Session established from tokens! User:",g.session.user.email),console.log(" User ID:",g.session.user.id),window.history.replaceState({},document.title,window.location.pathname+window.location.search),await this.processOAuthSession(g.session)}}console.log(" No tokens in URL hash, checking getSession..."),await new Promise(u=>setTimeout(u,500));let{data:c,error:d}=await K.auth.getSession();return(s=c==null?void 0:c.session)!=null&&s.user?(console.log(" Session found via getSession! User:",c.session.user.email),console.log(" User ID:",c.session.user.id),await this.processOAuthSession(c.session)):(console.error(" No session found after OAuth callback"),{success:!1,message:"No session found after OAuth. Please try logging in again."})}catch(a){return console.error(" OAuth callback exception:",a),{success:!1,message:a.message||"Authentication failed."}}}async processOAuthSession(t){var r,s,a,o,i,l,c,d,u,h,p,g;try{if(!(t!=null&&t.user))return{success:!1,message:"Invalid session."};console.log(" OAuth sign in successful:",t.user.email);const f=await Eo.getUserProfile(t.user.id);if(f.data){const m=f.data.is_admin,v=m===!0||m==="true"||m===1,b=f.data.is_approved,w=f.data.is_active,x=v||(b===!0||b==="true"||b===1)&&(w===!0||w==="true"||w===1);if(console.log(" Existing user approval check:",{email:f.data.email,is_admin:f.data.is_admin,is_approved:f.data.is_approved,is_active:f.data.is_active,isApproved:x,rawData:JSON.stringify(f.data,null,2)}),!x)return console.log(" Existing user pending approval - signing out and not authenticating"),console.log(" Approval status:",{is_approved:f.data.is_approved,is_active:f.data.is_active,is_pending_approval:f.data.is_pending_approval}),await K.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account is pending admin approval. Please wait for approval before logging in.",isNewUser:!1,requiresApproval:!0,user:{...f.data,leagueProfile:null,ladderProfile:null}};console.log(" User is approved - proceeding with authentication");const[j,S]=await Promise.all([Eo.getLeagueProfile(t.user.id),Eo.getLadderProfile(t.user.id)]);return this.currentUser={...f.data,leagueProfile:j.data,ladderProfile:S.data},this.isAuthenticated=!0,this.storeAuthData(this.currentUser,this.determineUserType(j.data,S.data)),{success:!0,user:this.currentUser,userType:this.determineUserType(j.data,S.data)}}else{console.log(" New OAuth user detected, creating user profile...");const m=((r=t.user.user_metadata)==null?void 0:r.full_name)||((s=t.user.user_metadata)==null?void 0:s.name)||((a=t.user.user_metadata)==null?void 0:a.display_name)||"",v=((o=t.user.user_metadata)==null?void 0:o.first_name)||((i=t.user.user_metadata)==null?void 0:i.given_name)||(m?m.split(" ")[0]:"")||((l=t.user.email)==null?void 0:l.split("@")[0])||"User",b=((c=t.user.user_metadata)==null?void 0:c.last_name)||((d=t.user.user_metadata)==null?void 0:d.family_name)||(m?m.split(" ").slice(1).join(" "):"")||"",w=v.trim()||((u=t.user.email)==null?void 0:u.split("@")[0])||"User",x=b.trim()||"";console.log(" Extracted OAuth user info:",{firstName:w,lastName:x,email:t.user.email,metadata:t.user.user_metadata});const j=((h=t.user.app_metadata)==null?void 0:h.provider)||((p=t.user.user_metadata)==null?void 0:p.provider)||t.user.identities&&((g=t.user.identities[0])==null?void 0:g.provider)||"oauth",{data:S,error:_}=await K.from("users").insert({id:t.user.id,email:t.user.email,first_name:w,last_name:x||"Name",is_pending_approval:!0,is_approved:!1,is_active:!1,auth_provider:j,created_at:new Date().toISOString()}).select().single();if(_)if(_.code==="23505"){console.log(" User already exists, fetching profile...");const C=await Eo.getUserProfile(t.user.id);if(C.data){if(this.currentUser={...C.data,leagueProfile:null,ladderProfile:null},!(C.data.is_admin===!0||C.data.is_admin==="true"||C.data.is_admin===1||C.data.is_approved===!0&&C.data.is_active===!0))return console.log(" Existing user pending approval - signing out and not authenticating"),await K.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account is pending admin approval. Please wait for approval before logging in.",isNewUser:!1,requiresApproval:!0,user:{...C.data,leagueProfile:null,ladderProfile:null}}}else throw new Error("Failed to create or fetch user profile")}else throw console.error(" Error creating OAuth user profile:",_),_;else{console.log(" New user created:",{id:S.id,email:S.email,is_approved:S.is_approved,is_active:S.is_active,is_pending_approval:S.is_pending_approval}),this.currentUser={...S,leagueProfile:null,ladderProfile:null};const C=S.is_approved,N=S.is_active,M=(C===!0||C==="true"||C===1)&&(N===!0||N==="true"||N===1);if(console.log(" Checking approval status:",{is_approved:S.is_approved,is_approved_type:typeof S.is_approved,is_active:S.is_active,is_active_type:typeof S.is_active,isApproved:M}),!M)return console.log(" New user pending approval - signing out and not authenticating"),await K.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account has been created and is pending admin approval. Please wait for approval before logging in.",isNewUser:!0,requiresApproval:!0,user:{...S,leagueProfile:null,ladderProfile:null}};console.log(" User is approved - proceeding with authentication")}return this.isAuthenticated=!0,this.storeAuthData(this.currentUser,"user"),{success:!0,user:this.currentUser,userType:"user",isNewUser:!1}}}catch(f){return console.error(" Error processing OAuth session:",f),{success:!1,message:f.message||"Failed to process authentication."}}}};const Hl=new qH,HH=({isOpen:n,onClose:t,userEmail:r,onUserUpdate:s})=>{const[a,o]=y.useState(null),[i,l]=y.useState("password"),[c,d]=y.useState(""),[u,h]=y.useState(""),[p,g]=y.useState(""),[f,m]=y.useState(""),[v,b]=y.useState(""),[w,x]=y.useState(""),[j,S]=y.useState(!1),[_,C]=y.useState(""),[N,M]=y.useState(""),E=r||f;y.useEffect(()=>{if(!n)return;C(""),M(""),d(""),h(""),g(""),b(""),x(""),m(r||"");const $=async()=>{var Q;const{data:{user:W}}=await K.auth.getUser();if(!((Q=W==null?void 0:W.identities)!=null&&Q.length)){o(!1),m((W==null?void 0:W.email)||r||"");return}const Y=W.identities.some(H=>H.provider==="email");o(Y),m((W==null?void 0:W.email)||r||"")};o(null),l("password"),$()},[n,r]);const P=async $=>{if($.preventDefault(),C(""),M(""),!(f!=null&&f.trim())||!u||!p){C("Email and password are required");return}if(u.length<6){C("Password must be at least 6 characters");return}if(u!==p){C("Passwords do not match");return}try{S(!0);const W=await Hl.addAlternateLogin(f.trim(),u);W.success?(M(W.message),m(""),h(""),g(""),setTimeout(()=>t(),2e3)):C(W.message)}catch{C("An error occurred. Please try again.")}finally{S(!1)}},D=async $=>{if($.preventDefault(),C(""),M(""),!u||!p){C("All fields are required");return}if(a&&!c){C("Current password is required");return}if(u.length<6){C("Password must be at least 6 characters");return}if(u!==p){C("Passwords do not match");return}try{if(S(!0),a){const{error:Y}=await K.auth.signInWithPassword({email:E,password:c});if(Y){C("Current password is incorrect"),S(!1);return}}const{error:W}=await K.auth.updateUser({password:u});if(W){C("Failed to update: "+W.message),S(!1);return}M(a?"Password changed successfully!":"Password set! You can now sign in with email and this password."),d(""),h(""),g(""),setTimeout(()=>t(),2e3)}catch(W){C("An error occurred: "+W.message)}finally{S(!1)}},T=async $=>{$.preventDefault(),C(""),M("");const W=v==null?void 0:v.trim();if(!W||!(w!=null&&w.trim())){C("New email and confirmation are required");return}if(W!==w.trim()){C("Emails do not match");return}if(W===E){C("New email is the same as current email");return}if(!c){C("Current password is required to change email");return}try{S(!0);const{error:Y}=await K.auth.signInWithPassword({email:E,password:c});if(Y){C("Current password is incorrect"),S(!1);return}const{data:{user:Q}}=await K.auth.getUser(),{error:H}=await K.auth.updateUser({email:W});if(H){C("Failed to update: "+H.message),S(!1);return}Q!=null&&Q.id&&await K.from("users").update({email:W}).eq("id",Q.id),M("Email updated! Use the new email for email/password sign-in. Google sign-in is unchanged."),b(""),x(""),d(""),m(W),s==null||s(),setTimeout(()=>t(),2e3)}catch(Y){C("An error occurred: "+Y.message)}finally{S(!1)}},A=a===!1,k={width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#2a2a2a",color:"#fff"},R={background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",borderRadius:"4px",padding:"10px",marginBottom:"15px",color:"#dc3545"},U={background:"rgba(40, 167, 69, 0.1)",border:"1px solid rgba(40, 167, 69, 0.3)",borderRadius:"4px",padding:"10px",marginBottom:"15px",color:"#28a745"},z={flex:1,padding:"10px",borderRadius:"4px",border:"none",color:"#fff",cursor:"pointer",fontWeight:"bold"};return e.jsx(It,{open:n,onClose:t,title:A?" Add Alternate Login":" Login & Security",maxWidth:"400px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{style:{color:"#aaa",fontSize:"0.85rem",marginBottom:"16px",lineHeight:1.5},children:A?"Add an email and password so you can sign in either way. Your primary login (e.g. Google) stays the same.":"Manage your email/password login. Changes do not affect Google sign-in."}),a===null?e.jsx("p",{style:{color:"#aaa",textAlign:"center"},children:"Loading..."}):A?e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Alternate login email:"}),e.jsx("input",{type:"email",value:f,onChange:$=>m($.target.value),placeholder:"email@example.com",style:k})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Password:"}),e.jsx("input",{type:"password",value:u,onChange:$=>h($.target.value),style:k}),e.jsx("small",{style:{color:"#999",fontSize:"0.85rem"},children:"Must be at least 6 characters"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Confirm Password:"}),e.jsx("input",{type:"password",value:p,onChange:$=>g($.target.value),style:k})]}),_&&e.jsxs("div",{style:R,children:[" ",_]}),N&&e.jsxs("div",{style:U,children:[" ",N]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"submit",disabled:j,style:{...z,background:j?"#666":"#007bff"},children:j?"Adding...":"Add Alternate Login"}),e.jsx("button",{type:"button",onClick:t,style:{...z,background:"transparent",border:"1px solid #444"},children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsx("button",{type:"button",onClick:()=>{l("password"),C(""),M("")},style:{flex:1,padding:"8px",borderRadius:"4px",border:i==="password"?"1px solid #007bff":"1px solid #444",background:i==="password"?"rgba(0,123,255,0.2)":"transparent",color:"#fff",cursor:"pointer",fontSize:"0.9rem"},children:"Change Password"}),e.jsx("button",{type:"button",onClick:()=>{l("email"),C(""),M("")},style:{flex:1,padding:"8px",borderRadius:"4px",border:i==="email"?"1px solid #007bff":"1px solid #444",background:i==="email"?"rgba(0,123,255,0.2)":"transparent",color:"#fff",cursor:"pointer",fontSize:"0.9rem"},children:"Change Email"})]}),i==="password"?e.jsxs("form",{onSubmit:D,children:[a&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Current Password:"}),e.jsx("input",{type:"password",value:c,onChange:$=>d($.target.value),style:k})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:a?"New Password:":"Password:"}),e.jsx("input",{type:"password",value:u,onChange:$=>h($.target.value),style:k}),e.jsx("small",{style:{color:"#999",fontSize:"0.85rem"},children:"Must be at least 6 characters"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:a?"Confirm New Password:":"Confirm Password:"}),e.jsx("input",{type:"password",value:p,onChange:$=>g($.target.value),style:k})]}),_&&e.jsxs("div",{style:R,children:[" ",_]}),N&&e.jsxs("div",{style:U,children:[" ",N]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"submit",disabled:j,style:{...z,background:j?"#666":"#007bff"},children:j?a?"Changing...":"Setting...":a?"Change Password":"Set Password"}),e.jsx("button",{type:"button",onClick:t,style:{...z,background:"transparent",border:"1px solid #444"},children:"Cancel"})]})]}):e.jsxs("form",{onSubmit:T,children:[e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Current email (email/password login):"}),e.jsx("input",{type:"email",value:E,readOnly:!0,style:{...k,opacity:.7,cursor:"not-allowed"}})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"New email:"}),e.jsx("input",{type:"email",value:v,onChange:$=>b($.target.value),placeholder:"new@example.com",style:k})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Confirm new email:"}),e.jsx("input",{type:"email",value:w,onChange:$=>x($.target.value),placeholder:"new@example.com",style:k})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff"},children:"Current password:"}),e.jsx("input",{type:"password",value:c,onChange:$=>d($.target.value),style:k}),e.jsx("small",{style:{color:"#999",fontSize:"0.85rem"},children:"Required to verify your identity"})]}),e.jsx("p",{style:{color:"#999",fontSize:"0.8rem",marginBottom:"16px"},children:"Only affects email/password sign-in. Google sign-in is unchanged."}),_&&e.jsxs("div",{style:R,children:[" ",_]}),N&&e.jsxs("div",{style:U,children:[" ",N]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"submit",disabled:j,style:{...z,background:j?"#666":"#007bff"},children:j?"Updating...":"Change Email"}),e.jsx("button",{type:"button",onClick:t,style:{...z,background:"transparent",border:"1px solid #444"},children:"Cancel"})]})]})]})]})})};class YH{constructor(){this.isSupported="Notification"in window,this.permission=this.isSupported?Notification.permission:"denied",this.isEnabled=!1}async requestPermission(){if(!this.isSupported)return console.warn("Browser notifications are not supported"),!1;if(this.permission==="granted")return this.isEnabled=!0,!0;if(this.permission==="denied")return console.warn("Notification permission was denied"),!1;try{const t=await Notification.requestPermission();return this.permission=t,this.isEnabled=t==="granted",this.isEnabled?(console.log(" Notification permission granted"),localStorage.setItem("notificationsEnabled","true")):(console.log(" Notification permission denied"),localStorage.setItem("notificationsEnabled","false")),this.isEnabled}catch(t){return console.error("Error requesting notification permission:",t),!1}}isNotificationEnabled(){return this.isSupported?localStorage.getItem("notificationsEnabled")==="true"&&this.permission==="granted"?(this.isEnabled=!0,!0):this.isEnabled:!1}showNotification(t,r,s={}){if(!this.isNotificationEnabled())return console.log("Notifications not enabled, skipping:",t),null;try{const a=new Notification(t,{body:r,icon:s.icon||"/favicon.ico",badge:s.badge||"/favicon.ico",tag:s.tag||"ladder-notification",requireInteraction:s.requireInteraction||!1,silent:s.silent||!1,data:s.data||{}});return s.requireInteraction||setTimeout(()=>{a.close()},5e3),a.onclick=()=>{window.focus(),a.close(),s.data&&s.data.route&&s.onClick&&s.onClick(s.data)},a}catch(a){return console.error("Error showing notification:",a),null}}showChallengeNotification(t){const{challenger:r,challengeType:s,matchDetails:a}=t,o=" New Challenge!",i=`${r.firstName} ${r.lastName} challenged you to a ${s} match!`;return this.showNotification(o,i,{tag:`challenge-${t._id}`,requireInteraction:!0,data:{type:"challenge",challengeId:t._id,route:"/ladder"}})}showChallengeAcceptedNotification(t){const{defender:r,challengeType:s}=t,a=" Challenge Accepted!",o=`${r.firstName} ${r.lastName} accepted your ${s} challenge!`;return this.showNotification(a,o,{tag:`challenge-accepted-${t._id}`,data:{type:"challenge-accepted",challengeId:t._id,route:"/ladder"}})}showChallengeDeclinedNotification(t){const{defender:r,challengeType:s}=t,a=" Challenge Declined",o=`${r.firstName} ${r.lastName} declined your ${s} challenge.`;return this.showNotification(a,o,{tag:`challenge-declined-${t._id}`,data:{type:"challenge-declined",challengeId:t._id,route:"/ladder"}})}showCounterProposalNotification(t){const{defender:r,challengeType:s}=t,a=" Counter-Proposal!",o=`${r.firstName} ${r.lastName} submitted a counter-proposal to your ${s} challenge!`;return this.showNotification(a,o,{tag:`counter-proposal-${t._id}`,requireInteraction:!0,data:{type:"counter-proposal",challengeId:t._id,route:"/ladder"}})}showMatchReminderNotification(t){const{player1:r,player2:s,matchDate:a,location:o}=t,i=" Match Reminder",l=`Your match between ${r.firstName} ${r.lastName} and ${s.firstName} ${s.lastName} is coming up!`;return this.showNotification(i,l,{tag:`match-reminder-${t._id}`,data:{type:"match-reminder",matchId:t._id,route:"/ladder"}})}showLadderUpdateNotification(t){const{oldPosition:r,newPosition:s,ladderName:a}=t,o=" Ladder Update!",i=`You moved from position ${r} to position ${s} on the ${a} ladder!`;return this.showNotification(o,i,{tag:`ladder-update-${Date.now()}`,data:{type:"ladder-update",route:"/ladder"}})}disableNotifications(){this.isEnabled=!1,localStorage.setItem("notificationsEnabled","false"),console.log("Notifications disabled")}async enableNotifications(){return this.permission==="granted"?(this.isEnabled=!0,localStorage.setItem("notificationsEnabled","true"),console.log("Notifications enabled"),!0):await this.requestPermission()}getStatus(){return{isSupported:this.isSupported,permission:this.permission,isEnabled:this.isEnabled,canRequest:this.permission==="default"}}}const ls=new YH,UC=({isOpen:n,onClose:t,currentUser:r,isMobile:s,onUserUpdate:a})=>{const[o,i]=y.useState(null),[l,c]=y.useState({}),[d,u]=y.useState(r),[h,p]=y.useState([]),[g,f]=y.useState(!1),[m,v]=y.useState(!1),[b,w]=y.useState(0);y.useEffect(()=>{u(r)},[r]),y.useEffect(()=>{console.log(" localUser state updated:",d)},[d]),y.useEffect(()=>{console.log(" refreshTrigger changed to:",b)},[b]),y.useEffect(()=>{(async()=>{var P,D,T;if(n&&(r!=null&&r.email))try{console.log(" Loading profile data for:",r.email);const A=await mt.getUserProfileData(r.email);if(console.log(" Supabase profile result:",A),A.success){const k=A.data;console.log(" Loaded profile data:",k),console.log(" Locations from Supabase:",(P=k.profile)==null?void 0:P.locations),console.log(" Availability from Supabase:",(D=k.profile)==null?void 0:D.availability),console.log(" Phone from Supabase:",(T=k.profile)==null?void 0:T.phone),u(R=>{var z,$,W,Y,Q;const U={...R,locations:((z=k.profile)==null?void 0:z.locations)||"",availability:(($=k.profile)==null?void 0:$.availability)||{},phone:((W=k.profile)==null?void 0:W.phone)||"",divisions:((Y=k.profile)==null?void 0:Y.divisions)||[],ladderInfo:((Q=k.profile)==null?void 0:Q.ladderInfo)||null};return console.log(" Updated localUser:",U),U})}else console.error(" Failed to load profile data:",A.error)}catch(A){console.error(" Error loading profile data:",A)}else console.log(" Modal not open or no email:",{isOpen:n,email:r==null?void 0:r.email})})()},[n,r==null?void 0:r.email]),y.useEffect(()=>{(async()=>{if(n)try{console.log(" Loading available locations...");const P=await mt.getLocations();if(console.log(" Locations from Supabase:",P),P.success){const D=P.data||[];console.log(" Raw locations structure:",D);const T=D.map(A=>{if(typeof A=="string")return console.log(`   String location: "${A}"`),A;if(A&&typeof A=="object"){console.log("   Object location:",A);const k=A.name||A.locationName||A.title||A.location||A.value||JSON.stringify(A);return console.log(`   Extracted name: "${k}"`),k}else return console.log("   Other type location:",A),String(A)}).filter(Boolean);console.log(" Final processed locations:",T),console.log(" Setting availableLocations to:",T),p(T)}else console.error(" Failed to load locations. Status:",response.status)}catch(P){console.error(" Error loading locations:",P)}})()},[n]);const x=(E,P)=>{i(E),c(P)},j=()=>{i(null),c({})},S=async E=>{try{console.log("Saving section:",E),console.log("Edit data:",l),console.log("Current user:",r),console.log("User ID:",r==null?void 0:r._id),console.log("User email:",r==null?void 0:r.email),console.log("All user fields:",Object.keys(r||{})),console.log("Environment VITE_BACKEND_URL:",{}.VITE_BACKEND_URL);const P=r==null?void 0:r.email;if(!P){console.error("No valid user email found"),alert("Error: No valid user email found. Please refresh the page and try again.");return}console.log("Using user email:",P),console.log("Using Supabase for profile update");let D={};E==="basic"?D={firstName:l.firstName,lastName:l.lastName,phone:l.phone}:E==="locations"?D={locations:l.locations}:E==="availability"&&(D={availability:l.availability}),console.log("Sending Supabase profile update:",D);const T=await mt.updateUserProfile(P,D);if(!T.success)throw new Error(T.error||"Failed to update profile");console.log("Supabase profile update successful:",T);try{const A=await mt.getUserProfileData(P);if(A.success){const k=A.data;console.log("Refreshed profile data:",k),u(R=>({...R,firstName:k.profile.firstName,lastName:k.profile.lastName,phone:k.profile.phone,locations:k.profile.locations||"",availability:k.profile.availability||{}})),a&&a()}}catch(A){console.error("Error refreshing profile data:",A)}i(null),c({}),alert(" Profile updated successfully!")}catch(P){console.error("Error updating profile:",P),alert("Error updating profile. Please try again.")}},_=(E,P)=>{c(D=>({...D,[E]:P}))},C=async E=>{try{console.log(" Starting location save process..."),console.log(" New locations string:",E),u(T=>{const A={...T,locations:E};return console.log(" Updated localUser immediately:",A),A}),w(T=>T+1),console.log(" Triggered refresh for immediate update");const P=r==null?void 0:r.email;if(!P){console.error("No valid user email found"),alert("Error: No valid user email found. Please refresh the page and try again.");return}const D=await mt.updateUserProfile(P,{locations:E});if(!D.success)throw new Error(D.error||"Failed to update locations");console.log(" Locations updated successfully in Supabase"),i(null),w(T=>T+1),console.log(" Final refresh triggered after backend save"),a&&a()}catch(P){console.error("Error saving locations:",P),alert("Error saving locations. Please try again.")}},N=()=>{try{const E=d.locations||"";if(console.log(" getUserLocations called with refreshTrigger:",b),console.log(" Current locations data:",E),console.log(" localUser.locations:",d.locations),!E)return[];if(typeof E=="string")if(E.includes(`
`)){const P=E.split(`
`).filter(Boolean).map(D=>String(D).trim());return console.log(" Parsed newline locations:",P),P}else if(E.includes(",")){const P=E.split(",").map(D=>String(D).trim()).filter(Boolean);return console.log(" Parsed comma locations:",P),P}else{const P=E.trim()?[String(E).trim()]:[];return console.log(" Parsed single location:",P),P}if(Array.isArray(E)){const P=E.map(D=>String(D).trim()).filter(Boolean);return console.log(" Parsed array locations:",P),P}return console.log(" No valid locations found, returning empty array"),[]}catch(E){return console.error(" Error in getUserLocations:",E),[]}};if(!n||!d)return null;const M=d.divisions||[];return console.log(" Modal rendering with localUser:",d),console.log(" Current locations:",d.locations),console.log(" Current availability:",d.availability),console.log(" Current phone:",d.phone),xr.createPortal(e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)",padding:s?"10px":"20px"},onClick:t,children:[e.jsxs("div",{style:{transform:"translate(0px, 0px)",cursor:"default",background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:s?"0":"1rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:s?"95vw":"auto",maxWidth:s?"95vw":"750px",minWidth:s?"auto":"500px",margin:s?"0":"0 auto",left:0,right:0,animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,position:"relative",fontFamily:"inherit",boxSizing:"border-box",textAlign:"center",height:s?"85vh":"88vh",maxHeight:s?"85vh":"88vh",display:"flex",flexDirection:"column",overflow:"hidden"},onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#e53e3e",padding:"0.8rem 1rem 0.6rem 1rem",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",position:"relative",cursor:"grab",userSelect:"none",gap:"0.8rem",flexShrink:0},children:[e.jsx("span",{style:{position:"absolute",left:0,top:0,width:"100%",height:"4px",background:"linear-gradient(90deg, #fff0 0%, #e53e3e 60%, #fff0 100%)",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",pointerEvents:"none"}}),e.jsx("h2",{style:{margin:0,fontSize:s?"0.9rem":"1rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",color:"#fff",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0},children:" Profile Information"}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#fff",fontSize:"1.5rem",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"background-color 0.2s",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",minWidth:"24px",zIndex:3},onMouseEnter:E=>E.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",onMouseLeave:E=>E.target.style.backgroundColor="transparent",children:""})]}),e.jsxs("div",{style:{padding:s?"0.8rem":"1rem",overflowY:"auto",flex:1,minHeight:0},children:[e.jsxs("div",{style:{display:"grid",gap:s?"8px":"10px"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffffff",fontSize:s?"0.9rem":"1rem"},children:" Basic Information"}),o!=="basic"&&e.jsx("button",{onClick:()=>x("basic",{firstName:d.firstName||"",lastName:d.lastName||"",phone:d.phone||""}),style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.4)",color:"#4CAF50",padding:"4px 8px",borderRadius:"4px",fontSize:s?"0.7rem":"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:E=>E.target.style.background="rgba(76, 175, 80, 0.3)",onMouseLeave:E=>E.target.style.background="rgba(76, 175, 80, 0.2)",children:" Edit"})]}),o==="basic"?e.jsxs("div",{style:{display:"grid",gap:"8px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[e.jsx("input",{type:"text",value:l.firstName||"",onChange:E=>_("firstName",E.target.value),placeholder:"First Name",style:{padding:"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.3)",color:"#ffffff",fontSize:"0.9rem"}}),e.jsx("input",{type:"text",value:l.lastName||"",onChange:E=>_("lastName",E.target.value),placeholder:"Last Name",style:{padding:"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.3)",color:"#ffffff",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{padding:"8px",color:"#aaa",fontSize:"0.85rem"},children:[e.jsx("strong",{children:"Email:"})," ",d.email,e.jsx("span",{style:{display:"block",marginTop:"4px",fontSize:"0.8rem"},children:"To change your email/password login email, use Login & Security below."})]}),e.jsx("input",{type:"tel",value:l.phone||"",onChange:E=>_("phone",E.target.value),placeholder:"Phone",style:{padding:"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.3)",color:"#ffffff",fontSize:"0.9rem"}}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>S("basic"),style:{background:"#4CAF50",color:"#fff",border:"none",padding:"6px 12px",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:" Save"}),e.jsx("button",{onClick:j,style:{background:"#6c757d",color:"#fff",border:"none",padding:"6px 12px",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:" Cancel"})]})]}):e.jsxs("div",{style:{color:"#cccccc",lineHeight:"1.4",fontSize:s?"0.85rem":"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",d.firstName," ",d.lastName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",d.email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Phone:"})," ",d.phone||"Not provided"]})]})]}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsx("button",{onClick:()=>v(!0),style:{width:"100%",background:"linear-gradient(135deg, #667eea, #764ba2)",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",fontSize:s?"0.9rem":"1rem",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:" Login & Security"})}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffffff",marginBottom:"4px",fontSize:s?"0.9rem":"1rem"},children:" League & Ladder Status"}),e.jsxs("div",{style:{display:"flex",gap:"16px",flexDirection:s?"column":"row"},children:[e.jsxs("div",{style:{flex:1,minWidth:s?"auto":"200px"},children:[e.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",fontSize:s?"0.8rem":"0.9rem",marginBottom:"2px"},children:" League Divisions:"}),e.jsx("div",{style:{color:"#cccccc",lineHeight:"1.5",fontSize:s?"0.8rem":"0.9rem",paddingLeft:"8px"},children:M.length>0?M.join(", "):"No divisions assigned"})]}),e.jsxs("div",{style:{flex:1,minWidth:s?"auto":"200px"},children:[e.jsx("div",{style:{color:"#FF9800",fontWeight:"bold",fontSize:s?"0.8rem":"0.9rem",marginBottom:"2px"},children:" Ladder Status:"}),e.jsx("div",{style:{color:"#cccccc",lineHeight:"1.5",fontSize:s?"0.8rem":"0.9rem",paddingLeft:"8px"},children:d.ladderInfo?e.jsxs("div",{children:[e.jsxs("div",{children:[" Ladder: ",d.ladderInfo.ladderName]}),e.jsxs("div",{children:[" Position: ",d.ladderInfo.position]})]}):"Not on any ladder"})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffffff",fontSize:s?"0.9rem":"1rem"},children:" Availability"}),o!=="availability"&&e.jsx("button",{onClick:()=>x("availability",{availability:d.availability||{}}),style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.4)",color:"#4CAF50",padding:"4px 8px",borderRadius:"4px",fontSize:s?"0.7rem":"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:E=>E.target.style.background="rgba(76, 175, 80, 0.3)",onMouseLeave:E=>E.target.style.background="rgba(76, 175, 80, 0.2)",children:" Edit"})]}),o==="availability"?e.jsxs("div",{style:{display:"grid",gap:"6px"},children:[e.jsx("div",{style:{color:"#ffc107",fontSize:"0.85rem",fontWeight:"bold",marginBottom:"4px"},children:"Quick Time Slot Editor:"}),e.jsxs("div",{style:{padding:"4px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"3px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:[e.jsx("div",{style:{color:"#4CAF50",fontSize:"0.8rem",fontWeight:"bold",marginBottom:"3px"},children:" Quick Add:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:"3px",alignItems:"end"},children:[e.jsxs("select",{id:"quick-day",style:{padding:"3px 4px",borderRadius:"3px",border:"1px solid rgba(255, 255, 255, 0.15)",background:"rgba(0, 0, 0, 0.4)",color:"#ffffff",fontSize:"0.8rem",minHeight:"24px"},children:[e.jsx("option",{value:"",children:"Day"}),e.jsx("option",{value:"Mon",children:"Mon"}),e.jsx("option",{value:"Tue",children:"Tue"}),e.jsx("option",{value:"Wed",children:"Wed"}),e.jsx("option",{value:"Thu",children:"Thu"}),e.jsx("option",{value:"Fri",children:"Fri"}),e.jsx("option",{value:"Sat",children:"Sat"}),e.jsx("option",{value:"Sun",children:"Sun"})]}),e.jsx("input",{type:"time",id:"quick-start",style:{padding:"3px 4px",borderRadius:"3px",border:"1px solid rgba(255, 255, 255, 0.15)",background:"rgba(0, 0, 0, 0.4)",color:"#ffffff",fontSize:"0.8rem",minHeight:"24px"}}),e.jsx("input",{type:"time",id:"quick-end",style:{padding:"3px 4px",borderRadius:"3px",border:"1px solid rgba(255, 255, 255, 0.15)",background:"rgba(0, 0, 0, 0.4)",color:"#ffffff",fontSize:"0.8rem",minHeight:"24px"}}),e.jsx("button",{type:"button",onClick:()=>{var W,Y;const E=document.getElementById("quick-day"),P=document.getElementById("quick-start"),D=document.getElementById("quick-end"),T=E.value,A=P.value,k=D.value;if(!T||!A||!k){alert("Please select day, start, and end times.");return}if(A>=k){alert("End time must be after start time.");return}const R=Q=>{const[H,ue]=Q.split(":"),J=parseInt(H),be=J>=12?"PM":"AM";return`${J%12||12}:${ue} ${be}`},U=`${R(A)} - ${R(k)}`,z=((W=l.availability)==null?void 0:W[T])||((Y=d.availability)==null?void 0:Y[T])||[];if(z.includes(U)){alert("This time slot already exists.");return}const $=[...z,U];c(Q=>({...Q,availability:{...Q.availability,[T]:$}})),E.value="",P.value="",D.value=""},style:{background:"rgba(76, 175, 80, 0.3)",border:"1px solid rgba(76, 175, 80, 0.5)",color:"#4CAF50",padding:"3px 6px",borderRadius:"3px",fontSize:"0.75rem",cursor:"pointer",fontWeight:"bold",minHeight:"24px"},children:"Add"})]})]}),e.jsxs("div",{style:{padding:"4px",background:"rgba(255, 255, 255, 0.02)",borderRadius:"3px",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[e.jsx("div",{style:{color:"#4CAF50",fontSize:"0.8rem",fontWeight:"bold",marginBottom:"3px"},children:" Current Slots:"}),e.jsx("div",{style:{display:"grid",gap:"2px",maxHeight:"120px",overflowY:"auto"},children:Object.entries(l.availability||d.availability||{}).map(([E,P])=>P&&P.length>0?P.map((D,T)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"2px 4px",background:"rgba(76, 175, 80, 0.08)",borderRadius:"2px",border:"1px solid rgba(76, 175, 80, 0.2)"},children:[e.jsxs("span",{style:{color:"#4CAF50",fontSize:"0.75rem",fontWeight:"500"},children:[e.jsxs("strong",{children:[E,":"]})," ",D]}),e.jsx("button",{type:"button",onClick:()=>{const A=P.filter((k,R)=>R!==T);c(k=>({...k,availability:{...k.availability,[E]:A}}))},style:{background:"rgba(220, 53, 69, 0.2)",border:"1px solid rgba(220, 53, 69, 0.3)",color:"#dc3545",padding:"2px 4px",borderRadius:"2px",fontSize:"0.7rem",cursor:"pointer",fontWeight:"bold"},children:""})]},`${E}-${T}`)):null).flat().filter(Boolean)})]}),e.jsxs("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>S("availability"),style:{background:"#4CAF50",color:"#fff",border:"none",padding:"4px 8px",borderRadius:"3px",fontSize:"0.7rem",cursor:"pointer"},children:" Save"}),e.jsx("button",{onClick:j,style:{background:"#6c757d",color:"#fff",border:"none",padding:"4px 8px",borderRadius:"3px",fontSize:"0.7rem",cursor:"pointer"},children:" Cancel"})]})]}):e.jsx("div",{style:{color:"#cccccc",lineHeight:"1.4",fontSize:s?"0.85rem":"0.9rem"},children:d.availability&&Object.keys(d.availability).length>0?(()=>{const E=Object.entries(d.availability).filter(([D,T])=>T&&T.length>0);if(E.length===0)return"No availability set";const P={Mon:"Mon",Tue:"Tue",Wed:"Wed",Thu:"Thu",Fri:"Fri",Sat:"Sat",Sun:"Sun"};return e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"repeat(2, 1fr)",gap:"6px"},children:E.map(([D,T])=>e.jsxs("div",{style:{padding:"4px 6px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.1)",fontSize:"0.85rem"},children:[e.jsxs("span",{style:{fontWeight:"bold",color:"#ffc107"},children:[P[D],":"]})," ",T.join(", ")]},D))})})():"No availability set"})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffffff",fontSize:s?"0.9rem":"1rem"},children:" Preferred Locations"}),o!=="locations"&&e.jsx("button",{onClick:()=>f(!0),style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.4)",color:"#4CAF50",padding:"4px 8px",borderRadius:"4px",fontSize:s?"0.7rem":"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:E=>E.target.style.background="rgba(76, 175, 80, 0.3)",onMouseLeave:E=>E.target.style.background="rgba(76, 175, 80, 0.2)",children:" Edit"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"repeat(2, 1fr)":"repeat(3, 1fr)",gap:"6px"},children:(()=>{try{const E=N();return!E||E.length===0?e.jsx("span",{style:{color:"#888",fontSize:"0.8rem",fontStyle:"italic",gridColumn:"1 / -1",textAlign:"center",padding:"10px"},children:"No locations selected"}):E.map((P,D)=>e.jsxs("span",{style:{background:"rgba(255, 255, 255, 0.1)",color:"#ffffff",padding:"5px 8px",borderRadius:"8px",fontSize:s?"0.75rem":"0.8rem",display:"flex",justifyContent:"center",alignItems:"center",gap:"3px",width:"100%",minHeight:"24px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:String(P),children:[" ",String(P)]},`${P}-${D}-${b}`))}catch(E){return console.error(" Error rendering locations display:",E),e.jsx("span",{style:{color:"#ff6b6b",fontSize:"0.8rem",fontStyle:"italic",gridColumn:"1 / -1",textAlign:"center",padding:"10px"},children:"Error loading locations"})}})()},b)]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:s?"6px":"8px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffffff",marginBottom:"4px",fontSize:s?"0.9rem":"1rem"},children:" Notification Preferences"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0"},children:[e.jsxs("div",{style:{color:"#cccccc",fontSize:s?"0.85rem":"0.9rem",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{children:" Browser Notifications:"}),e.jsx("span",{style:{color:ls.isNotificationEnabled()?"#4CAF50":"#f44336",fontWeight:"bold"},children:ls.isNotificationEnabled()?"Enabled":"Disabled"})]}),e.jsx("div",{style:{display:"flex",gap:"6px"},children:ls.isNotificationEnabled()?e.jsx("button",{onClick:async()=>{ls.disableNotifications(),w(E=>E+1)},style:{background:"rgba(244, 67, 54, 0.2)",border:"1px solid rgba(244, 67, 54, 0.4)",color:"#f44336",padding:"4px 8px",borderRadius:"4px",fontSize:s?"0.7rem":"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:E=>E.target.style.background="rgba(244, 67, 54, 0.3)",onMouseLeave:E=>E.target.style.background="rgba(244, 67, 54, 0.2)",children:" Disable"}):e.jsx("button",{onClick:async()=>{await ls.enableNotifications()&&w(P=>P+1)},style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.4)",color:"#4CAF50",padding:"4px 8px",borderRadius:"4px",fontSize:s?"0.7rem":"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:E=>E.target.style.background="rgba(76, 175, 80, 0.3)",onMouseLeave:E=>E.target.style.background="rgba(76, 175, 80, 0.2)",children:" Enable"})})]}),e.jsx("div",{style:{color:"#9ca3af",fontSize:s?"0.75rem":"0.8rem",fontStyle:"italic",marginTop:"4px"},children:ls.getStatus().permission==="denied"?" Notifications are blocked by your browser. Check your browser settings to enable them.":ls.getStatus().permission==="default"?' Click "Enable" to allow browser notifications for match updates and challenges.':" You'll receive instant alerts for challenges, match updates, and ladder changes."})]})]}),e.jsx("div",{style:{marginTop:"20px",textAlign:"center"},children:e.jsx("button",{style:{background:"linear-gradient(135deg, #6c757d, #5a6268)",color:"#fff",border:"none",borderRadius:"8px",padding:s?"10px 20px":"12px 24px",fontSize:s?"0.9rem":"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)",minWidth:s?"100px":"120px"},onMouseEnter:E=>{E.target.style.background="linear-gradient(135deg, #5a6268, #495057)",E.target.style.transform="translateY(-1px)",E.target.style.boxShadow="0 4px 12px rgba(108, 117, 125, 0.4)"},onMouseLeave:E=>{E.target.style.background="linear-gradient(135deg, #6c757d, #5a6268)",E.target.style.transform="translateY(0)",E.target.style.boxShadow="0 2px 8px rgba(108, 117, 125, 0.3)"},onClick:t,children:" Close"})})]})]}),e.jsx(UH,{isOpen:g,onClose:()=>f(!1),currentLocations:d.locations||"",availableLocations:h,onSave:C}),e.jsx(HH,{isOpen:m,onClose:()=>v(!1),userEmail:d.email,onUserUpdate:a})]}),document.body)},qC=({showEditProposalModal:n,showChatModal:t,showCompletedModal:r,winnerModalOpen:s,validationModalOpen:a,showSmartMatchmakingModal:o,showUserProfileModal:i,showPhase1Rules:l,showPhase1Overview:c,showRegistrationModal:d,showPendingRegistrationsModal:u,showCalendarModal:h,selectedProposal:p,chatType:g,opponentEmails:f,completedMatches:m,winnerModalPlayers:v,winnerModalMatch:b,matchToValidate:w,selectedOpponentForSmartMatch:x,pendingRegistrations:j,onCloseEditProposalModal:S,onCloseChatModal:_,onCloseCompletedModal:C,onCloseWinnerModal:N,onCloseValidationModal:M,onCloseSmartMatchmakingModal:E,onCloseUserProfileModal:P,onClosePhase1Rules:D,onClosePhase1Overview:T,onCloseRegistrationModal:A,onClosePendingRegistrationsModal:k,onCloseCalendarModal:R,onSaveEditProposal:U,onProposalUpdated:z,onSelectWinner:$,onValidateMatch:W,onRejectMatch:Y,onSmartMatchProposalComplete:Q,onUserUpdate:H,onRegistrationSuccess:ue,onApproveRegistration:J,onRejectRegistration:be,onOpenOpponentsModal:Ae,onMatchClick:O,onSmartMatchClick:oe,selectedDivision:me,effectivePhase:Ce,userPin:ve,playerName:De,playerLastName:Oe,senderEmail:Ze,isMobile:et,currentUser:re,players:je,filteredUpcomingMatches:V,phase1EndDate:Ee,playerStats:F,standings:ae,timeLeft:I,deadlineStatus:X,allPlayers:fe,styles:ne,proposalService:ye,seasonService:ot,seasonData:lt,currentPhaseInfo:tt,BACKEND_URL:ge,markMatchCompleted:xt,setCompletingMatchId:ht,updateCompletedMatch:Je,refetchMatches:Pe,refetchProposals:Ve,setPendingRegistrations:we})=>e.jsxs(e.Fragment,{children:[p&&n&&e.jsx(yW,{proposal:p,open:n,onClose:S,onSave:U,selectedDivision:me,phase:Ce,receiverPlayer:je.find(Re=>{var it,rt;return`${Re.firstName} ${Re.lastName}`.trim().toLowerCase()===(p.receiverName||"").trim().toLowerCase()||((it=Re.email)==null?void 0:it.toLowerCase())===((rt=p.receiverEmail)==null?void 0:rt.toLowerCase())})}),t&&e.jsx("div",{className:ne.modalOverlay,style:{zIndex:99999},children:e.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"95vw",height:"95vh",maxWidth:"1400px",maxHeight:"900px",background:"#181818",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid #333",background:"#222",borderRadius:"12px 12px 0 0"},children:[e.jsx("h2",{style:{margin:0,color:"#ffffff",fontSize:"1.2em"},children:g==="league"?"League Chat":"Direct Messages"}),e.jsx("button",{onClick:_,style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"background-color 0.2s"},onMouseOver:Re=>Re.target.style.background="#444",onMouseOut:Re=>Re.target.style.background="none",type:"button",children:""})]}),e.jsx("div",{style:{flex:1,overflow:"hidden",position:"relative"},children:g==="league"?e.jsx(SC,{userName:`${De} ${Oe}`,userEmail:Ze,userPin:ve,onClose:_}):e.jsx(dU,{userName:`${De} ${Oe}`,userEmail:Ze,userPin:ve,selectedDivision:me,opponentEmails:f,onClose:_})})]})}),r&&e.jsx("div",{className:ne.modalOverlay,children:e.jsxs("div",{className:ne.modalContent,style:{maxWidth:800,margin:"auto"},children:[e.jsx("h2",{children:"Completed Matches"}),e.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:m.length===0?e.jsx("p",{children:"No completed matches yet."}):e.jsx("div",{style:{display:"grid",gap:"10px"},children:m.map((Re,it)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",padding:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:Re.senderName})," vs ",e.jsx("strong",{children:Re.receiverName})]}),e.jsxs("div",{style:{color:"#4CAF50"},children:["Winner: ",e.jsx("strong",{children:Re.winner})]})]}),Re.notes&&e.jsxs("p",{style:{margin:"5px 0 0 0",color:"#ccc",fontSize:"0.9em"},children:["Notes: ",Re.notes]})]},Re._id||it))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:15},children:e.jsx("button",{className:ne.dashboardBtn,onClick:C,type:"button",children:"Close"})})]})}),e.jsx(Nb,{open:s,onClose:N,player1:v.player1,player2:v.player2,onSelect:$}),e.jsx(sH,{isOpen:a,onClose:M,match:w,onValidate:W,onReject:Y}),e.jsx(iH,{isOpen:o,onClose:E,player1:re,player2:x,upcomingMatches:V,isMobile:et,selectedDivision:me,phase:Ce,senderName:`${De} ${Oe}`,senderEmail:Ze,onProposalComplete:Q}),e.jsx(UC,{isOpen:i,onClose:P,currentUser:re,isMobile:et,onUserUpdate:H,availableLocations:["Legends Brews & Cues","Antiques","Rac m","Westside Billiards","Bijou Billiards","Crooked Cue","Back on the Boulevard","Main Street Tavern","Murray Street Darts","My House"]}),e.jsx(CC,{isOpen:l,onClose:D,isMobile:et}),e.jsx(oH,{isOpen:c,onClose:T,isMobile:et,playerName:De,playerLastName:Oe,completedMatches:m,totalRequiredMatches:0,playerStats:F,standings:ae,timeLeft:I,deadlineStatus:X,phase1EndDate:Ee,allPlayers:fe,selectedDivision:me}),e.jsx(lH,{isOpen:d,onClose:A,onSuccess:ue,isMobile:et,isAdmin:!0}),u&&e.jsx("div",{className:ne.modalOverlay,style:{zIndex:99999},children:e.jsxs("div",{className:ne.modalContent,style:{maxWidth:800,margin:"auto"},children:[e.jsx("h2",{children:"Pending Registrations"}),e.jsx("div",{style:{padding:"20px",maxHeight:"70vh",overflowY:"auto"},children:j.length===0?e.jsxs("div",{style:{textAlign:"center",color:"#ccc",padding:"40px"},children:[e.jsx("h3",{children:"No Pending Registrations"}),e.jsx("p",{children:"All registrations have been processed."})]}):e.jsx("div",{style:{display:"grid",gap:"15px"},children:j.sort((Re,it)=>new Date(Re.registrationDate)-new Date(it.registrationDate)).map((Re,it)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",padding:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"5px"},children:[e.jsxs("span",{style:{background:"#e53e3e",color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",minWidth:"20px",textAlign:"center"},children:["#",it+1]}),e.jsxs("h4",{style:{color:"#e53e3e",margin:"0"},children:[Re.firstName," ",Re.lastName]})]}),e.jsxs("p",{style:{color:"#ccc",margin:"0 0 5px 0"},children:[Re.email,"  ",Re.phone]}),e.jsxs("p",{style:{color:"#999",margin:"0 0 5px 0",fontSize:"12px"},children:["Registered: ",new Date(Re.registrationDate).toLocaleDateString()]}),e.jsxs("p",{style:{color:"#999",margin:"0",fontSize:"12px"},children:["Division: ",Re.division||"Not assigned"]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",flexDirection:"column",alignItems:"flex-end"},children:[e.jsxs("div",{style:{marginBottom:"10px",textAlign:"right"},children:[e.jsx("label",{style:{color:"#ccc",fontSize:"12px",display:"block",marginBottom:"2px"},children:"Assign Division:"}),e.jsxs("select",{id:`division-${Re._id}`,defaultValue:Re.division||"",style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"12px",minWidth:"120px"},children:[e.jsx("option",{value:"",children:"Select Division"}),e.jsx("option",{value:"FRBCAPL TEST",children:"FRBCAPL TEST"}),e.jsx("option",{value:"Singles Test",children:"Singles Test"}),e.jsx("option",{value:"Waiting List",children:"Waiting List"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>J(Re),style:{background:"#4CAF50",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Approve"}),e.jsx("button",{onClick:()=>be(Re),style:{background:"#f44336",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Reject"})]})]})]}),e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("h5",{style:{color:"#e53e3e",margin:"0 0 5px 0",fontSize:"14px"},children:"Availability:"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"5px",fontSize:"12px"},children:Object.entries(Re.availability).map(([rt,yt])=>e.jsxs("div",{style:{color:"#ccc"},children:[e.jsxs("strong",{children:[rt,":"]})," ",yt.length>0?yt.join(", "):"None"]},rt))})]}),e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("h5",{style:{color:"#e53e3e",margin:"0 0 5px 0",fontSize:"14px"},children:"Locations:"}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"12px"},children:Re.locations})]})]},Re._id))})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:15},children:e.jsx("button",{className:ne.dashboardBtn,onClick:k,type:"button",children:"Close"})})]})}),e.jsx(nH,{isOpen:h,onClose:R,isMobile:et,phase1EndDate:Ee,upcomingMatches:V,playerName:De,playerLastName:Oe,onOpenOpponentsModal:Ae,onMatchClick:O,onSmartMatchClick:oe})]});qC.propTypes={showEditProposalModal:ee.bool,showChatModal:ee.bool,showCompletedModal:ee.bool,winnerModalOpen:ee.bool,validationModalOpen:ee.bool,showSmartMatchmakingModal:ee.bool,showUserProfileModal:ee.bool,showPhase1Rules:ee.bool,showPhase1Overview:ee.bool,showRegistrationModal:ee.bool,showPendingRegistrationsModal:ee.bool,showCalendarModal:ee.bool,selectedProposal:ee.object,chatType:ee.string,opponentEmails:ee.array,completedMatches:ee.array,winnerModalPlayers:ee.object,winnerModalMatch:ee.object,matchToValidate:ee.object,selectedOpponentForSmartMatch:ee.object,pendingRegistrations:ee.array,onCloseEditProposalModal:ee.func.isRequired,onCloseChatModal:ee.func.isRequired,onCloseCompletedModal:ee.func.isRequired,onCloseWinnerModal:ee.func.isRequired,onCloseValidationModal:ee.func.isRequired,onCloseSmartMatchmakingModal:ee.func.isRequired,onCloseUserProfileModal:ee.func.isRequired,onClosePhase1Rules:ee.func.isRequired,onClosePhase1Overview:ee.func.isRequired,onCloseRegistrationModal:ee.func.isRequired,onClosePendingRegistrationsModal:ee.func.isRequired,onCloseCalendarModal:ee.func.isRequired,onSaveEditProposal:ee.func.isRequired,onProposalUpdated:ee.func.isRequired,onSelectWinner:ee.func.isRequired,onValidateMatch:ee.func.isRequired,onRejectMatch:ee.func.isRequired,onSmartMatchProposalComplete:ee.func.isRequired,onUserUpdate:ee.func.isRequired,onRegistrationSuccess:ee.func.isRequired,onApproveRegistration:ee.func.isRequired,onRejectRegistration:ee.func.isRequired,onOpenOpponentsModal:ee.func.isRequired,onMatchClick:ee.func.isRequired,onSmartMatchClick:ee.func.isRequired,selectedDivision:ee.string.isRequired,effectivePhase:ee.string.isRequired,userPin:ee.string,playerName:ee.string.isRequired,playerLastName:ee.string.isRequired,senderEmail:ee.string.isRequired,isMobile:ee.bool.isRequired,currentUser:ee.object,players:ee.array,filteredUpcomingMatches:ee.array,phase1EndDate:ee.string,playerStats:ee.object,standings:ee.array,timeLeft:ee.string,deadlineStatus:ee.string,allPlayers:ee.array,styles:ee.object.isRequired,proposalService:ee.object.isRequired,seasonService:ee.object.isRequired,seasonData:ee.object,currentPhaseInfo:ee.object,BACKEND_URL:ee.string.isRequired,markMatchCompleted:ee.func.isRequired,setCompletingMatchId:ee.func.isRequired,updateCompletedMatch:ee.func.isRequired,refetchMatches:ee.func.isRequired,refetchProposals:ee.func.isRequired,setPendingRegistrations:ee.func.isRequired};function Zj(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-");return`${i}-${l}-${o}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}function HC({playerName:n,playerLastName:t,onOpenChat:r,userPin:s,onGoToAdmin:a,onScheduleMatch:o,senderEmail:i,onGoToPlatformAdmin:l,isAdmin:c}){const[d,u]=y.useState([]),[h,p]=y.useState(""),[g,f]=y.useState(!1),[m,v]=y.useState(!1),[b,w]=y.useState(!1),[x,j]=y.useState(null),[S,_]=y.useState(""),[C,N]=y.useState(!1),[M,E]=y.useState(!1),[P,D]=y.useState(null),[T,A]=y.useState(!1),[k,R]=y.useState(""),[U,z]=y.useState(""),[$,W]=y.useState(null),[Y,Q]=y.useState(!1);y.useState(!1);const[H,ue]=y.useState(!1),[J,be]=y.useState("scheduled"),[Ae,O]=y.useState(!1),[oe,me]=y.useState(null),[Ce,ve]=y.useState(!1),[De,Oe]=y.useState(!1),[Ze,et]=y.useState(null),[re,je]=y.useState(!1),[V,Ee]=y.useState(null),[F,ae]=y.useState(!1),[I,X]=y.useState(null),[fe,ne]=y.useState([]),[ye,ot]=y.useState(!1),[lt,tt]=y.useState(0),[ge,xt]=y.useState(0),[ht,Je]=y.useState(0),Pe=`${n} ${t}`.trim(),{pendingProposals:Ve,sentProposals:we,loading:Re,lastUpdate:it,refetch:rt,updateProposalLocally:yt}=bC(Pe,h),kt=Ze||J,{matches:Ct,completedMatches:te,scheduledConfirmedMatches:ke,loading:We,lastUpdate:Fe,refetch:st,updateMatchLocally:Ft,markMatchCompleted:Le,updateCompletedMatch:Z}=IH(Pe,h,kt),Ye=()=>{const ce=["frbcapl@gmail.com","sslampro@gmail.com"],ut={}.VITE_SUPER_ADMIN_PIN||"777777";return ce.includes(i.toLowerCase())&&s===ut},{seasonData:dt,currentPhaseInfo:pt,loading:Tt,error:Wt,lastUpdate:ir,refetch:rr}=DH(h),{standings:Pr,loading:Fn,error:hs,lastUpdate:cn,refetch:Ja}=$H(h),{notes:Dr,loading:Jr,error:An,lastUpdate:ua,refetch:ha,updateNoteLocally:zr}=LH(),{scheduledMatches:Js,loading:Xs,error:Pa,lastUpdate:Gi,refetch:ec}=BH(h),[ps,Ea]=y.useState(0),[Xa,Vi]=y.useState(0),[_o,ks]=y.useState(!1),[Ra,Qa]=y.useState(!1),[Se,G]=y.useState(""),[He,Xe]=y.useState("all"),[nt,At]=y.useState("date"),[vt,Nt]=y.useState(null);y.useState(!1);const[tr,qt]=y.useState("direct"),[or,Ht]=y.useState(0),[Rt,Ue]=y.useState(!1),[ft,wt]=y.useState(null),[Lt,yr]=y.useState({player1:"",player2:""}),[Sr,Bs]=y.useState(!1),[Za,jr]=y.useState(null),[Dt,Ar]=y.useState(!1),[$r,dn]=y.useState(!1),[rs,un]=y.useState(!1),[Wn,tn]=y.useState([]),[ns,le]=y.useState(!1),[_e,Me]=y.useState(!1),[he,Be]=y.useState(!1),[ct,$t]=y.useState(!1),[qe,jt]=y.useState(!1),[Bt,Ot]=y.useState(null),[dr,ur]=y.useState(null),[bn,Un]=y.useState("normal"),[ms,fs]=y.useState(null),Cn=y.useRef(null);yn();const{isMobile:Ur,mobileUtils:Cs,swipeUtils:Ns,pullToRefreshUtils:Ts}=DC();y.useEffect(()=>{(async()=>{try{const ut=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);console.log("Device Info:",{userAgent:navigator.userAgent,isMobile:ut,backendUrl:Ie,protocol:window.location.protocol,hostname:window.location.hostname}),console.log("Testing backend connection...");const _t=await fetch(`${Ie}/health`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",credentials:"include"});_t.ok?console.log(" Backend connection successful"):console.error(" Backend connection failed:",_t.status,_t.statusText)}catch(ut){console.error(" Backend connection error:",ut),console.error("Error details:",{name:ut.name,message:ut.message,stack:ut.stack})}})()},[]),y.useEffect(()=>{Ea(Ve.length)},[Ve]),y.useEffect(()=>{Vi(we.length)},[we]),y.useEffect(()=>{async function ce(){try{const _t=await(await fetch(`${Ie}/api/messages/unread?user=${encodeURIComponent(i)}`)).json();Array.isArray(_t)&&Ht(_t.length)}catch(ut){console.error("Failed to fetch unread messages:",ut)}}if(i){ce();const ut=setInterval(ce,3e4);return()=>clearInterval(ut)}},[i]),y.useEffect(()=>{if(!n||!t||!h||We||Re)return;const ce=kt==="challenge"?2:1,_t=Js.filter(Nn=>Nn.division===h&&Nn.phase===ce&&(Nn.player1&&Nn.player1.trim().toLowerCase()===Pe.toLowerCase()||Nn.player2&&Nn.player2.trim().toLowerCase()===Pe.toLowerCase())).length;xt(te.length);const kr=Ct.filter(Nn=>Nn.status==="confirmed"&&(Nn.completed===!1||Nn.completed===void 0)).length+te.length,mr=Math.max(0,_t-kr);tt(mr),Je(_t)},[n,t,h,Js,te,Ct,We,Re]);const eo=(()=>{if(!n||!t||!h)return 0;const ut=Js.filter(_t=>_t.division===h&&(_t.player1&&_t.player1.trim().toLowerCase()===Pe.toLowerCase()||_t.player2&&_t.player2.trim().toLowerCase()===Pe.toLowerCase())).length;return ut===0&&kt==="scheduled"?(console.log("No schedule matches found, using fallback of 6 matches for Phase 1"),6):ut})();y.useEffect(()=>{let ce=!0;async function ut(){try{const _t=await fetch(`${Ie}/api/users/search?approved=true`);if(!_t.ok)throw new Error("Failed to fetch players from database");const pr=await _t.json();if(!pr.users||pr.users.length===0){ce&&ne([]);return}const kr=pr.users.map(mr=>({firstName:mr.firstName||"",lastName:mr.lastName||"",email:mr.email||"",phone:mr.phone||"",locations:mr.locations||"",availability:mr.availability||{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]},pin:mr.pin||"",preferredContacts:mr.preferredContacts||[],division:mr.division||"",divisions:mr.divisions||[]})).filter(mr=>mr.email&&mr.firstName&&mr.lastName);if(ce){ne(kr),Xb(kr);const mr=kr.find(Nn=>Nn.firstName===n&&Nn.lastName===t);mr&&tc(mr)}}catch(_t){console.error("Error loading players:",_t),ce&&(ne([]),Xb([]),tc(null))}}return ut(),()=>{ce=!1}},[]),y.useEffect(()=>{i&&jC.getUser(i).then(ce=>{let ut=[];Array.isArray(ce.divisions)?ut=ce.divisions.map(_t=>_t.trim()).filter(Boolean):typeof ce.divisions=="string"?ut=ce.divisions.split(",").map(_t=>_t.trim()).filter(Boolean):ce.division&&typeof ce.division=="string"&&(ut=ce.division.split(",").map(_t=>_t.trim()).filter(Boolean)),u(ut)}).catch(()=>{u([])})},[i]),y.useEffect(()=>{d.length>0?p(d[0]):p("")},[d]),y.useEffect(()=>{if(!i)return;(async()=>{try{const ut=await fetch(`${Ie}/api/unified-auth/profile-data?email=${encodeURIComponent(i)}&appType=league&t=${Date.now()}`);if(ut.ok){const _t=await ut.json();console.log("Loaded league profile data:",_t),_t.success&&_t.profile&&tc(pr=>({...pr,locations:_t.profile.locations||"",availability:_t.profile.availability||{}}))}}catch(ut){console.error("Error loading profile data:",ut)}})()},[i]);const to=async()=>{z("");try{const ce=await Lp.createNote(k.trim());zr(ce,"add"),R(""),A(!1)}catch{z("Failed to add note")}},Zo=async ce=>{if(window.confirm("Delete this note?"))try{await Lp.deleteNote(ce),zr({_id:ce},"remove")}catch(ut){console.error("Failed to delete note:",ut)}},Ki=async()=>{if(window.confirm("Are you sure you want to clear all notes?"))try{for(const ce of Dr)await Lp.deleteNote(ce._id);setNotes([]),ha()}catch(ce){console.error("Failed to clear notes:",ce)}};async function Ji(ce){if(P)try{await ra.counterProposal(P._id,ce),E(!1),D(null),st(),rt()}catch(ut){console.error("Failed to counter proposal:",ut)}}function Xi(){Q(!1),W(null)}const B=kt==="challenge"?2:1,Ne=Js.filter(ce=>ce.division===h&&(!ce.phase||ce.phase===B)&&(ce.player1&&ce.player1.trim().toLowerCase()===Pe.toLowerCase()||ce.player2&&ce.player2.trim().toLowerCase()===Pe.toLowerCase())),$e=Array.from(new Set(Ne.map(ce=>ce.player1&&ce.player1.trim().toLowerCase()===Pe.toLowerCase()?ce.player2Email||ce.player2EmailAddress||ce.player2Email||ce.player2||null:ce.player2&&ce.player2.trim().toLowerCase()===Pe.toLowerCase()&&(ce.player1Email||ce.player1EmailAddress||ce.player1Email||ce.player1)||null).filter(Boolean)));function Ge(){var _t,pr;const ce=new Set,ut=[];for(const kr of Ne){const mr=kr.player1&&kr.player1.trim().toLowerCase()===Pe.toLowerCase()?kr.player2:kr.player1;if(te.some(Xt=>{var el,Th;const Qs=[(el=Xt.player1Id)==null?void 0:el.trim().toLowerCase(),(Th=Xt.player2Id)==null?void 0:Th.trim().toLowerCase()];return Xt.division===h&&Qs.includes(Pe.toLowerCase())&&Qs.includes(mr==null?void 0:mr.trim().toLowerCase())}))continue;let nc=!1;for(let Xt=0;Xt<Ct.length;Xt++){if(ce.has(Xt))continue;const Qs=Ct[Xt],el=[(_t=Qs.player1Id)==null?void 0:_t.trim().toLowerCase(),(pr=Qs.player2Id)==null?void 0:pr.trim().toLowerCase()];if(Qs.division===h&&el.includes(Pe.toLowerCase())&&el.includes(mr==null?void 0:mr.trim().toLowerCase())){ce.add(Xt),nc=!0;break}}nc||ut.push(kr)}return ut}const Yt=Ge().map(ce=>{var pr,kr;const ut=ce.player1&&ce.player1.trim().toLowerCase()===Pe.toLowerCase()?(pr=ce.player2)==null?void 0:pr.trim():(kr=ce.player1)==null?void 0:kr.trim();if(!ut)return null;const _t=fe.find(mr=>`${mr.firstName} ${mr.lastName}`.trim().toLowerCase()===ut.toLowerCase());return{match:ce,player:_t,opponentName:ut}}).filter(Boolean);function hr(ce){const ut=Yt.find(pr=>pr.opponentName&&pr.opponentName.trim().toLowerCase()===ce.trim().toLowerCase()),_t=(ut==null?void 0:ut.player)||fe.find(pr=>`${pr.firstName} ${pr.lastName}`.trim().toLowerCase()===ce.trim().toLowerCase());if(!_t){alert("Player data not found for: "+ce);return}if(Qb){rn(_t);return}if(!_t.email){alert("This opponent does not have an email on file and cannot be proposed a match.");return}Ee(_t),je(!0),O(!1)}function vr(){if(console.log("Smart match button clicked!"),console.log("currentUser:",pa),console.log("allPlayers:",To),console.log("allPlayers length:",To==null?void 0:To.length),!pa||!To||To.length===0){console.log("Player data not available, showing alert"),alert("Player data not available for smart match. Please try again.");return}O(!0),rc(!0)}function rn(ce){UN(ce),O(!1),rc(!1),No(!0)}y.useEffect(()=>{if(!i||!n||!h||!dt||kt!=="scheduled")return;const ce=async()=>{try{await zH.checkAndSendDeadlineReminder(i,`${n} ${t}`,h)}catch(_t){console.error("Error checking deadline reminders:",_t)}};ce();const ut=setInterval(ce,60*60*1e3);return()=>clearInterval(ut)},[i,n,t,h,dt,kt]);const vn=Ct.filter(ce=>ce.division===h).filter(ce=>{if(Se){let ut="";if(ce.player1Id&&ce.player2Id?ce.player1Id.trim().toLowerCase()===Pe.trim().toLowerCase()?ut=ce.player2Id:ut=ce.player1Id:ce.senderName&&ce.receiverName&&(ce.senderName.trim().toLowerCase()===Pe.trim().toLowerCase()?ut=ce.receiverName:ut=ce.senderName),!ut.toLowerCase().includes(Se.toLowerCase()))return!1}return!(He!=="all"&&(He==="completed"&&ce.status!=="completed"||He==="pending"&&ce.status!=="pending"||He==="upcoming"&&ce.status==="completed"))}).sort((ce,ut)=>{switch(nt){case"date":const _t=ce.scheduledDate?new Date(ce.scheduledDate):new Date(ce.date||0),pr=ut.scheduledDate?new Date(ut.scheduledDate):new Date(ut.date||0);return _t-pr;case"opponent":let kr="",mr="";return ce.player1Id&&ce.player2Id?kr=ce.player1Id.trim().toLowerCase()===Pe.trim().toLowerCase()?ce.player2Id:ce.player1Id:ce.senderName&&ce.receiverName&&(kr=ce.senderName.trim().toLowerCase()===Pe.trim().toLowerCase()?ce.receiverName:ce.senderName),ut.player1Id&&ut.player2Id?mr=ut.player1Id.trim().toLowerCase()===Pe.trim().toLowerCase()?ut.player2Id:ut.player1Id:ut.senderName&&ut.receiverName&&(mr=ut.senderName.trim().toLowerCase()===Pe.trim().toLowerCase()?ut.receiverName:ut.senderName),kr.localeCompare(mr);case"status":const Nn={pending:1,confirmed:2,completed:3},nc=Nn[ce.status]||0,Xt=Nn[ut.status]||0;return nc-Xt;default:return 0}});function qn(ce){W(ce),Q(!0)}const In=H&&e.jsxs(It,{open:H,onClose:()=>{ue(!1),G(""),Xe("all"),At("date")},title:` All Upcoming Matches (${vn.length})`,maxWidth:"900px",className:"all-matches-modal",children:[e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:Ur?"wrap":"nowrap",alignItems:"center",marginBottom:"8px"},children:[e.jsxs("div",{style:{flex:1,minWidth:Ur?"100%":"200px",position:"relative"},children:[e.jsx("input",{type:"text",placeholder:"Search by opponent name...",value:Se,onChange:ce=>G(ce.target.value),style:{width:"100%",padding:"8px 12px 8px 36px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",outline:"none",transition:"all 0.2s ease"},onFocus:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.4)",ce.target.style.background="rgba(0, 0, 0, 0.5)"},onBlur:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.2)",ce.target.style.background="rgba(0, 0, 0, 0.3)"}}),e.jsx("span",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#888",fontSize:"0.9rem"},children:""})]}),e.jsxs("select",{value:He,onChange:ce=>Xe(ce.target.value),style:{padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",outline:"none",cursor:"pointer",minWidth:Ur?"100%":"120px"},onFocus:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.4)"},onBlur:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.2)"},children:[e.jsx("option",{value:"all",children:"All Matches"}),e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("select",{value:nt,onChange:ce=>At(ce.target.value),style:{padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",outline:"none",cursor:"pointer",minWidth:Ur?"100%":"100px"},onFocus:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.4)"},onBlur:ce=>{ce.target.style.border="1px solid rgba(255, 255, 255, 0.2)"},children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"opponent",children:"Sort by Opponent"}),e.jsx("option",{value:"status",children:"Sort by Status"})]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",height:"450px",minHeight:"200px"},children:vn.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#888",fontSize:"1.1rem"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"16px"},children:""}),e.jsx("div",{style:{marginBottom:"8px",fontWeight:"bold"},children:"No matches found"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:"You don't have any upcoming matches scheduled."})]}):e.jsx("div",{style:{display:"grid",gap:"12px",gridTemplateColumns:Ur?"1fr":"repeat(auto-fit, minmax(300px, 1fr))",maxWidth:"100%"},children:vn.map((ce,ut)=>{let _t="",pr="",kr="upcoming";if(ce.player1Id&&ce.player2Id)if(ce.player1Id.trim().toLowerCase()===Pe.trim().toLowerCase()?_t=ce.player2Id:_t=ce.player1Id,ce.scheduledDate){const Xt=new Date(ce.scheduledDate);isNaN(Xt.getTime())?pr="[Invalid Date]":pr=Zj(Xt.toISOString().split("T")[0])}else pr="[No Date]";else if(ce.senderName&&ce.receiverName&&(ce.senderName.trim().toLowerCase()===Pe.trim().toLowerCase()?_t=ce.receiverName:_t=ce.senderName),ce.date){const Xt=ce.date.split("-");if(Xt.length===3){const[Qs,el,Th]=Xt,HN=new Date(`${Qs}-${el}-${Th}`);isNaN(HN.getTime())?pr="[Invalid Date]":pr=Zj(ce.date)}else pr="[Invalid Date]"}else pr="[No Date]";ce.status;const mr=ce.status==="completed";mr?kr="completed":ce.status==="pending"&&(kr="pending");const Nn=Xt=>{switch(Xt){case"completed":return"#10b981";case"pending":return"#f59e0b";default:return"var(--accent-red)"}},nc=Xt=>{switch(Xt){case"completed":return"";case"pending":return"";default:return""}};return e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.15)",padding:"12px",transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:Xt=>{Xt.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 100%)",Xt.currentTarget.style.border="1px solid rgba(229, 62, 62, 0.3)",Xt.currentTarget.style.transform="translateY(-2px)",Xt.currentTarget.style.boxShadow="0 8px 24px rgba(229, 62, 62, 0.2)"},onMouseLeave:Xt=>{Xt.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%)",Xt.currentTarget.style.border="1px solid rgba(255, 255, 255, 0.15)",Xt.currentTarget.style.transform="translateY(0)",Xt.currentTarget.style.boxShadow="none"},children:[e.jsxs("div",{style:{position:"absolute",top:"16px",right:"16px",background:Nn(kr),color:"#fff",padding:"6px 12px",borderRadius:"16px",fontSize:"0.8rem",fontWeight:"600",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:[nc(kr)," ",kr]}),e.jsx("div",{style:{textAlign:"center",marginBottom:"8px",paddingRight:"100px"},children:e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"700",color:"#fff",textShadow:"0 2px 4px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",flexWrap:"wrap"},children:[e.jsxs("span",{children:[n," ",t]}),e.jsx("span",{style:{color:"var(--accent-red)",fontSize:"1rem",fontWeight:"600"},children:"VS"}),e.jsx("span",{children:_t||"[Unknown Opponent]"})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"12px",fontSize:"0.9rem",color:"#ccc"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255, 255, 255, 0.1)",padding:"8px 12px",borderRadius:"8px"},children:[" ",pr]}),ce.location&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255, 255, 255, 0.1)",padding:"8px 12px",borderRadius:"8px"},children:[" ",ce.location]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>qn(ce),style:{padding:"8px 16px",background:"linear-gradient(135deg, var(--accent-red), var(--accent-red-dark))",border:"none",borderRadius:"8px",color:"#fff",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(229, 62, 62, 0.3)",minWidth:"100px"},onMouseEnter:Xt=>{Xt.target.style.transform="translateY(-1px)",Xt.target.style.boxShadow="0 4px 16px rgba(229, 62, 62, 0.5)"},onMouseLeave:Xt=>{Xt.target.style.transform="translateY(0)",Xt.target.style.boxShadow="0 2px 8px rgba(229, 62, 62, 0.3)"},children:" View Details"}),!mr&&e.jsx(wC,{className:Ke.dashboardBtn+" "+Ke.matchCardDoneBtn,loading:vt===ce._id,loadingText:"Completing...",style:{padding:"8px 16px",fontSize:"0.85rem",fontWeight:"600",background:"linear-gradient(135deg, #6c757d, #5a6268)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:"0 2px 8px rgba(108, 117, 125, 0.3)"},onMouseEnter:Xt=>{vt!==ce._id&&(Xt.target.style.background="linear-gradient(135deg, #10b981, #059669)",Xt.target.style.transform="translateY(-1px)",Xt.target.style.boxShadow="0 4px 16px rgba(16, 185, 129, 0.5)")},onMouseLeave:Xt=>{vt!==ce._id&&(Xt.target.style.background="linear-gradient(135deg, #6c757d, #5a6268)",Xt.target.style.transform="translateY(0)",Xt.target.style.boxShadow="0 2px 8px rgba(108, 117, 125, 0.3)")},onClick:()=>{let Xt="",Qs="";ce.player1Id&&ce.player2Id?(Xt=ce.player1Id,Qs=ce.player2Id):ce.type==="scheduled"?(Xt=ce.player1,Qs=ce.player2):(Xt=ce.senderName,Qs=ce.receiverName),wt(ce),yr({player1:Xt,player2:Qs}),Ue(!0)},type:"button",children:" Mark as Complete"})]})]},ce._id||ut)})})}),e.jsx("div",{style:{padding:"8px 0 0",borderTop:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"8px",textAlign:"center"},children:e.jsxs("div",{style:{fontSize:"0.9rem",color:"#888"},children:["Showing ",vn.length," match",vn.length!==1?"es":""]})})]}),Aa=[...Ct.filter(ce=>{var ut,_t;return ce.division===h&&[(ut=ce.player1Id)==null?void 0:ut.trim().toLowerCase(),(_t=ce.player2Id)==null?void 0:_t.trim().toLowerCase()].includes(Pe.toLowerCase())}),...te.filter(ce=>{var ut,_t;return ce.division===h&&[(ut=ce.player1Id)==null?void 0:ut.trim().toLowerCase(),(_t=ce.player2Id)==null?void 0:_t.trim().toLowerCase()].includes(Pe.toLowerCase())})];Array.from(new Set(Aa.map(ce=>ce._id))).map(ce=>Aa.find(ut=>ut._id===ce)).length;const[Qi,ei]=y.useState(!1),[Co,No]=y.useState(!1),[pa,tc]=y.useState(null),[To,Xb]=y.useState([]),[WN,UN]=y.useState(null),[Qb,rc]=y.useState(!1);[...Ve.filter(ce=>ce.status==="pending"&&ce.receiverName===Pe),...we.filter(ce=>ce.status==="countered"&&ce.senderName===Pe)],[...we.filter(ce=>ce.status==="pending"&&ce.senderName===Pe),...Ve.filter(ce=>ce.status==="countered"&&ce.receiverName===Pe)],console.log(" Dashboard: showOpponents state:",Ae),console.log(" Dashboard: simulationRef.current:",!!Cn.current);const qN=Ae&&Cn.current?yh.createPortal(e.jsx("div",{style:{position:"absolute",top:Cn.current.getBoundingClientRect().top+window.scrollY,left:Cn.current.getBoundingClientRect().left+window.scrollX,width:Cn.current.offsetWidth,height:Cn.current.offsetHeight,zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.6)",pointerEvents:"auto"},children:e.jsx(Ak,{open:Ae,onClose:()=>O(!1),opponents:Yt,onOpponentClick:hr,phase:kt,selectedCalendarDate:oe,smartMatchMode:Qb,allPlayers:To})}),document.body):null,Zi=i==="guest@frontrangepool.com",Zb=Zi?!1:Re,ev=Zi?!1:We,tv=Zi?!1:Jr,rv=Zi?!1:Tt,nv=Zi?!1:Fn,sv=Zi?!1:Xs;return e.jsxs("div",{className:Ke.dashboardBg,style:{position:"relative"},children:[e.jsx("style",{children:`
          @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
          }
        `}),Ur?e.jsx(EH,{playerName:n,playerLastName:t,pendingProposals:Ve,sentProposals:we,matches:te,notes:Dr,standings:Pr,schedule:Js,proposalsLoading:Zb,matchesLoading:ev,notesLoading:tv,seasonLoading:rv,standingsLoading:nv,scheduleLoading:sv,setShowMatchProposalModal:()=>setShowMatchProposalModal(!0),setShowUserProfileModal:()=>Me(!0),onViewMatch:qn,onViewProposal:ce=>{j(ce),ks(!0)},onViewStandings:()=>f(!0),onViewSchedule:()=>jt(!0),onQuickAction:()=>setShowMatchProposalModal(!0)}):e.jsx("div",{className:Ke.dashboardFrame,style:{position:"relative",zIndex:1},children:e.jsxs("div",{className:Ke.dashboardCard,style:{position:"relative",zIndex:1,padding:"20px",margin:"16px"},children:[e.jsx($C,{playerName:n,playerLastName:t,isMobile:Ur,userPin:s,playerEmail:i,proposalsLoading:Zb,matchesLoading:ev,notesLoading:tv,seasonLoading:rv,standingsLoading:nv,scheduleLoading:sv,onProfileClick:()=>Me(!0),styles:Ke}),e.jsx(LC,{divisions:d,selectedDivision:h,onDivisionChange:ce=>p(ce.target.value),isMobile:Ur}),e.jsx(BC,{isMobile:Ur,styles:Ke,effectivePhase:kt,seasonData:dt,completedMatches:te,totalRequiredMatches:eo,playerName:n,playerLastName:t,selectedDivision:h,pendingCount:ps,sentCount:Xa,filteredUpcomingMatches:vn,currentUser:pa,allPlayers:To,showPhase1Rules:he,setShowPhase1Rules:Be,setShowPhase1Overview:$t,setPlayerStats:Ot,setTimeLeft:ur,setDeadlineStatus:Un,setPhase1EndDate:fs,onOpenOpponentsModal:ce=>{console.log(" Dashboard: onOpenOpponentsModal called with date:",ce),me(ce),ce?(console.log(" Dashboard: Setting smart match mode to false"),rc(!1)):(console.log(" Dashboard: Setting smart match mode to true"),rc(!0)),console.log(" Dashboard: Setting showOpponents to true"),O(!0)},onOpenCompletedMatchesModal:()=>ei(!0),onOpenStandingsModal:()=>f(!0),onOpenDefenseChallengersModal:()=>v(!0),onOpenAllMatchesModal:()=>ue(!0),onOpenProposalListModal:()=>w(!0),onOpenSentProposalListModal:()=>N(!0),onOpenPlayerSearch:()=>ve(!0),onMatchClick:qn,onSmartMatchClick:vr,onOpenMessageCenter:ce=>{qt(ce),ot(!0)},onOpenCalendar:()=>jt(!0),simulationRef:Cn,opponentsModalPortal:qN}),e.jsx(OC,{notes:Dr,notesLoading:Jr,noteError:U,userPin:s,onDeleteNote:Zo,onClearNotes:Ki,styles:Ke}),!Zi&&c&&e.jsx(zC,{userPin:s,loadingPendingRegistrations:ns,phaseOverride:Ze,selectedDivision:h,BACKEND_URL:Ie,styles:Ke,onShowRegistrationModal:()=>Ar(!0),onLoadPendingRegistrations:le,onSetPendingRegistrations:tn,onShowPendingRegistrationsModal:()=>dn(!0),onCreateTestRegistration:async()=>{try{const ce={firstName:"Test",lastName:"Player",email:`testplayer${Date.now()}@example.com`,phone:"555-1234",textNumber:"555-5678",emergencyContactName:"Emergency Contact",emergencyContactPhone:"555-9999",preferredContacts:["email","text"],availability:{Mon:["6:00 PM - 8:00 PM"],Tue:["8:00 PM - 10:00 PM"],Wed:[],Thu:["4:00 PM - 6:00 PM"],Fri:[],Sat:["2:00 PM - 4:00 PM"],Sun:["10:00 AM - 12:00 PM"]},locations:`Test Pool Hall
Community Center
Sports Bar`,pin:"1234",division:"FRBCAPL TEST",notes:"Test registration created by admin"},ut=await fetch(`${Ie}/api/users/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(ut.ok){const _t=await ut.json();alert(` Test registration created successfully!

Player: Test Player
Email: `+ce.email+`

You can now approve this registration.`);const pr=await fetch(`${Ie}/api/users/pending-registrations`);if(pr.ok){const kr=await pr.json();tn(kr)}}else{const _t=await ut.json();alert("Failed to create test registration: "+_t.error)}}catch(ce){console.error("Error creating test registration:",ce),alert("Error creating test registration: "+ce.message)}},onShowNoteModal:()=>A(!0),onShowPendingClaimsModal:()=>un(!0),onGoToAdmin:a,onGoToPlatformAdmin:l,isSuperAdmin:Ye,onActivatePhase2:()=>{},onSetPhaseOverride:et,onRefreshSeasonData:async()=>{try{const[ce,ut]=await Promise.all([zo.getCurrentSeason(h),zo.getCurrentPhaseAndWeek(h)]);setSeasonData((ce==null?void 0:ce.season)||null),setCurrentPhaseInfo(ut)}catch(ce){console.error("Error refreshing season data:",ce)}}})]})}),e.jsx(FC,{showPlayerSearch:Ce,showAdminPlayerSearch:De,showPlayerAvailability:re,showProposalModal:F,selectedOpponent:V,proposalData:I,fullName:Pe,senderEmail:i,selectedDivision:h,effectivePhase:kt,playerName:n,playerLastName:t,onClosePlayerSearch:()=>ve(!1),onCloseAdminPlayerSearch:()=>Oe(!1),onClosePlayerAvailability:()=>{je(!1),Ee(null)},onCloseProposalModal:()=>ae(!1),onProposeMatch:(ce,ut)=>{X({player:V,day:ce,slot:ut,selectedDivision:h,phase:kt}),ae(!0),je(!1),Ee(null)},onProposalComplete:()=>{},onUpdateProposalLocally:yt,onRefetchMatches:st,onRefetchProposals:rt}),e.jsx(WC,{showStandings:g,showDefenseChallengers:m,modalOpen:Y,showNoteModal:T,showProposalListModal:b,showSentProposalListModal:C,showCounterModal:M,showProposalDetailsModal:_o,selectedMatch:$,selectedProposal:x,counterProposal:P,newNote:k,noteError:U,proposalNote:S,pendingProposals:Ve,sentProposals:we,players:fe,STANDINGS_URLS:FH,onCloseStandings:()=>f(!1),onCloseDefenseChallengers:()=>v(!1),onCloseModal:Xi,onCloseNoteModal:()=>A(!1),onCloseProposalListModal:()=>w(!1),onCloseSentProposalListModal:()=>N(!1),onCloseCounterModal:()=>{E(!1),D(null)},onCloseProposalDetailsModal:()=>{ks(!1),j(null)},onAddNote:to,onUpdateNewNote:ce=>R(ce.target.value),onSelectProposal:ce=>{const ut=i&&ce.senderEmail&&i.toLowerCase()===ce.senderEmail.toLowerCase()||`${n} ${t}`.toLowerCase()===(ce.senderName||"").toLowerCase();j(ce),_(""),w(!1),ks(ut)},onSelectSentProposal:ce=>{const ut=i&&ce.senderEmail&&i.toLowerCase()===ce.senderEmail.toLowerCase()||`${n} ${t}`.toLowerCase()===(ce.senderName||"").toLowerCase();j(ce),_(""),N(!1),ks(ut)},onConfirmProposal:async()=>{await ra.updateProposalStatus(x._id,"confirmed",S),j(null),_(""),st(),rt()},onCounterPropose:()=>{D(x),E(!0),j(null)},onSubmitCounterProposal:Ji,onEditProposal:()=>{x.isCounter?(ks(!1),setTimeout(()=>{j(null),D(x),E(!0)},100)):(ks(!1),setTimeout(()=>{j(null),Qa(!0)},100))},onDeleteProposal:async()=>{if(window.confirm("Are you sure you want to delete this proposal?"))try{await ra.deleteProposal(x._id),ks(!1),j(null),rt()}catch(ce){console.error("Error deleting proposal:",ce),alert("Failed to delete proposal")}},onUpdateProposalLocally:yt,onRefetchMatches:st,onRefetchProposals:rt,selectedDivision:h,effectivePhase:kt,userPin:s,playerName:n,playerLastName:t,senderEmail:i,styles:Ke,proposalService:ra}),e.jsx(qC,{showEditProposalModal:Ra,showChatModal:ye,showCompletedModal:Qi,winnerModalOpen:Rt,validationModalOpen:Sr,showSmartMatchmakingModal:Co,showUserProfileModal:_e,onCloseUserProfileModal:()=>Me(!1),showPhase1Rules:he,showPhase1Overview:ct,showRegistrationModal:Dt,showPendingRegistrationsModal:$r,showCalendarModal:qe,selectedProposal:x,chatType:tr,opponentEmails:$e,completedMatches:te,winnerModalPlayers:Lt,winnerModalMatch:ft,matchToValidate:Za,selectedOpponentForSmartMatch:WN,pendingRegistrations:Wn,onCloseEditProposalModal:()=>Qa(!1),onCloseChatModal:()=>ot(!1),onCloseCompletedModal:()=>ei(!1),onCloseWinnerModal:()=>Ue(!1),onCloseValidationModal:()=>{Bs(!1),jr(null)},onCloseSmartMatchmakingModal:()=>No(!1),onClosePhase1Rules:()=>Be(!1),onClosePhase1Overview:()=>$t(!1),onCloseRegistrationModal:()=>Ar(!1),onClosePendingRegistrationsModal:()=>dn(!1),onCloseCalendarModal:()=>jt(!1),onSaveEditProposal:ce=>{j(ce),rt(),Qa(!1)},onProposalUpdated:ce=>{Z(ce),rt()},onSelectWinner:async ce=>{if(ft){if((pt==null?void 0:pt.phase)==="scheduled"&&dt&&zo.hasPhase1DeadlinePassed(dt)&&!window.confirm(` PHASE 1 DEADLINE HAS PASSED!

You are attempting to complete a match after the Phase 1 deadline. This may affect your standings or eligibility for Phase 2.

Do you want to continue marking this match as completed?`)){Ue(!1);return}Ue(!1),Nt(ft._id);try{const _t=await(await fetch(`${Ie}/api/matches?proposalId=${ft._id}`)).json();if(_t.length>0){const pr=_t[0]._id;await fetch(`${Ie}/api/matches/${pr}/complete`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({winner:ce,score:"TBD",notes:`Completed by ${n} ${t}`})})}else await ra.markCompleted(ft._id,ce);Le({...ft,winner:ce}),st(),rt()}catch(ut){console.error("Error completing match:",ut),alert("Failed to mark as completed.")}Nt(null)}},onValidateMatch:async ce=>{console.log("Validating match:",ce),st()},onRejectMatch:async ce=>{console.log("Rejecting match:",ce),st()},onSmartMatchProposalComplete:()=>{st(),rt()},onUserUpdate:ce=>{tc(ce)},onRegistrationSuccess:ce=>{console.log("New player registered by admin:",ce),Ar(!1),window.location.reload()},onApproveRegistration:async ce=>{const _t=document.getElementById(`division-${ce._id}`).value;if(!_t){alert("Please select a division before approving.");return}const pr={hasPaid:!0,paymentDate:new Date,paymentMethod:"Cash",paymentNotes:"Approved by admin"};try{const kr=await fetch(`${Ie}/api/users/admin/approve-registration/${ce._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({approvedBy:`${n} ${t}`,paymentInfo:pr,division:_t})});if(kr.ok)alert(`Registration approved successfully!

Player: ${ce.firstName} ${ce.lastName}
Division: ${_t}`),tn(mr=>mr.filter(Nn=>Nn._id!==ce._id));else{const mr=await kr.json();alert("Failed to approve: "+mr.error)}}catch(kr){console.error("Error approving registration:",kr),alert("Error approving registration")}},onRejectRegistration:async ce=>{const ut=prompt("Enter rejection reason (optional):");if(ut!==null)try{const _t=await fetch(`${Ie}/api/users/admin/reject-registration/${ce._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rejectedBy:`${n} ${t}`,notes:ut})});if(_t.ok)alert("Registration rejected successfully!"),tn(pr=>pr.filter(kr=>kr._id!==ce._id));else{const pr=await _t.json();alert("Failed to reject: "+pr.error)}}catch(_t){console.error("Error rejecting registration:",_t),alert("Error rejecting registration")}},onOpenOpponentsModal:ce=>{console.log(" Dashboard: Calendar modal calling onOpenOpponentsModal with date:",ce),me(ce),ce?(console.log(" Dashboard: Setting smart match mode to false"),rc(!1)):(console.log(" Dashboard: Setting smart match mode to true"),rc(!0)),console.log(" Dashboard: Setting showOpponents to true"),O(!0),jt(!1)},onMatchClick:qn,onSmartMatchClick:vr,selectedDivision:h,effectivePhase:kt,userPin:s,playerName:n,playerLastName:t,senderEmail:i,isMobile:Ur,currentUser:pa,players:fe,filteredUpcomingMatches:vn,phase1EndDate:ms,playerStats:Bt,standings:Pr,timeLeft:dr,deadlineStatus:bn,allPlayers:To,styles:Ke,proposalService:ra,seasonService:zo,seasonData:dt,currentPhaseInfo:pt,BACKEND_URL:Ie,markMatchCompleted:Le,setCompletingMatchId:Nt,updateCompletedMatch:Z,refetchMatches:st,refetchProposals:rt,setPendingRegistrations:tn}),In,rs&&e.jsx(WH,{onClose:()=>un(!1)}),i==="guest@frontrangepool.com"&&e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:9999,width:"85%",maxWidth:"1000px",height:"500px",pointerEvents:"auto"},children:e.jsx("div",{style:{background:"transparent",borderRadius:"12px",padding:"20px",width:"100%",height:"100%",overflow:"auto"},children:e.jsx(_C,{currentPhase:"scheduled",seasonData:{_id:"guest-season-1",name:"BCAPL Singles Division - Guest Preview",division:"FRBCAPL TEST",startDate:new Date,endDate:new Date(Date.now()+60*24*60*60*1e3),phase1EndDate:new Date(Date.now()+42*24*60*60*1e3),totalWeeks:10,currentWeek:3,isActive:!0},completedMatches:[{_id:"guest-match-1",player1Id:"Guest User",player2Id:"John Smith",winner:"Guest User",score:"5-3",matchDate:new Date(Date.now()-7*24*60*60*1e3),status:"completed"},{_id:"guest-match-2",player1Id:"Guest User",player2Id:"Jane Doe",winner:"Jane Doe",score:"3-5",matchDate:new Date(Date.now()-14*24*60*60*1e3),status:"completed"}],totalRequiredMatches:6,playerName:n,playerLastName:t,selectedDivision:"FRBCAPL TEST",onOpenOpponentsModal:()=>alert(" Opponents Modal - Members only!"),onOpenCompletedMatchesModal:()=>alert(" Completed Matches - Members only!"),onOpenStandingsModal:()=>alert(" Standings - Members only!"),onOpenAllMatchesModal:()=>alert(" All Matches - Members only!"),pendingCount:2,sentCount:1,onOpenProposalListModal:()=>alert(" Proposals - Members only!"),onOpenSentProposalListModal:()=>alert(" Sent Proposals - Members only!"),upcomingMatches:[{_id:"guest-upcoming-1",player1Id:"Guest User",player2Id:"Mike Johnson",proposedDate:new Date(Date.now()+7*24*60*60*1e3),status:"pending"}],onMatchClick:()=>alert(" Match Details - Members only!"),isMobile:Ur,onOpenMessageCenter:()=>alert(" Message Center - Members only!"),currentUser:pa,allPlayers:[{firstName:"Guest",lastName:"User",email:"guest@frontrangepool.com"},{firstName:"John",lastName:"Smith",email:"john@example.com"},{firstName:"Jane",lastName:"Doe",email:"jane@example.com"},{firstName:"Mike",lastName:"Johnson",email:"mike@example.com"}],onSmartMatchClick:()=>alert(" Smart Match - Members only!"),showPhase1Rules:he,setShowPhase1Rules:Be,showPhase1Overview:ct,setShowPhase1Overview:$t,setPlayerStats:Ot,setTimeLeft:ur,setDeadlineStatus:Un,setPhase1EndDate:fs,onOpenCalendar:()=>alert(" Calendar - Members only!")})})})]})}const GH="_adminDashboardRoot_1xwqk_9",VH="_adminDashboardNav_1xwqk_25",KH="_navLeft_1xwqk_45",JH="_navRight_1xwqk_45",XH="_adminDashboardMainColumn_1xwqk_89",QH="_banner_1xwqk_103",ZH="_slideIn_1xwqk_1",eY="_success_1xwqk_125",tY="_error_1xwqk_137",rY="_sectionNavigation_1xwqk_173",nY="_sectionButton_1xwqk_193",sY="_active_1xwqk_231",aY="_sectionContent_1xwqk_245",oY="_overviewSection_1xwqk_263",iY="_quickActions_1xwqk_301",lY="_quickActionButton_1xwqk_317",cY="_workflowContainer_1xwqk_383",dY="_workflowHeader_1xwqk_393",uY="_workflowProgress_1xwqk_427",hY="_workflowSteps_1xwqk_445",pY="_workflowStepIndicator_1xwqk_461",mY="_pending_1xwqk_483",fY="_completed_1xwqk_505",gY="_stepNumber_1xwqk_517",xY="_stepInfo_1xwqk_569",yY="_stepTitle_1xwqk_577",bY="_stepDescription_1xwqk_587",vY="_workflowContent_1xwqk_597",wY="_workflowStep_1xwqk_445",jY="_stepInstructions_1xwqk_621",SY="_instructionItem_1xwqk_637",_Y="_stepActions_1xwqk_675",kY="_workflowButton_1xwqk_689",CY="_divisionForm_1xwqk_743",NY="_workflowInput_1xwqk_757",TY="_workflowNote_1xwqk_799",PY="_workflowResult_1xwqk_823",EY="_dataSyncTools_1xwqk_847",RY="_syncButton_1xwqk_863",AY="_syncResult_1xwqk_913",MY="_playerManagementContainer_1xwqk_941",IY="_tabHeader_1xwqk_951",DY="_tabButton_1xwqk_969",$Y="_tabContent_1xwqk_1015",LY="_approvalSection_1xwqk_1029",BY="_loadingMessage_1xwqk_1039",OY="_emptyState_1xwqk_1053",zY="_registrationList_1xwqk_1075",FY="_registrationCard_1xwqk_1087",WY="_registrationHeader_1xwqk_1115",UY="_registrationNumber_1xwqk_1129",qY="_registrationDetails_1xwqk_1159",HY="_registrationActions_1xwqk_1185",YY="_divisionSelect_1xwqk_1199",GY="_approveButton_1xwqk_1243",VY="_rejectButton_1xwqk_1283",KY="_userSearchContainer_1xwqk_1325",JY="_searchForm_1xwqk_1335",XY="_searchInput_1xwqk_1347",QY="_searchButton_1xwqk_1387",ZY="_searchResults_1xwqk_1425",eG="_userCard_1xwqk_1437",tG="_userInfo_1xwqk_1463",rG="_userHeader_1xwqk_1475",nG="_userName_1xwqk_1491",sG="_systemBadges_1xwqk_1509",aG="_leagueBadge_1xwqk_1525",oG="_ladderBadge_1xwqk_1549",iG="_bothBadges_1xwqk_1573",lG="_ladderInfo_1xwqk_1583",cG="_resultsSummary_1xwqk_1619",dG="_summaryCard_1xwqk_1627",uG="_summaryStats_1xwqk_1657",hG="_summaryStat_1xwqk_1657",pG="_statNumber_1xwqk_1685",mG="_statLabel_1xwqk_1701",fG="_userEmail_1xwqk_1713",gG="_userContactInfo_1xwqk_1725",xG="_userPhone_1xwqk_1741",yG="_userTextNumber_1xwqk_1741",bG="_userDetails_1xwqk_1753",vG="_userAvailability_1xwqk_1783",wG="_availabilityGrid_1xwqk_1791",jG="_availabilityDay_1xwqk_1805",SG="_dayLabel_1xwqk_1819",_G="_timeSlots_1xwqk_1831",kG="_userActions_1xwqk_1851",CG="_addButton_1xwqk_1867",NG="_removeButton_1xwqk_1917",TG="_matchManagementContainer_1xwqk_1965",PG="_sectionHeader_1xwqk_1975",EG="_systemStatusContainer_1xwqk_2019",RG="_statsGrid_1xwqk_2029",AG="_statCard_1xwqk_2043",MG="_systemActions_1xwqk_2099",IG="_systemButton_1xwqk_2113",DG="_editButton_1xwqk_2317",$G="_modalOverlay_1xwqk_2357",LG="_modal_1xwqk_2357",BG="_modalHeader_1xwqk_2403",OG="_closeButton_1xwqk_2433",zG="_modalForm_1xwqk_2475",FG="_formRow_1xwqk_2487",WG="_formField_1xwqk_2499",UG="_modalActions_1xwqk_2569",qG="_cancelButton_1xwqk_2583",HG="_saveButton_1xwqk_2613",se={adminDashboardRoot:GH,adminDashboardNav:VH,navLeft:KH,navRight:JH,adminDashboardMainColumn:XH,banner:QH,slideIn:ZH,success:eY,error:tY,sectionNavigation:rY,sectionButton:nY,active:sY,sectionContent:aY,overviewSection:oY,quickActions:iY,quickActionButton:lY,workflowContainer:cY,workflowHeader:dY,workflowProgress:uY,workflowSteps:hY,workflowStepIndicator:pY,pending:mY,completed:fY,stepNumber:gY,stepInfo:xY,stepTitle:yY,stepDescription:bY,workflowContent:vY,workflowStep:wY,stepInstructions:jY,instructionItem:SY,stepActions:_Y,workflowButton:kY,divisionForm:CY,workflowInput:NY,workflowNote:TY,workflowResult:PY,dataSyncTools:EY,syncButton:RY,syncResult:AY,playerManagementContainer:MY,tabHeader:IY,tabButton:DY,tabContent:$Y,approvalSection:LY,loadingMessage:BY,emptyState:OY,registrationList:zY,registrationCard:FY,registrationHeader:WY,registrationNumber:UY,registrationDetails:qY,registrationActions:HY,divisionSelect:YY,approveButton:GY,rejectButton:VY,userSearchContainer:KY,searchForm:JY,searchInput:XY,searchButton:QY,searchResults:ZY,userCard:eG,userInfo:tG,userHeader:rG,userName:nG,systemBadges:sG,leagueBadge:aG,ladderBadge:oG,bothBadges:iG,ladderInfo:lG,resultsSummary:cG,summaryCard:dG,summaryStats:uG,summaryStat:hG,statNumber:pG,statLabel:mG,userEmail:fG,userContactInfo:gG,userPhone:xG,userTextNumber:yG,userDetails:bG,userAvailability:vG,availabilityGrid:wG,availabilityDay:jG,dayLabel:SG,timeSlots:_G,userActions:kG,addButton:CG,removeButton:NG,matchManagementContainer:TG,sectionHeader:PG,systemStatusContainer:EG,statsGrid:RG,statCard:AG,systemActions:MG,systemButton:IG,editButton:DG,modalOverlay:$G,modal:LG,modalHeader:BG,closeButton:OG,modalForm:zG,formRow:FG,formField:WG,modalActions:UG,cancelButton:qG,saveButton:HG};function YG(n){if(!n)return"N/A";if(n.includes("-")&&n.length===10){const[o,i,l]=n.split("-"),c=new Date(parseInt(o),parseInt(i)-1,parseInt(l)),d=String(c.getMonth()+1).padStart(2,"0"),u=String(c.getDate()).padStart(2,"0"),h=c.getFullYear();return`${d}-${u}-${h}`}let t;if(n.includes("-"))t=new Date(n);else if(n.includes("/")){const o=n.split("/");if(o.length===3){const[i,l,c]=o;t=new Date(c,i-1,l)}else return n}else return n;if(isNaN(t.getTime()))return n;const r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=t.getFullYear();return`${r}-${s}-${a}`}const e2=Ie;function GG({open:n,onClose:t}){const[r,s]=y.useState([]),[a,o]=y.useState(!0);y.useEffect(()=>{n&&(o(!0),fetch(`${e2}/admin/unentered-matches`).then(l=>l.json()).then(l=>{s(l),o(!1)}))},[n]);const i=l=>{fetch(`${e2}/admin/mark-lms-entered/${l}`,{method:"PATCH"}).then(c=>c.json()).then(()=>s(r.filter(c=>c._id!==l)))};return n?e.jsx(It,{open:n,onClose:t,title:"Confirmed Challenge Matches Needing LMS Entry",maxWidth:"520px",children:a?e.jsx("div",{style:{color:"#fff",textAlign:"center",padding:"2rem"},children:"Loading unentered matches..."}):r.length===0?e.jsx("div",{style:{color:"#fff",textAlign:"center",padding:"2rem"},children:"All matches are entered!"}):e.jsx("ul",{style:{padding:0,listStyle:"none"},children:r.map(l=>e.jsxs("li",{style:{marginBottom:12,background:"#222",borderRadius:8,padding:"12px 14px",display:"flex",alignItems:"center",justifyContent:"space-between",borderLeft:"4px solid #c00"},children:[e.jsx("span",{children:e.jsxs("span",{style:{color:"#fff"},children:[e.jsx("b",{children:YG(l.date)}),"  ",e.jsx("span",{style:{color:"#c00"},children:l.senderName})," vs ",e.jsx("span",{style:{color:"#c00"},children:l.receiverName}),l.location&&e.jsxs("span",{style:{color:"#fff"},children:[" @ ",l.location]})]})}),e.jsx("button",{style:{marginLeft:16,background:"#c00",color:"#fff",border:"none",borderRadius:5,padding:"7px 14px",fontWeight:"bold",cursor:"pointer",fontSize:"1em",transition:"background 0.2s"},onClick:()=>i(l._id),children:"Mark as Entered"})]},l._id))})}):null}const VG=({division:n,isAdmin:t=!1})=>{const[r,s]=y.useState([]),[a,o]=y.useState([]),[i,l]=y.useState(!0),[c,d]=y.useState(null),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState(""),[w,x]=y.useState(""),[j,S]=y.useState(""),[_,C]=y.useState("");y.useEffect(()=>{n&&(N(),M())},[n]);const N=async()=>{try{l(!0);const[A,k]=await Promise.all([Im(n,"scheduled"),Im(n,"completed")]);s(A),o(k)}catch(A){console.error("Error loading matches:",A)}finally{l(!1)}},M=async()=>{try{const A=await MH(n);d(A)}catch(A){console.error("Error loading match stats:",A)}},E=async()=>{if(!(!u||!v||!w))try{await RH(u._id,v,w,j),g(!1),h(null),b(""),x(""),S(""),N(),M()}catch(A){console.error("Error completing match:",A),alert("Failed to complete match: "+A.message)}},P=async()=>{if(u)try{await AH(u._id,_),m(!1),h(null),C(""),N(),M()}catch(A){console.error("Error cancelling match:",A),alert("Failed to cancel match: "+A.message)}},D=A=>new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),T=A=>A.status==="completed"?" Completed":A.status==="cancelled"?" Cancelled":" Scheduled";return i?e.jsx("div",{className:Ke.loading,children:"Loading matches..."}):e.jsxs("div",{className:Ke.matchManager,children:[c&&e.jsxs("div",{className:Ke.matchStats,children:[e.jsx("h3",{children:"Match Statistics"}),e.jsxs("div",{className:Ke.statsGrid,children:[e.jsxs("div",{className:Ke.statItem,children:[e.jsx("span",{className:Ke.statNumber,children:c.total}),e.jsx("span",{className:Ke.statLabel,children:"Total Matches"})]}),e.jsxs("div",{className:Ke.statItem,children:[e.jsx("span",{className:Ke.statNumber,children:c.scheduled}),e.jsx("span",{className:Ke.statLabel,children:"Scheduled"})]}),e.jsxs("div",{className:Ke.statItem,children:[e.jsx("span",{className:Ke.statNumber,children:c.completed}),e.jsx("span",{className:Ke.statLabel,children:"Completed"})]})]})]}),e.jsxs("div",{className:Ke.matchSection,children:[e.jsxs("h3",{children:["Scheduled Matches (",r.length,")"]}),r.length===0?e.jsx("p",{className:Ke.noMatches,children:"No scheduled matches"}):e.jsx("div",{className:Ke.matchList,children:r.map(A=>e.jsxs("div",{className:Ke.matchCard,children:[e.jsxs("div",{className:Ke.matchHeader,children:[e.jsx("span",{className:Ke.matchStatus,children:T(A)}),e.jsx("span",{className:Ke.matchDate,children:D(A.scheduledDate)})]}),e.jsxs("div",{className:Ke.matchPlayers,children:[e.jsx("span",{className:Ke.player1,children:A.player1Id}),e.jsx("span",{className:Ke.vs,children:"vs"}),e.jsx("span",{className:Ke.player2,children:A.player2Id})]}),e.jsxs("div",{className:Ke.matchDetails,children:[e.jsxs("span",{className:Ke.location,children:[" ",A.location]}),e.jsxs("span",{className:Ke.type,children:[" ",A.type]})]}),t&&e.jsxs("div",{className:Ke.matchActions,children:[e.jsx("button",{className:Ke.actionButton,onClick:()=>{h(A),g(!0)},children:"Complete"}),e.jsx("button",{className:`${Ke.actionButton} ${Ke.cancelButton}`,onClick:()=>{h(A),m(!0)},children:"Cancel"})]})]},A._id))})]}),e.jsxs("div",{className:Ke.matchSection,children:[e.jsxs("h3",{children:["Completed Matches (",a.length,")"]}),a.length===0?e.jsx("p",{className:Ke.noMatches,children:"No completed matches"}):e.jsx("div",{className:Ke.matchList,children:a.map(A=>e.jsxs("div",{className:`${Ke.matchCard} ${Ke.completedMatch}`,children:[e.jsxs("div",{className:Ke.matchHeader,children:[e.jsx("span",{className:Ke.matchStatus,children:T(A)}),e.jsx("span",{className:Ke.matchDate,children:D(A.completedDate)})]}),e.jsxs("div",{className:Ke.matchPlayers,children:[e.jsx("span",{className:`${Ke.player1} ${A.winner===A.player1Id?Ke.winner:""}`,children:A.player1Id}),e.jsx("span",{className:Ke.vs,children:"vs"}),e.jsx("span",{className:`${Ke.player2} ${A.winner===A.player2Id?Ke.winner:""}`,children:A.player2Id})]}),e.jsxs("div",{className:Ke.matchResult,children:[e.jsxs("span",{className:Ke.winner,children:[" Winner: ",A.winner]}),e.jsxs("span",{className:Ke.score,children:["Score: ",A.score]})]}),A.notes&&e.jsxs("div",{className:Ke.matchNotes,children:[e.jsx("span",{className:Ke.notesLabel,children:"Notes:"}),e.jsx("span",{className:Ke.notesText,children:A.notes})]})]},A._id))})]}),p&&u&&e.jsx("div",{className:Ke.modalOverlay,children:e.jsxs("div",{className:Ke.modal,children:[e.jsx("h3",{children:"Complete Match"}),e.jsxs("p",{children:[u.player1Id," vs ",u.player2Id]}),e.jsxs("div",{className:Ke.formGroup,children:[e.jsx("label",{children:"Winner:"}),e.jsxs("select",{value:v,onChange:A=>b(A.target.value),children:[e.jsx("option",{value:"",children:"Select winner"}),e.jsx("option",{value:u.player1Id,children:u.player1Id}),e.jsx("option",{value:u.player2Id,children:u.player2Id})]})]}),e.jsxs("div",{className:Ke.formGroup,children:[e.jsx("label",{children:"Score:"}),e.jsx("input",{type:"text",value:w,onChange:A=>x(A.target.value),placeholder:"e.g., 7-5"})]}),e.jsxs("div",{className:Ke.formGroup,children:[e.jsx("label",{children:"Notes (optional):"}),e.jsx("textarea",{value:j,onChange:A=>S(A.target.value),placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:Ke.modalActions,children:[e.jsx("button",{onClick:E,disabled:!v||!w,children:"Complete Match"}),e.jsx("button",{onClick:()=>g(!1),children:"Cancel"})]})]})}),f&&u&&e.jsx("div",{className:Ke.modalOverlay,children:e.jsxs("div",{className:Ke.modal,children:[e.jsx("h3",{children:"Cancel Match"}),e.jsxs("p",{children:[u.player1Id," vs ",u.player2Id]}),e.jsxs("div",{className:Ke.formGroup,children:[e.jsx("label",{children:"Reason for cancellation:"}),e.jsx("textarea",{value:_,onChange:A=>C(A.target.value),placeholder:"Why is this match being cancelled?"})]}),e.jsxs("div",{className:Ke.modalActions,children:[e.jsx("button",{onClick:P,children:"Cancel Match"}),e.jsx("button",{onClick:()=>m(!1),children:"Keep Match"})]})]})})]})};function KG({backendUrl:n}){const[t,r]=y.useState({enabled:!1,sheetId:"",sheetName:"Player Backup",apiKey:"",backupFrequency:"weekly",autoBackup:!0}),[s,a]=y.useState(!1),[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(null),[h,p]=y.useState(null),[g,f]=y.useState(1),[m,v]=y.useState(!1);y.useEffect(()=>{b(),w()},[]);const b=async()=>{try{const k=await fetch(`${n}/api/league-config`);if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);const R=await k.json();if(R.success&&R.config){const U=R.config.googleSheetsBackup||{};r({enabled:U.enabled||!1,sheetId:U.sheetId||"",sheetName:U.sheetName||"Player Backup",apiKey:U.apiKey==="***CONFIGURED***"?"":U.apiKey||"",backupFrequency:U.backupFrequency||"weekly",autoBackup:U.autoBackup!==void 0?U.autoBackup:!0}),U.sheetId&&U.apiKey==="***CONFIGURED***"&&u(z=>({...z,enabled:U.enabled,sheetId:U.sheetId,sheetName:U.sheetName,configured:!0,frequency:U.backupFrequency,autoBackup:U.autoBackup,lastBackup:U.lastBackupDate}))}}catch(k){console.error("Error loading config:",k)}},w=async()=>{try{const k=await fetch(`${n}/api/league-config/backup/status`);if(k.ok){const R=await k.json();R.success&&u(R.backup)}}catch(k){console.error("Error loading backup status:",k)}},x=(k,R)=>{c(k),i(R),setTimeout(()=>i(""),5e3)},j=(k,R)=>{r(U=>({...U,[k]:R})),(k==="sheetId"||k==="apiKey")&&p(null)},S=async()=>{if(!t.sheetId||!t.apiKey){x("error","Please fill in both fields first");return}a(!0),p(null);try{const R=await(await fetch(`${n}/api/league-config/backup/test-connection`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetId:t.sheetId,apiKey:t.apiKey})})).json();R.success?(p({success:!0,message:" Great! Connection successful!"}),x("success","Connection successful!")):(p({success:!1,message:` Connection failed: ${R.error}`}),x("error",`Connection failed: ${R.error}`))}catch{p({success:!1,message:"Connection test failed - please check your internet"}),x("error","Connection test failed")}a(!1)},_=async()=>{if(!t.sheetId||!t.apiKey){x("error","Please fill in both fields");return}if(!(h!=null&&h.success)){x("error","Please test the connection first");return}a(!0);try{const R=await(await fetch(`${n}/api/league-config/backup/configure`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();R.success?(x("success"," Backup setup complete!"),w(),f(4)):x("error",`Setup failed: ${R.error}`)}catch{x("error","Failed to save configuration")}a(!1)},C=async()=>{a(!0);try{const R=await(await fetch(`${n}/api/league-config/backup/run`,{method:"POST"})).json();R.success?(x("success",` Backup completed! ${R.count} players backed up.`),w()):x("error",`Backup failed: ${R.error}`)}catch{x("error","Backup failed")}a(!1)},N=k=>`https://docs.google.com/spreadsheets/d/${k}`,M=()=>e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px"},children:[e.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),e.jsx("h2",{style:{color:"white",marginBottom:"20px"},children:"Backup Your League Data"}),e.jsxs("p",{style:{fontSize:"18px",color:"white",marginBottom:"30px",lineHeight:"1.6",opacity:.9},children:["Keep a safe copy of all your player information in Google Sheets.",e.jsx("br",{}),"It's free, secure, and takes just a few minutes to set up."]}),e.jsxs("div",{style:{background:"#ffffff",padding:"20px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"15px"},children:"What You'll Get:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"15px"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Data Safety"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"Backup copy of all player info"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"15px"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Easy Viewing"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"View data in Google Sheets"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"15px"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Auto Backup"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"Keeps data up to date"})]})]})]}),e.jsxs("div",{style:{background:"#f8f9fa",padding:"25px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h4",{style:{color:"#1a1a1a",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(_H,{})," Frequently Asked Questions"]}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{style:{padding:"15px",background:"#ffffff",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[e.jsx("strong",{style:{color:"#1a1a1a",display:"block",marginBottom:"8px"},children:"Q: Is this free to use?"}),e.jsx("span",{style:{color:"#2c2c2c"},children:"A: Yes! Google Sheets is completely free. You only need a Google account."})]}),e.jsxs("div",{style:{padding:"15px",background:"#ffffff",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[e.jsx("strong",{style:{color:"#1a1a1a",display:"block",marginBottom:"8px"},children:"Q: How often does it backup?"}),e.jsx("span",{style:{color:"#2c2c2c"},children:"A: By default, it backs up weekly, but you can run manual backups anytime."})]}),e.jsxs("div",{style:{padding:"15px",background:"#ffffff",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[e.jsx("strong",{style:{color:"#1a1a1a",display:"block",marginBottom:"8px"},children:"Q: Is my data secure?"}),e.jsx("span",{style:{color:"#2c2c2c"},children:"A: Yes! Your API key only works with your specific Google Sheet and is stored securely."})]}),e.jsxs("div",{style:{padding:"15px",background:"#ffffff",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[e.jsx("strong",{style:{color:"#1a1a1a",display:"block",marginBottom:"8px"},children:"Q: What if I change my mind?"}),e.jsx("span",{style:{color:"#2c2c2c"},children:"A: You can disable backup anytime, and your Google Sheet will remain as a backup copy."})]})]})]}),e.jsxs("button",{onClick:()=>f(2),style:{padding:"15px 30px",background:"#007bff",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",margin:"0 auto"},children:["Get Started ",e.jsx(Cl,{})]})]}),E=()=>e.jsxs("div",{style:{padding:"30px 20px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"white",marginBottom:"10px"},children:"Step 1: Create a Google Sheet"}),e.jsx("p",{style:{color:"white",fontSize:"16px",opacity:.9},children:"First, let's create a place to store your backup data"})]}),e.jsxs("div",{style:{background:"#ffffff",padding:"25px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h4",{style:{color:"#1a1a1a",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Am,{})," Create Your Google Sheet"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"20px",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:"15px",color:"#1a1a1a"},children:[e.jsx("strong",{children:"1."})," Go to ",e.jsx("a",{href:"https://sheets.google.com",target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"underline"},children:"Google Sheets"})]}),e.jsxs("p",{style:{marginBottom:"15px",color:"#1a1a1a"},children:[e.jsx("strong",{children:"2."}),' Click "Blank" to create a new sheet']}),e.jsxs("p",{style:{marginBottom:"15px",color:"#1a1a1a"},children:[e.jsx("strong",{children:"3."}),' Give it a name like "League Backup" or "Player Data"']}),e.jsxs("p",{style:{color:"#1a1a1a"},children:[e.jsx("strong",{children:"4."})," Copy the Sheet ID from the URL (we'll show you how)"]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"10px"},children:""}),e.jsx("button",{onClick:()=>window.open("https://sheets.google.com","_blank"),style:{padding:"10px 20px",background:"#28a745",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Open Google Sheets"})]})]})]}),e.jsxs("div",{style:{background:"#fff8dc",padding:"20px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #ffd700"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"15px"},children:"How to Find Your Sheet ID:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:"10px",color:"#1a1a1a"},children:e.jsx("strong",{children:"Look at your Google Sheet URL:"})}),e.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"6px",border:"1px solid #dee2e6",fontFamily:"monospace",fontSize:"14px",wordBreak:"break-all",color:"#1a1a1a"},children:["https://docs.google.com/spreadsheets/d/",e.jsx("span",{style:{background:"#ffeb3b",padding:"2px 4px",borderRadius:"3px"},children:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms"}),"/edit"]}),e.jsx("p",{style:{marginTop:"10px",color:"#2c2c2c",fontSize:"14px"},children:"Copy the highlighted part (the long string of letters and numbers)"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsxs("p",{style:{color:"#2c2c2c",fontSize:"14px"},children:["It's the part between ",e.jsx("code",{style:{background:"#f0f0f0",padding:"2px 4px",borderRadius:"3px"},children:"/d/"})," and ",e.jsx("code",{style:{background:"#f0f0f0",padding:"2px 4px",borderRadius:"3px"},children:"/edit"})]})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#1a1a1a"},children:"Paste Your Sheet ID Here:"}),e.jsx("input",{type:"text",value:t.sheetId,onChange:k=>j("sheetId",k.target.value),placeholder:"Example: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms",style:{width:"100%",padding:"15px",border:"2px solid #ddd",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box",color:"#1a1a1a",backgroundColor:"#ffffff"}}),t.sheetId&&e.jsx("div",{style:{marginTop:"10px",fontSize:"14px",color:"#2c2c2c"},children:e.jsx("a",{href:N(t.sheetId),target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"underline"},children:" Open this sheet to verify"})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>f(1),style:{padding:"12px 24px",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(zg,{})," Back"]}),e.jsxs("button",{onClick:()=>f(3),disabled:!t.sheetId,style:{padding:"12px 24px",background:t.sheetId?"#007bff":"#ccc",color:"white",border:"none",borderRadius:"6px",cursor:t.sheetId?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"8px"},children:["Next ",e.jsx(Cl,{})]})]})]}),P=()=>e.jsxs("div",{style:{padding:"30px 20px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"white",marginBottom:"10px"},children:"Step 2: Get Your API Key"}),e.jsx("p",{style:{color:"white",fontSize:"16px",opacity:.9},children:"This allows the app to write to your Google Sheet (it's free and secure)"})]}),e.jsxs("div",{style:{background:"#ffffff",padding:"25px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"20px"},children:"Getting Your API Key (Takes 2 Minutes):"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"20px",alignItems:"center"},children:[e.jsx("div",{children:e.jsxs("ol",{style:{margin:0,paddingLeft:"20px",lineHeight:"2"},children:[e.jsxs("li",{style:{marginBottom:"10px",color:"#1a1a1a"},children:[e.jsx("strong",{children:"Go to"})," ",e.jsx("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"underline"},children:"Google Cloud Console"})]}),e.jsxs("li",{style:{marginBottom:"10px",color:"#1a1a1a"},children:[e.jsx("strong",{children:'Click "Create Project"'})," (or select an existing one)"]}),e.jsxs("li",{style:{marginBottom:"10px",color:"#1a1a1a"},children:[e.jsx("strong",{children:'Search for "Google Sheets API"'}),' and click "Enable"']}),e.jsxs("li",{style:{marginBottom:"10px",color:"#1a1a1a"},children:[e.jsx("strong",{children:'Go to "Credentials"'}),'  "Create Credentials"  "API Key"']}),e.jsxs("li",{style:{color:"#1a1a1a"},children:[e.jsx("strong",{children:"Copy the API key"})," (it looks like: AIzaSyC...)"]})]})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"10px"},children:""}),e.jsx("button",{onClick:()=>window.open("https://console.cloud.google.com/apis/credentials","_blank"),style:{padding:"10px 20px",background:"#28a745",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"Open Google Cloud Console"})]})]})]}),e.jsxs("div",{style:{background:"#e8f5e8",padding:"20px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #28a745"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"15px"},children:" Don't Worry About Security:"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#1a1a1a"},children:[e.jsx("li",{children:"Your API key only works with your specific Google Sheet"}),e.jsx("li",{children:"It can't access any other files or data"}),e.jsx("li",{children:"It's stored securely and encrypted"}),e.jsx("li",{children:"You can delete it anytime from Google Cloud Console"})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontWeight:"bold",color:"#1a1a1a"},children:"Paste Your API Key Here:"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:m?"text":"password",value:t.apiKey,onChange:k=>j("apiKey",k.target.value),placeholder:"Example: AIzaSyC...",style:{width:"100%",padding:"15px",paddingRight:"50px",border:"2px solid #ddd",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box",color:"#1a1a1a",backgroundColor:"#ffffff"}}),e.jsx("button",{onClick:()=>v(!m),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#666"},children:m?e.jsx(xH,{}):e.jsx(Il,{})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>f(2),style:{padding:"12px 24px",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(zg,{})," Back"]}),e.jsxs("button",{onClick:()=>f(4),disabled:!t.sheetId||!t.apiKey,style:{padding:"12px 24px",background:t.sheetId&&t.apiKey?"#007bff":"#ccc",color:"white",border:"none",borderRadius:"6px",cursor:t.sheetId&&t.apiKey?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"8px"},children:["Test & Save ",e.jsx(Cl,{})]})]})]}),D=()=>e.jsxs("div",{style:{padding:"30px 20px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("h2",{style:{color:"white",marginBottom:"10px"},children:"Step 3: Test & Save"}),e.jsx("p",{style:{color:"white",fontSize:"16px",opacity:.9},children:"Let's make sure everything works before saving"})]}),e.jsxs("div",{style:{background:"#ffffff",padding:"25px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"20px"},children:"Your Setup Summary:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#1a1a1a"},children:"Sheet ID:"}),e.jsx("br",{}),e.jsx("code",{style:{background:"#f8f9fa",padding:"5px 8px",borderRadius:"4px",fontSize:"14px",wordBreak:"break-all",color:"#1a1a1a",border:"1px solid #dee2e6"},children:t.sheetId||"Not set"})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#1a1a1a"},children:"API Key:"}),e.jsx("br",{}),e.jsx("code",{style:{background:"#f8f9fa",padding:"5px 8px",borderRadius:"4px",fontSize:"14px",color:"#1a1a1a",border:"1px solid #dee2e6"},children:t.apiKey?`${t.apiKey.substring(0,10)}...`:"Not set"})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("button",{onClick:S,disabled:s||!t.sheetId||!t.apiKey,style:{width:"100%",padding:"15px",background:"#17a2b8",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:s||!t.sheetId||!t.apiKey?.6:1},children:[s?e.jsx(qd,{style:{animation:"spin 1s linear infinite"}}):e.jsx(qd,{}),s?"Testing Connection...":"Test Connection"]}),h&&e.jsxs("div",{style:{marginTop:"15px",padding:"15px",borderRadius:"8px",background:h.success?"#d4edda":"#f8d7da",color:h.success?"#155724":"#721c24",border:`1px solid ${h.success?"#c3e6cb":"#f5c6cb"}`,display:"flex",alignItems:"center",gap:"10px"},children:[h.success?e.jsx(va,{}):e.jsx(Mm,{}),h.message]})]}),(h==null?void 0:h.success)&&e.jsx("div",{style:{marginBottom:"30px"},children:e.jsxs("button",{onClick:_,disabled:s,style:{width:"100%",padding:"15px",background:"#28a745",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",opacity:s?.6:1},children:[s?e.jsx(qd,{style:{animation:"spin 1s linear infinite"}}):e.jsx(va,{}),s?"Saving...":"Save Configuration"]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>f(3),style:{padding:"12px 24px",background:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(zg,{})," Back"]}),(d==null?void 0:d.configured)&&e.jsxs("button",{onClick:()=>f(5),style:{padding:"12px 24px",background:"#007bff",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:["Next ",e.jsx(Cl,{})]})]})]}),T=()=>e.jsxs("div",{style:{padding:"30px 20px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),e.jsx("h2",{style:{color:"#1a1a1a",marginBottom:"20px"},children:"Setup Complete!"}),e.jsx("p",{style:{fontSize:"18px",color:"#2c2c2c",marginBottom:"30px",lineHeight:"1.6"},children:"Your Google Sheets backup is now configured and ready to use."}),e.jsxs("div",{style:{background:"#e8f5e8",padding:"25px",borderRadius:"12px",marginBottom:"30px",border:"2px solid #28a745"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"20px"},children:" What's Working Now:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Auto Backup"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"Your data will be backed up automatically"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Easy Viewing"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"View your data in Google Sheets anytime"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),e.jsx("strong",{style:{color:"#1a1a1a"},children:"Data Safety"}),e.jsx("br",{}),e.jsx("small",{style:{color:"#2c2c2c"},children:"Your data is now safely backed up"})]})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("button",{onClick:C,disabled:s,style:{padding:"15px 30px",background:"#007bff",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",margin:"0 auto"},children:[s?e.jsx(qd,{style:{animation:"spin 1s linear infinite"}}):e.jsx(qd,{}),s?"Running Backup...":"Run Your First Backup"]}),e.jsx("p",{style:{marginTop:"10px",color:"#2c2c2c",fontSize:"14px"},children:"This will copy all your current player data to your Google Sheet"})]}),(d==null?void 0:d.sheetId)&&e.jsx("div",{style:{marginBottom:"30px"},children:e.jsxs("a",{href:N(d.sheetId),target:"_blank",rel:"noopener noreferrer",style:{padding:"12px 24px",background:"#28a745",color:"white",textDecoration:"none",borderRadius:"6px",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"16px"},children:[e.jsx(Jj,{})," View Your Backup Sheet"]})}),e.jsxs("div",{style:{background:"#fff8dc",padding:"20px",borderRadius:"12px",border:"2px solid #ffd700",textAlign:"left"},children:[e.jsx("h4",{style:{color:"#1a1a1a",marginBottom:"15px"},children:" What Happens Next:"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#1a1a1a",lineHeight:"1.6"},children:[e.jsx("li",{children:"Your data will be backed up automatically"}),e.jsx("li",{children:"You can view your data anytime in Google Sheets"}),e.jsx("li",{children:"You can run manual backups whenever you want"}),e.jsx("li",{children:"Your data is safe and secure"})]})]})]}),A=()=>e.jsxs("div",{style:{background:"#ffffff",padding:"16px",borderRadius:"8px",marginBottom:"20px",border:"2px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h4",{style:{margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"8px",color:"#1a1a1a"},children:[e.jsx(Fb,{})," Current Status"]}),d?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"14px",color:"#1a1a1a"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",d.enabled?" Enabled":" Disabled"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Last Backup:"})," ",d.lastBackup?new Date(d.lastBackup).toLocaleString():"Never"]}),d.sheetId&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Sheet:"})," ",d.sheetName||"Player Backup"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Sheet ID:"})," ",d.sheetId.substring(0,20),"..."]})]})]}):e.jsx("div",{style:{color:"#2c2c2c",fontStyle:"italic"},children:"No backup configured"}),e.jsxs("div",{style:{marginTop:"15px",display:"flex",gap:"10px",flexWrap:"wrap",justifyContent:"center"},children:[(d==null?void 0:d.sheetId)&&e.jsxs("a",{href:N(d.sheetId),target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"none",display:"inline-flex",alignItems:"center",gap:"5px",padding:"8px 12px",border:"1px solid #007bff",borderRadius:"4px",fontSize:"14px"},children:[e.jsx(Jj,{})," View Backup Sheet"]}),e.jsx("button",{onClick:()=>f(5),disabled:!(d!=null&&d.configured),style:{padding:"8px 12px",background:d!=null&&d.configured?"#007bff":"#ccc",color:"white",border:"none",borderRadius:"4px",cursor:d!=null&&d.configured?"pointer":"not-allowed",fontSize:"14px",opacity:d!=null&&d.configured?1:.6},children:"Manage Backup Settings"})]})]});return e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"20px"},children:[e.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `}),e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px"},children:[e.jsxs("h2",{style:{margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"10px",color:"white"},children:[e.jsx(Am,{})," Google Sheets Backup"]}),e.jsx("p",{style:{margin:0,opacity:.9,color:"white"},children:"Keep your league data safe with automatic Google Sheets backup"})]}),o&&e.jsx("div",{style:{padding:"12px 16px",borderRadius:"8px",marginBottom:"20px",background:l==="success"?"#d4edda":"#f8d7da",color:l==="success"?"#155724":"#721c24",border:`1px solid ${l==="success"?"#c3e6cb":"#f5c6cb"}`},children:o}),(d==null?void 0:d.configured)&&A(),g===1&&M(),g===2&&E(),g===3&&P(),g===4&&D(),g===5&&T()]})}function JG({backendUrl:n}){const[t,r]=y.useState([]),[s,a]=y.useState(!0),[o,i]=y.useState(null),[l,c]=y.useState({name:"",address:"",notes:""}),[d,u]=y.useState(""),[h,p]=y.useState("");y.useEffect(()=>{g()},[]);const g=async()=>{try{a(!0);const x=await fetch(`${n}/api/locations`);if(!x.ok)throw new Error("Failed to load locations");const j=await x.json();r(j.locations||[])}catch(x){u("Failed to load locations: "+x.message)}finally{a(!1)}},f=async()=>{if(!l.name.trim()){u("Location name is required");return}try{const x=await fetch(`${n}/api/locations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!x.ok)throw new Error("Failed to add location");const j=await x.json();r([...t,j.location]),c({name:"",address:"",notes:""}),p("Location added successfully!"),setTimeout(()=>p(""),3e3)}catch(x){u("Failed to add location: "+x.message)}},m=async(x,j)=>{try{const S=await fetch(`${n}/api/locations/${x}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!S.ok)throw new Error("Failed to update location");const _=await S.json();r(t.map(C=>C._id===x?_.location:C)),i(null),p("Location updated successfully!"),setTimeout(()=>p(""),3e3)}catch(S){u("Failed to update location: "+S.message)}},v=async x=>{if(window.confirm("Are you sure you want to delete this location? This will affect any players who have selected this location."))try{if(!(await fetch(`${n}/api/locations/${x}`,{method:"DELETE"})).ok)throw new Error("Failed to delete location");r(t.filter(S=>S._id!==x)),p("Location deleted successfully!"),setTimeout(()=>p(""),3e3)}catch(j){u("Failed to delete location: "+j.message)}},b=x=>{i(x._id)},w=()=>{i(null)};return s?e.jsx("div",{style:{textAlign:"center",padding:"20px"},children:e.jsx("div",{style:{fontSize:"18px",color:"#ccc"},children:"Loading locations..."})}):e.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",borderRadius:"12px",marginBottom:"20px",color:"white"},children:[e.jsxs("h2",{style:{margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Qc,{})," Location Management"]}),e.jsx("p",{style:{margin:0,opacity:.9},children:"Manage predefined locations that players can select during registration. Players can also add custom locations if needed."})]}),h&&e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid #4CAF50",color:"#4CAF50",padding:"12px",borderRadius:"6px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(PC,{})," ",h]}),d&&e.jsxs("div",{style:{background:"rgba(244, 67, 54, 0.2)",border:"1px solid #f44336",color:"#f44336",padding:"12px",borderRadius:"6px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Mm,{})," ",d]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"8px",marginBottom:"20px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h3",{style:{color:"#e53e3e",marginBottom:"15px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Ms,{})," Add New Location"]}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Location Name *"}),e.jsx("input",{type:"text",value:l.name,onChange:x=>c({...l,name:x.target.value}),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px"},placeholder:"e.g., Pool Hall A, Community Center"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Address (Optional)"}),e.jsx("input",{type:"text",value:l.address,onChange:x=>c({...l,address:x.target.value}),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px"},placeholder:"e.g., 123 Main St, City, State"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Notes (Optional)"}),e.jsx("textarea",{value:l.notes,onChange:x=>c({...l,notes:x.target.value}),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"16px",minHeight:"80px",resize:"vertical"},placeholder:"Additional information about this location..."})]}),e.jsxs("button",{onClick:f,style:{padding:"12px 20px",borderRadius:"6px",border:"none",background:"#e53e3e",color:"#fff",cursor:"pointer",fontSize:"16px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"},children:[e.jsx(Ms,{})," Add Location"]})]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h3",{style:{color:"#e53e3e",marginBottom:"15px"},children:["Existing Locations (",t.length,")"]}),t.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#ccc"},children:[e.jsx(Qc,{style:{fontSize:"48px",marginBottom:"15px",opacity:.5}}),e.jsx("p",{children:"No locations added yet. Add your first location above!"})]}):e.jsx("div",{style:{display:"grid",gap:"15px"},children:t.map(x=>e.jsx("div",{style:{background:"rgba(0,0,0,0.3)",padding:"15px",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)"},children:o===x._id?e.jsx(QG,{location:x,onSave:j=>m(x._id,j),onCancel:w}):e.jsx(XG,{location:x,onEdit:()=>b(x),onDelete:()=>v(x._id)})},x._id))})]})]})}function XG({location:n,onEdit:t,onDelete:r}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{color:"#fff",margin:"0 0 5px 0",fontSize:"18px"},children:n.name}),n.address&&e.jsxs("p",{style:{color:"#ccc",margin:"0 0 5px 0",fontSize:"14px"},children:[" ",n.address]}),n.notes&&e.jsxs("p",{style:{color:"#999",margin:0,fontSize:"13px"},children:[" ",n.notes]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:t,style:{padding:"8px 12px",borderRadius:"4px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Xc,{})," Edit"]}),e.jsxs("button",{onClick:r,style:{padding:"8px 12px",borderRadius:"4px",border:"1px solid #f44336",background:"transparent",color:"#f44336",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(zi,{})," Delete"]})]})]})}function QG({location:n,onSave:t,onCancel:r}){const[s,a]=y.useState({name:n.name,address:n.address||"",notes:n.notes||""}),o=()=>{if(!s.name.trim()){alert("Location name is required");return}t(s)};return e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Location Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:i=>a({...s,name:i.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Address"}),e.jsx("input",{type:"text",value:s.address,onChange:i=>a({...s,address:i.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontWeight:"bold"},children:"Notes"}),e.jsx("textarea",{value:s.notes,onChange:i=>a({...s,notes:i.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#222",color:"#fff",fontSize:"14px",minHeight:"60px",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsxs("button",{onClick:r,style:{padding:"8px 12px",borderRadius:"4px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(CH,{})," Cancel"]}),e.jsxs("button",{onClick:o,style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:"#4CAF50",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(pl,{})," Save"]})]})]})}function ZG(){const[n,t]=y.useState({registrationFee:30,weeklyDues:10,totalWeeks:10,participationFee:100,phase1Weeks:6,penaltyStructure:{strike1:5,strike2:10,strike3:0},paymentMethods:{venmo:{enabled:!0,username:"",displayName:"Venmo",instructions:"Send payment to @username"},cashapp:{enabled:!0,username:"",displayName:"Cash App",instructions:"Send payment to $username"},creditCard:{enabled:!1,processor:"square",displayName:"Credit/Debit Card",instructions:"Pay online using the link below",paymentLink:"",squareAppId:"",squareLocationId:""},applePay:{enabled:!1,displayName:"Apple Pay",instructions:"Pay using Apple Pay",paymentLink:""},googlePay:{enabled:!1,displayName:"Google Pay",instructions:"Pay using Google Pay",paymentLink:""},cash:{enabled:!0,displayName:"Cash",instructions:"Pay in person to league administrator"},check:{enabled:!1,displayName:"Check",instructions:"Make check payable to [Payee Name]",payeeName:"",mailingAddress:""}},additionalInstructions:"",contactInfo:{adminName:"",adminEmail:"",adminPhone:""},currentSession:{name:"Current Session",startDate:"",endDate:"",isActive:!0}}),[r,s]=y.useState(!0),[a,o]=y.useState(!1),[i,l]=y.useState(""),[c,d]=y.useState({type:"",text:""}),[u,h]=y.useState({feeStructure:!1,penaltyStructure:!1,paymentMethods:!1,additionalInstructions:!1,contactInfo:!1});y.useEffect(()=>{p()},[]);const p=async()=>{try{const j=await fetch(`${Ie}/api/payment-config`);if(j.ok){const S=await j.json();if(S.config){const _={...S.config,penaltyStructure:{strike1:5,strike2:10,strike3:0,...S.config.penaltyStructure},currentSession:{name:"Current Session",startDate:"",endDate:"",isActive:!0,...S.config.currentSession}};t(_)}}}catch(j){console.error("Error loading payment config:",j),d({type:"error",text:"Failed to load payment configuration"})}finally{s(!1)}},g=async()=>{o(!0),d({type:"",text:""});try{(await fetch(`${Ie}/api/payment-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?d({type:"success",text:"Payment configuration saved successfully!"}):d({type:"error",text:"Failed to save payment configuration"})}catch(j){console.error("Error saving payment config:",j),d({type:"error",text:"Error saving payment configuration"})}finally{o(!1)}},f=async(j,S)=>{l(j),d({type:"",text:""});try{if((await fetch(`${Ie}/api/payment-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,...S})})).ok){d({type:"success",text:`${j} saved successfully!`});let C=null;j==="Fee Structure"?C="feeStructure":j==="Penalty Structure"?C="penaltyStructure":j==="Payment Methods"?C="paymentMethods":j==="Additional Instructions"?C="additionalInstructions":j==="Contact Information"&&(C="contactInfo"),C&&h(N=>({...N,[C]:!1}))}else d({type:"error",text:`Failed to save ${j}`})}catch(_){console.error(`Error saving ${j}:`,_),d({type:"error",text:`Error saving ${j}`})}finally{l("")}},m=(j,S,_)=>{t(C=>({...C,paymentMethods:{...C.paymentMethods,[j]:{...C.paymentMethods[j],[S]:_}}}))},v=(j,S)=>{t(_=>({..._,contactInfo:{..._.contactInfo,[j]:S}}))},b=j=>{switch(j){case"venmo":return e.jsx(wH,{});case"cashapp":return e.jsx(fH,{});case"paypal":return e.jsx(hH,{});case"creditCard":return e.jsx(Kj,{});case"applePay":return e.jsx(uH,{});case"googlePay":return e.jsx(Am,{});case"cash":return e.jsx(jH,{});case"check":return e.jsx(PC,{});default:return e.jsx(Kj,{})}},w=j=>{h(S=>({...S,[j]:!S[j]}))},x=j=>{h(S=>({...S,[j]:!1})),p()};return r?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}),e.jsx("p",{children:"Loading payment configuration..."})]}):e.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"},children:[e.jsx("h2",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center"},children:" Payment Configuration"}),c.text&&e.jsxs("div",{style:{padding:"10px 15px",borderRadius:"6px",marginBottom:"20px",background:c.type==="success"?"rgba(76, 175, 80, 0.2)":"rgba(229, 62, 62, 0.2)",border:`1px solid ${c.type==="success"?"#4CAF50":"#e53e3e"}`,color:c.type==="success"?"#4CAF50":"#e53e3e",display:"flex",alignItems:"center",gap:"10px"},children:[c.type==="success"?e.jsx(va,{}):e.jsx(kf,{}),c.text]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:"League Fee Structure"}),e.jsx("button",{onClick:()=>w("feeStructure"),style:{padding:"6px 12px",borderRadius:"4px",border:"none",background:u.feeStructure?"#ff9800":"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:u.feeStructure?" Cancel Edit":" Edit"})]}),e.jsx("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:u.feeStructure?"rgba(76, 175, 80, 0.05)":"rgba(255,255,255,0.02)",opacity:u.feeStructure?1:.8},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Registration Fee ($)"}),e.jsx("input",{type:"number",value:n.registrationFee,onChange:j=>t(S=>({...S,registrationFee:Number(j.target.value)})),disabled:!u.feeStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.feeStructure?"#222":"#333",color:u.feeStructure?"#fff":"#888",cursor:u.feeStructure?"text":"not-allowed"},min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Weekly Dues ($)"}),e.jsx("input",{type:"number",value:n.weeklyDues,onChange:j=>t(S=>({...S,weeklyDues:Number(j.target.value)})),disabled:!u.feeStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.feeStructure?"#222":"#333",color:u.feeStructure?"#fff":"#888",cursor:u.feeStructure?"text":"not-allowed"},min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Total Weeks"}),e.jsx("input",{type:"number",value:n.totalWeeks,onChange:j=>t(S=>({...S,totalWeeks:Number(j.target.value)})),disabled:!u.feeStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.feeStructure?"#222":"#333",color:u.feeStructure?"#fff":"#888",cursor:u.feeStructure?"text":"not-allowed"},min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Participation Fee ($)"}),e.jsxs("div",{style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#333",color:"#4CAF50",fontWeight:"bold",textAlign:"center"},children:["$",n.registrationFee+n.weeklyDues*n.totalWeeks,e.jsxs("div",{style:{fontSize:"12px",color:"#888",marginTop:"2px"},children:["Auto-calculated: $",n.registrationFee," + ($",n.weeklyDues,"  ",n.totalWeeks,")"]})]})]})]})}),e.jsx("div",{style:{marginTop:"10px",padding:"10px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"6px",border:"1px solid #4CAF50"},children:e.jsxs("div",{style:{color:"#4CAF50",fontSize:"14px"},children:[e.jsx("strong",{children:"Total Session Cost:"})," $",n.registrationFee+n.weeklyDues*n.totalWeeks,"(",n.registrationFee," + ",n.weeklyDues,"  ",n.totalWeeks," weeks)"]})}),u.feeStructure&&e.jsxs("div",{style:{marginTop:"15px",textAlign:"center",display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>f("Fee Structure",{registrationFee:n.registrationFee,weeklyDues:n.weeklyDues,totalWeeks:n.totalWeeks,participationFee:n.registrationFee+n.weeklyDues*n.totalWeeks}),disabled:i==="Fee Structure",style:{padding:"8px 20px",borderRadius:"6px",border:"none",background:i==="Fee Structure"?"#666":"#4CAF50",color:"#fff",cursor:i==="Fee Structure"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i==="Fee Structure"?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),i==="Fee Structure"?"Saving...":"Save Fee Structure"]}),e.jsx("button",{onClick:()=>x("feeStructure"),disabled:i==="Fee Structure",style:{padding:"8px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#ccc",cursor:i==="Fee Structure"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cancel"})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:"Penalty Structure"}),e.jsx("button",{onClick:()=>w("penaltyStructure"),style:{padding:"6px 12px",borderRadius:"4px",border:"none",background:u.penaltyStructure?"#ff9800":"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:u.penaltyStructure?" Cancel Edit":" Edit"})]}),e.jsx("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:u.penaltyStructure?"rgba(76, 175, 80, 0.05)":"rgba(255,255,255,0.02)",opacity:u.penaltyStructure?1:.8},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"1st Strike Fine ($)"}),e.jsx("input",{type:"number",value:n.penaltyStructure.strike1,onChange:j=>t(S=>({...S,penaltyStructure:{...S.penaltyStructure,strike1:Number(j.target.value)}})),disabled:!u.penaltyStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.penaltyStructure?"#222":"#333",color:u.penaltyStructure?"#fff":"#888",cursor:u.penaltyStructure?"text":"not-allowed"},min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"2nd Strike Fine ($)"}),e.jsx("input",{type:"number",value:n.penaltyStructure.strike2,onChange:j=>t(S=>({...S,penaltyStructure:{...S.penaltyStructure,strike2:Number(j.target.value)}})),disabled:!u.penaltyStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.penaltyStructure?"#222":"#333",color:u.penaltyStructure?"#fff":"#888",cursor:u.penaltyStructure?"text":"not-allowed"},min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"3rd Strike Fine ($)"}),e.jsx("input",{type:"number",value:n.penaltyStructure.strike3,onChange:j=>t(S=>({...S,penaltyStructure:{...S.penaltyStructure,strike3:Number(j.target.value)}})),disabled:!u.penaltyStructure,style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.penaltyStructure?"#222":"#333",color:u.penaltyStructure?"#fff":"#888",cursor:u.penaltyStructure?"text":"not-allowed"},min:"0",step:"0.01"})]})]})}),u.penaltyStructure&&e.jsxs("div",{style:{marginTop:"15px",textAlign:"center",display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>f("Penalty Structure",{penaltyStructure:n.penaltyStructure}),disabled:i==="Penalty Structure",style:{padding:"8px 20px",borderRadius:"6px",border:"none",background:i==="Penalty Structure"?"#666":"#4CAF50",color:"#fff",cursor:i==="Penalty Structure"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i==="Penalty Structure"?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),i==="Penalty Structure"?"Saving...":"Save Penalty Structure"]}),e.jsx("button",{onClick:()=>x("penaltyStructure"),disabled:i==="Penalty Structure",style:{padding:"8px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#ccc",cursor:i==="Penalty Structure"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cancel"})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:"Payment Methods"}),e.jsx("button",{onClick:()=>w("paymentMethods"),style:{padding:"6px 12px",borderRadius:"4px",border:"none",background:u.paymentMethods?"#ff9800":"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:u.paymentMethods?" Cancel Edit":" Edit"})]}),e.jsx("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:u.paymentMethods?"rgba(76, 175, 80, 0.05)":"rgba(255,255,255,0.02)",opacity:u.paymentMethods?1:.8},children:Object.entries(n.paymentMethods).map(([j,S])=>e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",background:"rgba(255,255,255,0.02)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[b(j),e.jsx("h4",{style:{color:"#fff",margin:0,flex:1},children:S.displayName}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("input",{type:"checkbox",checked:S.enabled,onChange:_=>m(j,"enabled",_.target.checked),disabled:!u.paymentMethods,style:{cursor:u.paymentMethods?"pointer":"not-allowed"}}),e.jsx("span",{style:{color:"#fff",fontSize:"14px"},children:"Enabled"})]})]}),S.enabled&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px"},children:[j==="venmo"&&e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Venmo Username"}),e.jsx("input",{type:"text",value:S.username,onChange:_=>m(j,"username",_.target.value),disabled:!u.paymentMethods,placeholder:"@username",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed"}})]}),j==="cashapp"&&e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Cash App Username"}),e.jsx("input",{type:"text",value:S.username,onChange:_=>m(j,"username",_.target.value),disabled:!u.paymentMethods,placeholder:"$username",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed"}})]}),(j==="creditCard"||j==="applePay"||j==="googlePay")&&e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Payment Link"}),e.jsx("input",{type:"url",value:S.paymentLink,onChange:_=>m(j,"paymentLink",_.target.value),disabled:!u.paymentMethods,placeholder:"https://...",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed"}})]}),j==="check"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Payee Name"}),e.jsx("input",{type:"text",value:S.payeeName,onChange:_=>m(j,"payeeName",_.target.value),disabled:!u.paymentMethods,placeholder:"Pay to the order of...",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Mailing Address"}),e.jsx("textarea",{value:S.mailingAddress,onChange:_=>m(j,"mailingAddress",_.target.value),disabled:!u.paymentMethods,placeholder:"Mailing address for checks...",rows:"3",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed",resize:"vertical"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Instructions"}),e.jsx("textarea",{value:S.instructions,onChange:_=>m(j,"instructions",_.target.value),disabled:!u.paymentMethods,placeholder:"Payment instructions...",rows:"2",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.paymentMethods?"#222":"#333",color:u.paymentMethods?"#fff":"#888",cursor:u.paymentMethods?"text":"not-allowed",resize:"vertical"}})]})]})]},j))}),u.paymentMethods&&e.jsxs("div",{style:{marginTop:"15px",textAlign:"center",display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>f("Payment Methods",{paymentMethods:n.paymentMethods}),disabled:i==="Payment Methods",style:{padding:"8px 20px",borderRadius:"6px",border:"none",background:i==="Payment Methods"?"#666":"#4CAF50",color:"#fff",cursor:i==="Payment Methods"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i==="Payment Methods"?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),i==="Payment Methods"?"Saving...":"Save Payment Methods"]}),e.jsx("button",{onClick:()=>x("paymentMethods"),disabled:i==="Payment Methods",style:{padding:"8px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#ccc",cursor:i==="Payment Methods"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cancel"})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:"Additional Instructions"}),e.jsx("button",{onClick:()=>w("additionalInstructions"),style:{padding:"6px 12px",borderRadius:"4px",border:"none",background:u.additionalInstructions?"#ff9800":"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:u.additionalInstructions?" Cancel Edit":" Edit"})]}),e.jsx("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:u.additionalInstructions?"rgba(76, 175, 80, 0.05)":"rgba(255,255,255,0.02)",opacity:u.additionalInstructions?1:.8},children:e.jsx("textarea",{value:n.additionalInstructions,onChange:j=>t(S=>({...S,additionalInstructions:j.target.value})),disabled:!u.additionalInstructions,placeholder:"Enter any additional payment instructions or notes for players...",rows:"4",style:{width:"100%",padding:"12px",borderRadius:"6px",border:"1px solid #444",background:u.additionalInstructions?"#222":"#333",color:u.additionalInstructions?"#fff":"#888",cursor:u.additionalInstructions?"text":"not-allowed",resize:"vertical",fontFamily:"inherit"}})}),u.additionalInstructions&&e.jsxs("div",{style:{marginTop:"15px",textAlign:"center",display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>f("Additional Instructions",{additionalInstructions:n.additionalInstructions}),disabled:i==="Additional Instructions",style:{padding:"8px 20px",borderRadius:"6px",border:"none",background:i==="Additional Instructions"?"#666":"#4CAF50",color:"#fff",cursor:i==="Additional Instructions"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i==="Additional Instructions"?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),i==="Additional Instructions"?"Saving...":"Save Additional Instructions"]}),e.jsx("button",{onClick:()=>x("additionalInstructions"),disabled:i==="Additional Instructions",style:{padding:"8px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#ccc",cursor:i==="Additional Instructions"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cancel"})]})]}),e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:"Contact Information"}),e.jsx("button",{onClick:()=>w("contactInfo"),style:{padding:"6px 12px",borderRadius:"4px",border:"none",background:u.contactInfo?"#ff9800":"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:u.contactInfo?" Cancel Edit":" Edit"})]}),e.jsx("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:u.contactInfo?"rgba(76, 175, 80, 0.05)":"rgba(255,255,255,0.02)",opacity:u.contactInfo?1:.8},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Admin Name"}),e.jsx("input",{type:"text",value:n.contactInfo.adminName,onChange:j=>v("adminName",j.target.value),disabled:!u.contactInfo,placeholder:"League Administrator Name",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.contactInfo?"#222":"#333",color:u.contactInfo?"#fff":"#888",cursor:u.contactInfo?"text":"not-allowed"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Admin Email"}),e.jsx("input",{type:"email",value:n.contactInfo.adminEmail,onChange:j=>v("adminEmail",j.target.value),disabled:!u.contactInfo,placeholder:"admin@example.com",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.contactInfo?"#222":"#333",color:u.contactInfo?"#fff":"#888",cursor:u.contactInfo?"text":"not-allowed"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Admin Phone"}),e.jsx("input",{type:"tel",value:n.contactInfo.adminPhone,onChange:j=>v("adminPhone",j.target.value),disabled:!u.contactInfo,placeholder:"(555) 123-4567",style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:u.contactInfo?"#222":"#333",color:u.contactInfo?"#fff":"#888",cursor:u.contactInfo?"text":"not-allowed"}})]})]})}),u.contactInfo&&e.jsxs("div",{style:{marginTop:"15px",textAlign:"center",display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsxs("button",{onClick:()=>f("Contact Information",{contactInfo:n.contactInfo}),disabled:i==="Contact Information",style:{padding:"8px 20px",borderRadius:"6px",border:"none",background:i==="Contact Information"?"#666":"#4CAF50",color:"#fff",cursor:i==="Contact Information"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i==="Contact Information"?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),i==="Contact Information"?"Saving...":"Save Contact Information"]}),e.jsx("button",{onClick:()=>x("contactInfo"),disabled:i==="Contact Information",style:{padding:"8px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#ccc",cursor:i==="Contact Information"?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:"Cancel"})]})]}),e.jsxs("div",{style:{marginTop:"40px",padding:"20px",border:"2px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",background:"rgba(76, 175, 80, 0.05)",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#4CAF50",marginBottom:"15px"},children:" Save All Changes"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"20px",fontSize:"14px"},children:"Use this button to save all configuration changes at once, or use the individual save buttons for each section above."}),e.jsxs("button",{onClick:g,disabled:a,style:{padding:"12px 30px",borderRadius:"8px",border:"none",background:a?"#666":"linear-gradient(135deg, #4CAF50, #45a049)",color:"#fff",cursor:a?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"10px",margin:"0 auto",boxShadow:a?"none":"0 4px 15px rgba(76, 175, 80, 0.3)",transition:"all 0.2s ease"},onMouseEnter:j=>{a||(j.target.style.transform="translateY(-2px)",j.target.style.boxShadow="0 6px 20px rgba(76, 175, 80, 0.4)")},onMouseLeave:j=>{a||(j.target.style.transform="translateY(0)",j.target.style.boxShadow="0 4px 15px rgba(76, 175, 80, 0.3)")},children:[a?e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}):e.jsx(pl,{}),a?"Saving All Changes...":"Save All Configuration"]})]})]})}function eV(){const[n,t]=y.useState([]),[r,s]=y.useState(!0),[a,o]=y.useState(""),[i,l]=y.useState("all"),[c,d]=y.useState(null),[u,h]=y.useState(!1),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState({amount:"",paymentType:"weekly_dues",paymentMethod:"cash",notes:"",date:new Date().toISOString().split("T")[0]}),[w,x]=y.useState({amount:"",reason:"",strikeLevel:"1",notes:"",date:new Date().toISOString().split("T")[0]}),[j,S]=y.useState({registrationFee:30,weeklyDues:10,totalWeeks:10,penaltyStructure:{strike1:5,strike2:10,strike3:0}});y.useEffect(()=>{_(),C()},[]);const _=async()=>{s(!0);try{console.log(" Loading players..."),console.log(" API URL:",`${Ie}/api/users/search?approved=true`);const k=await fetch(`${Ie}/api/users/search?approved=true&t=${Date.now()}`);if(k.ok){const R=await k.json();console.log(" Loaded players data:",R.users.length,"players");const U=R.users.find(Q=>Q.firstName==="Beta"&&Q.lastName==="Test User");if(U)console.log(" Raw Beta Test User data from API:",{id:U._id,firstName:U.firstName,lastName:U.lastName,paymentHistory:U.paymentHistory,paymentHistoryLength:U.paymentHistory?U.paymentHistory.length:"undefined"});else{console.log(" Beta Test User not found in raw data"),console.log("Available users:",R.users.map(H=>`${H.firstName} ${H.lastName}`)),console.log(" All users with IDs:",R.users.map(H=>({id:H._id,name:`${H.firstName} ${H.lastName}`,email:H.email})));const Q=R.users.filter(H=>!H.firstName||!H.lastName||H.firstName.trim()===""||H.lastName.trim()==="");Q.length>0&&(console.log(" Users with empty names found:",Q.length),Q.forEach((H,ue)=>{console.log(`   ${ue+1}. ID: ${H._id}`),console.log(`      Email: ${H.email||"No email"}`),console.log(`      First Name: "${H.firstName||"EMPTY"}"`),console.log(`      Last Name: "${H.lastName||"EMPTY"}"`)}))}const z=R.users.filter(Q=>Q.paymentHistory&&Q.paymentHistory.length>0);console.log(" Users with payment history:",z.length),z.length>0&&console.log(" First user with payments:",{name:`${z[0].firstName} ${z[0].lastName}`,paymentHistory:z[0].paymentHistory});const $=R.users.find(Q=>Q.email==="frbcapl@gmail.com");$?(console.log(" Found frbcapl@gmail.com user:",{id:$._id,name:`${$.firstName} ${$.lastName}`,email:$.email,paymentHistory:$.paymentHistory,paymentHistoryLength:$.paymentHistory?$.paymentHistory.length:0}),console.log(" Full frbcapl user object:",$),console.log(" frbcapl user keys:",Object.keys($)),console.log(" frbcapl paymentHistory field:",$.paymentHistory),console.log(" frbcapl paymentHistory type:",typeof $.paymentHistory)):console.log(" frbcapl@gmail.com user not found");const W=R.users.filter(Q=>Q.firstName&&Q.lastName&&Q.firstName.trim()&&Q.lastName.trim()).map(Q=>{const H={...Q,paymentHistory:Q.paymentHistory||[],penalties:Q.penalties||[]};return H.currentBalance=N(H),H.paymentStatus=M(H),H}),Y=W.find(Q=>Q.firstName==="Beta"&&Q.lastName==="Test User");Y&&(console.log(" Beta Test User found in loaded data:"),console.log("Payment history length:",Y.paymentHistory.length),console.log("Payment history:",Y.paymentHistory),console.log("Calculated balance:",Y.currentBalance),console.log("Payment status:",Y.paymentStatus)),t(W),console.log(" Players loaded and processed")}else console.error(" Failed to load players:",k.status)}catch(k){console.error("Error loading players:",k)}finally{s(!1)}},C=async()=>{try{const k=await fetch(`${Ie}/api/payment-config`);if(k.ok){const R=await k.json();R.config&&S({registrationFee:R.config.registrationFee||30,weeklyDues:R.config.weeklyDues||10,totalWeeks:R.config.totalWeeks||10,penaltyStructure:R.config.penaltyStructure||{strike1:5,strike2:10,strike3:0}})}}catch(k){console.error("Error loading fee config:",k)}},N=k=>{if(!j)return console.warn("feeConfig not loaded yet for balance calculation."),0;const R=(j.registrationFee||0)+(j.weeklyDues||0)*(j.totalWeeks||0),U=(k.paymentHistory||[]).reduce((W,Y)=>Y.paymentType==="registration_fee"||Y.paymentType==="weekly_dues"||Y.paymentType==="participation_fee"||Y.paymentType==="penalty"?W+(Y.amount||0):W,0),z=(k.penalties||[]).reduce((W,Y)=>W+(Y.amount||0),0),$=R-U+z;return console.log(`Balance for ${k.firstName} ${k.lastName}: Expected=${R}, Paid=${U}, Penalties=${z}, Balance=${$}`),$},M=k=>{const R=N(k);return R<=0?"paid":R<=20?"partial":"overdue"},E=n.filter(k=>{var z,$,W;const R=((z=k.firstName)==null?void 0:z.toLowerCase().includes(a.toLowerCase()))||(($=k.lastName)==null?void 0:$.toLowerCase().includes(a.toLowerCase()))||((W=k.email)==null?void 0:W.toLowerCase().includes(a.toLowerCase())),U=i==="all"||k.paymentStatus===i;return R&&U}),P=async()=>{if(!(!c||!v.amount))try{console.log("Adding payment for player:",c._id),console.log("Payment data:",v);const k=await fetch(`${Ie}/api/users/${c._id}/add-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(console.log("Response status:",k.status),k.ok){const R=await k.json();console.log("Payment added successfully:",R),console.log(" Payment result details:",{success:R.success,message:R.message,payment:R.payment,user:R.user}),h(!1),b({amount:"",paymentType:"weekly_dues",paymentMethod:"cash",notes:"",date:new Date().toISOString().split("T")[0]}),console.log(" Reloading players after payment..."),await _(),console.log(" Players reloaded after payment"),alert("Payment added successfully!")}else{const R=await k.json();console.error("Payment failed:",R);const U=R.message||R.error||"Unknown error";alert(`Error adding payment: ${U}`)}}catch(k){console.error("Error adding payment:",k),alert(`Error adding payment: ${k.message}`)}},D=async()=>{if(!(!c||!w.amount))try{(await fetch(`${Ie}/api/users/${c._id}/add-penalty`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).ok&&(g(!1),x({amount:"",reason:"",strikeLevel:"1",notes:"",date:new Date().toISOString().split("T")[0]}),_())}catch(k){console.error("Error adding penalty:",k)}},T=k=>{switch(k){case"paid":return"#4CAF50";case"partial":return"#FF9800";case"overdue":return"#f44336";default:return"#666"}},A=k=>{switch(k){case"paid":return e.jsx(va,{});case"partial":return e.jsx(RC,{});case"overdue":return e.jsx(Mm,{});default:return e.jsx(IC,{})}};return r?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx("div",{style:{animation:"spin 1s linear infinite"},children:""}),e.jsx("p",{children:"Loading payment data..."})]}):e.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("h2",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center"},children:" Payment Tracker"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"30px"},children:[e.jsxs("div",{style:{padding:"15px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid #4CAF50",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:n.filter(k=>k.paymentStatus==="paid").length}),e.jsx("div",{style:{color:"#fff"},children:"Fully Paid"})]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(255, 152, 0, 0.1)",borderRadius:"8px",border:"1px solid #FF9800",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#FF9800"},children:n.filter(k=>k.paymentStatus==="partial").length}),e.jsx("div",{style:{color:"#fff"},children:"Partial Payment"})]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(244, 67, 54, 0.1)",borderRadius:"8px",border:"1px solid #f44336",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#f44336"},children:n.filter(k=>k.paymentStatus==="overdue").length}),e.jsx("div",{style:{color:"#fff"},children:"Overdue"})]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(102, 102, 102, 0.1)",borderRadius:"8px",border:"1px solid #666",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#666"},children:["$",n.reduce((k,R)=>k+Math.max(0,R.currentBalance),0).toFixed(2)]}),e.jsx("div",{style:{color:"#fff"},children:"Total Outstanding"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"20px",flexWrap:"wrap"},children:[e.jsx("div",{style:{flex:"1",minWidth:"200px"},children:e.jsx("input",{type:"text",placeholder:"Search players...",value:a,onChange:k=>o(k.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"}})}),e.jsxs("select",{value:i,onChange:k=>l(k.target.value),style:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",minWidth:"150px"},children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"paid",children:"Fully Paid"}),e.jsx("option",{value:"partial",children:"Partial Payment"}),e.jsx("option",{value:"overdue",children:"Overdue"})]}),e.jsxs("button",{onClick:()=>{},style:{padding:"10px 15px",borderRadius:"6px",border:"none",background:"#4CAF50",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(gH,{})," Export"]})]}),e.jsx("div",{style:{display:"grid",gap:"15px"},children:E.map(k=>e.jsxs("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[e.jsxs("div",{style:{flex:"1",minWidth:"200px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"5px"},children:[e.jsx("span",{style:{color:T(k.paymentStatus),fontSize:"18px"},children:A(k.paymentStatus)}),e.jsxs("h4",{style:{color:"#fff",margin:0},children:[k.firstName," ",k.lastName]})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[k.email,"  ",k.phone||"No phone"]})]}),e.jsxs("div",{style:{textAlign:"center",minWidth:"120px"},children:[e.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold",color:k.currentBalance>0?"#f44336":"#4CAF50"},children:["$",k.currentBalance.toFixed(2)]}),e.jsx("div",{style:{color:"#ccc",fontSize:"12px"},children:k.currentBalance>0?"Owed":"Paid"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{d(k),h(!0)},style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Ms,{})," Payment"]}),e.jsxs("button",{onClick:()=>{d(k),g(!0)},style:{padding:"8px 12px",borderRadius:"4px",border:"none",background:"#f44336",color:"#fff",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Mm,{})," Penalty"]}),e.jsxs("button",{onClick:()=>{d(k),m(!0)},style:{padding:"8px 12px",borderRadius:"4px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Il,{})," Details"]})]})]},k._id))}),u&&c&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:9999,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{background:"#333",padding:"20px",borderRadius:"8px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto",margin:"auto"},children:[e.jsxs("h3",{style:{color:"#fff",marginBottom:"20px"},children:["Add Payment - ",c.firstName," ",c.lastName]}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Payment Type"}),e.jsxs("select",{value:v.paymentType,onChange:k=>{const R=k.target.value;let U=0;R==="registration_fee"?U=j.registrationFee:R==="weekly_dues"?U=j.weeklyDues:R==="participation_fee"&&(U=j.registrationFee+j.weeklyDues*j.totalWeeks),b(z=>({...z,paymentType:R,amount:U}))},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},children:[e.jsxs("option",{value:"registration_fee",children:["Registration Fee ($",j.registrationFee,")"]}),e.jsxs("option",{value:"weekly_dues",children:["Weekly Dues ($",j.weeklyDues,")"]}),e.jsxs("option",{value:"participation_fee",children:["Participation Fee ($",j.registrationFee+j.weeklyDues*j.totalWeeks,")"]}),e.jsx("option",{value:"penalty",children:"Penalty Payment"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Amount ($)"}),e.jsx("input",{type:"number",value:v.amount,onChange:k=>b(R=>({...R,amount:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Payment Method"}),e.jsxs("select",{value:v.paymentMethod,onChange:k=>b(R=>({...R,paymentMethod:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"venmo",children:"Venmo"}),e.jsx("option",{value:"credit_card",children:"Credit/Debit Card"}),e.jsx("option",{value:"check",children:"Check"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Date"}),e.jsx("input",{type:"date",value:v.date,onChange:k=>b(R=>({...R,date:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Notes"}),e.jsx("textarea",{value:v.notes,onChange:k=>b(R=>({...R,notes:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",minHeight:"60px",resize:"vertical"},placeholder:"Optional notes about this payment..."})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[e.jsx("button",{onClick:P,style:{padding:"10px 20px",borderRadius:"6px",border:"none",background:"#4CAF50",color:"#fff",cursor:"pointer",flex:"1"},children:"Add Payment"}),e.jsx("button",{onClick:()=>h(!1),style:{padding:"10px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",flex:"1"},children:"Cancel"})]})]})}),p&&c&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:9999,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{background:"#333",padding:"20px",borderRadius:"8px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto",margin:"auto"},children:[e.jsxs("h3",{style:{color:"#fff",marginBottom:"20px"},children:["Add Penalty - ",c.firstName," ",c.lastName]}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Strike Level"}),e.jsxs("select",{value:w.strikeLevel,onChange:k=>{const R=k.target.value;x(U=>({...U,strikeLevel:R,amount:R==="1"?j.penaltyStructure.strike1:R==="2"?j.penaltyStructure.strike2:R==="3"?j.penaltyStructure.strike3:0}))},style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},children:[e.jsxs("option",{value:"1",children:["Strike 1 - $",j.penaltyStructure.strike1," fine"]}),e.jsxs("option",{value:"2",children:["Strike 2 - $",j.penaltyStructure.strike2," fine"]}),e.jsxs("option",{value:"3",children:["Strike 3 - ",j.penaltyStructure.strike3>0?`$${j.penaltyStructure.strike3} fine`:"Removal"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Fine Amount ($)"}),e.jsx("input",{type:"number",value:w.amount,onChange:k=>x(R=>({...R,amount:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Reason"}),e.jsx("input",{type:"text",value:w.reason,onChange:k=>x(R=>({...R,reason:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},placeholder:"Reason for penalty..."})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Date"}),e.jsx("input",{type:"date",value:w.date,onChange:k=>x(R=>({...R,date:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Notes"}),e.jsx("textarea",{value:w.notes,onChange:k=>x(R=>({...R,notes:k.target.value})),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff",minHeight:"60px",resize:"vertical"},placeholder:"Additional details about the penalty..."})]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[e.jsx("button",{onClick:D,style:{padding:"10px 20px",borderRadius:"6px",border:"none",background:"#f44336",color:"#fff",cursor:"pointer",flex:"1"},children:"Add Penalty"}),e.jsx("button",{onClick:()=>g(!1),style:{padding:"10px 20px",borderRadius:"6px",border:"1px solid #666",background:"transparent",color:"#fff",cursor:"pointer",flex:"1"},children:"Cancel"})]})]})}),f&&c&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:9999,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{background:"#333",padding:"20px",borderRadius:"8px",maxWidth:"800px",width:"90%",maxHeight:"80vh",overflow:"auto",margin:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#fff",margin:0},children:["Payment Details - ",c.firstName," ",c.lastName]}),e.jsx("button",{onClick:()=>m(!1),style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer"},children:""})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#222",borderRadius:"6px"},children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"10px"},children:"Player Information"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[e.jsxs("div",{children:["Email: ",c.email]}),e.jsxs("div",{children:["Phone: ",c.phone||"Not provided"]}),e.jsxs("div",{children:["Current Balance: ",e.jsxs("span",{style:{color:c.currentBalance>0?"#f44336":"#4CAF50",fontWeight:"bold"},children:["$",c.currentBalance.toFixed(2)]})]}),e.jsxs("div",{children:["Payment Status: ",e.jsx("span",{style:{color:T(c.paymentStatus)},children:c.paymentStatus.toUpperCase()})]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"10px"},children:"Payment History"}),console.log(" Details Modal - selectedPlayer:",c),console.log(" Details Modal - paymentHistory:",c.paymentHistory),c.paymentHistory&&c.paymentHistory.length>0?e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:c.paymentHistory.map((k,R)=>e.jsxs("div",{style:{padding:"10px",marginBottom:"8px",background:"#222",borderRadius:"4px",border:"1px solid #444"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold"},children:["$",k.amount," - ",k.paymentType.replace("_"," ").toUpperCase()]}),e.jsx("div",{style:{color:"#ccc",fontSize:"12px"},children:new Date(k.date||k.timestamp).toLocaleDateString()})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"12px",marginTop:"5px"},children:["Method: ",k.paymentMethod,"  ",k.notes&&`Notes: ${k.notes}`]})]},R))}):e.jsx("div",{style:{color:"#ccc",fontStyle:"italic"},children:"No payment history found."})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"10px"},children:"Penalties"}),c.penalties&&c.penalties.length>0?e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:c.penalties.map((k,R)=>e.jsxs("div",{style:{padding:"10px",marginBottom:"8px",background:"#222",borderRadius:"4px",border:"1px solid #f44336"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{color:"#f44336",fontWeight:"bold"},children:["$",k.amount," - ",k.reason]}),e.jsx("div",{style:{color:"#ccc",fontSize:"12px"},children:new Date(k.date||k.timestamp).toLocaleDateString()})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"12px",marginTop:"5px"},children:["Strike Level: ",k.strikeLevel,"  ",k.notes&&`Notes: ${k.notes}`]})]},R))}):e.jsx("div",{style:{color:"#ccc",fontStyle:"italic"},children:"No penalties found."})]})]})})]})}function tV(){const[n,t]=y.useState({phase1Weeks:6,currentSession:{name:"Current Session",startDate:"",endDate:"",isActive:!0}}),[r,s]=y.useState(!0);y.useState(!1);const[a,o]=y.useState({type:"",text:""}),[i,l]=y.useState("phases"),[c,d]=y.useState([]),[u,h]=y.useState(""),[p,g]=y.useState([]),[f,m]=y.useState([]);y.useState({});const[v,b]=y.useState("");y.useEffect(()=>{w(),x(),j()},[]);const w=async()=>{try{const N=await fetch(`${Ie}/api/payment-config`);if(N.ok){const M=await N.json();M.config&&t({phase1Weeks:M.config.phase1Weeks||6,currentSession:{name:"Current Session",startDate:"",endDate:"",isActive:!0,...M.config.currentSession}})}}catch(N){console.error("Error loading league config:",N),o({type:"error",text:"Failed to load league configuration"})}finally{s(!1)}},x=async()=>{try{const N=await fetch(`${Ie}/admin/divisions`);if(N.ok){const M=await N.json();d(M),M.length>0&&h(M[0].name)}}catch(N){console.error("Error loading divisions:",N)}},j=async()=>{try{const N=await fetch(`${Ie}/api/users`);if(N.ok){const M=await N.json();g(M.filter(E=>E.isApproved)),m(M.filter(E=>E.isApproved&&(!E.divisions||E.divisions.length===0)))}}catch(N){console.error("Error loading players:",N)}},S=async(N,M)=>{try{(await fetch(`${Ie}/admin/user/${N}/add-division`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:M})})).ok?(o({type:"success",text:"Player added to division successfully!"}),j()):o({type:"error",text:"Failed to add player to division"})}catch(E){console.error("Error adding player to division:",E),o({type:"error",text:"Error adding player to division"})}},_=async(N,M)=>{try{(await fetch(`${Ie}/admin/user/${N}/remove-division`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:M})})).ok?(o({type:"success",text:"Player removed from division successfully!"}),j()):o({type:"error",text:"Failed to remove player from division"})}catch(E){console.error("Error removing player from division:",E),o({type:"error",text:"Error removing player from division"})}};if(r)return e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx(xa,{style:{animation:"spin 1s linear infinite"}}),e.jsx("p",{children:"Loading league configuration..."})]});const C=()=>{switch(i){case"phases":return e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx(Oi,{style:{color:"#4CAF50"}}),e.jsx("h3",{style:{color:"#fff",margin:0},children:"Phase Configuration"})]}),e.jsxs("div",{style:{padding:"20px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid #4CAF50",textAlign:"center"},children:[e.jsx(Fb,{style:{fontSize:"48px",color:"#4CAF50",marginBottom:"15px"}}),e.jsxs("p",{style:{color:"#4CAF50",margin:0,fontSize:"16px"},children:["Phase configuration is now part of the division creation process.",e.jsx("br",{}),'Use the "Divisions" tab to create new divisions with phase settings.']})]})]});case"rosters":return e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx(Zc,{style:{color:"#4CAF50"}}),e.jsx("h3",{style:{color:"#fff",margin:0},children:"Player Rosters"})]}),e.jsxs("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.02)"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Select Division"}),e.jsxs("select",{value:u,onChange:N=>h(N.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},children:[e.jsx("option",{value:"",children:"Choose a division..."}),c.map(N=>e.jsx("option",{value:N.name,children:N.name},N._id))]})]}),u&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{color:"#fff",marginBottom:"15px"},children:["Players in ",u]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:p.filter(N=>N.divisions&&N.divisions.includes(u)).length===0?e.jsx("p",{style:{color:"#888",textAlign:"center"},children:"No players in this division"}):p.filter(N=>N.divisions&&N.divisions.includes(u)).map(N=>e.jsxs("div",{style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",background:"rgba(255,255,255,0.02)",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{color:"#fff",margin:"0 0 5px 0"},children:[N.firstName," ",N.lastName]}),e.jsx("p",{style:{color:"#888",margin:0,fontSize:"12px"},children:N.email})]}),e.jsx("button",{onClick:()=>_(N._id,u),style:{padding:"4px 8px",borderRadius:"4px",border:"none",background:"#e53e3e",color:"#fff",cursor:"pointer",fontSize:"12px"},children:e.jsx(NH,{})})]},N._id))})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"15px"},children:"Available Players"}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:f.length===0?e.jsx("p",{style:{color:"#888",textAlign:"center"},children:"No available players"}):f.map(N=>e.jsxs("div",{style:{padding:"10px",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",background:"rgba(255,255,255,0.02)",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{color:"#fff",margin:"0 0 5px 0"},children:[N.firstName," ",N.lastName]}),e.jsx("p",{style:{color:"#888",margin:0,fontSize:"12px"},children:N.email})]}),e.jsx("button",{onClick:()=>S(N._id,u),style:{padding:"4px 8px",borderRadius:"4px",border:"none",background:"#4CAF50",color:"#fff",cursor:"pointer",fontSize:"12px"},children:e.jsx(Zc,{})})]},N._id))})]})]})]})]});case"standings":return e.jsxs("div",{style:{marginBottom:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[e.jsx(ql,{style:{color:"#4CAF50"}}),e.jsx("h3",{style:{color:"#fff",margin:0},children:"Standings Tracking"})]}),e.jsxs("div",{style:{padding:"15px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.02)"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px"},children:"Select Division"}),e.jsxs("select",{value:v,onChange:N=>b(N.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #444",background:"#222",color:"#fff"},children:[e.jsx("option",{value:"",children:"Choose a division..."}),c.map(N=>e.jsx("option",{value:N.name,children:N.name},N._id))]})]}),v&&e.jsxs("div",{children:[e.jsxs("h4",{style:{color:"#fff",marginBottom:"15px"},children:["Standings for ",v]}),e.jsxs("div",{style:{padding:"15px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"6px",border:"1px solid #4CAF50",textAlign:"center"},children:[e.jsx(Bx,{style:{fontSize:"48px",color:"#4CAF50",marginBottom:"10px"}}),e.jsxs("p",{style:{color:"#4CAF50",margin:0},children:["Standings tracking will be integrated with CSI LMS data.",e.jsx("br",{}),'Use the "Divisions" tab to sync standings from CSI LMS.']})]})]})]})]});default:return null}};return e.jsxs("div",{style:{padding:"20px",maxWidth:"1000px",margin:"0 auto"},children:[e.jsx("h2",{style:{color:"#e53e3e",marginBottom:"20px",textAlign:"center"},children:" League Management"}),a.text&&e.jsxs("div",{style:{padding:"10px 15px",borderRadius:"6px",marginBottom:"20px",background:a.type==="success"?"rgba(76, 175, 80, 0.2)":"rgba(229, 62, 62, 0.2)",border:`1px solid ${a.type==="success"?"#4CAF50":"#e53e3e"}`,color:a.type==="success"?"#4CAF50":"#e53e3e",display:"flex",alignItems:"center",gap:"10px"},children:[a.type==="success"?e.jsx(va,{}):e.jsx(kf,{}),a.text]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>l("phases"),style:{padding:"10px 20px",borderRadius:"6px",border:"none",background:i==="phases"?"#4CAF50":"#333",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Oi,{})," Phase Configuration"]}),e.jsxs("button",{onClick:()=>l("rosters"),style:{padding:"10px 20px",borderRadius:"6px",border:"none",background:i==="rosters"?"#4CAF50":"#333",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Zc,{})," Player Rosters"]}),e.jsxs("button",{onClick:()=>l("standings"),style:{padding:"10px 20px",borderRadius:"6px",border:"none",background:i==="standings"?"#4CAF50":"#333",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ql,{})," Standings Tracking"]})]}),C()]})}const rV=async n=>{try{const{data:t,error:r}=await K.from("users").select("auth_provider").eq("id",n).single();return r?(console.error("Error checking OAuth user:",r),!1):(t==null?void 0:t.auth_provider)&&t.auth_provider!=="email"}catch(t){return console.error("Error checking OAuth user:",t),!1}},Wb=({onClose:n,onPlayerApproved:t,userToken:r})=>{const s=r||localStorage.getItem("authToken");console.log(" LadderApplicationsManager auth token:",s?"Present":"Missing");const[a,o]=y.useState([]),[i,l]=y.useState(!0),[c,d]=y.useState(""),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState(null),[w,x]=y.useState(null),[j,S]=y.useState("499-under");y.useEffect(()=>{_()},[]);const _=async()=>{try{l(!0);const P=await mt.getLadderApplications();P.success?o(P.applications):d(P.error||"Failed to fetch applications")}catch(P){console.error("Error fetching applications:",P),d("Network error. Please check your connection.")}finally{l(!1)}},C=async P=>{var D,T,A,k,R,U,z,$;try{g(!0);const W=await mt.approveUser(P);if(!W.success)throw new Error("Failed to approve user");const Y=await mt.addUserToLadder(P,j);if(!Y.success)throw new Error("Failed to add user to ladder");const Q={success:!0,playerCreated:W.user,ladderProfile:Y.ladderProfile};if(Q.success){const H=await rV((D=Q.playerCreated)==null?void 0:D.id);if(H)console.log(" OAuth user detected - skipping password reset email");else try{const{data:ue,error:J}=await K.auth.resetPasswordForEmail((T=Q.playerCreated)==null?void 0:T.email,{redirectTo:`${window.location.origin}/#/reset-password`});J?console.error("Failed to send password reset:",J):console.log(" Password reset email sent successfully")}catch(ue){console.error("Failed to send password reset:",ue)}try{let ue=null;H&&(ue=((A=Q.playerCreated)==null?void 0:A.auth_provider)||"oauth");const J={to_email:(k=Q.playerCreated)==null?void 0:k.email,to_name:`${(R=Q.playerCreated)==null?void 0:R.firstName} ${(U=Q.playerCreated)==null?void 0:U.lastName}`,ladder_name:((z=Q.ladderProfile)==null?void 0:z.ladder_name)||"499-under",position:(($=Q.ladderProfile)==null?void 0:$.position)||"TBD",app_url:window.location.origin,isOAuthUser:H,authProvider:ue};console.log(" Attempting to send approval email with data:",J);const be=await fetch(`${Ie}/api/email/send-ladder-approval`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),Ae=await be.json();console.log(" Email response:",Ae),be.ok?(x("sent"),console.log(" Ladder approval email sent successfully")):(x("failed"),console.error(" Email sending failed:",Ae))}catch(ue){console.error(" Email sending failed:",ue),x("failed")}b(Q.playerCreated),m(!0),await _(),h(null),t&&t()}}catch(W){console.error("Error approving application:",W),d("Network error. Please try again.")}finally{g(!1)}},N=async(P,D)=>{try{g(!0);const T=await mt.rejectUser(P);T.success?(await _(),h(null)):d(T.error||"Failed to reject application")}catch(T){console.error("Error rejecting application:",T),d("Network error. Please try again.")}finally{g(!1)}},M=P=>{switch(P){case"pending":return"#ffa726";case"approved":return"#4caf50";case"rejected":return"#f44336";default:return"#757575"}},E=P=>{switch(P){case"pending":return" Pending";case"approved":return" Approved";case"rejected":return" Rejected";default:return"Unknown"}};return xr.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(It,{open:!0,onClose:n,title:" Pending Ladder Applications",maxWidth:"95vw",maxHeight:"95vh",borderColor:"#8b5cf6",textColor:"#ffffff",glowColor:"#8b5cf6",style:{width:"95vw",height:"95vh"},children:e.jsxs("div",{style:{display:"flex",height:"100%",gap:"1rem",padding:"1rem"},children:[e.jsxs("div",{style:{flex:"1",minWidth:"500px"},children:[c&&e.jsx("div",{style:{background:"rgba(244, 67, 54, 0.2)",border:"1px solid rgba(244, 67, 54, 0.5)",color:"#ff6b6b",padding:"0.8rem",borderRadius:"8px",marginBottom:"1rem",fontSize:"1rem"},children:c}),i?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#fff",fontSize:"1.2rem"},children:"Loading applications..."}):a.length===0?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#ccc",fontSize:"1.2rem"},children:"No pending applications"}):e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",textAlign:"center"},children:[e.jsxs("h3",{style:{color:"#8b5cf6",margin:"0 0 0.5rem 0",fontSize:"1.1rem"},children:[" ",a.length," Pending Application",a.length!==1?"s":""]}),e.jsx("p",{style:{color:"#ccc",margin:0,fontSize:"0.9rem"},children:"Click on an application to view details and take action"})]}),e.jsx("div",{style:{maxHeight:"calc(95vh - 200px)",overflowY:"auto"},children:a.map((P,D)=>e.jsxs("div",{onClick:()=>h(P),style:{background:(u==null?void 0:u.id)===P.id?"rgba(139, 92, 246, 0.15)":"rgba(255, 255, 255, 0.05)",border:(u==null?void 0:u.id)===P.id?"2px solid #8b5cf6":"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1rem",marginBottom:"0.75rem",cursor:"pointer",transition:"all 0.3s ease",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{color:"#fff",margin:"0 0 0.25rem 0",fontSize:"1.1rem",fontWeight:"bold"},children:[P.firstName," ",P.lastName]}),e.jsx("p",{style:{color:"#ccc",margin:0,fontSize:"0.85rem"},children:P.email})]}),e.jsx("div",{style:{background:M(P.status),color:"white",padding:"0.25rem 0.75rem",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"bold"},children:E(P.status)})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.75rem",fontSize:"0.85rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#8b5cf6",fontWeight:"bold",marginBottom:"0.25rem"},children:" Experience"}),e.jsx("div",{style:{color:"#fff",textTransform:"capitalize"},children:P.experience})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#8b5cf6",fontWeight:"bold",marginBottom:"0.25rem"},children:" League"}),e.jsx("div",{style:{color:P.currentLeague&&P.currentLeague!=="Not provided"?"#4CAF50":"#ff9800",fontWeight:"bold"},children:P.currentLeague&&P.currentLeague!=="Not provided"?` ${P.currentLeague}`:" No League"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#8b5cf6",fontWeight:"bold",marginBottom:"0.25rem"},children:" Payment"}),e.jsx("div",{style:{color:P.payNow?"#4CAF50":"#ff9800",fontWeight:"bold"},children:P.payNow===void 0?e.jsxs("div",{children:[e.jsx("div",{children:" Unknown"}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#ccc"},children:"Older App"})]}):P.payNow?e.jsxs("div",{children:[e.jsx("div",{children:" $5/month"}),P.paymentMethod&&e.jsxs("div",{style:{fontSize:"0.7rem",color:"#ccc"},children:[P.paymentMethod==="venmo"&&" Venmo",P.paymentMethod==="cashapp"&&" Cash App",P.paymentMethod==="creditCard"&&" Card",P.paymentMethod==="applePay"&&" Apple Pay",P.paymentMethod==="googlePay"&&" Google Pay",P.paymentMethod==="cash"&&" Cash",P.paymentMethod==="check"&&" Check",!["venmo","cashapp","creditCard","applePay","googlePay","cash","check"].includes(P.paymentMethod)&&P.paymentMethod]})]}):" Free"})]})]}),e.jsx("div",{style:{marginTop:"0.75rem",textAlign:"center"},children:e.jsx("button",{onClick:T=>{T.stopPropagation(),(u==null?void 0:u.id)===P.id?h(null):h(P)},disabled:p,style:{padding:"0.5rem 1rem",background:(u==null?void 0:u.id)===P.id?"rgba(244, 67, 54, 0.2)":"rgba(139, 92, 246, 0.2)",color:(u==null?void 0:u.id)===P.id?"#ff6b6b":"#8b5cf6",border:(u==null?void 0:u.id)===P.id?"1px solid #ff6b6b":"1px solid #8b5cf6",borderRadius:"8px",fontSize:"0.85rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",minWidth:"120px"},children:(u==null?void 0:u._id)===P._id?"Hide Details":"View Details"})})]},P.id))})]})]}),e.jsx("div",{style:{flex:"1",minWidth:"500px",background:"rgba(255, 255, 255, 0.02)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)",height:"calc(95vh - 120px)",overflowY:"auto"},children:u?e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#fff",margin:"0 0 1.5rem 0",fontSize:"1.3rem",borderBottom:"2px solid #8b5cf6",paddingBottom:"0.5rem"},children:[" ",u.firstName," ",u.lastName]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#8b5cf6",margin:"0 0 1rem 0",fontSize:"1rem",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",paddingBottom:"0.5rem"},children:" Personal Information"}),e.jsxs("div",{style:{color:"#fff",lineHeight:"1.8"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Name:"}),e.jsxs("span",{style:{marginLeft:"0.5rem"},children:[u.firstName," ",u.lastName]})]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Email:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"#ccc"},children:u.email})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Phone:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"#ccc"},children:u.phone||"Not provided"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#8b5cf6",margin:"0 0 1rem 0",fontSize:"1rem",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",paddingBottom:"0.5rem"},children:" Skill Information"}),e.jsxs("div",{style:{color:"#fff",lineHeight:"1.8"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Experience:"}),e.jsx("span",{style:{marginLeft:"0.5rem",textTransform:"capitalize"},children:u.experience})]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Fargo Rate:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"#ccc"},children:u.fargoRate||"Not provided"})]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"League:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:u.currentLeague&&u.currentLeague!=="Not provided"?"#4CAF50":"#ff9800",fontWeight:"bold"},children:u.currentLeague&&u.currentLeague!=="Not provided"?` ${u.currentLeague}`:" Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Current Ranking:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"#ccc"},children:u.currentRanking||"Not provided"})]})]})]})]}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"1.5rem"},children:[e.jsx("h4",{style:{color:"#8b5cf6",margin:"0 0 1rem 0",fontSize:"1rem",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",paddingBottom:"0.5rem"},children:" Payment Information"}),e.jsxs("div",{style:{color:"#fff",lineHeight:"1.8"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Payment Required:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:u.payNow?"#4CAF50":"#ff9800",fontWeight:"bold"},children:u.payNow?" Yes - $5/month":" No - Free Access"})]}),u.paymentMethod&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"#8b5cf6",fontWeight:"bold"},children:"Payment Method:"}),e.jsxs("span",{style:{marginLeft:"0.5rem",color:"#4CAF50",fontWeight:"bold"},children:[u.paymentMethod==="venmo"&&" Venmo",u.paymentMethod==="cashapp"&&" Cash App",u.paymentMethod==="creditCard"&&" Credit Card",u.paymentMethod==="applePay"&&" Apple Pay",u.paymentMethod==="googlePay"&&" Google Pay",u.paymentMethod==="cash"&&" Cash",u.paymentMethod==="check"&&" Check",!["venmo","cashapp","creditCard","applePay","googlePay","cash","check"].includes(u.paymentMethod)&&u.paymentMethod]})]})]})]})]}),(u.status==="pending"||u.is_pending_approval)&&e.jsxs("div",{style:{borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"1.5rem"},children:[e.jsx("h4",{style:{color:"#8b5cf6",margin:"0 0 1rem 0",fontSize:"1rem",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",paddingBottom:"0.5rem"},children:" Admin Actions"}),e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"8px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[e.jsx("label",{style:{display:"block",color:"#8b5cf6",fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9rem"},children:" Select Ladder for Approval:"}),e.jsxs("select",{value:j,onChange:P=>S(P.target.value),style:{width:"100%",padding:"0.75rem",background:"rgba(0, 0, 0, 0.3)",color:"#fff",border:"1px solid rgba(139, 92, 246, 0.5)",borderRadius:"6px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-599",children:"550-599"}),e.jsx("option",{value:"600-plus",children:"600+"}),e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("button",{onClick:()=>N(u.id),disabled:p,style:{padding:"0.75rem 1.5rem",background:"rgba(244, 67, 54, 0.2)",color:"#ff6b6b",border:"1px solid #ff6b6b",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",minWidth:"120px"},children:p?" Processing...":" Reject"}),e.jsx("button",{onClick:()=>C(u.id),disabled:p,style:{padding:"0.75rem 1.5rem",background:"linear-gradient(45deg, #8b5cf6, #7c3aed)",color:"white",border:"1px solid #8b5cf6",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",minWidth:"120px",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)"},children:p?" Processing...":" Approve"})]}),e.jsx("p",{style:{color:"#ccc",textAlign:"center",margin:0,fontSize:"0.85rem",fontStyle:"italic"},children:"Approving will also activate their unified account for league access"})]})]}):e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#ccc",fontSize:"1.2rem",textAlign:"center"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),e.jsx("div",{children:"Select an application from the list to view details"})]})})})]})}),f&&v&&e.jsx(It,{open:f,onClose:()=>m(!1),title:" Application Approved - Login Credentials",maxWidth:"500px",children:e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:" Application Approved!"}),e.jsx("p",{style:{margin:0,fontSize:"1rem"},children:"Player has been added to the ladder and can now log in."})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{color:"#2196F3",margin:"0 0 1rem 0"},children:" Login Credentials:"}),e.jsxs("div",{style:{color:"#ccc"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Email:"})," ",v.email]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"PIN:"})," ",e.jsx("span",{style:{background:"rgba(255, 255, 255, 0.1)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontFamily:"monospace"},children:v.pin})]})]})]}),w&&e.jsx("div",{style:{background:w==="sent"?"rgba(76, 175, 80, 0.2)":"rgba(244, 67, 54, 0.2)",border:`1px solid ${w==="sent"?"rgba(76, 175, 80, 0.5)":"rgba(244, 67, 54, 0.5)"}`,color:w==="sent"?"#4CAF50":"#ff6b6b",padding:"0.8rem",borderRadius:"8px",marginBottom:"1rem",fontSize:"0.9rem"},children:w==="sent"?" Email notification sent successfully":" Failed to send email notification"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"1rem"},children:e.jsx("button",{onClick:()=>m(!1),style:{padding:"0.8rem 1.5rem",background:"rgba(33, 150, 243, 0.2)",color:"#2196F3",border:"1px solid #2196F3",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},children:"Close"})})]})})]}),document.body)};const nV=()=>{const[n,t]=y.useState("pending"),[r,s]=y.useState([]),[a,o]=y.useState([]),[i,l]=y.useState(!1),[c,d]=y.useState(""),[u,h]=y.useState(null),[p,g]=y.useState(!1);y.useEffect(()=>{f(),m()},[]);const f=async()=>{l(!0);try{const S=await mt.getPendingUsers();S.success&&s(S.users)}catch(S){console.error("Error fetching pending users:",S)}finally{l(!1)}},m=async()=>{try{const S=await mt.getAllUsersForAdmin();S.success&&o(S.users)}catch(S){console.error("Error fetching all users:",S)}},v=async(S,_)=>{try{if(!(await mt.approveUser(S)).success)throw new Error("Failed to approve user");(await mt.addUserToLadder(S,"499-under")).success?(alert(" User approved and added to ladder successfully!"),f(),m()):(alert(" User approved but failed to add to ladder. You may need to add them manually."),f(),m())}catch(C){console.error("Error approving user:",C),alert(" Error approving user: "+C.message)}},b=async S=>{if(confirm("Are you sure you want to reject this user?"))try{if((await mt.rejectUser(S)).success)alert(" User rejected successfully"),f(),m();else throw new Error("Failed to reject user")}catch(_){console.error("Error rejecting user:",_),alert(" Error rejecting user: "+_.message)}},w=async S=>{if(confirm("Are you sure you want to reactivate this user account?"))try{if((await mt.updateAdminUser(S,{isActive:!0})).success)alert(" User account reactivated successfully!"),f(),m();else throw new Error("Failed to reactivate user")}catch(_){console.error("Error reactivating user:",_),alert(" Error reactivating user: "+_.message)}},x=async(S,_)=>{if(confirm(`Are you sure you want to deactivate "${_}"? They will be deactivated but can be reactivated later.`))try{if((await mt.updateAdminUser(S,{isActive:!1})).success)alert(` "${_}" has been deactivated successfully. They can be reactivated later if needed.`),f(),m();else throw new Error("Failed to deactivate user")}catch(C){console.error("Error deactivating user:",C),alert(" Error deactivating user: "+C.message)}},j=a.filter(S=>S.firstName.toLowerCase().includes(c.toLowerCase())||S.lastName.toLowerCase().includes(c.toLowerCase())||S.email.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"simplified-admin-dashboard",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h2",{children:" Simplified Admin Dashboard"}),r.length>0&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #ff6b6b, #ee5a6f)",color:"white",padding:"20px",borderRadius:"10px",marginBottom:"20px",textAlign:"center",boxShadow:"0 4px 15px rgba(255, 107, 107, 0.4)",animation:"pulse 2s infinite"},children:[e.jsxs("h2",{style:{margin:"0 0 10px 0",fontSize:"1.5rem"},children:[" ",r.length," User",r.length!==1?"s":""," Waiting for Approval!"]}),e.jsx("p",{style:{margin:"0",fontSize:"1rem",opacity:.95},children:"Click the button below to review and approve them"})]}),e.jsxs("div",{className:"tab-buttons",children:[e.jsxs("button",{className:`tab-button ${n==="pending"?"active":""}`,onClick:()=>t("pending"),style:r.length>0?{background:n==="pending"?"#ff6b6b":"#ff8787",border:"2px solid #ff6b6b",fontWeight:"bold",fontSize:"1.1rem",animation:r.length>0?"pulse 2s infinite":"none"}:{},children:[" Pending Approvals ",r.length>0&&`(${r.length}) `]}),e.jsxs("button",{className:`tab-button ${n==="all"?"active":""}`,onClick:()=>t("all"),children:[" All Users (",a.length,")"]})]})]}),e.jsxs("div",{className:"dashboard-content",children:[n==="pending"&&e.jsxs("div",{className:"pending-section",children:[e.jsx("h3",{children:" Users Pending Approval"}),i?e.jsx("div",{className:"loading",children:"Loading pending users..."}):r.length===0?e.jsx("div",{className:"empty-state",children:" No pending approvals! All caught up."}):e.jsx("div",{className:"user-cards",children:r.map(S=>e.jsxs("div",{className:"user-card pending",children:[e.jsxs("div",{className:"user-header",children:[e.jsxs("h4",{children:[S.firstName," ",S.lastName]}),e.jsx("span",{className:"status-badge pending",children:"PENDING"})]}),e.jsxs("div",{className:"user-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" Email:"})," ",S.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Phone:"})," ",S.phone||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Registered:"})," ",new Date(S.createdAt).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:" PIN:"})," ",S.pin]})]}),e.jsxs("div",{className:"user-actions",children:[e.jsx("button",{className:"approve-btn",onClick:()=>v(S._id),children:" Approve & Add to Ladder"}),e.jsx("button",{className:"reject-btn",onClick:()=>b(S._id),children:" Reject"}),e.jsx("button",{className:"soft-delete-btn",onClick:()=>x(S._id,`${S.firstName} ${S.lastName}`),children:" Remove"}),e.jsx("button",{className:"details-btn",onClick:()=>{h(S),g(!0)},children:" View Details"})]})]},S._id))})]}),n==="all"&&e.jsxs("div",{className:"all-users-section",children:[e.jsx("div",{className:"search-bar",children:e.jsx("input",{type:"text",placeholder:" Search users by name or email...",value:c,onChange:S=>d(S.target.value),className:"search-input"})}),e.jsx("div",{className:"user-cards",children:j.map(S=>e.jsxs("div",{className:`user-card ${S.isActive?"active":"inactive"}`,children:[e.jsxs("div",{className:"user-header",children:[e.jsxs("h4",{children:[S.firstName," ",S.lastName]}),e.jsx("span",{className:`status-badge ${S.isActive?"active":"inactive"}`,children:S.isActive?"ACTIVE":"INACTIVE"})]}),e.jsxs("div",{className:"user-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:" Email:"})," ",S.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Phone:"})," ",S.phone||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Registered:"})," ",new Date(S.createdAt).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:" PIN:"})," ",S.pin]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Approved:"})," ",S.isApproved?"Yes":"No"]})]}),e.jsxs("div",{className:"user-actions",children:[e.jsx("button",{className:"details-btn",onClick:()=>{h(S),g(!0)},children:" View Details"}),!S.isActive&&e.jsx("button",{className:"reactivate-btn",onClick:()=>w(S._id),children:" Reactivate Account"}),e.jsx("button",{className:"soft-delete-btn",onClick:()=>x(S._id,`${S.firstName} ${S.lastName}`),children:" Remove"})]})]},S._id))})]})]}),p&&u&&xr.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:e.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:" User Details"}),e.jsx("button",{className:"close-btn",onClick:()=>g(!1),children:""})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"detail-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Name:"})," ",u.firstName," ",u.lastName]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Email:"})," ",u.email]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Phone:"})," ",u.phone||"Not provided"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"PIN:"})," ",u.pin]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Status:"})," ",u.isActive?"Active":"Inactive"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Approved:"})," ",u.isApproved?"Yes":"No"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Registered:"})," ",new Date(u.createdAt).toLocaleString()]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Last Updated:"})," ",new Date(u.updatedAt).toLocaleString()]})]})})]})}),document.body)]})};class sV{constructor(){this.backendUrl=Ie}async getAllUsers(){try{const t=await fetch(`${this.backendUrl}/api/unified-auth/all-users`,{method:"GET",headers:{"Content-Type":"application/json"}}),r=await t.json();if(t.ok&&r.success)return r.users||[];throw new Error(r.message||"Failed to get users")}catch(t){throw console.error("Get all unified users error:",t),t}}async searchUsers(t){try{const r=await fetch(`${this.backendUrl}/api/unified-auth/search-users?q=${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await r.json();if(r.ok&&s.success)return s.users||[];throw new Error(s.message||"Failed to search users")}catch(r){throw console.error("Search unified users error:",r),r}}async getUserData(t){try{const r=await fetch(`${this.backendUrl}/api/unified-auth/user-profile/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await r.json();if(r.ok&&s.success)return{user:s.user,leagueProfile:s.leagueProfile,ladderProfile:s.ladderProfile};throw new Error(s.message||"Failed to get user data")}catch(r){throw console.error("Get unified user data error:",r),r}}async addUser(t){try{const r=await fetch(`${this.backendUrl}/api/unified-auth/admin/add-user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await r.json();if(r.ok&&s.success)return s.user;throw new Error(s.message||"Failed to add user")}catch(r){throw console.error("Add unified user error:",r),r}}async updateUser(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/update-user/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();if(s.ok&&a.success)return a.user;throw new Error(a.message||"Failed to update user")}catch(s){throw console.error("Update unified user error:",s),s}}async deleteUser(t){try{const r=await fetch(`${this.backendUrl}/api/unified-auth/admin/delete-user/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),s=await r.json();if(r.ok&&s.success)return!0;throw new Error(s.message||"Failed to delete user")}catch(r){throw console.error("Delete unified user error:",r),r}}async addUserDivision(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/add-division/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:r})}),a=await s.json();if(s.ok&&a.success)return!0;throw new Error(a.message||"Failed to add division")}catch(s){throw console.error("Add user division error:",s),s}}async removeUserDivision(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/remove-division/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:r})}),a=await s.json();if(s.ok&&a.success)return!0;throw new Error(a.message||"Failed to remove division")}catch(s){throw console.error("Remove user division error:",s),s}}async approveUser(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/approve-user/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();if(s.ok&&a.success)return a.user;throw new Error(a.message||"Failed to approve user")}catch(s){throw console.error("Approve unified user error:",s),s}}async deactivateUser(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/deactivate-user/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:r})}),a=await s.json();if(s.ok&&a.success)return a.user;throw new Error(a.message||"Failed to deactivate user")}catch(s){throw console.error("Deactivate unified user error:",s),s}}async getSystemStats(){try{const t=await fetch(`${this.backendUrl}/api/unified-auth/admin/system-stats`,{method:"GET",headers:{"Content-Type":"application/json"}}),r=await t.json();if(t.ok&&r.success)return r.stats;throw new Error(r.message||"Failed to get system stats")}catch(t){throw console.error("Get unified system stats error:",t),t}}async getPendingApprovals(){try{const t=await fetch(`${this.backendUrl}/api/unified-auth/admin/pending-approvals`,{method:"GET",headers:{"Content-Type":"application/json"}}),r=await t.json();if(t.ok&&r.success)return r.approvals||[];throw new Error(r.message||"Failed to get pending approvals")}catch(t){throw console.error("Get pending unified approvals error:",t),t}}async linkUserProfiles(t,r){try{const s=await fetch(`${this.backendUrl}/api/unified-auth/admin/link-profiles/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await s.json();if(s.ok&&a.success)return a.user;throw new Error(a.message||"Failed to link profiles")}catch(s){throw console.error("Link user profiles error:",s),s}}async getUserActivityLog(t){try{const r=await fetch(`${this.backendUrl}/api/unified-auth/admin/user-activity/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}}),s=await r.json();if(r.ok&&s.success)return s.activity||[];throw new Error(s.message||"Failed to get user activity")}catch(r){throw console.error("Get user activity log error:",r),r}}}const sl=new sV,aV={}.VITE_STREAM_API_KEY,t2="frbcaplgmailcom";function oV({backendUrl:n,onComplete:t}){const[r,s]=y.useState(1),[a,o]=y.useState({name:"",description:"",scheduleUrl:"",standingsUrl:"",seasonStart:"",phase1Weeks:6,phase2Weeks:4,totalWeeks:10}),[i,l]=y.useState(!1),[c,d]=y.useState(""),u=[{id:1,title:"Create Division in CSI LMS",description:"First, create the division in the CSI LMS software",instructions:["1. Log into CSI LMS at https://lms.fargorate.com","2. Navigate to League Management","3. Create a new division with your desired name","4. Set up the division settings and rules","5. Make sure the division is active and ready for players"],completed:!1},{id:2,title:"Get Division URLs",description:"Copy the schedule and standings URLs from CSI LMS",instructions:["1. In CSI LMS, go to the division you just created","2. Click on the 'Reports' link in the navigation","3. Click the 'Schedule' button","4. Copy the URL from the schedule report page","5. Click the 'Teams' button","6. Copy the URL from the teams report page","7. Both URLs should look like: https://lms.fargorate.com/PublicReport/LeagueReports?..."],completed:!1},{id:3,title:"Configure Phase Settings",description:"Set up the division's phase structure and session dates",instructions:["1. Set the total number of weeks for the session","2. Configure how many weeks Phase 1 should last","3. Phase 2 weeks will be calculated automatically","4. Set the session start date","5. Review the calculated phase dates"],completed:!1},{id:4,title:"Add Division to App",description:"Create the division in your app with the URLs",instructions:["1. Enter the division name (exactly as in CSI LMS)","2. Add a description (optional)","3. Paste the schedule URL from CSI LMS","4. Paste the standings URL from CSI LMS","5. Click 'Create Division'"],completed:!1},{id:5,title:"Test Data Sync",description:"Verify the division is working correctly",instructions:["1. Click 'Update Schedule' to sync match data","2. Click 'Update Standings' to sync player rankings","3. Verify data appears correctly in the app","4. Test the division in the main dashboard"],completed:!1}],h=(f,m)=>{o(v=>({...v,[f]:m}))},p=async()=>{l(!0),d("");try{const f=await fetch(`${n}/api/seasons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name,division:a.name,description:a.description,scheduleUrl:a.scheduleUrl,standingsUrl:a.standingsUrl,seasonStart:a.seasonStart})}),m=await f.json();if(f.ok){try{const v=await fetch(`${n}/admin/divisions`);if(v.ok){const w=(await v.json()).find(x=>x.name===a.name);w&&await fetch(`${n}/api/division-config/${w._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({phase1Weeks:a.phase1Weeks,phase2Weeks:a.phase2Weeks,totalWeeks:a.totalWeeks,currentSession:{name:`${a.name} Session`,startDate:a.seasonStart,endDate:null,isActive:!0}})})}}catch(v){console.error("Error saving phase configuration:",v)}d(" Division created successfully with phase configuration!"),s(5),t&&t()}else d(" "+(m.error||"Failed to create division."))}catch(f){d(" Failed to create division: "+f.message)}l(!1)},g=()=>{switch(r){case 1:return e.jsxs("div",{className:se.workflowStep,children:[e.jsx("div",{className:se.stepInstructions,children:u[0].instructions.map((f,m)=>e.jsx("div",{className:se.instructionItem,children:f},m))}),e.jsx("div",{className:se.stepActions,children:e.jsxs("button",{className:se.workflowButton,onClick:()=>s(2),children:[e.jsx(Cl,{})," I've Created the Division in CSI LMS"]})})]});case 2:return e.jsxs("div",{className:se.workflowStep,children:[e.jsx("div",{className:se.stepInstructions,children:u[1].instructions.map((f,m)=>e.jsx("div",{className:se.instructionItem,children:f},m))}),e.jsx("div",{className:se.stepActions,children:e.jsxs("button",{className:se.workflowButton,onClick:()=>s(3),children:[e.jsx(Cl,{})," I Have the URLs Ready"]})})]});case 3:return e.jsxs("div",{className:se.workflowStep,children:[e.jsx("div",{className:se.stepInstructions,children:u[2].instructions.map((f,m)=>e.jsx("div",{className:se.instructionItem,children:f},m))}),e.jsxs("div",{className:se.divisionForm,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px",fontSize:"14px"},children:"Total Weeks"}),e.jsx("input",{type:"number",value:a.totalWeeks,onChange:f=>{const m=Number(f.target.value),v=a.phase1Weeks,b=Math.max(1,m-v);h("totalWeeks",m),h("phase2Weeks",b)},className:se.workflowInput,min:"2",max:"40"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px",fontSize:"14px"},children:"Phase 1 Weeks"}),e.jsx("input",{type:"number",value:a.phase1Weeks,onChange:f=>{const m=Number(f.target.value);if(h("phase1Weeks",m),a.totalWeeks){const v=Math.max(1,a.totalWeeks-m);h("phase2Weeks",v)}},className:se.workflowInput,min:"1",max:"20"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px",fontSize:"14px"},children:"Phase 2 Weeks"}),e.jsx("input",{type:"number",value:a.phase2Weeks,onChange:f=>{const m=Number(f.target.value);h("phase2Weeks",m);const v=a.phase1Weeks+m;h("totalWeeks",v)},className:se.workflowInput,min:"1",max:"20"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fff",display:"block",marginBottom:"5px",fontSize:"14px"},children:"Session Start Date"}),e.jsx("input",{type:"date",value:a.seasonStart,onChange:f=>h("seasonStart",f.target.value),className:se.workflowInput})]})]}),a.seasonStart&&e.jsx("div",{style:{marginTop:"15px",padding:"15px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"6px",border:"1px solid #4CAF50"},children:e.jsxs("div",{style:{color:"#4CAF50",fontSize:"14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px"},children:[e.jsx(Fb,{}),e.jsx("strong",{children:"Calculated Session Dates:"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Phase 1:"}),e.jsx("br",{}),(()=>new Date(a.seasonStart).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}))()," to ",(()=>{const f=new Date(a.seasonStart),m=new Date(f);return m.setDate(f.getDate()+a.phase1Weeks*6-1),m.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})})()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Phase 2:"}),e.jsx("br",{}),(()=>{const f=new Date(a.seasonStart),m=new Date(f);return m.setDate(f.getDate()+a.phase1Weeks*6),m.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})})()," to ",(()=>{const f=new Date(a.seasonStart),m=new Date(f);return m.setDate(f.getDate()+a.phase1Weeks*6+a.phase2Weeks*6-1),m.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})})()]})]}),e.jsxs("div",{style:{marginTop:"10px",fontSize:"12px",opacity:.8},children:["Total Session Length: ",a.totalWeeks," weeks (",a.phase1Weeks," weeks Phase 1 + ",a.phase2Weeks," weeks Phase 2)"]})]})}),e.jsxs("button",{className:se.workflowButton,onClick:()=>s(4),disabled:!a.seasonStart,children:[e.jsx(Cl,{})," Continue to Division Setup"]})]})]});case 4:return e.jsxs("div",{className:se.workflowStep,children:[e.jsx("div",{className:se.stepInstructions,children:u[3].instructions.map((f,m)=>e.jsx("div",{className:se.instructionItem,children:f},m))}),e.jsxs("div",{className:se.divisionForm,children:[e.jsx("input",{type:"text",placeholder:"Division Name (exactly as in CSI LMS)",value:a.name,onChange:f=>h("name",f.target.value),className:se.workflowInput}),e.jsx("input",{type:"text",placeholder:"Description (optional)",value:a.description,onChange:f=>h("description",f.target.value),className:se.workflowInput}),e.jsx("input",{type:"url",placeholder:"Schedule URL from CSI LMS",value:a.scheduleUrl,onChange:f=>h("scheduleUrl",f.target.value),className:se.workflowInput}),e.jsx("input",{type:"url",placeholder:"Standings URL from CSI LMS",value:a.standingsUrl,onChange:f=>h("standingsUrl",f.target.value),className:se.workflowInput}),e.jsx("button",{className:se.workflowButton,onClick:p,disabled:i||!a.name||!a.scheduleUrl||!a.standingsUrl,children:i?"Creating...":"Create Division"})]}),c&&e.jsx("div",{className:se.workflowResult,children:c})]});case 5:return e.jsxs("div",{className:se.workflowStep,children:[e.jsx("div",{className:se.stepInstructions,children:u[4].instructions.map((f,m)=>e.jsx("div",{className:se.instructionItem,children:f},m))}),e.jsxs("div",{className:se.stepActions,children:[e.jsx(iV,{backendUrl:n,divisionName:a.name}),e.jsxs("button",{className:se.workflowButton,onClick:()=>{s(1),o({name:"",description:"",scheduleUrl:"",standingsUrl:"",seasonStart:"",phase1Weeks:6,phase2Weeks:4,totalWeeks:10}),d("")},children:[e.jsx(Ms,{})," Create Another Division"]})]})]});default:return null}};return e.jsxs("div",{className:se.workflowContainer,children:[e.jsxs("div",{className:se.workflowHeader,children:[e.jsxs("h3",{children:[e.jsx(Ms,{})," Create New Division"]}),e.jsxs("div",{className:se.workflowProgress,children:["Step ",r," of ",u.length]})]}),e.jsx("div",{className:se.workflowSteps,children:u.map((f,m)=>e.jsxs("div",{className:`${se.workflowStepIndicator} ${r>f.id?se.completed:r===f.id?se.active:se.pending}`,children:[e.jsx("div",{className:se.stepNumber,children:f.id}),e.jsxs("div",{className:se.stepInfo,children:[e.jsx("div",{className:se.stepTitle,children:f.title}),e.jsx("div",{className:se.stepDescription,children:f.description})]})]},f.id))}),e.jsx("div",{className:se.workflowContent,children:g()})]})}function iV({backendUrl:n,divisionName:t}){const[r,s]=y.useState(!1),[a,o]=y.useState(""),i=async l=>{s(!0),o("");try{const d=await fetch(`${n}${l==="schedule"?"/admin/update-schedule":"/admin/update-standings"}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:t})}),u=await d.json();d.ok?o(` ${l==="schedule"?"Schedule":"Standings"} updated successfully!`):o(` Failed to update ${l}: ${u.error||"Unknown error"}`)}catch(c){o(` Failed to update ${l}: ${c.message}`)}s(!1)};return e.jsxs("div",{className:se.dataSyncTools,children:[e.jsxs("button",{className:se.syncButton,onClick:()=>i("schedule"),disabled:r,children:[e.jsx(zx,{})," Update Schedule"]}),e.jsxs("button",{className:se.syncButton,onClick:()=>i("standings"),disabled:r,children:[e.jsx(zx,{})," Update Standings"]}),a&&e.jsx("div",{className:se.syncResult,children:a})]})}function lV({backendUrl:n}){const[t,r]=y.useState("approve"),[s,a]=y.useState([]),[o,i]=y.useState([]),[l,c]=y.useState(!1);y.useEffect(()=>{d(),u()},[]);const d=async()=>{c(!0);try{const f=await fetch(`${n}/api/users/pending-registrations`);if(f.ok){const m=await f.json();a(m.sort((v,b)=>new Date(v.registrationDate)-new Date(b.registrationDate)))}}catch(f){console.error("Error fetching pending registrations:",f)}c(!1)},u=async()=>{try{const f=await fetch(`${n}/api/users/pending-payment`);if(f.ok){const m=await f.json();i(m.users||[])}}catch(f){console.error("Error fetching pending payments:",f)}},h=async(f,m,v)=>{try{const b=await fetch(`${n}/api/users/${f}/confirm-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentMethod:m||"Admin Confirmed",paymentNotes:v||""})});if(b.ok){const w=await b.json();alert(`Payment confirmed! PIN: ${w.user.pin}`),u()}else alert("Failed to confirm payment")}catch(b){console.error("Error confirming payment:",b),alert("Error confirming payment")}},p=async(f,m)=>{try{(await fetch(`${n}/api/users/admin/approve-registration/${f}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({approvedBy:"Admin",paymentInfo:{hasPaid:!0,paymentDate:new Date,paymentMethod:"Cash",paymentNotes:"Approved by admin"},division:m})})).ok?d():alert("Failed to approve registration")}catch(v){console.error("Error approving registration:",v),alert("Error approving registration")}},g=async(f,m)=>{try{(await fetch(`${n}/api/users/admin/reject-registration/${f}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rejectedBy:"Admin",notes:m})})).ok?d():alert("Failed to reject registration")}catch(v){console.error("Error rejecting registration:",v),alert("Error rejecting registration")}};return e.jsxs("div",{className:se.playerManagementContainer,children:[e.jsxs("div",{className:se.tabHeader,children:[e.jsxs("button",{className:`${se.tabButton} ${t==="approve"?se.active:""}`,onClick:()=>r("approve"),children:[e.jsx(Zc,{})," Approve New Players (",s.length,")"]}),e.jsxs("button",{className:`${se.tabButton} ${t==="payments"?se.active:""}`,onClick:()=>r("payments"),children:[e.jsx(va,{})," Pending Payments (",o.length,")"]}),e.jsxs("button",{className:`${se.tabButton} ${t==="manage"?se.active:""}`,onClick:()=>r("manage"),children:[e.jsx(So,{})," Manage Existing Players"]})]}),e.jsxs("div",{className:se.tabContent,children:[t==="approve"&&e.jsx("div",{className:se.approvalSection,children:l?e.jsx("div",{className:se.loadingMessage,children:"Loading pending registrations..."}):s.length===0?e.jsxs("div",{className:se.emptyState,children:[e.jsx(va,{})," No pending registrations"]}):e.jsx("div",{className:se.registrationList,children:s.map((f,m)=>e.jsxs("div",{className:se.registrationCard,children:[e.jsxs("div",{className:se.registrationHeader,children:[e.jsxs("span",{className:se.registrationNumber,children:["#",m+1]}),e.jsxs("h4",{children:[f.firstName," ",f.lastName]})]}),e.jsxs("div",{className:se.registrationDetails,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",f.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",f.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Registered:"})," ",new Date(f.registrationDate).toLocaleDateString()]})]}),e.jsxs("div",{className:se.registrationActions,children:[e.jsxs("select",{id:`division-${f._id}`,className:se.divisionSelect,children:[e.jsx("option",{value:"",children:"Select Division"}),e.jsx("option",{value:"FRBCAPL TEST",children:"FRBCAPL TEST"}),e.jsx("option",{value:"Singles Test",children:"Singles Test"}),e.jsx("option",{value:"Waiting List",children:"Waiting List"})]}),e.jsxs("button",{className:se.approveButton,onClick:()=>{const v=document.getElementById(`division-${f._id}`).value;if(!v){alert("Please select a division before approving.");return}p(f._id,v)},children:[e.jsx(va,{})," Approve"]}),e.jsxs("button",{className:se.rejectButton,onClick:()=>{const v=prompt("Enter rejection reason (optional):");v!==null&&g(f._id,v)},children:[e.jsx(zi,{})," Reject"]})]})]},f._id))})}),t==="payments"&&e.jsx("div",{className:se.paymentSection,children:o.length===0?e.jsxs("div",{className:se.emptyState,children:[e.jsx(va,{})," No pending payments"]}):e.jsx("div",{className:se.paymentList,children:o.map((f,m)=>e.jsxs("div",{className:se.paymentCard,children:[e.jsxs("div",{className:se.paymentHeader,children:[e.jsxs("span",{className:se.paymentNumber,children:["#",m+1]}),e.jsxs("h4",{children:[f.firstName," ",f.lastName]})]}),e.jsxs("div",{className:se.paymentDetails,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",f.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Registered:"})," ",new Date(f.registrationDate).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:se.pendingStatus,children:"Payment Pending"})]})]}),e.jsxs("div",{className:se.paymentActions,children:[e.jsxs("select",{id:`payment-method-${f._id}`,className:se.paymentMethodSelect,children:[e.jsx("option",{value:"Cash",children:"Cash"}),e.jsx("option",{value:"Venmo",children:"Venmo"}),e.jsx("option",{value:"Cash App",children:"Cash App"}),e.jsx("option",{value:"PayPal",children:"PayPal"}),e.jsx("option",{value:"Credit Card",children:"Credit Card"}),e.jsx("option",{value:"Apple Pay",children:"Apple Pay"}),e.jsx("option",{value:"Google Pay",children:"Google Pay"}),e.jsx("option",{value:"Check",children:"Check"}),e.jsx("option",{value:"Admin Confirmed",children:"Admin Confirmed"})]}),e.jsxs("button",{className:se.confirmPaymentButton,onClick:()=>{const v=document.getElementById(`payment-method-${f._id}`).value,b=prompt("Payment notes (optional):");b!==null&&h(f._id,v,b)},children:[e.jsx(va,{})," Confirm Payment"]})]})]},f._id))})}),t==="manage"&&e.jsx("div",{className:se.manageSection,children:e.jsx(cV,{backendUrl:n})})]})]})}function YC({player:n,onSave:t,onClose:r}){const[s,a]=y.useState({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",phone:n.phone||"",textNumber:n.textNumber||"",emergencyContactName:n.emergencyContactName||"",emergencyContactPhone:n.emergencyContactPhone||"",locations:n.locations||"",notes:n.notes||""}),o=(l,c)=>{let d=c;if(l==="phone"||l==="textNumber"||l==="emergencyContactPhone"){const u=c.replace(/\D/g,"");u.length<=3?d=`(${u}`:u.length<=6?d=`(${u.slice(0,3)}) ${u.slice(3)}`:u.length<=10?d=`(${u.slice(0,3)}) ${u.slice(3,6)}-${u.slice(6)}`:d=`(${u.slice(0,3)}) ${u.slice(3,6)}-${u.slice(6,10)}`}a(u=>({...u,[l]:d}))},i=l=>{l.preventDefault(),t({...n,...s})};return e.jsx("div",{className:se.modalOverlay,children:e.jsxs("div",{className:se.modal,children:[e.jsxs("div",{className:se.modalHeader,children:[e.jsxs("h3",{children:["Edit Player: ",n.firstName," ",n.lastName]}),e.jsx("button",{onClick:r,className:se.closeButton,children:""})]}),e.jsxs("form",{onSubmit:i,className:se.modalForm,children:[e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"First Name:"}),e.jsx("input",{type:"text",value:s.firstName,onChange:l=>o("firstName",l.target.value),required:!0})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Last Name:"}),e.jsx("input",{type:"text",value:s.lastName,onChange:l=>o("lastName",l.target.value),required:!0})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",value:s.email,onChange:l=>o("email",l.target.value),required:!0})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Phone:"}),e.jsx("input",{type:"tel",value:s.phone,onChange:l=>o("phone",l.target.value),placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Text Number:"}),e.jsx("input",{type:"tel",value:s.textNumber,onChange:l=>o("textNumber",l.target.value),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Emergency Contact Name:"}),e.jsx("input",{type:"text",value:s.emergencyContactName,onChange:l=>o("emergencyContactName",l.target.value)})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Emergency Contact Phone:"}),e.jsx("input",{type:"tel",value:s.emergencyContactPhone,onChange:l=>o("emergencyContactPhone",l.target.value),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Playing Locations:"}),e.jsx("input",{type:"text",value:s.locations,onChange:l=>o("locations",l.target.value)})]})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Notes:"}),e.jsx("textarea",{value:s.notes,onChange:l=>o("notes",l.target.value),rows:"3"})]}),e.jsxs("div",{className:se.modalActions,children:[e.jsx("button",{type:"button",onClick:r,className:se.cancelButton,children:"Cancel"}),e.jsx("button",{type:"submit",className:se.saveButton,children:"Save Changes"})]})]})]})})}function cV({backendUrl:n}){const[t,r]=y.useState(""),[s,a]=y.useState([]),[o,i]=y.useState([]),[l,c]=y.useState({}),[d,u]=y.useState(null),[h,p]=y.useState(!1);y.useEffect(()=>{fetch(`${n}/admin/divisions`).then(j=>j.json()).then(j=>i(j.map(S=>S.name))).catch(()=>i([]))},[n]);const g=async j=>{if(j.preventDefault(),!!t.trim())try{const _=await(await fetch(`${n}/admin/search-users?query=${encodeURIComponent(t)}`)).json();a(_),c({})}catch{a([]),alert("Search failed")}},f=async(j,S)=>{try{await fetch(`${n}/admin/user/${j}/add-division`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:S})}),g({preventDefault:()=>{}})}catch{alert("Failed to add user to division")}},m=async(j,S)=>{try{await fetch(`${n}/admin/user/${j}/remove-division`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({division:S})}),g({preventDefault:()=>{}})}catch{alert("Failed to remove user from division")}},v=(j,S)=>{c(_=>({..._,[j]:S}))},b=async()=>{try{const S=await(await fetch(`${n}/api/users`)).json();a(S),r("")}catch{a([]),alert("Failed to load all players")}},w=j=>{u(j),p(!0)},x=async j=>{try{const S=await fetch(`${n}/api/users/${j._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(S.ok){const _=await S.json();t.trim()?g({preventDefault:()=>{}}):b(),p(!1),u(null),alert(" Player updated successfully!")}else{const _=await S.json();alert(`Failed to update player: ${_.message||_.error||"Unknown error"}`)}}catch(S){alert(`Failed to update unified player: ${S.message}`)}};return e.jsxs("div",{className:se.userSearchContainer,children:[e.jsxs("form",{onSubmit:g,className:se.searchForm,children:[e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:t,onChange:j=>r(j.target.value),className:se.searchInput}),e.jsxs("button",{type:"submit",className:se.searchButton,children:[e.jsx(MC,{})," Search"]})]}),e.jsxs("button",{onClick:b,className:se.searchButton,style:{marginLeft:"10px"},children:[e.jsx(So,{})," Show All Players"]}),s.length>0&&e.jsx("div",{className:se.resultsSummary,children:e.jsxs("div",{className:se.summaryCard,children:[e.jsx("h4",{children:" Player Summary"}),e.jsxs("div",{className:se.summaryStats,children:[e.jsxs("div",{className:se.summaryStat,children:[e.jsx("span",{className:se.statNumber,children:s.length}),e.jsx("span",{className:se.statLabel,children:"Total Players"})]}),e.jsxs("div",{className:se.summaryStat,children:[e.jsx("span",{className:se.statNumber,children:s.filter(j=>j.isLeaguePlayer).length}),e.jsx("span",{className:se.statLabel,children:"League Players"})]}),e.jsxs("div",{className:se.summaryStat,children:[e.jsx("span",{className:se.statNumber,children:s.filter(j=>j.isLadderPlayer).length}),e.jsx("span",{className:se.statLabel,children:"Ladder Players"})]}),e.jsxs("div",{className:se.summaryStat,children:[e.jsx("span",{className:se.statNumber,children:s.filter(j=>j.system==="both").length}),e.jsx("span",{className:se.statLabel,children:"Both Systems"})]})]})]})}),s.length>0&&e.jsx("div",{className:se.searchResults,children:s.map(j=>{var S,_;return e.jsxs("div",{className:se.userCard,children:[e.jsxs("div",{className:se.userInfo,children:[e.jsxs("div",{className:se.userHeader,children:[e.jsx("h4",{className:se.userName,children:j.firstName&&j.lastName?`${j.firstName} ${j.lastName}`:j.name||j.email||"Unknown User"}),e.jsxs("div",{className:se.systemBadges,children:[j.system==="league"&&e.jsx("span",{className:se.leagueBadge,children:" League"}),j.system==="ladder"&&e.jsx("span",{className:se.ladderBadge,children:" Ladder"}),j.system==="both"&&e.jsxs("div",{className:se.bothBadges,children:[e.jsx("span",{className:se.leagueBadge,children:" League"}),e.jsx("span",{className:se.ladderBadge,children:" Ladder"})]})]})]}),e.jsxs("div",{className:se.userContactInfo,children:[e.jsxs("p",{className:se.userEmail,children:[e.jsx("strong",{children:"Email:"})," ",j.email]}),e.jsxs("p",{className:se.userPhone,children:[e.jsx("strong",{children:"Phone:"})," ",j.phone||"Not provided"]}),j.textNumber&&e.jsxs("p",{className:se.userTextNumber,children:[e.jsx("strong",{children:"Text:"})," ",j.textNumber]})]}),e.jsxs("div",{className:se.userDetails,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Current Divisions:"})," ",((S=j.divisions)==null?void 0:S.join(", "))||"None"]}),j.locations&&e.jsxs("p",{children:[e.jsx("strong",{children:"Playing Locations:"})," ",j.locations]}),j.availability&&e.jsxs("div",{className:se.userAvailability,children:[e.jsx("p",{children:e.jsx("strong",{children:"Availability:"})}),e.jsx("div",{className:se.availabilityGrid,children:Object.entries(j.availability).map(([C,N])=>N&&N.length>0&&e.jsxs("div",{className:se.availabilityDay,children:[e.jsxs("span",{className:se.dayLabel,children:[C,":"]}),e.jsx("span",{className:se.timeSlots,children:N.join(", ")})]},C))})]}),j.emergencyContactName&&e.jsxs("p",{children:[e.jsx("strong",{children:"Emergency Contact:"})," ",j.emergencyContactName," (",j.emergencyContactPhone,")"]}),j.notes&&e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",j.notes]}),j.system==="ladder"&&e.jsxs("div",{className:se.ladderInfo,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ladder:"})," ",j.ladderName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," #",j.position]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fargo Rate:"})," ",j.fargoRate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",j.isActive?"Active":"Inactive"]})]}),j.system==="both"&&j.ladderInfo&&e.jsxs("div",{className:se.ladderInfo,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ladder:"})," ",j.ladderInfo.ladderName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," #",j.ladderInfo.position]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fargo Rate:"})," ",j.ladderInfo.fargoRate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",j.ladderInfo.isActive?"Active":"Inactive"]})]})]})]}),e.jsxs("div",{className:se.userActions,children:[e.jsxs("button",{onClick:()=>w(j),className:se.editButton,children:[e.jsx(Xc,{})," Edit Player"]}),e.jsxs("select",{value:l[j._id]||"",onChange:C=>v(j._id,C.target.value),className:se.divisionSelect,children:[e.jsx("option",{value:"",children:"Select Division"}),o.map(C=>e.jsx("option",{value:C,children:C},C))]}),e.jsxs("button",{onClick:()=>f(j._id,l[j._id]),disabled:!l[j._id],className:se.addButton,children:[e.jsx(Ms,{})," Add to Division"]}),(_=j.divisions)==null?void 0:_.map(C=>e.jsxs("button",{onClick:()=>m(j._id,C),className:se.removeButton,children:[e.jsx(zi,{})," Remove from ",C]},C))]})]},j._id)})}),h&&d&&e.jsx(YC,{player:d,onSave:x,onClose:()=>{p(!1),u(null)}})]})}function dV({backendUrl:n}){const[t,r]=y.useState([]),[s,a]=y.useState("");return y.useEffect(()=>{fetch(`${n}/admin/divisions`).then(o=>o.json()).then(o=>{const i=o.map(l=>l.name);r(i),a(i[0]||"")}).catch(()=>r([]))},[n]),e.jsxs("div",{className:se.matchManagementContainer,children:[e.jsxs("div",{className:se.sectionHeader,children:[e.jsxs("h3",{children:[e.jsx(Oi,{})," Match Management"]}),e.jsx("select",{value:s,onChange:o=>a(o.target.value),className:se.divisionSelect,children:t.map(o=>e.jsx("option",{value:o,children:o},o))})]}),s&&e.jsx(VG,{division:s,isAdmin:!0})]})}function uV({backendUrl:n}){const[t,r]=y.useState(!1),[s,a]=y.useState({});y.useEffect(()=>{o()},[]);const o=async()=>{try{const[i,l]=await Promise.all([fetch(`${n}/api/users`),fetch(`${n}/admin/divisions`)]),c=await i.json(),d=await l.json();a({totalUsers:c.length,activeUsers:c.filter(u=>u.isActive).length,pendingRegistrations:c.filter(u=>!u.isApproved).length,totalDivisions:d.length})}catch(i){console.error("Error fetching system stats:",i)}};return e.jsxs("div",{className:se.systemStatusContainer,children:[e.jsxs("div",{className:se.statsGrid,children:[e.jsxs("div",{className:se.statCard,children:[e.jsx("div",{className:se.statNumber,children:s.totalUsers||0}),e.jsx("div",{className:se.statLabel,children:"Total Users"})]}),e.jsxs("div",{className:se.statCard,children:[e.jsx("div",{className:se.statNumber,children:s.activeUsers||0}),e.jsx("div",{className:se.statLabel,children:"Active Users"})]}),e.jsxs("div",{className:se.statCard,children:[e.jsx("div",{className:se.statNumber,children:s.pendingRegistrations||0}),e.jsx("div",{className:se.statLabel,children:"Pending Approvals"})]}),e.jsxs("div",{className:se.statCard,children:[e.jsx("div",{className:se.statNumber,children:s.totalDivisions||0}),e.jsx("div",{className:se.statLabel,children:"Divisions"})]})]}),e.jsxs("div",{className:se.systemActions,children:[e.jsxs("button",{className:se.systemButton,onClick:()=>r(!0),children:[e.jsx(mH,{})," View Unentered LMS Matches"]}),e.jsxs("button",{className:se.systemButton,onClick:o,children:[e.jsx(zx,{})," Refresh Stats"]})]}),e.jsx(GG,{open:t,onClose:()=>r(!1)})]})}function hV({backendUrl:n}){const[t,r]=y.useState("view"),[s,a]=y.useState([]),[o,i]=y.useState(!1),[l,c]=y.useState(null),[d,u]=y.useState(""),[h,p]=y.useState(null),[g,f]=y.useState(!1);y.useEffect(()=>{m()},[n]);const m=async()=>{i(!0);try{const C=await sl.getAllUsers();a(C)}catch(C){c("Failed to fetch users: "+C.message)}finally{i(!1)}},v=async C=>{if(C.preventDefault(),!!d.trim()){i(!0);try{const N=await sl.searchUsers(d);a(N)}catch(N){c("Search failed: "+N.message)}finally{i(!1)}}},b=async C=>{i(!0);try{const N=await sl.addUser(C);a(M=>[...M,N]),alert("User added successfully!"),r("view")}catch(N){c("Failed to add user: "+N.message)}finally{i(!1)}},w=C=>{p(C),f(!0)},x=async C=>{i(!0);try{const N=await sl.updateUser(C._id,C);a(M=>M.map(E=>E._id===C._id?N:E)),alert("User updated successfully!"),f(!1),p(null)}catch(N){c("Failed to update user: "+N.message)}finally{i(!1)}},j=async C=>{if(window.confirm("Are you sure you want to delete this user?")){i(!0);try{await sl.deleteUser(C),a(N=>N.filter(M=>M._id!==C)),alert("User deleted successfully!")}catch(N){c("Failed to delete user: "+N.message)}finally{i(!1)}}},S=async(C,N)=>{i(!0);try{await sl.addUserDivision(C,N),a(M=>M.map(E=>E._id===C?{...E,divisions:[...E.divisions,N]}:E)),alert("Division added to user successfully!")}catch(M){c("Failed to add division to user: "+M.message)}finally{i(!1)}},_=async(C,N)=>{i(!0);try{await sl.removeUserDivision(C,N),a(M=>M.map(E=>E._id===C?{...E,divisions:E.divisions.filter(P=>P!==N)}:E)),alert("Division removed from user successfully!")}catch(M){c("Failed to remove division from user: "+M.message)}finally{i(!1)}};return e.jsxs("div",{className:se.unifiedUsersContainer,children:[e.jsxs("div",{className:se.tabHeader,children:[e.jsxs("button",{className:`${se.tabButton} ${t==="view"?se.active:""}`,onClick:()=>r("view"),children:[e.jsx(So,{})," View All Users (",s.length,")"]}),e.jsxs("button",{className:`${se.tabButton} ${t==="add"?se.active:""}`,onClick:()=>r("add"),children:[e.jsx(Zc,{})," Add New User"]}),e.jsxs("button",{className:`${se.tabButton} ${t==="edit"?se.active:""}`,onClick:()=>r("edit"),children:[e.jsx(Fx,{})," Edit User"]})]}),e.jsxs("div",{className:se.tabContent,children:[t==="view"&&e.jsxs("div",{className:se.viewUsersSection,children:[e.jsxs("form",{onSubmit:v,className:se.searchForm,children:[e.jsx("input",{type:"text",placeholder:"Search users by name, email, or ID...",value:d,onChange:C=>u(C.target.value),className:se.searchInput}),e.jsxs("button",{type:"submit",className:se.searchButton,children:[e.jsx(MC,{})," Search"]})]}),o?e.jsx("div",{className:se.loadingMessage,children:"Loading users..."}):l?e.jsx("div",{className:se.errorMessage,children:l}):s.length===0?e.jsxs("div",{className:se.emptyState,children:[e.jsx(So,{})," No users found. Add one to get started!"]}):e.jsx("div",{className:se.userList,children:s.map(C=>{var N;return e.jsxs("div",{className:se.userCard,children:[e.jsxs("div",{className:se.userHeader,children:[e.jsx("h4",{className:se.userName,children:C.firstName&&C.lastName?`${C.firstName} ${C.lastName}`:C.name||C.email||"Unknown User"}),e.jsxs("div",{className:se.systemBadges,children:[C.system==="league"&&e.jsx("span",{className:se.leagueBadge,children:" League"}),C.system==="ladder"&&e.jsx("span",{className:se.ladderBadge,children:" Ladder"}),C.system==="both"&&e.jsxs("div",{className:se.bothBadges,children:[e.jsx("span",{className:se.leagueBadge,children:" League"}),e.jsx("span",{className:se.ladderBadge,children:" Ladder"})]})]})]}),e.jsxs("div",{className:se.userContactInfo,children:[e.jsxs("p",{className:se.userEmail,children:[e.jsx("strong",{children:"Email:"})," ",C.email]}),e.jsxs("p",{className:se.userPhone,children:[e.jsx("strong",{children:"Phone:"})," ",C.phone||"Not provided"]}),C.textNumber&&e.jsxs("p",{className:se.userTextNumber,children:[e.jsx("strong",{children:"Text:"})," ",C.textNumber]})]}),e.jsxs("div",{className:se.userDetails,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Current Divisions:"})," ",((N=C.divisions)==null?void 0:N.join(", "))||"None"]}),C.locations&&e.jsxs("p",{children:[e.jsx("strong",{children:"Playing Locations:"})," ",C.locations]}),C.availability&&e.jsxs("div",{className:se.userAvailability,children:[e.jsx("p",{children:e.jsx("strong",{children:"Availability:"})}),e.jsx("div",{className:se.availabilityGrid,children:Object.entries(C.availability).map(([M,E])=>E&&E.length>0&&e.jsxs("div",{className:se.availabilityDay,children:[e.jsxs("span",{className:se.dayLabel,children:[M,":"]}),e.jsx("span",{className:se.timeSlots,children:E.join(", ")})]},M))})]}),C.emergencyContactName&&e.jsxs("p",{children:[e.jsx("strong",{children:"Emergency Contact:"})," ",C.emergencyContactName," (",C.emergencyContactPhone,")"]}),C.notes&&e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",C.notes]}),C.system==="ladder"&&e.jsxs("div",{className:se.ladderInfo,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ladder:"})," ",C.ladderName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," #",C.position]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fargo Rate:"})," ",C.fargoRate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",C.isActive?"Active":"Inactive"]})]}),C.system==="both"&&C.ladderInfo&&e.jsxs("div",{className:se.ladderInfo,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ladder:"})," ",C.ladderInfo.ladderName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," #",C.ladderInfo.position]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fargo Rate:"})," ",C.ladderInfo.fargoRate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",C.ladderInfo.isActive?"Active":"Inactive"]})]})]}),e.jsxs("div",{className:se.userActions,children:[e.jsxs("button",{onClick:()=>w(C),className:se.editButton,children:[e.jsx(Xc,{})," Edit User"]}),e.jsxs("select",{value:C.system||"",onChange:M=>{const E=M.target.value;E==="league"?(_(C._id,"ladder"),_(C._id,"both")):E==="ladder"?(_(C._id,"league"),_(C._id,"both")):(_(C._id,"league"),_(C._id,"ladder")),S(C._id,E)},className:se.systemSelect,children:[e.jsx("option",{value:"",children:"Select System"}),e.jsx("option",{value:"league",children:"League Only"}),e.jsx("option",{value:"ladder",children:"Ladder Only"}),e.jsx("option",{value:"both",children:"Both Systems"})]}),e.jsxs("button",{onClick:()=>j(C._id),className:se.deleteButton,children:[e.jsx(zi,{})," Delete User"]})]})]},C._id)})})]}),t==="add"&&e.jsxs("div",{className:se.addUserSection,children:[e.jsx("h3",{children:"Add New User"}),e.jsxs("form",{onSubmit:C=>{C.preventDefault();const N={firstName:document.getElementById("add-firstName").value,lastName:document.getElementById("add-lastName").value,email:document.getElementById("add-email").value,phone:document.getElementById("add-phone").value,textNumber:document.getElementById("add-textNumber").value,emergencyContactName:document.getElementById("add-emergencyContactName").value,emergencyContactPhone:document.getElementById("add-emergencyContactPhone").value,locations:document.getElementById("add-locations").value,notes:document.getElementById("add-notes").value,system:document.getElementById("add-system").value,isActive:!0,isApproved:!0,isLeaguePlayer:!1,isLadderPlayer:!1,ladderName:"",position:"",fargoRate:"",availability:{},divisions:[],paymentInfo:{hasPaid:!1,paymentDate:null,paymentMethod:"",paymentNotes:""}};b(N)},className:se.addUserForm,children:[e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"First Name:"}),e.jsx("input",{type:"text",id:"add-firstName",required:!0})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Last Name:"}),e.jsx("input",{type:"text",id:"add-lastName",required:!0})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",id:"add-email",required:!0})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Phone:"}),e.jsx("input",{type:"tel",id:"add-phone",placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Text Number:"}),e.jsx("input",{type:"tel",id:"add-textNumber",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Emergency Contact Name:"}),e.jsx("input",{type:"text",id:"add-emergencyContactName"})]})]}),e.jsxs("div",{className:se.formRow,children:[e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Emergency Contact Phone:"}),e.jsx("input",{type:"tel",id:"add-emergencyContactPhone",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Playing Locations:"}),e.jsx("input",{type:"text",id:"add-locations"})]})]}),e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"Notes:"}),e.jsx("textarea",{id:"add-notes",rows:"3"})]}),e.jsx("div",{className:se.formRow,children:e.jsxs("div",{className:se.formField,children:[e.jsx("label",{children:"System:"}),e.jsxs("select",{id:"add-system",required:!0,children:[e.jsx("option",{value:"",children:"Select System"}),e.jsx("option",{value:"league",children:"League Only"}),e.jsx("option",{value:"ladder",children:"Ladder Only"}),e.jsx("option",{value:"both",children:"Both Systems"})]})]})}),e.jsx("button",{type:"submit",className:se.addUserButton,children:o?"Adding...":"Add User"}),l&&e.jsx("div",{className:se.errorMessage,children:l})]})]}),t==="edit"&&h&&e.jsx(YC,{player:h,onSave:x,onClose:()=>{f(!1),p(null)}})]})]})}function pV({userToken:n}){const[t,r]=y.useState(null),[s,a]=y.useState([]),[o,i]=y.useState(null),[l,c]=y.useState([]),[d,u]=y.useState(!1),[h,p]=y.useState(null),[g,f]=y.useState("overview"),m=yn();y.useEffect(()=>{const w=new Sf(aV);return w.connectUser({id:t2,name:"Admin"},w.devToken(t2)),r(w),()=>w.disconnectUser()},[]),y.useEffect(()=>{if(!t)return;(async()=>{try{const x=await t.queryChannels({});a(x)}catch(x){console.error("Error fetching channels:",x)}})()},[t]),y.useEffect(()=>{if(!o)return;(async()=>{u(!0);try{const x=await o.getMessages();c(x.messages)}catch(x){console.error("Error fetching messages:",x)}u(!1)})()},[o]);const v=(w,x)=>{p({type:w,message:x}),setTimeout(()=>p(null),5e3)};if(!t)return e.jsx("div",{children:"Loading admin dashboard..."});const b=()=>{switch(g){case"overview":return e.jsxs("div",{className:se.overviewSection,children:[e.jsx("h2",{children:"Welcome to Admin Dashboard"}),e.jsx("p",{children:"Select a section below to manage your league:"}),e.jsxs("div",{className:se.quickActions,children:[e.jsxs("button",{className:se.quickActionButton,onClick:()=>f("divisions"),children:[e.jsx(Ms,{})," Create New Division"]}),e.jsxs("button",{className:se.quickActionButton,onClick:()=>f("players"),children:[e.jsx(Zc,{})," Manage Players"]}),e.jsxs("button",{className:se.quickActionButton,onClick:()=>f("matches"),children:[e.jsx(Oi,{})," Match Management"]}),e.jsxs("button",{className:se.quickActionButton,onClick:()=>f("system"),children:[e.jsx(Ox,{})," System Status"]}),e.jsx("button",{className:se.quickActionButton,onClick:()=>f("ladder-applications"),children:" Pending Applications"}),e.jsx("button",{className:se.quickActionButton,onClick:()=>f("simplified-admin"),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:" Simplified Admin Dashboard"})]})]});case"divisions":return e.jsx(oV,{backendUrl:Ie,onComplete:()=>v("success","Division created successfully!")});case"players":return e.jsx(lV,{backendUrl:Ie});case"matches":return e.jsx(dV,{backendUrl:Ie});case"system":return e.jsx(uV,{backendUrl:Ie});case"backup":return e.jsx(KG,{backendUrl:Ie});case"locations":return e.jsx(JG,{backendUrl:Ie});case"payments":return e.jsx(ZG,{});case"payment-tracker":return e.jsx(eV,{});case"league-management":return e.jsx(tV,{});case"unified-users":return e.jsx(hV,{backendUrl:Ie});case"ladder-applications":return e.jsx(Wb,{onClose:()=>f("overview"),userToken:n});case"simplified-admin":return e.jsx(nV,{});default:return null}};return e.jsxs("div",{className:se.adminDashboardRoot,children:[e.jsxs("div",{className:se.adminDashboardNav,children:[e.jsxs("div",{className:se.navLeft,children:[e.jsx("button",{onClick:()=>{m("/"),window.location.reload()},children:" User Dashboard"}),e.jsx("button",{onClick:()=>m("/chat"),children:" Back to Chat"})]}),e.jsx("div",{className:se.navRight,children:e.jsx("button",{onClick:()=>{localStorage.clear(),m("/"),window.location.reload()},children:" Logout"})})]}),e.jsxs("div",{className:se.adminDashboardMainColumn,children:[h&&e.jsxs("div",{className:`${se.banner} ${se[h.type]}`,children:[h.type==="success"?e.jsx(va,{}):e.jsx(kf,{}),h.message]}),e.jsxs("div",{className:se.sectionNavigation,children:[e.jsx("button",{className:`${se.sectionButton} ${g==="overview"?se.active:""}`,onClick:()=>f("overview"),children:" Overview"}),e.jsxs("button",{className:`${se.sectionButton} ${g==="divisions"?se.active:""}`,onClick:()=>f("divisions"),children:[e.jsx(Ms,{})," Divisions"]}),e.jsxs("button",{className:`${se.sectionButton} ${g==="players"?se.active:""}`,onClick:()=>f("players"),children:[e.jsx(So,{})," Players"]}),e.jsxs("button",{className:`${se.sectionButton} ${g==="matches"?se.active:""}`,onClick:()=>f("matches"),children:[e.jsx(Oi,{})," Matches"]}),e.jsxs("button",{className:`${se.sectionButton} ${g==="system"?se.active:""}`,onClick:()=>f("system"),children:[e.jsx(Ox,{})," System"]}),e.jsxs("button",{className:`${se.sectionButton} ${g==="backup"?se.active:""}`,onClick:()=>f("backup"),children:[e.jsx(Am,{})," Backup"]}),e.jsxs("button",{className:`${se.sectionButton} ${g==="locations"?se.active:""}`,onClick:()=>f("locations"),children:[e.jsx(Qc,{})," Locations"]}),e.jsx("button",{className:`${se.sectionButton} ${g==="payments"?se.active:""}`,onClick:()=>f("payments"),children:" Payments"}),e.jsx("button",{className:`${se.sectionButton} ${g==="payment-tracker"?se.active:""}`,onClick:()=>f("payment-tracker"),children:" Payment Tracker"}),e.jsx("button",{className:`${se.sectionButton} ${g==="league-management"?se.active:""}`,onClick:()=>f("league-management"),children:" League Management"}),e.jsx("button",{className:`${se.sectionButton} ${g==="unified-users"?se.active:""}`,onClick:()=>f("unified-users"),children:" Unified Users"}),e.jsx("button",{className:`${se.sectionButton} ${g==="ladder-applications"?se.active:""}`,onClick:()=>f("ladder-applications"),children:" Pending Applications"})]}),e.jsx("div",{className:se.sectionContent,children:b()})]})]})}function mV(){const[n,t]=y.useState("overview"),[r,s]=y.useState(!1),[a,o]=y.useState(""),[i,l]=y.useState(""),[c,d]=y.useState(null),[u,h]=y.useState([]),[p,g]=y.useState([]),[f,m]=y.useState([]),v=()=>{const H=Bi.getCurrentAdmin();if(!H)throw new Error("No authenticated admin found");return{email:H.email,pin:H.pin}},[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState(!1),[C,N]=y.useState(!1),[M,E]=y.useState({leagueId:"",name:"",description:"",adminEmail:"",adminName:"",operatorEmail:""}),[P,D]=y.useState({email:"",firstName:"",lastName:"",phone:"",password:""}),[T,A]=y.useState({email:"",firstName:"",lastName:"",phone:"",password:"",role:"admin",permissions:{canCreateLeagues:!1,canDeleteLeagues:!1,canManageLeagueOperators:!1,canViewAllLeagueData:!1,canManageBilling:!1,canViewSystemLogs:!1}});y.useEffect(()=>{k()},[]);const k=async()=>{s(!0);try{const{email:H,pin:ue}=v(),J={"Content-Type":"application/json","x-admin-email":H,"x-admin-pin":ue},[be,Ae,O,oe]=await Promise.all([fetch(`${Ie}/api/platform/stats`,{headers:J}),fetch(`${Ie}/api/platform/leagues`,{headers:J}),fetch(`${Ie}/api/platform/operators`,{headers:J}),fetch(`${Ie}/api/platform/admins`,{headers:J})]);if(be.ok){const me=await be.json();d(me)}else console.error("Stats response error:",be.status,await be.text());if(Ae.ok){const me=await Ae.json();h(me.leagues||[])}else console.error("Leagues response error:",Ae.status,await Ae.text());if(O.ok){const me=await O.json();g(me.operators||[])}else console.error("Operators response error:",O.status,await O.text());if(oe.ok){const me=await oe.json();m(me.admins||[])}else console.error("Admins response error:",oe.status,await oe.text())}catch{o("Failed to load dashboard data")}finally{s(!1)}},R=async H=>{H.preventDefault(),s(!0),o("");try{const{email:ue,pin:J}=v(),be=await fetch(`${Ie}/api/platform/leagues`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M,adminEmail:ue,adminPin:J})}),Ae=await be.json();be.ok?(l("League created successfully!"),w(!1),E({leagueId:"",name:"",description:"",adminEmail:"",adminName:"",operatorEmail:""}),k()):o(Ae.message||"Failed to create league")}catch{o("Network error. Please try again.")}finally{s(!1)}},U=async H=>{H.preventDefault(),s(!0),o("");try{const{email:ue,pin:J}=v(),be=await fetch(`${Ie}/api/platform/operators`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,adminEmail:ue,adminPin:J})}),Ae=await be.json();be.ok?(l("Operator created successfully!"),j(!1),D({email:"",firstName:"",lastName:"",phone:"",password:""}),k()):o(Ae.message||"Failed to create operator")}catch{o("Network error. Please try again.")}finally{s(!1)}},z=async H=>{H.preventDefault(),s(!0),o("");try{const{email:ue,pin:J}=v(),be=await fetch(`${Ie}/api/platform/admins`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...T,adminEmail:ue,adminPin:J})}),Ae=await be.json();be.ok?(l("Admin created successfully!"),_(!1),A({email:"",firstName:"",lastName:"",phone:"",password:"",role:"admin",permissions:{canCreateLeagues:!1,canDeleteLeagues:!1,canManageLeagueOperators:!1,canViewAllLeagueData:!1,canManageBilling:!1,canViewSystemLogs:!1}}),k()):o(Ae.message||"Failed to create admin")}catch{o("Network error. Please try again.")}finally{s(!1)}},$=()=>e.jsxs("div",{className:"overview-section",children:[e.jsx("h2",{children:"Platform Overview"}),c&&e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx(ql,{className:"stat-icon"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:c.stats.leagues.total}),e.jsx("p",{children:"Total Leagues"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx(So,{className:"stat-icon"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:c.stats.operators}),e.jsx("p",{children:"League Operators"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx(Fx,{className:"stat-icon"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:c.stats.admins}),e.jsx("p",{children:"Platform Admins"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx(Bx,{className:"stat-icon"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:c.stats.leagues.active}),e.jsx("p",{children:"Active Leagues"})]})]})]}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("h3",{children:"Quick Actions"}),e.jsxs("div",{className:"action-buttons",children:[e.jsxs("button",{onClick:()=>w(!0),className:"btn-primary",children:[e.jsx(Ms,{})," Create New League"]}),e.jsxs("button",{onClick:()=>j(!0),className:"btn-secondary",children:[e.jsx(Fx,{})," Add League Operator"]}),e.jsxs("button",{onClick:()=>_(!0),className:"btn-secondary",children:[e.jsx(Xj,{})," Add Platform Admin"]})]})]})]}),W=()=>e.jsxs("div",{className:"leagues-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"League Management"}),e.jsxs("button",{onClick:()=>w(!0),className:"btn-primary",children:[e.jsx(Ms,{})," Create League"]})]}),e.jsx("div",{className:"leagues-grid",children:u.map(H=>e.jsxs("div",{className:"league-card",children:[e.jsxs("div",{className:"league-header",children:[e.jsx("h3",{children:H.name}),e.jsx("span",{className:`status-badge ${H.subscription.status}`,children:H.subscription.status})]}),e.jsxs("div",{className:"league-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",H.leagueId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Admin:"})," ",H.adminEmail]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Plan:"})," ",H.subscription.plan]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(H.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"league-actions",children:[e.jsxs("button",{className:"btn-small",children:[e.jsx(Il,{})," View Details"]}),e.jsxs("button",{className:"btn-small",children:[e.jsx(Xc,{})," Edit"]}),e.jsxs("button",{className:"btn-small btn-danger",children:[e.jsx(zi,{})," Delete"]})]})]},H.leagueId))})]}),Y=()=>e.jsxs("div",{className:"operators-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"League Operators"}),e.jsxs("button",{onClick:()=>j(!0),className:"btn-primary",children:[e.jsx(Ms,{})," Add Operator"]})]}),e.jsx("div",{className:"operators-grid",children:p.map(H=>e.jsxs("div",{className:"operator-card",children:[e.jsxs("div",{className:"operator-header",children:[e.jsxs("h3",{children:[H.firstName," ",H.lastName]}),e.jsx("span",{className:"status-badge active",children:"Active"})]}),e.jsxs("div",{className:"operator-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",H.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Leagues:"})," ",H.assignedLeagues.length]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Last Login:"})," ",H.lastLoginAt?new Date(H.lastLoginAt).toLocaleDateString():"Never"]})]}),e.jsxs("div",{className:"operator-actions",children:[e.jsxs("button",{className:"btn-small",children:[e.jsx(Il,{})," View Details"]}),e.jsxs("button",{className:"btn-small",children:[e.jsx(Xc,{})," Edit"]}),e.jsxs("button",{onClick:()=>N(!0),className:"btn-small",children:[e.jsx(bH,{})," Assign League"]})]})]},H._id))})]}),Q=()=>e.jsxs("div",{className:"admins-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"Platform Admins"}),e.jsxs("button",{onClick:()=>_(!0),className:"btn-primary",children:[e.jsx(Ms,{})," Add Admin"]})]}),e.jsx("div",{className:"admins-grid",children:f.map(H=>e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("h3",{children:[H.firstName," ",H.lastName]}),e.jsx("span",{className:`role-badge ${H.role}`,children:H.role})]}),e.jsxs("div",{className:"admin-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",H.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",H.role]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Last Login:"})," ",H.lastLoginAt?new Date(H.lastLoginAt).toLocaleDateString():"Never"]})]}),e.jsxs("div",{className:"admin-actions",children:[e.jsxs("button",{className:"btn-small",children:[e.jsx(Il,{})," View Details"]}),e.jsxs("button",{className:"btn-small",children:[e.jsx(Xc,{})," Edit"]}),e.jsxs("button",{className:"btn-small btn-danger",children:[e.jsx(zi,{})," Delete"]})]})]},H._id))})]});return e.jsxs("div",{className:"platform-admin-dashboard",children:[a&&e.jsxs("div",{className:"error-message",children:[e.jsx(kf,{})," ",a]}),i&&e.jsxs("div",{className:"success-message",children:[e.jsx(va,{})," ",i]}),e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{children:"Platform Administration"}),e.jsx("div",{className:"header-actions",children:e.jsxs("button",{onClick:k,className:"btn-secondary",disabled:r,children:[r?e.jsx(xa,{className:"spinner"}):e.jsx(kH,{})," Refresh"]})})]}),e.jsxs("div",{className:"dashboard-tabs",children:[e.jsxs("button",{className:`tab ${n==="overview"?"active":""}`,onClick:()=>t("overview"),children:[e.jsx(Bx,{})," Overview"]}),e.jsxs("button",{className:`tab ${n==="leagues"?"active":""}`,onClick:()=>t("leagues"),children:[e.jsx(ql,{})," Leagues"]}),e.jsxs("button",{className:`tab ${n==="operators"?"active":""}`,onClick:()=>t("operators"),children:[e.jsx(So,{})," Operators"]}),e.jsxs("button",{className:`tab ${n==="admins"?"active":""}`,onClick:()=>t("admins"),children:[e.jsx(Xj,{})," Admins"]})]}),e.jsxs("div",{className:"dashboard-content",children:[n==="overview"&&$(),n==="leagues"&&W(),n==="operators"&&Y(),n==="admins"&&Q()]}),e.jsx(It,{isOpen:b,onClose:()=>w(!1),title:"Create New League",maxWidth:"600px",children:e.jsxs("form",{onSubmit:R,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"League ID *"}),e.jsx("input",{type:"text",value:M.leagueId,onChange:H=>E({...M,leagueId:H.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-")}),placeholder:"e.g., front-range-pool",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"League Name *"}),e.jsx("input",{type:"text",value:M.name,onChange:H=>E({...M,name:H.target.value}),placeholder:"e.g., Front Range Pool League",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:M.description,onChange:H=>E({...M,description:H.target.value}),placeholder:"Brief description of the league"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Admin Email *"}),e.jsx("input",{type:"email",value:M.adminEmail,onChange:H=>E({...M,adminEmail:H.target.value}),placeholder:"admin@league.com",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Admin Name *"}),e.jsx("input",{type:"text",value:M.adminName,onChange:H=>E({...M,adminName:H.target.value}),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Assign Operator (Optional)"}),e.jsx("input",{type:"email",value:M.operatorEmail,onChange:H=>E({...M,operatorEmail:H.target.value}),placeholder:"operator@league.com"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:r,children:r?e.jsx(xa,{className:"spinner"}):"Create League"})]})]})}),e.jsx(It,{isOpen:x,onClose:()=>j(!1),title:"Create League Operator",maxWidth:"500px",children:e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email *"}),e.jsx("input",{type:"email",value:P.email,onChange:H=>D({...P,email:H.target.value}),placeholder:"operator@example.com",required:!0})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:P.firstName,onChange:H=>D({...P,firstName:H.target.value}),placeholder:"John",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:P.lastName,onChange:H=>D({...P,lastName:H.target.value}),placeholder:"Doe",required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"tel",value:P.phone,onChange:H=>D({...P,phone:H.target.value}),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password *"}),e.jsx("input",{type:"password",value:P.password,onChange:H=>D({...P,password:H.target.value}),placeholder:"Enter password",required:!0})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:r,children:r?e.jsx(xa,{className:"spinner"}):"Create Operator"})]})]})}),e.jsx(It,{isOpen:S,onClose:()=>_(!1),title:"Create Platform Admin",maxWidth:"600px",children:e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email *"}),e.jsx("input",{type:"email",value:T.email,onChange:H=>A({...T,email:H.target.value}),placeholder:"admin@platform.com",required:!0})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"First Name *"}),e.jsx("input",{type:"text",value:T.firstName,onChange:H=>A({...T,firstName:H.target.value}),placeholder:"Admin",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Last Name *"}),e.jsx("input",{type:"text",value:T.lastName,onChange:H=>A({...T,lastName:H.target.value}),placeholder:"User",required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"tel",value:T.phone,onChange:H=>A({...T,phone:H.target.value}),placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password *"}),e.jsx("input",{type:"password",value:T.password,onChange:H=>A({...T,password:H.target.value}),placeholder:"Enter password",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Role *"}),e.jsxs("select",{value:T.role,onChange:H=>A({...T,role:H.target.value}),required:!0,children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"support",children:"Support"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Permissions"}),e.jsx("div",{className:"permissions-grid",children:Object.entries(T.permissions).map(([H,ue])=>e.jsxs("label",{className:"permission-checkbox",children:[e.jsx("input",{type:"checkbox",checked:ue,onChange:J=>A({...T,permissions:{...T.permissions,[H]:J.target.checked}})}),H.replace(/([A-Z])/g," $1").replace(/^./,J=>J.toUpperCase())]},H))})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",onClick:()=>_(!1),className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:r,children:r?e.jsx(xa,{className:"spinner"}):"Create Admin"})]})]})}),e.jsx("style",{jsx:!0,children:`
        .platform-admin-dashboard {
          padding: 20px;
          max-width: 1200px;
          margin: 0 auto;
        }

        .dashboard-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 30px;
          padding-bottom: 20px;
          border-bottom: 2px solid #e0e0e0;
        }

        .dashboard-tabs {
          display: flex;
          gap: 10px;
          margin-bottom: 30px;
          border-bottom: 1px solid #e0e0e0;
        }

        .tab {
          padding: 12px 24px;
          border: none;
          background: none;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 8px;
          border-bottom: 3px solid transparent;
          transition: all 0.3s ease;
        }

        .tab.active {
          border-bottom-color: #007bff;
          color: #007bff;
        }

        .tab:hover {
          background: #f8f9fa;
        }

        .stats-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          display: flex;
          align-items: center;
          gap: 15px;
        }

        .stat-icon {
          font-size: 2rem;
          color: #007bff;
        }

        .stat-content h3 {
          margin: 0;
          font-size: 2rem;
          color: #333;
        }

        .stat-content p {
          margin: 5px 0 0 0;
          color: #666;
        }

        .quick-actions {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .action-buttons {
          display: flex;
          gap: 15px;
          flex-wrap: wrap;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
        }

        .leagues-grid,
        .operators-grid,
        .admins-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
          gap: 20px;
        }

        .league-card,
        .operator-card,
        .admin-card {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .league-header,
        .operator-header,
        .admin-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
        }

        .status-badge,
        .role-badge {
          padding: 4px 8px;
          border-radius: 4px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .status-badge.active { background: #d4edda; color: #155724; }
        .status-badge.trial { background: #fff3cd; color: #856404; }
        .status-badge.expired { background: #f8d7da; color: #721c24; }

        .role-badge.admin { background: #cce5ff; color: #004085; }
        .role-badge.support { background: #d1ecf1; color: #0c5460; }

        .league-details,
        .operator-details,
        .admin-details {
          margin-bottom: 15px;
        }

        .league-details p,
        .operator-details p,
        .admin-details p {
          margin: 5px 0;
          font-size: 0.9rem;
        }

        .league-actions,
        .operator-actions,
        .admin-actions {
          display: flex;
          gap: 10px;
          flex-wrap: wrap;
        }

        .btn-primary,
        .btn-secondary,
        .btn-small {
          padding: 10px 20px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 8px;
          font-size: 0.9rem;
          transition: all 0.3s ease;
        }

        .btn-primary {
          background: #007bff;
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          background: #0056b3;
        }

        .btn-secondary {
          background: #6c757d;
          color: white;
        }

        .btn-secondary:hover:not(:disabled) {
          background: #545b62;
        }

        .btn-small {
          padding: 6px 12px;
          font-size: 0.8rem;
        }

        .btn-danger {
          background: #dc3545;
          color: white;
        }

        .btn-danger:hover {
          background: #c82333;
        }

        .btn-primary:disabled,
        .btn-secondary:disabled {
          background: #ccc;
          cursor: not-allowed;
        }

        .form-group {
          margin-bottom: 15px;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
        }

        .form-group label {
          display: block;
          margin-bottom: 5px;
          font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
        }

        .permissions-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 10px;
        }

        .permission-checkbox {
          display: flex;
          align-items: center;
          gap: 8px;
          font-size: 0.9rem;
        }

        .form-actions {
          display: flex;
          gap: 15px;
          justify-content: flex-end;
          margin-top: 20px;
          padding-top: 20px;
          border-top: 1px solid #e0e0e0;
        }

        .error-message,
        .success-message {
          padding: 10px;
          margin-bottom: 20px;
          border-radius: 4px;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .error-message {
          background: #fee;
          color: #c33;
          border: 1px solid #fcc;
        }

        .success-message {
          background: #efe;
          color: #363;
          border: 1px solid #cfc;
        }

        .spinner {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .dashboard-header {
            flex-direction: column;
            gap: 15px;
            align-items: stretch;
          }

          .dashboard-tabs {
            flex-wrap: wrap;
          }

          .tab {
            flex: 1;
            min-width: 120px;
          }

          .stats-grid {
            grid-template-columns: 1fr;
          }

          .leagues-grid,
          .operators-grid,
          .admins-grid {
            grid-template-columns: 1fr;
          }

          .action-buttons {
            flex-direction: column;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .permissions-grid {
            grid-template-columns: 1fr;
          }
        }
      `})]})}const fV=!1;function gV({onSuccess:n,onShowSignup:t,compact:r=!1}){const[s,a]=y.useState(""),[o,i]=y.useState(!1),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState(!1),g=async x=>{if(x==null||x.preventDefault(),!(l!=null&&l.trim())||!d){a("Please enter email and password.");return}a(""),i(!0);try{const j=await Hl.signIn(l.trim(),d);j.success?(a(" Signing you in..."),n==null||n(j.user)):a(j.message||"Sign in failed. Please try again.")}catch{a("Sign in failed. Please try again.")}finally{i(!1)}},f=async x=>{a(""),i(!0),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const j=typeof window<"u"&&window.location.pathname||"/hub";localStorage.setItem("oauthReturnTo",j||"/hub");try{const S=await Hl.signInWithOAuth(x);S.success||(a(S.message||`Failed to sign in with ${x}.`),i(!1))}catch(S){console.error(`${x} OAuth error:`,S),a(`Failed to sign in with ${x}. Please try again.`),i(!1)}},m=window.innerWidth<=768,v=r||m,b=e.jsxs("button",{type:"button",onClick:()=>f("google"),disabled:o,style:{width:"100%",padding:v?m?"12px":"10px 14px":m?"14px":"16px",background:"#ffffff",color:"#333",border:"1px solid #ddd",borderRadius:m?"8px":"10px",fontSize:m?"0.9rem":"1rem",fontWeight:"600",cursor:o?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:o?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"all 0.2s ease"},onMouseEnter:x=>{o||(x.target.style.transform="translateY(-2px)",x.target.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)")},onMouseLeave:x=>{x.target.style.transform="translateY(0)",x.target.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"Google",style:{height:"24px",width:"24px"}}),"Continue with Google"]}),w=e.jsxs("form",{onSubmit:g,style:{display:"flex",flexDirection:"column",gap:v?"6px":m?"12px":"15px"},children:[e.jsx("input",{type:"email",placeholder:"Email",value:l,onChange:x=>c(x.target.value),disabled:o,style:{width:"100%",padding:v?"8px 10px":m?"12px 14px":"14px 16px",borderRadius:m?"8px":"10px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:r?"0.85rem":m?"0.95rem":"1rem"}}),e.jsxs("div",{style:{position:"relative",width:"100%"},children:[e.jsx("input",{type:h?"text":"password",placeholder:"Password",value:d,onChange:x=>u(x.target.value),disabled:o,style:{width:"100%",padding:v?"8px 44px 8px 10px":m?"12px 44px 12px 14px":"14px 44px 14px 16px",borderRadius:m?"8px":"10px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:r?"0.85rem":m?"0.95rem":"1rem"}}),e.jsx("button",{type:"button",onClick:()=>p(x=>!x),"aria-label":h?"Hide password":"Show password",style:{position:"absolute",right:"6px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#999",cursor:"pointer",padding:"4px 8px",fontSize:"0.9rem"},children:h?"":""})]}),e.jsx("button",{type:"submit",disabled:o||!(l!=null&&l.trim())||!d,style:{width:"100%",padding:v?"8px 10px":m?"14px":"16px",background:o||!(l!=null&&l.trim())||!d?"#555":"linear-gradient(135deg, #e53e3e 0%, #c53030 100%)",color:"#fff",border:"none",borderRadius:m?"8px":"10px",fontSize:r?"0.85rem":m?"0.9rem":"1rem",fontWeight:"600",cursor:o||!(l!=null&&l.trim())||!d?"not-allowed":"pointer",opacity:o||!(l!=null&&l.trim())||!d?.6:1},children:o?"Signing in...":"Sign in with Email"})]});return r&&!m?e.jsx("div",{style:{width:"100%"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.92), rgba(43, 43, 43, 0.85))",border:"2px solid #e53e3e",borderRadius:"12px",padding:"12px 20px",width:"100%",boxShadow:"0 4px 20px rgba(0,0,0,0.5), 0 0 60px rgba(229, 62, 62, 0.2)",color:"#ffffff",display:"flex",flexDirection:"row",alignItems:"stretch",gap:"20px",minHeight:0},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:"8px",minWidth:0},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"4px"},children:[e.jsx("h2",{style:{margin:"0 0 2px 0",fontSize:"1.2rem",color:"#fff",fontWeight:"bold"},children:"Welcome Back"}),e.jsx("p",{style:{margin:0,color:"#ccc",fontSize:"0.85rem"},children:"Sign in with Google or email"})]}),b]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",minWidth:0,borderLeft:"1px solid rgba(255,255,255,0.15)",paddingLeft:"20px"},children:[s&&e.jsx("div",{style:{background:s.includes("")?"rgba(76, 175, 80, 0.2)":"rgba(220, 53, 69, 0.2)",border:`1px solid ${s.includes("")?"rgba(76, 175, 80, 0.5)":"rgba(220, 53, 69, 0.5)"}`,padding:"8px 12px",borderRadius:"6px",color:s.includes("")?"#4CAF50":"#dc3545",fontSize:"0.85rem",marginBottom:"10px"},children:s}),e.jsx("div",{style:{marginBottom:"8px"},children:w}),e.jsx("p",{style:{margin:"6px 0 0 0",fontSize:"0.75rem",color:"#999"},children:e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline"},children:"Need help?"})}),t&&e.jsx("button",{type:"button",onClick:t,style:{width:"100%",padding:"8px 12px",background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",marginTop:"8px"},children:" New User? Sign Up"})]})]})}):e.jsx("div",{children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.82), rgba(43, 43, 43, 0.69))",border:"2px solid #e53e3e",borderRadius:m?"8px":"15px",padding:v?m?"20px":"16px 20px":"30px",width:"100%",maxWidth:"100%",boxShadow:"0 10px 30px rgba(0,0,0,0.5), 0 0 100px rgba(229, 62, 62, 0.3)",color:"#ffffff",display:"flex",flexDirection:"column",justifyContent:"center"},children:[!m&&e.jsxs("div",{style:{textAlign:"center",marginBottom:v?"12px":"30px"},children:[e.jsx("h1",{style:{margin:"0 0 4px 0",fontSize:r?"1.4rem":"2rem",color:"#ffffff",fontWeight:"bold"},children:"Welcome Back"}),e.jsx("p",{style:{margin:0,color:"#cccccc",fontSize:r?"0.9rem":"1rem"},children:"Sign in with Google or email"})]}),s&&e.jsx("div",{style:{background:s.includes("")?"rgba(76, 175, 80, 0.1)":"rgba(220, 53, 69, 0.1)",border:`1px solid ${s.includes("")?"rgba(76, 175, 80, 0.3)":"rgba(220, 53, 69, 0.3)"}`,padding:"12px",borderRadius:"6px",marginBottom:"20px",color:s.includes("")?"#4CAF50":"#dc3545",fontSize:m?"0.85rem":"0.9rem",textAlign:"center"},children:s}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:v?"8px":m?"12px":"15px",marginBottom:v?"12px":"25px"},children:[b,fV]}),e.jsx("div",{style:{marginBottom:v?"8px":"20px",textAlign:"center",color:"#999",fontSize:r?"0.8rem":"0.9rem"},children:" or sign in with email "}),w,e.jsx("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:v?"10px 12px":"16px",marginBottom:v?"10px":"20px",marginTop:v?"8px":"15px",textAlign:"center"},children:e.jsxs("p",{style:{color:"#ccc",margin:0,fontSize:m?"0.8rem":"0.9rem"},children:["Need help? ",e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline",fontWeight:"bold"},children:"Contact admin"})]})}),t&&e.jsx("button",{type:"button",onClick:t,style:{width:"100%",padding:v?m?"12px":"10px 14px":m?"14px":"16px",background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",border:"none",borderRadius:m?"8px":"10px",fontSize:v?m?"0.9rem":"0.95rem":m?"0.95rem":"1.1rem",fontWeight:"bold",cursor:"pointer",marginTop:v?"6px":"10px",boxShadow:"0 4px 15px rgba(76, 175, 80, 0.4)",transition:"all 0.3s ease"},onMouseEnter:x=>{x.target.style.transform="translateY(-2px)",x.target.style.boxShadow="0 6px 20px rgba(76, 175, 80, 0.5)"},onMouseLeave:x=>{x.target.style.transform="translateY(0)",x.target.style.boxShadow="0 4px 15px rgba(76, 175, 80, 0.4)"},children:" New User? Sign Up Here"})]})})}const dh="/assets/logo-38c98395.png",vu="/assets/bcapl_logo-4e2488a3.png",xV="/assets/csi_logo-ce9c4d05.png",GC="/assets/usapl_logo-0be33ca3.png",Wx="/assets/usapl_nationals_logo_color-01c37b2e.png",VC="/assets/fargorate-logo-aa89a03b.png",yV="/assets/8ball-35eff270.svg",bV="/assets/nineball-545f1e90.svg",KC="/assets/tenball-c626129a.svg",Ux="/assets/LBC logo with address-972110b7.png";function vV(){const[n,t]=y.useState(window.innerWidth),[r,s]=y.useState(window.innerHeight),[a]=y.useState(()=>[0,1,2,3,4,5,6,7,8,9].map(j=>{const S=.1+Math.random()*.15,_=Math.random()*Math.PI*2;return{x:Math.random()*n,y:Math.random()*r,vx:Math.cos(_)*S*1.2,vy:Math.sin(_)*S*1.2,baseSize:.8+Math.random()*.4,sizePhase:Math.random()*Math.PI*2,isSizeChanger:!1,speedCategory:"base",lastChange:Date.now(),changeInterval:8e3+Math.random()*12e3,rotationDirection:j>=5?Math.random()>.5?1:-1:0}}));y.useEffect(()=>{const j=()=>{t(window.innerWidth),s(window.innerHeight)};return window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]);function o(j,S,_){const[C,N]=y.useState(j);y.useRef(null);const M=y.useRef(j);return y.useEffect(()=>{let E,P=Date.now();const D=()=>{const T=Date.now(),A=T-P,k=M.current;if(T-k.lastChange>k.changeInterval){const ue=_.includes(S)?"fast":"base",J={...k,speedCategory:ue,lastChange:T,changeInterval:3e3+Math.random()*6e3};M.current=J,N(J)}if(Math.random()<.003){const H=Math.atan2(k.vy,k.vx),ue=(Math.random()-.5)*Math.PI*.3,J=H+ue,be=.3+Math.random()*1,Ae=k.speedCategory==="fast"?.6:.2;k.vx=Math.cos(J)*be*Ae,k.vy=Math.sin(J)*be*Ae}let R=k.x+k.vx*(A/16),U=k.y+k.vy*(A/16);(R<0||R>n||U<0||U>r)&&(k.edgeShrink||(k.edgeShrink=!0,k.edgeShrinkTime=T));const z=T/1e3;let $=k.baseSize;const W=Math.sin(z*.07+k.sizePhase)*.1,Y=Math.sin(z*.35+k.sizePhase*2)*.05;if($=k.baseSize+W+Y,$<k.baseSize*.3&&!k.sizeShrink&&(k.sizeShrink=!0,k.sizeShrinkTime=T),k.edgeShrink){const H=T-k.edgeShrinkTime;if(H<2e3){const J=1-H/2e3;k.edgeOpacity=J,$=k.baseSize+W+Y}else if(H<4e3)k.edgeOpacity=.01,$=.01;else if(H<4100)R=Math.random()*n,U=Math.random()*r,k.x=R,k.y=U,$=.01,k.edgeOpacity=.01;else if(H<12500){const J=.01+.99*((H-4100)/8400);$*=J,k.edgeOpacity=J}else k.edgeShrink=!1,k.edgeOpacity=1}else k.edgeOpacity=1;if(k.sizeShrink){const H=T-k.sizeShrinkTime;if(H<2e3){const J=1-H/2e3;k.sizeOpacity=J}else if(H<4e3)k.sizeOpacity=.01,$=.01;else if(H<4100)R=Math.random()*n,U=Math.random()*r,k.x=R,k.y=U,$=.01,k.sizeOpacity=.01;else if(H<12500){const J=.01+.99*((H-4100)/8400);$*=J,k.sizeOpacity=J}else k.sizeShrink=!1,k.sizeOpacity=1}else k.sizeOpacity=1;let Q=k.rotation||0;if(S>=5){const ue=(Math.sqrt(k.vx*k.vx+k.vy*k.vy)*2+.3)*(A/16)*(k.rotationDirection||1);Q+=ue}M.current={...k,x:R,y:U,size:$,rotation:Q},T-P>100&&(N(M.current),P=T),E=requestAnimationFrame(D)};return D(),()=>cancelAnimationFrame(E)},[n,r,_]),C}y.useState(()=>{const j=[];for(;j.length<3;){const _=Math.floor(Math.random()*10);j.includes(_)||j.push(_)}const S=[];for(;S.length<3;){const _=Math.floor(Math.random()*10);!S.includes(_)&&!j.includes(_)&&S.push(_)}return a.forEach((_,C)=>{j.includes(C)?(_.speedCategory="fast",_.vx=(Math.random()-.5)*2,_.vy=(Math.random()-.5)*2):(_.speedCategory="base",_.vx=(Math.random()-.5)*.5,_.vy=(Math.random()-.5)*.5),S.includes(C)&&(_.isSizeChanger=!0)}),!0});const[i,l]=y.useState(()=>{const j=[];for(;j.length<3;){const S=Math.floor(Math.random()*10);j.includes(S)||j.push(S)}return j}),c=()=>{const j=[];for(;j.length<3;){const S=Math.floor(Math.random()*10);j.includes(S)||j.push(S)}l(j)};y.useEffect(()=>{const j=setInterval(()=>{c(),console.log("Speed reassignment triggered")},4e3+Math.random()*4e3);return()=>clearInterval(j)},[]);const d=o(a[0],0,i),u=o(a[1],1,i),h=o(a[2],2,i),p=o(a[3],3,i),g=o(a[4],4,i),f=o(a[5],5,i),m=o(a[6],6,i),v=o(a[7],7,i),b=o(a[8],8,i),w=o(a[9],9,i),x=(j,S,_,C,N=!1)=>{const M=N&&j.rotation||0;return{position:"absolute",left:j.x,top:j.y,transform:`translate(-50%, -50%) scale(${j.size}) rotate(${M}deg)`,width:S,height:"auto",opacity:_*(j.edgeOpacity||1)*(j.sizeOpacity||1),zIndex:1,pointerEvents:"none",filter:C,transition:"none"}};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:1,pointerEvents:"none",overflow:"hidden"},children:[e.jsx("img",{src:dh,alt:"League Logo Background",style:x(d,150,.75,"drop-shadow(0 0 24px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:vu,alt:"BCAPL Logo Background",style:x(u,120,.75,"drop-shadow(0 0 18px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:xV,alt:"CSI Logo Background",style:x(h,120,.75,"drop-shadow(0 0 12px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:GC,alt:"USAPL Logo Background",style:x(p,140,.8,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:VC,alt:"Fargorate Logo Background",style:x(g,140,.8,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:yV,alt:"8 Ball Background",style:x(f,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)}),e.jsx("img",{src:bV,alt:"9 Ball Background",style:x(m,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)}),e.jsx("img",{src:KC,alt:"10 Ball Background",style:x(v,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)}),e.jsx("img",{src:Ux,alt:"Legends Logo Background",style:x(b,160,.75,"drop-shadow(0 0 20px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:Wx,alt:"USAPL Nationals Logo Background",style:x(w,140,.75,"drop-shadow(0 0 15px rgba(245, 30, 30, 0.2))")})]})}const wV="_simplePoolGame_1kwr6_1",jV="_tableContainer_1kwr6_11",SV="_tableCanvas_1kwr6_22",_V="_aimingInstructions_1kwr6_35",kV="_instructions_1kwr6_47",CV="_controls_1kwr6_52",NV="_shootControl_1kwr6_64",TV="_shootButton_1kwr6_70",PV="_disabled_1kwr6_86",EV="_buttonRow_1kwr6_105",RV="_resetAimButton_1kwr6_111",AV="_powerControl_1kwr6_145",MV="_testCueStick_1kwr6_151",IV="_cueStickBar_1kwr6_161",DV="_cueStickHandle_1kwr6_193",$V="_cueStickSlider_1kwr6_240",LV="_gameInfo_1kwr6_274",BV="_resetButton_1kwr6_291",OV="_callShotModal_1kwr6_388",zV="_callShotContent_1kwr6_401",FV="_callShotOptions_1kwr6_442",WV="_ballSelection_1kwr6_449",UV="_pocketSelection_1kwr6_450",qV="_pushOutOption_1kwr6_480",HV="_callShotButtons_1kwr6_505",YV="_callShotTable_1kwr6_558",GV="_tableBackground_1kwr6_565",VV="_pocket_1kwr6_450",KV="_selectedPocket_1kwr6_617",JV="_topLeft_1kwr6_626",XV="_topCenter_1kwr6_627",QV="_topRight_1kwr6_628",ZV="_bottomLeft_1kwr6_629",eK="_bottomCenter_1kwr6_630",tK="_bottomRight_1kwr6_631",rK="_callShotBall_1kwr6_633",nK="_selectedBall_1kwr6_663",sK="_selectionDisplay_1kwr6_672",aK="_selectedInfo_1kwr6_682",oK="_pushOutModal_1kwr6_710",iK="_pushOutContent_1kwr6_723",lK="_pushOutButtons_1kwr6_762",cK="_acceptButton_1kwr6_768",dK="_declineButton_1kwr6_769",Qr={simplePoolGame:wV,tableContainer:jV,tableCanvas:SV,aimingInstructions:_V,instructions:kV,controls:CV,shootControl:NV,shootButton:TV,disabled:PV,buttonRow:EV,resetAimButton:RV,powerControl:AV,testCueStick:MV,cueStickBar:IV,cueStickHandle:DV,cueStickSlider:$V,gameInfo:LV,resetButton:BV,callShotModal:OV,callShotContent:zV,callShotOptions:FV,ballSelection:WV,pocketSelection:UV,pushOutOption:qV,callShotButtons:HV,callShotTable:YV,tableBackground:GV,pocket:VV,selectedPocket:KV,topLeft:JV,topCenter:XV,topRight:QV,bottomLeft:ZV,bottomCenter:eK,bottomRight:tK,callShotBall:rK,selectedBall:nK,selectionDisplay:sK,selectedInfo:aK,pushOutModal:oK,pushOutContent:iK,pushOutButtons:lK,acceptButton:cK,declineButton:dK},Yl={BREAK:"break",PLAY:"play"};function al(n){return n===Yl.BREAK}function Ug(n){return n===Yl.PLAY}function uK(n,t){return n===Yl.BREAK&&t?Yl.PLAY:n}function hK(n,t){return n===Yl.BREAK&&t}function r2(n,t){return n===Yl.PLAY&&t}const pK="/assets/cueball-dc05310a.svg",mK="/assets/ball1-ceef28e6.svg",fK="/assets/ball2-cbc193d1.svg",gK="/assets/ball3-215e1e48.svg",xK="/assets/ball4-c3f7b27d.svg",yK="/assets/ball5-4ebd3c1c.svg",bK="/assets/ball6-4b0303af.svg",vK="/assets/ball7-3d7df680.svg",wK="/assets/ball8-b55dbd31.svg",jK="/assets/ball9-815f924b.svg",SK="/assets/PredatorTable-79481951.png",Br=600,hn=300,Qt=15,Gt=Qt/2,fa=1.3,mc=.9,Yd=30,qg=160,Gd=24.5,Hg=270.18,n2=Br*.75,s2=hn/2,Yg=Gt*.1,a2=.7,o2=.45,i2=.05,cp=.99,si=.75,ai=.75,ga=.95,oi=.3,_K=.8,wn=(...n)=>{},qx=({onGameEnd:n})=>{const t=y.useRef(null),[r,s]=y.useState({balls:[],cueBall:{x:100,y:150,originalX:100,originalY:150,vx:0,vy:0,visible:!0,isMoving:!1,rotation:0,rotationSpeed:0,spinX:0,spinY:0},isAnimating:!1,currentPlayer:1,gamePhase:Yl.BREAK,ballInHand:!1,scratchOccurred:!1}),[a,o]=y.useState(!1),[i,l]=y.useState({x:0,y:0}),[c,d]=y.useState(0),[u,h]=y.useState(.5),[p,g]=y.useState(0),[f,m]=y.useState(0),[v,b]=y.useState(!0),[w,x]=y.useState(null),[j,S]=y.useState(null),[_,C]=y.useState(null),[N,M]=y.useState(!1),[E,P]=y.useState(!1),[D,T]=y.useState(0),[A,k]=y.useState(!1),[R,U]=y.useState(null),[z,$]=y.useState(null);y.useState(!1);const[W,Y]=y.useState(!1),[Q,H]=y.useState(!1),[ue,J]=y.useState(!1),[be,Ae]=y.useState(!1),[O,oe]=y.useState(!1),[me,Ce]=y.useState(null),[ve,De]=y.useState(!1),[Oe,Ze]=y.useState({1:0,2:0}),[et,re]=y.useState(null),[je,V]=y.useState(null),[Ee,F]=y.useState(!1),[ae,I]=y.useState(null),[X,fe]=y.useState(!1),[ne,ye]=y.useState(!1),[ot,lt]=y.useState(!1),[tt,ge]=y.useState(!1),[xt,ht]=y.useState(null),[Je,Pe]=y.useState(0),[Ve,we]=y.useState([]),[Re,it]=y.useState(!1),rt=y.useRef(null),yt={cue:pK,1:mK,2:fK,3:gK,4:xK,5:yK,6:bK,7:vK,8:wK,9:jK,10:KC},kt=y.useRef({}),Ct=y.useRef(null),te=y.useRef(null),ke=(()=>[{x:30,y:24.5,id:"top-left"},{x:570.77,y:24.5,id:"top-right"},{x:30,y:270.18,id:"bottom-left"},{x:570.77,y:270.18,id:"bottom-right"},{x:300.385,y:24.5,id:"top-center"},{x:300.385,y:270.18,id:"bottom-center"}])(),We=y.useCallback(Se=>{if(!W)return;const G=t.current.getBoundingClientRect(),He=G.width/Br,Xe=(Se.clientX-G.left)/He,nt=(Se.clientY-G.top)/He,At=r.balls.find(Nt=>Nt.visible&&!Nt.pocketed&&Math.sqrt((Nt.x-Xe)**2+(Nt.y-nt)**2)<Gt*1.5);if(At){U(At.id);return}const vt=ke.find(Nt=>Math.sqrt((Nt.x-Xe)**2+(Nt.y-nt)**2)<60);if(vt){$(vt.id);return}},[W,r.balls,ke]),Fe=y.useCallback((Se,G)=>{const Nt=[{x:30,y:24.5,id:"top-left"},{x:570.77,y:24.5,id:"top-right"},{x:30,y:270.18,id:"bottom-left"},{x:570.77,y:270.18,id:"bottom-right"},{x:300.385,y:24.5,id:"top-center"},{x:300.385,y:270.18,id:"bottom-center"}];let tr=null,qt=1/0;return Nt.forEach(or=>{const Ht=Math.hypot(Se-or.x,G-or.y);Ht<qt&&(qt=Ht,tr=or)}),tr?tr.id:null},[]),st=y.useCallback(Se=>{const vt=[{x:30,y:24.5,margin:Qt*fa,type:"corner"},{x:570.77,y:24.5,margin:Qt*fa,type:"corner"},{x:30,y:270.18,margin:Qt*fa,type:"corner"},{x:570.77,y:270.18,margin:Qt*fa,type:"corner"},{x:300.385,y:24.5,margin:Qt*mc,type:"side"},{x:300.385,y:270.18,margin:Qt*mc,type:"side"}],Nt=Se.x,tr=Se.y,qt=Se.vx??0,or=Se.vy??0,Ht=Math.hypot(qt,or);return vt.some(Rt=>{const Ue=Rt.x-Nt,ft=Rt.y-tr,wt=Math.hypot(Ue,ft);if(wt>=Rt.margin+Yg)return!1;if(Ht>0){const Lt=(qt*Ue+or*ft)/(Ht*(wt||1)),yr=Rt.type==="side"?a2:o2,Sr=(qt*Ue+or*ft)/(wt||1);if(Lt<yr||Sr<i2)return!1}return!0})},[]),Ft=y.useCallback((Se,G)=>Se>=Yd&&Se<=qg&&G>=Gd&&G<=Hg,[]);y.useCallback(()=>{s(Se=>({...Se,scratchOccurred:!0,ballInHand:!0,currentPlayer:Se.currentPlayer===1?2:1,cueBall:{...Se.cueBall,x:100,y:150,vx:0,vy:0,visible:!0,isMoving:!1,rotation:0,rotationSpeed:0}}))},[]);const Le=y.useCallback(()=>{const Se=r.balls.filter(He=>He.visible&&!He.pocketed);if(wn("Visible balls on table:",Se.map(He=>He.id).sort((He,Xe)=>He-Xe)),Se.length===0)return null;const G=Se.reduce((He,Xe)=>Xe.id<He.id?Xe:He);return wn("Lowest numbered ball:",G.id),G},[r.balls]),Z=y.useCallback(()=>{if(Q)return null;const Se=ae||Le();let G=null;if(r.cueBall.visible||(G="scratch"),r.gamePhase==="break"){je&&je!==1&&(G="break_wrong_ball_first");const He=r.balls.filter(nt=>nt.pocketed&&!nt.wasPocketedBeforeShot),Xe=Je;He.length===0&&Xe<4&&(G="break_insufficient_cushions")}return!G&&je&&Se&&je!==Se.id&&(wn("Wrong ball first foul - Hit:",je,"Lowest:",Se.id),wn("Visible balls on table:",r.balls.filter(He=>He.visible&&!He.pocketed).map(He=>He.id).sort((He,Xe)=>He-Xe)),G="wrong_ball_first"),!G&&!ne&&!Q&&r.gamePhase!=="break"&&(G="no_contact"),!G&&ne&&!Ee&&r.balls.filter(Xe=>Xe.pocketed&&!Xe.wasPocketedBeforeShot).length===0&&(G="no_rail_contact"),wn("Current lowest ball:",Se?Se.id:"none"),G},[Q,je,Ee,ne,Le,r.balls,ae,r.cueBall.visible,r.gamePhase,Je]),Ye=y.useCallback(()=>{if(r.gamePhase==="break"||Q)return[];const Se=r.balls.filter(He=>He.pocketed&&!He.wasPocketedBeforeShot);if(Se.length===0)return[];const G=[];return Se.forEach(He=>{if(He.id===R)He.pocketedPocket!==z&&(wn("Illegally pocketed ball:",He.id,"- called ball went in wrong pocket"),G.push(He));else{const Xe=Se.find(nt=>nt.id===R);(!Xe||Xe.pocketedPocket!==z)&&(wn("Illegally pocketed ball:",He.id,"- not called ball and called ball not legally pocketed"),G.push(He))}}),G},[r.gamePhase,Q,R,z,r.balls]),dt=y.useCallback(Se=>{const G=xt||r.currentPlayer;window.dispatchEvent(new CustomEvent("gameFoul",{detail:{foulType:Se,player:G}})),Se==="scratch"?window.dispatchEvent(new CustomEvent("scratchFoul",{detail:{player:G}})):Se==="wrong_ball_first"?window.dispatchEvent(new CustomEvent("wrongBallFoul",{detail:{player:G}})):Se==="no_rail_contact"&&window.dispatchEvent(new CustomEvent("noRailFoul",{detail:{player:G}})),window.dispatchEvent(new CustomEvent("ballInHand",{detail:{player:G}})),Ze(He=>{const Xe={...He,[G]:He[G]+1};return Xe[G]>=3&&(window.dispatchEvent(new CustomEvent("threeFoul",{detail:{player:G}})),alert(`Player ${G} loses due to 3 consecutive fouls!`)),Xe}),s(He=>({...He,ballInHand:!0,currentPlayer:He.currentPlayer===1?2:1,scratchOccurred:Se==="scratch"})),Se==="scratch"&&s(He=>({...He,cueBall:{...He.cueBall,visible:!0,x:100,y:150,vx:0,vy:0}})),re(Se)},[r.currentPlayer,xt]),pt=y.useCallback((Se,G)=>{const He=r.cueBall;return Math.hypot(Se-He.x,G-He.y)<=Gt},[r.cueBall]),Tt=y.useCallback((Se,G)=>{(r.ballInHand||r.gamePhase==="break")&&pt(Se,G)&&(o(!0),l({x:Se-r.cueBall.x,y:G-r.cueBall.y}))},[r.ballInHand,r.gamePhase,r.cueBall,pt]),Wt=y.useCallback((Se,G)=>{if(a){const He=Se-i.x,Xe=G-i.y;let nt,At;r.gamePhase==="break"?(nt=Math.max(Yd+Gt,Math.min(qg-Gt,He)),At=Math.max(Gd+Gt,Math.min(Hg-Gt,Xe))):(nt=Math.max(30+Gt,Math.min(570.77-Gt,He)),At=Math.max(24.5+Gt,Math.min(270.18-Gt,Xe))),s(vt=>({...vt,cueBall:{...vt.cueBall,x:nt,y:At}}))}},[a,i,r.gamePhase]),ir=y.useCallback(()=>{a&&o(!1)},[a]);y.useCallback((Se,G)=>{Ft(Se,G)&&s(He=>({...He,cueBall:{...He.cueBall,x:Se,y:G,vx:0,vy:0,visible:!0,isMoving:!1},ballInHand:!1}))},[Ft]),y.useCallback((Se,G)=>{let He=null,Xe=1/0;return ke.forEach(nt=>{const At=Math.hypot(Se-nt.x,G-nt.y);At<Xe&&(Xe=At,He=nt)}),He},[]);const rr=y.useCallback((Se,G,He,Xe)=>{const nt=Se-He,At=G-Xe,vt=Math.sqrt(nt*nt+At*At);if(vt<Gt*2)return null;const Nt=Se-nt/vt*(Gt*2),tr=G-At/vt*(Gt*2);return{x:Nt,y:tr}},[]);function Pr(Se,G){return Se>=15&&Se<=30&&G>=hn-75&&G<=hn-60}function Fn(Se,G,He,Xe,nt){r2(nt,Xe)&&(Se.fillStyle="rgba(255, 215, 0, 0.2)",Se.fillRect(10,G-80,200,25),Se.strokeStyle="rgba(255, 215, 0, 0.5)",Se.lineWidth=1,Se.strokeRect(10,G-80,200,25),Se.fillStyle="rgba(255, 215, 0, 0.9)",Se.font="12px Arial",Se.textAlign="left",Se.fillText("Push Out Available",15,G-65),Se.fillStyle=He?"rgba(255, 215, 0, 0.9)":"rgba(255, 255, 255, 0.3)",Se.fillRect(15,G-75,15,15),Se.strokeStyle="rgba(255, 215, 0, 0.8)",Se.lineWidth=2,Se.strokeRect(15,G-75,15,15),He&&(Se.fillStyle="rgba(255, 215, 0, 0.9)",Se.font="bold 16px Arial",Se.textAlign="center",Se.fillText("",22,G-65)))}function hs(Se,G){Se.setLineDash([]),Se.beginPath(),Se.moveTo(G[0].x,G[0].y);for(let He=1;He<G.length;He++){const Xe=G[He];Se.lineTo(Xe.x,Xe.y)}Se.stroke()}function cn(Se){let G="rgba(255, 255, 255, 0.8)";N?G="rgba(0, 255, 0, 0.95)":E&&(G="rgba(255, 255, 0, 0.9)"),Math.abs(p)>.1&&(p>0?G="rgba(76, 175, 80, 0.9)":G="rgba(244, 67, 54, 0.9)"),Se.strokeStyle=G,Se.lineWidth=N?4:E?2:3,Se.setLineDash([]),Se.globalAlpha=.9}function Ja(Se){const G=Br*.3,He=Br*.5*Se;return G+He}function Dr(Se,G){let He=Se-G;for(;He>Math.PI;)He-=Math.PI*2;for(;He<-Math.PI;)He+=Math.PI*2;return He}const Jr=y.useCallback((Se,G)=>{const Nt=[{x:30,y:24.5,id:"top-left"},{x:570.77,y:24.5,id:"top-right"},{x:30,y:270.18,id:"bottom-left"},{x:570.77,y:270.18,id:"bottom-right"},{x:300.385,y:24.5,id:"top-center"},{x:300.385,y:270.18,id:"bottom-center"}];let tr=null,qt=1/0;if(Nt.forEach(or=>{const Ht=Math.hypot(Se-or.x,G-or.y);Ht<qt&&(qt=Ht,tr=or)}),tr&&qt<80){const or=Math.max(0,(80-qt)/80),Ht=Se+(tr.x-Se)*or*.3,Rt=G+(tr.y-G)*or*.3;return{x:Ht,y:Rt,assisted:!0}}return{x:Se,y:G,assisted:!1}},[]),An=y.useCallback((Se,G,He=null,Xe={})=>{const{ignoreCuePocket:nt=!0}=Xe,At={},vt=.99,Nt=16,tr=30.77,qt=570.77,or=24.5,Ht=270.18,Rt={1:"#ffff00",2:"#0000ff",3:"#ff0000",4:"#800080",5:"#ffa500",6:"#008000",7:"#8b4513",8:"#000000",9:"#ffff00",10:"#ff0000"};return(()=>{const ft=new Map;r.balls.forEach(Lt=>{Lt.visible&&!Lt.pocketed&&ft.set(Lt.id,{id:Lt.id,x:Lt.x,y:Lt.y,vx:0,vy:0,visible:!0,isMoving:!1,trajectory:[{x:Lt.x,y:Lt.y}]})});const wt=He||r.cueBall;ft.set("cue",{id:"cue",x:wt.x,y:wt.y,vx:Se,vy:G,visible:!0,isMoving:!0,trajectory:[{x:wt.x,y:wt.y}]});for(let Lt=0;Lt<300;Lt++){const yr=Array.from(ft.values()).filter(jr=>jr.visible);for(let jr=0;jr<Nt;jr++)yr.forEach(Dt=>{if(Math.abs(Dt.vx)<.03&&Math.abs(Dt.vy)<.03){Dt.vx=0,Dt.vy=0;return}Dt.vx*=Math.pow(vt,1/Nt),Dt.vy*=Math.pow(vt,1/Nt);let Ar=Dt.x+Dt.vx/Nt,$r=Dt.y+Dt.vy/Nt,dn=!1;Ar<tr+Gt?(Dt.x=tr+Gt,Dt.vx=Math.abs(Dt.vx)*.85,dn=!0):Ar>qt-Gt?(Dt.x=qt-Gt,Dt.vx=-Math.abs(Dt.vx)*.8,dn=!0):Dt.x=Ar,$r<or+Gt?(Dt.y=or+Gt,Dt.vy=Math.abs(Dt.vy)*.85,dn=!0):$r>Ht-Gt?(Dt.y=Ht-Gt,Dt.vy=-Math.abs(Dt.vy)*.8,dn=!0):Dt.y=$r;let rs=!1;const un=(tr+qt)/2,Wn=[{x:tr,y:or,margin:Qt*fa},{x:qt,y:or,margin:Qt*fa},{x:tr,y:Ht,margin:Qt*fa},{x:qt,y:Ht,margin:Qt*fa},{x:un,y:or,margin:Qt*mc},{x:un,y:Ht,margin:Qt*mc}],tn=Dt.x,ns=Dt.y,le=Dt.vx??0,_e=Dt.vy??0,Me=Math.hypot(le,_e);let he=!1;if(nt||(he=Wn.some(Be=>{const ct=Be.x-tn,$t=Be.y-ns,qe=Math.hypot(ct,$t),jt=Be.margin+Yg;if(qe>=jt)return!1;if(Me>0){const Bt=(le*ct+_e*$t)/(Me*(qe||1)),Ot=Be.x===un?a2:o2,dr=(le*ct+_e*$t)/(qe||1);if(Bt<Ot||dr<i2)return!1}return!0})),he&&!(nt&&Dt.id==="cue")&&(rs=!0),!rs&&Dt.id!=="cue"){const Be=Jr(Dt.x,Dt.y);if(Be.assisted){const ct=Be.x-Dt.x,$t=Be.y-Dt.y;Math.sqrt(ct*ct+$t*$t)<5&&(rs=!0)}}if(rs){Dt.visible=!1,Dt.trajectory.push({x:Dt.x,y:Dt.y,pocketed:!0});return}Dt.isMoving&&Math.abs(Dt.vx)<.03&&Math.abs(Dt.vy)<.03&&(Dt.vx=0,Dt.vy=0,Dt.isMoving=!1),Dt.trajectory.push({x:Dt.x,y:Dt.y,bounced:dn})});const Sr=ft.get("cue");Sr&&Sr.visible&&ft.forEach((jr,Dt)=>{if(Dt!=="cue"&&jr.visible){const Ar=jr.x-Sr.x,$r=jr.y-Sr.y,dn=Math.sqrt(Ar*Ar+$r*$r);if(dn>0&&dn<Qt+.5){const rs=Qt-dn+.01,un=Ar/dn,Wn=$r/dn,tn=Math.max(rs/2,.1);Sr.x-=un*tn,Sr.y-=Wn*tn,jr.x+=un*tn,jr.y+=Wn*tn;const ns=Sr.vx-jr.vx,le=Sr.vy-jr.vy,Me=-(ns*un+le*Wn)||.01;Sr.vx+=Me*un,Sr.vy+=Me*Wn,jr.vx-=Me*un,jr.vy-=Me*Wn,Sr.trajectory.length>0&&(Sr.trajectory[Sr.trajectory.length-1].collision=!0),jr.trajectory.length>0&&(jr.trajectory[jr.trajectory.length-1].collision=!0)}}});const Bs=Array.from(ft.values()).filter(jr=>jr.id!=="cue"&&jr.visible);for(let jr=0;jr<Bs.length;jr++)for(let Dt=jr+1;Dt<Bs.length;Dt++){const Ar=Bs[jr],$r=Bs[Dt],dn=$r.x-Ar.x,rs=$r.y-Ar.y,un=Math.sqrt(dn*dn+rs*rs);if(un>0&&un<Qt){const Wn=Qt-un+.01,tn=dn/un,ns=rs/un;Ar.x-=tn*(Wn/2),Ar.y-=ns*(Wn/2),$r.x+=tn*(Wn/2),$r.y+=ns*(Wn/2);const le=Ar.vx-$r.vx,_e=Ar.vy-$r.vy,he=-(le*tn+_e*ns)||.01;Ar.vx+=he*tn,Ar.vy+=he*ns,$r.vx-=he*tn,$r.vy-=he*ns,Ar.isMoving=!0,$r.isMoving=!0,Ar.trajectory.length>0&&(Ar.trajectory[Ar.trajectory.length-1].collision=!0),$r.trajectory.length>0&&($r.trajectory[$r.trajectory.length-1].collision=!0)}}if(yr.every(jr=>Math.abs(jr.vx)<.028&&Math.abs(jr.vy)<.028))break}ft.forEach((Lt,yr)=>{Lt.trajectory.length>1&&(At[yr]={points:Lt.trajectory,color:Rt[yr]||"#ffffff"})})})(),At},[r.balls,r.cueBall,st]),ua=y.useCallback((Se,G)=>{const He=G.x-Se.x,Xe=G.y-Se.y,nt=Math.sqrt(He*He+Xe*Xe);if(nt===0||nt>=Qt)return!1;const At=Qt-nt+.01,vt=He/nt,Nt=Xe/nt;Se.x-=vt*(At/2),Se.y-=Nt*(At/2),G.x+=vt*(At/2),G.y+=Nt*(At/2);const tr=Se.vx-G.vx,qt=Se.vy-G.vy,Ht=-(tr*vt+qt*Nt)||.01;Se.vx+=Ht*vt,Se.vy+=Ht*Nt,G.vx-=Ht*vt,G.vy-=Ht*Nt;const Rt=_K,Ue=Se.spinX||0,ft=Se.spinY||0,wt=G.spinX||0,Lt=G.spinY||0,yr=(Ue-wt)*Rt*vt,Sr=(ft-Lt)*Rt*Nt;return Se.spinX=(Ue-yr)*.9,Se.spinY=(ft-Sr)*.9,G.spinX=(wt+yr)*.9,G.spinY=(Lt+Sr)*.9,Se.isMoving=!0,G.isMoving=!0,!0},[]),ha=y.useCallback(()=>{const Se=[],G=Br*.75,He=hn/2;function Xe(){return(Math.random()-.5)*1.5}const nt=[{x:G,y:He},{x:G+Qt*.95,y:He-Qt*.48},{x:G+Qt*.95,y:He+Qt*.48},{x:G+2*Qt*.95,y:He-Qt*.95},{x:G+2*Qt*.95,y:He},{x:G+2*Qt*.95,y:He+Qt*.95},{x:G+3*Qt*.95,y:He-Qt*1.43},{x:G+3*Qt*.95,y:He-Qt*.48},{x:G+3*Qt*.95,y:He+Qt*.48},{x:G+3*Qt*.95,y:He+Qt*1.43}],At=[{x:G+3*Qt*.95,y:He-Qt*1.43},{x:G+3*Qt*.95,y:He+Qt*1.43}],Nt=[2,3].sort(()=>Math.random()-.5),qt=[4,5,6,7,8,9].sort(()=>Math.random()-.5);return[1,10,...Nt,...qt].forEach((Ht,Rt)=>{let Ue;if(Rt===0)Ue=nt[0];else if(Rt===1)Ue=nt[4];else if(Rt===2||Rt===3){const ft=Rt-2;Ue=At[ft]}else Ue=[nt[1],nt[2],nt[3],nt[5],nt[7],nt[8]][Rt-4];Ue&&Se.push({id:Ht,x:Ue.x+Xe(),y:Ue.y+Xe(),vx:0,vy:0,visible:!0,pocketed:!1,wasPocketedBeforeShot:!1,isMoving:!1,rotation:0,rotationSpeed:0,spinX:0,spinY:0})}),Se},[]),zr=y.useCallback(()=>{function At(){let vt=[];for(let Rt=0;Rt<16;Rt++){if(r.cueBall.visible){let Ue=r.cueBall.x+r.cueBall.vx/16,ft=r.cueBall.y+r.cueBall.vy/16;Ue<30+Gt?(r.cueBall.x=30+Gt,r.cueBall.vx=Math.abs(r.cueBall.vx)*si*ai,r.cueBall.spinY*=ga,ne&&F(!0)):Ue>570.77-Gt?(r.cueBall.x=570.77-Gt,r.cueBall.vx=-Math.abs(r.cueBall.vx)*si*ai,r.cueBall.spinY*=ga,ne&&F(!0)):r.cueBall.x=Ue,ft<24.5+Gt?(r.cueBall.y=24.5+Gt,r.cueBall.vy=Math.abs(r.cueBall.vy)*si*ai,r.cueBall.spinX*=ga,ne&&F(!0)):ft>270.18-Gt?(r.cueBall.y=270.18-Gt,r.cueBall.vy=-Math.abs(r.cueBall.vy)*si*ai,r.cueBall.spinX*=ga,ne&&F(!0)):r.cueBall.y=ft,r.cueBall.vx*=Math.pow(cp,1/16),r.cueBall.vy*=Math.pow(cp,1/16),r.cueBall.vx+=r.cueBall.spinX*oi,r.cueBall.vy+=r.cueBall.spinY*oi,r.cueBall.spinX*=Math.pow(ga,1/16),r.cueBall.spinY*=Math.pow(ga,1/16);const wt=Math.sqrt(r.cueBall.vx*r.cueBall.vx+r.cueBall.vy*r.cueBall.vy);wt>.01?(r.cueBall.rotationSpeed=wt/Gt,Math.abs(r.cueBall.vx)>Math.abs(r.cueBall.vy)?r.cueBall.rotation+=r.cueBall.rotationSpeed/16*Math.sign(r.cueBall.vx):r.cueBall.rotation+=r.cueBall.rotationSpeed/16*Math.sign(r.cueBall.vy)):r.cueBall.rotationSpeed=0,st(r.cueBall)&&(r.cueBall.isMoving=!1,r.cueBall.visible=!1),r.cueBall.isMoving&&Math.abs(r.cueBall.vx)<.03&&Math.abs(r.cueBall.vy)<.03&&(r.cueBall.vx=0,r.cueBall.vy=0,r.cueBall.isMoving=!1)}r.balls.forEach(Ue=>{if(!Ue.visible)return;let ft=Ue.x+Ue.vx/16,wt=Ue.y+Ue.vy/16;ft<30+Gt?(Ue.x=30+Gt,Ue.vx=Math.abs(Ue.vx)*si*ai,Ue.spinY*=ga,ne&&(wn("Rail contact detected for ball:",Ue.id),F(!0)),r.gamePhase==="break"&&Ue.id!=="cue"&&Pe(yr=>yr+1)):ft>570.77-Gt?(Ue.x=570.77-Gt,Ue.vx=-Math.abs(Ue.vx)*si*ai,Ue.spinY*=ga,ne&&F(!0),r.gamePhase==="break"&&Ue.id!=="cue"&&Pe(yr=>yr+1)):Ue.x=ft,wt<24.5+Gt?(Ue.y=24.5+Gt,Ue.vy=Math.abs(Ue.vy)*si*ai,Ue.spinX*=ga,ne&&F(!0),r.gamePhase==="break"&&Ue.id!=="cue"&&Pe(yr=>yr+1)):wt>270.18-Gt?(Ue.y=270.18-Gt,Ue.vy=-Math.abs(Ue.vy)*si*ai,Ue.spinX*=ga,ne&&F(!0),r.gamePhase==="break"&&Ue.id!=="cue"&&Pe(yr=>yr+1)):Ue.y=wt,Ue.vx*=Math.pow(cp,1/16),Ue.vy*=Math.pow(cp,1/16),Ue.vx+=Ue.spinX*oi,Ue.vy+=Ue.spinY*oi,Ue.spinX*=Math.pow(ga,1/16),Ue.spinY*=Math.pow(ga,1/16);const Lt=Math.sqrt(Ue.vx*Ue.vx+Ue.vy*Ue.vy);Lt>.01?(Ue.rotationSpeed=Lt/Gt,Math.abs(Ue.vx)>Math.abs(Ue.vy)?Ue.rotation+=Ue.rotationSpeed/16*Math.sign(Ue.vx):Ue.rotation+=Ue.rotationSpeed/16*Math.sign(Ue.vy)):Ue.rotationSpeed=0,st(Ue)&&(Ue.isMoving=!1,Ue.visible=!1,Ue.pocketed=!0,Ue.pocketedPocket=Fe(Ue.x,Ue.y),vt.includes(Ue.id)||vt.push(Ue.id)),Ue.isMoving&&Math.abs(Ue.vx)<.03&&Math.abs(Ue.vy)<.03&&(Ue.vx=0,Ue.vy=0,Ue.isMoving=!1)}),r.cueBall.visible&&r.balls.forEach(Ue=>{if(Ue.visible){const ft=ua(r.cueBall,Ue);!ot&&ft&&r.cueBall.isMoving&&(wn("First contact made with ball:",Ue.id),V(Ue.id),ye(!0),lt(!0))}}),r.balls.forEach((Ue,ft)=>{Ue.visible&&r.balls.slice(ft+1).forEach(wt=>{wt.visible&&ua(Ue,wt)})})}const Nt=r.balls.every(Rt=>!Rt.isMoving)&&!r.cueBall.isMoving;if(Nt&&me&&(De(!0),Ce(null)),Nt&&Q&&!X&&!tt&&xt===r.currentPlayer&&(wn("currentPlayer:",r.currentPlayer),wn("cueBall visible:",r.cueBall.visible),r.cueBall.visible?(ge(!0),H(!1)):(fe(!0),ge(!0),H(!1),dt("scratch"))),Nt&&!Q&&r.gamePhase!=="break"&&!X&&!tt&&xt===r.currentPlayer&&xt!==null&&!O){wn("currentPlayer:",r.currentPlayer),wn("gamePhase:",r.gamePhase),wn("Checking for fouls - Current player:",r.currentPlayer,"First ball hit:",je);const Rt=Z();if(Rt)wn("Foul detected:",Rt,"by player:",r.currentPlayer),fe(!0),ge(!0),U(null),$(null),H(!1),dt(Rt);else{if(!O){const ft=Ye();if(ft.length>0){wn("Illegally pocketed balls detected:",ft.map(wt=>wt.id)),we(ft),it(!0),ge(!0),U(null),$(null);return}}ge(!0),U(null),$(null),H(!1),Ze(ft=>{const wt={...ft,[xt]:0};return wn(`Resetting fouls for player ${xt} only. Player 1 fouls: ${wt[1]}, Player 2 fouls: ${wt[2]}`),wt}),r.balls.filter(ft=>ft.pocketed&&!ft.wasPocketedBeforeShot).length===0&&s(ft=>({...ft,currentPlayer:ft.currentPlayer===1?2:1}))}}if(Nt&&O&&!X&&!tt){ge(!0),oe(!1);const Rt=Z();Rt?(wn("Break foul detected:",Rt,"by player:",r.currentPlayer),fe(!0),dt(Rt)):r.balls.filter(ft=>ft.pocketed&&!ft.wasPocketedBeforeShot).length===0&&s(ft=>({...ft,currentPlayer:ft.currentPlayer===1?2:1}))}const tr=r.balls.find(Rt=>Rt.id===10&&Rt.pocketed),qt=r.balls.filter(Rt=>Rt.visible&&!Rt.pocketed),or=qt.length>0?qt.reduce((Rt,Ue)=>Ue.id<Rt.id?Ue:Rt):null;if(Nt&&or&&or.id===10&&window.dispatchEvent(new CustomEvent("tenBallTarget",{detail:{player:r.currentPlayer}})),Nt&&or&&Ug(r.gamePhase)&&window.dispatchEvent(new CustomEvent("lowestBall",{detail:{player:r.currentPlayer,lowestBall:or.id}})),Nt&&Ug(r.gamePhase)&&Math.random()<.1&&window.dispatchEvent(new CustomEvent("safetyOpportunity",{detail:{player:r.currentPlayer}})),Nt&&tr){const Rt=R===10,Ue=z&&tr.pocketedPocket===z;if(Rt&&Ue){const ft=xt;n&&n(ft),window.dispatchEvent(new CustomEvent("gameWinning",{detail:{player:ft}})),setTimeout(()=>{s(wt=>({...wt,balls:ha(),cueBall:{x:100,y:150,originalX:100,originalY:150,vx:0,vy:0,visible:!0,isMoving:!1},isAnimating:!1,gamePhase:"break",ballInHand:!1,scratchOccurred:!1})),setIsDragging(!1),b(!0),Ze({1:0,2:0}),s(wt=>({...wt,_foulReset:Date.now()})),window.tipManager&&window.tipManager.resetTips&&window.tipManager.resetTips()},2e3)}else{s(wt=>({...wt,balls:wt.balls.map(Lt=>Lt.id===10?{...Lt,pocketed:!1,visible:!0,x:n2,y:s2,vx:0,vy:0,isMoving:!1}:Lt)}));const ft=r.balls.find(wt=>wt.id===R&&wt.pocketed&&!wt.wasPocketedBeforeShot);ft&&ft.pocketedPocket===z||s(wt=>({...wt,currentPlayer:wt.currentPlayer===1?2:1})),U(null),$(null)}}const Ht=al(r.gamePhase);wn("Step function - wasBreakPhase:",Ht,"allStopped:",Nt,"gamePhase:",r.gamePhase),s(Rt=>({...Rt,isAnimating:!Nt,gamePhase:uK(Rt.gamePhase,Nt)})),hK(r.gamePhase,Nt)&&(J(!0),Ae(!1),setTimeout(()=>{window.dispatchEvent(new CustomEvent("pushOutStrategy",{detail:{player:r.currentPlayer}}))},500),setTimeout(()=>{window.dispatchEvent(new CustomEvent("pushOutAvailable",{detail:{player:r.currentPlayer}}))},1e3)),Nt||(rt.current=requestAnimationFrame(At))}rt.current=requestAnimationFrame(At)},[r,st,ua,je,Q,Z,dt,me,X,xt,tt,Ye,O]),Js=y.useCallback(()=>{if(r.isAnimating||!N)return;if(!al(r.gamePhase)){if(!Q){if(!R&&!z){Y(!0),M(!1);return}}}r.cueBall;const Se=u*18,G=f*Math.PI/180,He=Math.cos(G)*p*oi*Se*.05,Xe=Math.sin(G)*p*oi*Se*.05;V(null),F(!1),re(null),fe(!1),ye(!1),lt(!1),ge(!1),ht(r.currentPlayer),Pe(0);const nt=r.balls.filter(vt=>vt.visible&&!vt.pocketed),At=nt.length>0?nt.reduce((vt,Nt)=>Nt.id<vt.id?Nt:vt):null;I(At),s(vt=>({...vt,balls:vt.balls.map(Nt=>({...Nt,wasPocketedBeforeShot:Nt.pocketed}))})),s(vt=>({...vt,cueBall:{...vt.cueBall,vx:Math.cos(c)*Se,vy:Math.sin(c)*Se,isMoving:!0,spinX:He,spinY:Xe},isAnimating:!0,ballInHand:!1,gamePhase:vt.gamePhase})),al(r.gamePhase)&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("callPocket",{detail:{player:r.currentPlayer}}))},500),al(r.gamePhase)&&oe(!0),M(!1),b(!0),x(null),S(null),C(null),Q&&Ce({ballsPocketed:r.balls.filter(vt=>vt.pocketed).length,cueBallPosition:{x:r.cueBall.x,y:r.cueBall.y},player:r.currentPlayer}),Y(!1),ue&&!be&&r.gamePhase!=="break"&&(Ae(!0),J(!1)),Q&&(J(!1),Ae(!0))},[r.isAnimating,N,r.cueBall,u,c,Q,R,z,r.gamePhase,ue,be]),Xs=y.useCallback(Se=>{if(r.isAnimating)return;if(Se.button===2){P(!0);return}const G=t.current.getBoundingClientRect(),He=G.width/Br,Xe=(Se.clientX-G.left)/He,nt=(Se.clientY-G.top)/He;if(Xe>=0&&Xe<=Br&&nt>=0&&nt<=hn){if(W){if(Ug(r.gamePhase)&&ue&&Pr(Xe,nt)){H(!Q);return}if(R&&z||Q){if(Xe>=Br/2-80&&Xe<=Br/2-10&&nt>=hn-30&&nt<=hn-5){Y(!1),M(!0);return}if(Xe>=Br/2+10&&Xe<=Br/2+80&&nt>=hn-30&&nt<=hn-5){Y(!1),U(null),$(null),H(!1),M(!0);return}}const Nt=r.balls.find(qt=>qt.visible&&!qt.pocketed&&Math.sqrt((Xe-qt.x)**2+(nt-qt.y)**2)<Gt),tr=ke.find(qt=>Math.sqrt((Xe-qt.x)**2+(nt-qt.y)**2)<50);if(Nt||tr){We(Se);return}else{Y(!1),U(null),$(null),M(!1);return}}if((r.ballInHand||al(r.gamePhase))&&pt(Xe,nt)){Tt(Xe,nt);return}const vt=!N;M(vt),vt&&!al(r.gamePhase)&&!Q&&Y(!0),vt||(Y(!1),U(null),$(null))}},[r.isAnimating,r.ballInHand,r.gamePhase,pt,Tt,N,W,R,z,We,ue,Q]),Pa=y.useCallback(Se=>{a&&ir(),Se.button===2&&(P(!1),!N&&!r.isAnimating&&(M(!0),r.gamePhase!=="break"&&!Q&&Y(!0)))},[a,ir,N,r.isAnimating,r.gamePhase,Q]),Gi=y.useCallback(Se=>{if(r.isAnimating)return;const G=t.current.getBoundingClientRect(),He=G.width/Br,Xe=(Se.clientX-G.left)/He,nt=(Se.clientY-G.top)/He;if(a){Wt(Xe,nt);return}if(N&&!(W&&(A||Se.altKey)))return;const At={x:r.cueBall.x,y:r.cueBall.y},vt={x:Math.max(30,Math.min(570,At.x)),y:Math.max(24,Math.min(270,At.y))},Nt=Math.atan2(nt-vt.y,Xe-vt.x);let tr=!1,qt=null,or=1/0;r.balls.forEach(ft=>{if(ft.visible&&!ft.pocketed){const wt=ft.x-vt.x,Lt=ft.y-vt.y,yr=Math.sqrt(wt*wt+Lt*Lt),Sr=Math.atan2(Lt,wt);Math.abs(Nt-Sr)<.25&&yr<or&&(or=yr,qt=ft,tr=!0)}});let Ht=Nt;if(E){let ft=2e-5;tr&&qt&&(ft=1e-5*(Math.sqrt((qt.x-vt.x)**2+(qt.y-vt.y)**2)/100));const wt=vt.x,Lt=vt.y,yr=(Xe-wt)*ft,Sr=(nt-Lt)*ft;Ht=Math.atan2(Sr,yr)}else if(tr){const wt=vt.x,Lt=vt.y,yr=(Xe-wt)*.25,Sr=(nt-Lt)*.25;Ht=Math.atan2(Sr,yr)}else{const ft=.9*Math.PI/180;Ht=Math.round(Nt/ft)*ft}if(N&&W&&(A||Se.altKey)){const ft=Dr(Ht,D),wt=.001,Lt=Math.max(-wt,Math.min(wt,ft));Ht=D+Lt}if((Math.abs(Dr(Ht,D))>2e-4||!E)&&(d(Ht),T(Ht)),tr&&qt){const ft=rr(qt.x,qt.y,vt.x,vt.y);x(ft),S(qt)}else x(null),S(null)},[r.isAnimating,a,Wt,r.cueBall,r.balls,rr,N,W]),ec=y.useCallback(()=>{},[]);y.useCallback(()=>{b(!0),h(.5),g(0),m(0),C(null),M(!1)},[]),y.useCallback(()=>{const Se=r.cueBall;let G=null,He=1/0;return r.balls.forEach(Xe=>{Xe.visible&&!Xe.pocketed&&Xe.id<He&&(He=Xe.id,G=Xe)}),G?Math.atan2(G.y-Se.y,G.x-Se.x):Math.atan2(hn/2-Se.y,Br/2-Se.x)},[r.cueBall,r.balls]),y.useEffect(()=>{s(Se=>({...Se,balls:ha()}))},[ha]),y.useEffect(()=>{if(r.isAnimating)return zr(),()=>{rt.current&&cancelAnimationFrame(rt.current)}},[r.isAnimating,zr]),y.useEffect(()=>{const Se=G=>{G.key==="Escape"&&W&&(Y(!1),U(null),$(null),M(!1))};return document.addEventListener("keydown",Se),()=>{document.removeEventListener("keydown",Se)}},[W]);const ps=y.useCallback(()=>{const Se=t.current;if(!Se)return;const G=Se.getContext("2d");if(G.clearRect(0,0,Br,hn),Ct.current?G.drawImage(Ct.current,0,0,Br,hn):(G.fillStyle="#0d5c0d",G.fillRect(0,0,Br,hn)),te.current){G.save(),G.globalAlpha=.25;const Xe=Br*.305,nt=Xe*(te.current.height/te.current.width),At=(Br-Xe)/2,vt=(hn-nt)/2;G.shadowColor="rgba(0, 0, 0, 0.3)",G.shadowBlur=4,G.shadowOffsetX=0,G.shadowOffsetY=1,G.drawImage(te.current,At,vt,Xe,nt),G.restore()}al(r.gamePhase)&&!r.isAnimating&&(G.save(),G.strokeStyle="rgba(255, 0, 0, 0.5)",G.lineWidth=2,G.setLineDash([10,5]),G.strokeRect(Yd,Gd,qg-Yd,Hg-Gd),G.fillStyle="rgba(255, 0, 0, 0.8)",G.font="12px Arial",G.fillText("KITCHEN",Yd+10,Gd+20),G.restore());const He=(Xe,nt)=>{if(kt.current[nt]){const At=kt.current[nt];G.save(),G.translate(Xe.x,Xe.y),G.rotate(Xe.rotation||0),G.shadowColor="rgba(0, 0, 0, 0.3)",G.shadowBlur=3,G.shadowOffsetX=1,G.shadowOffsetY=1,G.beginPath(),G.arc(0,0,Gt,0,2*Math.PI),G.clip(),G.drawImage(At,-Gt,-Gt,Qt,Qt),G.shadowColor="transparent",G.globalAlpha=.3,G.fillStyle="rgba(255, 255, 255, 0.8)",G.beginPath(),G.arc(-Gt*.3,-Gt*.3,Gt*.4,0,2*Math.PI),G.fill(),G.restore()}else{const At=new Image;At.onload=()=>{kt.current[nt]=At,He(Xe,nt)},At.src=nt}};if(r.balls.forEach(Xe=>{Xe.visible&&!Xe.pocketed&&He(Xe,yt[Xe.id])}),v&&!r.isAnimating){const Xe={x:Math.max(30,Math.min(570,r.cueBall.x)),y:Math.max(24,Math.min(270,r.cueBall.y))},nt=c,At=u*18,vt=Math.cos(nt)*At,Nt=Math.sin(nt)*At,tr=f*Math.PI/180,qt=Math.cos(tr)*p*oi*At*.05,or=Math.sin(tr)*p*oi*At*.05,Ht=An(vt+qt,Nt+or,Xe,{ignoreCuePocket:!0});if(Ht.cue&&Ht.cue.points.length>1){const Rt=Ht.cue.points.find(Ue=>Ue.collision);if(Rt){wn("Trajectory collision at:",Rt.x.toFixed(2),Rt.y.toFixed(2));const Ue=r.balls.find(ft=>ft.visible&&!ft.pocketed&&ft.id===1);Ue&&wn("Actual ball 1 position:",Ue.x.toFixed(2),Ue.y.toFixed(2))}}Object.entries(Ht).forEach(([Rt,Ue])=>{const ft=Rt==="cue"?1:3;if(Ue.points.length>ft){if(G.save(),Rt==="cue"?cn(G):(G.strokeStyle=Ue.color,G.lineWidth=2,G.globalAlpha=.7),Rt==="cue"){const wt=Ue.points,Lt=wt[0],yr=wt[wt.length-1]||Lt;if(Math.hypot(yr.x-Lt.x,yr.y-Lt.y)<20){const Za=Ja(u);G.beginPath(),G.moveTo(Lt.x,Lt.y),G.lineTo(Lt.x+Math.cos(nt)*Za,Lt.y+Math.sin(nt)*Za),G.stroke()}else hs(G,wt)}else hs(G,Ue.points);G.restore();for(let wt=1;wt<Ue.points.length;wt++){const Lt=Ue.points[wt];if(Lt.collision&&(G.save(),G.fillStyle=Ue.color,G.globalAlpha=.6,G.beginPath(),G.arc(Lt.x,Lt.y,4,0,2*Math.PI),G.fill(),G.restore()),Lt.pocketed){G.save(),G.fillStyle="#00ff00",G.globalAlpha=.8,G.beginPath(),G.arc(Lt.x,Lt.y,6,0,2*Math.PI),G.fill(),G.restore();break}}}else if(Rt==="cue"){G.save(),cn(G);const wt=Ue.points[0],Lt=Ja(u),yr=wt.x+Math.cos(nt)*Lt,Sr=wt.y+Math.sin(nt)*Lt;G.beginPath(),G.moveTo(wt.x,wt.y),G.lineTo(yr,Sr),G.stroke(),G.restore()}})}if(_&&!r.isAnimating&&(G.save(),G.strokeStyle="rgba(255, 255, 0, 0.8)",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.arc(_.x,_.y,25,0,2*Math.PI),G.stroke(),G.restore()),!r.isAnimating&&!N){const tr=[{x:30,y:24.5,margin:Qt*fa},{x:570.77,y:24.5,margin:Qt*fa},{x:30,y:270.18,margin:Qt*fa},{x:570.77,y:270.18,margin:Qt*fa},{x:300.385,y:24.5,margin:Qt*mc},{x:300.385,y:270.18,margin:Qt*mc}],qt=r.cueBall.x+Math.cos(c)*100,or=r.cueBall.y+Math.sin(c)*100;let Ht=null,Rt=1/0;if(tr.forEach(Ue=>{const ft=Math.hypot(qt-Ue.x,or-Ue.y);ft<Rt&&(Rt=ft,Ht=Ue)}),Ht&&Rt<120){const Ue=Ht.margin+Yg;G.save(),G.strokeStyle="rgba(0, 255, 0, 0.18)",G.lineWidth=1.5,G.setLineDash([]),G.beginPath(),G.arc(Ht.x,Ht.y,Ue,0,2*Math.PI),G.stroke(),G.fillStyle="rgba(0, 255, 0, 0.15)",G.beginPath(),G.arc(Ht.x,Ht.y,2,0,2*Math.PI),G.fill(),G.restore()}}if(W&&!r.isAnimating){if(G.save(),G.fillStyle="rgba(0, 0, 0, 0.4)",G.fillRect(0,0,Br,hn),G.fillStyle="rgba(255, 215, 0, 0.9)",G.font="bold 16px Arial",G.textAlign="center",G.fillText("CALL YOUR SHOT",Br/2,30),G.font="14px Arial",G.fillStyle="rgba(255, 255, 255, 0.9)",G.fillText("Click a ball, then click a pocket",Br/2,50),R&&(G.fillStyle="rgba(0, 255, 0, 0.8)",G.font="bold 14px Arial",G.fillText(`Selected Ball: ${R}`,Br/2,hn-60)),z&&(G.fillStyle="rgba(0, 255, 0, 0.8)",G.font="bold 14px Arial",G.fillText(`Selected Pocket: ${z.replace("-"," ")}`,Br/2,hn-40)),R){const Xe=r.balls.find(nt=>nt.id===R&&nt.visible&&!nt.pocketed);Xe&&(G.strokeStyle="rgba(0, 255, 0, 0.8)",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.arc(Xe.x,Xe.y,Gt+5,0,2*Math.PI),G.stroke())}if(z){const Xe=ke.find(nt=>nt.id===z);Xe&&(G.strokeStyle="rgba(0, 255, 0, 0.8)",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.arc(Xe.x,Xe.y,30,0,2*Math.PI),G.stroke())}wn("Draw function - gamePhase:",r.gamePhase,"pushOutAvailable:",ue,"isCallShotMode:",W),Fn(G,hn,Q,ue,r.gamePhase),(R&&z||Q)&&(G.fillStyle="rgba(76, 175, 80, 0.9)",G.fillRect(Br/2-80,hn-30,70,25),G.fillStyle="white",G.font="bold 12px Arial",G.textAlign="center",G.fillText("CONFIRM",Br/2-45,hn-15),G.fillStyle="rgba(244, 67, 54, 0.9)",G.fillRect(Br/2+10,hn-30,70,25),G.fillStyle="white",G.font="bold 12px Arial",G.textAlign="center",G.fillText("CANCEL",Br/2+45,hn-15)),G.restore()}if(r.cueBall.visible){const Xe=r.cueBall,nt=yt.cue;if(kt.current[nt]){const At=kt.current[nt];G.save(),G.translate(Xe.x,Xe.y),G.rotate(Xe.rotation||0),G.beginPath(),G.arc(0,0,Gt,0,2*Math.PI),G.clip(),G.drawImage(At,-Gt,-Gt,Qt,Qt),p!==0&&!r.isAnimating&&(G.restore(),G.save(),G.strokeStyle=p>0?"rgba(76, 175, 80, 0.8)":"rgba(244, 67, 54, 0.8)",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.arc(Xe.x,Xe.y,Gt+5,0,2*Math.PI),G.stroke(),G.strokeStyle=p>0?"rgba(76, 175, 80, 0.9)":"rgba(244, 67, 54, 0.9)",G.lineWidth=2,G.setLineDash([]),G.beginPath(),G.moveTo(Xe.x,Xe.y),G.lineTo(Xe.x+Math.cos(f*Math.PI/180)*(Gt+10),Xe.y+Math.sin(f*Math.PI/180)*(Gt+10)),G.stroke()),G.restore()}else{const At=new Image;At.onload=()=>{kt.current[nt]=At,ps()},At.src=nt}}G.globalAlpha=1},[r,v,c,yt,u,_,N,An,W,R,z,ke,ue,Q]);y.useEffect(()=>{ps()},[r.isAnimating,v,c,u,_,N,W,R,z,ue,Q]),y.useEffect(()=>{const Se=new Image;Se.onload=()=>{Ct.current=Se,ps()},Se.src=SK},[ps]),y.useEffect(()=>{const Se=new Image;Se.onload=()=>{te.current=Se,ps()},Se.src=dh},[ps]),y.useEffect(()=>{const Se=He=>{He.altKey&&k(!0)},G=He=>{He.altKey||k(!1),He.key==="Alt"&&k(!1)};return window.addEventListener("keydown",Se),window.addEventListener("keyup",G),()=>{window.removeEventListener("keydown",Se),window.removeEventListener("keyup",G)}},[]);const[Ea,Xa]=y.useState(!1),Vi=y.useCallback(Se=>{Se.preventDefault(),Xa(!0),console.log("English drag started")},[]),_o=y.useCallback(Se=>{if(!Ea)return;const G=Se.currentTarget.getBoundingClientRect(),He=Se.clientX-G.left,Xe=Se.clientY-G.top,nt=He/G.width,At=Xe/G.height,vt=.5,Nt=.5,tr=Math.sqrt((nt-vt)**2+(At-Nt)**2),qt=Math.min(tr,.4),or=Math.min(qt/.4,1),Rt=(Math.atan2(At-Nt,nt-vt)*180/Math.PI+360)%360;g(or),m(Rt),console.log(`English updated: ${Math.round(or*100)}% at ${Math.round(Rt)}`)},[Ea]),ks=y.useCallback(()=>{Xa(!1),console.log("English drag ended")},[]),Ra=y.useCallback(Se=>{const G=Se%360;return G>=247.5&&G<=292.5?"#4CAF50":G>=67.5&&G<=112.5?"#F44336":G>=157.5&&G<=202.5?"#9C27B0":G>=337.5||G<=22.5?"#FF9800":G>292.5&&G<337.5?"#00BCD4":G>202.5&&G<247.5?"#CDDC39":G>22.5&&G<67.5?"#E91E63":"#FFC107"},[]),Qa=y.useCallback(Se=>{const G=Se%360;return G>=247.5&&G<=292.5?"Top Spin":G>=67.5&&G<=112.5?"Back Spin":G>=157.5&&G<=202.5?"Left Spin":G>=337.5||G<=22.5?"Right Spin":G>292.5&&G<337.5?"Top-Right Spin":G>202.5&&G<247.5?"Top-Left Spin":G>22.5&&G<67.5?"Bottom-Right Spin":"Bottom-Left Spin"},[]);return e.jsxs("div",{className:Qr.simplePoolGame,children:[e.jsx("div",{className:Qr.aimingInstructions,children:e.jsxs("div",{className:Qr.instructions,children:[e.jsx("strong",{children:"How To Aim:"}),e.jsx("br",{}),"Move mouse to aim  Click table to lock aim  Call Shot  Adjust power  Drag English ball  Click SHOOT",e.jsx("br",{}),e.jsxs("small",{style:{color:"#888",fontSize:"12px"},children:[" ",e.jsx("strong",{children:"Aim Line Colors:"})," White = Aiming  Green = Locked & ready  Yellow = Fine-tuning  Green/Red = English spin  Colored = Object ball paths",e.jsx("br",{})," ",e.jsx("strong",{children:"Fine-tuning:"})," Hold right-click for precise aiming, release to lock aim",e.jsx("br",{})," ",e.jsx("strong",{children:"English:"})," Click and drag on the English ball to set spin direction and intensity"]})]})}),r2(r.gamePhase,ue)&&e.jsx("div",{style:{alignSelf:"center",margin:"8px 0 14px 0",padding:"6px 14px",background:"rgba(255, 215, 0, 0.95)",color:"#000",fontWeight:700,fontSize:"15px",borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.25)"},children:"Push Out Available"}),e.jsx("div",{className:Qr.tableContainer,children:e.jsx("canvas",{ref:t,width:Br,height:hn,onPointerDown:Xs,onPointerUp:Pa,onPointerMove:Gi,onPointerLeave:ec,onContextMenu:Se=>Se.preventDefault(),className:Qr.tableCanvas})}),e.jsxs("div",{className:Qr.controls,children:[e.jsxs("div",{className:Qr.powerControl,children:[e.jsxs("label",{children:["Power: ",Math.round(u*100),"%"]}),e.jsxs("div",{style:{position:"relative",width:"100%",height:"8px",background:"#ffffff",borderRadius:"4px",border:"1px solid #e0e0e0",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:`${u*100}%`,height:"100%",background:"#2196F3",borderRadius:"3px"}}),e.jsx("div",{style:{position:"absolute",top:"-4px",left:`${u*100}%`,width:"16px",height:"16px",background:"#2196F3",borderRadius:"50%",border:"1px solid #1976D2",cursor:"pointer",transform:"translateX(-50%)"}}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.01",value:u,onChange:Se=>h(parseFloat(Se.target.value)),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"transparent",outline:"none",cursor:"pointer",opacity:0}})]})]}),e.jsxs("div",{className:Qr.englishControl,children:[e.jsx("label",{children:"English: Drag to set spin"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsxs("div",{onMouseDown:Vi,onMouseMove:_o,onMouseUp:ks,onMouseLeave:ks,style:{width:"60px",height:"60px",borderRadius:"50%",border:"2px solid #333",background:"linear-gradient(135deg, #fff 0%, #f0f0f0 100%)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",color:"#333",cursor:Ea?"grabbing":"grab",userSelect:"none"},children:[p>0?"+":"",Math.round(p*100),"%",p!==0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) translate(${Math.cos(f*Math.PI/180)*20}px, ${Math.sin(f*Math.PI/180)*20}px)`,width:"8px",height:"8px",borderRadius:"50%",background:Ra(f),border:"1px solid #fff"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) rotate(${f}deg)`,width:"2px",height:"20px",background:Ra(f),borderRadius:"1px"}})]})]}),p!==0&&e.jsx("div",{style:{fontSize:"12px",color:Ra(f),fontWeight:"bold"},children:Qa(f)}),p===0&&e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"No Spin"}),p!==0&&e.jsx("button",{onClick:()=>{g(0),m(0)},style:{fontSize:"10px",padding:"2px 6px",background:"#666",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",marginLeft:"5px"},children:"Reset"})]})]}),e.jsx("div",{className:Qr.shootButton,children:e.jsx("button",{className:Qr.shootButton,onClick:Js,disabled:r.isAnimating||!N,children:N?r.gamePhase==="break"||R&&z||Q?"SHOOT!":"CALL SHOT":"LOCK AIM FIRST"})}),e.jsxs("div",{className:Qr.gameInfo,children:[e.jsxs("span",{children:["Player: ",r.currentPlayer]}),e.jsxs("span",{children:["Phase: ",r.gamePhase]}),e.jsxs("span",{children:["Status: ",r.isAnimating?"Animating":r.ballInHand||r.gamePhase==="break"?a?"Drag Cue Ball to Position":r.gamePhase==="break"?"Click Cue Ball to Move (Kitchen Only)":"Click Cue Ball to Move (Anywhere)":N?"Aim Locked - Ready to Shoot":_?"Pocket assistance active - Click to lock!":"Move Mouse to Aim"]}),et&&e.jsxs("span",{style:{color:"#ff6b6b",fontWeight:"bold"},children:["FOUL: ",et==="scratch"?"Scratch":et==="wrong_ball_first"?"Wrong Ball First":et==="no_rail_contact"?"No Rail Contact":et]}),e.jsxs("span",{children:["Consecutive Fouls P1: ",Oe[1]," | P2: ",Oe[2]]})]}),e.jsxs("div",{className:Qr.buttonRow,children:[e.jsx("button",{className:Qr.resetAimButton,onClick:()=>{setIsDragging(!1),b(!1),h(.5)},disabled:r.isAnimating,children:"Reset Aim"}),e.jsx("button",{className:Qr.resetButton,onClick:()=>{s(Se=>({...Se,balls:ha(),cueBall:{x:100,y:150,originalX:100,originalY:150,vx:0,vy:0,visible:!0,isMoving:!1,rotation:0,rotationSpeed:0},isAnimating:!1,gamePhase:"break",ballInHand:!1,scratchOccurred:!1,currentPlayer:1})),b(!0),o(!1),C(null),M(!1),g(0),m(0),J(!1),Ae(!1),H(!1),Ce(null),De(!1),I(null),console.log("Resetting foul counters via reset button"),Ze({1:0,2:0}),re(null),fe(!1),ge(!1),ht(null),Pe(0),we([]),it(!1),window.tipManager&&window.tipManager.resetTips&&window.tipManager.resetTips()},children:"Reset Game"}),e.jsx("button",{className:Qr.resetButton,onClick:()=>{s(Se=>({...Se,ballInHand:!0,currentPlayer:Se.currentPlayer===1?2:1}))},style:{marginLeft:"10px",backgroundColor:"#ff6b6b"},children:"Test Ball-in-Hand"})]})]}),ve&&e.jsx("div",{className:Qr.pushOutModal,children:e.jsxs("div",{className:Qr.pushOutContent,children:[e.jsx("h3",{children:"Push Out Result"}),e.jsxs("p",{children:["Player ",r.currentPlayer===1?2:1,", do you want to accept this push out result?"]}),e.jsxs("div",{className:Qr.pushOutButtons,children:[e.jsx("button",{onClick:()=>{De(!1),s(Se=>({...Se,currentPlayer:Se.currentPlayer===1?2:1}))},className:Qr.acceptButton,children:"Accept"}),e.jsx("button",{onClick:()=>{De(!1)},className:Qr.declineButton,children:"Decline"})]})]})}),Re&&e.jsx("div",{className:Qr.pushOutModal,children:e.jsxs("div",{className:Qr.pushOutContent,children:[e.jsx("h3",{children:"Illegally Pocketed Balls"}),e.jsxs("p",{children:["Player ",r.currentPlayer===1?2:1,", balls were illegally pocketed:"]}),e.jsx("ul",{children:Ve.map(Se=>e.jsxs("li",{children:["Ball ",Se.id," ",Se.id===10?"(will be spotted)":"(remains pocketed)"]},Se.id))}),e.jsx("p",{children:"Do you want to:"}),e.jsxs("div",{className:Qr.pushOutButtons,children:[e.jsx("button",{onClick:()=>{it(!1),s(G=>({...G,currentPlayer:G.currentPlayer===1?2:1})),Ve.find(G=>G.id===10)&&s(G=>({...G,balls:G.balls.map(He=>He.id===10?{...He,pocketed:!1,visible:!0,x:n2,y:s2}:He)})),we([])},className:Qr.acceptButton,children:"Accept Table"}),e.jsx("button",{onClick:()=>{it(!1),we([])},className:Qr.declineButton,children:"Require Re-Shot"})]})]})})]})},kK="_tutorialRules_use5n_1",CK="_header_use5n_14",NK="_progressContainer_use5n_25",TK="_progressBar_use5n_31",PK="_progressFill_use5n_39",EK="_progressText_use5n_46",RK="_content_use5n_52",AK="_stepContent_use5n_56",MK="_highlightBox_use5n_73",IK="_highlightIcon_use5n_86",DK="_tipSection_use5n_90",$K="_navigation_use5n_110",LK="_navButton_use5n_119",BK="_disabled_use5n_135",OK="_centerButtons_use5n_145",zK="_skipButton_use5n_153",FK="_nextButton_use5n_171",WK="_startButton_use5n_171",UK="_quickRules_use5n_193",qK="_ruleGrid_use5n_205",HK="_ruleItem_use5n_211",YK="_ruleNumber_use5n_231",Lr={tutorialRules:kK,header:CK,progressContainer:NK,progressBar:TK,progressFill:PK,progressText:EK,content:RK,stepContent:AK,highlightBox:MK,highlightIcon:IK,tipSection:DK,navigation:$K,navButton:LK,disabled:BK,centerButtons:OK,skipButton:zK,nextButton:FK,startButton:WK,quickRules:UK,ruleGrid:qK,ruleItem:HK,ruleNumber:YK},GK=({step:n,currentStep:t,totalSteps:r,onNext:s,onBack:a,onSkip:o})=>{const i=(t+1)/r*100,l=["Remember: Always hit the lowest numbered ball first!","Call your shots clearly - specify ball and pocket.","The 10-ball is the money ball - pocket it legally to win!","Use the push out strategically to improve your position.","Three consecutive fouls result in loss of game.","Practice your break shot - it sets up the entire game.","Defensive play is just as important as offensive play.","Watch for safety opportunities when you can't make a shot."];return e.jsxs("div",{className:Lr.tutorialRules,children:[e.jsxs("div",{className:Lr.header,children:[e.jsx("h3",{children:"10-Ball Rules Tutorial"}),e.jsxs("div",{className:Lr.progressContainer,children:[e.jsx("div",{className:Lr.progressBar,children:e.jsx("div",{className:Lr.progressFill,style:{width:`${i}%`}})}),e.jsxs("span",{className:Lr.progressText,children:["Step ",t+1," of ",r]})]})]}),e.jsxs("div",{className:Lr.content,children:[e.jsxs("div",{className:Lr.stepContent,children:[e.jsx("h4",{children:n.title}),e.jsx("p",{children:n.content}),n.highlight&&e.jsxs("div",{className:Lr.highlightBox,children:[e.jsx(vH,{className:Lr.highlightIcon}),e.jsx("span",{children:"This concept will be highlighted on the table"})]})]}),e.jsxs("div",{className:Lr.tipSection,children:[e.jsx("h5",{children:" Pro Tip"}),e.jsx("p",{children:l[t%l.length]})]})]}),e.jsxs("div",{className:Lr.navigation,children:[e.jsxs("button",{className:`${Lr.navButton} ${t===0?Lr.disabled:""}`,onClick:a,disabled:t===0,children:[e.jsx(pH,{}),"Previous"]}),e.jsxs("div",{className:Lr.centerButtons,children:[e.jsx("button",{className:Lr.skipButton,onClick:o,children:"Skip Tutorial"}),t===r-1?e.jsxs("button",{className:Lr.startButton,onClick:s,children:[e.jsx(SH,{}),"Start Playing"]}):e.jsxs("button",{className:Lr.nextButton,onClick:s,children:["Next",e.jsx(Ob,{})]})]})]}),e.jsxs("div",{className:Lr.quickRules,children:[e.jsx("h5",{children:"Quick Reference"}),e.jsxs("div",{className:Lr.ruleGrid,children:[e.jsxs("div",{className:Lr.ruleItem,children:[e.jsx("span",{className:Lr.ruleNumber,children:"1"}),e.jsx("span",{children:"Hit lowest ball first"})]}),e.jsxs("div",{className:Lr.ruleItem,children:[e.jsx("span",{className:Lr.ruleNumber,children:"2"}),e.jsx("span",{children:"Call your shots"})]}),e.jsxs("div",{className:Lr.ruleItem,children:[e.jsx("span",{className:Lr.ruleNumber,children:"3"}),e.jsx("span",{children:"10-ball wins the game"})]}),e.jsxs("div",{className:Lr.ruleItem,children:[e.jsx("span",{className:Lr.ruleNumber,children:"4"}),e.jsx("span",{children:"Push out after break"})]})]})]})]})},VK="_gameModeSelector_s58nb_29",KK="_header_s58nb_67",JK="_backToDashboardButton_s58nb_113",XK="_difficultySection_s58nb_165",QK="_difficultyOptions_s58nb_187",ZK="_difficultyButton_s58nb_201",eJ="_active_s58nb_241",tJ="_difficultyLabel_s58nb_253",rJ="_difficultyDescription_s58nb_265",nJ="_modesGrid_s58nb_277",sJ="_modeCard_s58nb_291",aJ="_recommended_s58nb_333",oJ="_recommendedBadge_s58nb_353",iJ="_modeIcon_s58nb_379",lJ="_modeContent_s58nb_403",cJ="_modeArrow_s58nb_441",dJ="_features_s58nb_463",uJ="_featuresGrid_s58nb_483",hJ="_feature_s58nb_463",pJ="_whatYoullLearn_s58nb_539",Ia={gameModeSelector:VK,header:KK,backToDashboardButton:JK,difficultySection:XK,difficultyOptions:QK,difficultyButton:ZK,active:eJ,difficultyLabel:tJ,difficultyDescription:rJ,modesGrid:nJ,modeCard:sJ,recommended:aJ,recommendedBadge:oJ,modeIcon:iJ,modeContent:lJ,modeArrow:cJ,features:dJ,featuresGrid:uJ,feature:hJ,whatYoullLearn:pJ},l2=({onModeSelect:n,fromLogin:t=!1})=>{const r=[{id:"tutorial",title:"Interactive Tutorial",description:"Learn the official CSI 10-Ball rules step by step with interactive examples and tips.",icon:yH,color:"#4CAF50",recommended:!0}];return e.jsxs("div",{className:Ia.gameModeSelector,style:{maxWidth:"280px",width:"280px",margin:"0 auto",overflowX:"hidden",boxSizing:"border-box"},children:[e.jsxs("div",{className:Ia.header,children:[!t&&e.jsx("button",{className:Ia.backToDashboardButton,onClick:()=>window.location.href="/dashboard",children:" Back to Dashboard"}),e.jsx("h2",{children:"10-Ball Tutorial"}),e.jsx("p",{children:"Learn and master the official CSI 10-Ball rules"})]}),e.jsx("div",{className:Ia.modesGrid,children:r.map(s=>{const a=s.icon;return e.jsxs("div",{className:`${Ia.modeCard} ${s.recommended?Ia.recommended:""}`,onClick:()=>n(s.id),children:[s.recommended&&e.jsx("div",{className:Ia.recommendedBadge,children:"Recommended"}),e.jsx("div",{className:Ia.modeIcon,style:{backgroundColor:s.color},children:e.jsx(a,{})}),e.jsxs("div",{className:Ia.modeContent,children:[e.jsx("h3",{children:s.title}),e.jsx("p",{children:s.description})]}),e.jsx("div",{className:Ia.modeArrow,children:""})]},s.id)})}),e.jsxs("div",{className:Ia.whatYoullLearn,children:[e.jsx("h3",{children:"What You'll Learn"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Official CSI 10-Ball Rules"}),e.jsx("li",{children:"Break/Push Out Requirements"}),e.jsx("li",{children:"Call Shot/Ball in Hand Requirements"}),e.jsx("li",{children:"Illegally Pocketed Balls/Opponent's Option"}),e.jsx("li",{children:"Foul Detection and Penalties"}),e.jsx("li",{children:"Advanced Shot Planning"})]})]})]})},mJ="_tipContainer_1z0xf_1",fJ="_show_1z0xf_27",gJ="_dragging_1z0xf_35",xJ="_tipContent_1z0xf_47",yJ="_tipHeader_1z0xf_71",bJ="_tipIcon_1z0xf_89",vJ="_pulse_1z0xf_1",wJ="_tipTitle_1z0xf_99",jJ="_closeButton_1z0xf_113",SJ="_tipText_1z0xf_155",Ro={tipContainer:mJ,show:fJ,dragging:gJ,tipContent:xJ,tipHeader:yJ,tipIcon:bJ,pulse:vJ,tipTitle:wJ,closeButton:jJ,tipText:SJ},_J=({tip:n,isVisible:t,onClose:r})=>{const[s,a]=y.useState(!1),[o,i]=y.useState({x:0,y:0}),[l,c]=y.useState(!1),[d,u]=y.useState({x:0,y:0}),h=y.useRef(null);y.useEffect(()=>{if(t){a(!0);const m=setTimeout(()=>{r()},8e3);return()=>clearTimeout(m)}},[t,r]);const p=m=>{if(m.target.closest("button"))return;c(!0);const v=h.current.getBoundingClientRect();u({x:m.clientX-v.left,y:m.clientY-v.top})},g=m=>{if(!l)return;const v=m.clientX-d.x,b=m.clientY-d.y,w=window.innerWidth-250,x=window.innerHeight-100;i({x:Math.max(0,Math.min(v,w)),y:Math.max(0,Math.min(b,x))})},f=()=>{c(!1)};return y.useEffect(()=>{if(l)return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)}},[l,d]),t?e.jsx("div",{ref:h,className:`${Ro.tipContainer} ${s?Ro.show:""} ${l?Ro.dragging:""}`,style:{maxWidth:"250px",width:"250px",minWidth:"250px",top:o.y||20,left:o.x||"50%",transform:o.x?"none":"translateX(-50%)",right:"auto",cursor:l?"grabbing":"grab"},onMouseDown:p,children:e.jsxs("div",{className:Ro.tipContent,children:[e.jsxs("div",{className:Ro.tipHeader,children:[e.jsx("span",{className:Ro.tipIcon,children:""}),e.jsx("span",{className:Ro.tipTitle,children:"Pro Tip"}),e.jsx("button",{className:Ro.closeButton,onClick:r,children:""})]}),e.jsx("div",{className:Ro.tipText,children:n})]})}):null},kJ=y.forwardRef(({gameState:n,onTipShown:t},r)=>{const[s,a]=y.useState(null),[o,i]=y.useState(!1),[l,c]=y.useState(new Set),d=f=>{p(f)},u=()=>{c(new Set)};y.useImperativeHandle(r,()=>({triggerTip:d,resetTips:u}));const h={breakShot:{title:"Break Shot",tip:"Always hit the lowest numbered ball first! A good break can set up your entire game!"},callShot:{title:"Call Shot",tip:"Be specific about which pocket you're aiming for! If you don't call it, it doesn't count!"},pushOut:{title:"Push Out Opportunity",tip:"Use push out to improve your position when the table is difficult!"},foul:{title:"Foul Committed",tip:"Three consecutive fouls by the same player results in loss of game!"},tenBall:{title:"10-Ball Target",tip:"The 10-ball is the only ball that matters for winning!"},defensive:{title:"Defensive Play",tip:"Sometimes the best shot is the one that leaves your opponent nothing!"},practice:{title:"Keep Learning",tip:"Practice makes perfect - keep playing and learning!"},scratch:{title:"Scratch Foul",tip:"The cue ball went in a pocket! Your opponent gets ball-in-hand."},wrongBall:{title:"Wrong Ball First",tip:"You must hit the lowest numbered ball first! This is a foul."},noRail:{title:"No Rail Contact",tip:"After contact, a ball must hit a rail or be pocketed. This is a foul."},ballInHand:{title:"Ball-in-Hand",tip:"You can place the cue ball anywhere on the table after a foul."},kitchen:{title:"Kitchen Rule",tip:"During break, the cue ball must start in the kitchen (behind the head string)."},threeFoul:{title:"Three Foul Rule",tip:"Three consecutive fouls by the same player results in loss of game!"},pushOutStrategy:{title:"Push Out Strategy",tip:"After a legal break, you can push out to improve position. Opponent then chooses to shoot or pass."},callPocket:{title:"Call Pocket",tip:"You must call both the ball and the pocket for every shot after the break."},lowestBall:{title:"Lowest Ball First",tip:"Always hit the lowest numbered ball on the table first!"},safety:{title:"Safety Shot",tip:"A safety shot is when you don't expect to pocket a ball but leave your opponent in a difficult position."},jumpShot:{title:"Jump Shot",tip:"Jump shots are legal in 10-ball, but be careful not to jump the cue ball off the table!"},gameWinning:{title:"Game Winner",tip:"Legally pocket the 10-ball to win! Remember to call it and the pocket."}},p=f=>{if(l.has(f))return;const m=h[f];m&&(a(m),i(!0),c(v=>new Set([...v,f])),t==null||t(f))},g=()=>{i(!1)};return y.useEffect(()=>{n&&(n.gamePhase==="break"&&!l.has("breakShot")&&(p("breakShot"),window.dispatchEvent(new CustomEvent("kitchenRule"))),n.gamePhase==="play"&&!l.has("callShot")&&p("callShot"))},[n,l]),y.useEffect(()=>{const f=T=>{l.has("foul")||p("foul")},m=T=>{l.has("scratch")||p("scratch")},v=T=>{l.has("wrongBall")||p("wrongBall")},b=T=>{l.has("noRail")||p("noRail")},w=T=>{l.has("ballInHand")||p("ballInHand")},x=T=>{l.has("kitchen")||p("kitchen")},j=T=>{l.has("threeFoul")||p("threeFoul")},S=T=>{l.has("pushOut")||p("pushOut")},_=T=>{l.has("pushOutStrategy")||p("pushOutStrategy")},C=T=>{l.has("callPocket")||p("callPocket")},N=T=>{l.has("lowestBall")||p("lowestBall")},M=T=>{l.has("safety")||p("safety")},E=T=>{l.has("jumpShot")||p("jumpShot")},P=T=>{l.has("tenBall")||p("tenBall")},D=T=>{l.has("gameWinning")||p("gameWinning")};return window.addEventListener("gameFoul",f),window.addEventListener("scratchFoul",m),window.addEventListener("wrongBallFoul",v),window.addEventListener("noRailFoul",b),window.addEventListener("ballInHand",w),window.addEventListener("kitchenRule",x),window.addEventListener("threeFoul",j),window.addEventListener("pushOutAvailable",S),window.addEventListener("pushOutStrategy",_),window.addEventListener("callPocket",C),window.addEventListener("lowestBall",N),window.addEventListener("safetyOpportunity",M),window.addEventListener("jumpShot",E),window.addEventListener("tenBallTarget",P),window.addEventListener("gameWinning",D),()=>{window.removeEventListener("gameFoul",f),window.removeEventListener("scratchFoul",m),window.removeEventListener("wrongBallFoul",v),window.removeEventListener("noRailFoul",b),window.removeEventListener("ballInHand",w),window.removeEventListener("kitchenRule",x),window.removeEventListener("threeFoul",j),window.removeEventListener("pushOutAvailable",S),window.removeEventListener("pushOutStrategy",_),window.removeEventListener("callPocket",C),window.removeEventListener("lowestBall",N),window.removeEventListener("safetyOpportunity",M),window.removeEventListener("jumpShot",E),window.removeEventListener("tenBallTarget",P),window.removeEventListener("gameWinning",D)}},[l]),e.jsx(_J,{tip:s==null?void 0:s.tip,isVisible:o,onClose:g})}),CJ="_container_1jm20_1",NJ="_tenBallTutorial_1jm20_21",TJ="_header_1jm20_31",PJ="_backButton_1jm20_53",EJ="_content_1jm20_73",RJ="_tutorialContainer_1jm20_79",AJ="_controls_1jm20_86",MJ="_hintToggle_1jm20_96",ii={container:CJ,tenBallTutorial:NJ,header:TJ,backButton:PJ,content:EJ,tutorialContainer:RJ,controls:AJ,hintToggle:MJ},IJ=({fromLogin:n=!1,onBackToLogin:t})=>{const[r,s]=y.useState("menu"),[a,o]=y.useState(0),[i,l]=y.useState(!0),[c,d]=y.useState({player1Score:0,player2Score:0,currentPlayer:1,gamePhase:"break",rules:{callPocket:!0,pushOut:!0,threeFoulRule:!0,jumpShots:!0}}),u=[{title:"The Break Shot",content:"Start the game with a legal break shot. You must break from the kitchen hitting the 1-ball first and drive at least 4 balls to the rails or pocket a ball.",proTip:"A good break can set up your entire game!"},{title:"Welcome to 10-Ball!",content:"10-Ball is a call-shot game where you must hit the lowest numbered ball first and call your shots. The 10-ball is the game-winning ball!",proTip:"Always hit the lowest numbered ball first!"},{title:"Call Shot Rules",content:"After the break, you must call both the ball and the pocket for every shot. If you don't call it, it doesn't count!",proTip:"CSI rules state that you do not have to call obvious shots. Banks, Kicks, and Caroms should always be called. Be specific about which pocket you're aiming for! Make sure your opponent acknowledges your called shot."},{title:"Push Out Option",content:"After a legal break, the incoming player may choose to 'push out' - shoot the cue ball anywhere without hitting any ball. The opponent then chooses to shoot or pass.",proTip:"Use push out to improve your position when the table is difficult!"},{title:"Fouls and Penalties",content:"Common fouls include: scratching (cue ball in pocket), hitting wrong ball first, not hitting any rail after contact, and jumping the cue ball off the table.",proTip:"Three consecutive fouls by the same player results in loss of game!"},{title:"Winning the Game",content:"Legally pocket the 10-ball to win! Yes, you can win with an early ten ball...Remember, you must call the 10-ball and the pocket, and hit the lowest numbered ball first.",proTip:"The 10-ball is the only ball that matters for winning!"},{title:"Strategy Tips",content:"Plan your shots ahead, use defensive play when needed, and always consider your opponent's options after your shot.",proTip:"Sometimes the best shot is the one that leaves your opponent nothing!"},{title:"Ready to Play!",content:"You now know the basics of 10-Ball! Practice these rules and strategies to improve your game.",proTip:"Practice makes perfect - keep playing and learning!"}],h=v=>{s(v),v==="tutorial"&&(o(0),l(!0))},p=()=>{a<u.length-1?o(a+1):s("game")},g=()=>{a>0&&o(a-1)},f=v=>{d(b=>({...b,gamePhase:"end",player1Score:v===1?b.player1Score+1:b.player1Score,player2Score:v===2?b.player2Score+1:b.player2Score}))},m=()=>{switch(r){case"menu":return e.jsx(l2,{onModeSelect:h,fromLogin:n});case"tutorial":return e.jsxs("div",{className:ii.tutorialContainer,children:[e.jsx(GK,{step:u[a],currentStep:a,totalSteps:u.length,onNext:p,onBack:g,onSkip:()=>s("game")}),e.jsx(qx,{onGameEnd:f})]});case"game":return e.jsx(qx,{onGameEnd:f});default:return e.jsx(l2,{onModeSelect:h})}};return e.jsxs("div",{className:ii.container,children:[m(),(r==="game"||r==="tutorial")&&e.jsx(kJ,{gameState:c,onTipShown:v=>console.log(`Tip shown: ${v}`),ref:v=>{v&&(window.tipManager=v)}}),r!=="menu"&&!n&&e.jsx("div",{className:ii.navigation,children:e.jsx("button",{className:ii.backButton,onClick:()=>s("menu"),children:" Back to Menu"})}),r!=="menu"&&e.jsx("div",{className:ii.gameInfo,children:e.jsxs("div",{className:ii.scoreBoard,children:[e.jsx("div",{className:ii.playerScore,children:e.jsxs("span",{children:["Player 1: ",c.player1Score]})}),e.jsx("div",{className:ii.playerScore,children:e.jsxs("span",{children:["Player 2: ",c.player2Score]})})]})})]})};function DJ(){const[n,t]=y.useState(!1),[r,s]=y.useState(!1),[a,o]=y.useState(!1),[i,l]=y.useState({width:0,height:0}),[c,d]=y.useState(!1),[u,h]=y.useState("portrait"),p=y.useCallback(()=>{if(typeof window>"u")return!1;const w=window.innerWidth,x=window.innerHeight;l({width:w,height:x});const j=w>x;o(j),h(j?"landscape":"portrait");const S=(()=>{if(w<=768)return!0;if(typeof navigator<"u"){const _=navigator.userAgent.toLowerCase();if(["android","webos","iphone","ipad","ipod","blackberry","iemobile","opera mini","mobile"].some(N=>_.includes(N)))return!0}return"ontouchstart"in window||navigator.maxTouchPoints>0?w<=1024:!1})();t(S),s(w>768&&w<=1024),d("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),g={xs:480,sm:640,md:768,lg:1024,xl:1280,"2xl":1536},f=y.useCallback(()=>{const w=i.width;return w<g.xs?"xs":w<g.sm?"sm":w<g.md?"md":w<g.lg?"lg":w<g.xl?"xl":"2xl"},[i.width]),m={spacing:{xs:n?"4px":"8px",sm:n?"8px":"12px",md:n?"12px":"16px",lg:n?"16px":"24px",xl:n?"24px":"32px"},sizes:{buttonHeight:n?"44px":"36px",inputHeight:n?"44px":"36px",iconSize:n?"1.2rem":"1rem",fontSize:{xs:n?"0.7rem":"0.75rem",sm:n?"0.8rem":"0.875rem",md:n?"0.9rem":"1rem",lg:n?"1rem":"1.125rem",xl:n?"1.1rem":"1.25rem"}},animations:{duration:n?"0.2s":"0.3s",easing:"ease-out",scale:n?.98:.95},styles:{card:{padding:n?"12px":"16px",borderRadius:n?"8px":"12px",marginBottom:n?"8px":"12px"},button:{padding:n?"12px 16px":"10px 20px",fontSize:n?"0.9rem":"1rem",minHeight:n?"44px":"36px"},input:{padding:n?"12px":"10px",fontSize:n?"16px":"14px",minHeight:n?"44px":"36px"}}},v={threshold:80,velocity:.3,calculateSwipe:(w,x,j,S)=>{const _=j-w,C=S-x,N=Math.sqrt(_*_+C*C),M=N/300;return{deltaX:_,deltaY:C,distance:N,velocity:M,direction:Math.abs(_)>Math.abs(C)?_>0?"right":"left":C>0?"down":"up",isHorizontal:Math.abs(_)>Math.abs(C),isValid:N>50&&M>v.velocity}},createSwipeHandler:(w,x,j,S)=>{let _=0,C=0;return{onTouchStart:N=>{_=N.touches[0].clientX,C=N.touches[0].clientY},onTouchEnd:N=>{const M=N.changedTouches[0].clientX,E=N.changedTouches[0].clientY,P=v.calculateSwipe(_,C,M,E);if(P.isValid)switch(P.direction){case"left":w&&w(P);break;case"right":x&&x(P);break;case"up":j&&j(P);break;case"down":S&&S(P);break}}}}},b={threshold:80,createPullToRefreshHandler:w=>{let x=0,j=0,S=!1;return{onTouchStart:_=>{window.scrollY===0&&(x=_.touches[0].clientY,S=!0)},onTouchMove:_=>{S&&window.scrollY===0&&(j=_.touches[0].clientY,j-x>0&&_.preventDefault())},onTouchEnd:async()=>{S&&(j-x>b.threshold&&await w(),S=!1,x=0,j=0)}}}};return y.useEffect(()=>{p();const w=()=>{p()},x=()=>{setTimeout(p,100)};return window.addEventListener("resize",w),window.addEventListener("orientationchange",x),()=>{window.removeEventListener("resize",w),window.removeEventListener("orientationchange",x)}},[p]),{isMobile:n,isTablet:r,isLandscape:a,screenSize:i,touchCapable:c,orientation:u,breakpoints:g,getBreakpoint:f,mobileUtils:m,swipeUtils:v,pullToRefreshUtils:b,isSmallScreen:i.width<g.md,isMediumScreen:i.width>=g.md&&i.width<g.lg,isLargeScreen:i.width>=g.lg,isIOS:typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),isAndroid:typeof navigator<"u"&&/Android/.test(navigator.userAgent),isSafari:typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),redetect:p}}function $J({activeTab:n,onTabChange:t,onQuickAction:r,pendingCount:s=0,sentCount:a=0,matchesCount:o=0}){const i=[{id:"overview",label:"Home",icon:e.jsx(AC,{}),badge:null},{id:"matches",label:"Matches",icon:e.jsx(Oi,{}),badge:o>0?o:null},{id:"proposals",label:"Proposals",icon:e.jsx(So,{}),badge:s>0?s:null},{id:"standings",label:"Standings",icon:e.jsx(ql,{}),badge:null},{id:"chat",label:"Chat",icon:e.jsx(zb,{}),badge:null}];return e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"rgba(24, 24, 27, 0.95)",backdropFilter:"blur(20px)",borderTop:"1px solid rgba(255, 255, 255, 0.1)",padding:"8px 0",zIndex:1e3,display:"flex",justifyContent:"space-around",alignItems:"center"},children:[i.map(l=>e.jsxs("button",{onClick:()=>t(l.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:n===l.id?"#e53e3e":"#888",padding:"8px 4px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",minHeight:"60px",minWidth:"60px",position:"relative"},onTouchStart:c=>{c.target.style.transform="scale(0.95)"},onTouchEnd:c=>{c.target.style.transform="scale(1)"},children:[e.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"2px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.icon}),e.jsx("span",{style:{fontSize:"0.7rem",fontWeight:n===l.id?"600":"400",textAlign:"center"},children:l.label}),l.badge&&e.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",background:"#e53e3e",color:"#fff",borderRadius:"50%",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.6rem",fontWeight:"600",border:"2px solid rgba(24, 24, 27, 0.95)"},children:l.badge>99?"99+":l.badge})]},l.id)),e.jsx("button",{onClick:r,style:{position:"absolute",top:"-20px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, #e53e3e, #c53030)",color:"#fff",border:"none",borderRadius:"50%",width:"56px",height:"56px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",cursor:"pointer",boxShadow:"0 4px 16px rgba(229, 62, 62, 0.4)",transition:"all 0.2s ease",zIndex:1001},onTouchStart:l=>{l.target.style.transform="translateX(-50%) scale(0.95)"},onTouchEnd:l=>{l.target.style.transform="translateX(-50%) scale(1)"},children:e.jsx(Ms,{})})]})}function c2({children:n,title:t,subtitle:r,onTap:s,onSwipeLeft:a,onSwipeRight:o,swipeThreshold:i=80,showSwipeActions:l=!0,className:c="",style:d={},...u}){const[h,p]=y.useState(!1),[g,f]=y.useState(0),[m,v]=y.useState(0),[b,w]=y.useState(null),x=y.useRef(null),j=N=>{f(N.touches[0].clientX),v(N.touches[0].clientX),p(!0),w(null)},S=N=>{if(!h)return;const M=N.touches[0].clientX;v(M);const E=M-g;Math.abs(E)>20&&w(E>0?"right":"left")},_=()=>{if(!h)return;const N=m-g;Math.abs(N)>i&&(N>0&&o?o():N<0&&a&&a()),p(!1),f(0),v(0),w(null)},C=()=>{!h&&s&&s()};return e.jsxs("div",{ref:x,className:`mobile-optimized-card ${c}`,onTouchStart:j,onTouchMove:S,onTouchEnd:_,onClick:C,style:{position:"relative",background:"linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.15)",padding:"16px",marginBottom:"12px",cursor:s?"pointer":"default",transition:h?"none":"all 0.3s ease",transform:h?`translateX(${m-g}px)`:"translateX(0)",touchAction:"pan-y",userSelect:"none",WebkitTapHighlightColor:"transparent",...d},...u,children:[l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",opacity:b==="right"?.8:0,transition:"opacity 0.2s ease",color:"#10b981",fontSize:"1.2rem"},children:e.jsx(Il,{})}),e.jsx("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",opacity:b==="left"?.8:0,transition:"opacity 0.2s ease",color:"#ef4444",fontSize:"1.2rem"},children:e.jsx(zi,{})})]}),(t||r)&&e.jsxs("div",{style:{marginBottom:"12px"},children:[t&&e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",color:"#fff",lineHeight:"1.3"},children:t}),r&&e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"0.85rem",color:"#ccc",opacity:.8,lineHeight:"1.4"},children:r})]}),e.jsx("div",{style:{position:"relative"},children:n}),s&&e.jsx("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",color:"#888",fontSize:"0.8rem",opacity:.6},children:e.jsx(Ob,{})}),e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"12px",background:b==="right"?"linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, transparent 50%)":b==="left"?"linear-gradient(90deg, transparent 50%, rgba(239, 68, 68, 0.1) 100%)":"transparent",opacity:Math.abs(m-g)/i,transition:"opacity 0.2s ease",pointerEvents:"none"}})]})}function Gg({title:n,subtitle:t,children:r,collapsible:s=!1,defaultCollapsed:a=!1,onToggle:o,className:i="",style:l={},...c}){const[d,u]=Te.useState(a),h=()=>{s&&(u(!d),o&&o(!d))};return e.jsxs("div",{className:`mobile-section ${i}`,style:{background:"rgba(255, 255, 255, 0.02)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.08)",padding:"16px",marginBottom:"16px",...l},...c,children:[(n||t)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:s&&!d?"12px":"0",cursor:s?"pointer":"default"},onClick:h,children:[e.jsxs("div",{style:{flex:1},children:[n&&e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:"600",color:"#fff",lineHeight:"1.3"},children:n}),t&&e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"0.85rem",color:"#ccc",opacity:.8,lineHeight:"1.4"},children:t})]}),s&&e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",transition:"transform 0.2s ease",transform:d?"rotate(0deg)":"rotate(180deg)"},children:e.jsx(EC,{})})]}),e.jsx("div",{style:{display:s&&d?"none":"block",transition:"all 0.3s ease"},children:r})]})}function LJ({children:n,columns:t=2,className:r="",style:s={}}){return e.jsx("div",{className:`mobile-stats-grid ${r}`,style:{display:"grid",gridTemplateColumns:`repeat(${t}, 1fr)`,gap:"12px",...s},children:n})}function d2({title:n,value:t,subtitle:r,icon:s,color:a="#e53e3e",onClick:o,className:i="",style:l={},...c}){return e.jsxs("div",{className:`mobile-stat-card ${i}`,onClick:o,style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"12px",textAlign:"center",cursor:o?"pointer":"default",transition:"all 0.2s ease",...l},onTouchStart:d=>{o&&(d.target.style.transform="scale(0.98)")},onTouchEnd:d=>{o&&(d.target.style.transform="scale(1)")},...c,children:[s&&e.jsx("div",{style:{fontSize:"1.5rem",color:a,marginBottom:"8px",display:"flex",justifyContent:"center"},children:s}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#fff",marginBottom:"4px",lineHeight:"1.2"},children:t}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#ccc",fontWeight:"500",marginBottom:r?"2px":"0"},children:n}),r&&e.jsx("div",{style:{fontSize:"0.7rem",color:"#888",lineHeight:"1.3"},children:r})]})}function BJ(){const{isMobile:n,isTablet:t,screenSize:r,touchCapable:s,orientation:a,mobileUtils:o,breakpoints:i,getBreakpoint:l}=DJ(),[c,d]=Te.useState("overview");return e.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a1a 0%, #2d1b69 100%)",color:"#fff",padding:"16px",paddingBottom:"100px"},children:[e.jsx(Gg,{title:"Mobile Detection Test",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{children:[" Is Mobile: ",e.jsx("strong",{children:n?"YES":"NO"})]}),e.jsxs("div",{children:[" Is Tablet: ",e.jsx("strong",{children:t?"YES":"NO"})]}),e.jsxs("div",{children:[" Touch Capable: ",e.jsx("strong",{children:s?"YES":"NO"})]}),e.jsxs("div",{children:[" Orientation: ",e.jsx("strong",{children:a})]}),e.jsxs("div",{children:[" Screen Size: ",e.jsxs("strong",{children:[r.width," x ",r.height]})]}),e.jsxs("div",{children:[" Breakpoint: ",e.jsx("strong",{children:l()})]})]})}),e.jsxs(Gg,{title:"Touch Interaction Test",children:[e.jsx(c2,{title:"Swipe Test Card",subtitle:"Try swiping left or right",onTap:()=>alert("Card tapped!"),onSwipeLeft:()=>alert("Swiped left!"),onSwipeRight:()=>alert("Swiped right!"),children:e.jsx("div",{style:{padding:"8px 0"},children:e.jsx("p",{children:"This card supports swipe gestures. Try swiping left or right to see the action indicators."})})}),e.jsx(c2,{title:"Tap Test Card",subtitle:"Tap to test touch response",onTap:()=>alert("Touch response working!"),children:e.jsx("div",{style:{padding:"8px 0"},children:e.jsx("p",{children:"Tap this card to test touch responsiveness and visual feedback."})})})]}),e.jsx(Gg,{title:"Stats Grid Test",children:e.jsxs(LJ,{columns:2,children:[e.jsx(d2,{title:"Test Stat 1",value:"42",subtitle:"Sample data",color:"#e53e3e",onClick:()=>alert("Stat 1 clicked!")}),e.jsx(d2,{title:"Test Stat 2",value:"17",subtitle:"More data",color:"#10b981",onClick:()=>alert("Stat 2 clicked!")})]})}),e.jsx($J,{activeTab:c,onTabChange:d,onQuickAction:()=>alert("Quick action!"),pendingCount:3,sentCount:5,matchesCount:12})]})}const OJ=({isAuthenticated:n,userFirstName:t,userLastName:r,userEmail:s,userPin:a,userType:o,handleLogout:i,onOpenProfile:l})=>{const c=yn(),[d,u]=y.useState(null),[h,p]=y.useState("league"),[g,f]=y.useState(!0);y.useEffect(()=>{s&&(async()=>{try{console.log(" Hub: Starting player type detection for:",s),f(!0);const w=await mt.getPlayerProfileData(s,"league");if(console.log(" Hub: Supabase result:",w),w.success&&w.data){const x=w.data,j=x.hasLeagueProfile&&x.leagueProfile,S=x.hasLadderProfile&&x.ladderProfile;console.log(" Hub: Profile analysis:",{hasLeagueProfile:j,hasLadderProfile:S,leagueProfile:x.leagueProfile,ladderProfile:x.ladderProfile}),j&&S?(console.log(" Hub: Setting user type to BOTH"),p("both")):j?(console.log(" Hub: Setting user type to LEAGUE"),p("league")):S?(console.log(" Hub: Setting user type to LADDER"),p("ladder")):(console.log(" Hub: No profiles found, defaulting to LEAGUE"),p("league"))}else console.log(" Hub: Supabase query not successful or no profile data"),p("league")}catch(w){console.error(" Hub: Error detecting player type:",w),p("league")}finally{f(!1),console.log(" Hub: Player type detection complete. Final type:",h)}})()},[s]);const m=[{id:"ladder",name:"Ladder App",description:"Challenge-based ladder system with rankings",icon:"",color:"#2196F3",status:"active",route:"/ladder"},{id:"league",name:"League App",description:"Manage league matches, schedules, and standings",icon:"",color:"#4CAF50",status:"active",route:"/league"}],v=async b=>{b.status==="active"?(u(b),c(b.route)):alert(`${b.name} is coming soon!`)};return e.jsxs("div",{className:"app-hub-container",children:[e.jsx("div",{className:"pool-simulation-background",children:e.jsx(dk,{aspectWidth:800,aspectHeight:400,children:e.jsx("div",{style:{width:"100%",height:"100%",position:"relative"},children:e.jsx(Zu,{})})})}),e.jsx("div",{className:"app-hub-content",children:e.jsxs("div",{className:"app-hub-header",children:[n&&e.jsxs("div",{style:{fontSize:"1.4rem",fontWeight:"600",color:"white",marginBottom:"0.3rem",textAlign:"center",textShadow:"0 2px 4px rgba(0,0,0,0.3)",paddingTop:"0.5rem"},children:["Hello, ",t]}),n&&e.jsxs("div",{className:"user-info",children:[e.jsx("div",{style:{color:"rgba(255,255,255,0.95)",fontSize:"0.9rem",fontWeight:"500",textAlign:"center",letterSpacing:"0.2px",textShadow:"0 1px 2px rgba(0,0,0,0.2)",marginBottom:"0.4rem"},children:g?"Detecting your player type...":`Thank you for being a ${h==="both"?"League & Ladder":h==="league"?"League":h==="ladder"?"Ladder":"Unknown"} player`}),g?e.jsx("span",{style:{background:"#666",padding:"6px 18px",borderRadius:"16px",fontSize:"0.9rem",fontWeight:"600",display:"inline-block",boxShadow:"0 3px 12px rgba(102, 102, 102, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.4), inset 0 -1px 1px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(255,255,255,0.35)",textShadow:"0 1px 2px rgba(0,0,0,0.2)",position:"relative",backdropFilter:"blur(4px)",letterSpacing:"0.3px"},children:"Detecting..."}):e.jsx("span",{style:{background:h==="both"||h==="league"?"linear-gradient(135deg, #4CAF50 20%, #2E7D32 80%)":h==="ladder"?"linear-gradient(135deg, #2196F3 20%, #1565C0 80%)":"#666",padding:"6px 18px",borderRadius:"16px",fontSize:"0.9rem",fontWeight:"600",display:"inline-block",boxShadow:`
                    0 3px 12px ${h.includes("league")?"rgba(76, 175, 80, 0.4)":"rgba(33, 150, 243, 0.4)"},
                    inset 0 1px 2px rgba(255, 255, 255, 0.4),
                    inset 0 -1px 1px rgba(0, 0, 0, 0.2)
                  `,border:"1px solid rgba(255,255,255,0.35)",textShadow:"0 1px 2px rgba(0,0,0,0.2)",position:"relative",backdropFilter:"blur(4px)",letterSpacing:"0.3px"},children:h==="both"?"League & Ladder Player":h==="league"?"League Player":h==="ladder"?"Ladder Player":"Unknown"})]}),e.jsx("div",{className:"hub-subtitle",children:e.jsx("p",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"white",marginTop:"0.1rem",marginBottom:"0rem"},children:"Where would you like to go today?"})}),e.jsx("div",{className:"apps-section",children:e.jsx("div",{className:"apps-grid active-apps",children:m.map(b=>e.jsxs("div",{className:`app-card ${b.status} ${b.id==="league"?"league-app":""}`,onClick:()=>v(b),style:{"--app-color":b.color},"data-app-id":b.id,children:[e.jsx("div",{className:"app-icon",children:b.icon}),e.jsxs("div",{className:"app-info",children:[e.jsx("h3",{children:b.name}),e.jsx("p",{children:b.description}),e.jsx("div",{className:"app-status",children:e.jsx("span",{className:"status-active",children:"Available"})})]})]},b.id))})})]})})]})},u2=!1,JC=({isOpen:n,onClose:t,claimingPlayer:r=null,containerSelector:s=null})=>{const[a,o]=y.useState(r?"claim":"check"),[i,l]=y.useState({firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",email:"",password:"",phone:"",fargoRate:(r==null?void 0:r.fargoRate)||"400",ladderName:(r==null?void 0:r.ladderName)||"499-under",message:""}),[c,d]=y.useState(!1),[u,h]=y.useState(""),[p,g]=y.useState(""),[f,m]=y.useState(null);y.useEffect(()=>{r?(o("claim"),l({firstName:r.firstName||"",lastName:r.lastName||"",phone:"",fargoRate:r.fargoRate||"400",ladderName:r.ladderName||"499-under",message:""})):(o("check"),l({firstName:"",lastName:"",phone:"",fargoRate:"400",ladderName:"499-under",message:""}))},[r]);const v=E=>{const{name:P,value:D}=E.target;l(T=>({...T,[P]:D}))},b=async E=>{h(""),d(!0),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const P={firstName:i.firstName,lastName:i.lastName,phone:i.phone,fargoRate:i.fargoRate,ladderName:i.ladderName,message:i.message,isNewSignup:!0};localStorage.setItem("pendingOAuthSignup",JSON.stringify(P));const D=typeof window<"u"&&window.location.pathname||"/ladder";localStorage.setItem("oauthReturnTo",D.startsWith("/ladder")||D.startsWith("/guest/ladder")?D:"/ladder");try{const T=await Hl.signInWithOAuth(E);T.success||(h(T.message||`Failed to sign in with ${E}.`),d(!1),localStorage.removeItem("pendingOAuthSignup"))}catch(T){console.error(`${E} OAuth error:`,T),h(`Failed to sign in with ${E}. Please try again.`),d(!1),localStorage.removeItem("pendingOAuthSignup")}},w=async E=>{var P,D,T;if(E==null||E.preventDefault(),!((P=i.firstName)!=null&&P.trim())||!((D=i.lastName)!=null&&D.trim())||!((T=i.email)!=null&&T.trim())||!i.password){h("Please fill in first name, last name, email, and password.");return}if(i.password.length<8){h("Password must be at least 8 characters.");return}h(""),d(!0);try{const A=await mt.createNewPlayerSignup({firstName:i.firstName.trim(),lastName:i.lastName.trim(),email:i.email.trim(),password:i.password,phone:i.phone||"",fargoRate:i.fargoRate||"400",ladderName:i.ladderName||"499-under",joinLadder:!0});A.success?(g(A.message||"Account created! Check your email to confirm. Once approved by admin, you can log in."),o("success")):h(A.error||"Signup failed. Please try again.")}catch{h("Signup failed. Please try again.")}finally{d(!1)}},x=async E=>{var T,A,k;h(""),d(!0),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const P={firstName:i.firstName,lastName:i.lastName,phone:i.phone,message:i.message,position:((T=f==null?void 0:f[0])==null?void 0:T.position)||(r==null?void 0:r.position),ladderName:((A=f==null?void 0:f[0])==null?void 0:A.ladder_name)||(r==null?void 0:r.ladderName)||"499-under",fargoRate:((k=f==null?void 0:f[0])==null?void 0:k.fargo_rate)||(r==null?void 0:r.fargoRate),isClaiming:!0};localStorage.setItem("pendingClaim",JSON.stringify(P));const D=typeof window<"u"&&window.location.pathname||"/ladder";localStorage.setItem("oauthReturnTo",D.startsWith("/ladder")||D.startsWith("/guest/ladder")?D:"/ladder");try{const R=await Hl.signInWithOAuth(E);R.success||(h(R.message||`Failed to sign in with ${E}.`),d(!1),localStorage.removeItem("pendingClaim"))}catch(R){console.error(`${E} OAuth error:`,R),h(`Failed to sign in with ${E}. Please try again.`),d(!1),localStorage.removeItem("pendingClaim")}},j=async E=>{var P;if(E.preventDefault(),!i.firstName||!i.lastName){h("Please enter both first and last name");return}d(!0),h("");try{const D=await mt.checkExistingPlayer(i.firstName.trim(),i.lastName.trim(),null);if(D.success&&D.hasExistingPlayers&&D.foundPlayers.length>0){const T=D.foundPlayers.find(k=>k.ladder_profiles&&k.ladder_profiles.length>0)||D.foundPlayers[0],A=(P=T.ladder_profiles)==null?void 0:P[0];m([{first_name:T.first_name,last_name:T.last_name,position:(A==null?void 0:A.position)||999,ladder_name:(A==null?void 0:A.ladder_name)||"499-under",fargo_rate:(A==null?void 0:A.fargo_rate)||null,user_id:T.id}]),l(k=>({...k,firstName:T.first_name,lastName:T.last_name,fargoRate:(A==null?void 0:A.fargo_rate)||"400",ladderName:(A==null?void 0:A.ladder_name)||"499-under"})),o("claim")}else h(`We couldn't find you on the ladder. Try "I'm a New Player" instead.`)}catch{h("Error checking. Please try again.")}finally{d(!1)}},S=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"10px",textAlign:"center"},children:"Join the Ladder"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"30px",fontSize:"0.9rem",textAlign:"center"},children:"Choose how you want to join:"}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"10px",borderRadius:"4px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginBottom:"30px"},children:[e.jsxs("button",{type:"button",onClick:()=>o("new"),style:{width:"100%",padding:"20px",background:"#4CAF50",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1.1rem",textAlign:"left",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"I'm a New Player"}),e.jsx("div",{style:{fontSize:"0.85rem",opacity:.9},children:"Create a new account and join the ladder"})]})]}),e.jsxs("button",{type:"button",onClick:()=>o("checkName"),style:{width:"100%",padding:"20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1.1rem",textAlign:"left",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"I'm Already on the Ladder"}),e.jsx("div",{style:{fontSize:"0.85rem",opacity:.9},children:"Claim your existing position"})]})]})]})]}),_=()=>{var E,P,D;return e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:" New Player Signup"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"20px",fontSize:"0.95rem",textAlign:"center",lineHeight:"1.6"},children:"Sign up with Google or email. Your account will be sent to admin for approval."}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("button",{type:"button",onClick:()=>b("google"),disabled:c,style:{width:"100%",padding:"14px",background:"#ffffff",color:"#333",border:"1px solid #ddd",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"Google",style:{height:"24px"}}),"Sign Up with Google"]}),u2]}),e.jsx("div",{style:{textAlign:"center",color:"#999",fontSize:"0.9rem",marginBottom:"15px"},children:" or sign up with email "}),e.jsxs("form",{onSubmit:w,style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff",fontSize:"0.9rem"},children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:i.firstName,onChange:v,required:!0,placeholder:"First name",style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff",fontSize:"0.9rem"},children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:i.lastName,onChange:v,required:!0,placeholder:"Last name",style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff",fontSize:"0.9rem"},children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:v,required:!0,placeholder:"your@email.com",style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#fff",fontSize:"0.9rem"},children:"Password * (min 8 characters)"}),e.jsx("input",{type:"password",name:"password",value:i.password,onChange:v,required:!0,minLength:8,placeholder:"Password",style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"}})]}),e.jsx("button",{type:"submit",disabled:c||!((E=i.firstName)!=null&&E.trim())||!((P=i.lastName)!=null&&P.trim())||!((D=i.email)!=null&&D.trim())||!i.password||i.password.length<8,style:{width:"100%",padding:"14px",background:c?"#555":"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"#fff",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:c?"Creating account...":"Sign Up with Email"})]}),e.jsx("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:e.jsxs("p",{style:{color:"#ccc",margin:0,fontSize:"0.85rem"},children:["Need help? ",e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline",fontWeight:"bold"},children:"Contact admin"})]})}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",padding:"15px",borderRadius:"6px",marginTop:"20px",fontSize:"0.85rem",color:"#ccc"},children:[e.jsx("strong",{style:{color:"#4CAF50"},children:"What happens next?"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0,lineHeight:"1.8"},children:[e.jsx("li",{children:"Your account will be created (email signup) or linked (Google)"}),e.jsx("li",{children:"Admin will approve your account (usually within 24 hours)"}),e.jsx("li",{children:"You'll receive an email once approved"}),e.jsx("li",{children:"Log in with email or Google to access the ladder!"})]})]}),e.jsx("button",{type:"button",onClick:()=>o("check"),style:{width:"100%",marginTop:"20px",padding:"12px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"})]})},C=()=>e.jsxs("form",{onSubmit:j,style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"10px",textAlign:"center"},children:" Check Your Name"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"0.95rem",textAlign:"center"},children:"Enter your name as it appears on the ladder to find your position"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontWeight:"bold"},children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:i.firstName,onChange:v,required:!0,style:{width:"100%",padding:"12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"},placeholder:"Enter your first name",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"25px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontWeight:"bold"},children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:i.lastName,onChange:v,required:!0,style:{width:"100%",padding:"12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"},placeholder:"Enter your last name"})]}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>o("check"),style:{flex:1,padding:"14px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"}),e.jsx("button",{type:"submit",disabled:c||!i.firstName||!i.lastName,style:{flex:2,padding:"14px",background:c||!i.firstName||!i.lastName?"#666":"linear-gradient(135deg, #007bff 0%, #0056b3 100%)",color:"#fff",border:"none",borderRadius:"6px",cursor:c||!i.firstName||!i.lastName?"not-allowed":"pointer",fontWeight:"bold",fontSize:"1.1rem",boxShadow:c||!i.firstName||!i.lastName?"none":"0 4px 15px rgba(0, 123, 255, 0.4)"},children:c?"Checking...":" Find My Position"})]})]}),N=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:" Claim Your Ladder Position"}),(r||f&&f.length>0||i.firstName&&i.lastName)&&e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"2px solid #4CAF50",borderRadius:"8px",padding:"15px",marginBottom:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#4CAF50",marginBottom:"5px"},children:[i.firstName," ",i.lastName]}),f&&f.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{color:"#aaa",fontSize:"0.9rem"},children:["Position #",f[0].position,"  ",f[0].ladder_name||"499-under"," Ladder"]}),f[0].fargo_rate&&e.jsxs("div",{style:{color:"#aaa",fontSize:"0.85rem",marginTop:"5px"},children:["Fargo: ",f[0].fargo_rate]})]}),r&&(!f||f.length===0)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{color:"#aaa",fontSize:"0.9rem"},children:["Position #",r.position,"  ",r.ladderName||"499-under"," Ladder"]}),r.fargoRate&&e.jsxs("div",{style:{color:"#aaa",fontSize:"0.85rem",marginTop:"5px"},children:["Fargo: ",r.fargoRate]})]})]}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"0.95rem",lineHeight:"1.6",textAlign:"center"},children:"Sign in with Google to claim this position instantly."}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{marginBottom:"25px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{type:"button",onClick:()=>x("google"),disabled:c,style:{width:"100%",padding:"14px",background:"#ffffff",color:"#333",border:"1px solid #ddd",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"Google",style:{height:"24px"}}),"Claim with Google"]}),u2]}),e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"20px",marginTop:"25px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#FF9800",marginTop:"0",marginBottom:"10px"},children:" Don't have Google?"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"15px",fontSize:"0.9rem",lineHeight:"1.6"},children:"Contact the admin to claim your position manually."}),e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline",fontWeight:"bold"},children:"admin@frontrangepool.com"})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",padding:"15px",borderRadius:"6px",marginTop:"20px",fontSize:"0.85rem",color:"#ccc"},children:[e.jsx("strong",{style:{color:"#4CAF50"},children:"What happens next?"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0,lineHeight:"1.8"},children:[e.jsx("li",{children:"Sign in with Google"}),e.jsx("li",{children:"Your position will be claimed automatically"}),e.jsx("li",{children:"Admin will approve your claim (usually within 24 hours)"}),e.jsx("li",{children:"You'll receive an email once approved"}),e.jsx("li",{children:"Log in with Google/Facebook to access the ladder!"})]})]}),e.jsx("button",{type:"button",onClick:()=>o("check"),style:{width:"100%",marginTop:"20px",padding:"12px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"})]}),M=()=>e.jsxs("div",{style:{padding:"40px 20px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:""}),e.jsx("h3",{style:{color:"#4CAF50",marginBottom:"15px"},children:"Success!"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"1rem",lineHeight:"1.6"},children:p||"Your request has been submitted successfully!"}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"20px",marginBottom:"25px",textAlign:"left"},children:[e.jsx("h4",{style:{color:"#4CAF50",marginTop:"0",marginBottom:"15px"},children:" Next Steps:"}),e.jsxs("ol",{style:{color:"#ccc",lineHeight:"1.8",margin:"0",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Wait for approval"})," - Admin will approve your account (usually within 24 hours)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Check your email"})," - You'll receive an email once approved"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Log in"})," - Use email or Google to log in"]})]})]}),e.jsx("button",{onClick:t,style:{padding:"14px 28px",background:"linear-gradient(135deg, #007bff 0%, #0056b3 100%)",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1rem",boxShadow:"0 4px 15px rgba(0, 123, 255, 0.4)"},children:"Got it! Close"})]});return e.jsxs(It,{open:n,onClose:t,title:a==="success"?"":" Join the Ladder",maxWidth:"600px",containerSelector:s||null,children:[a==="check"&&S(),a==="checkName"&&C(),a==="new"&&_(),a==="claim"&&N(),a==="success"&&M()]})};function XC({isOpen:n,onClose:t,claimingPlayer:r=null}){const[s,a]=y.useState(r?"claim":"name"),[o,i]=y.useState((r==null?void 0:r.firstName)||""),[l,c]=y.useState((r==null?void 0:r.lastName)||""),[d,u]=y.useState(null),[h,p]=y.useState(!1),[g,f]=y.useState(""),m=async j=>{var S,_;if(j==null||j.preventDefault(),!o.trim()||!l.trim()){f("Please enter both first and last name.");return}f(""),p(!0);try{const C=await mt.checkExistingPlayer(o.trim(),l.trim(),null);if(C.success&&C.hasExistingPlayers&&((S=C.foundPlayers)==null?void 0:S.length)>0){const N=C.foundPlayers.find(E=>{var P;return(P=E.ladder_profiles)==null?void 0:P.length})||C.foundPlayers[0],M=(_=N.ladder_profiles)==null?void 0:_[0];u({first_name:N.first_name,last_name:N.last_name,position:(M==null?void 0:M.position)??999,ladder_name:(M==null?void 0:M.ladder_name)||"499-under",fargo_rate:M==null?void 0:M.fargo_rate}),a("claim")}else f(`We couldn't find you on the ladder. Try "I'm a New Player" instead.`)}catch{f("Error checking. Please try again.")}finally{p(!1)}},v=async()=>{f(""),p(!0),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const j=typeof window<"u"&&window.location.pathname||"/ladder";localStorage.setItem("oauthReturnTo",j.startsWith("/ladder")||j.startsWith("/guest/ladder")?j:"/ladder"),localStorage.setItem("pendingClaim",JSON.stringify({firstName:(d==null?void 0:d.first_name)||o,lastName:(d==null?void 0:d.last_name)||l,phone:"",message:"",position:(d==null?void 0:d.position)??999,ladderName:(d==null?void 0:d.ladder_name)||"499-under",fargoRate:d==null?void 0:d.fargo_rate,isClaiming:!0}));try{const S=await Hl.signInWithOAuth("google");S.success||(f(S.message||"Failed to sign in."),p(!1),localStorage.removeItem("pendingClaim"))}catch{f("Failed. Please try again."),p(!1),localStorage.removeItem("pendingClaim")}},b=()=>{a(r?"claim":"name"),i((r==null?void 0:r.firstName)||""),c((r==null?void 0:r.lastName)||""),u(null),f("")},w=()=>{b(),t()},x={width:"100%",padding:12,borderRadius:8,border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"};return e.jsx(It,{open:n,onClose:w,title:"Claim Your Ladder Position",maxWidth:"480px",children:e.jsxs("div",{style:{padding:24},children:[s==="name"&&e.jsxs("form",{onSubmit:m,children:[e.jsx("p",{style:{color:"#aaa",marginBottom:20,fontSize:"0.95rem"},children:"Enter your name as it appears on the ladder."}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",marginBottom:6,color:"#fff",fontWeight:600},children:"First Name"}),e.jsx("input",{type:"text",value:o,onChange:j=>i(j.target.value),style:x,placeholder:"First name"})]}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("label",{style:{display:"block",marginBottom:6,color:"#fff",fontWeight:600},children:"Last Name"}),e.jsx("input",{type:"text",value:l,onChange:j=>c(j.target.value),style:x,placeholder:"Last name"})]}),g&&e.jsx("div",{style:{background:"rgba(220,53,69,0.15)",border:"1px solid rgba(220,53,69,0.4)",padding:12,borderRadius:8,marginBottom:16,color:"#ff6b6b"},children:g}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx("button",{type:"button",onClick:w,style:{flex:1,padding:14,background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:8,cursor:"pointer",fontWeight:600},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h||!o.trim()||!l.trim(),style:{flex:2,padding:14,background:h?"#555":"#007bff",color:"#fff",border:"none",borderRadius:8,cursor:h?"not-allowed":"pointer",fontWeight:600},children:h?"Checking...":"Find My Position"})]})]}),s==="claim"&&(d||r)&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(76,175,80,0.15)",border:"2px solid #4CAF50",borderRadius:10,padding:16,marginBottom:20,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700,color:"#4CAF50"},children:d?`${d.first_name} ${d.last_name}`:`${r==null?void 0:r.firstName} ${r==null?void 0:r.lastName}`}),e.jsxs("div",{style:{color:"#aaa",fontSize:"0.9rem",marginTop:4},children:["Position #",(d==null?void 0:d.position)??(r==null?void 0:r.position),"  ",(d==null?void 0:d.ladder_name)||(r==null?void 0:r.ladderName)||"499-under"]})]}),e.jsx("p",{style:{color:"#aaa",marginBottom:20},children:"Sign in with Google to claim this position."}),g&&e.jsx("div",{style:{background:"rgba(220,53,69,0.15)",border:"1px solid rgba(220,53,69,0.4)",padding:12,borderRadius:8,marginBottom:16,color:"#ff6b6b"},children:g}),e.jsxs("button",{type:"button",onClick:v,disabled:h,style:{width:"100%",padding:14,background:"#fff",color:"#333",border:"1px solid #ddd",borderRadius:8,fontSize:"1rem",fontWeight:600,cursor:h?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:12},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"",style:{height:24}}),h?"Signing in...":"Continue with Google"]}),e.jsx("button",{type:"button",onClick:()=>{a("name"),u(null),f("")},style:{width:"100%",marginTop:12,padding:10,background:"transparent",color:"#888",border:"none",cursor:"pointer",fontSize:"0.9rem"},children:" Different name"})]})]})})}function Ub({isOpen:n,onClose:t,isMobile:r,onContactAdmin:s}){const[a,o]=y.useState({introduction:!1,brackets:!1,challengeAcceptance:!1,matchTypes:!1,matchReporting:!1,fargoReporting:!1,membership:!1,winnerTakesAll:!1,immunity:!1,prizeDistribution:!1,contact:!1}),i=c=>{o(d=>({...d,[c]:!d[c]}))},l=({sectionKey:c,title:d,children:u,isExpanded:h})=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{onClick:()=>i(c),style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.3s ease",userSelect:"none"},onMouseEnter:p=>{p.target.style.background="rgba(255, 68, 68, 0.2)"},onMouseLeave:p=>{p.target.style.background="rgba(255, 68, 68, 0.1)"},children:[e.jsx("h3",{style:{color:"#ff4444",margin:0,fontSize:"1.2rem",fontWeight:"bold"},children:d}),e.jsx("span",{style:{color:"#ff4444",fontSize:"1.5rem",fontWeight:"bold",transform:h?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:""})]}),h&&e.jsx("div",{style:{padding:"15px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"0 0 8px 8px",border:"1px solid rgba(255, 68, 68, 0.2)",borderTop:"none"},children:u})]});return xr.createPortal(e.jsx(It,{open:n,onClose:t,title:" Ladder of Legends Rules",maxWidth:"600px",maxHeight:"90vh",borderColor:"#ff4444",textColor:"#ffffff",glowColor:"#ff4444",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{lineHeight:"1.5",fontSize:"1rem"},children:[e.jsxs(l,{sectionKey:"introduction",title:" Welcome to the Ladder of Legends",isExpanded:a.introduction,children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"What is the Ladder of Legends?"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"10px"},children:"The Ladder of Legends is a unquiely formatted tournament series that is a sanctioned BCAPL singles pool league. With skill-based brackets, and a dynamic ranking system. Players compete to climb the ladder through strategic challenges and matches, with prizes awarded every 3 months."})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#4CAF50",marginBottom:"8px",fontSize:"1.1rem"},children:"How It Works"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Three Skill Brackets:"})," 499-under, 500-549, and 550+ (based on FargoRate)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Challenge System:"})," Challenge players up to 4 spots above you to climb the ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Types:"})," Challenge matches, SmackDown matches, and SmackBack matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Membership Required:"})," $5/month membership + $5 per match reporting fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pools:"})," Awards every 3 months with scaled payouts based on ladder size"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Getting Started"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Join the Community:"}),' Facebook group "Ladder of Legends" for updates and match coordination']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Claim Your Position:"})," Sign up with Google or email to claim a ladder position (free account creation)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Get Active:"})," Purchase membership and start challenging other players"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Play Matches:"})," Schedule matches anywhere, anytime (except top 5 players - see special rules)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Report Results:"})," Winner reports the match and pays the $5 fee"]})]})]}),e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h4",{style:{color:"#9c27b0",marginBottom:"8px",fontSize:"1.1rem"},children:"Important Notes"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Player Responsibility:"})," You are responsible for knowing and following all rules"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Age Requirement:"})," Players under 18 require parental approval"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Participation Agreement:"})," Joining implies agreement to all rules listed here"]})]})]})]}),e.jsxs(l,{sectionKey:"brackets",title:" Brackets & Race Requirements",isExpanded:a.brackets,children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"15px",fontSize:"1rem"},children:"Players are placed in brackets based on skill levels:"}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"499 and under"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 5 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $20"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"500-549"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 7 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $25"})]})]}),e.jsxs("div",{style:{background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"550+"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 7 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $25"})]})]}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#8b5cf6",marginBottom:"8px",fontSize:"1.1rem"},children:" Bracket Transition Rules"}),e.jsxs("p",{style:{color:"#e0e0e0",fontSize:"0.95rem",marginBottom:"10px"},children:["When your FargoRate exceeds ladder limits, you receive a ",e.jsx("strong",{children:"14-day grace period"}),":"]}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Rating Goes Over Bracket Max:"})," Automatically move up after 14 days if rating stays over (enter at bottom of new bracket)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Rating Drops Below Bracket Min:"})," Choose to stay or move down after 14 days"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"During Grace Period:"})," Can continue playing normally while you decide or recover your rating"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Status:"})," Shown in your User Status panel with countdown timer"]})]}),e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.15)",border:"1px solid rgba(16, 185, 129, 0.4)",borderRadius:"6px",padding:"8px"},children:e.jsx("p",{style:{color:"#10b981",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:' Players moving to lower brackets receive Fast Track privileges - see "Types of Matches" for details'})})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Additional Information"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Brackets are determined using FargoRate"}),e.jsx("li",{children:"If no FargoRate, known skill level equivalent applies"}),e.jsx("li",{children:"Higher races are allowed by mutual agreement"}),e.jsxs("li",{children:[e.jsx("strong",{children:"Note:"})," All matches have a flat $5 reporting fee regardless of bracket"]})]})]}),e.jsxs(l,{sectionKey:"challengeAcceptance",title:" Challenge Acceptance & Decline Policy",isExpanded:a.challengeAcceptance,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Challenge Acceptance"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"15px"},children:"For all match types, players must accept a challenge or use a decline when called out."}),e.jsx("p",{children:"Medical and emergenccy stipulations apply."}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Decline Challenge Policy"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Allowance:"})," Each player gets 2 declines total"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Effect:"})," When a challenge is declined, the challenger moves up one position and the defender moves down one position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reset System:"})," Each decline resets 30 days after it was used (not all at once)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Strategic Use:"})," Use your declines wisely - they have immediate position consequences"]})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"6px",padding:"8px",marginTop:"8px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.9rem",margin:0,fontWeight:"bold"},children:" Important: Declining a challenge results in immediate position changes regardless of match outcome."})})]})]}),e.jsxs(l,{sectionKey:"matchTypes",title:" Types of Matches",isExpanded:a.matchTypes,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"CHALLENGE MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Players can challenge opponents up to 4 spots above them"}),e.jsx("li",{children:"Challenger wins: Players switch positions"}),e.jsx("li",{children:"Defender wins: Ladder positions remain unchanged"})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"SMACKDOWN MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:'Any player can call out a "SmackDown"'}),e.jsx("li",{children:"Player calls out an opponent no more than 5 spots below them"}),e.jsxs("li",{children:["The Challenger ",e.jsx("em",{children:"(Person calling out the SmackDown)"})," pays the full entry fee; the Defender pays 50% of the entry fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Wins:"})," Opponent moves THREE spots down, challenger moves TWO spots up (but not into first place)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Loses:"})," Players switch positions"]}),e.jsx("li",{children:"First place must be earned via a Challenge Match or SmackBack match"})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"SMACKBACK MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"If the SmackDown defender wins, they can challenge for 1st place in their next match with a SmackBack"}),e.jsxs("li",{children:["The Challenger ",e.jsx("em",{children:"(Person calling out the SmackBack)"})," pays the full entry fee; the Defender pays 50% of the entry fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Wins:"})," Moves into 1st place, all other positions move down one spot"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Defender Wins:"})," Ladder positions remain unchanged"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"FAST TRACK MATCHES:"}),e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#2196F3",marginBottom:"8px",fontSize:"1rem"},children:" Fast Track Re-entry System"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.95rem",marginBottom:"10px"},children:"Special matches for players crossing the 500 Fargo rating boundary, designed to be fair to existing ladder players."}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Grace Periods (14 days):"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Over Ladder Max:"})," When your Fargo goes over your ladder's maximum, a 14-day grace period starts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Under Ladder Min:"})," When your Fargo drops below your ladder's minimum, a 14-day grace period starts"]}),e.jsx("li",{children:"Grace status appears in your User Status panel with countdown"})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"What Happens After Grace Period:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Over Max:"})," If still over max after 14 days  ",e.jsx("strong",{children:"Automatically move UP"})," to next ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Back Under Max:"})," If you recover  Stay on current ladder, nothing happens"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Under Min:"})," If still under min after 14 days  Choose to stay or move down with Fast Track"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Back Above Min:"})," If you recover  Stay on current ladder, nothing happens"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Bottom Entry Rule:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:["If you choose to move down to 499-under ladder, you enter at the ",e.jsx("strong",{children:"bottom"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No existing players are bumped"})," - this protects current ladder positions"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Fast Track Privileges:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"2 special challenges"})," (must be used within 4 weeks)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Extended range:"})," Can challenge up to ",e.jsx("strong",{children:"6 spots above"})," (normal limit is 4)"]}),e.jsx("li",{children:'Shown as green tile in User Status panel (e.g., "2 challenges left")'})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Match Mechanics:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"If Fast Track challenger wins:"})," They ",e.jsx("strong",{children:"insert"})," into defender's exact position"]}),e.jsx("li",{children:"The Defender and all other players below the move down one spot"}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Fast Track challenger loses:"})," Ladder positions do not change"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Eligibility:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",fontSize:"0.9rem"},children:[e.jsx("li",{children:"Must be on the same ladder for Fast Track challenges"}),e.jsx("li",{children:"Range must be within 6 positions above challenger"}),e.jsx("li",{children:"Cannot create challenges if 2 uses are exhausted or 4-week window expired"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"TOP 5 PLAYER SPECIAL RULES"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Location Requirement:"})," Matches involving top 5 players must be played at Legends Brews & Cues (2790 Hancock Expwy, Colorado Springs)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Schedule:"})," Top 5 matches are played on SATURDAYS OR SUNDAYS only"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time Window:"})," Match start times between 2pm-8pm, by mutual agreement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Live Streaming:"})," Top 5 matches will be live-streamed on the Legends Facebook page"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No Greens Fees:"})," Tables for top 5 matches are open - no table fees"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin Presence:"})," An admin/TD will be present to referee and make final decisions on disputes"]})]})]})]}),e.jsxs(l,{sectionKey:"matchReporting",title:" Match Reporting Process",isExpanded:a.matchReporting,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Reporting Requirements"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Active membership required:"})," You must have an active $5/month membership to report matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Winner reports:"})," The winner of each match is responsible for reporting the match result"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Required information:"})," Winner selection, final score, race format, and any notes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment required:"})," $5 match fee must be paid when reporting (winner pays the fee)"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Reporting Process"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Step 1:"}),' Winner goes to "Report Match" in the ladder app']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 2:"})," Select the match from pending matches list"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 3:"})," Enter match details (winner, score, race format)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 4:"})," Pay the $5 match fee (via cash, Stripe, or credits)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 5:"})," Match is automatically processed and ladder positions updated"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Payment Options"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Credits:"})," Use account credits if you have $5+ available"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cash:"})," Pay in person at Legends - drop payment in the red dropbox (NOT processed until admin receives and approves payment)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Stripe:"})," Pay directly with credit card through Stripe"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Manual payment:"})," Contact admin for manual payment processing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trust levels:"})," New users require admin verification, trusted users get instant processing"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Important Notes"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Membership check:"})," System automatically checks if your membership is active before allowing reporting"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee distribution:"})," $3 goes to prize pool, $2 goes to platform maintenance"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cash payments:"})," Cash payments are recorded but NOT processed until admin physically receives and approves the payment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin override:"})," Admins can report matches without payment requirements"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Disputes:"})," Contact ladder administrators for any match reporting issues"]})]})]}),e.jsxs(l,{sectionKey:"fargoReporting",title:" BCA Sanctioning & FargoRate Reporting",isExpanded:a.fargoReporting,children:[e.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#dc2626",marginBottom:"8px",fontSize:"1rem"},children:" MANDATORY BCA SANCTIONING REQUIREMENT"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Effective Date:"})," January 1, 2026 - ALL players must be BCA-sanctioned to participate"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Enforcement:"})," Players without sanctioning cannot challenge, accept challenges, or report matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Period:"})," Current players have until January 1, 2026 to get sanctioned"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"New Players:"})," Must be sanctioned before joining the ladder"]})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.2)",border:"1px solid rgba(220, 38, 38, 0.4)",borderRadius:"6px",padding:"8px",marginTop:"8px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" League-wide requirement - no exceptions after January 1, 2026"})})]}),e.jsxs("div",{style:{background:"rgba(107, 70, 193, 0.1)",border:"1px solid rgba(107, 70, 193, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#8b5cf6",marginBottom:"8px",fontSize:"1rem"},children:"How to Get BCA-Sanctioned"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Cost:"})," $25.00 for the current calendar year"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment:"})," Credit card (instant) or cash (dropbox at Legends)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Where:"}),' Click " Get Sanctioned" in your player status on the ladder page']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Already Sanctioned?"})," Contact admin if you've paid elsewhere - they can verify and update your status"]})]})]}),e.jsxs("div",{style:{background:"rgba(0, 188, 212, 0.1)",border:"1px solid rgba(0, 188, 212, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#00BCD4",marginBottom:"8px",fontSize:"1rem"},children:"FargoRate Reporting (Until Jan 1, 2026)"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Current Policy:"})," Matches are sent to FargoRate when BOTH players are sanctioned"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status Indicators:"}),"  Green = sanctioned,  Red = not sanctioned (check player status in ladder)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Important:"})," All matches count for ladder standings regardless of sanctioning status"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"After Jan 1, 2026:"})," ALL matches will be automatically reported to FargoRate since all players must be sanctioned"]})]})]}),e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px"},children:e.jsx("p",{style:{color:"#10b981",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" Get BCA-sanctioned to have your ladder matches count toward your official FargoRate!"})})]}),e.jsx(l,{sectionKey:"membership",title:" Membership & Payment Structure",isExpanded:a.membership,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Creation:"})," Free - no cost to claim a ladder position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ladder Membership:"})," $5/month (required for challenges and match reporting)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Fees:"})," $5 per match (total, not per player)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Who Pays:"})," The WINNER reports the match and pays the $5 fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Important:"})," Only ONE $5 fee per match - not per player!"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee Distribution:"})," $3 to prize pool, $2 to platform"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Methods:"})," Credit card (Stripe) or manual payment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Billing:"})," Monthly automatic renewal for membership"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Reporting:"})," Requires active membership and match fee payment"]})]})}),e.jsx(l,{sectionKey:"winnerTakesAll",title:" Winner Takes All",isExpanded:a.winnerTakesAll,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Entry fees"}),e.jsx("li",{children:"Any added sponsor prizes/money (TBD)"}),e.jsx("li",{children:"Ladder position"}),e.jsx("li",{children:"Bragging rights"})]})}),e.jsx(l,{sectionKey:"immunity",title:" Immunity",isExpanded:a.immunity,children:e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem"},children:"Winners receive 7 day immunity from new challenges."})}),e.jsx(l,{sectionKey:"prizeDistribution",title:" Prize Distribution",isExpanded:a.prizeDistribution,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Period:"})," Every 3 months (4 times per year)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Separate Prize Pools:"})," Each ladder (499-under, 500-549, 550+) has its own prize pool"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pool Funding:"})," $12 per active member (added by league every reset) + $3.00 per match played (from $5 match fee: $0.50 to climber, $2.50 to places)"]}),e.jsx("li",{children:e.jsx("strong",{children:"Prize Distribution:"})}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"8px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Climber:"})," $1 per active player at period start + $0.50 per match played"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Top Players:"})," 15% of field gets paid (minimum 1, no maximum cap)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dynamic Payouts:"})," Prize fund distributed based on field size:"]}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"8px",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1 place paid:"})," 1st gets 100%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2 places paid:"})," 1st gets 60%, 2nd gets 40%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3 places paid:"})," 1st gets 50%, 2nd gets 30%, 3rd gets 20%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4 places paid:"})," 1st gets 50%, 2nd gets 30%, 3rd gets 15%, 4th gets 5%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5+ places paid:"})," 1st gets 40%, 2nd gets 25%, 3rd gets 15%, 4th gets 10%, 5th gets 5%, additional places split remaining %"]})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Climber:"})," Player who climbed the most ladder positions during the 3-month period"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Eligibility:"})," Must have active membership and played at least 3 matches during the period"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Example:"})," With 25 players and $450 prize pool ($300 from added money + $150 from matches): Climber gets $25 (from added money) + $30 (from 60 matches) = $55. Remaining $395 split among top 3 (15% of 25 = 3 places): 1st gets $197.50 (50%), 2nd gets $118.50 (30%), 3rd gets $79 (20%)"]})]})}),e.jsxs(l,{sectionKey:"contact",title:" Questions?",isExpanded:a.contact,children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"15px",fontSize:"1rem"},children:'Join the Facebook group: "Top Colorado Springs Pool Players - The Ladder of Legends" for more information and to participate.'}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"12px",fontSize:"1rem"},children:"Need help or have questions about the rules?"}),e.jsx("button",{onClick:()=>{t(),s?setTimeout(()=>{s()},100):alert("Contact Admin feature is not available in this context. Please use the Contact Admin card on the main ladder page.")},style:{background:"linear-gradient(45deg, #ff4444, #ff6b35)",color:"#fff",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(255, 68, 68, 0.3)"},onMouseEnter:c=>{c.target.style.background="linear-gradient(45deg, #ff5722, #ff9800)",c.target.style.boxShadow="0 6px 20px rgba(255, 68, 68, 0.4)",c.target.style.transform="translateY(-2px)"},onMouseLeave:c=>{c.target.style.background="linear-gradient(45deg, #ff4444, #ff6b35)",c.target.style.boxShadow="0 4px 15px rgba(255, 68, 68, 0.3)",c.target.style.transform="translateY(0)"},children:" Contact Admin"})]})]})]})}),document.body)}const zJ=async n=>{try{const t=await fetch(`${Ie}/api/monetization/payment-status/${n}`);if(!t.ok)throw new Error("Failed to check payment status");const r=await t.json();return{isCurrent:r.isCurrent||!1,message:r.message||"Payment status unknown",lastPayment:r.lastPayment,nextDue:r.nextDue}}catch(t){return console.error("Error checking payment status:",t),{isCurrent:!1,message:"Unable to verify payment status. Please contact support.",lastPayment:null,nextDue:null}}},FJ=(n,t)=>{confirm(` Membership Required

To participate in ladder challenges and match reporting, you need a current $5/month membership.

Would you like to purchase a membership now?`)?n():t()},Vg={TESTING:1,TRIAL_LAUNCH:2,FULL_LAUNCH:3},h2={PHASE_1_END:new Date(2025,10,1),PHASE_2_END:new Date(2026,0,1)},wo=()=>{const n=new Date;return n<h2.PHASE_1_END?{phase:Vg.TESTING,membershipFee:0,name:"Testing Phase",description:"Free Membership",fullDescription:"Free access to all features during testing phase",color:"rgba(76, 175, 80, 0.1)",icon:"",isFree:!0}:n<h2.PHASE_2_END?{phase:Vg.TRIAL_LAUNCH,membershipFee:5,name:"Trial Launch",description:"$5/month",fullDescription:"Trial launch with reduced pricing - 2-month cycles",color:"rgba(255, 152, 0, 0.1)",icon:"",isFree:!1}:{phase:Vg.FULL_LAUNCH,membershipFee:5,name:"Full Launch",description:"$5/month",fullDescription:"Full launch with complete prize pool system - 3-month cycles",color:"rgba(156, 39, 176, 0.1)",icon:"",isFree:!1}},Hx=n=>typeof n!="string"?n:n.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim(),QC=n=>{if(typeof n!="string")return"";const t=n.trim().toLowerCase();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))throw new Error("Invalid email format");return t},ml=n=>{const t=Number(n);if(isNaN(t)||!isFinite(t))throw new Error("Invalid number format");return t},ed=n=>{const t={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};return n&&typeof n=="string"&&(t.Authorization=`Bearer ${Hx(n)}`),t},p2=n=>{if(!n||typeof n!="object")throw new Error("Invalid player data");return{...n,firstName:n.firstName?Hx(n.firstName):"",lastName:n.lastName?Hx(n.lastName):"",email:n.email?QC(n.email):"",fargoRate:n.fargoRate?ml(n.fargoRate):0}},qb=({isOpen:n,onClose:t})=>{const[r,s]=y.useState(""),[a,o]=y.useState(""),[i,l]=y.useState(""),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[p,g]=y.useState(""),f=[{id:"facebook",title:"Facebook Group",description:"Join our Facebook group for community support",details:"The Ladder of Legends",icon:"",action:"Join Group",color:"#1877F2"},{id:"message",title:"Send Message",description:"Send a direct message to ladder admin",details:"Get help with ladder issues, payments, or technical problems",icon:"",action:"Send Message",color:"#8b5cf6"}],m=b=>{switch(s(b.id),b.id){case"facebook":window.open("https://facebook.com/groups/ladderoflegends","_blank");break}},v=async()=>{if(!i.trim()||!a.trim()){g("Please fill in both subject and message");return}d(!0),g("");try{const b=localStorage.getItem("unifiedUserData"),w=b?JSON.parse(b):null,x={subject:i.trim(),message:a.trim(),from:w?`${w.firstName} ${w.lastName}`:"Anonymous User",fromEmail:w?w.email:"unknown@email.com",type:"ladder_admin_message"},j=await fetch(`${Ie}/api/ladder/admin-messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!j.ok){const _=await j.json();throw new Error(_.message||"Failed to send message")}const S=await j.json();console.log("Message sent successfully:",S),h(!0),l(""),o(""),setTimeout(()=>{h(!1),s(""),t()},3e3)}catch(b){console.error("Error sending message:",b),g(b.message||"Failed to send message. Please try again.")}finally{d(!1)}};return n?xr.createPortal(e.jsx(It,{open:n,onClose:t,title:" Contact Ladder Admin",maxWidth:"600px",borderColor:"#ffc107",textColor:"#ffffff",glowColor:"#ffc107",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"20px",fontSize:"1rem",textAlign:"center"},children:"Need help with the ladder? Choose your preferred contact method below:"}),!r&&e.jsx("div",{style:{display:"grid",gap:"15px",marginBottom:"20px"},children:f.map(b=>e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:`2px solid ${b.color}40`,borderRadius:"12px",padding:"16px",cursor:"pointer",transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:w=>{w.target.style.background="rgba(255, 255, 255, 0.1)",w.target.style.borderColor=`${b.color}80`,w.target.style.transform="translateY(-2px)"},onMouseLeave:w=>{w.target.style.background="rgba(255, 255, 255, 0.05)",w.target.style.borderColor=`${b.color}40`,w.target.style.transform="translateY(0)"},onClick:()=>m(b),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"1.5rem",marginRight:"12px"},children:b.icon}),e.jsx("h3",{style:{color:b.color,margin:0,fontSize:"1.1rem",fontWeight:"bold"},children:b.title})]}),e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"0.9rem",lineHeight:"1.4"},children:b.description}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.85rem",lineHeight:"1.3",whiteSpace:"pre-line"},children:b.details}),e.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",background:b.color,color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold"},children:b.action})]},b.id))}),r==="message"&&!u&&e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"12px",padding:"20px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[e.jsx("span",{style:{fontSize:"1.5rem",marginRight:"12px"},children:""}),e.jsx("h3",{style:{color:"#8b5cf6",margin:0,fontSize:"1.1rem",fontWeight:"bold"},children:"Send Message to Ladder Admin"})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",color:"#e0e0e0",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"bold"},children:"Subject:"}),e.jsx("input",{type:"text",value:i,onChange:b=>l(b.target.value),placeholder:"Brief description of your issue...",style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#e0e0e0",fontSize:"0.9rem",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",color:"#e0e0e0",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"bold"},children:"Message:"}),e.jsx("textarea",{value:a,onChange:b=>o(b.target.value),placeholder:"Describe your issue in detail...",rows:4,style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#e0e0e0",fontSize:"0.9rem",resize:"vertical",boxSizing:"border-box",fontFamily:"inherit"}})]}),p&&e.jsx("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"16px",color:"#f44336",fontSize:"0.9rem"},children:p}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{s(""),l(""),o(""),g("")},style:{padding:"10px 20px",background:"transparent",color:"#ccc",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:"Cancel"}),e.jsx("button",{onClick:v,disabled:c,style:{padding:"10px 20px",background:c?"rgba(139, 92, 246, 0.5)":"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",cursor:c?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"bold",opacity:c?.7:1},children:c?"Sending...":"Send Message"})]})]}),u&&e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"12px",padding:"20px",marginBottom:"20px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"12px"},children:""}),e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 8px 0",fontSize:"1.1rem",fontWeight:"bold"},children:"Message Sent Successfully!"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Your message has been sent to the ladder admin. You'll receive a response soon."})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Common Issues:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BCA Sanctioning Status:"})," If you're already sanctioned but showing as not sanctioned"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Issues:"})," Problems with match fees or membership payments"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Profile Problems:"})," Issues with profile completion or approval"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Disputes:"})," Questions about match results or reporting"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Technical Issues:"})," App problems or bugs"]})]})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:t,style:{padding:"12px 24px",background:"linear-gradient(135deg, #ffc107, #ff9800)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",transition:"all 0.2s ease"},onMouseEnter:b=>b.target.style.transform="translateY(-1px)",onMouseLeave:b=>b.target.style.transform="translateY(0)",children:"Close"})})]})}),document.body):null},Dm=({userPin:n,isPublicView:t=!1,isAdmin:r=!1})=>{const[s,a]=y.useState([]),[o,i]=y.useState(!0),[l,c]=y.useState(null),d=y.useRef(null),u=async()=>{var p;try{i(!0),c(null),console.log(" Ticker: Fetching recent matches...");const g=r?["499-under","500-549","550-plus","simulation"]:["499-under","500-549","550-plus"],f=await mt.getRecentCompletedMatches(10,g);console.log(" Ticker: Result from Supabase:",f),console.log(" Ticker: Matches count:",(p=f.matches)==null?void 0:p.length),f.success?(console.log(" Ticker: Setting recent matches:",f.matches),a(f.matches)):(console.error(" Ticker: Error loading matches:",f.error),c(f.error||"Failed to load recent matches"))}catch(g){console.error(" Ticker: Error fetching recent matches:",g),c("Failed to load recent matches")}finally{i(!1)}};y.useEffect(()=>{u()},[n]);const h=p=>{const g=p.winner,f=p.player1,m=p.player2;if(!g||!f||!m)return null;const v=g.firstName&&g.lastName?`${g.firstName} ${g.lastName}`:"Unknown Player",b=g._id===f._id?m:f,w=b.firstName&&b.lastName?`${b.firstName} ${b.lastName}`:"Unknown Player",x=p.gameType||"8-Ball",j=p.raceLength||"5",S=p.score||"N/A";return{winner:v,loser:w,gameType:x,raceLength:j,score:S,ladder:p.ladderDisplayName,date:p.completedDate}};return o?e.jsxs("div",{className:"ladder-news-ticker",children:[e.jsx("div",{className:"ticker-header",children:e.jsx("h4",{children:"Recent Match Results"})}),e.jsxs("div",{className:"ticker-content loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading recent matches..."})]})]}):l||s.length===0?e.jsxs("div",{className:"ladder-news-ticker",children:[e.jsx("div",{className:"ticker-header",children:e.jsx("h4",{children:"Recent Match Results"})}),e.jsx("div",{className:"ticker-content empty",children:e.jsx("span",{children:"No recent matches to display"})})]}):e.jsxs("div",{className:t?"public-news-ticker":"ladder-news-ticker",children:[e.jsxs("div",{className:"ticker-header",children:[e.jsx("h4",{children:"Recent Match Results"}),e.jsx("button",{className:"refresh-button",onClick:u,disabled:o,title:"Refresh recent matches",style:{padding:0,minWidth:"60px",height:"30px",fontSize:"1.2rem"},children:""})]}),e.jsx("div",{className:"ticker-content",ref:d,children:e.jsx("div",{className:"ticker-track",children:[...s,...s].map((p,g)=>{const f=h(p);return f?e.jsx("div",{className:"ticker-item",children:e.jsxs("div",{className:"match-result",children:[e.jsxs("span",{className:"winner",children:[" ",f.winner.split(" ")[0]]}),e.jsx("span",{className:"vs",children:"defeated"}),e.jsx("span",{className:"loser",children:f.loser.split(" ")[0]}),e.jsxs("span",{className:"score",children:["(",f.score,")"]}),e.jsx("span",{className:"ladder-badge",children:f.ladder}),e.jsx("span",{className:"match-date",children:new Date(f.date).toLocaleDateString()})]})},`${p._id}-${g}`):null})})})]})},WJ=({isOpen:n,onClose:t})=>{const[r,s]=y.useState([]),[a,o]=y.useState({}),[i,l]=y.useState(!1),[c,d]=y.useState(null),[u,h]=y.useState({status:"",type:"",priority:""}),[p,g]=y.useState(""),[f,m]=y.useState(!1),v=async()=>{l(!0);try{const _=new URLSearchParams;u.status&&_.append("status",u.status),u.type&&_.append("type",u.type),u.priority&&_.append("priority",u.priority);const C=await fetch(`${Ie}/api/ladder/admin-messages?${_}`);if(C.ok){const N=await C.json();s(N.messages||[])}}catch(_){console.error("Error fetching messages:",_)}finally{l(!1)}},b=async()=>{try{const _=await fetch(`${Ie}/api/ladder/admin-messages/stats`);if(_.ok){const C=await _.json();o(C.stats||{})}}catch(_){console.error("Error fetching stats:",_)}};y.useEffect(()=>{n&&(v(),b())},[n,u]);const w=async(_,C,N={})=>{m(!0);try{const M=await fetch(`${Ie}/api/ladder/admin-messages/${_}/${C}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(M.ok)await v(),await b(),d(null),g("");else{const E=await M.json();alert(`Error: ${E.message||"Failed to update message"}`)}}catch(M){console.error("Error updating message:",M),alert("Failed to update message")}finally{m(!1)}},x=_=>{switch(_){case"new":return"#ffc107";case"read":return"#17a2b8";case"replied":return"#28a745";case"resolved":return"#6c757d";default:return"#6c757d"}},j=_=>{switch(_){case"urgent":return"#dc3545";case"high":return"#fd7e14";case"medium":return"#ffc107";case"low":return"#28a745";default:return"#6c757d"}},S=_=>new Date(_).toLocaleString();return n?xr.createPortal(e.jsx(It,{open:n,onClose:t,title:" Admin Messages",maxWidth:"1000px",borderColor:"#8b5cf6",textColor:"#ffffff",glowColor:"#8b5cf6",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"12px",marginBottom:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#ffc107",fontSize:"1.5rem",fontWeight:"bold"},children:a.new||0}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.8rem"},children:"New"})]}),e.jsxs("div",{style:{background:"rgba(23, 162, 184, 0.1)",border:"1px solid rgba(23, 162, 184, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#17a2b8",fontSize:"1.5rem",fontWeight:"bold"},children:a.read||0}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.8rem"},children:"Read"})]}),e.jsxs("div",{style:{background:"rgba(40, 167, 69, 0.1)",border:"1px solid rgba(40, 167, 69, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#28a745",fontSize:"1.5rem",fontWeight:"bold"},children:a.replied||0}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.8rem"},children:"Replied"})]}),e.jsxs("div",{style:{background:"rgba(108, 117, 125, 0.1)",border:"1px solid rgba(108, 117, 125, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#6c757d",fontSize:"1.5rem",fontWeight:"bold"},children:a.resolved||0}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.8rem"},children:"Resolved"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"20px",flexWrap:"wrap"},children:[e.jsxs("select",{value:u.status,onChange:_=>h({...u,status:_.target.value}),style:{padding:"8px 12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"replied",children:"Replied"}),e.jsx("option",{value:"resolved",children:"Resolved"})]}),e.jsxs("select",{value:u.type,onChange:_=>h({...u,type:_.target.value}),style:{padding:"8px 12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"ladder_admin_message",children:"Ladder Admin"}),e.jsx("option",{value:"general_inquiry",children:"General"}),e.jsx("option",{value:"technical_issue",children:"Technical"}),e.jsx("option",{value:"payment_issue",children:"Payment"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("button",{onClick:()=>h({status:"",type:"",priority:""}),style:{padding:"8px 16px",background:"transparent",color:"#ccc",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem"},children:"Clear Filters"})]}),i?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#e0e0e0"},children:"Loading messages..."}):r.length===0?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#e0e0e0"},children:"No messages found"}):e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:r.map(_=>e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"16px",marginBottom:"12px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:C=>{C.target.style.background="rgba(255, 255, 255, 0.1)"},onMouseLeave:C=>{C.target.style.background="rgba(255, 255, 255, 0.05)"},onClick:()=>d(_),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[e.jsx("h4",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem",fontWeight:"bold"},children:_.subject}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("span",{style:{background:x(_.status),color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"bold"},children:_.status.toUpperCase()}),e.jsx("span",{style:{background:j(_.priority),color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"bold"},children:_.priority.toUpperCase()})]})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.85rem",marginBottom:"8px"},children:["From: ",_.from," (",_.fromEmail,")"]}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.4"},children:_.message.length>100?`${_.message.substring(0,100)}...`:_.message}),e.jsx("div",{style:{color:"#999",fontSize:"0.8rem",marginTop:"8px"},children:S(_.createdAt)})]},_._id))}),c&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100001},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #8b5cf6",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#8b5cf6",margin:0,fontSize:"1.2rem"},children:"Message Details"}),e.jsx("button",{onClick:()=>d(null),style:{background:"transparent",border:"none",color:"#ccc",fontSize:"1.5rem",cursor:"pointer"},children:""})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"1.1rem"},children:c.subject}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem",marginBottom:"12px"},children:["From: ",c.from," (",c.fromEmail,")"]}),e.jsx("div",{style:{color:"#999",fontSize:"0.8rem",marginBottom:"16px"},children:S(c.createdAt)}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"16px",color:"#e0e0e0",fontSize:"0.95rem",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:c.message})]}),c.adminNotes&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h5",{style:{color:"#8b5cf6",margin:"0 0 8px 0",fontSize:"1rem"},children:"Admin Notes:"}),e.jsx("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"12px",color:"#e0e0e0",fontSize:"0.9rem",whiteSpace:"pre-wrap"},children:c.adminNotes})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",color:"#e0e0e0",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"bold"},children:"Admin Notes:"}),e.jsx("textarea",{value:p,onChange:_=>g(_.target.value),placeholder:"Add notes about this message...",rows:3,style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#e0e0e0",fontSize:"0.9rem",resize:"vertical",boxSizing:"border-box",fontFamily:"inherit"}})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>d(null),style:{padding:"10px 20px",background:"transparent",color:"#ccc",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:"Close"}),c.status==="new"&&e.jsx("button",{onClick:()=>w(c._id,"read"),disabled:f,style:{padding:"10px 20px",background:"linear-gradient(135deg, #17a2b8, #138496)",color:"white",border:"none",borderRadius:"8px",cursor:f?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"bold",opacity:f?.7:1},children:"Mark as Read"}),e.jsx("button",{onClick:()=>w(c._id,"replied",{repliedBy:"Admin",adminNotes:p}),disabled:f,style:{padding:"10px 20px",background:"linear-gradient(135deg, #28a745, #1e7e34)",color:"white",border:"none",borderRadius:"8px",cursor:f?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"bold",opacity:f?.7:1},children:"Mark as Replied"}),e.jsx("button",{onClick:()=>w(c._id,"resolved",{adminNotes:p}),disabled:f,style:{padding:"10px 20px",background:"linear-gradient(135deg, #6c757d, #545b62)",color:"white",border:"none",borderRadius:"8px",cursor:f?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"bold",opacity:f?.7:1},children:"Mark as Resolved"})]})]})}),e.jsx("div",{style:{textAlign:"center",marginTop:"20px"},children:e.jsx("button",{onClick:t,style:{padding:"12px 24px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",transition:"all 0.2s ease"},onMouseEnter:_=>_.target.style.transform="translateY(-1px)",onMouseLeave:_=>_.target.style.transform="translateY(0)",children:"Close"})})]})}),document.body):null},$m="/assets/LBC logo with address-972110b7.png";function UJ(){const[n,t]=y.useState(window.innerWidth),[r,s]=y.useState(window.innerHeight),[a]=y.useState(()=>[0,1,2,3].map(f=>{const m=.1+Math.random()*.15,v=Math.random()*Math.PI*2;return{x:Math.random()*n,y:Math.random()*r,vx:Math.cos(v)*m*1.2,vy:Math.sin(v)*m*1.2,baseSize:.8+Math.random()*.4,sizePhase:Math.random()*Math.PI*2,isSizeChanger:!1,speedCategory:"base",lastChange:Date.now(),changeInterval:8e3+Math.random()*12e3,rotationDirection:f>=1?Math.random()>.5?1:-1:0}}));y.useEffect(()=>{const f=()=>{t(window.innerWidth),s(window.innerHeight)};return window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);function o(f,m,v){const[b,w]=y.useState(f);y.useRef(null);const x=y.useRef(f);return y.useEffect(()=>{let j,S=Date.now();const _=()=>{const C=Date.now(),N=C-S,M=x.current;if(C-M.lastChange>M.changeInterval){const z=v.includes(m)?"fast":"base",$={...M,speedCategory:z,lastChange:C,changeInterval:3e3+Math.random()*6e3};x.current=$,w($)}if(Math.random()<.003){const U=Math.atan2(M.vy,M.vx),z=(Math.random()-.5)*Math.PI*.3,$=U+z,W=.3+Math.random()*1,Y=M.speedCategory==="fast"?.6:.2;M.vx=Math.cos($)*W*Y,M.vy=Math.sin($)*W*Y}let E=M.x+M.vx*(N/16),P=M.y+M.vy*(N/16);(E<0||E>n||P<0||P>r)&&(M.edgeShrink||(M.edgeShrink=!0,M.edgeShrinkTime=C));const D=C/1e3;let T=M.baseSize;const A=Math.sin(D*.07+M.sizePhase)*.1,k=Math.sin(D*.35+M.sizePhase*2)*.05;if(T=M.baseSize+A+k,T<M.baseSize*.3&&!M.sizeShrink&&(M.sizeShrink=!0,M.sizeShrinkTime=C),M.edgeShrink){const U=C-M.edgeShrinkTime;if(U<2e3){const $=1-U/2e3;M.edgeOpacity=$,T=M.baseSize+A+k}else if(U<4e3)M.edgeOpacity=.01,T=.01;else if(U<4100)E=Math.random()*n,P=Math.random()*r,M.x=E,M.y=P,T=.01,M.edgeOpacity=.01;else if(U<12500){const $=.01+.99*((U-4100)/8400);T*=$,M.edgeOpacity=$}else M.edgeShrink=!1,M.edgeOpacity=1}else M.edgeOpacity=1;if(M.sizeShrink){const U=C-M.sizeShrinkTime;if(U<2e3){const $=1-U/2e3;M.sizeOpacity=$}else if(U<4e3)M.sizeOpacity=.01,T=.01;else if(U<4100)E=Math.random()*n,P=Math.random()*r,M.x=E,M.y=P,T=.01,M.sizeOpacity=.01;else if(U<12500){const $=.01+.99*((U-4100)/8400);T*=$,M.sizeOpacity=$}else M.sizeShrink=!1,M.sizeOpacity=1}else M.sizeOpacity=1;let R=M.rotation||0;if(m>=1){const z=(Math.sqrt(M.vx*M.vx+M.vy*M.vy)*2+.3)*(N/16)*(M.rotationDirection||1);R+=z}x.current={...M,x:E,y:P,size:T,rotation:R},C-S>100&&(w(x.current),S=C),j=requestAnimationFrame(_)};return _(),()=>cancelAnimationFrame(j)},[n,r,v]),b}y.useState(()=>{const f=[];for(;f.length<2;){const v=Math.floor(Math.random()*4);f.includes(v)||f.push(v)}const m=[];for(;m.length<2;){const v=Math.floor(Math.random()*4);!m.includes(v)&&!f.includes(v)&&m.push(v)}return a.forEach((v,b)=>{f.includes(b)?(v.speedCategory="fast",v.vx=(Math.random()-.5)*2,v.vy=(Math.random()-.5)*2):(v.speedCategory="base",v.vx=(Math.random()-.5)*.5,v.vy=(Math.random()-.5)*.5),m.includes(b)&&(v.isSizeChanger=!0)}),!0});const[i,l]=y.useState(()=>{const f=[];for(;f.length<2;){const m=Math.floor(Math.random()*4);f.includes(m)||f.push(m)}return f}),c=()=>{const f=[];for(;f.length<2;){const m=Math.floor(Math.random()*4);f.includes(m)||f.push(m)}l(f)};y.useEffect(()=>{const f=setInterval(()=>{c(),console.log("Speed reassignment triggered")},4e3+Math.random()*4e3);return()=>clearInterval(f)},[]);const d=o(a[0],0,i),u=o(a[1],1,i),h=o(a[2],2,i),p=o(a[3],3,i),g=(f,m,v,b,w=!1)=>{const x=w&&f.rotation||0;return{position:"absolute",left:f.x,top:f.y,transform:`translate(-50%, -50%) scale(${f.size}) rotate(${x}deg)`,width:m,height:"auto",opacity:v*(f.edgeOpacity||1)*(f.sizeOpacity||1),zIndex:-1,pointerEvents:"none",filter:b,transition:"none"}};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:-1,pointerEvents:"none",overflow:"visible"},children:[e.jsx("img",{src:$m,alt:"Legends Logo Background",style:g(d,160,.75,"drop-shadow(0 0 20px rgba(245, 30, 30, 0.2))")}),e.jsx("img",{src:jm,alt:"8 Ball Background",style:g(u,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)}),e.jsx("img",{src:wm,alt:"9 Ball Background",style:g(h,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)}),e.jsx("img",{src:Qu,alt:"10 Ball Background",style:g(p,40,.7,"drop-shadow(0 0 10px rgba(245, 30, 30, 0.3))",!0)})]})}const ZC=y.memo(()=>{const[n,t]=y.useState(new Date);y.useEffect(()=>{const a=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(a)},[]);const r=a=>{const o={weekday:"long",year:"numeric",month:"long",day:"numeric"};return a.toLocaleDateString(void 0,o)},s=a=>a.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});return e.jsxs("div",{style:{position:"absolute",top:"5px",right:"5px",background:"rgba(0, 0, 0, 0.7)",color:"#fff",padding:"8px 12px",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.2)",fontSize:"0.85rem",fontFamily:"monospace",zIndex:10,textAlign:"center",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px",color:"#10b981"},children:s(n)}),e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:r(n)})]})});ZC.displayName="LocalClock";const eN=y.memo(({selectedLadder:n,setSelectedLadder:t,setHasManuallySelectedLadder:r,currentView:s,setCurrentView:a,isPublicView:o,setShowMatchCalendar:i,isAdmin:l=!1})=>{const c=d=>{switch(d){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";case"simulation":return" Simulation";default:return d}};return e.jsxs("div",{className:"ladder-header-section",style:{position:"relative"},children:[e.jsx(ZC,{}),!o&&s!=="main"&&e.jsx("button",{onClick:()=>a("main"),style:{position:"absolute",top:"5px",left:"5px",background:"transparent",color:"#8B5CF6",border:"2px solid #8B5CF6",borderRadius:"6px",padding:"6px 12px",fontSize:"0.8rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)",zIndex:10},onMouseEnter:d=>{d.target.style.background="rgba(139, 92, 246, 0.1)",d.target.style.transform="translateY(-1px)",d.target.style.boxShadow="0 4px 12px rgba(139, 92, 246, 0.4)"},onMouseLeave:d=>{d.target.style.background="transparent",d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 2px 8px rgba(139, 92, 246, 0.3)"},children:" Back to Ladder Home"}),e.jsx("div",{className:"calendar-button-container",style:{display:"flex",justifyContent:"center",marginBottom:"1rem"},children:e.jsx("button",{className:"calendar-button",onClick:()=>i(!0),style:{background:"transparent",color:"#10b981",border:"2px solid #10b981",borderRadius:"6px",padding:"12px 36px",fontSize:"1.2rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(16, 185, 129, 0.3)",zIndex:10},onMouseEnter:d=>{d.target.style.background="rgba(16, 185, 129, 0.1)",d.target.style.transform="translateY(-1px)",d.target.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)"},onMouseLeave:d=>{d.target.style.background="transparent",d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 2px 8px rgba(16, 185, 129, 0.3)"},children:" Match Calendar"})}),e.jsx("h1",{className:"ladder-main-title",style:{color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontWeight:"bold",fontSize:"3.5rem",letterSpacing:"3px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase",marginBottom:"0rem"},children:"Ladder of Legends"}),e.jsx("p",{className:"ladder-subtitle",style:{marginBottom:"1.5rem",marginTop:"0rem",fontSize:"0.9rem"},children:"Tournament Series"}),e.jsxs("div",{className:"ladder-selector",style:{marginTop:"1rem",padding:"1rem",background:"rgba(0, 0, 0, 0.3)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",gap:"1rem",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("label",{style:{color:"#fff",fontWeight:"bold",whiteSpace:"nowrap",flexShrink:0,fontSize:"0.9rem"},children:"Select Ladder:"}),e.jsxs("select",{value:n,onChange:d=>{t(d.target.value),r(!0)},style:{background:"rgba(0, 0, 0, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"white",padding:"0.5rem 0.8rem",borderRadius:"8px",fontSize:"0.9rem",cursor:"pointer",minWidth:"120px",flexShrink:0},children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"}),l&&e.jsx("option",{value:"simulation",children:" Simulation"}),l&&e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]})]}),e.jsx("h2",{className:"ladder-selection-title",style:{color:"#8B5CF6",WebkitTextStroke:"1.5px #000000",textShadow:"0 0 8px rgba(139, 92, 246, 0.7)",fontWeight:"bold",letterSpacing:"2px",textTransform:"uppercase",fontSize:"2rem",marginBottom:"0rem",marginTop:"1rem",fontFamily:'"Orbitron", "Exo 2", "Rajdhani", "Arial Black", sans-serif'},children:c(n)}),e.jsx("p",{className:"ladder-selection-subtitle",style:{fontSize:"0.9rem",marginTop:"0.2rem"},children:"Current rankings and positions"})]})});eN.displayName="LadderHeader";const qJ="America/Denver";function Bp(){return new Date().toISOString().split("T")[0]}function Yx(n){if(!n)return null;const[t,r,s]=n.split("-");return new Date(parseInt(t),parseInt(r)-1,parseInt(s),12,0,0)}function m2(n){if(!n)return"";const t=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}function Ss(n,t={}){if(!n)return"";const r={year:"numeric",month:"short",day:"numeric"};if(typeof n=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(n)){const[a,o,i]=n.split("-");return new Date(parseInt(a),parseInt(o)-1,parseInt(i)).toLocaleDateString("en-US",{...r,...t})}return(typeof n=="string"?new Date(n):n).toLocaleDateString("en-US",{...r,...t})}function HJ(n,t={}){if(!n)return"";const r={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",timeZone:qJ};return(typeof n=="string"?new Date(n):n).toLocaleString("en-US",{...r,...t})}function YJ(n){if(!n)return!1;const t=typeof n=="string"?new Date(n):n,r=new Date;return t.toDateString()===r.toDateString()}function Hb(){return Bp()}const kd=({isOpen:n,onClose:t})=>{console.log(" Calendar: Component rendered, isOpen:",n);const[r,s]=y.useState([]),[a,o]=y.useState(!1),[i,l]=y.useState(""),[c,d]=y.useState(new Date),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState(!1),[w,x]=y.useState(!1),[j,S]=y.useState(!1),_=()=>{const k=localStorage.getItem("isAuthenticated")==="true";return m(k),k},C=async()=>{console.log(" Calendar: fetchMatches called!"),o(!0),l(""),s([]);try{console.log(" Calendar: Fetching matches from Supabase");const k=await mt.getScheduledMatches();if(!k.success)throw new Error(`Failed to fetch matches: ${k.error}`);const R=k.matches;console.log(" Calendar: Fetched matches data:",R),console.log(" Calendar: Total matches found:",R.length),R.forEach((W,Y)=>{console.log(` Calendar: Match ${Y+1}:`,{id:W.id,player1:W.winner_name,player2:W.loser_name,scheduledDate:W.match_date,completedDate:W.completed_date,status:W.status})});const U=R.filter(W=>{const Y=new Date(W.match_date||W.completed_date);return Y.getMonth()===8&&Y.getDate()===23});console.log(" Calendar: Matches on 9/23:",U);const $=(R||[]).map(W=>({_id:W.id,player1:{firstName:W.winner_name?W.winner_name.split(" ")[0]:"TBD",lastName:W.winner_name?W.winner_name.split(" ").slice(1).join(" "):""},player2:{firstName:W.loser_name?W.loser_name.split(" ")[0]:"TBD",lastName:W.loser_name?W.loser_name.split(" ").slice(1).join(" "):""},scheduledDate:W.match_date,completedDate:W.completed_date,status:W.status,location:W.location,ladder:W.ladder_id,winner_position:W.winner_position,loser_position:W.loser_position,winner_name:W.winner_name,loser_name:W.loser_name})).filter(W=>["scheduled","completed"].includes(W.status)?W.scheduledDate||W.completedDate?!W.player1||!W.player2?(console.log(" Calendar: Filtering out match with missing players:",W._id),!1):!0:(console.log(" Calendar: Filtering out match with no date:",W._id),!1):(console.log(" Calendar: Filtering out match with invalid status:",W.status,W._id),!1));console.log(" Calendar: Filtered matches from",R.length,"to",$.length),s($),console.log(" Calendar: setMatches called with:",$.length,"matches")}catch(k){console.error(" Calendar: Error in fetchMatches:",k),l("Failed to load matches: "+k.message)}finally{o(!1),console.log(" Calendar: fetchMatches completed, loading set to false")}};y.useEffect(()=>{const k=()=>{x(!1)},R=()=>{S(window.innerWidth<=768)};k(),R();const U=()=>{R()};return window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[]),y.useEffect(()=>{n&&(_(),C())},[n]),y.useEffect(()=>{const k=R=>{console.log(" Calendar: Matches updated event received!",R.detail),console.log(" Calendar: Event type:",R.type),console.log(" Calendar: Event target:",R.target),console.log(" Calendar: Refreshing matches..."),C()};return console.log(" Calendar: Setting up matchesUpdated event listener"),window.addEventListener("matchesUpdated",k),console.log(" Calendar: Event listener added to window:",window),()=>{console.log(" Calendar: Removing matchesUpdated event listener"),window.removeEventListener("matchesUpdated",k)}},[]),y.useEffect(()=>{if(!n)return;const k=setInterval(()=>{console.log(" Calendar: Auto-updating matches..."),C()},3e4);return()=>{console.log(" Calendar: Clearing auto-update interval"),clearInterval(k)}},[n]);const N=()=>{const k=c.getFullYear(),R=c.getMonth(),U=new Date(k,R,1),z=new Date(U);z.setDate(z.getDate()-U.getDay());const $=[],W=new Date(z);for(let Y=0;Y<42;Y++)$.push(new Date(W)),W.setDate(W.getDate()+1);return $},M=k=>{const R=k.getFullYear()+"-"+String(k.getMonth()+1).padStart(2,"0")+"-"+String(k.getDate()).padStart(2,"0"),U=r.filter(z=>{const $=new Date(z.scheduledDate||z.completedDate);return $.getFullYear()+"-"+String($.getMonth()+1).padStart(2,"0")+"-"+String($.getDate()).padStart(2,"0")===R});return console.log("Matches for date:",R,U),U},E=k=>{const R=new Date(c);R.setMonth(R.getMonth()+k),d(R),C()},P=N(),D=c.toLocaleDateString("en-US",{month:"long",year:"numeric"}),A=(()=>w?{maxWidth:j?"98vw":"95vw",maxHeight:j?"95vh":"90vh",width:j?"98vw":"95vw",height:j?"95vh":"90vh"}:j?{maxWidth:"95vw",maxHeight:"90vh",width:"95vw",height:"90vh"}:{maxWidth:"1100px",maxHeight:"85vh"})();return xr.createPortal(e.jsxs(It,{open:n,onClose:t,title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:j?"4px":"8px",fontSize:j?"0.9rem":"1rem"},children:[e.jsx("img",{src:$m,alt:"LEGENDS",style:{height:j?"24px":"32px",width:"auto",verticalAlign:"middle"}}),e.jsx("span",{style:{fontSize:j?"0.9rem":"1rem"},children:"Ladder Match Calendar"}),e.jsx("span",{style:{fontSize:j?"18px":"24px"},children:""})]}),maxWidth:A.maxWidth,maxHeight:A.maxHeight,width:A.width,height:A.height,borderColor:"#064e3b",glowColor:"#8B5CF6",textColor:"#FFD700",className:`glossy-calendar-modal ${w?"iframe-mode":""} ${j?"mobile-mode":""}`,children:[e.jsxs("div",{className:`ladder-match-calendar ${w?"iframe-mode":""} ${j?"mobile-mode":""}`,style:{maxHeight:w?"calc(95vh - 80px)":j?"calc(90vh - 80px)":"calc(750px - 100px)",overflowY:"auto",padding:j?"0.2rem":"0.3rem"},children:[e.jsxs("div",{className:"calendar-header",children:[e.jsx("button",{className:"nav-button",onClick:()=>E(-1),children:""}),e.jsx("h2",{className:"month-year",children:D}),e.jsx("button",{className:"nav-button",onClick:()=>E(1),children:""})]}),e.jsxs("div",{className:"calendar-legend",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:j?"0.3rem":"0.5rem",marginBottom:j?"0.3rem":"0.5rem",padding:j?"0.2rem":"0.3rem",fontSize:j?"0.6rem":"0.7rem",color:"#e0e0e0",flexWrap:"wrap"},children:[e.jsx("span",{children:" #1 Ranked"}),e.jsx("span",{children:" Top 5"}),e.jsx("span",{children:" Completed"}),e.jsx("span",{children:" Scheduled"})]}),e.jsxs("div",{className:`calendar-grid ${w?"iframe-mode":""} ${j?"mobile-mode":""}`,children:[e.jsx("div",{className:"day-headers",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(k=>e.jsx("div",{className:"day-header",children:j?k.substring(0,1):k},k))}),e.jsx("div",{className:"calendar-days",children:P.map((k,R)=>{const U=k.getMonth()===c.getMonth(),z=YJ(k),$=M(k),W=$.length>0;return e.jsxs("div",{className:`calendar-day ${U?"":"other-month"} ${z?"today":""}  ${W?"has-matches":""} ${!f&&W?"login-required":""} ${j?"mobile-mode":""} ${w?"iframe-mode":""}`,onClick:()=>{f?(h(k),g(!0)):b(!0)},title:W&&!f?"Login required to view match details":W?"Click to view match details":"",children:[e.jsx("div",{className:"day-number",children:k.getDate()}),W&&e.jsx("div",{className:"match-indicator",children:e.jsx("span",{className:"match-count",children:$.length})}),W&&(!j||!f)&&e.jsx("div",{className:"match-players",children:$.slice(0,6).map((Y,Q)=>{var me,Ce;const H=Y.winner_position?parseInt(Y.winner_position):null,ue=Y.loser_position?parseInt(Y.loser_position):null,J=H&&H<=5||ue&&ue<=5,be=H===1||ue===1,Ae=Y.status==="completed",O=H===1,oe=ue===1;return e.jsxs("div",{className:`player-names ${J?"top5-match":""} ${Ae?"completed-match":"scheduled-match"} ${be?"first-place-match":""}`,children:[e.jsxs("div",{className:"player-name",children:[((me=Y.player1)==null?void 0:me.firstName)||"TBD",O&&e.jsx("span",{className:"crown-icon",children:"  "})]}),e.jsx("div",{className:"vs",children:"vs"}),e.jsxs("div",{className:"player-name",children:[((Ce=Y.player2)==null?void 0:Ce.firstName)||"TBD",oe&&e.jsx("span",{className:"crown-icon",children:"   "})]}),Ae&&e.jsx("span",{className:"status-icon",children:"  "})]},Q)})})]},`${k.getTime()}-${r.length}`)})})]}),a&&e.jsx("div",{className:"loading-state",children:e.jsx("p",{children:"Loading matches..."})}),i&&e.jsxs("div",{className:"error-state",children:[e.jsxs("p",{children:[" ",i]}),e.jsx("button",{onClick:C,className:"retry-button",children:"Try Again"}),e.jsx("button",{onClick:()=>l(""),className:"dismiss-button",children:"Dismiss"})]}),e.jsxs("div",{className:"calendar-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot has-matches"}),e.jsx("span",{children:"Has matches"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot today"}),e.jsx("span",{children:"Today"})]})]})]}),e.jsx(It,{open:p,onClose:()=>g(!1),title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("img",{src:$m,alt:"LEGENDS",style:{height:"50px",width:"auto",verticalAlign:"middle"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("span",{children:["Matches for ",u?u.toLocaleDateString("en-US",{weekday:"long"}):""]}),e.jsx("span",{style:{fontSize:"0.9em",opacity:.9},children:u?u.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):""})]}),e.jsx("span",{style:{fontSize:"24px"},children:""})]}),maxWidth:"600px",maxHeight:"500px",borderColor:"#064e3b",glowColor:"#8B5CF6",textColor:"#FFD700",className:"glossy-calendar-modal",children:e.jsx("div",{className:"day-matches-modal",children:u&&e.jsx(e.Fragment,{children:M(u).length>0?e.jsx("div",{className:"matches-list",children:M(u).map((k,R)=>{var U,z,$,W,Y,Q;return e.jsxs("div",{className:"match-item",children:[e.jsxs("div",{className:"match-players",children:[e.jsxs("div",{className:"player-section",children:[e.jsx("span",{className:"player-role challenger",children:" Challenger"}),e.jsxs("div",{className:"player-name-row",children:[e.jsxs("span",{className:"player-name",children:[(U=k.player1)==null?void 0:U.firstName," ",(z=k.player1)==null?void 0:z.lastName]}),e.jsxs("span",{className:"player-rank",children:["#",(($=k.player1)==null?void 0:$.position)||"N/A"]})]})]}),e.jsx("span",{className:"vs",children:"vs"}),e.jsxs("div",{className:"player-section",children:[e.jsx("span",{className:"player-role defender",children:" Defender"}),e.jsxs("div",{className:"player-name-row",children:[e.jsxs("span",{className:"player-name",children:[(W=k.player2)==null?void 0:W.firstName," ",(Y=k.player2)==null?void 0:Y.lastName]}),e.jsxs("span",{className:"player-rank",children:["#",((Q=k.player2)==null?void 0:Q.position)||"N/A"]})]})]})]}),e.jsxs("div",{className:"match-details",children:[e.jsx("span",{className:"match-type",children:k.matchType}),k.venue&&e.jsxs("span",{className:"venue",children:[" ",k.venue]}),k.scheduledTime&&e.jsxs("span",{className:"time",children:[" ",k.scheduledTime]})]})]},R)})}):e.jsx("p",{className:"no-matches",children:"No matches scheduled for this date"})})})}),e.jsx(It,{open:v,onClose:()=>b(!1),title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"24px"},children:""}),e.jsx("span",{children:"Login Required"})]}),maxWidth:"600px",maxHeight:"500px",borderColor:"#ef4444",glowColor:"#ef4444",textColor:"#ffffff",className:"login-required-modal",children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"#e0e0e0",background:"linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05))",borderRadius:"12px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),e.jsx("h3",{style:{color:"#ffffff",marginBottom:"1rem",fontSize:"1.2rem",fontWeight:"bold"},children:"Must be a registered user to see match data"}),e.jsx("p",{style:{color:"#d0d0d0",marginBottom:"1.5rem",lineHeight:"1.5"},children:"Please log in to your account to view detailed match information and history."}),e.jsx("button",{onClick:()=>b(!1),style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(239, 68, 68, 0.3)"},onMouseEnter:k=>{k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 6px 20px rgba(239, 68, 68, 0.4)"},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 4px 15px rgba(239, 68, 68, 0.3)"},children:"Got it"})]})})]}),document.body)},GJ=({isOpen:n,onClose:t,players:r,selectedLadder:s,isPublicView:a,userLadderData:o,getChallengeReason:i,onPlayerClick:l,handleChallengePlayer:c,getChallengeType:d})=>{const[u,h]=y.useState(new Set);if(!n)return null;const p=v=>{const b=new Set(u);b.has(v)?b.delete(v):b.add(v),h(b)},g=v=>{if(a||!(o!=null&&o.canChallenge))return null;const b=(o==null?void 0:o.ladder)===s;if(!((o==null?void 0:o.canChallenge)&&b))return e.jsx("div",{className:"challenge-reason-mobile",style:{fontSize:"0.9rem",color:"#888",marginTop:"4px",cursor:"pointer",textAlign:"center",padding:"4px 8px",borderRadius:"4px",border:"1px solid #888",backgroundColor:"rgba(136, 136, 136, 0.1)"},onClick:()=>{const j=document.createElement("div");j.style.cssText=`
              position: fixed;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              background: rgba(10, 10, 20, 0.95);
              color: white;
              padding: 20px;
              border-radius: 8px;
              border: 2px solid #6B46C1;
              box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
              z-index: 10000;
              max-width: 90vw;
              font-size: 14px;
              line-height: 1.4;
              text-align: center;
            `,j.innerHTML=`<div>${i(o,v)}</div>`;const S=document.createElement("div");S.style.cssText=`
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0, 0, 0, 0.5);
              z-index: 9999;
              cursor: pointer;
            `;const _=()=>{try{S&&S.parentNode&&document.body.removeChild(S),j&&j.parentNode&&document.body.removeChild(j)}catch(N){console.warn("Error closing popup:",N)}};S.addEventListener("click",_),j.addEventListener("click",N=>N.stopPropagation());const C=document.createElement("button");C.textContent="",C.style.cssText=`
              position: absolute;
              top: 8px;
              right: 12px;
              background: rgba(255, 255, 255, 0.1);
              border: 1px solid rgba(255, 255, 255, 0.3);
              color: white;
              font-size: 18px;
              font-weight: bold;
              cursor: pointer;
              padding: 4px 8px;
              width: 30px;
              height: 30px;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
            `,C.addEventListener("click",_),j.appendChild(C),document.body.appendChild(S),document.body.appendChild(j),setTimeout(_,5e3)},children:i(o,v)});const x=d?d(o,v):null;return x?e.jsx("button",{className:"challenge-btn-mobile",style:{backgroundColor:x==="challenge"?"#ff4444":x==="smackdown"?"#f59e0b":"#10b981",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",width:"100%",transition:"all 0.2s ease"},onClick:j=>{j.stopPropagation(),c&&c(v,x)},onMouseEnter:j=>{j.target.style.transform="translateY(-1px)",j.target.style.opacity="0.9"},onMouseLeave:j=>{j.target.style.transform="translateY(0)",j.target.style.opacity="1"},children:x==="challenge"?"Challenge":x==="smackdown"?"SmackDown":x==="fast-track"?"Fast Track":"SmackBack"}):e.jsx("div",{className:"challenge-reason-mobile",style:{fontSize:"0.9rem",color:"#888",marginTop:"4px",cursor:"pointer",textAlign:"center",padding:"4px 8px",borderRadius:"4px",border:"1px solid #888",backgroundColor:"rgba(136, 136, 136, 0.1)"},onClick:()=>{const j=document.createElement("div");j.style.cssText=`
              position: fixed;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              background: rgba(10, 10, 20, 0.95);
              color: white;
              padding: 20px;
              border-radius: 8px;
              border: 2px solid #6B46C1;
              box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
              z-index: 10000;
              max-width: 90vw;
              font-size: 14px;
              line-height: 1.4;
              text-align: center;
            `,j.innerHTML=`<div>${i(o,v)}</div>`;const S=document.createElement("div");S.style.cssText=`
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0, 0, 0, 0.5);
              z-index: 9999;
              cursor: pointer;
            `;const _=()=>{try{S&&S.parentNode&&document.body.removeChild(S),j&&j.parentNode&&document.body.removeChild(j)}catch(N){console.warn("Error closing popup:",N)}};S.addEventListener("click",_),j.addEventListener("click",N=>N.stopPropagation());const C=document.createElement("button");C.textContent="",C.style.cssText=`
              position: absolute;
              top: 8px;
              right: 12px;
              background: rgba(255, 255, 255, 0.1);
              border: 1px solid rgba(255, 255, 255, 0.3);
              color: white;
              font-size: 18px;
              font-weight: bold;
              cursor: pointer;
              padding: 4px 8px;
              width: 30px;
              height: 30px;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
            `,C.addEventListener("click",_),j.appendChild(C),document.body.appendChild(S),document.body.appendChild(j),setTimeout(_,5e3)},children:i(o,v)})},f=v=>{if(!v.lastMatch)return"No matches";const{opponent:b,result:w,score:x}=v.lastMatch,j=w==="W"?"#4CAF50":"#f44336";return e.jsxs("div",{style:{fontSize:"0.9rem"},children:[e.jsx("span",{style:{color:j,fontWeight:"bold"},children:w==="W"?"W":"L"})," vs ",e.jsx("span",{style:{color:j},children:b}),x&&e.jsx("div",{style:{fontSize:"0.8rem",color:"#888",marginTop:"2px"},children:x})]})},m=v=>{if(v.immunityUntil){const b=new Date(v.immunityUntil),w=new Date;if(w.setHours(0,0,0,0),b>w)return e.jsxs("span",{style:{color:"#FFD700",fontWeight:"bold"},children:["Immune until ",b.toLocaleDateString()]})}return e.jsx("span",{style:{color:"#4CAF50"},children:"Available"})};return e.jsx("div",{className:"mobile-ladder-container",style:{width:"100%",padding:"10px",backgroundColor:"transparent"},children:e.jsx("div",{className:"mobile-players-list",children:r.map((v,b)=>{const w=u.has(v._id);return e.jsxs("div",{className:"mobile-player-card",style:{backgroundColor:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"16px",marginBottom:"12px",transition:"all 0.3s ease",overflow:"hidden"},onMouseEnter:x=>{x.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",x.target.style.borderColor="rgba(107, 70, 193, 0.5)"},onMouseLeave:x=>{x.target.style.backgroundColor="rgba(255, 255, 255, 0.05)",x.target.style.borderColor="rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:w?"12px":"0"},onClick:()=>p(v._id),children:[e.jsx("span",{style:{color:"#FFD700",fontWeight:"bold",fontSize:"1.2rem",marginRight:"12px",minWidth:"30px"},children:v.position}),e.jsxs("span",{style:{color:"white",fontWeight:"500",fontSize:"1.1rem",flex:1},children:[v.firstName," ",v.lastName]}),e.jsx("span",{style:{color:"#888",fontSize:"1.2rem",transition:"transform 0.3s ease",transform:w?"rotate(180deg)":"rotate(0deg)"},children:""})]}),w&&e.jsxs("div",{style:{animation:"slideDown 0.3s ease",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"12px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"12px",fontSize:"0.9rem"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"#888",fontSize:"0.8rem"},children:"Fargo"}),e.jsx("div",{style:{color:"#00BCD4",fontWeight:"bold"},children:v.fargoRate||"N/A"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"#888",fontSize:"0.8rem"},children:"W-L"}),e.jsxs("div",{style:{color:"white",fontWeight:"bold"},children:[v.wins,"-",v.losses]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{color:"#888",fontSize:"0.8rem"},children:"Status"}),e.jsx("div",{style:{fontSize:"0.8rem"},children:m(v)})]})]}),!a&&e.jsxs("div",{style:{textAlign:"center",marginBottom:"12px",fontSize:"0.9rem"},children:[e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",marginBottom:"2px",cursor:"pointer"},title:" = BCA sanctioned (Fargo reported) |  = Not sanctioned (ladder only)",onClick:()=>{const x=document.createElement("div");x.style.cssText=`
                              position: fixed;
                              top: 50%;
                              left: 50%;
                              transform: translate(-50%, -50%);
                              background: rgba(10, 10, 20, 0.95);
                              color: white;
                              padding: 20px;
                              border-radius: 8px;
                              border: 2px solid #6B46C1;
                              box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
                              z-index: 10000;
                              max-width: 90vw;
                              font-size: 14px;
                              line-height: 1.4;
                              text-align: center;
                            `,x.innerHTML=`
                              <div style="margin-bottom: 15px; font-size: 16px; font-weight: bold; color: #6B46C1;">
                                Fargo Reporting System
                              </div>
                              <div style="margin-bottom: 10px;">
                                <strong> Green Checkmark:</strong> Player is BCA-sanctioned
                              </div>
                              <div style="margin-bottom: 10px;">
                                <strong> Red X:</strong> Player is not BCA-sanctioned
                              </div>
                              <div style="margin-bottom: 15px; padding: 10px; background: rgba(107, 70, 193, 0.2); border-radius: 4px;">
                                <strong>Fargo Reporting Rule:</strong><br/>
                                Matches are only reported to FargoRate when <strong>BOTH</strong> players have  checkmarks
                              </div>
                              <div style="font-size: 12px; color: #888;">
                                Non-sanctioned matches still count for ladder standings
                              </div>
                            `;const j=document.createElement("div");j.style.cssText=`
                              position: fixed;
                              top: 0;
                              left: 0;
                              width: 100%;
                              height: 100%;
                              background: rgba(0, 0, 0, 0.5);
                              z-index: 9999;
                              cursor: pointer;
                            `;const S=()=>{try{j&&j.parentNode&&document.body.removeChild(j),x&&x.parentNode&&document.body.removeChild(x)}catch(C){console.warn("Error closing popup:",C)}};j.addEventListener("click",S),x.addEventListener("click",C=>C.stopPropagation());const _=document.createElement("button");_.textContent="",_.style.cssText=`
                              position: absolute;
                              top: 8px;
                              right: 12px;
                              background: rgba(255, 255, 255, 0.1);
                              border: 1px solid rgba(255, 255, 255, 0.3);
                              color: white;
                              font-size: 18px;
                              font-weight: bold;
                              cursor: pointer;
                              padding: 4px 8px;
                              width: 30px;
                              height: 30px;
                              border-radius: 50%;
                              display: flex;
                              align-items: center;
                              justify-content: center;
                            `,_.addEventListener("click",S),x.appendChild(_),document.body.appendChild(j),document.body.appendChild(x),setTimeout(S,8e3)},children:"Fargo Reported"}),e.jsx("div",{children:v.sanctioned&&v.sanctionYear===new Date().getFullYear()?e.jsx("span",{style:{color:"#4CAF50",fontWeight:"bold"},children:" Yes"}):e.jsx("span",{style:{color:"#f44336",fontWeight:"bold"},children:" No"})})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"12px",fontSize:"0.9rem"},children:[e.jsx("div",{style:{color:"#888",fontSize:"0.8rem",marginBottom:"2px"},children:"Last Match"}),e.jsx("div",{children:f(v)})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("button",{style:{flex:1,backgroundColor:"#6B46C1",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease"},onClick:x=>{x.stopPropagation(),l&&l(v)},onMouseEnter:x=>{x.target.style.backgroundColor="#5B3AA3",x.target.style.transform="translateY(-1px)"},onMouseLeave:x=>{x.target.style.backgroundColor="#6B46C1",x.target.style.transform="translateY(0)"},children:" View Stats"}),e.jsx("div",{style:{flex:1},children:g(v)})]})]})]},v._id)})})})};const tN=y.memo(({ladderData:n,isPublicView:t,userLadderData:r,canChallengePlayer:s,getChallengeType:a,getChallengeReason:o,handleChallengePlayer:i,handlePlayerClick:l,getPlayerStatus:c,isPositionClaimed:d,selectedLadder:u})=>{const[h,p]=y.useState(!1);return y.useEffect(()=>{const g=()=>{p(window.innerWidth<=768)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),h?e.jsx(GJ,{isOpen:!0,onClose:()=>{},players:n,selectedLadder:u,isPublicView:t,userLadderData:r,getChallengeReason:o,onPlayerClick:l,handleChallengePlayer:i,getChallengeType:a}):e.jsx("div",{className:"ladder-table-modal",style:t?{width:"100%",maxWidth:"none",minWidth:"100%",padding:"0",margin:"0",boxSizing:"border-box",border:"0"}:{},children:e.jsxs("div",{className:`ladder-table ${t?"":"logged-in-view"}`,style:t?{position:"relative",width:"100%",maxWidth:"none",minWidth:"100%",overflowX:"hidden",overflowY:"visible",boxSizing:"border-box",border:"0"}:{position:"relative"},children:[e.jsxs("div",{className:"table-header",style:t?{width:"100%",maxWidth:"none",minWidth:"100%",border:"0"}:{},children:[e.jsx("div",{className:"header-cell",children:"Rank"}),e.jsx("div",{className:"header-cell",children:"Player"}),e.jsx("div",{className:"header-cell",title:" = BCA sanctioned (Fargo reported) |  = Not sanctioned (ladder only)",style:{cursor:"pointer"},onClick:()=>{const g=document.createElement("div");g.style.cssText=`
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(10, 10, 20, 0.95);
                color: white;
                padding: 30px;
                border-radius: 8px;
                border: 2px solid #6B46C1;
                box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
                z-index: 10000;
                max-width: 500px;
                font-size: 14px;
                line-height: 1.4;
                text-align: center;
              `,g.innerHTML=`
                <div style="margin-bottom: 15px; font-size: 16px; font-weight: bold; color: #6B46C1;">
                  Fargo Reporting System
                </div>
                <div style="margin-bottom: 10px;">
                  <strong> Green Checkmark:</strong> Player is BCA-sanctioned
                </div>
                <div style="margin-bottom: 10px;">
                  <strong> Red X:</strong> Player is not BCA-sanctioned
                </div>
                <div style="margin-bottom: 15px; padding: 10px; background: rgba(107, 70, 193, 0.2); border-radius: 4px;">
                  <strong>Fargo Reporting Rule:</strong><br/>
                  Matches are only reported to FargoRate when <strong>BOTH</strong> players have  checkmarks
                </div>
                <div style="font-size: 12px; color: #888;">
                  Non-sanctioned matches still count for ladder standings
                </div>
              `;const f=document.createElement("div");f.style.cssText=`
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 9999;
                cursor: pointer;
              `;const m=()=>{try{f&&f.parentNode&&document.body.removeChild(f),g&&g.parentNode&&document.body.removeChild(g)}catch(b){console.warn("Error closing popup:",b)}};f.addEventListener("click",m),g.addEventListener("click",b=>b.stopPropagation());const v=document.createElement("button");v.textContent="",v.style.cssText=`
                position: absolute;
                top: 8px;
                right: 12px;
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                padding: 4px 8px;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
              `,v.addEventListener("click",m),g.appendChild(v),document.body.appendChild(f),document.body.appendChild(g),setTimeout(m,8e3)},children:"Fargo"}),t?window.innerWidth<=768?e.jsx("div",{className:"header-cell",children:"W/L"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"header-cell",children:"W"}),e.jsx("div",{className:"header-cell",children:"L"})]}):window.innerWidth<=768?e.jsx("div",{className:"header-cell",children:"W/L"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"header-cell",children:"W"}),e.jsx("div",{className:"header-cell",children:"L"})]}),t&&window.innerWidth>768?e.jsx("div",{className:"header-cell",children:"Last Match"}):t&&window.innerWidth<=768?e.jsx("div",{className:"header-cell",children:"Last Match"}):e.jsx("div",{className:"header-cell",children:"Status"}),!t&&e.jsx("div",{className:"header-cell",title:" = BCA sanctioned (Fargo reported) |  = Not sanctioned (ladder only)",style:{cursor:"pointer"},onClick:()=>{const g=document.createElement("div");g.style.cssText=`
                  position: fixed;
                  top: 50%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  background: rgba(10, 10, 20, 0.95);
                  color: white;
                  padding: 30px;
                  border-radius: 8px;
                  border: 2px solid #6B46C1;
                  box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
                  z-index: 10000;
                  max-width: 500px;
                  font-size: 14px;
                  line-height: 1.4;
                  text-align: center;
                `,g.innerHTML=`
                  <div style="margin-bottom: 15px; font-size: 16px; font-weight: bold; color: #6B46C1;">
                    Fargo Reporting System
                  </div>
                  <div style="margin-bottom: 10px;">
                    <strong> Green Checkmark:</strong> Player is BCA-sanctioned
                  </div>
                  <div style="margin-bottom: 10px;">
                    <strong> Red X:</strong> Player is not BCA-sanctioned
                  </div>
                  <div style="margin-bottom: 15px; padding: 10px; background: rgba(107, 70, 193, 0.2); border-radius: 4px;">
                    <strong>Fargo Reporting Rule:</strong><br/>
                    Matches are only reported to FargoRate when <strong>BOTH</strong> players have  checkmarks
                  </div>
                  <div style="font-size: 12px; color: #888;">
                    Non-sanctioned matches still count for ladder standings
                  </div>
                `;const f=document.createElement("div");f.style.cssText=`
                  position: fixed;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  background: rgba(0, 0, 0, 0.5);
                  z-index: 9999;
                  cursor: pointer;
                `;const m=()=>{try{f&&f.parentNode&&document.body.removeChild(f),g&&g.parentNode&&document.body.removeChild(g)}catch(b){console.warn("Error closing popup:",b)}};f.addEventListener("click",m),g.addEventListener("click",b=>b.stopPropagation());const v=document.createElement("button");v.textContent="",v.style.cssText=`
                  position: absolute;
                  top: 8px;
                  right: 12px;
                  background: rgba(255, 255, 255, 0.1);
                  border: 1px solid rgba(255, 255, 255, 0.3);
                  color: white;
                  font-size: 18px;
                  font-weight: bold;
                  cursor: pointer;
                  padding: 4px 8px;
                  width: 30px;
                  height: 30px;
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                `,v.addEventListener("click",m),g.appendChild(v),document.body.appendChild(f),document.body.appendChild(g),setTimeout(m,8e3)},children:"Fargo Reported"}),!t&&e.jsx("div",{className:"header-cell last-match-header",style:{whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordBreak:"keep-all",justifyContent:"flex-start",textAlign:"left",paddingLeft:"30px"},children:"Last Match"})]}),n.map((g,f)=>e.jsxs("div",{className:`table-row ${g.lastMatch&&g.lastMatch.opponent?"has-last-match":""} ${g.position===1?"first-place-row":""}`,style:t?g.position===1?{width:"100%",maxWidth:"none",minWidth:"100%",border:"2px solid #FFD700",position:"sticky",top:"0px",zIndex:99}:{width:"100%",maxWidth:"none",minWidth:"100%"}:g.position===1?{border:"2px solid #FFD700",position:"sticky",top:"62px",zIndex:99}:{},children:[e.jsxs("div",{className:"table-cell rank",style:g.position===1?{color:"#FFD700",textShadow:"0 0 8px #FFD700",fontSize:"1.2rem",fontWeight:"bold"}:{},children:[g.position===1&&" ","#",g.position]}),e.jsxs("div",{className:"table-cell name",style:{position:"relative"},children:[e.jsxs("div",{className:"player-name-clickable",onClick:()=>l(g),style:g.position===1?{color:"#FFD700",fontSize:"1.15rem",fontWeight:"600",textShadow:"0 0 5px rgba(255, 215, 0, 0.5)"}:{},children:[g.position===1&&e.jsx("span",{style:{position:"absolute",top:"-14px",left:"-2px",fontSize:"1.3rem",transform:"rotate(-10deg)",zIndex:10,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:""}),(()=>{const m=g.firstName||"",v=g.lastName||"";if(t){const b=v?v.charAt(0)+".":"";return m+" "+b}else{if(window.innerWidth>768)return m+" "+v;{const b=v?v.charAt(0)+".":"";return m+" "+b}}})(),!t&&(()=>{var b,w;return!((r==null?void 0:r.email)&&((g.email||"").toLowerCase()===(r.email||"").toLowerCase()||(((b=g.unifiedAccount)==null?void 0:b.email)||"").toLowerCase()===(r.email||"").toLowerCase())||g.email||((w=g.unifiedAccount)==null?void 0:w.email))&&e.jsx("span",{className:"no-account",title:"Unclaimed position",children:"*"})})()]}),!t&&d({ladder:u,position:g.position})&&e.jsx("div",{style:{display:"inline-block",width:"fit-content",flexShrink:"0"},children:e.jsx("div",{style:{background:"#4CAF50",color:"white",borderRadius:"1px",padding:"0px",fontSize:"0.6rem",marginTop:"0px",fontWeight:"400",textAlign:"center",height:"12px",lineHeight:"12px",display:"block",whiteSpace:"nowrap",width:"45px",boxSizing:"border-box",overflow:"hidden"},children:" Claimed"})}),(()=>{console.log(" LadderTable: userLadderData?.canChallenge check:",r==null?void 0:r.canChallenge,"for player:",g.firstName),console.log(" LadderTable: selectedLadder:",u,"userLadderData.ladder:",r==null?void 0:r.ladder);const m=(r==null?void 0:r.ladder)===u,v=(r==null?void 0:r.canChallenge)&&m;return console.log(" LadderTable: isOnCorrectLadder:",m,"canShowChallenges:",v),v})()&&e.jsx("div",{style:{marginTop:"4px"},children:(()=>{console.log(" LadderTable: Checking challenge for",r.firstName,"vs",g.firstName,"canChallenge:",r.canChallenge);const m=a(r,g);return console.log(" LadderTable: Challenge type result:",m),m?e.jsx("button",{className:"challenge-btn-small",onClick:()=>i(g,m),style:{background:m==="challenge"?"#ff4444":m==="smackdown"?"#f59e0b":"#10b981",color:"white",border:"none",borderRadius:"2px",padding:"0px !important",fontSize:"1rem !important",cursor:"pointer",minWidth:"auto !important",width:"auto !important",height:"20px !important",lineHeight:"20px !important",maxHeight:"20px !important",minHeight:"20px !important",margin:"0 !important"},children:m==="challenge"?"Challenge":m==="smackdown"?"SmackDown":m==="fast-track"?"Fast Track":"SmackBack"}):e.jsx("div",{className:"challenge-reason-hover",style:{fontSize:"1.2rem",color:"#888",marginTop:"2px",cursor:"pointer",fontWeight:"bold",textAlign:"center",padding:"4px 8px",borderRadius:"50%",border:"1px solid #888",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},title:o(r,g),onClick:v=>{const b=document.createElement("div");b.style.cssText=`
                              position: fixed;
                              top: 50%;
                              left: 50%;
                              transform: translate(-50%, -50%);
                              background: rgba(10, 10, 20, 0.95);
                              color: white;
                              padding: 40px 50px 40px 40px;
                              border-radius: 8px;
                              border: 2px solid #6B46C1;
                              box-shadow: 0 8px 32px rgba(107, 70, 193, 0.4);
                              z-index: 10000;
                              max-width: 500px;
                              min-width: 400px;
                              font-size: 14px;
                              line-height: 1.4;
                              text-align: center;
                            `,b.innerHTML=`<div style="margin-top: 15px;">${o(r,g)}</div>`;const w=document.createElement("div");w.style.cssText=`
                              position: fixed;
                              top: 0;
                              left: 0;
                              width: 100%;
                              height: 100%;
                              background: rgba(0, 0, 0, 0.5);
                              z-index: 9999;
                              cursor: pointer;
                            `;const x=()=>{document.body.removeChild(w),document.body.removeChild(b)};w.addEventListener("click",x),b.addEventListener("click",S=>S.stopPropagation());const j=document.createElement("button");j.textContent="",j.style.cssText=`
                              position: absolute;
                              top: 8px;
                              right: 12px;
                              background: rgba(255, 255, 255, 0.1);
                              border: 1px solid rgba(255, 255, 255, 0.3);
                              color: white;
                              font-size: 18px;
                              font-weight: bold;
                              cursor: pointer;
                              padding: 4px 8px;
                              width: 30px;
                              height: 30px;
                              border-radius: 50%;
                              display: flex;
                              align-items: center;
                              justify-content: center;
                              transition: all 0.2s ease;
                              z-index: 10001;
                            `,j.addEventListener("mouseenter",()=>{j.style.backgroundColor="rgba(255, 255, 255, 0.2)",j.style.borderColor="rgba(255, 255, 255, 0.5)"}),j.addEventListener("mouseleave",()=>{j.style.backgroundColor="rgba(255, 255, 255, 0.1)",j.style.borderColor="rgba(255, 255, 255, 0.3)"}),j.addEventListener("click",x),b.appendChild(j),document.body.appendChild(w),document.body.appendChild(b),setTimeout(x,5e3)},onMouseEnter:v=>{v.target.style.backgroundColor="#333",v.target.style.color="#fff",v.target.style.borderColor="#fff"},onMouseLeave:v=>{v.target.style.backgroundColor="transparent",v.target.style.color="#888",v.target.style.borderColor="#888"},children:"?"})})()})]}),e.jsx("div",{className:"table-cell fargo-rate",children:g.fargoRate||"N/A"}),t?window.innerWidth<=768?e.jsxs("div",{className:"table-cell wins-losses-combined",style:{transform:"translateX(-5px)",marginLeft:"8px",paddingLeft:"8px",position:"relative",textAlign:"center"},children:[g.wins||0,"/",g.losses||0]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-cell wins",children:g.wins||0}),e.jsx("div",{className:"table-cell losses",children:g.losses||0})]}):window.innerWidth<=768?e.jsxs("div",{className:"table-cell wins-losses-combined",style:{transform:"translateX(-5px)",marginLeft:"8px",paddingLeft:"8px",position:"relative",textAlign:"center"},children:[g.wins||0,"/",g.losses||0]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-cell wins",children:g.wins||0}),e.jsx("div",{className:"table-cell losses",children:g.losses||0})]}),t&&window.innerWidth>768?e.jsx("div",{className:"table-cell last-match",children:g.lastMatch?e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:g.lastMatch.result==="W"?"#4CAF50":"#f44336"},children:[(g.lastMatch.result==="W","")," ",t?(()=>{const m=g.lastMatch.opponent.split(" ");return m.length>=2?m[0]+" "+m[1].charAt(0)+".":g.lastMatch.opponent})():g.lastMatch.opponent]}):e.jsx("span",{style:{color:"#999",fontSize:"0.9rem"},children:"No matches"})}):t&&window.innerWidth<=768?e.jsx("div",{className:"table-cell last-match-mobile",style:{padding:"0 3px",fontSize:"0.6rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:g.lastMatch&&g.lastMatch.opponent?e.jsx("div",{className:"last-match-mobile-details",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:e.jsxs("div",{className:"last-match-result-mobile",style:{fontWeight:"bold",color:g.lastMatch.result==="W"?"#4CAF50":"#f44336",fontSize:"0.6rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:[g.lastMatch.result==="W"?"W":"L"," vs ",t?(()=>{const m=g.lastMatch.opponent.split(" ");return m.length>=2?m[0]+" "+m[1].charAt(0)+".":g.lastMatch.opponent})():g.lastMatch.opponent]})}):e.jsx("span",{className:"no-matches-mobile",style:{color:"#999",fontSize:"0.7rem"},children:"No matches"})}):e.jsx("div",{className:"table-cell status",children:(()=>{const m=c(g);return e.jsx("span",{className:m.className,children:m.text})})()}),!t&&e.jsx("div",{className:"table-cell bca-status",children:g.sanctioned&&g.sanctionYear===new Date().getFullYear()?e.jsx("span",{style:{color:"#4CAF50",fontWeight:"bold"},children:""}):e.jsx("span",{style:{color:"#f44336",fontWeight:"bold"},children:""})}),!t&&e.jsx("div",{className:"table-cell last-match",children:g.lastMatch?e.jsxs("div",{style:{fontSize:"1.0rem",lineHeight:"1.2"},children:[e.jsxs("div",{style:{fontWeight:"bold",color:g.lastMatch.result==="W"?"#4CAF50":"#f44336"},children:[(g.lastMatch.result==="W","")," ",window.innerWidth<=768?(()=>{const m=g.lastMatch.opponent.split(" ");return m.length>=2?m[0]+" "+m[1].charAt(0)+".":g.lastMatch.opponent})():g.lastMatch.opponent]}),e.jsx("div",{style:{color:"#666",fontSize:"0.7rem"},children:Ss(g.lastMatch.date)}),g.lastMatch.venue&&e.jsx("div",{style:{color:"#888",fontSize:"0.65rem"},children:g.lastMatch.venue})]}):e.jsx("span",{style:{color:"#999",fontSize:"1.0rem"},children:"No matches"})})]},g._id||f))]})})});tN.displayName="LadderTable";const Gr={async getUpcomingTournament(n){try{const{data:t,error:r}=await K.from("tournament_events").select(`
          *,
          registrations:tournament_registrations(count)
        `).eq("ladder_name",n).eq("status","registration").order("tournament_date",{ascending:!0}).limit(1).single();if(r&&r.code!=="PGRST116")throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching upcoming tournament:",t),{success:!1,error:t.message}}},async getTournamentById(n){try{const{data:t,error:r}=await K.from("tournament_events").select(`
          *,
          registrations:tournament_registrations(*),
          rounds:tournament_rounds(*),
          player_stats:tournament_player_stats(*)
        `).eq("id",n).single();if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching tournament:",t),{success:!1,error:t.message}}},async getTournamentsByLadder(n,t=10){try{const{data:r,error:s}=await K.from("tournament_events").select("*").eq("ladder_name",n).order("tournament_date",{ascending:!1}).limit(t);if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching tournaments:",r),{success:!1,error:r.message}}},async createTournament(n){try{const{data:t,error:r}=await K.from("tournament_events").insert([n]).select().single();if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error creating tournament:",t),{success:!1,error:t.message}}},async updateTournamentStatus(n,t){try{const{data:r,error:s}=await K.from("tournament_events").update({status:t,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error updating tournament status:",r),{success:!1,error:r.message}}},async registerPlayer(n){try{const{data:t}=await K.from("tournament_registrations").select("id").eq("tournament_id",n.tournament_id).eq("email",n.email).single();if(t)return{success:!1,error:"Already registered for this tournament"};const{data:r,error:s}=await K.from("tournament_registrations").insert([n]).select().single();if(s)throw s;return await K.rpc("calculate_tournament_totals",{tournament_uuid:n.tournament_id}),{success:!0,data:r}}catch(t){return console.error("Error registering player:",t),{success:!1,error:t.message}}},async getTournamentRegistrations(n){try{const{data:t,error:r}=await K.from("tournament_registrations").select("*").eq("tournament_id",n).order("registration_date",{ascending:!0});if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching registrations:",t),{success:!1,error:t.message}}},async updatePaymentStatus(n,t,r=null){try{const s={payment_status:t};r&&(s.payment_confirmation=r);const{data:a,error:o}=await K.from("tournament_registrations").update(s).eq("id",n).select().single();if(o)throw o;if(t==="paid"){const{data:i}=await K.from("tournament_registrations").select("tournament_id, player_id, player_name, payment_amount").eq("id",n).single();if(i){await K.rpc("calculate_tournament_totals",{tournament_uuid:i.tournament_id});const{data:l}=await K.from("tournament_events").select("ladder_name, name").eq("id",i.tournament_id).single();if(l)try{(await fetch("/api/monetization/tournament-entry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:i.tournament_id,tournamentName:l.name,ladderName:l.ladder_name,playerId:i.player_id,playerName:i.player_name,entryFee:i.payment_amount||20})})).ok?console.log(" Added $10 to ladder prize pool"):console.warn(" Failed to add to prize pool, but payment confirmed")}catch(c){console.warn(" Prize pool API error:",c)}}}return{success:!0,data:a}}catch(s){return console.error("Error updating payment status:",s),{success:!1,error:s.message}}},async getTournamentRounds(n){try{const{data:t,error:r}=await K.from("tournament_rounds").select(`
          *,
          matches:tournament_matches(*)
        `).eq("tournament_id",n).order("round_number",{ascending:!0});if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching rounds:",t),{success:!1,error:t.message}}},async getRoundMatches(n){try{const{data:t,error:r}=await K.from("tournament_matches").select("*").eq("round_id",n).order("match_number",{ascending:!0});if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching matches:",t),{success:!1,error:t.message}}},async getCurrentRound(n){try{const{data:t,error:r}=await K.from("tournament_rounds").select(`
          *,
          matches:tournament_matches(*)
        `).eq("tournament_id",n).eq("round_name","King of the Hill").eq("status","in-progress").order("round_number",{ascending:!0});if(r&&console.error("Error fetching King of the Hill round:",r),t&&t.length>0)return console.log(" Found active King of the Hill round"),{success:!0,data:t[0]};const{data:s,error:a}=await K.from("tournament_rounds").select(`
          *,
          matches:tournament_matches(*)
        `).eq("tournament_id",n).in("status",["pending","in-progress"]).neq("round_name","King of the Hill").order("round_number",{ascending:!0}).limit(1);return a?(console.error("Error fetching regular rounds:",a),{success:!1,error:a.message}):s&&s.length>0?{success:!0,data:s[0]}:{success:!0,data:null}}catch(t){return console.error("Error fetching current round:",t),{success:!1,error:t.message}}},async updateMatchResult(n,t,r,s,a,o=null){try{const{data:i,error:l}=await K.from("tournament_matches").update({winner_id:t,winner_name:r,loser_id:s,loser_name:a,score:o,status:"completed",completed_at:new Date().toISOString()}).eq("id",n).select().single();if(l)throw l;return{success:!0,data:i}}catch(i){return console.error("Error updating match result:",i),{success:!1,error:i.message}}},async getTournamentStandings(n){try{const{data:t,error:r}=await K.from("tournament_player_stats").select("*").eq("tournament_id",n).order("eliminated",{ascending:!0}).order("total_payout",{ascending:!1}).order("wins",{ascending:!1});if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching standings:",t),{success:!1,error:t.message}}},async getPlayerStats(n,t){try{const{data:r,error:s}=await K.from("tournament_player_stats").select("*").eq("tournament_id",n).eq("player_id",t).single();if(s&&s.code!=="PGRST116")throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching player stats:",r),{success:!1,error:r.message}}},async updatePlayerStats(n,t,r){try{const{data:s,error:a}=await K.from("tournament_player_stats").update(r).eq("tournament_id",n).eq("player_id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating player stats:",s),{success:!1,error:s.message}}},subscribeToMatches(n,t){return K.channel(`tournament-matches-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"tournament_matches",filter:`tournament_id=eq.${n}`},t).subscribe()},subscribeToStandings(n,t){return K.channel(`tournament-standings-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"tournament_player_stats",filter:`tournament_id=eq.${n}`},t).subscribe()},unsubscribe(n){n&&K.removeChannel(n)},async generateBracket(n,t,r,s){try{const{data:a,error:o}=await K.from("tournament_rounds").insert(t).select();if(o)throw o;const i=r.map(u=>{var h;return{...u,round_id:(h=a.find(p=>p.round_number===u.round_number))==null?void 0:h.id}}),{error:l}=await K.from("tournament_matches").insert(i);if(l)throw l;const{error:c}=await K.from("tournament_player_stats").insert(s);if(c)throw c;const{error:d}=await K.from("tournament_events").update({status:"in-progress",updated_at:new Date().toISOString()}).eq("id",n);if(d)throw d;return{success:!0,rounds:a.length,matches:r.length}}catch(a){return console.error("Error generating bracket:",a),{success:!1,error:a.message}}},async completeTournament(n){try{const t=await this.getTournamentStandings(n);if(!t.success)throw new Error("Failed to get standings");const r=t.data;for(let a=0;a<r.length;a++){const o=r[a];await K.from("tournament_player_stats").update({final_standing:a+1,ladder_position:a+1,updated_at:new Date().toISOString()}).eq("id",o.id)}const{error:s}=await K.from("tournament_events").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",n);if(s)throw s;return{success:!0,standings:r}}catch(t){return console.error("Error completing tournament:",t),{success:!1,error:t.message}}}},rN=y.memo(({isPublicView:n,navigateToView:t,userLadderData:r,handleSmartMatch:s,setCurrentView:a,pendingChallenges:o,setShowMatchReportingModal:i,setShowChallengesModal:l,setShowPaymentDashboard:c,setShowPrizePoolModal:d,setShowUnifiedSignup:u,setShowRulesModal:h,setShowContactAdminModal:p,isAdmin:g,setShowApplicationsManager:f,setShowMatchCalendar:m,setShowAdminMessagesModal:v,selectedLadder:b,setSelectedTournament:w,setShowTournamentRegistrationModal:x,setShowTournamentInfoModal:j})=>{const S=yn();console.log(" NavigationMenu - isPublicView:",n);const _=async()=>{console.log(" Tournament info card clicked");try{const C=await Gr.getUpcomingTournament(b);C.success&&C.data?(console.log(" Found actual tournament:",C.data),w(C.data),j(!0)):(console.log(" No tournament found, showing generic info"),w(null),j(!0))}catch(C){console.error("Error fetching tournament:",C),w(null),j(!0)}};return e.jsx("div",{className:"ladder-navigation",children:e.jsxs("div",{className:"nav-grid",children:[!n&&e.jsxs("div",{className:"nav-card",onClick:()=>t("ladders"),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"View Ladders"}),e.jsx("p",{children:"See all ladder positions and rankings"})]}),e.jsxs("div",{className:"nav-card",onClick:()=>{console.log(" NavigationMenu: Match Calendar clicked, opening calendar"),m(!0)},children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Match Calendar"}),e.jsx("p",{children:"View confirmed matches and schedule"})]}),!n&&(r==null?void 0:r.canChallenge)&&e.jsxs("div",{className:"nav-card",onClick:s,children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Smart Match"}),e.jsx("p",{children:"AI-powered challenge suggestions"})]}),!n&&(r==null?void 0:r.canChallenge)&&e.jsxs("div",{className:"nav-card",onClick:()=>l(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"My Challenges"}),e.jsx("p",{children:"Manage your challenges and responses"}),o.length>0&&e.jsx("div",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#ff4444",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:"bold"},children:o.length})]}),!n&&e.jsxs("div",{className:"nav-card",onClick:()=>i(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Report Match"}),e.jsx("p",{children:"Report match results and pay fees"})]}),!n&&(r==null?void 0:r.playerId)==="ladder"&&e.jsxs("div",{className:"nav-card",onClick:()=>t("matches"),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"My Completed Matches"}),e.jsx("p",{children:"View your completed match history"})]}),e.jsxs("div",{className:"nav-card",onClick:()=>d(!0),style:{position:"relative"},children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Prize Pools"}),e.jsx("p",{children:"View current prize pools and winners"}),e.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",display:"flex",alignItems:"center",gap:"5px",fontSize:"0.8rem",color:"#00ff00"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#00ff00",animation:"pulse 2s infinite"}}),"Live"]})]}),e.jsxs("div",{className:"nav-card",onClick:()=>c(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Payment Dashboard"}),e.jsx("p",{children:"Manage credits, membership, and payments"})]}),!(r!=null&&r.canChallenge)&&(r==null?void 0:r.playerId)!=="guest"&&e.jsxs("div",{className:"nav-card",style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",cursor:"default"},children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Challenge Features"}),e.jsx("p",{children:"Login to access Smart Match and challenge other players"}),e.jsx("button",{onClick:()=>u(!0),style:{background:"#ff4444",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",marginTop:"8px",cursor:"pointer",fontSize:"0.9rem"},children:"Login Now"})]}),e.jsxs("div",{className:"nav-card",onClick:()=>h(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Ladder Rules"}),e.jsx("p",{children:"Read the complete ladder rules"})]}),e.jsxs("div",{className:"nav-card",onClick:()=>p(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Contact Admin"}),e.jsx("p",{children:"Get help with ladder issues"})]}),!n&&r&&b&&e.jsxs("div",{className:"nav-card",onClick:()=>{_()},style:{position:"relative"},children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Tournament"}),e.jsx("p",{children:"View tournament format and structure"}),e.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",width:"8px",height:"8px",borderRadius:"50%",background:"#8b5cf6",animation:"pulse 2s infinite"}})]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"nav-card admin-card",onClick:()=>f(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Applications"}),e.jsx("p",{children:"Review ladder signup applications"})]}),e.jsxs("div",{className:"nav-card admin-card",onClick:()=>v(!0),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Admin Messages"}),e.jsx("p",{children:"View and manage user messages"})]}),e.jsxs("div",{className:"nav-card admin-card",onClick:()=>S("/ladder/admin"),children:[e.jsx("div",{className:"nav-icon",children:""}),e.jsx("h3",{children:"Ladder Admin"}),e.jsx("p",{children:"Manage ladder players and settings"})]})]})]})})});rN.displayName="NavigationMenu";const VJ=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],nN=({opponent:n,opponentLabel:t="Opponent"})=>{const[r,s]=y.useState(!1),[a,o]=y.useState(""),[i,l]=y.useState(null),[c,d]=y.useState(!1),u=async()=>{var f;const g=n==null?void 0:n.email;if(!g){o("No email for opponent");return}if(i){d(!c);return}s(!0),o("");try{const m=await mt.getUserProfileData(g);m.success&&((f=m.data)!=null&&f.profile)?(l(m.data.profile),d(!0)):o("Could not load profile")}catch(m){o(m.message||"Failed to load")}finally{s(!1)}},h=g=>{if(!g||typeof g!="object"||Object.keys(g).length===0)return"Not set";const f=[];for(const m of VJ){const v=g[m];v&&Array.isArray(v)&&v.length>0&&f.push(`${m}: ${v.join(", ")}`)}return f.length>0?f.join(`
`):"Not set"},p=g=>!g||typeof g=="string"&&!g.trim()?"Not set":typeof g=="string"?g.trim():Array.isArray(g)?g.join(", "):String(g);return e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsxs("button",{type:"button",onClick:u,disabled:r||!(n!=null&&n.email),style:{background:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.5)",color:"#10b981",padding:"8px 14px",borderRadius:"6px",fontSize:"0.9rem",cursor:r||!(n!=null&&n.email)?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"6px",opacity:n!=null&&n.email?1:.6},children:[" ",r?"Loading...":c&&i?"Hide availability & locations":"View opponent's availability & locations"]}),a&&e.jsx("div",{style:{color:"#ef4444",fontSize:"0.85rem",marginTop:"6px"},children:a}),c&&i&&e.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.3)",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.1)",fontSize:"0.9rem"},children:[e.jsxs("div",{style:{marginBottom:"10px",color:"#10b981",fontWeight:600},children:[" ",(n==null?void 0:n.firstName)||t,"'s Availability"]}),e.jsx("pre",{style:{whiteSpace:"pre-wrap",margin:0,color:"#e0e0e0",fontFamily:"inherit",fontSize:"0.85rem"},children:h(i.availability)}),e.jsx("div",{style:{marginTop:"12px",marginBottom:"6px",color:"#10b981",fontWeight:600},children:" Preferred Locations"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.85rem"},children:p(i.locations)}),e.jsx("button",{type:"button",onClick:()=>d(!1),style:{marginTop:"10px",background:"transparent",border:"1px solid #666",color:"#999",padding:"4px 10px",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:"Hide"})]})]})},Cf=y.memo(({showMobilePlayerStats:n,selectedPlayerForStats:t,setShowMobilePlayerStats:r,updatedPlayerData:s,lastMatchData:a,playerMatchHistory:o,showFullMatchHistory:i,setShowFullMatchHistory:l,getPlayerStatus:c,fetchUpdatedPlayerData:d,setShowUnifiedSignup:u,isPublicView:h,getChallengeReason:p,userLadderData:g})=>{var k;const[f,m]=y.useState({x:0,y:0}),[v,b]=y.useState(!1),[w,x]=y.useState({x:0,y:0}),j=y.useRef(null);if(y.useEffect(()=>{if(n&&j.current){const R=j.current.offsetWidth||600,U=j.current.offsetHeight||400;m({x:(window.innerWidth-R)/2,y:(window.innerHeight-U)/2})}},[n]),y.useEffect(()=>{if(v)return document.addEventListener("mousemove",_),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",C)}},[v,w]),!n||!t)return null;const S=R=>{R.target.closest(".stats-close-btn")||R.target.closest("button")||(b(!0),x({x:R.clientX-f.x,y:R.clientY-f.y}))},_=R=>{var Y,Q;if(!v)return;const U=R.clientX-w.x,z=R.clientY-w.y,$=window.innerWidth-(((Y=j.current)==null?void 0:Y.offsetWidth)||600),W=window.innerHeight-(((Q=j.current)==null?void 0:Q.offsetHeight)||400);m({x:Math.max(0,Math.min(U,$)),y:Math.max(0,Math.min(z,W))})},C=()=>{b(!1)},N=s||t;console.log(" PlayerStatsModal - safePlayerData.immunityUntil:",N==null?void 0:N.immunityUntil),console.log(" PlayerStatsModal - updatedPlayerData.immunityUntil:",s==null?void 0:s.immunityUntil),console.log(" PlayerStatsModal - selectedPlayerForStats.immunityUntil:",t==null?void 0:t.immunityUntil);const M=a||null,E=o||[],P=M?{result:M.result,opponentName:M.opponent,matchDate:M.date,venue:M.venue,matchType:M.matchType||"challenge",playerRole:M.playerRole||"player",score:M.score||"N/A"}:null,D=E.map(R=>({result:R.result,opponentName:R.opponent,matchDate:R.date,venue:R.venue,matchType:R.matchType||"challenge",playerRole:R.playerRole||"player",score:R.score||"N/A"}));console.log(" PlayerStatsModal - safeMatchHistory:",E),console.log(" PlayerStatsModal - safeMatchHistory length:",E.length),console.log(" PlayerStatsModal - transformedMatchHistory:",D),console.log(" PlayerStatsModal - transformedMatchHistory.length:",D.length);const T=e.jsx("div",{className:"player-stats-modal",style:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999,backdropFilter:"blur(5px)",padding:"10px",boxSizing:"border-box",overflow:"hidden",transform:"none",margin:"0",inset:"0",willChange:"auto"},children:e.jsxs("div",{ref:j,className:"player-stats-content",style:{background:"rgba(35, 35, 42, 0.16)",borderRadius:"18px",maxWidth:"95vw",width:window.innerWidth<=768?"320px":"600px",maxHeight:"85vh",overflowY:"auto",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 32px #e53e3e22, 0 0 16px #e53e3e11",boxSizing:"border-box",position:"absolute",left:`${f.x}px`,top:`${f.y}px`,cursor:v?"grabbing":"grab"},onMouseDown:S,children:[e.jsxs("div",{className:"player-stats-header",children:[e.jsx("h3",{children:h?`${t.firstName} ${t.lastName?t.lastName.charAt(0)+".":""}`:`${t.firstName} ${t.lastName}`}),e.jsx("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:e.jsx("button",{className:"stats-close-btn",onClick:()=>r(!1),children:""})})]}),h&&!((k=t==null?void 0:t.unifiedAccount)!=null&&k.unifiedUserId)&&e.jsxs("div",{style:{padding:"0 20px 15px 20px",textAlign:"center"},children:[e.jsx("button",{onClick:()=>{console.log(" PlayerStatsModal: Green button clicked!"),console.log(" PlayerStatsModal: setShowUnifiedSignup function:",u),r(!1),u(!0),console.log(" PlayerStatsModal: Called setShowUnifiedSignup(true)")},style:{background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",padding:window.innerWidth<=768?"10px 16px":"12px 24px",fontSize:window.innerWidth<=768?"14px":"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)",transition:"all 0.3s ease",width:window.innerWidth<=768?"100%":"auto",boxSizing:"border-box"},onMouseOver:R=>{R.target.style.background="#45a049",R.target.style.transform="translateY(-2px)"},onMouseOut:R=>{R.target.style.background="#4CAF50",R.target.style.transform="translateY(0)"},children:" Claim My Ladder Position"}),e.jsx("p",{style:{fontSize:window.innerWidth<=768?"10px":"12px",color:"#888",margin:window.innerWidth<=768?"6px 0 0 0":"8px 0 0 0",fontStyle:"italic",lineHeight:window.innerWidth<=768?"1.3":"normal"},children:"Verify your profile details and subscribe for full ladder access"})]}),e.jsx("div",{className:"player-stats-body",children:e.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:[e.jsx("div",{style:{flex:"1",minWidth:"200px"},children:e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Rank"}),e.jsxs("div",{className:"stat-value",children:["#",N.position||"N/A"]})]}),!h&&e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"FargoRate"}),e.jsx("div",{className:"stat-value",children:N.fargoRate===0?"No FargoRate":N.fargoRate||"N/A"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Wins"}),e.jsx("div",{className:"stat-value wins",children:N.wins||0})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Losses"}),e.jsx("div",{className:"stat-value losses",children:N.losses||0})]}),!h&&e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Status"}),e.jsx("div",{className:"stat-value status",children:(()=>{const R=c(t);return e.jsx("span",{className:R.className,children:R.text})})()})]}),N.immunityUntil&&new Date(N.immunityUntil)>new Date&&e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Immunity Until"}),e.jsx("div",{className:"stat-value",children:Ss(N.immunityUntil)})]}),!h&&g&&p&&e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Challenge Status"}),e.jsx("div",{className:"stat-value",style:{fontSize:"0.8rem",color:"#ccc",lineHeight:"1.3"},children:p(g,t)}),(t==null?void 0:t.email)&&(t==null?void 0:t.userId)&&e.jsx(nN,{opponent:t,opponentLabel:`${t.firstName||""} ${t.lastName||""}`.trim()})]})]})}),e.jsxs("div",{style:{flex:"1",minWidth:"200px"},children:[e.jsx("div",{className:"stat-item",children:e.jsxs("div",{className:"stat-value",children:[e.jsx("div",{style:{marginBottom:"8px",fontSize:"0.9rem",color:"#ccc"},children:"Last Match"}),P?e.jsxs("div",{className:"last-match-info",style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%",marginBottom:"8px"},children:[e.jsxs("div",{className:"match-opponent",style:{margin:0,marginRight:"auto"},children:["vs ",h?(()=>{const R=P.opponentName.split(" ");return R.length>=2?R[0]+" "+R[1].charAt(0)+".":P.opponentName})():P.opponentName]}),e.jsx("div",{className:`match-result ${P.result==="W"?"win":"loss"}`,style:{margin:0,padding:"4px 8px",fontSize:"0.8rem",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"20px",height:"20px",marginLeft:"70px"},children:P.result==="W"?"W":"L"})]}),!h&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsxs("div",{className:"match-result",children:[P.result==="W"?"Won":"Lost"," ",P.score]}),e.jsx("div",{className:"match-type",children:P.matchType==="challenge"?"Challenge Match":P.matchType==="ladder-jump"?"Ladder Jump":P.matchType==="smackdown"?"SmackDown":P.matchType==="smackback"?"SmackBack":P.matchType==="fast-track"?"Fast Track Challenge":P.matchType}),e.jsx("div",{className:"player-role",children:P.playerRole==="challenger"?"Challenger":P.playerRole==="defender"?"Defender":"Player"}),e.jsx("div",{className:"match-date",children:Ss(P.matchDate)})]})]}):e.jsx("span",{className:"no-match",children:"No recent matches"})]})}),e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-label",children:"Match History"}),e.jsx("div",{className:"stat-value",children:h?e.jsx("div",{style:{textAlign:"center",padding:"20px 8px",color:"#ffaa00",fontSize:"12px",fontStyle:"italic"},children:"Must be a ladder member to see full match history"}):D.length>1?e.jsxs("div",{className:"match-history-list",style:{maxHeight:"150px",overflowY:"auto"},children:[console.log(" Rendering match history (skipping first):",D.slice(1,3)),D.slice(1,3).map((R,U)=>e.jsxs("div",{className:"match-history-item",style:{padding:"6px",borderBottom:"1px solid rgba(255,255,255,0.1)",fontSize:"11px",marginBottom:"2px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{className:`match-result ${R.result==="W"?"win":"loss"}`,children:R.result==="W"?"W":"L"}),e.jsxs("span",{style:{color:"#ccc"},children:["vs ",h?(()=>{const z=R.opponentName.split(" ");return z.length>=2?z[0]+" "+z[1].charAt(0)+".":R.opponentName})():R.opponentName]}),e.jsx("span",{style:{color:"#888",fontSize:"10px"},children:Ss(R.matchDate)})]}),e.jsxs("div",{style:{fontSize:"10px",color:"#888",marginTop:"2px"},children:[R.score,"  ",R.matchType,"  ",HJ(R.matchDate)]})]},U)),D.length>3&&e.jsx("div",{style:{textAlign:"center",padding:"8px"},children:e.jsxs("button",{onClick:()=>{console.log(" Show More button clicked! Setting showFullMatchHistory to true"),console.log(" Current showFullMatchHistory state:",i),r(!1),setTimeout(()=>{l(!0),console.log(" After setting showFullMatchHistory to true")},100)},style:{background:"rgba(255, 68, 68, 0.2)",border:"1px solid #ff4444",color:"#ff4444",padding:"4px 8px",borderRadius:"4px",fontSize:"10px",cursor:"pointer"},children:["Show More (",D.length-3," more)"]})})]}):e.jsx("span",{className:"no-match",children:"No previous matches"})})]})]})]})})]})}),A=document.body;return A?xr.createPortal(T,A):(console.error(" No portal target found, rendering inline"),T)});Cf.displayName="PlayerStatsModal";const sN=y.memo(({showFullMatchHistory:n,selectedPlayerForStats:t,setShowFullMatchHistory:r,setShowMobilePlayerStats:s,playerMatchHistory:a,isPublicView:o})=>{if(!n||!t)return null;const i=e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999999,padding:"20px",backdropFilter:"blur(10px)"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #8B5CF6",borderRadius:"12px",width:"90vw",maxWidth:"800px",minWidth:"600px",height:"85vh",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#ffffff"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #ff4444",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h2",{style:{color:"#ff4444",margin:0},children:[" ",t.firstName," ",t.lastName," - Full Match History"]}),e.jsx("button",{onClick:()=>{r(!1),s(!0)},style:{background:"none",border:"none",color:"#ff4444",fontSize:"24px",cursor:"pointer",padding:"5px"},children:""})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#8B5CF6 rgba(255, 255, 255, 0.1)"},children:a.length>0?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",overflow:"hidden"},children:[e.jsx("style",{jsx:!0,children:`
                div::-webkit-scrollbar {
                  width: 8px;
                }
                div::-webkit-scrollbar-track {
                  background: rgba(255, 255, 255, 0.1);
                  border-radius: 4px;
                }
                div::-webkit-scrollbar-thumb {
                  background: #8B5CF6;
                  border-radius: 4px;
                }
                div::-webkit-scrollbar-thumb:hover {
                  background: #7C3AED;
                }
              `}),a.map((l,c)=>(console.log(" Match data:",l),console.log(" Match location:",l.location),console.log(" Match positionBefore:",l.positionBefore),console.log(" Match positionAfter:",l.positionAfter),console.log(" All match keys:",Object.keys(l)),console.log(" Match venue (raw):",l.venue),console.log(" Match player1OldPosition (raw):",l.player1OldPosition),console.log(" Match player1NewPosition (raw):",l.player1NewPosition),e.jsxs("div",{style:{padding:"12px 15px",borderBottom:c<a.length-1?"1px solid rgba(255, 255, 255, 0.1)":"none",display:"flex",alignItems:"center",gap:"12px",minHeight:"60px"},children:[e.jsx("div",{style:{minWidth:"60px"},children:e.jsx("span",{style:{background:l.result==="W"?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)",color:l.result==="W"?"#22c55e":"#ef4444",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",display:"block",textAlign:"center"},children:l.result==="W"?"WIN":"LOSS"})}),e.jsx("div",{style:{minWidth:"140px"},children:e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"14px"},children:["vs ",l.opponentName||l.opponent]})}),e.jsxs("div",{style:{flex:1,textAlign:"center"},children:[e.jsxs("div",{style:{color:"#ccc",fontSize:"13px",marginBottom:"2px"},children:[l.score,"  ",l.matchType,"  ",l.playerRole]}),e.jsxs("div",{style:{color:"#999",fontSize:"12px"},children:[l.location||l.venue||"Location TBD","  Pos ",l.positionBefore||"?","  ",l.positionAfter||"?"]})]}),e.jsx("div",{style:{minWidth:"90px",textAlign:"right"},children:e.jsx("div",{style:{color:"#888",fontSize:"11px"},children:new Date(l.matchDate||l.date).toLocaleDateString()})})]},c)))]}):e.jsx("div",{style:{textAlign:"center",color:"#ccc",padding:"40px",fontSize:"16px"},children:"No completed matches found"})})]})});return o?i:xr.createPortal(i,document.body)});sN.displayName="FullMatchHistoryModal";const KJ=({isOpen:n,onClose:t,userLadderData:r,isProfileComplete:s,setShowPaymentDashboard:a,setShowPaymentInfo:o})=>{if(!n)return null;const i=typeof window<"u"?window.innerWidth<=768:!1;console.log(" PromotionalPeriodModal - Profile completion status:",{isProfileComplete:s,userLadderData:r==null?void 0:r.playerInfo});const l=e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:i?"10px":"20px"},children:e.jsxs("div",{style:{backgroundColor:"#1a1a2e",borderRadius:"12px",padding:i?"12px":"25px",maxWidth:i?"95vw":"400px",width:i?"95vw":"50vw",border:"2px solid #4CAF50",boxShadow:"0 10px 30px rgba(76, 175, 80, 0.3)",position:"relative",maxHeight:i?"80vh":"auto",overflowY:i?"auto":"visible",display:"flex",flexDirection:"column"},children:[e.jsx("button",{onClick:t,style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",color:"#fff",fontSize:i?"20px":"24px",cursor:"pointer",padding:"5px",borderRadius:"50%",width:i?"30px":"35px",height:i?"30px":"35px",display:"flex",alignItems:"center",justifyContent:"center"},children:""}),e.jsxs("div",{style:{textAlign:"center",marginBottom:i?"15px":"25px"},children:[e.jsx("div",{style:{fontSize:i?"35px":"48px",marginBottom:i?"5px":"10px"},children:""}),e.jsx("h2",{style:{color:"#4CAF50",margin:"0 0 8px 0",fontSize:i?"18px":"24px",fontWeight:"bold"},children:"FREE PERIOD ACTIVE!"}),e.jsx("p",{style:{color:"#e0e0e0",margin:"0",fontSize:i?"13px":"16px",lineHeight:i?"1.3":"1.5"},children:"Full ladder member access is completely FREE until October 31st, 2025!"})]}),e.jsxs("div",{style:{marginBottom:i?"15px":"25px",flex:"1"},children:[e.jsxs("div",{style:{backgroundColor:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:i?"12px":"20px",marginBottom:i?"12px":"20px"},children:[e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 12px 0",fontSize:i?"15px":"18px"},children:" What's Included:"}),e.jsxs("ul",{style:{color:"#e0e0e0",margin:"0",paddingLeft:"20px",lineHeight:i?"1.4":"1.6",fontSize:i?"13px":"16px"},children:[e.jsx("li",{children:"Full ladder participation"}),e.jsx("li",{children:"All ladder member features unlocked"}),e.jsx("li",{children:"No monthly membership fee required"})]}),e.jsx("div",{style:{marginTop:i?"10px":"15px",padding:i?"8px":"12px",backgroundColor:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px"},children:e.jsx("p",{style:{color:"#ffc107",margin:"0",fontSize:i?"12px":"14px",fontWeight:"bold"},children:" Note: Match reporting still requires $5 per match fee"})})]}),!s&&e.jsxs("div",{style:{backgroundColor:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#ffc107",margin:"0 0 15px 0",fontSize:"18px"},children:" Complete Your Profile:"}),e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 10px 0",lineHeight:"1.6"},children:"To unlock all features, add your available dates and preferred locations in your profile settings."}),e.jsx("button",{onClick:()=>{t(),window.dispatchEvent(new CustomEvent("openProfileModal"))},style:{background:"linear-gradient(135deg, #ffc107 0%, #ff8f00 100%)",color:"#000",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Complete Profile"})]}),s&&e.jsxs("div",{style:{backgroundColor:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:i?"15px":"20px",marginBottom:i?"15px":"20px"},children:[e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 10px 0",fontSize:i?"16px":"18px"},children:" Profile Complete!"}),e.jsx("p",{style:{color:"#e0e0e0",margin:"0",lineHeight:"1.6",fontSize:i?"14px":"16px"},children:"Your profile is fully set up. You have access to all ladder features during the promotional period!"})]})]}),e.jsxs("div",{style:{textAlign:"center",marginTop:"auto"},children:[e.jsxs("div",{style:{display:"flex",gap:i?"8px":"12px",justifyContent:"center",marginBottom:i?"10px":"15px",flexDirection:i?"column":"row"},children:[e.jsx("button",{onClick:()=>{t(),a&&a(!0)},style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",padding:i?"12px 16px":"10px 20px",fontSize:i?"13px":"14px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",width:i?"100%":"auto"},onMouseEnter:c=>{c.target.style.transform="translateY(-2px)",c.target.style.boxShadow="0 6px 20px rgba(0, 0, 0, 0.3)"},onMouseLeave:c=>{c.target.style.transform="translateY(0)",c.target.style.boxShadow="0 4px 15px rgba(0, 0, 0, 0.2)"},children:" View Payment Dashboard"}),e.jsx("button",{onClick:()=>{t(),o?o(!0):alert(` Payment Information

 Monthly Membership: $5/month
 Match Reporting Fee: $5 per match
 Payment Methods: CashApp, Venmo, PayPal, Credit/Debit

Note: Match reporting still requires $5 per match fee during the promotional period.`)},style:{background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)",color:"white",border:"none",borderRadius:"8px",padding:i?"12px 16px":"10px 20px",fontSize:i?"13px":"14px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease",width:i?"100%":"auto"},onMouseEnter:c=>{c.target.style.transform="translateY(-2px)",c.target.style.boxShadow="0 6px 20px rgba(0, 0, 0, 0.3)"},onMouseLeave:c=>{c.target.style.transform="translateY(0)",c.target.style.boxShadow="0 4px 15px rgba(0, 0, 0, 0.2)"},children:" Payment Information"})]}),e.jsx("button",{onClick:t,style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",border:"none",borderRadius:"6px",padding:i?"14px 20px":"12px 30px",cursor:"pointer",fontSize:i?"15px":"16px",fontWeight:"bold",width:i?"100%":"auto",marginTop:i?"5px":"0"},children:"Got It!"})]})]})});return xr.createPortal(l,document.body)},JJ=({isOpen:n,onClose:t,playerName:r,playerEmail:s,onSuccess:a})=>{var j,S,_,C,N,M,E,P,D;console.log(" BCASanctioningPaymentModal rendered with props:",{isOpen:n,playerName:r,playerEmail:s});const[o,i]=y.useState(!1),[l,c]=y.useState("stripe"),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState(null);y.useEffect(()=>{n&&s&&m()},[n,s]);const m=async()=>{try{console.log(" Fetching BCA status for:",s);const T=await fetch(`${Ie}/api/monetization/bca-sanctioning-status/${encodeURIComponent(s)}`);if(T.ok){const A=await T.json();console.log(" BCA status response:",A),f(A)}else console.log(" BCA status fetch failed:",T.status)}catch(T){console.error("Error fetching BCA status:",T)}},v=async T=>{T.preventDefault(),i(!0),u("");try{l==="stripe"?await b():l==="cash"&&await w()}catch(A){console.error("Payment error:",A),u(A.message||"Payment processing failed. Please try again.")}finally{i(!1)}},b=async()=>{const T=await fetch(`${Ie}/api/monetization/create-bca-sanctioning-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:s,playerName:r,amount:25,returnUrl:window.location.origin+"/ladder"})}),A=await T.json();if(!T.ok)throw new Error(A.message||"Failed to create payment session");window.location.href=A.url},w=async()=>{const T=await fetch(`${Ie}/api/monetization/bca-sanctioning`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:s,playerName:r,paymentMethod:"cash",amount:25})}),A=await T.json();if(!T.ok)throw new Error(A.message||"Failed to record payment");p(" Cash payment recorded! Please drop your $25 payment in the red dropbox at Legends. Your BCA sanctioning will be activated once admin receives and approves your payment."),setTimeout(()=>{a&&a(A),t()},3e3)},x=((j=g==null?void 0:g.player)==null?void 0:j.sanctioned)&&((S=g==null?void 0:g.player)==null?void 0:S.sanctionYear)===new Date().getFullYear();return xr.createPortal(e.jsx(It,{open:n,onClose:t,title:x?" BCAPL Sanctioning Status":" Get BCAPL Sanctioned",maxWidth:"500px",borderColor:x?"#4CAF50":"#ffc107",textColor:"#ffffff",glowColor:x?"#4CAF50":"#ffc107",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"20px"},children:[g&&e.jsxs("div",{style:{background:(_=g.player)!=null&&_.sanctioned?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:(C=g.player)!=null&&C.sanctioned?"1px solid rgba(16, 185, 129, 0.3)":"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px",textAlign:"center"},children:[e.jsx("h3",{style:{color:(N=g.player)!=null&&N.sanctioned?"#10b981":"#dc2626",margin:"0 0 10px 0",fontSize:"1.2rem"},children:(M=g.player)!=null&&M.sanctioned?" Already Sanctioned":" Not Sanctioned"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem"},children:(E=g.player)!=null&&E.sanctioned?`Sanctioned for ${g.player.sanctionYear}`:"Get BCA-sanctioned to have your matches reported to FargoRate"})]}),((P=g==null?void 0:g.player)==null?void 0:P.sanctioned)&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(0, 188, 212, 0.1)",border:"1px solid rgba(0, 188, 212, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#00BCD4",marginBottom:"8px",fontSize:"1rem"},children:"What This Means:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem"},children:[e.jsx("li",{children:"Your ladder matches played against other sanctioned players are reported to FargoRate"}),e.jsx("li",{children:"Your official FargoRate will be updated"}),e.jsx("li",{children:"You're eligible for all BCAPL benefits"})]})]}),(g==null?void 0:g.payment)&&e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Payment Details:"}),e.jsxs("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Amount:"})," $",g.payment.amount,e.jsx("br",{}),e.jsx("strong",{children:"Status:"})," ",g.payment.status,e.jsx("br",{}),e.jsx("strong",{children:"Date:"})," ",new Date(g.payment.createdAt).toLocaleDateString()]})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:t,style:{padding:"12px 24px",background:"linear-gradient(135deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",transition:"all 0.2s ease"},onMouseEnter:T=>T.target.style.transform="translateY(-1px)",onMouseLeave:T=>T.target.style.transform="translateY(0)",children:"Close"})})]}),!((D=g==null?void 0:g.player)!=null&&D.sanctioned)&&e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px",fontSize:"1.1rem"},children:"Payment Information"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsxs("p",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"BCA Sanctioning Fee:"})," $25.00"]}),e.jsxs("p",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Valid For:"})," Current calendar year (",new Date().getFullYear(),")"]}),e.jsxs("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Benefit:"})," Your ladder matches will be reported to FargoRate"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 87, 34, 0.1)",border:"1px solid rgba(255, 87, 34, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ff5722",marginBottom:"8px",fontSize:"1rem"},children:" Already Sanctioned?"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem"},children:[e.jsx("li",{children:e.jsx("strong",{children:"Showing as Not Sanctioned?"})}),e.jsx("li",{children:"If you have already paid for BCA sanctioning in another league, please contact an admin"}),e.jsxs("li",{children:[e.jsx("strong",{children:"Verification:"})," Admins can verify your payment and update your sanctioning status manually"]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"8px",fontWeight:"bold"},children:"Payment Method"}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"15px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",borderRadius:"6px",border:l==="stripe"?"2px solid #8b5cf6":"2px solid rgba(255, 255, 255, 0.2)",background:l==="stripe"?"rgba(139, 92, 246, 0.1)":"transparent"},children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"stripe",checked:l==="stripe",onChange:T=>c(T.target.value),style:{marginRight:"8px"}})," Credit Card (Instant)"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",borderRadius:"6px",border:l==="cash"?"2px solid #8b5cf6":"2px solid rgba(255, 255, 255, 0.2)",background:l==="cash"?"rgba(139, 92, 246, 0.1)":"transparent"},children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"cash",checked:l==="cash",onChange:T=>c(T.target.value),style:{marginRight:"8px"}})," Cash (Dropbox)"]})]})]}),d&&e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"15px",color:"#fca5a5",fontSize:"0.9rem"},children:d}),h&&e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"15px",color:"#6ee7b7",fontSize:"0.9rem"},children:h}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:t,disabled:o,style:{padding:"12px 24px",background:"transparent",color:"#ccc",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",cursor:o?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold",opacity:o?.6:1},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,style:{padding:"12px 24px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",cursor:o?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold",opacity:o?.6:1},children:o?"Processing...":"Pay $25.00"})]})]}),l==="cash"&&e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginTop:"15px"},children:[e.jsx("h5",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Cash Payment Instructions"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem"},children:[e.jsx("li",{children:"Drop $25.00 in the red dropbox at Legends"}),e.jsx("li",{children:'Include a note with your name and "BCA Sanctioning"'}),e.jsx("li",{children:"Your sanctioning will be activated once admin receives payment"}),e.jsx("li",{children:"You'll receive confirmation when processed"})]})]})]})}),document.body)},XJ=({userLadderData:n,userPin:t,onShowFastTrackModal:r,onShowPlayerChoiceModal:s})=>{const[a,o]=y.useState(null),[i,l]=y.useState(null),[c,d]=y.useState(!1);y.useState(!1),y.useState(!1),y.useEffect(()=>{var p;(n==null?void 0:n.playerId)==="ladder"&&((p=n==null?void 0:n.unifiedAccount)!=null&&p.unifiedUserId)&&(u(),h())},[n]);const u=async()=>{var p;if((p=n==null?void 0:n.unifiedAccount)!=null&&p.unifiedUserId){d(!0);try{const g=await mt.getFastTrackStatus(n.unifiedAccount.unifiedUserId);g.success?o(g.data):(console.error("Failed to fetch fast track status:",g.error),o(null))}catch(g){console.error("Error fetching fast track status:",g),o(null)}finally{d(!1)}}},h=async()=>{var p;if((p=n==null?void 0:n.unifiedAccount)!=null&&p.unifiedUserId)try{const g=await mt.getFastTrackGracePeriod(n.unifiedAccount.unifiedUserId);g.success?l(g.data):(console.error("Failed to fetch grace period status:",g.error),l(null))}catch(g){console.error("Error fetching grace period status:",g),l(null)}};return!n||n.playerId!=="ladder"?null:i!=null&&i.isActive?e.jsxs("div",{className:"status-item fast-track-grace-period",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"8px"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Grace Period"}),e.jsx("span",{className:"value",style:{color:"#ffc107",cursor:"pointer",fontSize:"0.85rem",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.1"},onClick:()=>r&&r(),children:i.daysRemaining>0?`${i.daysRemaining} days left`:"Move up now!"})]}):a!=null&&a.hasFastTrack&&!a.isExpired?e.jsxs("div",{className:"status-item fast-track-status",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"8px"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Fast Track"}),e.jsxs("span",{className:"value",style:{color:"#10b981",cursor:"pointer",fontSize:"0.85rem",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.1"},onClick:()=>r&&r(),children:[a.challengesRemaining," challenges left"]})]}):null},QJ=({isOpen:n,onClose:t,userLadderData:r,userPin:s,fastTrackStatus:a,gracePeriodStatus:o})=>{const[i,l]=y.useState(!1);if(!n)return null;const c=async()=>{if(r!=null&&r.email){l(!0);try{console.log(" Starting grace period via Supabase for:",r.email);const d=await mt.startFastTrackGracePeriod(r.email);d.success?(alert(` ${d.message}

Grace period expires in 14 days.`),t(),window.location.reload()):alert(`Error: ${d.error||"Failed to start grace period"}`)}catch(d){console.error("Error starting grace period:",d),alert("Error starting grace period. Please try again.")}finally{l(!1)}}};return xr.createPortal(e.jsx(It,{open:n,onClose:t,title:" Fast Track Re-entry System",maxWidth:"700px",borderColor:"#10b981",textColor:"#ffffff",glowColor:"#10b981",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"15px"},children:[(o==null?void 0:o.isActive)&&e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"12px",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#ffc107",margin:"0 0 6px 0",fontSize:"1.1rem"},children:" Grace Period Active"}),e.jsxs("p",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem"},children:[e.jsxs("strong",{children:[o.daysRemaining||0," days"]})," remaining"]}),e.jsx("p",{style:{color:"#ccc",margin:"5px 0 0 0",fontSize:"0.85rem"},children:"Maintain your 500+ rating to move up to the 500+ ladder"})]}),(a==null?void 0:a.hasFastTrack)&&!a.isExpired&&e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"12px",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#10b981",margin:"0 0 6px 0",fontSize:"1.1rem"},children:" Fast Track Active"}),e.jsxs("p",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem"},children:[e.jsx("strong",{children:a.challengesRemaining})," fast track challenges remaining"]}),a.daysRemaining>0&&e.jsxs("p",{style:{color:"#ccc",margin:"5px 0 0 0",fontSize:"0.85rem"},children:["Expires in ",e.jsxs("strong",{children:[a.daysRemaining," days"]})]})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"8px",fontSize:"1rem",textAlign:"center"},children:"How the Fast Track Re-entry System Works"}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"8px"},children:[e.jsx("h5",{style:{color:"#3b82f6",margin:"0 0 6px 0",fontSize:"0.95rem"},children:" When Your Fargo Goes Over Ladder Max:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Period:"})," You get 14 days to see if your rating stays high"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Still Over After 14 Days:"})," Automatically move UP to next ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Drop Back Under Max:"})," Stay on current ladder, nothing happens"]})]})]}),e.jsxs("div",{style:{background:"rgba(249, 115, 22, 0.1)",border:"1px solid rgba(249, 115, 22, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#f97316",margin:"0 0 6px 0",fontSize:"0.95rem"},children:" When Your Fargo Drops Under Ladder Min:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Period:"})," You get 14 days to recover your rating"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Recover Above Min:"})," Stay on current ladder, nothing happens"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Still Under After 14 Days:"})," Choose to stay OR move down with Fast Track"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fast Track Benefits:"})," 2 extended challenges (6 spots range instead of 4)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time Limit:"})," Fast Track expires after 4 weeks"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem",textAlign:"center"},children:"Fast Track Challenge Rules"}),e.jsx("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px"},children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Extended Range:"})," Can challenge up to 6 spots instead of normal 4 spots"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Insertion Mechanics:"})," Winner takes defender's position, everyone below moves down one spot"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Limited Use:"})," Only 2 fast track challenges total"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Same Ladder:"})," Both players must be on the same ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Must Win:"})," You still have to win the match to advance"]})]})})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"8px",fontSize:"1rem",textAlign:"center"},children:"Why This System is Fair"}),e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"12px"},children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"No Unfair Bumping:"})," Existing ladder players are never moved down unfairly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Earned Privileges:"})," Fast track challenge positions must be earned by winning matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time Limited:"})," Privileges expire to prevent abuse"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Player Choice:"})," You decide whether to stay on the higher ladder or move down"]})]})})]}),e.jsxs("div",{style:{textAlign:"center",marginTop:"12px"},children:[(r==null?void 0:r.fargoRate)>=500&&(r==null?void 0:r.ladder)==="499-under"&&!(o!=null&&o.isActive)&&e.jsx("button",{onClick:c,disabled:i,style:{padding:"12px 24px",background:"linear-gradient(135deg, #ffc107, #ff8f00)",color:"white",border:"none",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold",marginRight:"10px",opacity:i?.6:1},children:i?"Starting...":"Start Grace Period"}),e.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"bold"},children:"Got It!"})]})]})}),document.body)},ZJ=({isOpen:n,onClose:t,userLadderData:r,userPin:s,onChoiceMade:a})=>{const[o,i]=y.useState(!1),[l,c]=y.useState(null);if(!n)return null;const d=async u=>{if(r!=null&&r.email){i(!0);try{console.log(" Submitting Fast Track player choice via Supabase:",{choice:u,email:r.email});const h=await mt.submitFastTrackPlayerChoice(r.email,u);h.success?(c(u),alert(u==="stay"?" You will remain on your current ladder. Good luck!":` ${h.message}

You now have ${h.fastTrackChallenges} Fast Track challenges to use within 4 weeks!`),a&&a(u),t(),window.location.reload()):alert(`Error: ${h.error||"Failed to record choice"}`)}catch(h){console.error("Error recording player choice:",h),alert("Error recording your choice. Please try again.")}finally{i(!1)}}};return e.jsx(It,{open:n,onClose:t,title:" Choose Your Ladder Path",maxWidth:"600px",borderColor:"#ffc107",textColor:"#ffffff",glowColor:"#ffc107",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#ffc107",margin:"0 0 10px 0",fontSize:"1.2rem"},children:"Your Fargo rating has fallen below 499"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem"},children:"You need to choose your ladder path. This choice cannot be changed later."})]}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"20px"},children:[e.jsxs("div",{style:{flex:1,background:"rgba(0, 0, 0, 0.3)",border:"2px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"20px",cursor:o?"not-allowed":"pointer",opacity:o?.6:1,transition:"all 0.3s ease"},onClick:()=>!o&&d("stay"),onMouseOver:u=>{o||(u.currentTarget.style.borderColor="#ffc107",u.currentTarget.style.background="rgba(255, 193, 7, 0.1)")},onMouseOut:u=>{o||(u.currentTarget.style.borderColor="rgba(255, 193, 7, 0.3)",u.currentTarget.style.background="rgba(0, 0, 0, 0.3)")},children:[e.jsx("h4",{style:{color:"#ffc107",margin:"0 0 10px 0",fontSize:"1.1rem",textAlign:"center"},children:" Stay on 500+ Ladder"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsx("li",{children:"Keep your current position on the 500+ ladder"}),e.jsx("li",{children:"Work your way up through normal challenges"}),e.jsx("li",{children:"No special privileges"}),e.jsx("li",{children:"Standard 4-spot challenge range"})]})]}),e.jsxs("div",{style:{flex:1,background:"rgba(0, 0, 0, 0.3)",border:"2px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"20px",cursor:o?"not-allowed":"pointer",opacity:o?.6:1,transition:"all 0.3s ease"},onClick:()=>!o&&d("move_down"),onMouseOver:u=>{o||(u.currentTarget.style.borderColor="#10b981",u.currentTarget.style.background="rgba(16, 185, 129, 0.1)")},onMouseOut:u=>{o||(u.currentTarget.style.borderColor="rgba(16, 185, 129, 0.3)",u.currentTarget.style.background="rgba(0, 0, 0, 0.3)")},children:[e.jsx("h4",{style:{color:"#10b981",margin:"0 0 10px 0",fontSize:"1.1rem",textAlign:"center"},children:" Move Down with Fast Track"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsx("li",{children:"Start at bottom of 499 ladder"}),e.jsx("li",{children:"Get 2 fast track challenges (6 spots up)"}),e.jsx("li",{children:"4 weeks to use fast track privileges"}),e.jsx("li",{children:"Climb back up quickly if you're good enough"})]})]})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" Important: This choice cannot be changed later. Choose carefully!"})}),o&&e.jsx("div",{style:{textAlign:"center",marginBottom:"20px"},children:e.jsx("p",{style:{color:"#ffc107",fontSize:"1rem"},children:"Processing your choice..."})}),!o&&e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:t,style:{padding:"12px 24px",background:"linear-gradient(135deg, #6b7280, #4b5563)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Cancel"})})]})})},aN=y.memo(({userLadderData:n,setShowUnifiedSignup:t,setShowProfileModal:r,isAdmin:s,isProfileComplete:a,setShowPaymentDashboard:o,setShowPaymentInfo:i,userPin:l})=>{var T;const c=yn(),[d,u]=y.useState(!1),[h,p]=y.useState(null),[g,f]=y.useState(!1),[m,v]=y.useState(!1),[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState(!1),[C,N]=y.useState(null),[M,E]=y.useState(null);Te.useEffect(()=>{const A=()=>{u(!1),r(!0)};return window.addEventListener("openProfileModal",A),()=>window.removeEventListener("openProfileModal",A)},[r]),y.useEffect(()=>{n!=null&&n.email&&(n==null?void 0:n.playerId)==="ladder"&&(P(),D())},[n]);const P=async()=>{var A;if(n!=null&&n.email){f(!0);try{const k=n.email||((A=n.unifiedAccount)==null?void 0:A.email),R=await mt.getPlayerDeclineStatus(k);if(R.success){const U=R.declineStatus||R.data;p(U?{availableDeclines:U.availableDeclines??U.declinesRemaining??0,...U}:null)}else console.error("Failed to fetch decline status:",R.error),p(null)}catch(k){console.error("Error fetching decline status:",k),p(null)}finally{f(!1)}}},D=async()=>{var A;if(!(n!=null&&n.email)){console.log(" Grace Period: No email found in userLadderData");return}try{const k=n.email||((A=n.unifiedAccount)==null?void 0:A.email);console.log(" Grace Period: Fetching status for email:",k);const R=await mt.getPlayerGracePeriodStatus(k);console.log(" Grace Period: Supabase result:",R),R.success?(console.log(" Grace Period: Response data:",R.data),E(R.data)):(console.error(" Grace Period: Failed to fetch grace period status:",R.error),E(null))}catch(k){console.error(" Grace Period: Error fetching grace period status:",k),E(null)}};return e.jsxs(e.Fragment,{children:[e.jsx(KJ,{isOpen:d,onClose:()=>u(!1),userLadderData:n,isProfileComplete:a,setShowPaymentDashboard:o,setShowPaymentInfo:i}),e.jsx("div",{className:"user-status-card",children:e.jsxs("div",{className:"status-info",children:[(n==null?void 0:n.firstName)&&e.jsxs("p",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#10b981",marginBottom:"8px",marginTop:"0"},children:["Hi, ",n.firstName,"! "]}),e.jsx("h3",{children:"Your Ladder Status"}),e.jsxs("div",{className:"status-details",children:[e.jsxs("div",{className:"status-item",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",flex:"1",minWidth:"100px"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"0px",lineHeight:"1"}}),e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"2px",lineHeight:"1"},children:"Fargo Rate"}),e.jsx("span",{className:"value",style:{fontSize:"1rem",fontWeight:"bold"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":(n==null?void 0:n.fargoRate)===0?"No Rate":(n==null?void 0:n.fargoRate)||"N/A"}),(n==null?void 0:n.fargoRate)!==0&&!(n!=null&&n.needsClaim)&&(n==null?void 0:n.playerId)!=="unknown"&&e.jsx("span",{className:"label",style:{fontSize:"0.6rem",color:"#888",marginTop:"2px",lineHeight:"1"},children:n!=null&&n.fargoRateUpdatedAt?e.jsxs(e.Fragment,{children:["Updated ",(()=>{const A=new Date(n.fargoRateUpdatedAt),R=Math.abs(new Date-A),U=Math.floor(R/(1e3*60*60*24));return U===0?"today":U===1?"yesterday":U<30?`${U} days ago`:U<60?"1 month ago":`${Math.floor(U/30)} months ago`})()]}):"Not yet updated"})]}),e.jsxs("div",{className:"status-item",style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",textAlign:"center",flex:"1",minWidth:"100px",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Ladder"}),e.jsx("span",{className:"value",style:{fontSize:"1rem",fontWeight:"bold"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":(n==null?void 0:n.ladder)==="499-under"?"499":(n==null?void 0:n.ladder)==="500-549"?"500-549":(n==null?void 0:n.ladder)==="550+"?"550+":"None"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Position"}),e.jsx("span",{className:"value",style:{fontSize:"1rem",fontWeight:"bold"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":`#${(n==null?void 0:n.position)||"N/A"}`})]})]}),e.jsxs("div",{className:"status-item",style:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",textAlign:"center",flex:"1",minWidth:"100px",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Record"}),e.jsx("span",{className:"value",style:{fontSize:"1rem",fontWeight:"bold"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"#10b981"},children:(n==null?void 0:n.wins)||0}),e.jsx("span",{style:{color:"#999",padding:"0 3px"},children:"-"}),e.jsx("span",{style:{color:"#dc2626"},children:(n==null?void 0:n.losses)||0})]})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px",lineHeight:"1"},children:"Best Ever"}),e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px",lineHeight:"1"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":(()=>{const A=n==null?void 0:n.ladderProgression;return!A||!A.overallBestLadder?(n==null?void 0:n.ladder)==="499-under"?"499":(n==null?void 0:n.ladder)==="500-549"?"500-549":(n==null?void 0:n.ladder)==="550+"?"550+":"Current":A.overallBestLadder==="499-under"?"499":A.overallBestLadder==="500-549"?"500-549":A.overallBestLadder==="550-plus"?"550+":"N/A"})()}),e.jsx("span",{className:"value",style:{fontSize:"1rem",fontWeight:"bold",color:"#FFD700"},children:n!=null&&n.needsClaim||(n==null?void 0:n.playerId)==="unknown"?"N/A":(()=>{const A=n==null?void 0:n.ladderProgression;return`#${(A==null?void 0:A.overallBestPosition)||(n==null?void 0:n.highestPosition)||(n==null?void 0:n.position)||"N/A"}`})()})]})]}),!s&&(n==null?void 0:n.immunityUntil)&&e.jsxs("div",{className:"status-item immunity",children:[e.jsx("span",{className:"label",children:"Immunity Until:"}),e.jsx("span",{className:"value",children:Ss(n.immunityUntil)})]}),(n==null?void 0:n.playerId)==="ladder"&&e.jsxs("div",{className:"status-item bca-sanctioning",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"BCA Sanctioning"}),e.jsx("span",{className:"value",style:{color:n!=null&&n.sanctioned&&(n==null?void 0:n.sanctionYear)===new Date().getFullYear()?"#4CAF50":"#ffc107",cursor:"pointer",fontSize:"0.85rem",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.1"},onClick:()=>w(!0),children:n!=null&&n.sanctioned&&(n==null?void 0:n.sanctionYear)===new Date().getFullYear()?" Sanctioned":" Get Sanctioned"})]}),(n==null?void 0:n.playerId)==="ladder"&&e.jsxs("div",{className:"status-item payment-status",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:"Challenge Access"}),e.jsx("span",{className:"value",style:{color:wo().isFree?"#4CAF50":"#ffc107",cursor:"pointer",fontSize:"0.85rem",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.1"},onClick:async()=>{(await zJ(n.email)).isCurrent?alert(` Payment Current!

Your $5/month subscription is active.
You can participate in challenges and defenses.`):wo().isFree?u(!0):FJ(()=>c("/"),()=>console.log("User cancelled payment"))},children:wo().isFree?" FREE PERIOD":" Payment Required"})]}),!s&&h&&(n==null?void 0:n.playerId)==="ladder"&&e.jsxs("div",{className:"status-item decline-status",children:[e.jsx("span",{className:"label",children:"Decline Status:"}),e.jsx("span",{className:"value",style:{color:h.availableDeclines>0?"#10b981":"#dc2626",cursor:"pointer"},onClick:()=>v(!0),children:g?"Loading...":`${h.availableDeclines}/2 Available`})]}),(n==null?void 0:n.needsClaim)&&!s&&e.jsxs("div",{className:"status-item claim-notice",style:{cursor:"pointer"},onClick:()=>r(!0),onMouseOver:A=>{A.currentTarget.style.backgroundColor="rgba(255, 193, 7, 0.1)",A.currentTarget.style.transform="translateY(-1px)"},onMouseOut:A=>{A.currentTarget.style.backgroundColor="",A.currentTarget.style.transform="translateY(0)"},children:[e.jsx("span",{className:"label",children:"Profile Status:"}),e.jsx("span",{className:"value",style:{color:"#ffc107"},children:a?"Complete - Ready to receive challenges":"Incomplete - Add availability and locations to receive challenges"})]}),(n==null?void 0:n.playerId)==="unknown"&&e.jsxs("div",{className:"status-item unknown-notice",style:{cursor:"pointer"},onClick:()=>t(!0),onMouseOver:A=>{A.currentTarget.style.backgroundColor="rgba(255, 193, 7, 0.1)",A.currentTarget.style.transform="translateY(-1px)"},onMouseOut:A=>{A.currentTarget.style.backgroundColor="",A.currentTarget.style.transform="translateY(0)"},children:[e.jsx("span",{className:"label",children:"Account Status:"}),e.jsx("span",{className:"value",style:{color:"#ffc107"},children:"Not Active - Click to join ladder"})]}),e.jsx(XJ,{userLadderData:n,userPin:l,onShowFastTrackModal:()=>j(!0),onShowPlayerChoiceModal:()=>_(!0)}),(()=>(console.log(" Rendering grace period check:",{gracePeriodStatus:M,inGracePeriod:M==null?void 0:M.inGracePeriod}),M&&M.inGracePeriod&&e.jsxs("div",{className:"status-item grace-period",style:{flex:"1.4",minWidth:"180px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"8px",cursor:"pointer"},onClick:()=>j(!0),children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px",lineHeight:"1"},children:" Grace Period"}),e.jsx("span",{className:"label",style:{fontSize:"0.65rem",marginBottom:"2px",lineHeight:"1",color:"#888"},children:M.reason==="under_min"?"Under Minimum":"Over Maximum"}),e.jsxs("span",{className:"value",style:{color:M.daysRemaining<=7?"#ef4444":"#3b82f6",fontSize:"0.85rem",fontWeight:"bold"},children:[M.daysRemaining," days left"]})]})))(),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"status-item immunity",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"8px",cursor:"pointer"},onClick:()=>alert(` Immunity Explanation:

When you win a match, you get 7 days of immunity from challenges.

During this time:
 No one can challenge you
 You can still challenge others
 You can still defend in scheduled matches

This gives you a week to enjoy your victory!`),children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:" Immunity"}),e.jsx("span",{className:"value",style:{color:"#8b5cf6",fontSize:"0.85rem",fontWeight:"bold"},children:"7 days left"})]}),e.jsxs("div",{className:"status-item decline-status",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"8px",padding:"8px",cursor:"pointer"},onClick:()=>v(!0),children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:" Declines"}),e.jsx("span",{className:"value",style:{color:"#22c55e",fontSize:"0.85rem",fontWeight:"bold"},children:"2/2 Available"})]}),e.jsxs("div",{className:"status-item fast-track-status",style:{flex:"1.2",minWidth:"160px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"8px",cursor:"pointer"},onClick:()=>j(!0),children:[e.jsx("span",{className:"label",style:{fontSize:"0.7rem",marginBottom:"1px"},children:" Fast Track"}),e.jsx("span",{className:"value",style:{color:"#10b981",fontSize:"0.85rem",fontWeight:"bold"},children:"2 challenges left"})]})]})]})]})}),m&&xr.createPortal(e.jsx(It,{open:m,onClose:()=>v(!1),title:" Decline Challenge Rules",maxWidth:"650px",borderColor:"#8b5cf6",textColor:"#ffffff",glowColor:"#8b5cf6",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{padding:"15px"},children:[e.jsxs("div",{style:{background:(h==null?void 0:h.availableDeclines)>0?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:(h==null?void 0:h.availableDeclines)>0?"1px solid rgba(16, 185, 129, 0.3)":"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"12px",textAlign:"center"},children:[e.jsx("h3",{style:{color:(h==null?void 0:h.availableDeclines)>0?"#10b981":"#dc2626",margin:"0 0 6px 0",fontSize:"1.1rem"},children:(h==null?void 0:h.availableDeclines)>0?" Declines Available":" No Declines Left"}),e.jsxs("p",{style:{color:"#e0e0e0",margin:0,fontSize:"1rem"},children:[e.jsxs("strong",{children:[(h==null?void 0:h.availableDeclines)||0,"/2"]})," declines available"]}),(h==null?void 0:h.nextResetDate)&&e.jsxs("p",{style:{color:"#ccc",margin:"5px 0 0 0",fontSize:"0.85rem"},children:["Next decline resets in ",e.jsxs("strong",{children:[h.daysUntilNextReset," days"]})]})]}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"How the Decline System Works"}),e.jsx("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px"},children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",margin:0,fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Allowance:"})," Each player gets 2 declines total"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Effect:"})," When you decline a challenge, the challenger moves up one position and you move down one position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reset System:"})," Each decline resets 30 days after it was used (not all at once)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Strategic Use:"})," Use your declines wisely - they have immediate position consequences"]})]})})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"10px",marginBottom:"12px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.85rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" Important: Declining a challenge results in immediate position changes regardless of match outcome."})}),e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Example Scenarios"}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"10px",color:"#e0e0e0",fontSize:"0.85rem",lineHeight:"1.3"},children:[e.jsxs("p",{style:{margin:"0 0 6px 0"},children:[e.jsx("strong",{children:"Scenario 1:"})," You have 2 declines available. You decline a challenge. You now have 1 decline available, and that declined challenge resets in 30 days."]}),e.jsxs("p",{style:{margin:"0 0 6px 0"},children:[e.jsx("strong",{children:"Scenario 2:"})," You have 0 declines available. You must accept all challenges or face immediate position changes."]}),e.jsxs("p",{style:{margin:0},children:[e.jsx("strong",{children:"Scenario 3:"})," You used a decline 25 days ago. In 5 days, that decline will be restored and you'll have 1 more available."]})]})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:()=>v(!1),style:{padding:"10px 20px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.95rem",fontWeight:"bold"},children:"Got It!"})})]})}),document.body),b&&e.jsx(JJ,{isOpen:b,onClose:()=>w(!1),playerName:`${(n==null?void 0:n.firstName)||""} ${(n==null?void 0:n.lastName)||""}`.trim(),playerEmail:(n==null?void 0:n.email)||((T=n==null?void 0:n.unifiedAccount)==null?void 0:T.email),onSuccess:()=>{w(!1),window.location.reload()}}),e.jsx(QJ,{isOpen:x,onClose:()=>j(!1),userLadderData:n,userPin:l,fastTrackStatus:C,gracePeriodStatus:M}),e.jsx(ZJ,{isOpen:S,onClose:()=>_(!1),userLadderData:n,userPin:l,onChoiceMade:A=>{console.log("Player choice made:",A)}})]})});aN.displayName="UserStatusCard";class li extends y.Component{constructor(r){super(r);av(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,s){console.error("LadderErrorBoundary caught an error:",r),console.error("Error message:",r==null?void 0:r.message),console.error("Error stack:",r==null?void 0:r.stack),console.error("Component stack:",s==null?void 0:s.componentStack),this.setState({error:r,errorInfo:s})}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",margin:"20px",border:"2px solid #8B5CF6",borderRadius:"12px",backgroundColor:"rgba(139, 92, 246, 0.1)",color:"#8B5CF6",textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",color:"#8B5CF6"},children:" Ladder System Error"}),e.jsx("p",{style:{margin:"0 0 16px 0",color:"#666"},children:"There was an issue loading the ladder data. This won't affect other parts of the app."}),!1,e.jsx("button",{onClick:this.handleRetry,style:{background:"#8B5CF6",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",marginRight:"8px"},children:"Retry"}),e.jsx("button",{onClick:()=>window.location.reload(),style:{background:"#666",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Refresh"})]}):this.props.children}}const oN=({isOpen:n,onClose:t,challenger:r,defender:s,challengeType:a="challenge",onChallengeComplete:o})=>{const[i,l]=y.useState({entryFee:"",raceLength:"",gameType:"9-ball",tableSize:"9-foot",preferredDates:[],preferredTimes:{},postContent:"",location:"Legends Brews & Cues"}),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[p,g]=y.useState("");y.useEffect(()=>{if(s&&s.ladderName){const _={"499-under":{entryFee:20,raceLength:5},"500-549":{entryFee:25,raceLength:7},"550-plus":{entryFee:25,raceLength:7}},C=_[s.ladderName]||_["499-under"];l(N=>({...N,entryFee:C.entryFee.toString(),raceLength:C.raceLength.toString()}))}},[s]),y.useEffect(()=>{console.log(" formData updated:",i)},[i]);const f=_=>{const{name:C,value:N}=_.target;l(M=>({...M,[C]:N}))},m=()=>{try{console.log(" handleDateAdd called");const _=document.getElementById("preferredDate"),C=document.getElementById("preferredTime");if(console.log(" Input elements found:",{dateInput:!!_,timeInput:!!C}),!_||!C){console.error("Date or time input elements not found");return}const N=_.value,M=C.value||"19:00";if(console.log(" Input values:",{rawDate:N,newTime:M}),console.log(" Current formData.preferredDates:",i.preferredDates),!N){console.log("No date selected");return}const E=Yx(N),P=E?E.toISOString().split("T")[0]:N;if(console.log(" Processed date:",{rawDate:N,newDate:P}),i.preferredDates.includes(P)){console.log(" Date already exists:",P),alert("This date has already been added. Please select a different date.");return}console.log(" About to update formData with new date:",P,"at",M),l(D=>{const T={...D,preferredDates:[...D.preferredDates,P],preferredTimes:{...D.preferredTimes,[P]:M}};return console.log(" New formData after update:",T),T}),_.value="",C.value="19:00",console.log(" Date added successfully:",P,"at",M)}catch(_){console.error(" Error in handleDateAdd:",_),alert("There was an error adding the date. Please try again.")}},v=_=>{try{if(_<0||_>=i.preferredDates.length){console.error("Invalid index for date removal:",_);return}const C=i.preferredDates[_];l(N=>{const M={...N.preferredTimes};return delete M[C],{...N,preferredDates:N.preferredDates.filter((E,P)=>P!==_),preferredTimes:M}}),console.log("Date removed successfully:",C)}catch(C){console.error("Error in handleDateRemove:",C),alert("There was an error removing the date. Please try again.")}},b=(_,C)=>{try{if(!_||!C){console.error("Invalid date or time for time change:",{date:_,newTime:C});return}l(N=>({...N,preferredTimes:{...N.preferredTimes,[_]:C}})),console.log("Time changed successfully for",_,"to",C)}catch(N){console.error("Error in handleTimeChange:",N),alert("There was an error changing the time. Please try again.")}},w=_=>{var C,N;try{const M=Yx(_),E=M?M.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase():new Date(_).toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),P=((C=r.availability)==null?void 0:C[E])||[],D=((N=s.availability)==null?void 0:N[E])||[],T=P.filter(A=>D.includes(A));return{challengerTimes:P,defenderTimes:D,overlappingTimes:T}}catch(M){return console.error("Error in getAvailabilitySuggestions:",M),{challengerTimes:[],defenderTimes:[],overlappingTimes:[]}}},x=()=>{const C={challenge:"Challenge Match",smackdown:"SmackDown Match",smackback:"SmackBack Match","fast-track":"Fast Track Challenge"}[a]||"Challenge Match",N=i.preferredDates.map(E=>{const P=i.preferredTimes[E]||"19:00",D=Ss(E,{weekday:"short",month:"short",day:"numeric"}),T=new Date(`2000-01-01T${P}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${D} at ${T}`}).join(", "),M=` ${C} 

${r.firstName} ${r.lastName} (Position ${r.position}) is calling out ${s.firstName} ${s.lastName} (Position ${s.position}) for a ${C.toLowerCase()}!

 Entry Fee: $${i.entryFee}
 Race to: ${i.raceLength}
 Game: ${i.gameType}
 Table: ${i.tableSize}
 Location: ${i.location}
 Proposed Times: ${N}

${i.postContent?`
 Message: ${i.postContent}`:""}

${s.firstName}, you have 3 days to respond! `;if(a==="fast-track"){const E=s.position-r.position;return`${M}

 FAST TRACK CHALLENGE 
This is a special fast track challenge with extended range!
 Challenger can challenge up to 6 spots (normal limit is 4)
 Position difference: ${E} spots
 Winner takes defender's position, others move down one spot
 This is one of the challenger's limited fast track privileges`}return M},j=async _=>{var C;_.preventDefault(),d(!0),g("");try{const N={challengerEmail:r.email,defenderEmail:s.email,challengeType:a,entryFee:parseInt(i.entryFee),raceLength:parseInt(i.raceLength),gameType:i.gameType,tableSize:i.tableSize,preferredDates:i.preferredDates,preferredTimes:i.preferredTimes,postContent:x(),location:i.location},M=await mt.createChallenge(N);if(!M.success)throw new Error(M.error||"Failed to create challenge");try{await(await _a(()=>import("./emailNotificationService-3e5482ec.js"),[])).default.sendChallengeNotification({defenderEmail:s.email,defenderName:`${s.firstName} ${s.lastName}`,challengerName:`${r.firstName} ${r.lastName}`,challengerPosition:r.position,defenderPosition:s.position,ladderName:selectedLadder,matchType:a,entryFee:i.entryFee,raceLength:i.raceLength,gameType:i.gameType,proposedDate:i.preferredDates[0],proposedLocation:i.location,expiresAt:(C=M.data)==null?void 0:C.expires_at,message:i.message||""}),console.log(" Challenge notification email sent to defender")}catch(E){console.error("Failed to send challenge notification email:",E)}h(!0),o&&o(M.data)}catch(N){console.error("Error creating challenge:",N),g(N.message)}finally{d(!1)}},S=()=>{h(!1),t()};return n?u?e.jsx(It,{open:!0,onClose:S,title:" Challenge Sent!",maxWidth:"500px",children:e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),e.jsx("h3",{style:{color:"#ff4444",marginBottom:"16px"},children:"Challenge Successfully Sent!"}),e.jsxs("p",{style:{color:"#e0e0e0",marginBottom:"20px"},children:["Your ",a," challenge has been sent to ",s.firstName," ",s.lastName,"."]}),e.jsx("p",{style:{color:"#ccc",fontSize:"0.9rem",marginBottom:"20px"},children:"They have 3 days to respond. You'll be notified when they accept, decline, or counter-propose."}),e.jsx("button",{onClick:S,style:{background:"linear-gradient(135deg, #ff4444, #cc3333)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease"},children:"Close"})]})}):e.jsx(It,{open:!0,onClose:t,title:` ${a.charAt(0).toUpperCase()+a.slice(1)} Challenge`,maxWidth:"600px",className:"ladder-challenge-modal",borderColor:"#5b21b6",glowColor:"#5b21b6",children:e.jsxs("div",{style:{padding:"16px"},children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"6px",padding:"8px",marginBottom:"12px"},children:[e.jsxs("h3",{style:{color:"#ff4444",margin:"0 0 6px 0",textAlign:"center",fontSize:"1rem"},children:[r.firstName," ",r.lastName," vs ",s.firstName," ",s.lastName]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",color:"#e0e0e0",fontSize:"0.8rem"},children:[e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("strong",{children:"Challenger:"})," Pos ",r.position,"  ",r.ladderName]}),e.jsx("div",{style:{fontSize:"16px",color:"#ff4444",margin:"0 8px"},children:""}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("strong",{children:"Defender:"})," Pos ",s.position,"  ",s.ladderName]})]})]}),e.jsx(nN,{opponent:s,opponentLabel:`${s.firstName} ${s.lastName}`}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Match Details"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-column",children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Entry Fee ($)"}),e.jsx("input",{type:"number",name:"entryFee",value:i.entryFee,onChange:f,required:!0,min:"1",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"}})]}),e.jsxs("div",{className:"form-column",children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Race Length"}),e.jsx("select",{name:"raceLength",value:i.raceLength,onChange:f,required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"},children:Array.from({length:16},(_,C)=>C+5).map(_=>e.jsx("option",{value:_,children:_},_))})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-column",children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Game Type"}),e.jsxs("select",{name:"gameType",value:i.gameType,onChange:f,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"9-ball",children:"9-Ball"}),e.jsx("option",{value:"8-ball",children:"8-Ball"}),e.jsx("option",{value:"10-ball",children:"10-Ball"}),e.jsx("option",{value:"mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:"form-column",children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Table Size"}),e.jsxs("select",{name:"tableSize",value:i.tableSize,onChange:f,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"9-foot",children:"9-Foot"}),e.jsx("option",{value:"7-foot",children:"7-Foot"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Location"}),e.jsxs("select",{name:"location",value:i.location,onChange:f,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"Legends Brews & Cues",children:"Legends Brews & Cues"}),e.jsx("option",{value:"Antiques",children:"Antiques"}),e.jsx("option",{value:"Rac m",children:"Rac m"}),e.jsx("option",{value:"Westside Billiards",children:"Westside Billiards"}),e.jsx("option",{value:"Bijou Billiards",children:"Bijou Billiards"}),e.jsx("option",{value:"Crooked Cue",children:"Crooked Cue"}),e.jsx("option",{value:"Back on the Boulevard",children:"Back on the Boulevard"}),e.jsx("option",{value:"Main Street Tavern",children:"Main Street Tavern"}),e.jsx("option",{value:"Murray Street Darts",children:"Murray Street Darts"}),e.jsx("option",{value:"My House",children:"My House"})]})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1rem"},children:"Preferred Dates & Times"}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("input",{type:"date",id:"preferredDate",min:new Date().toISOString().split("T")[0],style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem"}}),e.jsx("input",{type:"time",id:"preferredTime",defaultValue:"19:00",style:{padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.9rem",width:"120px"}}),e.jsx("button",{type:"button",onClick:_=>{_.preventDefault(),_.stopPropagation(),m()},style:{padding:"8px 16px",background:"#ff4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",transition:"background-color 0.2s ease"},onMouseEnter:_=>_.target.style.backgroundColor="#cc3333",onMouseLeave:_=>_.target.style.backgroundColor="#ff4444",children:"Add"})]}),i.preferredDates.length>0&&e.jsxs("div",{style:{marginTop:"8px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"8px",fontSize:"0.9rem"},children:"Selected Dates & Times:"}),i.preferredDates.map((_,C)=>{const N=w(_),M=i.preferredTimes[_]||"19:00";return e.jsxs("div",{style:{padding:"12px",background:"rgba(255, 68, 68, 0.1)",borderRadius:"6px",marginBottom:"8px",border:"1px solid rgba(255, 68, 68, 0.3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("span",{style:{color:"#e0e0e0",fontSize:"0.9rem",fontWeight:"bold"},children:Ss(_,{weekday:"short",month:"short",day:"numeric"})}),e.jsx("input",{type:"time",value:M,onChange:E=>b(_,E.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",fontSize:"0.85rem",width:"100px"}})]}),e.jsx("button",{type:"button",onClick:()=>v(C),style:{background:"none",border:"none",color:"#ff4444",cursor:"pointer",fontSize:"16px",padding:"4px"},children:""})]}),N.overlappingTimes.length>0&&e.jsx("div",{style:{marginBottom:"6px"},children:e.jsxs("div",{style:{color:"#4CAF50",fontSize:"0.8rem",marginBottom:"4px"},children:[" Both available at: ",N.overlappingTimes.join(", ")]})}),e.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"0.75rem"},children:[e.jsxs("div",{style:{color:"#81C784"},children:["You: ",N.challengerTimes.length>0?N.challengerTimes.join(", "):"No availability set"]}),e.jsxs("div",{style:{color:"#FFB74D"},children:[s.firstName,": ",N.defenderTimes.length>0?N.defenderTimes.join(", "):"No availability set"]})]})]},C)})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Additional Message (Optional)"}),e.jsx("textarea",{name:"postContent",value:i.postContent,onChange:f,rows:"2",placeholder:"Add any additional message for your challenge...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical",fontSize:"0.9rem"}})]}),p&&e.jsx("div",{style:{background:"rgba(255, 0, 0, 0.1)",border:"1px solid #ff0000",borderRadius:"4px",padding:"8px",marginBottom:"12px",color:"#ff6666",fontSize:"0.9rem"},children:p}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:t,style:{padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,style:{padding:"10px 20px",background:c?"#666":"linear-gradient(135deg, #ff4444, #cc3333)",color:"white",border:"none",borderRadius:"8px",cursor:c?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:c?"Sending...":"Send Challenge"})]})]})]})}):null};const eX=({isOpen:n,onClose:t,challenge:r,currentUser:s,onCounterProposalSubmitted:a})=>{var _,C,N,M,E;const[o,i]=y.useState({entryFee:((_=r==null?void 0:r.matchDetails)==null?void 0:_.entryFee)||5,raceLength:((C=r==null?void 0:r.matchDetails)==null?void 0:C.raceLength)||5,gameType:((N=r==null?void 0:r.matchDetails)==null?void 0:N.gameType)||"8-ball",tableSize:((M=r==null?void 0:r.matchDetails)==null?void 0:M.tableSize)||"7-foot",location:((E=r==null?void 0:r.matchDetails)==null?void 0:E.location)||"Legends Brews & Cues",preferredDates:[],note:""}),[l,c]=y.useState(!1),[d,u]=y.useState(""),[h,p]=y.useState(""),g=["8-ball","9-ball","10-ball","mixed"],f=["7-foot","9-foot"],m=["Legends Brews & Cues","Shooters Pool Hall","Rack Em Up","The Break Room","Corner Pocket","Cue Club","Pool Palace","Billiards & Brews","The Rack","My House"],v=[3,5,7,9,11,13,15,17,19,21],b=(P,D)=>{i(T=>({...T,[P]:D}))},w=()=>{h&&!o.preferredDates.includes(h)&&(i(P=>({...P,preferredDates:[...P.preferredDates,h]})),p(""))},x=P=>{i(D=>({...D,preferredDates:D.preferredDates.filter(T=>T!==P)}))},j=async()=>{c(!0),u("");try{const P=await mt.counterProposeChallenge(r._id||r.id,{...o,preferredDates:o.preferredDates});if(!P.success)throw new Error(P.error||"Failed to submit counter-proposal");await S({to_email:r.challenger.email,to_name:`${r.challenger.firstName} ${r.challenger.lastName}`,from_name:`${s.firstName} ${s.lastName}`,original_challenge_type:r.challengeType,original_entry_fee:r.matchDetails.entryFee,original_race_length:r.matchDetails.raceLength,original_game_type:r.matchDetails.gameType,original_location:r.matchDetails.location,counter_entry_fee:o.entryFee,counter_race_length:o.raceLength,counter_game_type:o.gameType,counter_location:o.location,counter_dates:o.preferredDates,counter_note:o.note,challenge_id:r._id}),a&&a("counter-proposed",P),t()}catch(P){console.error("Error submitting counter-proposal:",P),u(P.message)}finally{c(!1)}},S=async P=>{try{(await fetch(`${Ie}/api/email/send-counter-proposal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)})).ok||console.error("Failed to send counter-proposal email")}catch(D){console.error("Error sending counter-proposal email:",D)}};return!n||!r?null:e.jsx(It,{open:!0,onClose:t,title:" Counter-Proposal",maxWidth:"700px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 12px 0"},children:"Original Challenge"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Entry Fee:"})," $",r.matchDetails.entryFee]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Race Length:"})," ",r.matchDetails.raceLength]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Game Type:"})," ",r.matchDetails.gameType]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",r.matchDetails.location]})]})})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"16px"},children:"Your Counter-Proposal"}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Entry Fee ($)"}),e.jsx("input",{type:"number",value:o.entryFee,onChange:P=>b("entryFee",parseInt(P.target.value)||0),min:"0",max:"50",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Race Length"}),e.jsx("select",{value:o.raceLength,onChange:P=>b("raceLength",parseInt(P.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"},children:v.map(P=>e.jsxs("option",{value:P,children:["Race to ",P]},P))})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Game Type"}),e.jsx("select",{value:o.gameType,onChange:P=>b("gameType",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"},children:g.map(P=>e.jsx("option",{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Table Size"}),e.jsx("select",{value:o.tableSize,onChange:P=>b("tableSize",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"},children:f.map(P=>e.jsx("option",{value:P,children:P},P))})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Location"}),e.jsx("select",{value:o.location,onChange:P=>b("location",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"},children:m.map(P=>e.jsx("option",{value:P,children:P},P))})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Preferred Dates"}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("input",{type:"date",value:h,onChange:P=>p(P.target.value),min:Hb(),style:{flex:1,padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}}),e.jsx("button",{type:"button",onClick:w,disabled:!h,style:{padding:"8px 16px",background:h?"#10b981":"#666",color:"white",border:"none",borderRadius:"4px",cursor:h?"pointer":"not-allowed"},children:"Add"})]}),o.preferredDates.length>0&&e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"4px",padding:"8px",maxHeight:"120px",overflowY:"auto"},children:o.preferredDates.map((P,D)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:D<o.preferredDates.length-1?"1px solid #444":"none"},children:[e.jsx("span",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:Ss(P,{weekday:"short",month:"short",day:"numeric"})}),e.jsx("button",{type:"button",onClick:()=>x(P),style:{background:"#dc2626",color:"white",border:"none",borderRadius:"3px",padding:"2px 6px",cursor:"pointer",fontSize:"0.8rem"},children:"Remove"})]},D))})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Counter-Proposal Note"}),e.jsx("textarea",{value:o.note,onChange:P=>b("note",P.target.value),rows:"3",placeholder:"Explain your counter-proposal...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical"}})]})]}),d&&e.jsx("div",{style:{background:"rgba(255, 0, 0, 0.1)",border:"1px solid #ff0000",borderRadius:"4px",padding:"8px",marginBottom:"16px",color:"#ff6666"},children:d}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:t,disabled:l,style:{padding:"12px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Cancel"}),e.jsx("button",{onClick:j,disabled:l||o.preferredDates.length===0,style:{padding:"12px 24px",background:l||o.preferredDates.length===0?"#666":"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",cursor:l||o.preferredDates.length===0?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:l?"Submitting...":o.preferredDates.length===0?"Add Dates First":"Submit Counter-Proposal"})]})]})})};const tX=({isOpen:n,onClose:t,challenge:r,currentUser:s,onChallengeResponse:a})=>{const[o,i]=y.useState(""),[l,c]=y.useState(!1),[d,u]=y.useState(""),[h,p]=y.useState(!1),[g,f]=y.useState(""),[m,v]=y.useState(null),[b,w]=y.useState(!1);y.useEffect(()=>{n&&s&&x()},[n,s]);const x=async()=>{var E;w(!0);try{const P=s.email||((E=s.unifiedAccount)==null?void 0:E.email);console.log(" Fetching decline status from Supabase for:",P);const D=await mt.getPlayerDeclineStatus(P);D.success?(console.log(" Decline status from Supabase:",D.declineStatus),v(D.declineStatus)):(console.error("Failed to fetch decline status:",D.error),v(null))}catch(P){console.error("Error fetching decline status:",P),v(null)}finally{w(!1)}},j=async()=>{c(!0),u("");try{const E=await mt.acceptChallenge(r._id||r.id,{note:o,selectedDate:g});if(!E.success)throw new Error(E.error||"Failed to accept challenge");await C({to_email:r.challenger.email,to_name:`${r.challenger.firstName} ${r.challenger.lastName}`,from_name:`${s.firstName} ${s.lastName}`,challenge_type:r.challengeType,entry_fee:r.matchDetails.entryFee,race_length:r.matchDetails.raceLength,game_type:r.matchDetails.gameType,location:r.matchDetails.location,note:o,challenge_id:r._id,match_date:g}),a&&a("accepted",E),t()}catch(E){console.error("Error accepting challenge:",E),u(E.message)}finally{c(!1)}},S=async()=>{var E;c(!0),u("");try{const P=await mt.declineChallenge(r._id||r.id,{note:o,defenderEmail:s.email||((E=s.unifiedAccount)==null?void 0:E.email)});if(!P.success)throw new Error(P.error||"Failed to decline challenge");try{await(await _a(()=>import("./emailNotificationService-3e5482ec.js"),[])).default.sendChallengeDeclined({challengerEmail:r.challenger.email,challengerName:`${r.challenger.firstName} ${r.challenger.lastName}`,defenderName:`${s.firstName} ${s.lastName}`,challengerPosition:r.challenger.position,defenderPosition:r.defender.position,ladderName:r.defender.ladderName,declineReason:o||"No reason provided"}),console.log(" Challenge declined email sent to challenger")}catch(D){console.error("Failed to send decline email:",D)}a&&a("declined",P),await x(),t()}catch(P){console.error("Error declining challenge:",P),u(P.message)}finally{c(!1)}},_=()=>{p(!0)},C=async E=>{try{(await fetch(`${Ie}/api/email/send-challenge-confirmation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)})).ok||console.error("Failed to send confirmation email")}catch(P){console.error("Error sending confirmation email:",P)}},N=E=>({challenge:"Challenge Match",smackdown:"SmackDown Match",smackback:"SmackBack Match","fast-track":"Fast Track Challenge"})[E]||E,M=()=>r.challengeType==="challenge"?"If you win: Positions remain unchanged. If challenger wins: You switch positions.":r.challengeType==="smackdown"?"If challenger wins: You move 3 spots down, challenger moves 2 spots up. If you win: You switch positions.":r.challengeType==="smackback"?"If challenger wins: They move to 1st place, all others move down. If you win: Positions remain unchanged.":r.challengeType==="fast-track"?"If challenger wins: They take your position, you move to their old spot, others between move down one. If you win: Positions remain unchanged.":"";return!n||!r?null:e.jsxs(It,{open:!0,onClose:t,title:` ${N(r.challengeType)}`,maxWidth:"600px",children:[e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#ff4444",margin:"0 0 12px 0",textAlign:"center"},children:[r.challenger.firstName," ",r.challenger.lastName," vs ",r.defender.firstName," ",r.defender.lastName]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",color:"#e0e0e0"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Challenger:"}),e.jsx("br",{}),"Position ",r.challenger.position,e.jsx("br",{}),r.challenger.ladderName]}),e.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),e.jsxs("div",{children:[e.jsx("strong",{children:"Defender:"}),e.jsx("br",{}),"Position ",r.defender.position,e.jsx("br",{}),r.defender.ladderName]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px"},children:"Match Details"}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"16px",color:"#e0e0e0"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Entry Fee:"})," $",r.matchDetails.entryFee]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Race Length:"})," ",r.matchDetails.raceLength]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Game Type:"})," ",r.matchDetails.gameType]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Table Size:"})," ",r.matchDetails.tableSize]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",r.matchDetails.location]})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px",marginTop:"12px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#10b981",fontWeight:"bold",marginBottom:"4px"},children:" Match Fee Information"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:["The ",e.jsx("strong",{children:"winner"})," reports the match and pays the ",e.jsx("strong",{children:"$5 match fee"}),".",e.jsx("br",{}),e.jsx("em",{children:"Only one $5 fee per match - not per player!"})]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px"},children:"Position Changes"}),e.jsx("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.4"},children:M()})]}),m&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px"},children:"Decline Status"}),e.jsxs("div",{style:{background:m.availableDeclines>0?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:m.availableDeclines>0?"1px solid rgba(16, 185, 129, 0.3)":"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.4"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Available Declines:"})," ",m.availableDeclines,"/2"]}),e.jsx("span",{style:{color:m.availableDeclines>0?"#10b981":"#dc2626",fontWeight:"bold"},children:m.availableDeclines>0?" Can Decline":" No Declines Left"})]}),m.availableDeclines===0&&e.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.2)",border:"1px solid rgba(220, 38, 38, 0.4)",borderRadius:"4px",padding:"8px",marginTop:"8px",color:"#fca5a5",fontSize:"0.85rem"},children:[" ",e.jsx("strong",{children:"Warning:"})," You have no declines remaining. If you decline this challenge, the challenger will move up one position and you will move down one position.",m.nextResetDate&&e.jsxs("div",{style:{marginTop:"4px"},children:["Next decline resets in ",m.daysUntilNextReset," days."]})]}),m.availableDeclines>0&&e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.4)",borderRadius:"4px",padding:"8px",marginTop:"8px",color:"#6ee7b7",fontSize:"0.85rem"},children:[" ",e.jsx("strong",{children:"Decline Effect:"})," If you decline this challenge, the challenger will move up one position and you will move down one position."]})]})]}),r.challengePost.postContent&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px"},children:"Challenge Message"}),e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"12px",color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.4",whiteSpace:"pre-line"},children:r.challengePost.postContent})]}),r.matchDetails.preferredDates&&r.matchDetails.preferredDates.length>0&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px"},children:"Select Match Date"}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"12px",color:"#e0e0e0"},children:[e.jsx("p",{style:{marginBottom:"12px",fontSize:"0.9rem",color:"#ccc"},children:"Choose from the challenger's preferred dates:"}),r.matchDetails.preferredDates.map((E,P)=>e.jsxs("label",{style:{display:"block",marginBottom:"8px",cursor:"pointer",padding:"8px",borderRadius:"4px",background:g===E?"rgba(16, 185, 129, 0.2)":"transparent",border:g===E?"1px solid #10b981":"1px solid transparent",transition:"all 0.2s ease"},children:[e.jsx("input",{type:"radio",name:"selectedDate",value:E,checked:g===E,onChange:D=>f(D.target.value),style:{marginRight:"8px"}}),Ss(E,{weekday:"long",year:"numeric",month:"long",day:"numeric"})]},P)),g&&e.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"4px",color:"#10b981",fontSize:"0.9rem"},children:[" Match scheduled for: ",Ss(g,{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Your Response Note (Optional)"}),e.jsx("textarea",{value:o,onChange:E=>i(E.target.value),rows:"3",placeholder:"Add a note to your response...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical"}})]}),d&&e.jsx("div",{style:{background:"rgba(255, 0, 0, 0.1)",border:"1px solid #ff0000",borderRadius:"4px",padding:"8px",marginBottom:"16px",color:"#ff6666"},children:d}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"space-between"},children:[e.jsx("button",{onClick:S,disabled:l||b||m&&m.availableDeclines===0,style:{padding:"12px 24px",background:l||b||m&&m.availableDeclines===0?"#666":"#dc2626",color:"white",border:"none",borderRadius:"8px",cursor:l||b||m&&m.availableDeclines===0?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:l?"Processing...":b?"Loading...":m&&m.availableDeclines===0?"No Declines Left":"Decline"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:_,disabled:l,style:{padding:"12px 24px",background:l?"#666":"#f59e0b",color:"white",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Counter"}),e.jsx("button",{onClick:j,disabled:l||r.matchDetails.preferredDates&&r.matchDetails.preferredDates.length>0&&!g,style:{padding:"12px 24px",background:l||r.matchDetails.preferredDates&&r.matchDetails.preferredDates.length>0&&!g?"#666":"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",cursor:l||r.matchDetails.preferredDates&&r.matchDetails.preferredDates.length>0&&!g?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:l?"Processing...":r.matchDetails.preferredDates&&r.matchDetails.preferredDates.length>0&&!g?"Select Date First":"Accept"})]})]}),e.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"4px",color:"#ffc107",fontSize:"0.9rem",textAlign:"center"},children:[" This challenge expires on ",Ss(r.deadline)]})]}),e.jsx(eX,{isOpen:h,onClose:()=>p(!1),challenge:r,currentUser:s,onCounterProposalSubmitted:a})]})};const rX=({isOpen:n,onClose:t,challenger:r,availableDefenders:s=[],ladderData:a=[],onChallengeComplete:o,userPin:i})=>{const[l,c]=y.useState([]),[d,u]=y.useState(!1),[h,p]=y.useState(null),[g,f]=y.useState(!1),[m,v]=y.useState("challenge"),[b,w]=y.useState(null),[x,j]=y.useState(!1),[S,_]=y.useState(!1),[C,N]=y.useState(""),[M,E]=y.useState([]),[P,D]=y.useState(null),[T,A]=y.useState(!1),[k,R]=y.useState(!1),[U,z]=y.useState(null),[$,W]=y.useState(!1);y.useEffect(()=>{console.log(" Smart Match Modal useEffect triggered:",{isOpen:n,challenger:r?"Present":"Missing",availableDefendersCount:s.length,availableDefenders:s}),n&&r&&s.length>0?Y():n&&r&&s.length===0&&(console.warn(" Smart Match: No available defenders found!"),console.log("Available defenders array:",s))},[n,r,s]);const Y=async()=>{u(!0),c([]);try{await new Promise(X=>setTimeout(X,1e3));const I=O(r,s);c(I)}catch(I){console.error("Error generating suggestions:",I)}finally{u(!1)}},Q=(I,X)=>{const fe=I.availability||{},ne=X.availability||{};if(Object.keys(fe).length===0||Object.keys(ne).length===0)return{score:.5,reason:"No availability data",details:"No availability information available"};const ye=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],ot=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];let lt=0,tt=0,ge=[];ye.forEach((Pe,Ve)=>{if(fe[Pe]&&ne[Pe]){tt++;const we=fe[Pe],Re=ne[Pe];if(Array.isArray(we)&&Array.isArray(Re)){const it=we.filter(rt=>Re.includes(rt));it.length>0&&(lt++,ge.push(`${ot[Ve]}: ${it.join(", ")}`))}}});const xt=tt>0?lt/tt:.5,ht=tt>0?`${lt}/${tt} days with matching availability`:"No availability overlap",Je=ge.length>0?ge.join("; "):"No overlapping free time found";return{score:xt,reason:ht,details:Je}},H=(I,X)=>{const fe=I.locations||"",ne=X.locations||"";if(!fe||!ne)return{score:.5,reason:"No location preferences",details:"No location preferences set"};const ye=fe.toLowerCase().split(/[,;|]/).map(Je=>Je.trim()),ot=ne.toLowerCase().split(/[,;|]/).map(Je=>Je.trim()),lt=ye.filter(Je=>ot.some(Pe=>Pe.includes(Je)||Je.includes(Pe))),tt=lt.map(Je=>{const Pe=ye.find(we=>we.toLowerCase()===Je.toLowerCase()),Ve=ot.find(we=>we.toLowerCase()===Je.toLowerCase());return Pe||Ve||Je}),ge=lt.length>0?Math.min(1,lt.length/Math.max(ye.length,ot.length)):.2,xt=lt.length>0?`Both prefer: ${tt.join(", ")}`:"No location preferences match",ht=tt.length>0?tt.join(", "):"No common pool halls found";return{score:ge,reason:xt,details:ht}},ue=(I,X)=>{const fe=new Date,ne=new Date(fe.getTime()+7*24*60*60*1e3),ye=I.scheduledMatches||[],ot=X.scheduledMatches||[],lt=ye.some(ge=>{const xt=new Date(ge.scheduledDate);return xt>=fe&&xt<=ne}),tt=ot.some(ge=>{const xt=new Date(ge.scheduledDate);return xt>=fe&&xt<=ne});return lt&&tt?{score:.3,reason:"Both players have scheduled matches this week"}:lt||tt?{score:.6,reason:"One player has scheduled matches this week"}:{score:1,reason:"No schedule conflicts"}},J=I=>{try{const fe=JSON.parse(localStorage.getItem("smartMatchLearning")||"[]").filter(tt=>tt.challengerId===I||tt.defenderId===I);if(fe.length===0)return{};const ne={preferredMatchTypes:{},preferredTimeSlots:{},responseRate:0,averageConfidence:0,successRate:0};fe.forEach(tt=>{(tt.outcome==="accepted"||tt.outcome==="played")&&(ne.preferredMatchTypes[tt.matchType]=(ne.preferredMatchTypes[tt.matchType]||0)+1)});const ye=fe.length,ot=fe.filter(tt=>tt.outcome!=="no_response").length;ne.responseRate=ye>0?ot/ye:0;const lt=fe.filter(tt=>tt.outcome==="accepted"||tt.outcome==="played");return ne.averageConfidence=lt.length>0?lt.reduce((tt,ge)=>tt+ge.confidence,0)/lt.length:0,ne.successRate=ye>0?lt.length/ye:0,ne}catch(X){return console.error("Error getting learned preferences:",X),{}}},be=async(I,X)=>{var fe,ne;try{console.log(" Fetching head-to-head record:",{challenger:I,defender:X});let ye=I._id||I.id||I.playerId;if(!ye||ye==="ladder"||!ye.match(/^[0-9a-fA-F]{24}$/)){const Re=a.find(it=>it.firstName===I.firstName&&it.lastName===I.lastName);Re&&(ye=Re._id,console.log(" Found challenger in ladder data:",ye))}const ot=X._id||X.id||X.playerId;if(console.log(" Using IDs:",{challengerId:ye,defenderId:ot}),console.log(" Challenger object keys:",Object.keys(I)),console.log(" Defender object keys:",Object.keys(X)),!ye)return console.log(" Missing challenger ID for head-to-head lookup"),{wins:0,losses:0,totalMatches:0,lastMatch:null};if(!ot)return console.log(" Missing defender ID for head-to-head lookup"),{wins:0,losses:0,totalMatches:0,lastMatch:null};const[lt,tt]=await Promise.all([mt.getPlayerMatchHistory(I.email||((fe=I.unifiedAccount)==null?void 0:fe.email),10),mt.getPlayerMatchHistory(X.email||((ne=X.unifiedAccount)==null?void 0:ne.email),10)]),ge=lt.success?lt.data:[],xt=tt.success?tt.data:[];console.log(" Challenger matches:",ge.length),console.log(" Defender matches:",xt.length);const ht=[];if(ge.forEach(Re=>{if(Re.result){const it=Re.opponentName===`${X.firstName} ${X.lastName}`;console.log(" Checking challenger match:",{matchId:Re._id,opponentName:Re.opponentName,defenderName:`${X.firstName} ${X.lastName}`,isAgainstDefender:it}),it&&(ht.push(Re),console.log(" Found head-to-head match in challenger data"))}}),xt.forEach(Re=>{if(Re.result){const it=Re.opponentName===`${I.firstName} ${I.lastName}`;console.log(" Checking defender match:",{matchId:Re._id,opponentName:Re.opponentName,challengerName:`${I.firstName} ${I.lastName}`,isAgainstChallenger:it}),it&&(ht.find(rt=>rt._id===Re._id)||(ht.push(Re),console.log(" Found head-to-head match in defender data")))}}),console.log(" Head-to-head matches found:",ht.length),ht.length===0)return{wins:0,losses:0,totalMatches:0,lastMatch:null};let Je=0,Pe=0,Ve=null;ht.sort((Re,it)=>new Date(it.completedDate||it.scheduledDate)-new Date(Re.completedDate||Re.scheduledDate)),ht.forEach(Re=>{if((Re.playerRole==="challenger"||Re.playerRole==="defender")&&(Re.result==="W"?Je++:Re.result==="L"&&Pe++),!Ve){let rt=Re.matchDate||Re.completedDate||Re.scheduledDate||Re.date||Re.createdAt;if(rt)try{const yt=new Date(rt);isNaN(yt.getTime())?rt="Match completed":rt=Ss(yt)}catch{rt="Match completed"}else rt="Match completed";Ve={date:rt,winner:Re.result==="W"?`${I.firstName} ${I.lastName}`:Re.opponentName,loser:Re.result==="W"?Re.opponentName:`${I.firstName} ${I.lastName}`,score:Re.score||"N/A"}}});const we={wins:Je,losses:Pe,totalMatches:Je+Pe,lastMatch:Ve};return console.log(" Calculated head-to-head record:",we),we}catch(ye){return console.error(" Error getting head-to-head record:",ye),console.error(" Error details:",ye.message),{wins:0,losses:0,totalMatches:0,lastMatch:null}}},Ae=(I,X,fe)=>{const ne=fe.confidence,ye=J(I._id||I.email),ot=J(X._id||X.email);let lt=0;return ye.preferredMatchTypes&&ye.preferredMatchTypes[fe.type]&&(lt+=5),ot.responseRate>.7?lt+=8:ot.responseRate>.5&&(lt+=4),ot.successRate>.8?lt+=6:ot.successRate>.6&&(lt+=3),ot.responseRate<.3&&(lt-=10),Math.min(Math.max(ne+lt,10),95)},O=(I,X)=>{const fe=[],ne=new Map,ye=I.ladder||I.ladderName,ot=X.filter(Pe=>Pe.ladderName===ye);ot.filter(Pe=>Pe.position<I.position&&Pe.position>=I.position-4).forEach(Pe=>{const Ve=Q(I,Pe),we=H(I,Pe),Re=ue(I,Pe),it=oe(I,Pe),rt=Math.min(1,it*.2+Ve.score*.5+we.score*.25+Re.score*.05),yt={defender:Pe,type:"challenge",confidence:rt,availabilityScore:Ve.score,locationScore:we.score,scheduleScore:Re.score,positionDiff:I.position-Pe.position},kt=Ae(I,Pe,yt),Ct=I.position-Pe.position;let te=`Challenge Match: ${Pe.firstName} is ${Ct} spot${Ct>1?"s":""} above you`;Ct===1?te+=" - Perfect for a quick climb!":Ct===2?te+=" - Great opportunity to advance":Ct>=3&&(te+=" - High reward challenge"),Ve.score>.7&&(te+=` |  ${Ve.reason}`),we.score>.7&&(te+=` |  ${we.reason}`),Re.score<.5&&(te+=` |  ${Re.reason}`);const ke=`${Pe.firstName}-${Pe.lastName}`;ne.has(ke)||ne.set(ke,{defender:Pe,matchTypes:[],availabilityScore:Ve.score,locationScore:we.score,scheduleScore:Re.score,availabilityDetails:Ve.details,locationDetails:we.details}),ne.get(ke).matchTypes.push({type:"challenge",confidence:kt,reason:te,priority:1,positionDiff:Ct,learnedBonus:kt-rt})});const tt=I.fastTrackChallengesRemaining>0&&I.fastTrackExpirationDate&&new Date<new Date(I.fastTrackExpirationDate),ge=I.reverseFastTrackChallengesRemaining>0&&I.reverseFastTrackExpirationDate&&new Date<new Date(I.reverseFastTrackExpirationDate);(tt||ge)&&ot.filter(Ve=>Ve.position<I.position&&Ve.position>=I.position-6).forEach(Ve=>{const we=Q(I,Ve),Re=H(I,Ve),it=ue(I,Ve),rt=oe(I,Ve),yt=Math.min(1,rt*.2+we.score*.5+Re.score*.25+it.score*.05),kt=I.position-Ve.position,Ct="fast-track",te="Fast Track",ke=I.fastTrackChallengesRemaining;let We=`${te} Challenge: ${Ve.firstName} is ${kt} spot${kt>1?"s":""} above you (Extended Range!)`;We+=` | ${ke} Fast Track challenges remaining`,kt>4?We+=" - Extended range opportunity!":kt>=3&&(We+=" - Great Fast Track target"),we.score>.7&&(We+=` |  ${we.reason}`),Re.score>.7&&(We+=` |  ${Re.reason}`),it.score<.5&&(We+=` |  ${it.reason}`);const Fe=`${Ve.firstName}-${Ve.lastName}`;ne.has(Fe)||ne.set(Fe,{defender:Ve,matchTypes:[],availabilityScore:we.score,locationScore:Re.score,scheduleScore:it.score,availabilityDetails:we.details,locationDetails:Re.details}),ne.get(Fe).matchTypes.push({type:Ct,confidence:yt,reason:We,priority:0,positionDiff:kt,learnedBonus:0})}),ot.filter(Pe=>Pe.position>I.position&&Pe.position<=I.position+5).forEach(Pe=>{const Ve=Q(I,Pe),we=H(I,Pe),Re=ue(I,Pe),it=oe(I,Pe),rt=Math.min(1,it*.2+Ve.score*.5+we.score*.25+Re.score*.05),yt=Pe.position-I.position;let kt=`SmackDown Match: ${Pe.firstName} is ${yt} spot${yt>1?"s":""} below you`;yt===1?kt+=" - Defend your position":yt<=3?kt+=" - Maintain your ranking":kt+=" - Show your dominance",Ve.score>.7&&(kt+=` |  ${Ve.reason}`),we.score>.7&&(kt+=` |  ${we.reason}`),Re.score<.5&&(kt+=` |  ${Re.reason}`);const Ct=`${Pe.firstName}-${Pe.lastName}`;ne.has(Ct)||ne.set(Ct,{defender:Pe,matchTypes:[],availabilityScore:Ve.score,locationScore:we.score,scheduleScore:Re.score,availabilityDetails:Ve.details,locationDetails:we.details}),ne.get(Ct).matchTypes.push({type:"smackdown",confidence:rt,reason:kt,priority:2,positionDiff:yt})}),I.ladderName==="499-under"&&I.position<=3&&X.filter(Ve=>["500-549","550-plus"].includes(Ve.ladderName)).slice(-4).forEach(Ve=>{const we=oe(I,Ve),Re=`Ladder Jump: ${Ve.firstName} is in ${Ve.ladderName} ladder - Big opportunity to advance!`;fe.push({defender:Ve,type:"ladder-jump",confidence:we,reason:Re,priority:3})}),ot.filter(Pe=>{const Ve=Q(I,Pe),we=H(I,Pe),Re=ue(I,Pe);return Ve.score>=.7&&we.score>=.6&&Re.score>=.8}).forEach(Pe=>{const Ve=Q(I,Pe),we=H(I,Pe),Re=ue(I,Pe),it=Math.abs(I.position-Pe.position);I.position>Pe.position;const rt=.9,yt=`Perfect Match: ${Pe.firstName} - Great availability & location compatibility! |  ${Ve.reason} |  ${we.reason}`;fe.push({defender:Pe,type:"perfect-match",confidence:rt,reason:yt,priority:0,positionDiff:it,availabilityScore:Ve.score,locationScore:we.score,scheduleScore:Re.score,availabilityDetails:Ve.details,locationDetails:we.details})});const Je=Array.from(ne.values()).map(Pe=>{const Ve=Pe.matchTypes.sort((Re,it)=>Re.priority!==it.priority?Re.priority-it.priority:it.confidence-Re.confidence),we=Ve[0];return{defender:Pe.defender,type:we.type,confidence:we.confidence,reason:we.reason,priority:we.priority,positionDiff:we.positionDiff,availabilityScore:Pe.availabilityScore,locationScore:Pe.locationScore,scheduleScore:Pe.scheduleScore,availabilityDetails:Pe.availabilityDetails,locationDetails:Pe.locationDetails,allMatchTypes:Ve,learnedBonus:we.learnedBonus||0}}).sort((Pe,Ve)=>Pe.priority!==Ve.priority?Pe.priority-Ve.priority:Ve.confidence-Pe.confidence).slice(0,10);return console.log("Final suggestions:",Je.length),console.log("Final suggestions:",Je),Je},oe=(I,X,fe)=>{let ne=50;const ye=Math.abs(I.position-X.position);if(ye===1?ne+=25:ye===2?ne+=20:ye===3?ne+=15:ye<=5?ne+=10:ye<=8&&(ne+=5),X.recentMatches&&X.recentMatches.length>0){const lt=new Date(X.recentMatches[0].date),tt=(new Date-lt)/(1e3*60*60*24);tt<=1?ne+=20:tt<=3?ne+=18:tt<=7?ne+=15:tt<=14?ne+=12:tt<=30?ne+=8:tt<=60?ne+=3:ne-=5}else ne-=10;if(X.wins&&X.totalMatches){const lt=X.wins/X.totalMatches,tt=X.totalMatches;tt>=10?lt>=.7?ne+=15:lt>=.6?ne+=12:lt>=.5?ne+=8:lt>=.4?ne+=3:ne-=5:tt>=5?lt>=.6?ne+=10:lt>=.4?ne+=5:ne-=2:ne+=5}if(I.ladderName===X.ladderName&&(ne+=5),X.totalMatches&&(X.totalMatches>=20?ne+=3:X.totalMatches>=10?ne+=2:X.totalMatches>=5&&(ne+=1)),X.recentMatches&&X.recentMatches.length>=3){const lt=X.recentMatches.slice(0,3).filter(tt=>tt.winner===X.email||tt.winner===X.firstName).length;lt>=2?ne+=8:lt===1?ne+=3:ne-=5}const ot=new Date().getHours();return ot>=18&&ot<=22?ne+=3:ot>=12&&ot<=17&&(ne+=2),Math.min(Math.max(ne,10),95)},me=I=>{p(I.defender),v(I.type),f(!0)},Ce=async(I,X)=>{X.stopPropagation(),w(I),j(!0),A(!0);try{const fe=await be(r,I.defender);D(fe)}catch(fe){console.error("Error loading head-to-head record:",fe),D({wins:0,losses:0,totalMatches:0,lastMatch:null})}finally{A(!1)}},ve=(I,X)=>{X.stopPropagation(),console.log(" Match type clicked:",I),console.log(" Setting selectedMatchType to:",I),console.log(" Setting showMatchTypeModal to true"),z(I),R(!0),console.log(" Modal state should be updated now")},De=I=>{p(I.defender),v(I.type),f(!0)},Oe=I=>{j(!1),p(I.defender),v(I.type),f(!0)},Ze=()=>{if(!C.trim())return;const I=C.toLowerCase().trim();let X=[...l];I.includes("challenge")||I.includes("above")?X=l.filter(fe=>fe.type==="challenge"):I.includes("smackdown")||I.includes("below")?X=l.filter(fe=>fe.type==="smackdown"):I.includes("perfect match")||I.includes("perfect")?X=l.filter(fe=>fe.type==="perfect-match"):(I.includes("fast track")||I.includes("fasttrack"))&&(X=l.filter(fe=>fe.type==="fast-track")),I.includes("1 position")||I.includes("one position")?X=X.filter(fe=>fe.positionDiff===1):I.includes("2 position")||I.includes("two position")?X=X.filter(fe=>fe.positionDiff===2):(I.includes("3 position")||I.includes("three position"))&&(X=X.filter(fe=>fe.positionDiff===3)),I.includes("tonight")||I.includes("evening")?X=X.filter(fe=>fe.availabilityScore>.6):(I.includes("weekend")||I.includes("saturday")||I.includes("sunday"))&&(X=X.filter(fe=>fe.availabilityScore>.5)),(I.includes("available")||I.includes("free"))&&(X=X.filter(fe=>fe.availabilityScore>.7&&fe.scheduleScore>.7)),(I.includes("location")||I.includes("nearby")||I.includes("close"))&&(X=X.filter(fe=>fe.locationScore>.6)),X.sort((fe,ne)=>ne.confidence-fe.confidence),E(X),N(""),console.log(" AI Query processed:",{query:I,results:X.length})},et=()=>{c([]),p(null),f(!1),t()},re=I=>I>=80?"#10b981":I>=60?"#3b82f6":I>=40?"#f59e0b":"#6b7280",je=I=>I>=80?"Easy Smart Match":I>=60?"Possible Smart Match":I>=40?"Unlikely Smart Match":"Very Unlikely Smart Match",V=I=>({challenge:"",smackdown:"","ladder-jump":"",smackback:"","fast-track":""})[I]||"",Ee=I=>({challenge:" Challenge Match",smackdown:" SmackDown Match","ladder-jump":" Ladder Jump",smackback:" SmackBack Match","fast-track":" Fast Track Challenge"})[I]||I,F=I=>{if(!I.recentMatches||I.recentMatches.length===0)return!1;let X=0;for(let fe=0;fe<I.recentMatches.length&&I.recentMatches[fe].result==="win";fe++)if(X++,X>=3)return!0;return!1},ae=I=>({challenge:{title:"Challenge Match",description:"A standard ladder challenge where you challenge a player above you on the ladder. Win to move up in position!",rules:["Players can challenge opponents up to 4 spots above them","Challenger wins: Players switch positions","Defender wins: Ladder positions remain unchanged","Must be accepted when called out"]},smackdown:{title:"SmackDown Match",description:"An intense match with special rules and higher stakes. The challenger pays full entry fee, defender pays 50%.",rules:['Any player can call out a "SmackDown"',"Player calls out an opponent no more than 5 spots below them","The Challenger pays the full entry fee; the Defender pays 50% of the entry fee","If Challenger Wins: Opponent moves THREE spots down, challenger moves TWO spots up (but not into first place)","If Challenger Loses: Players switch positions","First place must be earned via a Challenge Match or SmackBack match"]},"ladder-jump":{title:"Ladder Jump",description:"Challenge a player much higher on the ladder to jump multiple positions at once. High risk, high reward! (Currently not available in UI)",rules:["Challenge players significantly above your current position","Win to jump multiple positions at once","Lose and you stay in your current position","Requires mutual agreement on the jump distance","Must be accepted when called out","Note: This feature is not yet available in the user interface"]},smackback:{title:"SmackBack Match",description:"A special match where a SmackDown defender can challenge for 1st place in their next match.",rules:["If the SmackDown defender wins, they can challenge for 1st place in their next match with a SmackBack","The Challenger pays the full entry fee; the Defender pays 50% of the entry fee","If Challenger Wins: Moves into 1st place, all other positions move down one spot","If Defender Wins: Ladder positions remain unchanged"]},"fast-track":{title:"Fast Track Challenge",description:"Special challenge for players who moved down to 499-under ladder with Fast Track privileges.",rules:["Can challenge up to 6 spots above (normal limit is 4)","Winner takes defender's position, others move down one spot","Limited to 2 challenges within 4 weeks","Must be on same ladder for Fast Track challenges"]}})[I]||{title:"Unknown Match Type",description:"This match type is not recognized.",rules:["Contact an administrator for more information."]};return n?xr.createPortal(e.jsxs(e.Fragment,{children:[e.jsx(It,{open:!0,onClose:et,title:` Smart Match: ${r.firstName} ${r.lastName}`,maxWidth:"1200px",maxHeight:"80vh",className:"ladder-smart-match-modal",borderColor:"#5b21b6",glowColor:"#5b21b6",children:e.jsxs("div",{className:"ladder-smart-match-content",children:[e.jsxs("div",{className:"ladder-smart-match-header",children:[e.jsxs("div",{className:"ladder-smart-match-header-left",children:[e.jsx("h3",{className:"ladder-smart-match-title",children:"Smart Match Suggestions"}),e.jsx("p",{className:"ladder-smart-match-subtitle",children:"AI suggestions based on ladder rules, activity & history"})]}),e.jsx("button",{className:"ladder-smart-match-ai-btn",onClick:()=>_(!0),children:" Ask AI"})]}),d&&e.jsxs("div",{className:"ladder-smart-match-loading",children:[e.jsx("div",{className:"ladder-smart-match-spinner"}),e.jsx("p",{className:"ladder-smart-match-loading-text",children:"Analyzing ladder data and generating suggestions..."})]}),!d&&l.length===0&&e.jsxs("div",{className:"ladder-smart-match-empty",children:[e.jsx("div",{className:"ladder-smart-match-empty-icon",children:""}),e.jsx("h3",{className:"ladder-smart-match-empty-title",children:"No Suggestions Available"}),e.jsx("p",{className:"ladder-smart-match-empty-message",children:s.length===0?e.jsxs(e.Fragment,{children:["No opponents found on this ladder.",e.jsx("br",{}),e.jsx("small",{style:{color:"#9ca3af",fontSize:"0.9rem"},children:"This could mean the ladder data hasn't loaded yet or there's a connection issue."})]}):"No suitable opponents found for smart match suggestions."}),s.length===0&&e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"10px",padding:"8px 16px",background:"#5b21b6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Refresh Page"})]}),!d&&l.length>0&&e.jsxs("div",{className:"ladder-smart-match-suggestions",children:[e.jsxs("h4",{className:"ladder-smart-match-suggestions-title",children:["Top Suggestions (",l.length,")"]}),e.jsx("div",{className:"ladder-smart-match-suggestions-list",children:l.map((I,X)=>{var fe;return e.jsxs("div",{className:"ladder-smart-match-suggestion",onClick:()=>me(I),children:[e.jsxs("div",{className:"ladder-smart-match-suggestion-header",children:[e.jsxs("div",{className:"ladder-smart-match-suggestion-info",children:[e.jsxs("h4",{className:"ladder-smart-match-suggestion-title",children:[I.defender.firstName," ",I.defender.lastName,!((fe=I.defender.unifiedAccount)!=null&&fe.hasUnifiedAccount)&&e.jsx("span",{className:"ladder-smart-match-asterisk",title:"Incomplete profile - limited contact options",children:"*"}),F(I.defender)&&e.jsx("span",{className:"ladder-smart-match-hot-streak-badge",title:"Hot Streak: 3+ consecutive wins!",children:""})]}),e.jsxs("span",{className:"ladder-smart-match-suggestion-details",children:["Position ",I.defender.position,"  ",I.defender.ladderName]})]}),e.jsx("div",{className:"ladder-smart-match-confidence",children:e.jsx("div",{className:"ladder-smart-match-confidence-badge",style:{background:re(I.confidence)},children:je(I.confidence)})})]}),e.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[I.availabilityDetails&&I.availabilityDetails!=="No overlapping free time found"&&e.jsxs("div",{style:{marginBottom:"6px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#4CAF50",fontSize:"0.75rem",fontWeight:"600",marginBottom:"2px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[" ",e.jsx("span",{children:"Overlapping Availability:"})]}),e.jsx("div",{style:{color:"#81C784",fontSize:"0.7rem",lineHeight:"1.3",textAlign:"center"},children:I.availabilityDetails})]}),I.locationDetails&&I.locationDetails!=="No location data"&&e.jsxs("div",{style:{textAlign:"center"},children:[e.jsxs("div",{style:{color:"#FFB74D",fontSize:"0.75rem",fontWeight:"600",marginBottom:"2px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[" ",e.jsx("span",{children:"Location Match:"})]}),e.jsx("div",{style:{color:"#FFCC80",fontSize:"0.7rem",lineHeight:"1.3",textAlign:"center"},children:I.locationDetails})]})]}),e.jsxs("div",{className:"ladder-smart-match-suggestion-footer",children:[e.jsxs("div",{className:"ladder-smart-match-tags",children:[I.allMatchTypes&&I.allMatchTypes.map((ne,ye)=>e.jsxs("button",{className:"ladder-smart-match-tag ladder-smart-match-tag-primary",title:"Click to learn more about this match type",onClick:ot=>ve(ne.type,ot),style:{cursor:"pointer",userSelect:"none",border:"none",background:"transparent",color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"600",display:"flex",flexDirection:"column",alignItems:"center",gap:"0px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",textAlign:"center",minHeight:"auto",marginRight:"3px",marginBottom:"2px"},children:[e.jsx("div",{style:{fontSize:"0.65rem"},children:"Learn About"}),e.jsxs("div",{style:{fontSize:"0.65rem"},children:[Ee(ne.type)," ",V(ne.type)]})]},ye)),I.availabilityScore>.7&&e.jsx("span",{className:"ladder-smart-match-tag ladder-smart-match-tag-success",children:" Good Availability"}),I.locationScore>.7&&e.jsx("span",{className:"ladder-smart-match-tag ladder-smart-match-tag-info",children:" Location Match"})]}),e.jsxs("div",{className:"ladder-smart-match-actions",children:[I.allMatchTypes&&I.allMatchTypes.length>1?e.jsxs("button",{className:"ladder-smart-match-action-btn ladder-smart-match-action-btn-primary",onClick:ne=>{ne.stopPropagation(),w(I),W(!0)},style:{marginRight:"8px"},children:["Schedule Match (",I.allMatchTypes.length," options)"]}):e.jsxs("button",{className:"ladder-smart-match-action-btn ladder-smart-match-action-btn-primary",onClick:ne=>{ne.stopPropagation(),De(I)},style:{marginRight:"8px"},children:["Schedule ",Ee(I.type).replace(" ","").replace(" ","").replace(" ","").replace(" ","").replace(" ","").replace(" ","")]}),e.jsx("button",{className:"ladder-smart-match-action-btn ladder-smart-match-action-btn-secondary",onClick:ne=>Ce(I,ne),children:" View Details"})]})]})]},`${I.defender._id}-${I.type}`)})}),e.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"4px",color:"#ffc107",fontSize:"0.9rem"},children:[" ",e.jsx("strong",{children:"Tip:"})," Click on any suggestion to create a challenge. The confidence score indicates how likely the opponent is to respond positively."]})]}),e.jsxs("div",{className:"ladder-smart-match-footer",style:{display:"flex",justifyContent:"flex-end",marginTop:"12px"},children:[e.jsx("div",{className:"ladder-smart-match-legend",children:e.jsxs("p",{className:"ladder-smart-match-legend-text",children:[e.jsx("span",{className:"ladder-smart-match-asterisk",children:"*"})," = Incomplete profile (limited contact options)"]})}),e.jsx("button",{onClick:et,style:{padding:"12px 24px",background:"#666",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",marginLeft:"auto"},children:"Close"})]})]})}),g&&h&&e.jsx(oN,{isOpen:g,onClose:()=>f(!1),challenger:r,defender:h,challengeType:m,onChallengeComplete:I=>{f(!1),p(null),o&&o(I),et()}}),x&&b&&e.jsx(It,{open:x,onClose:()=>j(!1),title:` Match Analysis: ${b.defender.firstName} ${b.defender.lastName}`,maxWidth:"500px",maxHeight:"80vh",className:"ladder-smart-match-details-modal",borderColor:"#5b21b6",glowColor:"#5b21b6",children:e.jsxs("div",{style:{padding:"20px",maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{background:"rgba(91, 33, 182, 0.15)",border:"1px solid rgba(91, 33, 182, 0.4)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#ffffff",margin:"0 0 8px 0",fontSize:"1.2rem",fontWeight:"bold"},children:[V(b.type)," ",Ee(b.type)]}),e.jsxs("p",{style:{color:"#e0e0e0",margin:"0",fontSize:"1rem",fontWeight:"500"},children:["Position ",b.defender.position,"  ",b.defender.ladderName]})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px",fontSize:"1.1rem",fontWeight:"bold"},children:"Match Compatibility"}),e.jsx("p",{style:{color:"#d1d5db",fontSize:"0.95rem",marginBottom:"16px",fontStyle:"italic"},children:"How easy this match will be to schedule and coordinate:"}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.4)",border:"1px solid #555",borderRadius:"8px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:"Scheduling Ease:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:b.confidence>=80?" Very easy to coordinate":b.confidence>=60?" Some coordination needed":" Requires more planning"})]}),e.jsx("span",{style:{color:re(b.confidence),fontWeight:"bold",fontSize:"1rem",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:je(b.confidence)})]}),b.availabilityScore!==void 0&&e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:" Availability Match:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:b.availabilityScore===.5?" No availability data set":b.availabilityScore>.7?" You have similar free times":b.availabilityScore>.4?" Some matching availability":" Very different free time schedules"})]}),e.jsxs("span",{style:{color:b.availabilityScore===.5?"#9ca3af":b.availabilityScore>.7?"#10b981":"#f59e0b",fontSize:"1rem",fontWeight:"bold",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:[Math.round(b.availabilityScore*100),"%"]})]}),b.availabilityDetails&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"#e0e0e0",background:"rgba(91, 33, 182, 0.15)",border:"1px solid rgba(91, 33, 182, 0.3)",borderRadius:"6px",padding:"8px 12px",marginTop:"8px"},children:[e.jsx("strong",{style:{color:"#ffffff"},children:"Overlapping times:"})," ",b.availabilityDetails]})]}),b.locationScore!==void 0&&e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:" Location Match:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:b.locationScore>.7?" You prefer the same pool halls":b.locationScore>.4?" Some overlapping preferred venues":" You prefer different pool halls"})]}),e.jsxs("span",{style:{color:b.locationScore>.7?"#10b981":"#f59e0b",fontSize:"1rem",fontWeight:"bold",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:[Math.round(b.locationScore*100),"%"]})]}),b.locationDetails&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"#e0e0e0",background:"rgba(59, 130, 246, 0.15)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",padding:"8px 12px",marginTop:"8px"},children:[e.jsx("strong",{style:{color:"#ffffff"},children:"Common venues:"})," ",b.locationDetails]})]}),b.scheduleScore!==void 0&&e.jsx("div",{style:{padding:"12px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:" Schedule Conflicts:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:b.scheduleScore>.7?" No upcoming matches - both players free":b.scheduleScore>.4?" One player has upcoming matches":" Both players have upcoming matches"})]}),e.jsxs("span",{style:{color:b.scheduleScore>.7?"#10b981":"#f59e0b",fontSize:"1rem",fontWeight:"bold",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:[Math.round(b.scheduleScore*100),"%"]})]})})]})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"12px",fontSize:"1.1rem",fontWeight:"bold"},children:"Why This Match?"}),e.jsx("p",{style:{color:"#d1d5db",fontSize:"0.95rem",marginBottom:"12px",fontStyle:"italic"},children:"AI reasoning:"}),e.jsx("div",{style:{color:"#e0e0e0",lineHeight:"1.5",background:"rgba(0, 0, 0, 0.4)",border:"1px solid #555",borderRadius:"8px",padding:"16px",fontSize:"1rem"},children:b.reason})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h4",{style:{color:"#ffc107",marginBottom:"12px",fontSize:"1.1rem",fontWeight:"bold"},children:["Your Record vs ",b.defender.firstName]}),e.jsx("p",{style:{color:"#d1d5db",fontSize:"0.95rem",marginBottom:"12px",fontStyle:"italic"},children:"Your history against this opponent:"}),e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.4)",border:"1px solid #555",borderRadius:"8px",padding:"16px"},children:T?e.jsx("div",{style:{textAlign:"center",color:"#d1d5db",fontSize:"1rem"},children:" Loading head-to-head record..."}):P&&P.totalMatches===0?e.jsx("div",{style:{textAlign:"center",color:"#d1d5db",fontSize:"1rem"},children:" No previous matches - This would be your first game!"}):P?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:"Your Record:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:(()=>{const I=Math.round(P.wins/P.totalMatches*100);return I>=70?" You dominate this matchup":I>=50?" Even matchup":" They have your number"})()})]}),e.jsxs("span",{style:{color:(()=>Math.round(P.wins/P.totalMatches*100)>=50?"#10b981":"#ef4444")(),fontSize:"1.2rem",fontWeight:"bold",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:[P.wins,"-",P.losses]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:"Win Rate:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:(()=>{const I=Math.round(P.wins/P.totalMatches*100);return I>=70?" Strong advantage":I>=50?" Competitive":" Tough opponent"})()})]}),e.jsxs("span",{style:{color:(()=>Math.round(P.wins/P.totalMatches*100)>=50?"#10b981":"#ef4444")(),fontSize:"1rem",fontWeight:"bold",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:[Math.round(P.wins/P.totalMatches*100),"%"]})]}),P.lastMatch&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontSize:"1rem",fontWeight:"600"},children:"Last Match:"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#d1d5db",marginTop:"4px"},children:P.lastMatch.winner===`${r.firstName} ${r.lastName}`?" You won":" They won"})]}),e.jsx("span",{style:{color:"#e0e0e0",fontSize:"1rem",fontWeight:"500",padding:"4px 8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px"},children:P.lastMatch.date==="Match completed"?"Match completed":(()=>{try{const I=new Date(P.lastMatch.date);return isNaN(I.getTime())?"Match completed":Ss(I)}catch{return"Match completed"}})()})]})]}):e.jsx("div",{style:{textAlign:"center",color:"#d1d5db",fontSize:"1rem"},children:" Error loading head-to-head record"})})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"0.95rem"},children:" Match Planning Guide"}),e.jsxs("div",{style:{background:b.confidence>=70?"rgba(16, 185, 129, 0.1)":b.confidence>=50?"rgba(245, 158, 11, 0.1)":"rgba(59, 130, 246, 0.1)",border:b.confidence>=70?"1px solid rgba(16, 185, 129, 0.3)":b.confidence>=50?"1px solid rgba(245, 158, 11, 0.3)":"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",padding:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"1rem"},children:b.confidence>=70?"":b.confidence>=50?"":""}),e.jsx("span",{style:{color:b.confidence>=70?"#10b981":b.confidence>=50?"#f59e0b":"#3b82f6",fontWeight:"bold",fontSize:"0.9rem"},children:b.confidence>=70?"EASY TO SCHEDULE":b.confidence>=50?"GOOD MATCH":"REQUIRES PLANNING"})]}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.8rem",margin:"0",lineHeight:"1.3"},children:b.confidence>=70?"Great compatibility - scheduling should be smooth!":b.confidence>=50?"Good match - some coordination needed for details.":"Challenging to coordinate - may need more back-and-forth to schedule."})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>j(!1),style:{padding:"8px 16px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem"},children:"Close"}),e.jsx("button",{onClick:()=>Oe(b),style:{padding:"8px 16px",background:b.confidence>=70?"linear-gradient(135deg, #10b981 0%, #059669 100%)":b.confidence>=50?"linear-gradient(135deg, #6b46c1 0%, #a855f7 100%)":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"0.9rem"},children:b.confidence>=70?" Create Challenge":b.confidence>=50?"Create Challenge":" Create Challenge"})]})]})}),S&&e.jsx(It,{open:S,onClose:()=>_(!1),title:" AI Match Assistant",maxWidth:"800px",className:"ladder-ai-assistant-modal",borderColor:"#5b21b6",glowColor:"#5b21b6",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(91, 33, 182, 0.1)",border:"1px solid rgba(91, 33, 182, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffffff",margin:"0 0 12px 0",display:"flex",alignItems:"center",gap:"8px"},children:" AI Match Assistant"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0 0 12px 0"},children:`Ask me to find matches in natural language! Try: "Find me someone to challenge tonight" or "Who's available this weekend?"`}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[e.jsx("input",{type:"text",value:C,onChange:I=>N(I.target.value),placeholder:"Ask me to find a match...",style:{flex:1,padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #444",borderRadius:"6px",color:"#ffffff",fontSize:"0.9rem"},onKeyPress:I=>{I.key==="Enter"&&Ze()}}),e.jsx("button",{onClick:Ze,style:{background:"linear-gradient(135deg, #6b46c1 0%, #a855f7 100%)",border:"none",color:"#ffffff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem"},children:"Ask"})]}),e.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:["Find me a challenge match","Who's available tonight?","Find someone 2 positions above me"].map((I,X)=>e.jsx("button",{onClick:()=>N(I),style:{background:"rgba(91, 33, 182, 0.2)",border:"1px solid rgba(91, 33, 182, 0.4)",color:"#c4b5fd",padding:"4px 8px",borderRadius:"12px",cursor:"pointer",fontSize:"0.8rem",transition:"all 0.2s ease"},children:I},X))})]}),M.length>0&&e.jsxs("div",{className:"ladder-smart-match-suggestions",children:[e.jsxs("h4",{className:"ladder-smart-match-suggestions-title",children:[" AI Results (",M.length," matches found)"]}),e.jsx("div",{className:"ladder-smart-match-suggestions-list",children:M.map((I,X)=>{var fe;return e.jsxs("div",{className:"ladder-smart-match-suggestion",onClick:()=>{_(!1),me(I)},style:{border:"2px solid #5b21b6"},children:[e.jsxs("div",{className:"ladder-smart-match-suggestion-header",children:[e.jsxs("div",{className:"ladder-smart-match-suggestion-info",children:[e.jsxs("span",{className:"ladder-smart-match-suggestion-icon",children:[" ",V(I.type)]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"ladder-smart-match-suggestion-title",children:[I.defender.firstName," ",I.defender.lastName,!((fe=I.defender.unifiedAccount)!=null&&fe.hasUnifiedAccount)&&e.jsx("span",{className:"ladder-smart-match-asterisk",title:"Incomplete profile - limited contact options",children:"*"})]}),e.jsxs("p",{className:"ladder-smart-match-suggestion-details",children:["Position ",I.defender.position,"  ",I.defender.ladderName]})]})]}),e.jsx("div",{className:"ladder-smart-match-confidence",children:e.jsx("div",{className:"ladder-smart-match-confidence-badge",style:{background:re(I.confidence)},children:je(I.confidence)})})]}),e.jsxs("div",{className:"ladder-smart-match-suggestion-footer",children:[e.jsxs("div",{className:"ladder-smart-match-tags",children:[e.jsx("span",{className:`ladder-smart-match-tag ladder-smart-match-tag-${I.type}`,children:Ee(I.type)}),I.availabilityScore>.7&&e.jsx("span",{className:"ladder-smart-match-tag ladder-smart-match-tag-success",children:" Good Availability"}),I.locationScore>.7&&e.jsx("span",{className:"ladder-smart-match-tag ladder-smart-match-tag-info",children:" Location Match"}),I.learnedBonus>0&&e.jsx("span",{className:"ladder-smart-match-tag ladder-smart-match-tag-success",children:" AI Enhanced"})]}),e.jsx("button",{className:"ladder-smart-match-details-btn",onClick:ne=>{ne.stopPropagation(),_(!1),Ce(I,ne)},title:"View detailed match analysis",children:"View Details"})]})]},`ai-${I.defender._id}-${I.type}`)})})]}),M.length===0&&C&&e.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#9ca3af"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),e.jsx("h3",{style:{marginBottom:"8px"},children:"No matches found"}),e.jsx("p",{children:"Try a different query or check the main suggestions below."})]}),e.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},children:e.jsx("button",{onClick:()=>_(!1),style:{padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Close"})})]})}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        
        /* Fallback styles for GoDaddy hosting issues */
        .ladder-smart-match-modal {
          background: linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98)) !important;
          border: 2px solid #5b21b6 !important;
          border-radius: 12px !important;
          color: #ffffff !important;
        }
        
        .ladder-smart-match-content {
          background: transparent !important;
          color: #ffffff !important;
        }
        
        .ladder-smart-match-header {
          background: rgba(91, 33, 182, 0.1) !important;
          border: 1px solid rgba(91, 33, 182, 0.3) !important;
          border-radius: 6px !important;
          padding: 6px !important;
          margin-bottom: 8px !important;
        }
        
        .ladder-smart-match-title {
          color: #ffffff !important;
          margin: 0 0 2px 0 !important;
          text-align: center !important;
          font-size: 1.1rem !important;
          font-weight: bold !important;
          text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;
        }
        
        .ladder-smart-match-subtitle {
          color: #e0e0e0 !important;
          text-align: center !important;
          margin: 0 !important;
          font-size: 0.8rem !important;
        }
        
        /* Compact card layout */
        .ladder-smart-match-suggestion-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-top: 12px;
          padding-top: 12px;
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ladder-smart-match-details-btn {
          background: rgba(91, 33, 182, 0.8) !important;
          border: 1px solid #5b21b6 !important;
          color: #ffffff !important;
          padding: 6px 12px !important;
          border-radius: 4px !important;
          cursor: pointer !important;
          font-size: 0.85rem !important;
          transition: all 0.2s ease !important;
        }
        
        .ladder-smart-match-details-btn:hover {
          background: rgba(91, 33, 182, 1) !important;
          border-color: #7c3aed !important;
          transform: translateY(-1px) !important;
        }
        
        .ladder-smart-match-tag-info {
          background: rgba(59, 130, 246, 0.2) !important;
          color: #60a5fa !important;
          border: 1px solid rgba(59, 130, 246, 0.3) !important;
        }
        
        /* Mobile responsive adjustments for compact cards */
        @media (max-width: 768px) {
          .ladder-smart-match-suggestion-footer {
            flex-direction: column;
            gap: 8px;
            align-items: stretch;
          }
          
          .ladder-smart-match-details-btn {
            width: 100% !important;
            text-align: center !important;
          }
        }
        
        .ladder-smart-match-hot-streak-badge {
          display: inline-block;
          margin-left: 6px;
          font-size: 0.9rem;
          animation: hotStreakPulse 2s infinite;
          filter: drop-shadow(0 0 4px rgba(255, 69, 0, 0.6));
        }
        
        @keyframes hotStreakPulse {
          0%, 100% { 
            transform: scale(1);
            filter: drop-shadow(0 0 4px rgba(255, 69, 0, 0.6));
          }
          50% { 
            transform: scale(1.1);
            filter: drop-shadow(0 0 8px rgba(255, 69, 0, 0.8));
          }
        }
      `}),console.log(" Modal render check - showMatchTypeModal:",k,"selectedMatchType:",U),k&&U&&xr.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>R(!1),style:{zIndex:100001,position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content",onClick:I=>I.stopPropagation(),style:{position:"relative",backgroundColor:"#1a1a1a",padding:"20px",borderRadius:"8px",maxWidth:"400px",width:"40%",maxHeight:"80vh",overflow:"auto",border:"2px solid #a855f7",boxShadow:"0 10px 30px rgba(168, 85, 247, 0.3)"},children:[e.jsxs("div",{className:"modal-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsxs("h2",{style:{color:"#ffffff",margin:0,fontSize:"1.5rem"},children:[V(U)," ",ae(U).title]}),e.jsx("button",{className:"modal-close-btn",onClick:()=>R(!1),style:{background:"none",border:"none",color:"#ffffff",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"16px",lineHeight:"1.5"},children:ae(U).description}),e.jsx("h4",{style:{color:"#a855f7",marginBottom:"12px",fontSize:"1.1rem"},children:"Match Rules:"}),e.jsx("ul",{style:{color:"#ccc",paddingLeft:"20px",marginBottom:"20px"},children:ae(U).rules.map((I,X)=>e.jsx("li",{style:{marginBottom:"8px",lineHeight:"1.4"},children:I},X))})]}),e.jsx("div",{className:"modal-footer",style:{textAlign:"center"},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>R(!1),style:{background:"linear-gradient(135deg, #a855f7, #7c3aed)",border:"none",color:"white",padding:"10px 20px",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",fontWeight:"600"},children:"Got it!"})})]})}),document.body),$&&b&&xr.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>W(!1),style:{zIndex:100001,position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{className:"modal-content",onClick:I=>I.stopPropagation(),style:{position:"relative",backgroundColor:"#1a1a1a",padding:"20px",borderRadius:"8px",maxWidth:"400px",width:"40%",maxHeight:"80vh",overflow:"auto",border:"2px solid #a855f7",boxShadow:"0 10px 30px rgba(168, 85, 247, 0.3)"},children:[e.jsxs("div",{className:"modal-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h2",{style:{color:"#ffffff",margin:0,fontSize:"1.5rem"},children:"Choose Match Type"}),e.jsx("button",{className:"modal-close-btn",onClick:()=>W(!1),style:{background:"none",border:"none",color:"#ffffff",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"16px",lineHeight:"1.5"},children:["Select the type of match you want to schedule with ",b.defender.firstName,":"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:b.allMatchTypes.map((I,X)=>e.jsxs("button",{onClick:()=>{const fe={...b,type:I.type,confidence:I.confidence};De(fe),W(!1)},style:{background:"linear-gradient(135deg, #a855f7, #7c3aed)",border:"none",color:"white",padding:"12px 16px",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",fontWeight:"600",textAlign:"left",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{children:[Ee(I.type)," ",V(I.type)]}),e.jsxs("span",{style:{fontSize:"0.9rem",opacity:.8},children:[Math.round(I.confidence*100),"% confidence"]})]},X))})]})]})}),document.body)]}),document.body):null};const nX=`
  @keyframes pulse {
    0% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.02); }
    100% { opacity: 1; transform: scale(1); }
  }
`;if(typeof document<"u"){const n=document.createElement("style");n.textContent=nX,document.head.appendChild(n)}const sX=({isOpen:n,onClose:t,selectedLadder:r})=>{var U,z,$,W,Y,Q,H,ue,J,be,Ae,O,oe,me,Ce,ve,De,Oe,Ze,et,re,je,V,Ee,F,ae,I,X,fe,ne,ye,ot,lt,tt,ge,xt,ht,Je,Pe,Ve;const[s,a]=y.useState(r),[o,i]=y.useState(null),[l,c]=y.useState(!0),[d,u]=y.useState(null),[h,p]=y.useState([]),[g,f]=y.useState([]),[m,v]=y.useState(null),[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState([]);y.useEffect(()=>{n&&a(r)},[n,r]),y.useEffect(()=>{o&&S.length>0&&E()},[o,S]),y.useEffect(()=>{if(n){C(),N(),M(),P();const we=setInterval(()=>{C(),P()},3e4),Re=it=>{it.key==="Escape"&&t()};return document.addEventListener("keydown",Re),()=>{clearInterval(we),document.removeEventListener("keydown",Re)}}},[n,s,t]);const C=async()=>{try{c(!0),u(null),console.log(" Prize Pool: Fetching data for ladder:",s);const we=await mt.getPrizePoolData(s);if(console.log(" Prize Pool: Supabase result:",we),we.success)console.log(" Prize Pool: Setting prize pool data:",we.data),i(we.data);else{console.log(" Prize Pool: Supabase query failed, using estimated data");const Re=D();i(Re),u("Using estimated data - Supabase query failed")}}catch(we){console.error("Error fetching prize pool data:",we);const Re=D();i(Re),u("Using estimated data - Connection failed")}finally{c(!1)}},N=async()=>{try{const we=await mt.getPrizePoolHistory(s);we.success&&p(we.data)}catch(we){console.error("Error fetching historical data:",we)}},M=async()=>{try{const we=await mt.getPrizePoolWinners(s);we.success?(console.log("Winners data received:",we.data),f(Array.isArray(we.data)?we.data:[])):(console.log("No winners data available, setting empty array"),f([]))}catch(we){console.error("Error fetching winners:",we),f([])}},E=async()=>{try{const we=new Date,Re=S.length||25,it=(o==null?void 0:o.totalMatches)||0;let rt,yt,kt,Ct,te,ke,We;if(we<new Date(2026,0,1))rt=1,yt=0,kt=7,Ct=1,te=new Date(2025,8,1).toISOString(),ke=new Date(2025,11,31).toISOString(),We=4;else{rt=2,yt=5,kt=7,Ct=1;const rr=we.getMonth(),Pr=Math.floor(rr/3)*3;te=new Date(we.getFullYear(),Pr,1).toISOString(),ke=new Date(we.getFullYear(),Pr+3,1).toISOString(),We=3}const Fe=Re*kt,st=Re*Ct,Ft=it*.5,Le=st+Ft,Z=Re*yt*We,Ye=it*2.5,dt=Fe+Z+Ye,pt=dt+Le,Tt=Math.max(2,Math.ceil(Re*.15)),Wt={placesToPay:Tt,climber:Math.round(Le),firstPlace:Tt>=1?Math.round(dt*.4):0,secondPlace:Tt>=2?Math.round(dt*.3):0,thirdPlace:Tt>=3?Math.round(dt*.2):0,fourthPlace:Tt>=4?Math.round(dt*.1):0},ir={phase:rt,membershipFee:yt,seedAmount:Fe,climberSeed:st,totalPrizePool:pt,totalPlacementPool:dt,totalClimberFund:Le,nextPayoutDate:ke,currentPeriodStart:te,periodLengthMonths:We,activePlayerCount:Re,payouts:Wt,currentClimber:null};console.log("Seed funding data (calculated):",ir),v(ir)}catch(we){console.error("Error fetching seed funding:",we),v(null)}},P=async()=>{try{const we=await mt.getLadderPlayersByName(s);if(we.success){console.log("Ladder standings received:",we.data);const Re=we.data.sort((it,rt)=>it.position-rt.position);console.log(" Prize Pool: Top 3 players:",Re.slice(0,3)),_(Re)}else console.log("No standings data available"),_([])}catch(we){console.error("Error fetching ladder standings:",we),_([])}},D=()=>{const we=new Date,Re=new Date(we.getFullYear(),Math.floor(we.getMonth()/2)*2,1),it=Math.floor((we-Re)/(1e3*60*60*24)),rt=Math.floor(it/7*3),yt=rt*3,kt=new Date(Re);return kt.setMonth(kt.getMonth()+2),{currentPrizePool:yt,totalMatches:rt,nextDistribution:kt.toISOString(),isEstimated:!0}},T=we=>{switch(we){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return we}},A=we=>{a(we),w(!1),j(!1),E()},k=we=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(we),R=we=>new Date(we).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return n?xr.createPortal(e.jsxs("div",{className:"prize-pool-modal ladder-prize-pool-modal",onClick:we=>{we.target===we.currentTarget&&t()},style:{position:"fixed",top:-20,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:[e.jsxs("div",{className:"prize-pool-modal-content",onClick:we=>we.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"16px",padding:"0.5rem 1rem",maxWidth:"min(640px, 95vw)",maxHeight:"85vh",width:"min(640px, 95vw)",overflow:"hidden",display:"flex",flexDirection:"column",border:"2px solid #00ff00",boxShadow:"0 0 30px rgba(0, 255, 0, 0.5)",position:"relative"},children:[e.jsxs("div",{className:"modal-header",style:{position:"relative",marginBottom:"0.05rem",paddingBottom:"0.05rem",borderBottom:"1px solid rgba(255, 68, 68, 0.3)"},children:[e.jsx("button",{onClick:t,style:{position:"absolute",top:"0",right:"0",background:"rgba(255, 68, 68, 0.2)",border:"1px solid #ff4444",color:"#ff4444",padding:"0.4rem 0.8rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold",zIndex:10},children:" Close"}),e.jsx("h2",{style:{color:"#fff",margin:"0 0 0.5rem 0",fontSize:"1.2rem",textAlign:"center",fontWeight:"bold",marginTop:"1.7rem"},children:"  Prize Pool Tracker"}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"left",gap:"0.4rem",marginTop:"0.8rem",flexWrap:"wrap",paddingLeft:"2rem"},children:[e.jsx("label",{style:{color:"#ccc",fontWeight:"bold",fontSize:"1rem"},children:"Select Ladder:"}),e.jsxs("select",{value:s,onChange:we=>A(we.target.value),style:{background:"rgba(0, 0, 0, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"white",padding:"0.2rem 0.8rem",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",minWidth:"140px"},children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",textAlign:"left",paddingRight:"60px",color:"#fff",fontSize:"1.1rem",fontWeight:"bold"},children:[T(s)," Ladder"]}),e.jsxs("div",{style:{position:"absolute",top:"10px",left:"60px",display:"flex",alignItems:"left",gap:"2px",fontSize:"0.8rem",color:"#00ff00"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#00ff00",animation:"pulse 2s infinite"}}),"Live"]})]}),e.jsx("div",{className:"modal-body",style:{flex:1,minHeight:0,overflowY:"auto"},children:l&&!o?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{style:{color:"#ccc",marginTop:"1rem"},children:"Loading prize pool data..."})]}):e.jsxs(e.Fragment,{children:[d&&e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px",padding:"8px",marginBottom:"1rem",fontSize:"0.9rem",color:"#ffc107"},children:[" ",d]}),e.jsx("div",{style:{marginBottom:"0.1rem"},children:e.jsxs("div",{style:{background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"10px",padding:"0.5rem 0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:"bold",color:"#00ff00"},children:k((m==null?void 0:m.totalPrizePool)||0)}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Total Prize Pool"}),e.jsxs("div",{style:{color:"#aaa",fontSize:"0.7rem",marginTop:"4px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px",textAlign:"left"},children:[e.jsxs("div",{children:[" Placement Pool: ",k((m==null?void 0:m.totalPlacementPool)||0)]}),e.jsxs("div",{children:[" Climber Fund: ",k((m==null?void 0:m.totalClimberFund)||0)]})]}),(m==null?void 0:m.phase)===1&&e.jsxs("div",{style:{color:"#ff0000",fontSize:"1rem",marginTop:"6px",fontWeight:"bold",textShadow:"0 0 8px rgba(255, 0, 0, 0.8)",background:"rgba(255, 0, 0, 0.1)",border:"2px solid #ff0000",borderRadius:"8px",padding:"8px",textAlign:"center",animation:"pulse 2s infinite"},children:[" TESTING PHASE - FREE UNTIL DEC 31ST, 2025 ",e.jsx("br",{}),"These amounts will NOT be paid out",e.jsx("br",{}),"Prize pool resets Jan 1st, 2026 when $5/month membership begins",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.85rem",color:"#ffc107"},children:"(Prize pools funded by tournament entries and match fees)"})]}),(m==null?void 0:m.phase)===2&&e.jsxs("div",{style:{color:"#ffc107",fontSize:"0.9rem",marginTop:"8px",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px",padding:"6px",textAlign:"center"},children:[" MEMBERSHIP BEGINS JAN 1, 2026 ",e.jsx("br",{}),"$5/month membership  First real prize payout in March 2026",e.jsx("br",{}),"Prize pools funded by tournaments ($20 entry: $10 to ladder prize pool)"]}),(o==null?void 0:o.isEstimated)&&e.jsx("div",{style:{color:"#ffc107",fontSize:"0.9rem",marginTop:"4px"},children:"(Estimated)"})]})}),m&&e.jsxs("div",{style:{marginBottom:"0.5rem",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#ccc",fontSize:"0.85rem",marginBottom:"0.25rem"},children:["Period Start: ",new Date(m.currentPeriodStart).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),"  Next Payout: ",new Date(m.nextPayoutDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.jsxs("div",{style:{color:"#fff",fontSize:"0.85rem",fontStyle:"italic",marginBottom:"4px"},children:[m.periodLengthMonths,"-month period ",m.membershipFee>0?` ${k(m.membershipFee)}/month membership`:" FREE membership (testing)"]}),e.jsxs("div",{style:{color:"#999",fontSize:"0.75rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"4px",padding:"4px 8px",display:"inline-block"},children:[m.activePlayerCount," active players"]})]}),e.jsxs("div",{style:{marginBottom:"0.1rem"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"0.5rem",fontSize:"1.1rem",textAlign:"center"},children:"Revenue Breakdown"}),e.jsxs("div",{style:{display:"grid",gap:"0.35rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"0.6rem 0.8rem",fontSize:"0.82rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"6px",padding:"6px 8px"},children:[e.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:"Tournament Entries ($10 ea):"}),e.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:k(((m==null?void 0:m.seedAmount)||0)+((m==null?void 0:m.climberSeed)||0))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#ccc"},children:"Match Contributions ($3 ea):"}),e.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:k(((o==null?void 0:o.totalMatches)||0)*3)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderTop:"1px solid rgba(255,255,255,0.2)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("span",{style:{color:"#ccc"},children:"Completed Matches:"}),e.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:(o==null?void 0:o.totalMatches)||0})]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#aaa",fontStyle:"italic",marginTop:"0.35rem",padding:"6px 8px",background:"rgba(33, 150, 243, 0.1)",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.2)"},children:" Prize pools funded by: Match fees ($3 per match) + Tournament entries ($20 entry: $10 to ladder prize pool, $10 to tournament payout)"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#ccc"},children:"Awards:"}),e.jsxs("span",{style:{color:"#fff"},children:["Climber + Top ",((U=m==null?void 0:m.payouts)==null?void 0:U.placesToPay)||1]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"6px 10px",marginBottom:"6px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx("span",{style:{color:"#fff",fontSize:"1rem",fontWeight:"bold"},children:" Climber Award:"}),e.jsxs("span",{style:{color:"#ddd",fontSize:"0.7rem",fontStyle:"italic"},children:["(Most improved, not in top ",((z=m==null?void 0:m.payouts)==null?void 0:z.placesToPay)||4,")"]})]}),e.jsx("span",{style:{color:"#fff",fontWeight:"bold",fontSize:"1.1rem"},children:k((($=m==null?void 0:m.payouts)==null?void 0:$.climber)||0)})]}),e.jsx("div",{style:{color:"#00ff88",fontSize:"0.95rem",fontWeight:"bold",marginTop:"0.5rem",marginBottom:"0.25rem",textAlign:"center",borderTop:"1px solid rgba(0, 255, 136, 0.3)",paddingTop:"0.5rem"},children:" Placement Awards"}),((W=m==null?void 0:m.payouts)==null?void 0:W.firstPlace)!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"8px",padding:"6px 10px",marginBottom:"1px"},children:[e.jsx("span",{style:{color:"#ccc",fontSize:"0.95rem",fontWeight:"bold"},children:"1st Place (40%):"}),e.jsx("span",{style:{color:"#00ff88",fontSize:"1.1rem",fontStyle:"italic",fontWeight:"bold",textShadow:"0 0 8px rgba(0, 255, 136, 0.5)",background:"linear-gradient(45deg, #00ff88, #00ffaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:S.length>0?`${((Q=(Y=S[0])==null?void 0:Y.users)==null?void 0:Q.first_name)||((H=S[0])==null?void 0:H.firstName)||""} ${((J=(ue=S[0])==null?void 0:ue.users)==null?void 0:J.last_name)||((be=S[0])==null?void 0:be.lastName)||""}`.trim()||"No player":"No players yet"}),e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:k(((Ae=m==null?void 0:m.payouts)==null?void 0:Ae.firstPlace)||0)})]}),((O=m==null?void 0:m.payouts)==null?void 0:O.secondPlace)!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"8px",padding:"6px 10px",marginBottom:"1px"},children:[e.jsx("span",{style:{color:"#ccc",fontSize:"0.95rem",fontWeight:"bold"},children:"2nd Place (30%):"}),e.jsx("span",{style:{color:"#ffd700",fontSize:"1.1rem",fontStyle:"italic",fontWeight:"bold",textShadow:"0 0 10px rgba(255, 215, 0, 0.7)",background:"linear-gradient(45deg, #ffd700, #ffed4e)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:S.length>1&&`${((me=(oe=S[1])==null?void 0:oe.users)==null?void 0:me.first_name)||((Ce=S[1])==null?void 0:Ce.firstName)||""} ${((De=(ve=S[1])==null?void 0:ve.users)==null?void 0:De.last_name)||((Oe=S[1])==null?void 0:Oe.lastName)||""}`.trim()||"No player"}),e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:k(((Ze=m==null?void 0:m.payouts)==null?void 0:Ze.secondPlace)||0)})]}),((et=m==null?void 0:m.payouts)==null?void 0:et.thirdPlace)!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"8px",padding:"6px 10px",marginBottom:"1px"},children:[e.jsx("span",{style:{color:"#ccc",fontSize:"0.95rem",fontWeight:"bold"},children:"3rd Place (20%):"}),e.jsx("span",{style:{color:"#c0c0c0",fontSize:"1.1rem",fontStyle:"italic",fontWeight:"bold",textShadow:"0 0 8px rgba(192, 192, 192, 0.6)",background:"linear-gradient(45deg, #c0c0c0, #e8e8e8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:S.length>2&&`${((je=(re=S[2])==null?void 0:re.users)==null?void 0:je.first_name)||((V=S[2])==null?void 0:V.firstName)||""} ${((F=(Ee=S[2])==null?void 0:Ee.users)==null?void 0:F.last_name)||((ae=S[2])==null?void 0:ae.lastName)||""}`.trim()||"No player"}),e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:k(((I=m==null?void 0:m.payouts)==null?void 0:I.thirdPlace)||0)})]}),((X=m==null?void 0:m.payouts)==null?void 0:X.fourthPlace)!==void 0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"8px",padding:"6px 10px",marginBottom:"1px"},children:[e.jsx("span",{style:{color:"#ccc",fontSize:"0.95rem",fontWeight:"bold"},children:"4th Place (10%):"}),e.jsx("span",{style:{color:"#e9d5ff",fontSize:"1.1rem",fontStyle:"italic",fontWeight:"bold"},children:S.length>3&&`${((ne=(fe=S[3])==null?void 0:fe.users)==null?void 0:ne.first_name)||((ye=S[3])==null?void 0:ye.firstName)||""} ${((lt=(ot=S[3])==null?void 0:ot.users)==null?void 0:lt.last_name)||((tt=S[3])==null?void 0:tt.lastName)||""}`.trim()||"No player"}),e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:k(((ge=m==null?void 0:m.payouts)==null?void 0:ge.fourthPlace)||0)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 255, 0, 0.05)",border:"1px solid rgba(0, 255, 0, 0.2)",borderRadius:"8px",padding:"6px 10px",marginTop:"4px"},children:[e.jsx("span",{style:{color:"#00ff00",fontSize:"0.95rem",fontWeight:"bold"},children:"Total Payouts:"}),e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold",fontSize:"1.1rem"},children:k((((xt=m==null?void 0:m.payouts)==null?void 0:xt.climber)||0)+(((ht=m==null?void 0:m.payouts)==null?void 0:ht.firstPlace)||0)+(((Je=m==null?void 0:m.payouts)==null?void 0:Je.secondPlace)||0)+(((Pe=m==null?void 0:m.payouts)==null?void 0:Pe.thirdPlace)||0)+(((Ve=m==null?void 0:m.payouts)==null?void 0:Ve.fourthPlace)||0))})]})]})]}),e.jsxs("div",{style:{display:"grid",gap:"0.02rem",marginBottom:"0.1rem"},children:[e.jsx("button",{onClick:()=>j(!0),style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",color:"#ffc107",padding:"10px 14px",borderRadius:"8px",cursor:"pointer",fontSize:"0.95rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s ease"},onMouseEnter:we=>{we.target.style.background="rgba(255, 193, 7, 0.2)"},onMouseLeave:we=>{we.target.style.background="rgba(255, 193, 7, 0.1)"},children:" Show Winners"}),e.jsx("button",{onClick:()=>w(!0),style:{background:"rgba(0, 123, 255, 0.1)",border:"1px solid rgba(0, 123, 255, 0.3)",color:"#007bff",padding:"10px 14px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s ease"},onMouseEnter:we=>{we.target.style.background="rgba(0, 123, 255, 0.2)"},onMouseLeave:we=>{we.target.style.background="rgba(0, 123, 255, 0.1)"},children:" Show History"})]})]})})]}),x&&xr.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"350px",width:"55%",maxHeight:"80vh",overflow:"auto",border:"2px solid #00ff00",boxShadow:"0 0 30px rgba(0, 255, 0, 0.3)",position:"relative"},children:[e.jsx("button",{onClick:()=>j(!1),style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 0, 0, 0.2)",border:"1px solid rgba(255, 0, 0, 0.5)",color:"#ff4444",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"1.2rem",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:we=>{we.target.style.background="rgba(255, 0, 0, 0.3)",we.target.style.borderColor="rgba(255, 0, 0, 0.7)"},onMouseLeave:we=>{we.target.style.background="rgba(255, 0, 0, 0.2)",we.target.style.borderColor="rgba(255, 0, 0, 0.5)"},children:""}),e.jsxs("div",{style:{marginBottom:"2rem",textAlign:"center"},children:[e.jsx("h2",{style:{color:"#ffc107",margin:"0 0 0.5rem 0",fontSize:"1.8rem",fontWeight:"bold"},children:" Recent Winners"}),e.jsxs("p",{style:{color:"#ccc",margin:0,fontSize:"1rem"},children:[s," Ladder Prize Winners"]})]}),e.jsx("div",{style:{background:"rgba(255, 193, 7, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 193, 7, 0.2)"},children:g.length>0?e.jsx("div",{style:{display:"grid",gap:"1rem"},children:g.map((we,Re)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 193, 7, 0.1)",transition:"all 0.2s ease"},onMouseEnter:it=>{it.target.style.background="rgba(255, 193, 7, 0.1)",it.target.style.borderColor="rgba(255, 193, 7, 0.3)"},onMouseLeave:it=>{it.target.style.background="rgba(255, 255, 255, 0.05)",it.target.style.borderColor="rgba(255, 193, 7, 0.1)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"1.1rem"},children:we.playerName}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem",marginTop:"2px"},children:[we.category,"  ",R(we.date)]})]}),e.jsx("div",{style:{color:"#ffc107",fontWeight:"bold",fontSize:"1.2rem",textAlign:"right"},children:k(we.amount)})]},Re))}):e.jsxs("div",{style:{color:"#ccc",fontStyle:"italic",textAlign:"center",padding:"2rem",fontSize:"1.1rem"},children:[" No winners recorded yet",e.jsx("div",{style:{fontSize:"0.9rem",marginTop:"0.5rem",opacity:.7},children:"Winners will appear here after the first prize distribution"})]})}),e.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center",color:"#888",fontSize:"0.9rem"},children:"Prize distributions occur every 3 months"})]})}),document.body),b&&xr.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"350px",width:"55%",maxHeight:"80vh",overflow:"auto",border:"2px solid #00ff00",boxShadow:"0 0 30px rgba(0, 255, 0, 0.3)",position:"relative"},children:[e.jsx("button",{onClick:()=>w(!1),style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 0, 0, 0.2)",border:"1px solid rgba(255, 0, 0, 0.5)",color:"#ff4444",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"1.2rem",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:we=>{we.target.style.background="rgba(255, 0, 0, 0.3)",we.target.style.borderColor="rgba(255, 0, 0, 0.7)"},onMouseLeave:we=>{we.target.style.background="rgba(255, 0, 0, 0.2)",we.target.style.borderColor="rgba(255, 0, 0, 0.5)"},children:""}),e.jsxs("div",{style:{marginBottom:"2rem",textAlign:"center"},children:[e.jsx("h2",{style:{color:"#007bff",margin:"0 0 0.5rem 0",fontSize:"1.8rem",fontWeight:"bold"},children:" Prize Pool History"}),e.jsxs("p",{style:{color:"#ccc",margin:0,fontSize:"1rem"},children:[s," Ladder Historical Data"]})]}),e.jsx("div",{style:{background:"rgba(0, 123, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(0, 123, 255, 0.2)"},children:h.length>0?e.jsx("div",{style:{display:"grid",gap:"1rem"},children:h.map((we,Re)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:we.isCurrent?"rgba(0, 123, 255, 0.1)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:we.isCurrent?"1px solid rgba(0, 123, 255, 0.3)":"1px solid rgba(0, 123, 255, 0.1)",transition:"all 0.2s ease"},onMouseEnter:it=>{it.target.style.background="rgba(0, 123, 255, 0.15)",it.target.style.borderColor="rgba(0, 123, 255, 0.4)"},onMouseLeave:it=>{it.target.style.background=we.isCurrent?"rgba(0, 123, 255, 0.1)":"rgba(255, 255, 255, 0.05)",it.target.style.borderColor=we.isCurrent?"rgba(0, 123, 255, 0.3)":"rgba(0, 123, 255, 0.1)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:we.isCurrent?"#00ff00":"#fff",fontWeight:"bold",fontSize:"1.1rem"},children:we.period}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem",marginTop:"2px"},children:[we.matches," matches played"]})]}),e.jsx("div",{style:{color:we.isCurrent?"#00ff00":"#007bff",fontWeight:"bold",fontSize:"1.2rem",textAlign:"right"},children:k(we.prizePool)})]},Re))}):e.jsxs("div",{style:{color:"#ccc",fontStyle:"italic",textAlign:"center",padding:"2rem",fontSize:"1.1rem"},children:[" No historical data available",e.jsx("div",{style:{fontSize:"0.9rem",marginTop:"0.5rem",opacity:.7},children:"Historical data will appear here after prize distributions"})]})}),e.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center",color:"#888",fontSize:"0.9rem"},children:"Prize pools reset every 3 months"})]})}),document.body)]}),document.body):null};const aX=({isOpen:n,onClose:t,playerName:r,selectedLadder:s,onMatchReported:a,isAdmin:o=!1,onPaymentInfoModalReady:i,setShowPaymentDashboard:l,userLadderData:c=null,preselectedMatchId:d=null})=>{const u=wo(),h=u.isFree,p=typeof window<"u"?window.innerWidth<=768:!1,[g,f]=y.useState([]),[m,v]=y.useState(null),[b,w]=y.useState(!1),[x,j]=y.useState(!0),[S,_]=y.useState(!1),[C,N]=y.useState(""),[M,E]=y.useState(""),[P,D]=y.useState(""),[T,A]=y.useState(""),[k,R]=y.useState("race-to-5"),[U,z]=y.useState(""),[$,W]=y.useState(""),[Y,Q]=y.useState(""),[H,ue]=y.useState(""),[J,be]=y.useState(""),[Ae,O]=y.useState("8-ball"),[oe,me]=y.useState(""),[Ce,ve]=y.useState(!1),[De,Oe]=y.useState(!1),[Ze,et]=y.useState(""),[re,je]=y.useState(!1);y.useEffect(()=>{i&&i(Oe)},[i]);const[V,Ee]=y.useState(null),[F,ae]=y.useState(null),[I,X]=y.useState(0),[fe,ne]=y.useState([]),[ye,ot]=y.useState(null);y.useEffect(()=>{n&&(console.log(" Report Modal - Opening with playerName:",r,"selectedLadder:",s),tt(),ge(),lt(),xt())},[n,r,s,c]),y.useEffect(()=>{if(n&&d&&g.length>0&&!m){const Z=g.find(Ye=>(Ye._id||Ye.id)===d);if(Z){console.log(" Pre-selecting match:",Z),v(Z),D(""),A("");let Ye="race-to-5";Z.matchFormat?Ye=Z.matchFormat:Z.raceLength&&(Ye=`race-to-${Z.raceLength}`),R(Ye);const dt=Ye.match(/race-to-(\d+)/);if(dt){const pt=parseInt(dt[1]);W(pt.toString()),Q("0")}}}},[n,d,g,m]);const lt=async()=>{try{const Z=await fetch(`${Ie}/api/monetization/payment-methods`);if(Z.ok){const Ye=await Z.json();ne(Ye.paymentMethods),ot(Ye),Ye.paymentMethods.length>0&&et(Ye.paymentMethods[0].id)}}catch(Z){console.error("Error loading payment methods:",Z)}},tt=async()=>{try{j(!0),N(""),console.log(" Report Modal - Fetching scheduled matches using Supabase..."),console.log(" Report Modal - Looking for playerName:",r),console.log(" Report Modal - userLadderData:",c);const Z=await mt.getScheduledMatchesForPlayer(r,s);Z.success?(console.log(" Report Modal - Matches from Supabase:",Z.matches),f(Z.matches)):(console.error(" Report Modal - Supabase Error:",Z.error),N("Failed to load pending matches"),f([]))}catch(Z){console.error("Error fetching pending matches:",Z),N("Failed to load pending matches"),f([])}finally{j(!1)}},ge=async()=>{var Z,Ye,dt,pt,Tt;try{const Wt=await mt.getPaymentStatus(r);console.log(" Match Reporting Modal - Payment status from Supabase:",Wt);let ir=!1;try{const rr=await mt.getPlayerProfileData(r,"ladder");rr.success&&((Z=rr.data)!=null&&Z.user)&&(ir=!0,console.log(" Match Reporting Modal - Found unified account via direct check"))}catch(rr){console.log(" Match Reporting Modal - Could not check unified account directly:",rr)}if(Wt){const rr={hasMembership:Wt.hasMembership||!1,status:Wt.status||"inactive",isActive:Wt.hasMembership&&(Wt.status==="active"||Wt.status==="free_phase"),isPromotionalPeriod:Wt.isPromotionalPeriod||!1,hasUnifiedAccount:ir||((Ye=c==null?void 0:c.unifiedAccount)==null?void 0:Ye.hasUnifiedAccount)===!0};console.log(" Match Reporting Modal - Converted membership data:",rr),Ee(rr)}else console.log(" Match Reporting Modal - No payment status found, setting membership with unified account check"),Ee({hasMembership:!1,status:"inactive",isActive:!1,isPromotionalPeriod:!1,hasUnifiedAccount:ir||((dt=c==null?void 0:c.unifiedAccount)==null?void 0:dt.hasUnifiedAccount)===!0})}catch(Wt){console.error("Error fetching membership:",Wt);let ir=!1;try{const rr=await mt.getPlayerProfileData(r,"ladder");rr.success&&((pt=rr.data)!=null&&pt.user)&&(ir=!0)}catch{}Ee({hasMembership:!1,status:"inactive",isActive:!1,isPromotionalPeriod:!1,hasUnifiedAccount:ir||((Tt=c==null?void 0:c.unifiedAccount)==null?void 0:Tt.hasUnifiedAccount)===!0})}},xt=async()=>{try{const Z=await fetch(`${Ie}/api/monetization/user-payment-data/${r}`);if(Z.ok){const Ye=await Z.json();ae(Ye.paymentHistory),X(Ye.credits||0)}}catch(Z){console.error("Error loading user payment data:",Z)}},ht=Z=>{v(Z),D(""),A("");let Ye="race-to-5";Z.matchFormat?Ye=Z.matchFormat:Z.raceLength&&(Ye=`race-to-${Z.raceLength}`),R(Ye);const dt=Ye.match(/race-to-(\d+)/),pt=dt?parseInt(dt[1]):5;W(pt.toString());const Tt=Z.date||Z.scheduledDate||Z.match_date||Z.scheduled_date;if(Tt)try{me(new Date(Tt).toISOString().split("T")[0])}catch(Wt){console.error("Error parsing match date:",Wt),me(new Date().toISOString().split("T")[0])}else me(new Date().toISOString().split("T")[0]);z(""),Q(""),ue(""),be(""),O(Z.gameType||"8-ball"),ve(!1),N(""),E("")},Je=()=>{v({_id:"example-match",senderName:"John Doe",receiverName:"Jane Smith",date:"2024-01-15",time:"7:00 PM",location:"Legends Brews & Cues",matchFormat:"race-to-5",raceLength:5}),w(!0),D(""),A(""),R("race-to-5"),z(""),W(""),Q(""),ue(""),be(""),O("8-ball"),me("2024-01-15"),ve(!1),N(""),E("")},Pe=()=>{v(null),w(!1),N(""),E("")},Ve=(Z,Ye,dt)=>{const pt=parseInt(Z),Tt=parseInt(Ye);if(!Z||!Ye||isNaN(pt)||isNaN(Tt))return{valid:!1,error:"Please enter valid numbers for both scores"};if(pt<=0||Tt<=0)return{valid:!1,error:"Scores must be greater than 0"};if(pt===Tt)return{valid:!1,error:"Winner and loser cannot have the same score"};let Wt;return dt==="other"?Wt=parseInt(U)||5:Wt=parseInt(dt.split("-")[2])||5,pt>Wt||Tt>Wt?{valid:!1,error:`Scores cannot exceed ${Wt} games for ${dt.replace("-"," ")}`}:pt<Tt?{valid:!1,error:"Winner must have more games than loser"}:{valid:!0,error:""}},we=(Z,Ye)=>`${Z}-${Ye}`,Re=(Z,Ye)=>{if(Z==="winner"?W(Ye):Q(Ye),be(""),Ye&&(Z==="winner"?Y:$)){const dt=Ve(Z==="winner"?Ye:$,Z==="winner"?Y:Ye,k);dt.valid?A(we(Z==="winner"?Ye:$,Z==="winner"?Y:Ye)):(be(dt.error),A(""))}},it=()=>{let Z;k==="other"?Z=parseInt(U)||5:Z=parseInt(k.split("-")[2])||5;const Ye=[];for(let dt=0;dt<=Z;dt++)Ye.push(dt);return Ye},rt=()=>{if(!F)return"new";const Z=F.totalPayments||0,Ye=F.failedPayments||0,dt=Z>0?(Z-Ye)/Z:0;return Z>=10&&dt>=.95?"trusted":Z>=3&&dt>=.8?"verified":"new"},yt=()=>I>=5,kt=async Z=>{var rr;if(Z.preventDefault(),!P){N("Please select a winner");return}if(k==="other"&&(!U||parseInt(U)<1)){N("Please enter a valid custom race number (1 or higher)");return}const Ye=Ve($,Y,k);if(!Ye.valid){be(Ye.error),N("Please fix the score before submitting");return}if(A(we($,Y)),b){E(" Example match result submitted! (This was just a test - no actual match was reported)"),setTimeout(()=>{Pe()},3e3);return}if(o){await Ct();return}const dt=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),pt=(V==null?void 0:V.hasUnifiedAccount)===!0||((rr=c==null?void 0:c.unifiedAccount)==null?void 0:rr.hasUnifiedAccount)===!0,Tt=!V||V.hasMembership===!1&&V.status==="inactive"&&!V.isPromotionalPeriod&&Object.keys(V).length<=3,Wt=u.phase===2,ir=h||dt||pt&&Tt||Wt&&pt;if(console.log(" Match Reporting Modal - Membership check:",{isFreePhase:h,hasActiveMembership:dt,hasUnifiedAccount:pt,noPaymentRecord:Tt,isPhase2Promotional:Wt,canProceed:ir,phaseInfo:u.name,membership:V}),!ir){console.log(" Membership check failed:",{membership:V,hasActiveMembership:dt,isFreePhase:h,hasUnifiedAccount:pt,noPaymentRecord:Tt,phaseInfo:u.description}),N(` Active membership required to report matches (${u.description}). Please renew your membership first.`),ve(!0);return}yt()?await te():ve(!0)},Ct=async()=>{try{_(!0),N("");const Z=P===m.senderName?m.senderId:m.receiverId,Ye=T,dt=H;console.log(" Admin submitting ladder match result:",{matchId:m._id,winnerId:Z,score:Ye,notes:dt,matchDate:oe});const pt=await mt.updateMatchStatus(m._id,"completed",{winnerId:Z},Ye,dt,oe);pt.success?(E(" Match result recorded successfully by admin!"),f(Tt=>Tt.filter(Wt=>Wt._id!==m._id)),a&&a(pt.data),setTimeout(()=>{t()},2e3)):(console.error(" Admin match reporting error:",pt.error),N(`Failed to record match result: ${pt.error}`))}catch(Z){console.error("Error submitting match result as admin:",Z),N("Failed to record match result")}finally{_(!1)}},te=async()=>{try{if((await fetch(`${Ie}/api/monetization/use-credits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r,amount:5,description:"Ladder Match Fee"})})).ok)await st(),X(Ye=>Ye-5);else throw new Error("Failed to use credits")}catch(Z){console.error("Credit payment error:",Z),N("Credit payment failed. Please try again.")}},ke=async()=>{var Z,Ye;je(!0),N("");try{if(!m)throw new Error("No match selected for payment");if(!r)throw new Error("Player name not found");const dt=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),pt=(V==null?void 0:V.hasUnifiedAccount)===!0||((Z=c==null?void 0:c.unifiedAccount)==null?void 0:Z.hasUnifiedAccount)===!0,Tt=u.phase===2,Wt=u.membershipFee||5,ir=!h&&!dt&&!pt&&!Tt,rr=h?5:ir?5+Wt:5,Pr=[];if(Pr.push(fetch(`${Ie}/api/monetization/record-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"match_fee",playerEmail:r,playerName:r,amount:5,paymentMethod:"cash",matchId:m._id,playerId:r,description:`Match fee for ${m.senderName} vs ${m.receiverName}`,notes:`Cash payment at Legends red dropbox - Match fee for ${m.senderName} vs ${m.receiverName}`,status:"pending_verification"})})),ir){const cn=u.membershipFee||5;Pr.push(fetch(`${Ie}/api/monetization/record-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"membership",playerEmail:r,playerName:r,amount:cn,paymentMethod:"cash",playerId:r,description:`Membership renewal for ${r} (${u.name})`,notes:`Cash payment at Legends red dropbox - Membership renewal for ${r} (${u.name})`,status:"pending_verification"})}))}const Fn=await Promise.all(Pr);if(Fn.every(cn=>cn.ok)){const cn=await Promise.all(Fn.map(async Jr=>{try{return await Jr.json()}catch(An){return console.error("Error parsing payment response:",An,Jr),{success:!1,error:"Failed to parse response"}}}));if(!cn.every(Jr=>Jr.success!==!1)){const Jr=cn.filter(An=>!An.success);throw console.error("Some payments failed:",Jr),new Error(`Failed to record payment(s): ${Jr.map(An=>An.error||An.message||"Unknown error").join(", ")}`)}if(cn.some(Jr=>{var An;return((An=Jr.payment)==null?void 0:An.status)==="pending_verification"||Jr.requiresVerification})){await We();const Jr=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),An=(V==null?void 0:V.hasUnifiedAccount)===!0||((Ye=c==null?void 0:c.unifiedAccount)==null?void 0:Ye.hasUnifiedAccount)===!0,ua=u.phase===2,ha=!h&&!Jr&&!An&&!ua,zr=u.membershipFee||5,Xs=(h?5:ha?5+zr:5).toFixed(0);E(` Cash Payment Recorded Successfully!

 Match Result Submitted
 Amount Due: $${Xs} cash
 Drop Location: RED dropbox at Legends Brews & Cues

 Your match result has been recorded and is pending admin verification. Once your cash payment is verified, ladder positions will be updated automatically.

Thank you for your payment!`)}else await st(),E(` Match Complete! 
          
 Cash Payment Processed
 Match Result Recorded
 Ladder positions updated automatically

Great game! Your match is now complete and reflected in the ladder rankings.`);setTimeout(()=>{t(),a&&a()},8e3)}else{const cn=Fn.filter(Dr=>!Dr.ok),Ja=await Promise.all(cn.map(async Dr=>{try{const Jr=await Dr.json();return Jr.message||Jr.error||`HTTP ${Dr.status}: ${Dr.statusText}`}catch{return`HTTP ${Dr.status}: ${Dr.statusText}`}}));throw new Error(`Failed to record cash payment(s): ${Ja.join(", ")}`)}}catch(dt){console.error("Cash payment error:",dt),N(`Failed to record cash payment: ${dt.message}. Please try again or contact support.`)}finally{je(!1)}},We=async()=>{try{let Z=5;k==="other"&&U?Z=parseInt(U)||5:k&&k.startsWith("race-to-")&&(Z=parseInt(k.split("-")[2])||5);const Ye=Ae,dt=await fetch(`${Ie}/api/ladder/matches/${m._id}/record-pending-payment`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({winner:P===m.senderName?m.senderId:m.receiverId,score:T,notes:H,reportedBy:m.senderName===r?m.senderId:m.receiverId,reportedAt:new Date().toISOString(),paymentMethod:"cash",gameType:Ye,raceLength:Z})});if(!dt.ok){const pt=await dt.json();throw new Error(pt.message||"Failed to record match with pending payment")}f(pt=>pt.filter(Tt=>Tt._id!==m._id))}catch(Z){throw console.error("Error recording match with pending payment:",Z),Z}},Fe=async Z=>{var Ye;je(!0),N("");try{const dt=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),pt=(V==null?void 0:V.hasUnifiedAccount)===!0||((Ye=c==null?void 0:c.unifiedAccount)==null?void 0:Ye.hasUnifiedAccount)===!0,Tt=u.phase===2,Wt=u.membershipFee||5,ir=!h&&!dt&&!pt&&!Tt,rr=h?5:ir?5+Wt:5,Pr=[];if(Pr.push(fetch(`${Ie}/api/monetization/record-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"match_fee",playerEmail:r,playerName:r,amount:5,paymentMethod:Z,matchId:m._id,playerId:r,description:`Match fee for ${m.senderName} vs ${m.receiverName}`,notes:`Match fee for ${m.senderName} vs ${m.receiverName}`,status:"completed"})})),ir){const cn=u.membershipFee||5;Pr.push(fetch(`${Ie}/api/monetization/record-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"membership",playerEmail:r,playerName:r,amount:cn,paymentMethod:Z,playerId:r,description:`Membership renewal for ${r} (${u.name})`,notes:`Membership renewal for ${r} (${u.name})`,status:"completed"})}))}if((await Promise.all(Pr)).every(cn=>cn.ok))rt()==="new"?(E(` Payment Recorded Successfully!

 Match Result Submitted  
 Pending Admin Verification
 Ladder positions will update once verified

Your payment has been recorded and your match result submitted. Admin will verify and process your match shortly.`),setTimeout(()=>{t(),a()},8e3)):await st();else throw new Error("Failed to record payment(s)")}catch(dt){console.error("Payment error:",dt),N("Payment processing failed. Please try again.")}finally{je(!1)}},st=async()=>{try{_(!0),N("");const Z=P===m.senderName?m.senderId:m.receiverId,Ye=T,dt=H;let pt=5;k==="other"&&U?pt=parseInt(U)||5:k&&k.startsWith("race-to-")&&(pt=parseInt(k.split("-")[2])||5);const Tt=Ae;console.log(" Submitting ladder match result:",{matchId:m._id,winnerId:Z,score:Ye,notes:dt,gameType:Tt,raceLength:pt,matchDate:oe});const Wt=await mt.updateMatchStatus(m._id,"completed",{winnerId:Z},Ye,dt,oe);if(Wt.success){const ir=P===m.senderName?m.senderName:m.receiverName,rr=P===m.senderName?m.receiverName:m.senderName,Pr=we($,Y);E(` Match Result Submitted Successfully! 
        
 Winner: ${ir} (${Pr})
 Loser: ${rr}

Your match has been recorded and ladder positions will be updated automatically. Great game!`),f(Fn=>Fn.filter(hs=>hs._id!==m._id)),a&&a(Wt.data),setTimeout(()=>{t()},2e3)}else{console.error(" Match reporting error from Supabase:",Wt.error),N(Wt.error||"Failed to report match result");return}}catch(Z){console.error("Error reporting match result:",Z),N(Z.message||"Failed to report match result")}finally{_(!1)}},Ft=Z=>{if(!Z)return"TBD";try{if(Z.includes("-")){const[dt,pt,Tt]=Z.split("-");if(dt&&pt&&Tt){const Wt=new Date(parseInt(dt),parseInt(pt)-1,parseInt(Tt));if(!isNaN(Wt.getTime()))return Wt.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}}const Ye=new Date(Z);if(!isNaN(Ye.getTime()))return Ye.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(Ye){console.error("Error formatting date:",Ye,Z)}return"TBD"},Le=Z=>{switch(Z){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return Z}};return n?e.jsxs("div",{className:"prize-pool-modal match-reporting-modal",style:p?{padding:"4px"}:void 0,children:[e.jsxs("div",{className:"prize-pool-modal-content",style:p?{width:"98vw",maxWidth:"98vw",maxHeight:"55vh",overflowY:"auto",padding:"8px"}:{overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsxs("div",{style:{color:"#ffd700",fontSize:p?"1rem":"1.2rem",fontWeight:"bold",flex:"1"},children:[Le(s)," Ladder"]}),e.jsxs("h2",{style:{color:"#10b981",margin:"0",fontSize:p?"1.1rem":"1.4rem",textAlign:"center",flex:"2"},children:[" Report Match Result",o&&e.jsx("div",{style:{background:"rgba(245, 158, 66, 0.2)",border:"1px solid rgba(245, 158, 66, 0.4)",borderRadius:"4px",padding:"4px 6px",marginTop:"6px",fontSize:"0.75rem",color:"#f59e42"},children:" Admin Mode"})]}),e.jsx("div",{style:{flex:"1",display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:p?"1.2rem":"1.5rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:p?"32px":"40px",height:p?"32px":"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.1)",Z.target.style.color="#fff"},onMouseLeave:Z=>{Z.target.style.background="none",Z.target.style.color="#ccc"},children:""})})]}),e.jsx("div",{className:"modal-body",children:x?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{style:{color:"#ccc",marginTop:"1rem"},children:"Loading pending matches..."})]}):e.jsxs(e.Fragment,{children:[C&&e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px",padding:"8px",marginBottom:"1rem",fontSize:"0.9rem",color:"#ffc107"},children:[" ",C]}),M&&e.jsx("div",{style:{background:"rgba(76, 175, 80, 0.2)",border:"2px solid rgba(76, 175, 80, 0.6)",borderRadius:"12px",padding:"16px",marginBottom:"1.5rem",fontSize:p?"1rem":"1.1rem",color:"#4caf50",fontWeight:"bold",textAlign:"center",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)",animation:"pulse 2s infinite"},children:M}),!m&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsx("h3",{style:{color:"#ff4444",margin:"0",fontSize:p?"1rem":"1.1rem"},children:" Pending Matches"}),e.jsx("button",{onClick:Je,style:{background:"rgba(255, 193, 7, 0.2)",border:"1px solid rgba(255, 193, 7, 0.4)",borderRadius:"6px",padding:p?"6px 10px":"8px 12px",color:"#ffc107",fontSize:p?"0.85rem":"0.9rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 193, 7, 0.3)"},onMouseLeave:Z=>{Z.target.style.background="rgba(255, 193, 7, 0.2)"},children:" Try Example"})]}),g.length===0?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"2rem",textAlign:"center",color:"#ccc"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:""}),e.jsx("div",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:"No pending matches!"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:"All your matches have been reported."})]}):e.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:g.map(Z=>e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:Ye=>{Ye.target.style.background="rgba(255, 255, 255, 0.08)",Ye.target.style.borderColor="rgba(255, 68, 68, 0.3)"},onMouseLeave:Ye=>{Ye.target.style.background="rgba(255, 255, 255, 0.05)",Ye.target.style.borderColor="rgba(255, 255, 255, 0.1)"},onClick:()=>ht(Z),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"1.1rem"},children:[Z.senderName," vs ",Z.receiverName]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem",marginTop:"0.25rem"},children:[" ",Ft(Z.date||Z.match_date||Z.scheduledDate)," ",Z.time?`at ${Z.time}`:""]}),Z.location&&e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[" ",Z.location]})]}),e.jsx("div",{style:{background:"rgba(255, 68, 68, 0.2)",color:"#ff4444",padding:p?"0.4rem 0.8rem":"0.5rem 1rem",borderRadius:"6px",fontSize:p?"0.85rem":"0.9rem",fontWeight:"bold"},children:"Report Result"})]})},Z._id))})]}),m&&!Ce&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[b&&e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsx("span",{style:{background:"rgba(255, 193, 7, 0.2)",border:"1px solid rgba(255, 193, 7, 0.4)",borderRadius:"4px",padding:"2px 6px",color:"#ffc107",fontSize:"0.75rem"},children:" Example Mode"})}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"6px",padding:"0.4rem 0.5rem",marginBottom:"0.4rem"},children:e.jsxs("div",{style:{color:"#ccc",fontSize:"0.85rem",display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("span",{children:[e.jsx("strong",{style:{color:"#fff"},children:m.senderName})," vs ",e.jsx("strong",{style:{color:"#fff"},children:m.receiverName})]}),e.jsxs("span",{children:[" ",(()=>{const Z=m.date||m.match_date||m.scheduledDate||m.scheduled_date;return Z?Ft(Z):"TBD"})()," ",m.time?`at ${m.time}`:""]}),m.location&&e.jsxs("span",{children:[" ",m.location]})]})}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"6px",padding:"0.35rem 0.5rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsx("span",{style:{color:"#e0e0e0",fontSize:"0.8rem"},children:"Winner pays $5 fee"}),e.jsx("button",{onClick:()=>Oe(!0),style:{background:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.4)",color:"#10b981",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(16, 185, 129, 0.3)"},onMouseLeave:Z=>{Z.target.style.background="rgba(16, 185, 129, 0.2)"},children:" View Payment Details"})]}),e.jsxs("form",{onSubmit:kt,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr":"1fr 1fr 1fr",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.2rem",fontWeight:"bold",fontSize:"0.85rem"},children:"Match Date *"}),e.jsx("input",{type:"date",value:oe,onChange:Z=>me(Z.target.value),required:!0,style:{width:"100%",padding:p?"0.4rem":"0.4rem 0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:"0.9rem"}}),p&&e.jsx("small",{style:{color:"#aaa",fontSize:"0.7rem",display:"block",marginTop:"1px"},children:"Adjust if different date"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.2rem",fontWeight:"bold",fontSize:"0.85rem"},children:"Match Format *"}),e.jsxs("select",{value:k,onChange:Z=>{R(Z.target.value),be(""),A(""),z(""),W(""),Q("")},style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:p?"0.95rem":"1rem",textAlign:"center"},children:[e.jsx("option",{value:"race-to-5",style:{background:"#000",color:"#fff"},children:"Race to 5"}),e.jsx("option",{value:"race-to-7",style:{background:"#000",color:"#fff"},children:"Race to 7"}),e.jsx("option",{value:"race-to-9",style:{background:"#000",color:"#fff"},children:"Race to 9"}),e.jsx("option",{value:"race-to-11",style:{background:"#000",color:"#fff"},children:"Race to 11"}),e.jsx("option",{value:"race-to-13",style:{background:"#000",color:"#fff"},children:"Race to 13"}),e.jsx("option",{value:"race-to-15",style:{background:"#000",color:"#fff"},children:"Race to 15"}),e.jsx("option",{value:"race-to-17",style:{background:"#000",color:"#fff"},children:"Race to 17"}),e.jsx("option",{value:"race-to-19",style:{background:"#000",color:"#fff"},children:"Race to 19"}),e.jsx("option",{value:"race-to-21",style:{background:"#000",color:"#fff"},children:"Race to 21"}),e.jsx("option",{value:"other",style:{background:"#000",color:"#fff"},children:"Other (Custom)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.2rem",fontWeight:"bold",fontSize:"0.85rem"},children:"Game Type *"}),e.jsxs("select",{value:Ae,onChange:Z=>O(Z.target.value),style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:p?"0.95rem":"1rem",textAlign:"center"},children:[e.jsx("option",{value:"8-ball",style:{background:"#000",color:"#fff"},children:"8-Ball"}),e.jsx("option",{value:"9-ball",style:{background:"#000",color:"#fff"},children:"9-Ball"}),e.jsx("option",{value:"10-ball",style:{background:"#000",color:"#fff"},children:"10-Ball"}),e.jsx("option",{value:"mixed",style:{background:"#000",color:"#fff"},children:"Mixed"})]})]})]}),k==="other"&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.5rem",fontWeight:"bold"},children:"Custom Race to *"}),e.jsx("input",{type:"number",value:U,onChange:Z=>{z(Z.target.value),be(""),A(""),W(""),Q("")},placeholder:"Enter number (e.g., 25, 50, 100)",min:"1",max:"999",style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:p?"0.95rem":"1rem"}}),e.jsx("div",{style:{color:"#999",fontSize:"0.8rem",marginTop:"0.25rem"},children:"Enter the number of games needed to win (1-999)"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr":"1fr 1.5fr",gap:"0.5rem",marginBottom:"0.5rem",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.2rem",fontWeight:"bold",fontSize:"0.85rem"},children:"Winner *"}),e.jsxs("select",{value:P,onChange:Z=>D(Z.target.value),style:{width:"100%",padding:p?"0.4rem":"0.4rem 0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:"0.9rem",textAlign:"center"},required:!0,children:[e.jsx("option",{value:"",style:{background:"#000",color:"#fff"},children:"Select winner"}),e.jsx("option",{value:m.senderName,style:{background:"#000",color:"#fff"},children:m.senderName}),e.jsx("option",{value:m.receiverName,style:{background:"#000",color:"#fff"},children:m.receiverName})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.3rem",fontWeight:"bold"},children:"Final Score *"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr":"1fr auto 1fr",gap:p?"0.5rem":"0.75rem",alignItems:"center",marginBottom:"0.5rem"},className:"score-input-grid",children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#4caf50",fontSize:"0.9rem",marginBottom:"0.25rem",fontWeight:"bold"},children:P?`${P} games won`:"Player games won"}),e.jsxs("select",{value:$,onChange:Z=>Re("winner",Z.target.value),style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:J?"2px solid #f44336":"1px solid rgba(76, 175, 80, 0.3)",background:"rgba(0, 0, 0, 0.8)",color:"#4caf50",fontSize:p?"1.1rem":"1.2rem",fontWeight:"bold",textAlign:"center"},children:[e.jsx("option",{value:"",style:{background:"#000",color:"#fff"},children:"Select"}),it().map(Z=>e.jsx("option",{value:Z,style:{background:"#000",color:"#fff"},children:Z},Z))]})]}),!p&&e.jsx("div",{style:{color:"#ccc",fontSize:"1.5rem",fontWeight:"bold",textAlign:"center",marginTop:"1.5rem"},children:"-"}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#f44336",fontSize:"0.9rem",marginBottom:"0.25rem",fontWeight:"bold"},children:P?`${P===m.senderName?m.receiverName:m.senderName} games won`:"Player games won"}),e.jsxs("select",{value:Y,onChange:Z=>Re("loser",Z.target.value),style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:J?"2px solid #f44336":"1px solid rgba(244, 67, 54, 0.3)",background:"rgba(0, 0, 0, 0.8)",color:"#f44336",fontSize:p?"1.1rem":"1.2rem",fontWeight:"bold",textAlign:"center"},children:[e.jsx("option",{value:"",style:{background:"#000",color:"#fff"},children:"Select"}),it().map(Z=>e.jsx("option",{value:Z,style:{background:"#000",color:"#fff"},children:Z},Z))]})]})]}),T&&P&&e.jsx("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"6px",padding:"0.5rem",textAlign:"center",marginBottom:"0.5rem"},children:e.jsxs("div",{style:{color:"#4caf50",fontWeight:"bold",fontSize:p?"1rem":"1.1rem"},children:[" ",P," wins: ",T]})}),J&&e.jsxs("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"6px",padding:"0.5rem",color:"#f44336",fontSize:"0.9rem",textAlign:"center"},children:[" ",J]})]})]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("label",{style:{display:"block",color:"#ccc",marginBottom:"0.2rem",fontWeight:"bold",fontSize:"0.85rem"},children:"Notes (optional)"}),e.jsx("textarea",{value:H,onChange:Z=>ue(Z.target.value),placeholder:"Additional notes...",rows:2,style:{width:"100%",padding:p?"0.45rem":"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(0, 0, 0, 0.3)",color:"#fff",fontSize:p?"0.95rem":"1rem",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"grid",gap:"0.5rem",marginTop:"0.25rem"},children:[e.jsx("button",{type:"submit",disabled:S||!P||!$||!Y||J||k==="other"&&!U,style:{background:"rgba(255, 68, 68, 0.8)",border:"none",color:"#fff",padding:p?"8px 12px":"10px 14px",borderRadius:"8px",cursor:S||!P||!$||!Y||J||k==="other"&&!U?"not-allowed":"pointer",fontSize:p?"0.95rem":"1rem",fontWeight:"bold",opacity:S||!P||!$||!Y||J||k==="other"&&!U?.6:1,transition:"all 0.2s ease"},onMouseEnter:Z=>{!S&&P&&$&&Y&&!J&&!(k==="other"&&!U)&&(Z.target.style.background="rgba(255, 68, 68, 1)")},onMouseLeave:Z=>{Z.target.style.background="rgba(255, 68, 68, 0.8)"},children:S?"Submitting...":" Report Match & Pay $5 Fee"}),e.jsx("button",{type:"button",onClick:()=>{v(null),D(""),A(""),R("race-to-5"),z(""),W(""),Q(""),ue(""),be(""),O("8-ball")},style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#ccc",padding:p?"8px 12px":"10px 14px",borderRadius:"8px",cursor:"pointer",fontSize:p?"0.95rem":"1rem",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.15)",Z.target.style.color="#fff"},onMouseLeave:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.1)",Z.target.style.color="#ccc"},children:" Back to Matches"})]})]})]}),Ce&&e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#ff4444",marginBottom:"1rem",fontSize:p?"1.15rem":"1.3rem",textAlign:"center"},children:" Pay Match Fee"}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"#fff",fontSize:p?"0.9rem":"1rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Total Amount Due"}),e.jsxs("div",{style:{color:"#4caf50",fontSize:p?"1.2rem":"1.4rem",fontWeight:"bold",marginBottom:"0.25rem"},children:["$",(()=>{var ir;const Z=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),Ye=(V==null?void 0:V.hasUnifiedAccount)===!0||((ir=c==null?void 0:c.unifiedAccount)==null?void 0:ir.hasUnifiedAccount)===!0,dt=u.phase===2,pt=!h&&!Z&&!Ye&&!dt,Tt=u.membershipFee||5;return(h?5:pt?5+Tt:5).toFixed(2)})()]}),e.jsx("div",{style:{color:"#ccc",fontSize:p?"0.75rem":"0.8rem"},children:h?"Match Fee ($5) - Promotional Period!":(()=>{var Tt;const Z=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),Ye=(V==null?void 0:V.hasUnifiedAccount)===!0||((Tt=c==null?void 0:c.unifiedAccount)==null?void 0:Tt.hasUnifiedAccount)===!0,dt=u.phase===2;return!h&&!Z&&!Ye&&!dt})()?"Match Fee ($5) + Membership Renewal ($5)":"Match Fee ($5)"})]}),e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"2px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"1rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{color:"#4caf50",fontWeight:"bold",fontSize:p?"0.95rem":"1rem"},children:[" Pay with Credits ($",I.toFixed(2)," available)"]}),e.jsx("div",{style:{color:"#4caf50",fontSize:p?"0.8rem":"0.85rem",marginTop:"0.25rem"},children:" Instant processing - No admin approval needed!"})]}),e.jsx("button",{onClick:yt()?te:()=>N(`Insufficient credits. You have $${I.toFixed(2)} but need $5.00`),disabled:!yt(),style:{background:yt()?"linear-gradient(135deg, #4caf50, #45a049)":"rgba(255, 255, 255, 0.1)",color:yt()?"#fff":"#888",border:"none",padding:p?"0.6rem 1.1rem":"0.75rem 1.5rem",borderRadius:"8px",fontSize:p?"0.85rem":"0.9rem",fontWeight:"bold",cursor:yt()?"pointer":"not-allowed",transition:"all 0.2s ease",boxShadow:yt()?"0 2px 8px rgba(76, 175, 80, 0.3)":"none",opacity:yt()?1:.6},onMouseEnter:Z=>{yt()&&(Z.target.style.background="linear-gradient(135deg, #45a049, #4caf50)",Z.target.style.boxShadow="0 4px 12px rgba(76, 175, 80, 0.4)")},onMouseLeave:Z=>{Z.target.style.background=yt()?"linear-gradient(135deg, #4caf50, #45a049)":"rgba(255, 255, 255, 0.1)",Z.target.style.boxShadow=yt()?"0 2px 8px rgba(76, 175, 80, 0.3)":"none"},children:yt()?" Pay $5":"Insufficient"})]}),!yt()&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"6px",padding:"0.75rem",marginTop:"0.5rem"},children:[e.jsxs("div",{style:{color:"#ff9800",fontSize:p?"0.8rem":"0.85rem"},children:["Need $",(5-I).toFixed(2)," more credits"]}),e.jsx("button",{onClick:()=>l(!0),style:{background:"linear-gradient(135deg, #ff9800, #f57c00)",color:"#fff",border:"none",padding:p?"0.5rem 1rem":"0.6rem 1.2rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(255, 152, 0, 0.3)"},onMouseEnter:Z=>{Z.target.style.background="linear-gradient(135deg, #f57c00, #ff9800)",Z.target.style.boxShadow="0 4px 10px rgba(255, 152, 0, 0.4)"},onMouseLeave:Z=>{Z.target.style.background="linear-gradient(135deg, #ff9800, #f57c00)",Z.target.style.boxShadow="0 2px 6px rgba(255, 152, 0, 0.3)"},children:" Buy Credits"})]})]})}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{color:"#ccc",fontSize:p?"0.9rem":"0.95rem",marginBottom:"0.75rem",textAlign:"center"},children:"Or pay with one of these methods:"}),e.jsxs("div",{style:{display:"grid",gap:"0.5rem"},children:[fe.filter(Z=>Z.id==="creditCard"||Z.id==="square").map(Z=>e.jsx("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"2px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"0.75rem",transition:"all 0.2s ease"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{color:"#2196f3",fontWeight:"bold",fontSize:p?"0.9rem":"0.95rem"},children:[" ",Z.name]}),e.jsx("div",{style:{color:"#2196f3",fontSize:p?"0.75rem":"0.8rem",marginTop:"0.25rem"},children:" Instant processing after Square approval"})]}),Z.paymentLink?e.jsxs("a",{href:Z.paymentLink,target:"_blank",rel:"noopener noreferrer",style:{background:"linear-gradient(135deg, #2196f3, #1976d2)",color:"#fff",padding:p?"0.5rem 0.8rem":"0.6rem 1rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",textDecoration:"none",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(33, 150, 243, 0.3)",textAlign:"center",display:"block"},onMouseEnter:Ye=>{Ye.target.style.background="linear-gradient(135deg, #1976d2, #2196f3)",Ye.target.style.boxShadow="0 3px 8px rgba(33, 150, 243, 0.4)"},onMouseLeave:Ye=>{Ye.target.style.background="linear-gradient(135deg, #2196f3, #1976d2)",Ye.target.style.boxShadow="0 2px 6px rgba(33, 150, 243, 0.3)"},children:["Pay $",(()=>{var rr;const Ye=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),dt=(V==null?void 0:V.hasUnifiedAccount)===!0||((rr=c==null?void 0:c.unifiedAccount)==null?void 0:rr.hasUnifiedAccount)===!0,pt=u.phase===2,Tt=!h&&!Ye&&!dt&&!pt,Wt=u.membershipFee||5;return(h?5:Tt?5+Wt:5).toFixed(0)})()]}):e.jsxs("button",{onClick:()=>Fe(Z.id),disabled:re,style:{background:re?"rgba(255, 255, 255, 0.1)":"linear-gradient(135deg, #2196f3, #1976d2)",color:"#fff",border:"none",padding:p?"0.5rem 0.8rem":"0.6rem 1rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",cursor:re?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:re?.6:1,boxShadow:re?"none":"0 2px 6px rgba(33, 150, 243, 0.3)",width:"100%"},onMouseEnter:Ye=>{re||(Ye.target.style.background="linear-gradient(135deg, #1976d2, #2196f3)",Ye.target.style.boxShadow="0 3px 8px rgba(33, 150, 243, 0.4)")},onMouseLeave:Ye=>{Ye.target.style.background=re?"rgba(255, 255, 255, 0.1)":"linear-gradient(135deg, #2196f3, #1976d2)",Ye.target.style.boxShadow=re?"none":"0 2px 6px rgba(33, 150, 243, 0.3)"},children:["Mark Paid $",(()=>{var rr;const Ye=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),dt=(V==null?void 0:V.hasUnifiedAccount)===!0||((rr=c==null?void 0:c.unifiedAccount)==null?void 0:rr.hasUnifiedAccount)===!0,pt=u.phase===2,Tt=!h&&!Ye&&!dt&&!pt,Wt=u.membershipFee||5;return(h?5:Tt?5+Wt:5).toFixed(0)})()]})]})},Z.id)),e.jsx("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"2px solid rgba(255, 68, 68, 0.4)",borderRadius:"8px",padding:"0.75rem",transition:"all 0.2s ease"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:p?"0.9rem":"0.95rem"},children:" Cash Payment (Recommended)"}),e.jsx("div",{style:{color:"#ff4444",fontSize:p?"0.75rem":"0.8rem",marginTop:"0.25rem"},children:"Drop cash in RED dropbox at Legends  Admin will verify payment"}),e.jsx("div",{style:{color:(F==null?void 0:F.trustLevel)==="trusted"?"#4caf50":(F==null?void 0:F.trustLevel)==="verified"?"#ff9800":"#ff4444",fontSize:p?"0.7rem":"0.75rem",marginTop:"0.25rem",fontWeight:"500"},children:(F==null?void 0:F.trustLevel)==="trusted"?" Instant processing":(F==null?void 0:F.trustLevel)==="verified"?" Auto-processing":" Requires admin approval"})]}),e.jsx("button",{onClick:()=>ke(),disabled:re,style:{background:re?"rgba(255, 255, 255, 0.1)":"rgba(255, 68, 68, 0.9)",color:"#fff",border:"none",padding:p?"0.5rem 0.8rem":"0.6rem 1rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",cursor:re?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:re?.6:1,boxShadow:re?"none":"0 2px 6px rgba(255, 68, 68, 0.3)",width:"100%"},onMouseEnter:Z=>{re||(Z.target.style.background="rgba(255, 68, 68, 1)",Z.target.style.boxShadow="0 3px 8px rgba(255, 68, 68, 0.4)")},onMouseLeave:Z=>{Z.target.style.background=re?"rgba(255, 255, 255, 0.1)":"rgba(255, 68, 68, 0.9)",Z.target.style.boxShadow=re?"none":"0 2px 6px rgba(255, 68, 68, 0.3)"},children:re?"Processing...":` Record Cash Payment $${(()=>{var Tt;const Z=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),Ye=(V==null?void 0:V.hasUnifiedAccount)===!0||((Tt=c==null?void 0:c.unifiedAccount)==null?void 0:Tt.hasUnifiedAccount)===!0,dt=u.phase===2;return h?"5":!h&&!Z&&!Ye&&!dt?"10":"5"})()}`})]})}),fe.filter(Z=>Z.id!=="cash"&&Z.id!=="creditCard"&&Z.id!=="square").map(Z=>e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"0.75rem",transition:"all 0.2s ease"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:p?"0.9rem":"0.95rem"},children:Z.name}),Z.username&&e.jsx("div",{style:{color:"#4caf50",fontSize:p?"0.75rem":"0.8rem",marginTop:"0.25rem"},children:Z.username}),e.jsx("div",{style:{color:(F==null?void 0:F.trustLevel)==="trusted"?"#4caf50":(F==null?void 0:F.trustLevel)==="verified"?"#ff9800":"#ff4444",fontSize:p?"0.7rem":"0.75rem",marginTop:"0.25rem",fontWeight:"500"},children:(F==null?void 0:F.trustLevel)==="trusted"?" Instant processing":(F==null?void 0:F.trustLevel)==="verified"?" Auto-processing":" Requires admin approval"})]}),Z.paymentLink?e.jsxs("a",{href:Z.paymentLink,target:"_blank",rel:"noopener noreferrer",style:{background:"rgba(76, 175, 80, 0.8)",color:"#fff",padding:p?"0.5rem 0.8rem":"0.6rem 1rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",textDecoration:"none",transition:"all 0.2s ease",textAlign:"center",display:"block"},onMouseEnter:Ye=>{Ye.target.style.background="rgba(76, 175, 80, 1)"},onMouseLeave:Ye=>{Ye.target.style.background="rgba(76, 175, 80, 0.8)"},children:["Pay $",(()=>{var rr;const Ye=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),dt=(V==null?void 0:V.hasUnifiedAccount)===!0||((rr=c==null?void 0:c.unifiedAccount)==null?void 0:rr.hasUnifiedAccount)===!0,pt=u.phase===2,Tt=!h&&!Ye&&!dt&&!pt,Wt=u.membershipFee||5;return(h?5:Tt?5+Wt:5).toFixed(0)})()]}):e.jsx("button",{onClick:()=>Fe(Z.id),disabled:re,style:{background:re?"rgba(255, 255, 255, 0.1)":"rgba(76, 175, 80, 0.8)",color:"#fff",border:"none",padding:p?"0.5rem 0.8rem":"0.6rem 1rem",borderRadius:"6px",fontSize:p?"0.8rem":"0.85rem",fontWeight:"bold",cursor:re?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:re?.6:1,width:"100%"},onMouseEnter:Ye=>{re||(Ye.target.style.background="rgba(76, 175, 80, 1)")},onMouseLeave:Ye=>{Ye.target.style.background=re?"rgba(255, 255, 255, 0.1)":"rgba(76, 175, 80, 0.8)"},children:re?"Processing...":`Mark Paid $${(()=>{var rr;const Ye=(V==null?void 0:V.isActive)||(V==null?void 0:V.hasMembership)&&((V==null?void 0:V.status)==="active"||(V==null?void 0:V.status)==="free_phase"),dt=(V==null?void 0:V.hasUnifiedAccount)===!0||((rr=c==null?void 0:c.unifiedAccount)==null?void 0:rr.hasUnifiedAccount)===!0,pt=u.phase===2,Tt=!h&&!Ye&&!dt&&!pt,Wt=u.membershipFee||5;return(h?5:Tt?5+Wt:5).toFixed(0)})()}`})]})},Z.id))]})]}),e.jsx("button",{type:"button",onClick:()=>ve(!1),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#ccc",padding:p?"8px 12px":"10px 14px",borderRadius:"8px",cursor:"pointer",fontSize:p?"0.95rem":"1rem",transition:"all 0.2s ease",width:"100%"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.15)",Z.target.style.color="#fff"},onMouseLeave:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.1)",Z.target.style.color="#ccc"},children:" Back to Match Form"})]})]})})]}),De&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e4,overflow:"auto",boxSizing:"border-box"},children:e.jsxs("div",{style:{background:"rgba(20, 20, 20, 0.95)",border:"2px solid rgba(255, 68, 68, 0.3)",borderRadius:"12px",padding:"0.75rem 1rem",maxWidth:"800px",width:"min(600px, 95vw)",maxHeight:"calc(100vh - 2rem)",overflowY:"auto",position:"relative",margin:"auto"},children:[e.jsx("button",{onClick:()=>Oe(!1),style:{position:"absolute",top:"8px",right:"12px",background:"none",border:"none",color:"#ccc",fontSize:"1.5rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 255, 255, 0.1)",Z.target.style.color="#fff"},onMouseLeave:Z=>{Z.target.style.background="none",Z.target.style.color="#ccc"},children:""}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"0.75rem"},children:[e.jsx("h2",{style:{color:"#ff4444",margin:"0 0 0.25rem 0",fontSize:"1.35rem"},children:" Payment Information"}),e.jsx("p",{style:{color:"#ccc",margin:0,fontSize:"0.85rem"},children:"Subscription and match reporting fees"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(180px, 1fr))",gap:"0.75rem",margin:"0 auto"},children:[e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#2196f3",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Monthly Membership - $5/mo"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"Includes:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsx("li",{children:"Access to all ladder divisions"}),e.jsx("li",{children:"Challenge other players"}),e.jsx("li",{children:"View ladder standings and statistics"}),e.jsx("li",{children:"Participate in tournaments and events"}),e.jsx("li",{children:"Receive notifications and updates"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Expired? Renew ($5) + match fee ($5) = $10."})]})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#4caf50",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Match Fee - $5/match"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"How it works:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsxs("li",{children:["Only the ",e.jsx("strong",{children:"winner"})," pays the $5 fee"]}),e.jsx("li",{children:"One fee per match (not per player)"}),e.jsx("li",{children:"Fee is paid when reporting the match result"}),e.jsx("li",{children:"Supports ladder and prize pools"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#ff9800",fontSize:"0.75rem"},children:"Winner pays $5; loser pays nothing."})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#ffc107",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Payment Methods"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"We accept:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsx("li",{children:"CashApp"}),e.jsx("li",{children:"Venmo"}),e.jsx("li",{children:"PayPal"}),e.jsx("li",{children:"Credit/Debit Cards (via Square)"}),e.jsx("li",{children:"Credits (pre-purchased)"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Tip: Buy credits for instant reporting!"})]})]}),e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#9c27b0",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Trust & Verification"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"Verification:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"New users:"})," Payments require admin verification (24-48 hours)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Verified users:"})," 3+ successful payments = auto-approval"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trusted:"})," 10+ payments = instant"]})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Build trust for faster processing!"})]})]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"0.75rem"},children:e.jsx("button",{onClick:()=>Oe(!1),style:{background:"rgba(255, 68, 68, 0.8)",color:"#fff",border:"none",padding:"8px 20px",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:Z=>{Z.target.style.background="rgba(255, 68, 68, 1)"},onMouseLeave:Z=>{Z.target.style.background="rgba(255, 68, 68, 0.8)"},children:"Got it! Close"})})]})})]}):null};const oX=({isOpen:n,onClose:t,pendingChallenges:r=[],sentChallenges:s=[],scheduledMatches:a=[],onViewChallenge:o,onReportMatch:i,onRescheduleRequest:l,onReportNoShow:c})=>{const[d,u]=y.useState("pending"),h=p=>{switch(p){case"challenge":return" Challenge";case"smackdown":return" SmackDown";case"ladder-jump":return" Ladder Jump";case"fast-track":return" Fast Track";default:return" Match"}};return n?e.jsx(It,{open:!0,onClose:t,title:" My Challenges",maxWidth:"680px",maxHeight:"80vh",className:"my-challenges-modal",borderColor:"#5b21b6",glowColor:"#5b21b6",children:e.jsxs("div",{className:"my-challenges-modal-content",children:[e.jsxs("div",{className:"my-challenges-tabs",children:[e.jsxs("button",{className:`my-challenges-tab ${d==="pending"?"active":""}`,onClick:()=>u("pending"),children:[" Pending (",r.length,")"]}),e.jsxs("button",{className:`my-challenges-tab ${d==="sent"?"active":""}`,onClick:()=>u("sent"),children:[" Sent (",s.length,")"]}),e.jsxs("button",{className:`my-challenges-tab ${d==="scheduled"?"active":""}`,onClick:()=>u("scheduled"),children:[" Scheduled (",a.length,")"]})]}),e.jsxs("div",{className:"my-challenges-body",children:[d==="pending"&&e.jsx("div",{className:"my-challenges-section",children:r.length===0?e.jsxs("div",{className:"my-challenges-empty",children:[e.jsx("span",{className:"my-challenges-empty-icon",children:""}),e.jsx("p",{children:"No challenges waiting for your response."})]}):e.jsx("div",{className:"my-challenges-list",children:r.map(p=>{var g,f,m,v,b,w,x;return e.jsxs("div",{className:"my-challenge-card pending",children:[e.jsxs("div",{className:"my-challenge-card-header",children:[e.jsxs("h4",{children:[(g=p.challenger)==null?void 0:g.firstName," ",(f=p.challenger)==null?void 0:f.lastName,e.jsx("span",{className:"vs",children:" vs "}),(m=p.defender)==null?void 0:m.firstName," ",(v=p.defender)==null?void 0:v.lastName]}),e.jsx("span",{className:`my-challenge-type ${p.challengeType}`,children:h(p.challengeType)})]}),e.jsxs("div",{className:"my-challenge-card-details",children:[e.jsxs("span",{children:["$",((b=p.matchDetails)==null?void 0:b.entryFee)||"0"]}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Race to ",((w=p.matchDetails)==null?void 0:w.raceLength)||"5"]}),e.jsx("span",{children:""}),e.jsx("span",{children:((x=p.matchDetails)==null?void 0:x.gameType)||"8-Ball"}),p.deadline&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Expires ",new Date(p.deadline).toLocaleDateString()]})]})]}),e.jsx("button",{className:"my-challenge-btn respond",onClick:()=>o(p),children:" Respond"})]},p._id)})})}),d==="sent"&&e.jsx("div",{className:"my-challenges-section",children:s.length===0?e.jsxs("div",{className:"my-challenges-empty",children:[e.jsx("span",{className:"my-challenges-empty-icon",children:""}),e.jsx("p",{children:"No sent challenges. Challenge another player to get started!"})]}):e.jsx("div",{className:"my-challenges-list",children:s.map(p=>{var g,f,m,v,b,w;return e.jsxs("div",{className:"my-challenge-card sent",children:[e.jsxs("div",{className:"my-challenge-card-header",children:[e.jsxs("h4",{children:[(g=p.challenger)==null?void 0:g.firstName," ",(f=p.challenger)==null?void 0:f.lastName,e.jsx("span",{className:"vs",children:" vs "}),(m=p.defender)==null?void 0:m.firstName," ",(v=p.defender)==null?void 0:v.lastName]}),e.jsx("span",{className:`my-challenge-type ${p.challengeType}`,children:h(p.challengeType)})]}),e.jsxs("div",{className:"my-challenge-card-details",children:[e.jsx("span",{className:`status-${p.status}`,children:p.status}),e.jsx("span",{children:""}),e.jsxs("span",{children:["$",((b=p.matchDetails)==null?void 0:b.entryFee)||"0"]}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Race to ",((w=p.matchDetails)==null?void 0:w.raceLength)||"5"]})]}),e.jsx("button",{className:"my-challenge-btn view",onClick:()=>o(p),children:" View Details"})]},p._id)})})}),d==="scheduled"&&e.jsx("div",{className:"my-challenges-section",children:a.length===0?e.jsxs("div",{className:"my-challenges-empty",children:[e.jsx("span",{className:"my-challenges-empty-icon",children:""}),e.jsx("p",{children:"No scheduled matches yet."})]}):e.jsx("div",{className:"my-challenges-list",children:a.map(p=>{const g=p.player1||p.winner,f=p.player2||p.loser,m=g?`${g.firstName||g.first_name||""} ${g.lastName||g.last_name||""}`.trim():p.winner_name||"Unknown",v=f?`${f.firstName||f.first_name||""} ${f.lastName||f.last_name||""}`.trim():p.loser_name||"Unknown",b=p.scheduledDate||p.match_date||p.scheduled_date,w=p.raceLength||p.race_length||"5",x=p.gameType||p.game_type||"8-Ball",j=p.matchType||p.match_type||"challenge",S=p.rescheduleCount||0,_=p.scheduledDate?new Date(p.scheduledDate):null,C=_?new Date(_.getTime()+30*60*1e3):null,N=_&&C&&new Date>=C;return e.jsxs("div",{className:"my-challenge-card scheduled",children:[e.jsxs("div",{className:"my-challenge-card-header",children:[e.jsxs("h4",{children:[m," ",e.jsx("span",{className:"vs",children:"vs"})," ",v]}),e.jsx("span",{className:`my-challenge-type ${j}`,children:h(j)})]}),e.jsxs("div",{className:"my-challenge-card-details",children:[e.jsxs("span",{children:["Race to ",w]}),e.jsx("span",{children:""}),e.jsx("span",{children:x}),e.jsx("span",{children:""}),e.jsx("span",{children:b?new Date(b).toLocaleDateString():"TBD"})]}),e.jsxs("div",{className:"my-challenge-card-actions",children:[e.jsx("button",{className:"my-challenge-btn report",onClick:()=>i(p),children:" Report Score"}),S<2&&e.jsxs("button",{className:"my-challenge-btn reschedule",onClick:()=>l(p),children:[" Reschedule (",S,"/2)"]}),N&&e.jsx("button",{className:"my-challenge-btn noshow",onClick:()=>c(p),children:" No-Show"})]})]},p._id||p.id)})})})]})]})}):null};const iX=({isOpen:n,onClose:t,match:r,currentUser:s,onForfeitSubmitted:a})=>{var N,M,E,P;const[o,i]=y.useState(""),[l,c]=y.useState(null),[d,u]=y.useState(null),[h,p]=y.useState(!1),[g,f]=y.useState(""),m=y.useRef(null),v=D=>{const T=D.target.files[0];if(!T)return;if(!T.type.startsWith("image/")){f("Please select an image file");return}if(T.size>5*1024*1024){f("Photo must be less than 5MB");return}c(T),f("");const A=new FileReader;A.onloadend=()=>{u(A.result)},A.readAsDataURL(T)},b=()=>{c(null),u(null),m.current&&(m.current.value="")},w=async()=>{var D,T,A,k;if(p(!0),f(""),!o||o.trim().length<10){f("Please provide a detailed explanation (at least 10 characters)"),p(!1);return}if(!l){f("Photo proof is required. Please upload a photo showing you at the venue."),p(!1);return}try{const R=((D=r.player1)==null?void 0:D._id)||((T=r.challenger)==null?void 0:T._id),U=((A=r.player2)==null?void 0:A._id)||((k=r.defender)==null?void 0:k._id),z=s.playerId||s._id,$=z===R?U:R,W=new FileReader;W.readAsDataURL(l),W.onloadend=async()=>{try{const Y=W.result,Q=await mt.reportForfeit({matchId:r._id,reportedBy:z,noShowPlayer:$,message:o.trim(),photoProof:Y});if(!Q.success)throw new Error(Q.error||"Failed to submit forfeit request");a&&a(Q),i(""),c(null),u(null),t()}catch(Y){console.error("Error submitting forfeit request:",Y),f(Y.message),p(!1)}},W.onerror=()=>{f("Failed to read photo file"),p(!1)}}catch(R){console.error("Error preparing forfeit request:",R),f(R.message),p(!1)}};if(!n||!r)return null;const x=((N=r.player1)==null?void 0:N._id)||((M=r.challenger)==null?void 0:M._id);(E=r.player2)!=null&&E._id||((P=r.defender)==null||P._id);const j=s.playerId||s._id,S=r.player1?`${r.player1.firstName} ${r.player1.lastName}`:r.challenger?`${r.challenger.firstName} ${r.challenger.lastName}`:"Player 1",_=r.player2?`${r.player2.firstName} ${r.player2.lastName}`:r.defender?`${r.defender.firstName} ${r.defender.lastName}`:"Player 2",C=j===x?_:S;return e.jsx(It,{open:!0,onClose:t,title:" Report No-Show",maxWidth:"600px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#f59e0b",margin:"0 0 12px 0"},children:" Forfeit Report Instructions"}),e.jsxs("ul",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0",paddingLeft:"20px"},children:[e.jsx("li",{children:"You must have waited at least 30 minutes past scheduled match time"}),e.jsx("li",{children:"Provide a detailed explanation of what happened"}),e.jsx("li",{children:"Upload a photo showing you at the venue (required proof)"}),e.jsx("li",{children:"Admin will review and approve/deny this forfeit request"})]})]}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#3b82f6",margin:"0 0 8px 0"},children:"Match Details"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Opponent:"})," ",C]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled:"})," ",new Date(r.scheduledDate).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})]}),r.venue&&e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",r.venue]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"8px",fontWeight:"bold"},children:["Explanation ",e.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),e.jsx("p",{style:{color:"#999",fontSize:"0.85rem",margin:"0 0 8px 0"},children:"Explain what happened, how long you waited, any communication attempts, etc."}),e.jsx("textarea",{value:o,onChange:D=>i(D.target.value),rows:"5",placeholder:"Example: I arrived at Legends Brews & Cues at 7:00 PM as scheduled. I waited until 7:35 PM (35 minutes). I tried calling and texting but got no response. The venue staff can confirm I was here...",style:{width:"100%",padding:"12px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical",fontFamily:"inherit"}}),o.length>0&&o.length<10&&e.jsx("p",{style:{color:"#dc2626",fontSize:"0.85rem",margin:"4px 0 0 0"},children:"Message must be at least 10 characters"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"8px",fontWeight:"bold"},children:["Photo Proof ",e.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),e.jsx("p",{style:{color:"#999",fontSize:"0.85rem",margin:"0 0 8px 0"},children:"Upload a photo showing you at the venue (table, scoreboard, check-in, etc.)"}),d?e.jsxs("div",{style:{position:"relative",border:"2px solid #10b981",borderRadius:"8px",overflow:"hidden"},children:[e.jsx("img",{src:d,alt:"Forfeit proof",style:{width:"100%",height:"auto",maxHeight:"400px",objectFit:"contain",background:"#000"}}),e.jsx("button",{type:"button",onClick:b,style:{position:"absolute",top:"10px",right:"10px",background:"rgba(220, 38, 38, 0.9)",color:"white",border:"none",borderRadius:"50%",width:"36px",height:"36px",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:""}),e.jsx("div",{style:{padding:"8px",background:"rgba(16, 185, 129, 0.1)",borderTop:"1px solid rgba(16, 185, 129, 0.3)",color:"#10b981",fontSize:"0.9rem",textAlign:"center"},children:" Photo uploaded - Ready to submit"})]}):e.jsxs("div",{children:[e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:v,style:{display:"none"}}),e.jsxs("button",{type:"button",onClick:()=>{var D;return(D=m.current)==null?void 0:D.click()},style:{width:"100%",padding:"40px",borderRadius:"8px",border:"2px dashed #666",background:"#2a2a2a",color:"#999",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:D=>{D.target.style.borderColor="#3b82f6",D.target.style.color="#3b82f6"},onMouseLeave:D=>{D.target.style.borderColor="#666",D.target.style.color="#999"},children:[" Click to Upload Photo",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"JPG, PNG, or HEIC (Max 5MB)"})]})]})]}),e.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#dc2626",margin:"0 0 8px 0"},children:" Penalties for No-Show Player"}),e.jsxs("p",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0"},children:["If approved by admin, ",C," will receive penalties based on their no-show history:"]}),e.jsxs("ul",{style:{color:"#e0e0e0",fontSize:"0.85rem",margin:"8px 0 0 0",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1st offense:"})," Forfeit loss + down 1 additional position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2nd offense (within 60 days):"})," Forfeit loss + down 2 additional positions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3rd offense (within 60 days):"})," Forfeit loss + down 1 position + 14-day suspension"]})]})]}),g&&e.jsxs("div",{style:{padding:"12px",background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"4px",color:"#ff6b6b",marginBottom:"20px",fontSize:"0.9rem"},children:[" ",g]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx("button",{onClick:t,disabled:h,style:{padding:"12px 24px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:h?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Cancel"}),e.jsx("button",{onClick:w,disabled:h||!o.trim()||o.length<10||!l,style:{padding:"12px 24px",background:h||!o.trim()||o.length<10||!l?"#666":"linear-gradient(135deg, #dc2626, #991b1b)",color:"white",border:"none",borderRadius:"4px",cursor:h||!o.trim()||o.length<10||!l?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:h?"Submitting...":"Submit Forfeit Report"})]}),e.jsx("p",{style:{color:"#999",fontSize:"0.8rem",margin:"12px 0 0 0",textAlign:"center"},children:"This report will be reviewed by an admin. You'll be notified when a decision is made."})]})})};const lX=({isOpen:n,onClose:t,match:r,currentUser:s,onRescheduleSubmitted:a})=>{var T,A;const[o,i]=y.useState([]),[l,c]=y.useState({}),[d,u]=y.useState(""),[h,p]=y.useState("19:00"),[g,f]=y.useState(""),[m,v]=y.useState(!1),[b,w]=y.useState(""),x=()=>{if(!d){w("Please select a date");return}if(o.includes(d)){w("This date is already added");return}i([...o,d]),c({...l,[d]:h}),u(""),p("19:00"),w("")},j=k=>{i(o.filter(U=>U!==k));const R={...l};delete R[k],c(R)},S=async()=>{if(v(!0),w(""),o.length===0){w("Please add at least one proposed date"),v(!1);return}if(!g||g.trim().length<5){w("Please provide a reason (at least 5 characters)"),v(!1);return}try{const k=s.playerId||s._id,R=await fetch(`${Ie}/api/reschedule/request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:r._id,requestedBy:k,proposedDates:o,proposedTimes:l,reason:g.trim()})}),U=await R.json();if(!R.ok)throw new Error(U.error||U.message||"Failed to submit reschedule request");a&&a(U),i([]),c({}),f(""),t()}catch(k){console.error("Error submitting reschedule request:",k),w(k.message)}finally{v(!1)}};if(!n||!r)return null;const _=r.rescheduleCount||0,C=_<2,N=((T=r.player1)==null?void 0:T._id)||((A=r.challenger)==null?void 0:A._id),M=s.playerId||s._id,E=r.player1?`${r.player1.firstName} ${r.player1.lastName}`:r.challenger?`${r.challenger.firstName} ${r.challenger.lastName}`:"Player 1",P=r.player2?`${r.player2.firstName} ${r.player2.lastName}`:r.defender?`${r.defender.firstName} ${r.defender.lastName}`:"Player 2",D=M===N?P:E;return e.jsx(It,{open:!0,onClose:t,title:" Request Reschedule",maxWidth:"700px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:C?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:`1px solid ${C?"rgba(16, 185, 129, 0.3)":"rgba(220, 38, 38, 0.3)"}`,borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsx("strong",{children:"Reschedules Used:"})," ",_,"/2"]}),e.jsx("span",{style:{color:C?"#10b981":"#dc2626",fontWeight:"bold",fontSize:"0.9rem"},children:C?` ${2-_} reschedule${2-_>1?"s":""} remaining`:" Limit reached"})]}),!C&&e.jsx("p",{style:{color:"#dc2626",fontSize:"0.85rem",margin:"8px 0 0 0"},children:"This match has been rescheduled the maximum number of times. Please contact admin for further rescheduling."})]}),C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 12px 0"},children:"Current Schedule"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Opponent:"})," ",D]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled:"})," ",new Date(r.scheduledDate).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})]}),r.venue&&e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",r.venue]})]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"12px"},children:"Propose New Date(s)"}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[e.jsxs("div",{style:{flex:"1"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.85rem"},children:"Date"}),e.jsx("input",{type:"date",value:d,onChange:k=>u(k.target.value),min:Hb(),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}})]}),e.jsxs("div",{style:{flex:"0.7"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.85rem"},children:"Time"}),e.jsx("input",{type:"time",value:h,onChange:k=>p(k.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}})]}),e.jsx("div",{style:{flex:"0.3",display:"flex",alignItems:"flex-end"},children:e.jsx("button",{type:"button",onClick:x,style:{width:"100%",padding:"8px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"+ Add"})})]}),o.length>0&&e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#10b981",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Proposed Dates:"}),o.map((k,R)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"4px",marginBottom:"4px"},children:[e.jsxs("span",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[new Date(k).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),l[k]&&` at ${new Date(`2000-01-01T${l[k]}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`]}),e.jsx("button",{type:"button",onClick:()=>j(k),style:{background:"#dc2626",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.85rem"},children:"Remove"})]},R))]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"8px",fontWeight:"bold"},children:["Reason for Reschedule ",e.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),e.jsx("textarea",{value:g,onChange:k=>f(k.target.value),rows:"3",placeholder:"Example: I have a work conflict and can't make the original time...",style:{width:"100%",padding:"12px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical",fontFamily:"inherit"}}),g.length>0&&g.length<5&&e.jsx("p",{style:{color:"#dc2626",fontSize:"0.85rem",margin:"4px 0 0 0"},children:"Reason must be at least 5 characters"})]}),b&&e.jsxs("div",{style:{padding:"12px",background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"4px",color:"#ff6b6b",marginBottom:"20px",fontSize:"0.9rem"},children:[" ",b]}),e.jsxs("p",{style:{color:"#999",fontSize:"0.85rem",margin:"0 0 20px 0",padding:"12px",background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"4px"},children:[" ",D," will receive your reschedule request and can accept, counter with different dates, or decline. They have 3 days to respond."]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx("button",{onClick:t,disabled:m,style:{padding:"12px 24px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:m?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Cancel"}),e.jsx("button",{onClick:S,disabled:m||o.length===0||!g.trim()||g.length<5,style:{padding:"12px 24px",background:m||o.length===0||!g.trim()||g.length<5?"#666":"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"4px",cursor:m||o.length===0||!g.trim()||g.length<5?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:m?"Submitting...":"Send Reschedule Request"})]})]}):e.jsxs("div",{style:{textAlign:"center",padding:"40px 20px"},children:[e.jsx("p",{style:{color:"#dc2626",fontSize:"1.1rem",marginBottom:"20px"},children:" This match has reached the maximum number of reschedules (2)."}),e.jsx("p",{style:{color:"#999",fontSize:"0.95rem",marginBottom:"20px"},children:"Please contact the admin if you need to reschedule this match again."}),e.jsx("button",{onClick:t,style:{padding:"12px 24px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Close"})]})]})})};const cX=({isOpen:n,onClose:t,rescheduleRequest:r,currentUser:s,onResponseSubmitted:a})=>{const[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(!1),[h,p]=y.useState([]),[g,f]=y.useState({}),[m,v]=y.useState(""),[b,w]=y.useState("19:00"),[x,j]=y.useState(""),[S,_]=y.useState(!1),[C,N]=y.useState(""),M=async()=>{var k;if(!o){N("Please select a date to accept");return}_(!0),N("");try{const R=await fetch(`${Ie}/api/reschedule/${r._id}/accept`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selectedDate:o,selectedTime:((k=r.proposedTimes)==null?void 0:k[o])||null,responseNote:l.trim()})}),U=await R.json();if(!R.ok)throw new Error(U.error||"Failed to accept reschedule");a&&a("accepted",U),t()}catch(R){console.error("Error accepting reschedule:",R),N(R.message)}finally{_(!1)}},E=async()=>{_(!0),N("");try{const k=await fetch(`${Ie}/api/reschedule/${r._id}/decline`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({responseNote:l.trim()})}),R=await k.json();if(!k.ok)throw new Error(R.error||"Failed to decline reschedule");a&&a("declined",R),t()}catch(k){console.error("Error declining reschedule:",k),N(k.message)}finally{_(!1)}},P=()=>{if(!m){N("Please select a date");return}if(h.includes(m)){N("This date is already added");return}p([...h,m]),f({...g,[m]:b}),v(""),w("19:00"),N("")},D=k=>{p(h.filter(U=>U!==k));const R={...g};delete R[k],f(R)},T=async()=>{if(h.length===0){N("Please add at least one proposed date");return}_(!0),N("");try{const k=await fetch(`${Ie}/api/reschedule/${r._id}/counter`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proposedDates:h,proposedTimes:g,reason:x.trim()||"Counter-proposal with different dates"})}),R=await k.json();if(!k.ok)throw new Error(R.error||"Failed to submit counter-proposal");a&&a("countered",R),t()}catch(k){console.error("Error submitting counter-proposal:",k),N(k.message)}finally{_(!1)}};if(!n||!r)return null;const A=r.requestedBy?`${r.requestedBy.firstName} ${r.requestedBy.lastName}`:"Opponent";return e.jsx(It,{open:!0,onClose:t,title:" Reschedule Request",maxWidth:"700px",children:e.jsx("div",{style:{padding:"20px"},children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#f59e0b",margin:"0 0 12px 0"},children:" Counter with Different Dates"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0"},children:"Propose alternative dates that work better for you"})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[e.jsx("h5",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Original Proposed Dates:"}),r.proposedDates.map((k,R)=>{var $,W;const U=new Date(k).toISOString().split("T")[0],z=(($=r.proposedTimes)==null?void 0:$[U])||((W=r.proposedTimes)==null?void 0:W[k]);return e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.85rem",marginBottom:"4px"},children:[" ",new Date(k).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),z&&` at ${new Date(`2000-01-01T${z}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`]},R)})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h5",{style:{color:"#10b981",marginBottom:"12px"},children:"Your Counter-Proposal"}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[e.jsxs("div",{style:{flex:"1"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.85rem"},children:"Date"}),e.jsx("input",{type:"date",value:m,onChange:k=>v(k.target.value),min:Hb(),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}})]}),e.jsxs("div",{style:{flex:"0.7"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.85rem"},children:"Time"}),e.jsx("input",{type:"time",value:b,onChange:k=>w(k.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff"}})]}),e.jsx("div",{style:{flex:"0.3",display:"flex",alignItems:"flex-end"},children:e.jsx("button",{type:"button",onClick:P,style:{width:"100%",padding:"8px",background:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"+ Add"})})]}),h.length>0&&e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#10b981",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Your Proposed Dates:"}),h.map((k,R)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"4px",marginBottom:"4px"},children:[e.jsxs("span",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[new Date(k).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),g[k]&&` at ${new Date(`2000-01-01T${g[k]}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`]}),e.jsx("button",{type:"button",onClick:()=>D(k),style:{background:"#dc2626",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"0.85rem"},children:"Remove"})]},R))]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Reason (Optional)"}),e.jsx("textarea",{value:x,onChange:k=>j(k.target.value),rows:"3",placeholder:"Explain why these dates work better for you...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical"}})]}),C&&e.jsxs("div",{style:{padding:"12px",background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"4px",color:"#ff6b6b",marginBottom:"20px",fontSize:"0.9rem"},children:[" ",C]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx("button",{onClick:()=>u(!1),disabled:S,style:{padding:"12px 24px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:S?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Back"}),e.jsx("button",{onClick:T,disabled:S||h.length===0,style:{padding:"12px 24px",background:S||h.length===0?"#666":"linear-gradient(135deg, #f59e0b, #d97706)",color:"white",border:"none",borderRadius:"4px",cursor:S||h.length===0?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:S?"Submitting...":"Send Counter-Proposal"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 12px 0"},children:"Current Schedule"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled:"})," ",new Date(r.currentDate).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})]})})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[e.jsxs("h4",{style:{color:"#10b981",margin:"0 0 12px 0"},children:["Proposed Dates from ",A]}),r.proposedDates.map((k,R)=>{var $,W;const U=new Date(k).toISOString().split("T")[0],z=(($=r.proposedTimes)==null?void 0:$[U])||((W=r.proposedTimes)==null?void 0:W[k]);return e.jsxs("label",{style:{display:"block",padding:"12px",background:o===U?"rgba(16, 185, 129, 0.2)":"rgba(0, 0, 0, 0.2)",border:o===U?"2px solid #10b981":"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",marginBottom:"8px",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx("input",{type:"radio",name:"selectedDate",value:U,checked:o===U,onChange:Y=>i(Y.target.value),style:{marginRight:"12px"}}),e.jsxs("span",{style:{color:"#e0e0e0",fontSize:"0.95rem"},children:[new Date(k).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),z&&` at ${new Date(`2000-01-01T${z}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`]})]},R)})]}),r.reason&&e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[e.jsx("h5",{style:{color:"#3b82f6",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Reason for Reschedule:"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0"},children:r.reason})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px"},children:"Your Response Note (Optional)"}),e.jsx("textarea",{value:l,onChange:k=>c(k.target.value),rows:"3",placeholder:"Add a note to your response...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical"}})]}),C&&e.jsxs("div",{style:{padding:"12px",background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"4px",color:"#ff6b6b",marginBottom:"20px",fontSize:"0.9rem"},children:[" ",C]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx("button",{onClick:E,disabled:S,style:{padding:"12px 24px",background:S?"#666":"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:S?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:S?"Processing...":"Decline"}),e.jsx("button",{onClick:()=>u(!0),disabled:S,style:{padding:"12px 24px",background:S?"#666":"linear-gradient(135deg, #f59e0b, #d97706)",color:"white",border:"none",borderRadius:"4px",cursor:S?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Counter"}),e.jsx("button",{onClick:M,disabled:S||!o,style:{padding:"12px 24px",background:S||!o?"#666":"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"4px",cursor:S||!o?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:S?"Processing...":o?"Accept":"Select Date First"})]})]})})})},dX=({isOpen:n,onClose:t,playerEmail:r})=>{const[s,a]=y.useState("overview"),[o,i]=y.useState(!1),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState({credits:0,totalPurchased:0,totalUsed:0,membership:null,paymentHistory:[],trustLevel:"new",stats:{}}),[g,f]=y.useState({amount:20,paymentMethod:"",customAmount:""}),[m,v]=y.useState({paymentMethod:"",duration:"monthly"}),[b,w]=y.useState([]),[x,j]=y.useState(!1),[S,_]=y.useState(!1),[C,N]=y.useState({x:0,y:0}),[M,E]=y.useState(!1),P=y.useRef({x:0,y:0});y.useEffect(()=>{if(n&&r){R(),U();const O=window.location.hash||"",oe=O.includes("?")?new URLSearchParams(O.slice(O.indexOf("?")+1)):null,me=typeof window<"u"&&window.location.search?new URLSearchParams(window.location.search):null,Ce=typeof window<"u"&&window.location.pathname||"",ve=Ce.match(/transactionId=([^&/]+)/i)||Ce.match(/transaction_id=([^&/]+)/i),De=(oe==null?void 0:oe.get("transactionId"))||(oe==null?void 0:oe.get("transaction_id"))||(me==null?void 0:me.get("transactionId"))||(me==null?void 0:me.get("transaction_id"))||(ve?ve[1]:null);let Oe=(oe==null?void 0:oe.get("credit_purchase_success"))==="1"||(me==null?void 0:me.get("credit_purchase_success"))==="1",Ze=(oe==null?void 0:oe.get("membership_purchase_success"))==="1"||(me==null?void 0:me.get("membership_purchase_success"))==="1";try{sessionStorage.getItem("credit_purchase_return")==="1"&&(Oe=!0),((oe==null?void 0:oe.get("membership_purchase_success"))==="1"||(me==null?void 0:me.get("membership_purchase_success"))==="1")&&(Ze=!0)}catch{}(De||Oe||Ze)&&(async()=>{try{if(De){const re=await fetch(`${Ie}/api/monetization/complete-credit-purchase-return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactionId:De,playerEmail:r})}),je=await re.json().catch(()=>({}));if(re.ok&&je.success){u(je.alreadyProcessed?"Credits were already added.":` Payment successful! Credits added. New balance: $${(je.newBalance||0).toFixed(2)}`),c(""),a("overview"),await R(!1);return}if(re.status===400&&(je.message||"").toLowerCase().includes("not a credit")){const Ee=await fetch(`${Ie}/api/monetization/complete-membership-purchase-return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactionId:De,playerEmail:r})}),F=await Ee.json().catch(()=>({}));if(Ee.ok&&F.membershipUpdated){u(" Membership activated! Thank you for your payment."),c(""),a("overview"),await R(!1);return}u(F.message||'Could not complete membership. Try "Check for my payment" or contact support.')}}if(Ze){const re=await fetch(`${Ie}/api/monetization/check-and-complete-membership-purchase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r})}),je=await re.json().catch(()=>({}));re.ok&&je.membershipUpdated&&(u(" Membership activated! Thank you for your payment."),c(""),a("overview")),await R(!1)}if(Oe&&!Ze){const re=await fetch(`${Ie}/api/monetization/check-and-complete-credit-purchase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r})}),je=await re.json().catch(()=>({}));re.ok&&je.success?(u(je.alreadyProcessed?"Credits were already added.":` Payment successful! $${(je.amount||0).toFixed(2)} credits added. New balance: $${(je.newBalance||0).toFixed(2)}`),c(""),a("overview"),await R(!1)):Oe&&(u(je.message||"Checking for your payment If you just paid, try opening this dashboard again in a few seconds."),c(""),R(!1))}}catch{Oe&&(u('Payment completed. If credits dont appear, click "Check for my payment" below.'),R(!1)),Ze&&(u("Payment completed. If membership does not update, open this dashboard again or contact support."),R(!1))}finally{try{sessionStorage.removeItem("credit_purchase_return")}catch{}if(Oe||Ze||De){let re=O.replace(/[?&]credit_purchase_success=1&?/g,"").replace(/[?&]membership_purchase_success=1&?/g,"").replace(/[?&]transactionId=[^&]+&?/g,"").replace(/[?&]transaction_id=[^&]+&?/g,"").replace(/[?&]orderId=[^&]+&?/g,"").replace(/\?&/,"?").replace(/\?$/,"")||"#/ladder",je=(window.location.search||"").replace(/[?&]membership_purchase_success=1&?/g,"").replace(/[?&]credit_purchase_success=1&?/g,"").replace(/[?&]transactionId=[^&]+&?/g,"").replace(/[?&]transaction_id=[^&]+&?/g,"").replace(/[?&]orderId=[^&]+&?/g,"").replace(/\?&/,"?").replace(/\?$/,"");const V=window.location.pathname||"",Ee=V.includes("transactionId")||V.includes("orderId")||V.includes("transaction_id")?"/":V;(re!==O||je!==(window.location.search||"")||Ee!==V)&&window.history.replaceState(null,"",Ee+je+re)}}})(),N({x:0,y:0})}},[n,r]),y.useEffect(()=>{if(n&&r){const O=setInterval(()=>{R(!1)},1e4);return()=>clearInterval(O)}},[n,r]);const D=O=>{E(!0),P.current={x:O.clientX-C.x,y:O.clientY-C.y},document.body.style.userSelect="none"},T=O=>{M&&N({x:O.clientX-P.current.x,y:O.clientY-P.current.y})},A=()=>{E(!1),document.body.style.userSelect=""};y.useEffect(()=>(M?(window.addEventListener("mousemove",T),window.addEventListener("mouseup",A)):(window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",A)),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",A)}),[M]);const k=async()=>{_(!0),c(""),u("Checking for your Square payment (credits or membership)");try{const O=Ie||"",[oe,me]=await Promise.all([fetch(`${O}/api/monetization/check-and-complete-credit-purchase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r})}),fetch(`${O}/api/monetization/check-and-complete-membership-purchase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r})})]),Ce=await oe.json().catch(()=>({})),ve=await me.json().catch(()=>({})),De=oe.ok&&Ce.success,Oe=me.ok&&ve.membershipUpdated,Ze=[];De&&Ze.push(Ce.alreadyProcessed?"Credits were already added.":` Credits: $${(Ce.amount||0).toFixed(2)} added. New balance: $${(Ce.newBalance||0).toFixed(2)}`),Oe&&Ze.push(" Membership activated."),Ze.length?(u(Ze.join(" ")),c("")):oe.ok&&Ce.message?u(Ce.message):me.ok&&ve.message?u(ve.message):u(Ce.message||ve.message||"No new Square payment found. If you just paid, wait a moment and try again."),await R(!0)}catch{c("Network error. Is the backend running on "+Ie+"?"),u("")}finally{_(!1)}},R=async(O=!0)=>{var oe,me;try{O&&i(!0),console.log(` Loading account data for: ${r}`),console.log(` URL: ${Ie}/api/monetization/user-payment-data/${r}`);const Ce=await fetch(`${Ie}/api/monetization/user-payment-data/${r}`);if(console.log(` Response status: ${Ce.status}`),Ce.ok){const ve=await Ce.json();console.log(" Account data loaded:",ve),p({credits:ve.credits||0,totalPurchased:ve.totalPurchased??0,totalUsed:ve.totalUsed??0,membership:ve.membership||null,paymentHistory:((oe=ve.paymentHistory)==null?void 0:oe.recentPayments)||[],trustLevel:((me=ve.paymentHistory)==null?void 0:me.trustLevel)||"new",stats:ve.paymentHistory||{}}),c("")}else{const ve=await Ce.json().catch(()=>({}));console.error(" Failed to load account data:",Ce.status,ve),p({credits:0,totalPurchased:0,totalUsed:0,membership:null,paymentHistory:[],trustLevel:"new",stats:{totalPayments:0,failedPayments:0,successRate:0}}),c("Payment system temporarily unavailable. Using default settings.")}}catch(Ce){console.error(" Network error loading account data:",Ce),p({credits:0,totalPurchased:0,totalUsed:0,membership:null,paymentHistory:[],trustLevel:"new",stats:{totalPayments:0,failedPayments:0,successRate:0}}),c("Network error. Using default settings.")}finally{i(!1)}},U=async()=>{try{const O=await fetch(`${Ie}/api/monetization/payment-methods`);if(O.ok){const oe=await O.json();w(oe.paymentMethods||[]),oe.paymentMethods.length>0&&(f(me=>({...me,paymentMethod:oe.paymentMethods[0].id})),v(me=>({...me,paymentMethod:oe.paymentMethods[0].id})))}}catch(O){console.error("Error loading payment methods:",O)}},z=async()=>{var O;try{i(!0),c("");const oe=g.customAmount?parseFloat(g.customAmount):g.amount;if(!oe||oe<5){c("Minimum purchase amount is $5.00");return}if(!g.paymentMethod){c("Please select a payment method");return}const me=g.paymentMethod==="cash",Ce=await fetch(`${Ie}/api/monetization/purchase-credits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r,amount:oe,paymentMethod:g.paymentMethod,paymentData:{source:"payment_dashboard",isCashPayment:me,notes:me?`Cash payment at Legends red dropbox - Credit purchase $${oe}`:void 0}})});if(Ce.ok){const ve=await Ce.json();if(ve.requiresRedirect&&ve.paymentUrl){u("Redirecting to Square to complete payment..."),window.location.href=ve.paymentUrl;return}((O=ve.payment)==null?void 0:O.status)==="pending_verification"?u(me?" Cash payment recorded! Please drop your payment in the red dropbox at Legends. Credits will NOT be added until admin receives and approves your payment.":" Payment recorded! Pending admin verification."):u(` Successfully purchased $${oe.toFixed(2)} in credits!`),await R(),f({amount:20,paymentMethod:g.paymentMethod,customAmount:""})}else{const ve=await Ce.json();c(ve.message||"Failed to purchase credits")}}catch(oe){console.error("Error purchasing credits:",oe),c("Network error purchasing credits")}finally{i(!1)}},$=async()=>{var O,oe;try{if(i(!0),c(""),!m.paymentMethod){c("Please select a payment method");return}const me=m.paymentMethod==="cash",Ce=m.paymentMethod==="credits",ve=wo(),De=ve.membershipFee,Oe=`Phase ${ve.phase} (${ve.name})`;if(De===0){u(" Free membership active during testing phase - no payment required!"),await R();return}if(Ce){if(h.credits<De){c(`Insufficient credits. You have $${((O=h.credits)==null?void 0:O.toFixed(2))||"0.00"} but need $${De.toFixed(2)}`);return}const re=await fetch(`${Ie}/api/monetization/use-credits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r,amount:De,description:"Monthly Ladder Membership"})});if(re.ok)u(" Membership activated successfully using credits!"),await R();else{const je=await re.json();c(je.message||"Failed to purchase membership with credits")}return}const Ze=b.find(re=>re.id===m.paymentMethod);if((Ze==null?void 0:Ze.processor)==="square"){const re=typeof window<"u"&&window.location.origin?window.location.origin+(window.location.pathname||"/"):"",je=re?`${re}?membership_purchase_success=1`:void 0,V=await fetch(`${Ie}/api/monetization/square/create-membership-link`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,playerName:(r==null?void 0:r.split("@")[0])||"Ladder Member",amount:Math.round(De*100),redirectUrl:je})});if(V.ok){const F=await V.json();if(F.url){u("Redirecting to Square to complete payment..."),window.location.href=F.url;return}}const Ee=await V.json().catch(()=>({}));c(Ee.message||"Could not start Square checkout. Try another method or try again."),i(!1);return}const et=await fetch(`${Ie}/api/monetization/record-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerEmail:r,amount:De,paymentMethod:m.paymentMethod,description:`Monthly Ladder Membership - ${Oe}`,type:"membership",requiresVerification:!1,notes:me?`Cash payment at Legends red dropbox - Membership purchase ${Oe}`:`Membership purchase via dashboard - ${Oe}`})});if(et.ok)((oe=(await et.json()).payment)==null?void 0:oe.status)==="pending_verification"?u(me?" Cash payment recorded! Please drop your payment in the red dropbox at Legends. Membership will NOT be activated until admin receives and approves your payment.":" Payment recorded! Pending admin verification."):u(" Membership activated successfully!"),await R();else{const re=await et.json();c(re.message||"Failed to purchase membership")}}catch(me){console.error("Error purchasing membership:",me),c("Network error purchasing membership")}finally{i(!1)}},W=O=>{switch(O){case"trusted":return"#4caf50";case"verified":return"#ff9800";default:return"#f44336"}},Y=(O,oe)=>{if(oe)switch(O){case"pending_verification":return" Pending Approval";case"failed":return" Rejected";default:return" Pending Approval"}switch(O){case"completed":return" Approved";case"failed":return" Rejected";case"none":return"No Recent Purchase";default:return"No Pending Payments"}},Q=(O,oe)=>{if(oe)return"Needs Admin Approval";switch(O){case"trusted":return"Instant Process";case"verified":return"Auto Process";default:return"Manual Approval Required"}},H=O=>new Date(O).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ue=()=>{var Oe,Ze,et,re,je,V,Ee;const O=wo(),{phase:oe,membershipFee:me,description:Ce,color:ve,icon:De}=O;return e.jsxs("div",{children:[e.jsxs("div",{style:{background:ve,border:`1px solid ${ve.replace("0.1","0.3")}`,borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"0.5rem",fontSize:"1.1rem"},children:[De," Current Phase: ",Ce]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[oe===1&&"Free access to all features during testing phase",oe===2&&"Trial launch with reduced pricing - 2-month cycles",oe===3&&"Full launch with complete prize pool system - 3-month cycles"]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Account Status"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem",marginBottom:"0.25rem"},children:"Available Credits"}),e.jsxs("div",{style:{color:"#4caf50",fontSize:"1.5rem",fontWeight:"bold"},children:["$",h.credits.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem",marginBottom:"0.25rem"},children:"Payment Status"}),e.jsx("div",{style:{color:W(h.trustLevel),fontSize:"0.8rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:Y(h.creditPurchaseStatus,(Oe=h.paymentHistory)==null?void 0:Oe.hasPendingPayments)})]})]}),e.jsxs("div",{style:{background:me===0||(Ze=h.membership)!=null&&Ze.isActive?"rgba(76, 175, 80, 0.1)":"rgba(255, 152, 0, 0.1)",border:`1px solid ${me===0||(et=h.membership)!=null&&et.isActive?"rgba(76, 175, 80, 0.3)":"rgba(255, 152, 0, 0.3)"}`,borderRadius:"8px",padding:"1rem"},children:[e.jsx("div",{style:{color:me===0||(re=h.membership)!=null&&re.isActive?"#4caf50":"#ff9800",fontWeight:"bold",marginBottom:"0.5rem"},children:me===0?" Free Membership Active!":(je=h.membership)!=null&&je.isActive?" Active Membership":" Membership Required"}),me===0?e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"No payment required during Phase 1 testing period"}):(V=h.membership)!=null&&V.isActive?e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:["Expires: ",H(h.membership.expiresAt)]}):e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[oe===2&&"Trial launch membership required to report matches",oe===3&&"Full membership required to report matches"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Quick Actions"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsx("button",{onClick:()=>a("credits"),style:{background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"8px",padding:"1rem",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Buy Credits"}),e.jsx("button",{onClick:()=>a("membership"),style:{background:"linear-gradient(45deg, #ff9800, #f57c00)",color:"white",border:"none",borderRadius:"8px",padding:"1rem",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:" Renew Membership"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem"},children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Payment Statistics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",color:"#ccc",fontSize:"0.9rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#4caf50",fontSize:"1.2rem",fontWeight:"bold"},children:h.stats.totalPayments||0}),e.jsx("div",{children:"Total Payments"})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{color:"#ff9800",fontSize:"1.2rem",fontWeight:"bold"},children:[((h.stats.successRate||0)*100).toFixed(0),"%"]}),e.jsx("div",{children:"Success Rate"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#2196f3",fontSize:"1.2rem",fontWeight:"bold"},children:h.stats.failedPayments||0}),e.jsx("div",{children:"Failed Payments"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",padding:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.08)",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>j(!0),onMouseEnter:F=>{F.target.style.background="rgba(255, 255, 255, 0.08)",F.target.style.borderColor="rgba(255, 255, 255, 0.15)"},onMouseLeave:F=>{F.target.style.background="rgba(255, 255, 255, 0.03)",F.target.style.borderColor="rgba(255, 255, 255, 0.08)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{color:"#fff",fontSize:"0.9rem",fontWeight:"500"},children:"Trust Level:"}),e.jsx("span",{style:{color:h.trustLevel==="trusted"?"#10b981":h.trustLevel==="verified"?"#f59e0b":"#ef4444",fontSize:"0.9rem",fontWeight:"bold"},children:Q(h.trustLevel,(Ee=h.paymentHistory)==null?void 0:Ee.hasPendingPayments)}),e.jsx("span",{style:{color:"#888",fontSize:"0.8rem"},children:""})]}),e.jsx("div",{style:{color:"#888",fontSize:"0.75rem",textAlign:"right",maxWidth:"180px"},children:h.trustLevel==="trusted"?"10+ payments, 95%+ success":h.trustLevel==="verified"?"3+ payments, 80%+ success":"New user - manual approval required"})]})]})]})},J=()=>e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Purchase Credits"}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{color:"#ccc",display:"block",marginBottom:"0.5rem"},children:"Credit Amount"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.5rem",marginBottom:"1rem"},children:[20,50,100,200].map(O=>e.jsxs("button",{onClick:()=>f(oe=>({...oe,amount:O,customAmount:""})),style:{background:g.amount===O?"rgba(76, 175, 80, 0.8)":"rgba(255, 255, 255, 0.1)",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",padding:"0.75rem",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:["$",O]},O))}),e.jsx("input",{type:"number",placeholder:"Custom amount (min $5)",value:g.customAmount,onChange:O=>f(oe=>({...oe,customAmount:O.target.value,amount:0})),style:{width:"100%",padding:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{color:"#ccc",display:"block",marginBottom:"0.5rem"},children:"Payment Method"}),e.jsxs("select",{value:g.paymentMethod,onChange:O=>f(oe=>({...oe,paymentMethod:O.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem"},children:[e.jsx("option",{value:"cash",children:" Cash Payment (Legends Red Dropbox - Pending Admin Approval)"}),b.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),e.jsx("button",{onClick:z,disabled:o,style:{width:"100%",background:o?"rgba(255, 255, 255, 0.1)":"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"8px",padding:"1rem",cursor:o?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:o?"Processing...":`Purchase $${g.customAmount||g.amount} Credits`})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"1rem"},children:[e.jsx("h4",{style:{color:"#4caf50",margin:"0 0 0.5rem 0"},children:" Why Buy Credits?"}),e.jsxs("ul",{style:{color:"#ccc",fontSize:"0.9rem",margin:0,paddingLeft:"1.5rem"},children:[e.jsx("li",{children:"Instant match fee payments - no waiting for verification"}),e.jsx("li",{children:"No need to enter payment details for each match"}),e.jsx("li",{children:"Automatic monthly membership renewal"}),e.jsx("li",{children:"Credits never expire"})]})]})]}),be=()=>{var Oe;const O=wo(),{phase:oe,membershipFee:me,description:Ce,color:ve,icon:De}=O;return e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Membership Management"}),e.jsxs("div",{style:{background:ve,border:`1px solid ${ve.replace("0.1","0.3")}`,borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"0.5rem",fontSize:"1.1rem"},children:[De," Phase ",oe,": ",Ce]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[oe===1&&"Free membership during testing phase - Full access to all features",oe===2&&"Trial launch period - 2-month membership cycles with reduced pricing",oe===3&&"Full launch with 3-month membership cycles and complete prize pool system"]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"0.75rem",fontSize:"1rem"},children:" 3-Phase Membership System"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.85rem",lineHeight:"1.4"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{style:{color:"#4caf50"},children:" Phase 1 (Testing):"})," Free access to test all features and build the community"]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{style:{color:"#ff9800"},children:" Phase 2 (Trial Launch):"})," $5/month - Reduced pricing for early adopters with 2-month cycles"]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{style:{color:"#9c27b0"},children:" Phase 3 (Full Launch):"})," $5/month - Complete prize pool system with 3-month cycles"]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.75rem",fontSize:"0.8rem"},children:[e.jsx("strong",{children:" Why the phases?"}),e.jsx("br",{})," Phase 1: Test features and build player base",e.jsx("br",{})," Phase 2: Validate pricing and system with reduced rates",e.jsx("br",{})," Phase 3: Full monetization with complete prize pool funding"]})]})]}),me>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{color:"#ccc",display:"block",marginBottom:"0.5rem"},children:"Payment Method"}),e.jsxs("select",{value:m.paymentMethod,onChange:Ze=>v(et=>({...et,paymentMethod:Ze.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem"},children:[e.jsxs("option",{value:"credits",children:[" Pay with Credits ($",((Oe=h.credits)==null?void 0:Oe.toFixed(2))||"0.00"," available)"]}),e.jsx("option",{value:"cash",children:" Cash Payment (Legends Red Dropbox - Pending Admin Approval)"}),b.map(Ze=>e.jsx("option",{value:Ze.id,children:Ze.name},Ze.id))]})]}),e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{color:"#ff9800",fontWeight:"bold",marginBottom:"0.5rem"},children:[" Membership Fee: $",me.toFixed(2),"/month",oe===1&&e.jsx("span",{style:{color:"#4caf50",fontSize:"0.8rem",marginLeft:"0.5rem"},children:" FREE!"}),oe===2&&e.jsx("span",{style:{color:"#ff9800",fontSize:"0.8rem",marginLeft:"0.5rem"},children:" Trial Pricing!"})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[h.trustLevel==="new"&&e.jsx("div",{style:{color:"#ff9800",fontWeight:"bold",marginBottom:"0.5rem"},children:" New users require admin verification"}),oe===1&&"Free access during testing phase - No payment required",oe===2&&"Trial launch pricing - Active membership required to report match results",oe===3&&"Full launch pricing - Active membership required to report match results"]})]}),e.jsx("button",{onClick:$,disabled:o,style:{width:"100%",background:o?"rgba(255, 255, 255, 0.1)":"linear-gradient(45deg, #ff9800, #f57c00)",color:"white",border:"none",borderRadius:"8px",padding:"1rem",cursor:o?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"bold"},children:o?"Processing...":`Purchase Monthly Membership ($${me.toFixed(2)})`})]}),me===0&&e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"1.5rem",textAlign:"center",color:"#4caf50"},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"0.5rem"},children:" Free Membership Active!"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#ccc"},children:"You have full access to all ladder features during the testing phase. No payment required until Phase 2 begins."})]})]})},Ae=()=>e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff",margin:"0 0 1rem 0",fontSize:"1.2rem"},children:" Payment History"}),h.paymentHistory.length===0?e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"2rem",textAlign:"center",color:"#ccc"},children:"No payment history found"}):e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:h.paymentHistory.map((O,oe)=>e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#fff"},children:O.description}),e.jsx("span",{style:{marginLeft:"1rem",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.8rem",fontWeight:"bold",background:O.type==="membership"?"rgba(76, 175, 80, 0.2)":O.type==="match_fee"?"rgba(255, 152, 0, 0.2)":"rgba(156, 39, 176, 0.2)",color:O.type==="membership"?"#4caf50":O.type==="match_fee"?"#ff9800":"#9c27b0"},children:O.type==="membership"?"MEMBERSHIP":O.type==="match_fee"?"MATCH FEE":"CREDITS"})]}),e.jsxs("span",{style:{color:"#4caf50",fontWeight:"bold",fontSize:"1.1rem"},children:["$",O.amount.toFixed(2)]})]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Method:"})," ",O.paymentMethod]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",H(O.createdAt)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{style:{color:O.status==="completed"?"#4caf50":O.status==="failed"?"#f44336":"#ff9800",marginLeft:"0.5rem"},children:O.status.toUpperCase()})]})]})]},oe))})]});return n?xr.createPortal(e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:15e3,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)",paddingTop:"120px",paddingBottom:"20px"},onClick:t,children:[e.jsxs("div",{style:{transform:`translate(${C.x}px, ${C.y}px)`,cursor:M?"grabbing":"default",background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:"1.2rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:"800px",maxWidth:"95vw",maxHeight:"calc(100vh - 160px)",display:"flex",flexDirection:"column",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",position:"relative",fontFamily:"inherit",boxSizing:"border-box"},onClick:O=>O.stopPropagation(),children:[e.jsxs("div",{onMouseDown:D,style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#e53e3e",padding:"0.3rem .5rem",borderTopLeftRadius:"1.2rem",borderTopRightRadius:"1.2rem",cursor:M?"grabbing":"grab",userSelect:"none",gap:"1rem"},children:[e.jsxs("h2",{style:{margin:0,fontSize:"1rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",color:"#fff",textShadow:"0 1px 12px #000a",flex:1},children:[" Payment Dashboard ",S&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:"normal",opacity:.9},children:" Checking..."})]}),e.jsx("button",{onClick:k,disabled:S,style:{background:S?"rgba(255,255,255,0.2)":"transparent",border:"none",color:"#fff",fontSize:"1.2rem",cursor:S?"wait":"pointer",padding:"0.35rem 0.5rem",marginRight:"10px",borderRadius:"4px"},title:"Check for recent Square payment and refresh",children:""}),e.jsx("button",{onClick:t,style:{background:"transparent",border:"none",color:"#fff",fontSize:"1.2rem",cursor:"pointer",padding:"0.2rem",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px"},onMouseEnter:O=>{O.target.style.background="rgba(255, 255, 255, 0.2)"},onMouseLeave:O=>{O.target.style.background="transparent"},children:""})]}),e.jsxs("div",{style:{padding:"1rem 0",maxHeight:"calc(100vh - 240px)",overflowY:"auto"},children:[l&&e.jsxs("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"6px",padding:"12px",marginBottom:"1rem",color:"#f44336"},children:[" ",l]}),d&&e.jsx("div",{style:{background:d.startsWith("")?"rgba(76, 175, 80, 0.25)":"rgba(76, 175, 80, 0.1)",border:"2px solid rgba(76, 175, 80, 0.5)",borderRadius:"8px",padding:"14px 16px",marginBottom:"1rem",color:"#fff",fontWeight:d.startsWith("")?"bold":"normal",fontSize:d.startsWith("")?"1.05rem":"0.95rem"},children:d}),e.jsxs("div",{style:{marginBottom:"1rem",padding:"1rem",background:"rgba(33, 150, 243, 0.15)",borderRadius:"8px",border:"2px solid rgba(33, 150, 243, 0.5)"},children:[e.jsx("div",{style:{color:"#90caf9",fontWeight:"bold",marginBottom:"0.5rem"},children:"Just paid with Square? (credits or membership)"}),e.jsx("button",{type:"button",onClick:k,disabled:S,style:{width:"100%",padding:"0.75rem 1rem",background:S?"rgba(255,255,255,0.1)":"rgba(33, 150, 243, 0.5)",color:"#fff",border:"2px solid rgba(33, 150, 243, 0.8)",borderRadius:"8px",cursor:S?"wait":"pointer",fontSize:"1rem",fontWeight:"bold"},children:S?"Checking":"Check for my payment"})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[{id:"overview",label:" Overview",icon:""},{id:"credits",label:" Credits",icon:""},{id:"membership",label:" Membership",icon:""},{id:"history",label:" History",icon:""}].map(O=>e.jsx("button",{onClick:()=>a(O.id),style:{background:s===O.id?"rgba(76, 175, 80, 0.8)":"transparent",color:s===O.id?"#fff":"#ccc",border:"none",borderRadius:"6px 6px 0 0",padding:"0.75rem 1rem",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold",transition:"all 0.2s ease"},children:O.label},O.id))}),s==="overview"&&ue(),s==="credits"&&J(),s==="membership"&&be(),s==="history"&&Ae()]})]}),x&&xr.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:25e3,backdropFilter:"blur(5px)",padding:"1rem"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"12px",padding:window.innerWidth<=768?"1.5rem":"2rem",width:"40vw",maxHeight:"90vh",overflowY:"auto",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.5)",position:"relative"},children:[e.jsx("button",{onClick:()=>j(!1),style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 255, 255, 0.1)",border:"none",color:"#fff",fontSize:"1.2rem",cursor:"pointer",padding:"0.5rem",borderRadius:"50%",width:"2rem",height:"2rem",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s ease"},onMouseEnter:O=>O.target.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:O=>O.target.style.background="rgba(255, 255, 255, 0.1)",children:""}),e.jsx("h2",{style:{color:"#fff",marginBottom:"1.2rem",fontSize:window.innerWidth<=768?"1.5rem":"1.8rem",textAlign:"center",marginTop:"0.5rem"},children:" Trust System Explained"}),e.jsxs("div",{style:{color:"#ccc",lineHeight:"1.6"},children:[e.jsxs("p",{style:{marginBottom:"1.2rem",fontSize:window.innerWidth<=768?"1rem":"1.1rem",textAlign:"center"},children:["Our trust system determines how quickly your ",e.jsx("strong",{children:"cash, Venmo, and Cash App payments"})," are processed. Credit card payments through Square are always processed instantly."]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.15)",borderRadius:"8px",padding:"1rem",border:"2px solid rgba(16, 185, 129, 0.3)",marginBottom:"1rem"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"0.7rem",fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",textAlign:"center"},children:" Credit Cards & Credits"}),e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.95rem":"1rem",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Credit cards processed instantly through Square"}),e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Use credits for instant processing"}),e.jsx("div",{style:{marginBottom:"0.4rem"},children:" No trust level required"}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"#888",marginTop:"0.6rem"},children:[e.jsx("strong",{children:"Note:"})," Credit cards verified by Square  Credits verified by system"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"repeat(3, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",padding:"1rem",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsx("h4",{style:{color:"#ef4444",marginBottom:"0.7rem",fontSize:window.innerWidth<=768?"1.05rem":"1.2rem",textAlign:"center"},children:" New User"}),e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.9rem":"0.95rem",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Manual approval required"}),e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Admin verification needed"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#888",marginTop:"0.6rem"},children:e.jsx("strong",{children:"0-2 payments"})})]})]}),e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",borderRadius:"8px",padding:"1rem",border:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsx("h4",{style:{color:"#f59e0b",marginBottom:"0.7rem",fontSize:window.innerWidth<=768?"1.05rem":"1.2rem",textAlign:"center"},children:" Verified User"}),e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.9rem":"0.95rem",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Auto-processing"}),e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Faster processing"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#888",marginTop:"0.6rem"},children:e.jsx("strong",{children:"3+ payments, 80%+ success"})})]})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",borderRadius:"8px",padding:"1rem",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsx("h4",{style:{color:"#10b981",marginBottom:"0.7rem",fontSize:window.innerWidth<=768?"1.05rem":"1.2rem",textAlign:"center"},children:" Trusted User"}),e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.9rem":"0.95rem",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"0.4rem"},children:" Instant processing"}),e.jsx("div",{style:{marginBottom:"0.4rem"},children:" No approval needed"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#888",marginTop:"0.6rem"},children:e.jsx("strong",{children:"10+ payments, 95%+ success"})})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"1rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"0.7rem",fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",textAlign:"center"},children:" Tips to Improve Your Trust Level:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"repeat(2, 1fr)",gap:"0.6rem",fontSize:window.innerWidth<=768?"0.95rem":"1rem",textAlign:"center"},children:[e.jsx("div",{children:" Make payments on time"}),e.jsx("div",{children:" Use consistent payment methods"}),e.jsx("div",{children:" Avoid failed payments"}),e.jsx("div",{children:" Build positive payment history"}),e.jsx("div",{style:{gridColumn:window.innerWidth<=768?"1":"1 / -1",color:"#10b981",fontWeight:"bold",marginTop:"0.3rem"},children:" Use credit cards or credits for instant processing!"})]})]})]})]})}),document.body)]}),document.body):null};const uX=({isOpen:n,onClose:t,onPermissionGranted:r})=>{const[s,a]=y.useState(null),[o,i]=y.useState(!1);y.useEffect(()=>{n&&a(ls.getStatus())},[n]);const l=async()=>{i(!0);try{const d=await ls.requestPermission();a(ls.getStatus()),d&&(ls.showNotification(" Notifications Enabled!","You'll now receive instant alerts for challenges and counter-proposals!",{requireInteraction:!0}),r&&r())}catch(d){console.error("Error requesting notification permission:",d)}finally{i(!1)}},c=()=>{ls.disableNotifications(),a(ls.getStatus()),t()};return!n||!s?null:e.jsx("div",{className:"notification-modal-overlay",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:window.innerWidth<=768?"180px":"120px",zIndex:1e5,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"},children:e.jsxs("div",{className:"notification-modal-container",onClick:d=>d.stopPropagation(),style:{background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",color:"#fff",border:"2px solid #e53e3e",borderRadius:window.innerWidth<=768?"0.5rem":"1.2rem",boxShadow:"0 0 32px #e53e3e, 0 0 40px rgba(0,0,0,0.85)",width:window.innerWidth<=768?"95vw":"400px",maxWidth:window.innerWidth<=768?"95vw":"400px",minWidth:window.innerWidth<=768?"320px":"400px",margin:"0 auto",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,position:"relative",fontFamily:"inherit",boxSizing:"border-box",maxHeight:"60vh",display:"flex",flexDirection:"column",overflowY:"auto"},role:"dialog","aria-modal":"true","aria-label":"Enable Notifications",tabIndex:-1,children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#e53e3e",padding:"0.5rem 1rem",borderTopLeftRadius:window.innerWidth<=768?"0.5rem":"1.2rem",borderTopRightRadius:window.innerWidth<=768?"0.5rem":"1.2rem",position:"relative",userSelect:"none",gap:"1rem"},children:e.jsx("h2",{style:{margin:0,fontSize:window.innerWidth<=768?"1rem":"1.1rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0,color:"#fff"},children:" Enable Notifications"})}),e.jsxs("div",{className:"notification-permission-modal",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx("div",{className:"notification-icon",children:""}),e.jsx("h3",{children:"Stay Updated with Instant Alerts!"})]}),e.jsxs("div",{className:"notification-benefits",children:[e.jsx("h4",{children:"Get notified instantly when:"}),e.jsxs("ul",{children:[e.jsx("li",{children:" Someone challenges you to a match"}),e.jsx("li",{children:" Your challenges are accepted or declined"}),e.jsx("li",{children:" Players submit counter-proposals"}),e.jsx("li",{children:" You have upcoming matches"}),e.jsx("li",{children:" Your ladder position changes"})]})]}),e.jsxs("div",{className:"notification-status",children:[s.permission==="granted"&&e.jsx("div",{className:"status-success",children:" Notifications are enabled! You'll receive instant alerts."}),s.permission==="denied"&&e.jsx("div",{className:"status-error",children:" Notifications are blocked. You can enable them in your browser settings."}),s.permission==="default"&&e.jsx("div",{className:"status-pending",children:' Click "Enable Notifications" to get instant alerts!'})]}),e.jsxs("div",{className:"notification-actions",children:[s.permission==="default"&&e.jsx("button",{onClick:l,disabled:o,className:"enable-notifications-btn",children:o?"Requesting...":" Enable Notifications"}),s.permission==="granted"&&e.jsx("button",{onClick:t,className:"close-btn",children:" All Set!"}),s.permission==="denied"&&e.jsx("button",{onClick:t,className:"close-btn",children:"Maybe Later"}),e.jsx("button",{onClick:c,className:"dismiss-btn",children:"Don't Ask Again"})]}),e.jsx("div",{className:"notification-footer",children:e.jsx("p",{children:e.jsx("small",{children:"You can change notification settings anytime in your browser or app preferences."})})})]})]})})};const hX=()=>{const[n,t]=y.useState(null),[r,s]=y.useState(!0),[a,o]=y.useState(!0);y.useEffect(()=>{i()},[]);const i=async()=>{try{const c=await fetch(`${Ie}/api/monetization/promotional-config`);if(c.ok){const d=await c.json();t(d.config)}}catch(c){console.error("Error fetching promotional config:",c)}finally{s(!1)}},l=()=>{o(!1)};return r||!n||!n.isPromotionalPeriod||!a?null:e.jsxs("div",{className:"promotional-pricing-banner",children:[e.jsxs("div",{className:"promotional-content",children:[e.jsxs("div",{className:"promotional-text",children:[e.jsx("div",{className:"promotional-title",children:n.promotionalMessage}),e.jsx("div",{className:"match-fees-note",children:"Match fees apply."}),e.jsx("div",{className:"promotional-details",children:e.jsxs("div",{className:"pricing-info",children:[e.jsx("span",{className:"free-membership",children:"$5/month membership"}),e.jsx("span",{className:"match-fee",children:"$5 per match ($3 to prize pool, $2 platform)"})]})})]}),e.jsx("div",{className:"promotional-actions",children:e.jsx("button",{onClick:l,className:"dismiss-btn",title:"Dismiss this banner",children:""})})]}),e.jsx("div",{className:"promotional-footer",children:e.jsx("div",{className:"prize-pool-info",children:n.daysUntilPrizePoolStarts>0?e.jsxs("span",{className:"prize-pool-countdown",children:["Prize fund starts in ",n.daysUntilPrizePoolStarts," days"]}):e.jsx("span",{className:"prize-pool-active",children:" Prize fund is now active!"})})})]})},pX=({isOpen:n,onClose:t,tournament:r})=>{if(!n)return null;const s=(r==null?void 0:r.round_robin_type)==="double"?"Double":(r==null?void 0:r.round_robin_type)==="triple"?"Triple":"Single";return xr.createPortal(e.jsx("div",{onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001,padding:"1rem"},children:e.jsxs("div",{onClick:a=>a.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"800px",width:"100%",maxHeight:"90vh",overflow:"auto",border:"2px solid #8b5cf6",boxShadow:"0 0 30px rgba(139, 92, 246, 0.5)",position:"relative"},children:[e.jsx("button",{onClick:t,style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 68, 68, 0.2)",border:"1px solid #ff4444",color:"#ff4444",padding:"0.5rem 1rem",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:" Close"}),e.jsxs("div",{style:{marginBottom:"2rem",paddingRight:"80px"},children:[e.jsx("h2",{style:{color:"#8b5cf6",margin:"0 0 0.5rem 0",fontSize:"2rem"},children:" Tournament Rules & Format"}),e.jsxs("div",{style:{color:"#00ff00",fontSize:"1.2rem",fontWeight:"bold"},children:[s," Round Robin with Cash Climb"]})]}),e.jsxs("section",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#ffc107",marginBottom:"1rem",fontSize:"1.4rem"},children:" How It Works"}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[e.jsxs("h4",{style:{color:"#8b5cf6",marginBottom:"0.75rem",fontSize:"1.1rem"},children:["Phase 1: ",s," Round Robin"]}),e.jsxs("ul",{style:{color:"#e0e0e0",marginLeft:"1.5rem",lineHeight:"1.8"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Everyone plays everyone"})," ",s==="Double"?"twice":s==="Triple"?"three times":"once"]}),e.jsx("li",{children:e.jsx("strong",{children:"Win = +$1 to your prize money"})}),e.jsx("li",{children:e.jsx("strong",{children:"Lose = Elimination point"})}),e.jsxs("li",{children:[e.jsx("strong",{children:"Get 2 losses? You're eliminated"})," (can't advance to Cash Climb)"]}),e.jsx("li",{children:"Players with 0 or 1 losses advance to the final round"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"12px",padding:"1.5rem"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"0.75rem",fontSize:"1.1rem"},children:" Phase 2: Cash Climb (Final Round)"}),e.jsxs("ul",{style:{color:"#e0e0e0",marginLeft:"1.5rem",lineHeight:"1.8"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Players with 0 or 1 losses"})," compete for 1st place prize"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Single-elimination bracket"})," - lose once and you're out"]}),e.jsx("li",{children:e.jsx("strong",{children:"Winner takes the 1st place prize!"})}),e.jsx("li",{children:"If only ONE player has 0-1 losses, they automatically win 1st place"})]})]})]}),e.jsxs("section",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#ffc107",marginBottom:"1rem",fontSize:"1.4rem"},children:" Prize Structure"}),e.jsx("div",{style:{background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"12px",padding:"1.5rem"},children:e.jsxs("div",{style:{color:"#e0e0e0",lineHeight:"1.8"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("strong",{style:{color:"#00ff00"},children:" $1 per win"})," - Everyone earns $1 for every match they win"]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("strong",{style:{color:"#ffd700"},children:" 1st Place"})," - Cash Climb champion receives the biggest prize"]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("strong",{style:{color:"#c0c0c0"},children:" Remaining Prize Pool"})," - Split among all players based on their wins"]}),e.jsxs("div",{style:{marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid rgba(255, 255, 255, 0.2)",fontSize:"0.95rem",color:"#ccc"},children:[e.jsx("strong",{children:"Example:"})," Win 5 matches = $5 guaranteed + your share of remaining pool + 1st place prize if you win Cash Climb!"]})]})})]}),e.jsxs("section",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#ffc107",marginBottom:"1rem",fontSize:"1.4rem"},children:" Entry Fee Breakdown"}),e.jsx("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"12px",padding:"1.5rem"},children:e.jsxs("div",{style:{color:"#e0e0e0",lineHeight:"1.8"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsx("span",{children:e.jsx("strong",{children:" Entry Fee:"})}),e.jsx("span",{style:{color:"#fff",fontSize:"1.2rem",fontWeight:"bold"},children:"$20"})]}),e.jsxs("div",{style:{marginLeft:"1.5rem",fontSize:"0.95rem",color:"#ccc"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{children:" Tournament Prize Pool:"}),e.jsx("span",{children:"$10"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:" Ladder Prize Pool (quarterly):"}),e.jsx("span",{children:"$10"})]})]})]})})]}),e.jsxs("section",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#ffc107",marginBottom:"1rem",fontSize:"1.4rem"},children:" Match Format"}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem"},children:e.jsxs("div",{style:{color:"#e0e0e0",lineHeight:"1.8"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("strong",{style:{color:"#00ff00"},children:"Game Type:"})," ",(r==null?void 0:r.game_type)||"8-Ball"]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("strong",{style:{color:"#00ff00"},children:"Race To:"})," 5 games (first to win 5 games wins the match)"]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#00ff00"},children:"Call Your Shots:"})," Yes (standard tournament rules)"]})]})})]}),e.jsxs("section",{children:[e.jsx("h3",{style:{color:"#ffc107",marginBottom:"1rem",fontSize:"1.4rem"},children:" Important Notes"}),e.jsx("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"12px",padding:"1.5rem"},children:e.jsxs("ul",{style:{color:"#e0e0e0",marginLeft:"1.5rem",lineHeight:"1.8",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Be on time!"})," Late arrivals may result in forfeits"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2 losses = elimination"})," from Cash Climb contention"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Sportsmanship matters"})," - Respect your opponents"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin decisions are final"})," on disputed calls"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"All prize money paid within 7 days"})," after tournament completion"]})]})})]}),e.jsxs("div",{style:{marginTop:"2rem",paddingTop:"1.5rem",borderTop:"2px solid rgba(139, 92, 246, 0.3)",textAlign:"center"},children:[e.jsx("div",{style:{color:"#8b5cf6",fontSize:"1.1rem",marginBottom:"0.5rem"},children:"Questions? Contact the tournament director!"}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Good luck and have fun! "})]})]})}),document.body)},iN=({isOpen:n,onClose:t,tournamentId:r,currentUser:s,onRegistrationComplete:a})=>{const[o,i]=y.useState(null),[l,c]=y.useState([]),[d,u]=y.useState(!0),[h,p]=y.useState(!1),[g,f]=y.useState(null),[m,v]=y.useState(!1),[b,w]=y.useState(!1);y.useEffect(()=>{n&&r&&x()},[n,r]);const x=async()=>{u(!0),f(null);try{const E=await Gr.getTournamentById(r);E.success&&i(E.data);const P=await Gr.getTournamentRegistrations(r);if(P.success&&(c(P.data),s&&s.email)){const D=P.data.find(T=>T.email&&T.email.toLowerCase()===s.email.toLowerCase());v(!!D)}}catch(E){console.error("Error fetching tournament data:",E),f("Failed to load tournament information")}finally{u(!1)}},j=async()=>{if(!s){f("You must be logged in to register");return}if(!s.email){f("Your account is missing an email address");return}p(!0),f(null);try{const E=s.id||s.email,P={tournament_id:r,player_id:E,player_name:`${s.firstName||""} ${s.lastName||""}`.trim(),email:s.email,fargo_rate:s.fargoRate||500,payment_status:"pending",payment_amount:o.entry_fee};console.log(" Registering player:",P);const D=await Gr.registerPlayer(P);D.success?(v(!0),a&&a(D.data),x()):f(D.error||"Failed to register for tournament")}catch(E){console.error("Registration error:",E),f("An error occurred during registration")}finally{p(!1)}},S=E=>new Date(E).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}),_=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),C=E=>{switch(E){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return E}},N=l.filter(E=>E.payment_status==="paid"),M=o?Math.ceil((new Date(o.tournament_date)-new Date)/(1e3*60*60*24)):0;return n?xr.createPortal(e.jsx("div",{className:"tournament-registration-modal",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem"},children:e.jsxs("div",{onClick:E=>E.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflow:"auto",border:"2px solid #00ff00",boxShadow:"0 0 30px rgba(0, 255, 0, 0.3)"},children:[e.jsx("button",{onClick:t,style:{position:"absolute",top:"1rem",right:"1rem",background:"rgba(255, 0, 0, 0.2)",border:"1px solid rgba(255, 0, 0, 0.5)",color:"#ff4444",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"1.2rem",display:"flex",alignItems:"center",justifyContent:"center"},children:""}),d?e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx("div",{style:{color:"#00ff00",fontSize:"1.2rem"},children:"Loading tournament..."})}):o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"2rem",textAlign:"center"},children:[e.jsx("h2",{style:{color:"#00ff00",margin:"0 0 0.5rem 0",fontSize:"1.8rem"},children:" Tournament Registration"}),e.jsxs("h3",{style:{color:"#8b5cf6",margin:0,fontSize:"1.4rem"},children:[C(o.ladder_name)," Ladder"]})]}),e.jsx("div",{style:{background:"rgba(0, 255, 0, 0.05)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",border:"1px solid rgba(0, 255, 0, 0.2)"},children:e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginBottom:"0.25rem"},children:" Date & Time"}),e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem"},children:S(o.tournament_date)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginBottom:"0.25rem"},children:" Format"}),e.jsxs("div",{style:{color:"#fff",fontSize:"1.1rem"},children:[o.round_robin_type==="double"?"Double":o.round_robin_type==="triple"?"Triple":"Single"," Round Robin","  ",o.game_type]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginBottom:"0.25rem"},children:" Entry Fee"}),e.jsx("div",{style:{color:"#fff",fontSize:"1.3rem",fontWeight:"bold"},children:_(o.entry_fee)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginBottom:"0.25rem"},children:" Prize Pool"}),e.jsx("div",{style:{color:"#ffd700",fontSize:"1.3rem",fontWeight:"bold"},children:_(o.total_prize_pool)})]})]}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"0.9rem",color:"#ccc"},children:[" Entry fee split: $",o.entry_fee/2," to tournament prizes, $",o.entry_fee/2," seeds the next 3-month ladder prize pool"]}),e.jsx("button",{onClick:()=>w(!0),style:{width:"100%",background:"linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)",border:"none",borderRadius:"12px",padding:"1rem",color:"#fff",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",marginTop:"1rem",transition:"all 0.2s ease"},onMouseEnter:E=>{E.target.style.transform="scale(1.02)",E.target.style.boxShadow="0 0 20px rgba(139, 92, 246, 0.5)"},onMouseLeave:E=>{E.target.style.transform="scale(1)",E.target.style.boxShadow="none"},children:" View Tournament Rules & Format"})]})}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem"},children:"Registered Players"}),e.jsx("div",{style:{color:"#fff",fontSize:"1.5rem",fontWeight:"bold"},children:N.length})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem"},children:"Days Until Tournament"}),e.jsx("div",{style:{color:"#ffc107",fontSize:"1.5rem",fontWeight:"bold"},children:M})]})]})}),g&&e.jsx("div",{style:{background:"rgba(255, 0, 0, 0.1)",border:"1px solid rgba(255, 0, 0, 0.3)",borderRadius:"8px",padding:"1rem",marginBottom:"1.5rem",color:"#ff4444",textAlign:"center"},children:g}),m?e.jsxs("div",{style:{background:"rgba(0, 255, 0, 0.1)",border:"2px solid rgba(0, 255, 0, 0.5)",borderRadius:"12px",padding:"1.5rem",textAlign:"center",color:"#00ff00",fontSize:"1.2rem",fontWeight:"bold"},children:[" You're Registered!",e.jsx("div",{style:{fontSize:"0.9rem",marginTop:"0.5rem",opacity:.8},children:"See you at the tournament!"})]}):e.jsx("button",{onClick:j,disabled:h||o.status!=="registration",style:{width:"100%",background:o.status==="registration"?"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)":"rgba(100, 100, 100, 0.3)",border:"none",borderRadius:"12px",padding:"1.5rem",color:o.status==="registration"?"#000":"#666",fontSize:"1.3rem",fontWeight:"bold",cursor:o.status==="registration"?"pointer":"not-allowed",transition:"all 0.2s ease"},onMouseEnter:E=>{o.status==="registration"&&!h&&(E.target.style.transform="scale(1.02)",E.target.style.boxShadow="0 0 20px rgba(0, 255, 0, 0.5)")},onMouseLeave:E=>{E.target.style.transform="scale(1)",E.target.style.boxShadow="none"},children:h?"Registering...":o.status!=="registration"?"Registration Closed":"Register Now"}),N.length>0&&e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsxs("h4",{style:{color:"#00ff00",marginBottom:"1rem"},children:["Registered Players (",N.length,")"]}),e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"1rem",maxHeight:"200px",overflowY:"auto"},children:N.map((E,P)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",borderBottom:P<N.length-1?"1px solid rgba(255, 255, 255, 0.1)":"none"},children:[e.jsx("span",{style:{color:"#fff"},children:E.player_name}),E.fargo_rate&&e.jsxs("span",{style:{color:"#00ff00",fontSize:"0.9rem"},children:[E.fargo_rate," Fargo"]})]},E.id))})]})]}):e.jsx("div",{style:{textAlign:"center",color:"#ff4444",padding:"2rem"},children:"Tournament not found"}),e.jsx(pX,{isOpen:b,onClose:()=>w(!1),tournament:o})]})}),document.body):null},mX=({ladderName:n,currentUser:t})=>{const[r,s]=y.useState(null),[a,o]=y.useState(!0),[i,l]=y.useState(!1),[c,d]=y.useState(!1);y.useEffect(()=>{u()},[n]);const u=async()=>{o(!0);try{const v=await Gr.getUpcomingTournament(n);if(v.success&&v.data&&(s(v.data),t&&t.email)){const b=await Gr.getTournamentRegistrations(v.data.id);if(b.success){const w=b.data.find(x=>x.email&&x.email.toLowerCase()===t.email.toLowerCase());d(!!w)}}}catch(v){console.error("Error fetching tournament:",v)}finally{o(!1)}},h=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),p=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),g=v=>Math.ceil((new Date(v)-new Date)/864e5);if(a||!r)return null;const f=g(r.tournament_date),m=f<=7;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>l(!0),style:{background:m?"linear-gradient(135deg, #ff4444 0%, #cc0000 100%)":"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",cursor:"pointer",border:m?"2px solid #ff6666":"2px solid #00ff00",boxShadow:m?"0 4px 20px rgba(255, 68, 68, 0.3)":"0 4px 20px rgba(0, 255, 0, 0.3)",transition:"all 0.2s ease",position:"relative",overflow:"hidden"},onMouseEnter:v=>{v.currentTarget.style.transform="scale(1.02)",v.currentTarget.style.boxShadow=m?"0 6px 30px rgba(255, 68, 68, 0.5)":"0 6px 30px rgba(0, 255, 0, 0.5)"},onMouseLeave:v=>{v.currentTarget.style.transform="scale(1)",v.currentTarget.style.boxShadow=m?"0 4px 20px rgba(255, 68, 68, 0.3)":"0 4px 20px rgba(0, 255, 0, 0.3)"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent)",animation:"shimmer 3s infinite"}}),e.jsxs("div",{style:{position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#000",margin:0,fontSize:"1.5rem",fontWeight:"bold",textShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:" Upcoming Tournament"}),e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Click to view details and register"})]}),c&&e.jsx("div",{style:{background:"rgba(0,0,0,0.2)",padding:"0.5rem 1rem",borderRadius:"20px",color:"#000",fontWeight:"bold",fontSize:"0.9rem"},children:" Registered"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginBottom:"0.25rem"},children:" Date"}),e.jsx("div",{style:{color:"#000",fontSize:"1.1rem",fontWeight:"bold"},children:h(r.tournament_date)})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginBottom:"0.25rem"},children:" Days Until"}),e.jsx("div",{style:{color:"#000",fontSize:"1.5rem",fontWeight:"bold",animation:m?"pulse 2s infinite":"none"},children:f})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginBottom:"0.25rem"},children:" Entry"}),e.jsx("div",{style:{color:"#000",fontSize:"1.1rem",fontWeight:"bold"},children:p(r.entry_fee)})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginBottom:"0.25rem"},children:" Prize Pool"}),e.jsx("div",{style:{color:"#000",fontSize:"1.1rem",fontWeight:"bold"},children:p(r.total_prize_pool)})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.75rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginBottom:"0.25rem"},children:" Registered"}),e.jsx("div",{style:{color:"#000",fontSize:"1.1rem",fontWeight:"bold"},children:r.total_players||0})]})]}),!c&&e.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(0,0,0,0.3)",borderRadius:"8px",textAlign:"center",color:"#000",fontWeight:"bold",fontSize:"1.1rem"},children:" Click to Register Now!"})]})]}),e.jsx(iN,{isOpen:i,onClose:()=>l(!1),tournamentId:r==null?void 0:r.id,currentUser:t,onRegistrationComplete:()=>{d(!0),u()}}),e.jsx("style",{children:`
        @keyframes shimmer {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }
        @keyframes pulse {
          0%, 100% { transform: scale(1); opacity: 1; }
          50% { transform: scale(1.1); opacity: 0.8; }
        }
      `})]})},lN=document.createElement("style");lN.textContent=`
  @keyframes pulse {
    0%, 100% { box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3); }
    50% { box-shadow: 0 4px 25px rgba(139, 92, 246, 0.5); }
  }
`;typeof document<"u"&&document.head.appendChild(lN);const fX=({isOpen:n,onClose:t,tournament:r=null})=>{var s;return n?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px 20px",zIndex:1e3,overflow:"auto"},children:e.jsxs("div",{style:{backgroundColor:"rgba(20, 20, 20, 0.95)",borderRadius:"12px",padding:"1rem",maxWidth:"450px",width:"50%",height:"80vh",overflowY:"auto",border:"2px solid #8b5cf6",boxShadow:"0 10px 30px rgba(139, 92, 246, 0.3)",WebkitOverflowScrolling:"touch",margin:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",position:"relative"},children:[e.jsxs("h2",{style:{color:"#00aa00",margin:0,fontSize:"2rem",fontWeight:"bold"},children:[" Cash Climb ",r&&r.title||"Tournament Info"]}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"1.5rem",cursor:"pointer",padding:"0.5rem",position:"absolute",right:"0",top:"50%",transform:"translateY(-50%)"},children:""})]}),e.jsxs("div",{style:{color:"#fff",lineHeight:"1.6"},children:[r&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#8b5cf6",marginBottom:"0.5rem",fontSize:"1rem"},children:" Tournament Details"}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Date:"})," ",new Date(r.tournament_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Entry Fee:"})," $",r.entry_fee||20]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Format:"})," ",r.format||"Double Round Robin"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Registered Players:"})," ",((s=r.registrations)==null?void 0:s.length)||0]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Status:"})," ",r.status||"Registration Open"]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#8b5cf6",marginBottom:"0.5rem",fontSize:"1.5rem"},children:" Format"}),e.jsx("div",{style:{background:"rgba(139, 92, 246, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:r?e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Format:"})," ",r.format||"Double Round Robin"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Game:"})," ",r.game_type||"8-Ball Pool"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Race to:"})," ",r.race_to||"5"," games per match"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Elimination:"})," ",r.elimination_rule||"3-Loss Elimination"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Call Shots:"})," ",r.call_shots?"Yes":"No"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.95rem",lineHeight:"1.4"},children:[e.jsx("strong",{style:{color:"#ffc107"},children:"Phase 1: Round Robin"}),e.jsx("br",{}),"Matches are scheduled as if everyone would play everyone else (single, double, or triple times depending on player count).",e.jsx("br",{}),"Each match you ",e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:"WIN"})," earns you a payout from that round's prize pool.",e.jsx("br",{}),"BUT - ",e.jsx("span",{style:{color:"#ff4444",fontWeight:"bold"},children:"get 3 losses and you're OUT!"}),e.jsx("br",{}),"Keep what you win, but you won't be playing your remaining scheduled matches."]}),e.jsx("br",{}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem",lineHeight:"1.4"},children:[e.jsx("strong",{style:{color:"#ffc107"},children:"Phase 2: Cash Climb"}),e.jsx("br",{}),"When only a few players remain (3-6 players depending on tournament size), Cash Climb begins!",e.jsx("br",{}),"All surviving players advance to the final round. Your losses reset to 0.",e.jsx("br",{}),"Now you get only 2 losses before elimination.",e.jsx("br",{}),"Mixed round robin/winner-stays format with escalating payouts per match.",e.jsx("br",{}),"Last player standing wins the remaining prize pool as 1st place!"]}),e.jsx("br",{})]})})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#8b5cf6",marginBottom:"0.5rem",fontSize:"1.5rem"},children:" Match Rules"}),e.jsx("div",{style:{background:"rgba(139, 92, 246, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:r?e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Game:"})," ",r.game_type||"8-Ball Pool"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Call Shots:"})," ",r.call_shots?"Players must call their shots":"Call shots not required"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Sportsmanship:"})," ",r.sportsmanship_rule||"Good sportsmanship required at all times"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"On Time:"})," ",r.punctuality_rule||"Players must be on time for matches"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Game Type:"})," 8-Ball Pool"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Match Format:"})," May be a single game or a maximum race to 5 (Dependent on the size of the tournament field)"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Game Rules:"})," League, Ladder, and Tournament use CSI game play rules with no modifications"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Sportsmanship:"})," Good sportmanship is expected and required - admin decisions are final"]})]})})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#8b5cf6",marginBottom:"0.5rem",fontSize:"1.5rem"},children:" Prize Structure"}),e.jsx("div",{style:{background:"rgba(139, 92, 246, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:r?e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Entry Fee:"})," $",r.entry_fee||20," ($",Math.floor((r.entry_fee||20)/2)," to tournament payout, $",Math.floor((r.entry_fee||20)/2)," to ladder prize pool)"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Win Payout:"})," $",r.win_payout||1," per match win from prize pool"]}),e.jsxs("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"1st Place:"})," ",r.first_place_rule||"Remaining prize pool after win payouts"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.95rem"},children:[e.jsx("strong",{children:"Prize Distribution:"})," ",r.prize_distribution||"Distributed at tournament completion"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.95rem",lineHeight:"1.4"},children:[e.jsx("strong",{style:{color:"#00ff00"},children:"How You Win Money:"}),e.jsx("br",{}),"The prize pool is divided across all rounds.",e.jsx("br",{})," Each round has a different payout amount that increases as the tournament progresses.",e.jsx("br",{}),"When you ",e.jsx("span",{style:{color:"#00ff00",fontWeight:"bold"},children:"WIN"})," a match, you earn that round's payout immediately.",e.jsx("br",{})," The more rounds you survive, the bigger the payouts become!"]}),e.jsx("br",{}),e.jsxs("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.95rem",lineHeight:"1.4"},children:[e.jsx("strong",{style:{color:"#ffd700"},children:"Cash Climb Payouts:"}),e.jsx("br",{}),"In the final round, payouts escalate dramatically with each match.",e.jsx("br",{}),"With 3 players remaining, the winner stays at the table to face the next challenger.",e.jsx("br",{}),"The last player standing wins what they won along the way + 1st place reserved amount + whatever is left in the prize pool!"]}),e.jsxs("p",{style:{margin:"0",fontSize:"1rem",lineHeight:"1.4"},children:[e.jsx("p",{}),e.jsx("br",{}),e.jsx("strong",{style:{color:"#2196f3"},children:"Entry Fee:"}),e.jsx("br",{}),"$20 entry fee"]}),e.jsxs("p",{children:[e.jsx("strong",{style:{color:"#2196f3"},children:"Entry FeeBreakdown:"}),e.jsx("br",{}),"$10 goes to this tournament's prize pool",e.jsx("br",{}),"$10 goes to the quarterly ladder prize pool (separate payout every 3 months)."]})]})})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#8b5cf6",marginBottom:"0.5rem",fontSize:"1.2rem"},children:" Important Notes"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",padding:"0.5rem",borderRadius:"4px",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:" Tournament brackets are generated automatically when registration closes"}),e.jsx("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:" All matches must be reported through the app"}),e.jsx("p",{style:{margin:"0 0 0.3rem 0",fontSize:"0.95rem"},children:" Prize money is distributed after tournament completion"}),e.jsx("p",{style:{margin:"0",fontSize:"0.95rem"},children:" Contact admin for any questions or disputes"})]})]})]}),e.jsx("div",{style:{marginTop:"1rem",paddingTop:"0.5rem",borderTop:"1px solid rgba(139, 92, 246, 0.3)",textAlign:"center"},children:e.jsx("button",{onClick:t,style:{background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"#fff",border:"none",borderRadius:"4px",padding:"8px 16px",fontSize:"0.85rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(139, 92, 246, 0.3)"},children:"Got It!"})})]})}):null};const Yb=({playerName:n,playerLastName:t,senderEmail:r,userType:s,isAdmin:a=!1,showClaimForm:o=!1,initialView:i="main",isPublicView:l=!1,onClaimLadderPosition:c,claimedPositions:d=new Set,isPositionClaimed:u=()=>!1,setShowProfileModal:h})=>{var tn,ns;yn();const p=qi(),[g,f]=y.useState(i),[m,v]=y.useState(null),[b,w]=y.useState([]),[x,j]=y.useState(!0),[S,_]=y.useState(null),[C,N]=y.useState(null),[M,E]=y.useState(!1),[P,D]=y.useState("499-under"),[T,A]=y.useState(!1),[k,R]=y.useState(!1),[U,z]=y.useState(null),[$,W]=y.useState(!1);y.useEffect(()=>{console.log(" LadderApp: showTournamentRegistrationModal changed to:",k),console.log(" LadderApp: selectedTournament changed to:",U)},[k,U]);const[Y,Q]=y.useState(!1),[H,ue]=y.useState(Date.now()),[J,be]=y.useState([]),[Ae,O]=y.useState(!1);y.useEffect(()=>{console.log(" LadderApp: showUnifiedSignup state changed to:",Ae)},[Ae]),y.useEffect(()=>{const le=window.location.hash||"",_e=p.search||"",Me=le.includes("credit_purchase_success=1")||le.includes("membership_purchase_success=1")||le.includes("tab=payment-dashboard"),he=_e.includes("credit_purchase_success=1")||_e.includes("membership_purchase_success=1")||_e.includes("tab=payment-dashboard");try{(Me||he||sessionStorage.getItem("credit_purchase_return")==="1")&&rt(!0)}catch{}},[p.pathname,p.search]),y.useEffect(()=>{(async()=>{if(m!=null&&m.email){const _e=await Rt(m);kt(_e),console.log(" SmackBack eligibility for",m.firstName,m.lastName,":",_e)}else kt(!1)})()},[m]);const[oe,me]=y.useState(!1),[Ce,ve]=y.useState(!0),[De,Oe]=y.useState(!1),[Ze,et]=y.useState(!1),[re,je]=y.useState(!1),[V,Ee]=y.useState(!1),[F,ae]=y.useState(null),[I,X]=y.useState(null),[fe,ne]=y.useState("challenge"),[ye,ot]=y.useState([]),[lt,tt]=y.useState([]),[ge,xt]=y.useState([]),[ht,Je]=y.useState(!1),[Pe,Ve]=y.useState(!1),[we,Re]=y.useState(null),[it,rt]=y.useState(!1),[yt,kt]=y.useState(!1),[Ct,te]=y.useState(!1),[ke,We]=y.useState(null),[Fe,st]=y.useState(!1),[Ft,Le]=y.useState(!1),[Z,Ye]=y.useState(!1),[dt,pt]=y.useState(!1),[Tt,Wt]=y.useState(!1),[ir,rr]=y.useState(!1),[Pr,Fn]=y.useState(null),[hs,cn]=y.useState(null),Ja=le=>{st(le),ke&&ke(le)},[Dr,Jr]=y.useState(null),[An,ua]=y.useState(!1),[ha,zr]=y.useState(null),[Js,Xs]=y.useState([]),[Pa,Gi]=y.useState(!1),[ec,ps]=y.useState(null),[Ea,Xa]=y.useState([]),[Vi,_o]=y.useState(!1),[ks,Ra]=y.useState(!1),[Qa,Se]=y.useState(!1),G=y.useRef(null),He=Te.useMemo(()=>{if(!m||!b||!Array.isArray(b))return m;const le=b.find(_e=>{var Me;return(_e==null?void 0:_e.email)&&(m==null?void 0:m.email)&&_e.email.toLowerCase()===m.email.toLowerCase()||((Me=_e==null?void 0:_e.unifiedAccount)==null?void 0:Me.email)&&(m==null?void 0:m.email)&&_e.unifiedAccount.email.toLowerCase()===m.email.toLowerCase()});return le?{...m,wins:typeof le.wins=="number"?le.wins:m.wins,losses:typeof le.losses=="number"?le.losses:m.losses,totalMatches:typeof le.totalMatches=="number"?le.totalMatches:m.totalMatches}:m},[m,b]),Xe=y.useCallback((le,_e)=>{if(!le||!Array.isArray(le)||!_e)return;const Me=le.find(he=>{var Be;return he.email===_e||((Be=he.unifiedAccount)==null?void 0:Be.email)===_e});Me&&(m==null?void 0:m.playerId)==="ladder"&&(console.log(" Found current user in ladder data, updating wins/losses:",Me.wins,Me.losses),v(he=>({...he,wins:Me.wins||0,losses:Me.losses||0,totalMatches:Me.totalMatches||0})))},[m==null?void 0:m.playerId]),nt=y.useCallback(async()=>(G.current&&clearTimeout(G.current),G.current=setTimeout(async()=>{try{j(!0);const le=await mt.getLadderPlayersByName(P);if(console.log("Ladder Supabase response:",le),le.success&&Array.isArray(le.data)){const Me=le.data.map(async Be=>{var qe,jt,Bt,Ot;let ct=null,$t=[];if((qe=Be.users)!=null&&qe.email)try{const dr=await mt.getPlayerLastMatch(Be.users.email);dr.success&&dr.data&&(ct=dr.data);const ur=await mt.getPlayerMatchHistory(Be.users.email,5);ur.success&&ur.data&&($t=ur.data)}catch(dr){console.log(`Error fetching match data for ${Be.users.email}:`,dr)}return{_id:Be.id,userId:Be.user_id||null,email:((jt=Be.users)==null?void 0:jt.email)||"",firstName:((Bt=Be.users)==null?void 0:Bt.first_name)||"",lastName:((Ot=Be.users)==null?void 0:Ot.last_name)||"",position:Be.position,ladderName:Be.ladder_name||P,fargoRate:Be.fargo_rate||0,totalMatches:Be.total_matches||0,wins:Be.wins||0,losses:Be.losses||0,isActive:Be.is_active,immunityUntil:Be.immunity_until,smackbackEligibleUntil:Be.smackback_eligible_until,vacationMode:Be.vacation_mode,vacationUntil:Be.vacation_until,lastMatch:ct,recentMatches:$t}}),he=await Promise.all(Me);w(he),console.log(`Loaded ${he.length} players from ${P} ladder (Supabase) with last match data`),Xe(he,r)}else console.error("Error loading ladder data from Supabase:",le.error),w([]);const _e=localStorage.getItem("unifiedUserData");if(_e)try{const Me=JSON.parse(_e);if(console.log(" Found unified user data:",Me),Me.ladderProfile){const he=Me.ladderProfile;v({playerId:"ladder",name:`${Me.firstName} ${Me.lastName}`,firstName:Me.firstName,lastName:Me.lastName,email:Me.email,fargoRate:he.fargoRate,ladder:he.ladderName,position:he.position,wins:he.wins||0,losses:he.losses||0,immunityUntil:he.immunityUntil,activeChallenges:he.activeChallenges||[],canChallenge:he.canChallenge||!0,isActive:!0,sanctioned:he.sanctioned,sanctionYear:he.sanctionYear})}else await tr(Me.email)}catch(Me){console.error("Error parsing unified user data:",Me),await tr(email)}else await tr(email,"","")}catch(le){console.error("Error loading ladder data:",le),w([]),ue(Date.now())}finally{j(!1)}},300),()=>{K.removeChannel(channel)}),[P,r,Xe]);y.useEffect(()=>(nt(),Nt(),wt(),vt(),()=>{G.current&&clearTimeout(G.current)}),[P,nt]);const At=y.useCallback(async()=>{if(console.log(" loadPlayerMatches called for:",m==null?void 0:m.email),!(m!=null&&m.email)){console.log(" No email, skipping loadPlayerMatches"),_o(!1);return}try{_o(!0),console.log(" Fetching matches from ALL ladders using Supabase...");const le=a?["499-under","500-549","550-plus","simulation"]:["499-under","500-549","550-plus"],_e=await mt.getAllPlayerMatches(m.email,le);_e.success?(console.log(" Total matches from Supabase:",_e.matches.length),Xa(_e.matches)):(console.error(" Supabase Error:",_e.error),Xa([]))}catch(le){console.error("Error loading player matches:",le),Xa([])}finally{_o(!1)}},[m==null?void 0:m.email,a]);y.useEffect(()=>{g==="matches"&&At()},[g,m==null?void 0:m.email,At]),y.useEffect(()=>{V&&(m!=null&&m.email)&&wt()},[V,m==null?void 0:m.email,P]),y.useEffect(()=>{m&&m.ladder&&m.ladder!=="Guest"&&m.ladder!=="League Player - Claim Account"&&m.ladder!=="Not Recognized"&&P==="499-under"&&!Y&&(console.log(" Setting selectedLadder to user ladder:",m.ladder),D(m.ladder))},[m]),y.useEffect(()=>{const le=(m==null?void 0:m.email)||r;le&&!a&&(console.log(" Re-checking membership status for:",le),Ht(le))},[m==null?void 0:m.email,r]);const vt=async()=>{if(r){console.log("Loading profile data for email:",r);try{const le=await mt.getPlayerProfileData(r,"ladder");console.log("Loaded user data from Supabase:",le);const _e=le.success?le.data.user:null;if(_e){const Me={firstName:n,lastName:t,email:r,phone:_e.phone||"",preferredContacts:[],locations:_e.locations||"",availability:_e.availability||{}};console.log("Setting new playerInfo:",Me),console.log("playerInfo.locations:",Me.locations),N(Me)}else console.log("No user data found in Supabase, setting default playerInfo"),N({firstName:n,lastName:t,email:r,phone:"",preferredContacts:[],locations:"",availability:{}})}catch(le){console.error("Error loading profile data:",le)}}};y.useEffect(()=>{o&&O(!0)},[o]),y.useEffect(()=>{(async()=>{if(!(!r||!(m!=null&&m.canChallenge)))try{const _e=await mt.getUserByEmail(r);if(_e){const Me=_e.phone&&_e.phone.trim()!=="",he=_e.locations&&_e.locations.trim()!=="",Be=_e.availability&&Object.keys(_e.availability).length>0,ct=Me&&he&&Be;ve(ct),console.log("Profile completion status:",{hasPhone:Me,hasLocations:he,hasAvailability:Be,profileComplete:ct})}}catch(_e){console.error("Error checking profile completion:",_e)}})()},[r,m==null?void 0:m.canChallenge]),y.useEffect(()=>{(()=>{if(!Qa&&(m!=null&&m.canChallenge)){const _e=ls.getStatus();_e.isSupported&&_e.permission==="default"&&Ra(!0),Se(!0)}})()},[m==null?void 0:m.canChallenge,Qa]),y.useEffect(()=>{G.current&&clearTimeout(G.current),K.channel("ladder-updates").on("postgres_changes",{event:"*",schema:"public",table:"ladder_profiles"},async le=>{var _e;if(console.log(" Realtime update received:",le),le.new&&le.new.ladder_name===P){console.log(` Processing realtime update for current ladder: ${P}`);try{const Me=await mt.getLadderPlayersByName(P);if(console.log(" Realtime: Fetching data for ladder:",P),console.log(" Realtime: Result:",Me),Me.success&&Array.isArray(Me.data)){const he=Me.data.map(async ct=>{var jt,Bt,Ot,dr;let $t=null,qe=[];if((jt=ct.users)!=null&&jt.email)try{const ur=await mt.getPlayerLastMatch(ct.users.email);ur.success&&ur.data&&($t=ur.data);const bn=await mt.getPlayerMatchHistory(ct.users.email,5);bn.success&&bn.data&&(qe=bn.data)}catch(ur){console.log(` Realtime: Error fetching match data for ${ct.users.email}:`,ur)}return{_id:ct.id,email:((Bt=ct.users)==null?void 0:Bt.email)||"",firstName:((Ot=ct.users)==null?void 0:Ot.first_name)||"",lastName:((dr=ct.users)==null?void 0:dr.last_name)||"",position:ct.position,fargoRate:ct.fargo_rate||0,totalMatches:ct.total_matches||0,wins:ct.wins||0,losses:ct.losses||0,isActive:ct.is_active,immunityUntil:ct.immunity_until,vacationMode:ct.vacation_mode,vacationUntil:ct.vacation_until,lastMatch:$t,recentMatches:qe}}),Be=await Promise.all(he);w(Be),console.log(` Realtime: Updated ${Be.length} players from ${P} ladder with last match data`),Xe(Be,r)}else console.error(" Realtime: Error loading ladder data:",Me.error)}catch(Me){console.error(" Realtime: Error in update handler:",Me)}}else console.log(` Ignoring realtime update for different ladder: ${(_e=le.new)==null?void 0:_e.ladder_name} (current: ${P})`)}).subscribe(),G.current=setTimeout(async()=>{try{j(!0);const le=await mt.getLadderPlayersByName(P);if(console.log("Ladder Supabase response:",le),le.success&&Array.isArray(le.data)){const Me=le.data.map(async Be=>{var qe,jt,Bt,Ot;let ct=null,$t=[];if((qe=Be.users)!=null&&qe.email)try{const dr=await mt.getPlayerLastMatch(Be.users.email);dr.success&&dr.data&&(ct=dr.data);const ur=await mt.getPlayerMatchHistory(Be.users.email,5);ur.success&&ur.data&&($t=ur.data)}catch(dr){console.log(`Error fetching match data for ${Be.users.email}:`,dr)}return{_id:Be.id,userId:Be.user_id||null,email:((jt=Be.users)==null?void 0:jt.email)||"",firstName:((Bt=Be.users)==null?void 0:Bt.first_name)||"",lastName:((Ot=Be.users)==null?void 0:Ot.last_name)||"",position:Be.position,ladderName:Be.ladder_name||P,fargoRate:Be.fargo_rate||0,totalMatches:Be.total_matches||0,wins:Be.wins||0,losses:Be.losses||0,isActive:Be.is_active,immunityUntil:Be.immunity_until,smackbackEligibleUntil:Be.smackback_eligible_until,vacationMode:Be.vacation_mode,vacationUntil:Be.vacation_until,lastMatch:ct,recentMatches:$t}}),he=await Promise.all(Me);w(he),console.log(`Loaded ${he.length} players from ${P} ladder (Supabase) with last match data`),Xe(he,r)}else console.error("Error loading ladder data from Supabase:",le.error),w([]);const _e=localStorage.getItem("unifiedUserData");if(_e)try{const Me=JSON.parse(_e);if(console.log(" Found unified user data:",Me),Me.ladderProfile){const he=Me.ladderProfile;v({playerId:"ladder",name:`${Me.firstName} ${Me.lastName}`,firstName:Me.firstName,lastName:Me.lastName,email:Me.email,fargoRate:he.fargoRate,fargoRateUpdatedAt:he.fargoRateUpdatedAt,ladder:he.ladderName,position:he.position,wins:he.wins||0,losses:he.losses||0,immunityUntil:he.immunityUntil,activeChallenges:[],canChallenge:!1,unifiedAccount:Me.unifiedAccount,isActive:!0,sanctioned:he.sanctioned,sanctionYear:he.sanctionYear,stats:{wins:he.wins,losses:he.losses,totalMatches:he.totalMatches}}),console.log(` User position set: ${Me.firstName} ${Me.lastName} - Position: ${he.position}`),console.log(" Set user ladder data from unified profile"),await Ht(Me.email)}}catch(Me){console.error("Error parsing unified user data:",Me)}console.log(" senderEmail exists:",!!r,"Value:",r),r?(console.log(" Calling checkPlayerStatus for:",r),await tr(r)):v({playerId:"guest",name:`${n} ${t}`,firstName:n,lastName:t,email:null,fargoRate:450,ladder:"499-under",position:"Guest",immunityUntil:null,activeChallenges:[],canChallenge:!1})}catch(le){console.error("Error loading ladder data:",le),w([]),v({playerId:"guest",name:`${n} ${t}`,firstName:n,lastName:t,email:r,fargoRate:450,ladder:"499-under",position:"Guest",immunityUntil:null,activeChallenges:[],canChallenge:!1}),console.warn("Ladder data could not be loaded. Please check your connection and try again.")}finally{j(!1)}},300)},[P,r,Xe]);const Nt=async()=>{be(["Legends Brews & Cues","Antiques","Rac m","Westside Billiards","Bijou Billiards","Crooked Cue","Back on the Boulevard","Main Street Tavern","Murray Street Darts","My House"])},tr=async le=>{try{console.log(" Checking player status for email:",le);const _e=await mt.getPlayerProfileData(le,"ladder");if(console.log(" Profile data from Supabase:",_e),!_e.success){console.error("Failed to get profile data:",_e.error);return}const Me=_e.data.user,he=_e.data.ladderProfile,Be={isLadderPlayer:!!he,unifiedAccount:Me?{hasUnifiedAccount:!!Me,email:Me.email}:null};Me&&(Be.ladderInfo={firstName:Me.first_name,lastName:Me.last_name,email:Me.email,fargoRate:(he==null?void 0:he.fargo_rate)||0,fargoRateUpdatedAt:he==null?void 0:he.fargo_rate_updated_at,ladderName:(he==null?void 0:he.ladder_name)||"499-under",position:(he==null?void 0:he.position)||null,wins:(he==null?void 0:he.wins)||0,losses:(he==null?void 0:he.losses)||0,immunityUntil:he==null?void 0:he.immunity_until,isActive:(he==null?void 0:he.is_active)!==!1,sanctioned:he==null?void 0:he.sanctioned,sanctionYear:he==null?void 0:he.sanction_year,stats:he==null?void 0:he.stats,ladderProgression:he==null?void 0:he.ladder_progression}),console.log(" Player status response:",Be),_(Be),Be.isLadderPlayer?(v({playerId:"ladder",name:`${Be.ladderInfo.firstName} ${Be.ladderInfo.lastName}`,firstName:Be.ladderInfo.firstName,lastName:Be.ladderInfo.lastName,email:le,fargoRate:Be.ladderInfo.fargoRate,fargoRateUpdatedAt:Be.ladderInfo.fargoRateUpdatedAt,ladder:Be.ladderInfo.ladderName,position:Be.ladderInfo.position,wins:Be.ladderInfo.wins||0,losses:Be.ladderInfo.losses||0,immunityUntil:Be.ladderInfo.immunityUntil,activeChallenges:[],canChallenge:!1,unifiedAccount:Be.unifiedAccount,isActive:Be.ladderInfo.isActive!==!1,sanctioned:Be.ladderInfo.sanctioned,sanctionYear:Be.ladderInfo.sanctionYear,stats:Be.ladderInfo.stats,ladderProgression:Be.ladderInfo.ladderProgression}),await Ht(le)):Be.isLeaguePlayer?v({playerId:"league",name:`${Be.leagueInfo.firstName} ${Be.leagueInfo.lastName}`,firstName:Be.leagueInfo.firstName,lastName:Be.leagueInfo.lastName,email:le,fargoRate:450,ladder:"499-under",position:"League Player - Claim Account",immunityUntil:null,activeChallenges:[],canChallenge:!1,needsClaim:!0,leagueInfo:Be.leagueInfo}):v({playerId:"unknown",name:`${n} ${t}`,firstName:n,lastName:t,email:le,fargoRate:450,ladder:"499-under",position:"Not Recognized",immunityUntil:null,activeChallenges:[],canChallenge:!1})}catch(_e){console.error("Error checking player status:",_e)}},qt=y.useCallback(le=>{f(le)},[]);y.useMemo(()=>{switch(P){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return P}},[P]);const or=(le,_e)=>{var Bt,Ot;const Me=p2(le),he=p2(_e);if(console.log(` Ladder comparison: Challenger ${Me.firstName} ${Me.lastName} ladder="${Me.ladder}", Defender ${he.firstName} ${he.lastName} ladderName="${he.ladderName}"`),console.log(" Challenger unifiedAccount:",Me.unifiedAccount),console.log(" Defender unifiedAccount:",he.unifiedAccount),console.log(" Challenger canChallenge:",Me.canChallenge),console.log(" Defender hasUnifiedAccount:",(Bt=he.unifiedAccount)==null?void 0:Bt.hasUnifiedAccount),Me.ladder!==he.ladderName)return console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} (${Me.ladder}) cannot challenge ${he.firstName} ${he.lastName} (${he.ladderName}) - Different ladder`),!1;const Be=!!(Me.email||le!=null&&le.email),ct=!!(_e!=null&&_e.userId)&&!!(he.email||_e!=null&&_e.email);if(!Be)return console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} cannot challenge ${he.firstName} ${he.lastName} - Challenger account required`),!1;if(!ct)return console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} cannot challenge ${he.firstName} ${he.lastName} - Opponent profile incomplete`),!1;if(Me.email===((Ot=he.unifiedAccount)==null?void 0:Ot.email))return console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} cannot challenge themselves`),!1;if(Me.isActive===!1)return console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} is not active`),!1;if(!he.isActive)return console.log(` Challenge blocked: ${he.firstName} ${he.lastName} is not active`),!1;if(he.immunityUntil&&new Date(he.immunityUntil)>new Date)return console.log(` Challenge blocked: ${he.firstName} ${he.lastName} has immunity until ${he.immunityUntil}`),!1;const $t=ml(Me.position),qe=ml(he.position),jt=$t-qe;return jt>=-4&&jt<=0?(console.log(` Standard Challenge allowed: ${Me.firstName} ${Me.lastName} (Position ${$t}) can challenge ${he.firstName} ${he.lastName} (Position ${qe}) - ${Math.abs(jt)} positions above`),!0):jt>0&&jt<=5?(console.log(` SmackDown allowed: ${Me.firstName} ${Me.lastName} (Position ${$t}) can challenge ${he.firstName} ${he.lastName} (Position ${qe}) - ${jt} positions below`),!0):(console.log(` Challenge blocked: ${Me.firstName} ${Me.lastName} (Position ${$t}) cannot challenge ${he.firstName} ${he.lastName} (Position ${qe}) - Position difference ${jt} is outside allowed range (-4 to +5)`),!1)},Ht=async le=>{if(le)try{console.log(" Checking membership status for:",le),console.log(" Current userLadderData before membership check:",m);const _e=await mt.getPaymentStatus(le);console.log(" Payment status from Supabase:",_e);const Me=wo(),he=Me.isFree;if(_e){const Be=_e.hasMembership===!0||_e.has_membership===!0,ct=_e.status||_e.membership_status||"inactive",$t=ct==="active"||ct==="free_phase"||ct==="promotional_period",qe=Be&&$t;console.log(" Membership check details:",{paymentStatus:_e,hasMembershipFlag:Be,statusValue:ct,isActiveStatus:$t,hasActiveMembership:qe,paymentStatusKeys:Object.keys(_e||{}),paymentStatusFull:JSON.stringify(_e,null,2)}),v(jt=>{var bn,Un;console.log(" Previous userLadderData:",jt),console.log(" hasActiveMembership:",qe),console.log(" isFreePhase (Phase 1):",he),console.log(" currentPhase:",Me.phase,Me.name),console.log(" prev?.unifiedAccount?.hasUnifiedAccount:",(bn=jt==null?void 0:jt.unifiedAccount)==null?void 0:bn.hasUnifiedAccount);const Bt=((Un=jt==null?void 0:jt.unifiedAccount)==null?void 0:Un.hasUnifiedAccount)===!0,Ot=!_e||_e.hasMembership===!1&&_e.status==="inactive"&&!_e.isPromotionalPeriod&&Object.keys(_e).length<=3,dr=a||he||qe||Bt&&Ot||Bt&&qe;console.log(" Updated canChallenge to:",dr,"(isAdmin:",a,", hasMembership:",qe,", isFreePhase:",he,", hasUnifiedAccount:",Bt,", noPaymentRecord:",Ot,")");const ur={...jt,canChallenge:dr,membershipStatus:_e,currentPhase:Me.phase,phaseInfo:Me};return console.log(" Final updated userLadderData:",ur),console.log(" Phase info in final data:",ur.phaseInfo),ur})}else console.log(" Failed to check membership status:",response.status),v(Be=>{const ct=a||he;return console.log(" Membership API failed, using fallback canChallenge:",ct,"(isFreePhase:",he,")"),{...Be,canChallenge:ct,membershipStatus:null,currentPhase:Me.phase,phaseInfo:Me}})}catch(_e){console.error("Error checking membership status:",_e);const Me=wo(),he=Me.isFree;v(Be=>{const ct=a||he;return console.log(" Membership API error, using fallback canChallenge:",ct,"(isFreePhase:",he,")"),{...Be,canChallenge:ct,membershipStatus:null,currentPhase:Me.phase,phaseInfo:Me}})}},Rt=async le=>{try{const _e=(le==null?void 0:le.email)||le;if(!_e)return!1;const Me=await mt.getPlayerMatchHistory(_e,20);return!(Me!=null&&Me.success)||!Me.data||Me.data.length===0?(console.log("No match history found for SmackBack check"),!1):!!Me.data.find(ct=>{var Bt,Ot,dr,ur;if(ct.status!=="completed"||ct.matchType!=="smackdown"||!(((Bt=ct.winner)==null?void 0:Bt.email)===_e||((Ot=ct.winner)==null?void 0:Ot.id)===(le==null?void 0:le.id)||((dr=ct.player1)==null?void 0:dr.email)===_e&&ct.winner===ct.player1||((ur=ct.player2)==null?void 0:ur.email)===_e&&ct.winner===ct.player2))return!1;const qe=new Date(ct.completedDate||ct.scheduledDate),jt=new Date;return jt.setDate(jt.getDate()-7),qe>=jt})}catch(_e){return console.error("Error checking recent SmackDown win:",_e),!1}},Ue=(le,_e)=>{var Me,he;try{const Be=((le==null?void 0:le.email)||((Me=le==null?void 0:le.unifiedAccount)==null?void 0:Me.email)||"").toString().trim(),ct=((_e==null?void 0:_e.email)||((he=_e==null?void 0:_e.unifiedAccount)==null?void 0:he.email)||"").toString().trim(),$t=!!Be,qe=!!(_e!=null&&_e.userId)&&!!ct;if(!$t||!qe||Be&&ct&&Be.toLowerCase()===ct.toLowerCase()||(_e==null?void 0:_e.isActive)===!1||_e!=null&&_e.immunityUntil&&new Date(_e.immunityUntil)>new Date)return null;const jt=ml(le==null?void 0:le.position),Bt=ml(_e==null?void 0:_e.position),Ot=Bt-jt;if(console.log(` Challenge Type Check: ${le==null?void 0:le.firstName} (Pos ${jt}) vs ${_e==null?void 0:_e.firstName} (Pos ${Bt})`),console.log(` Position difference: ${Ot} (negative = defender is above challenger, positive = defender is below challenger)`),Bt===1&&yt)return console.log("  SmackBack allowed (challenger recently won SmackDown, can challenge 1st place)"),"smackback";if((le==null?void 0:le.fastTrackChallengesRemaining)>0&&(le==null?void 0:le.fastTrackExpirationDate)&&new Date<new Date(le.fastTrackExpirationDate)&&Ot>=-6&&Ot<=0){const ur=le==null?void 0:le.fastTrackChallengesRemaining;return console.log(`  fast-track allowed (defender is ${Math.abs(Ot)} positions above, ${ur} challenges remaining)`),"fast-track"}return Ot>=-4&&Ot<=0?(console.log(`  Challenge allowed (defender is ${Math.abs(Ot)} positions above)`),"challenge"):Ot>0&&Ot<=5?(console.log(`  SmackDown allowed (defender is ${Ot} positions below)`),"smackdown"):(console.log(`  No challenge allowed (position difference ${Ot} outside range)`),null)}catch(Be){return console.error("Error in getChallengeType:",Be),null}},ft=(le,_e)=>{var Me,he;try{const Be=((le==null?void 0:le.email)||((Me=le==null?void 0:le.unifiedAccount)==null?void 0:Me.email)||"").toString().toLowerCase().trim(),ct=((_e==null?void 0:_e.email)||((he=_e==null?void 0:_e.unifiedAccount)==null?void 0:he.email)||"").toString().toLowerCase().trim(),$t=`${(le==null?void 0:le.firstName)||""} ${(le==null?void 0:le.lastName)||""}`.toLowerCase().trim(),qe=`${(_e==null?void 0:_e.firstName)||""} ${(_e==null?void 0:_e.lastName)||""}`.toLowerCase().trim();if(Be&&ct&&Be===ct||$t&&qe&&$t===qe&&(le==null?void 0:le.position)===(_e==null?void 0:_e.position))return"Same player";if(!Be)return"Profile incomplete";if(!(_e!=null&&_e.userId)||!ct)return"Opponent profile incomplete";if(!(_e!=null&&_e.isActive))return"Defender inactive";if(_e!=null&&_e.immunityUntil&&new Date(_e.immunityUntil)>new Date)return"Defender immune";const jt=ml(le==null?void 0:le.position),Bt=ml(_e==null?void 0:_e.position),Ot=Bt-jt;return Bt===1?yt?"SmackBack eligible - Recently won SmackDown":"Need recent SmackDown win to challenge 1st place":Ot<-4?`Too far above (${Math.abs(Ot)} positions) - Max 4 positions above allowed`:Ot>5?`Too far below (${Ot} positions) - Max 5 positions below allowed for SmackDown`:"Eligible"}catch(Be){return console.error("Error in getChallengeReason:",Be),"Invalid data"}},wt=async()=>{if(r)try{const le=QC(r),_e=await mt.getPendingChallenges(le);_e.success?ot(_e.data||[]):(console.error("Error loading pending challenges:",_e.error),ot([]));const Me=await mt.getSentChallenges(le);if(Me.success){const jt=(Me.data||[]).filter(Bt=>{var Ot,dr,ur;return!(((Ot=Bt.matchDetails)==null?void 0:Ot.entryFee)===0&&((ur=(dr=Bt.challengePost)==null?void 0:dr.postContent)!=null&&ur.toLowerCase().includes("admin")))});tt(jt)}else console.error("Error loading sent challenges:",Me.error),tt([]);const he=await mt.getScheduledMatches(P||null);console.log(" All scheduled matches from Supabase:",he);const Be=he!=null&&he.success?he.matches||[]:[];console.log(" Looking for user email:",le),console.log(" Looking for user name:",`${m==null?void 0:m.firstName} ${m==null?void 0:m.lastName}`);let ct=null;if(le)try{const{data:qe,error:jt}=await K.from("users").select("id").eq("email",le.toLowerCase()).maybeSingle();qe&&!jt&&(ct=qe.id,console.log(" Found user ID for matching:",ct))}catch(qe){console.log("Could not get user ID:",qe)}const $t=(Be==null?void 0:Be.filter(qe=>{var eo,to,Zo,Ki,Ji,Xi,B,Ne,$e,Ge,St,Yt,hr,vr,rn,Mn,vn,qn;const jt=le.toLowerCase(),Bt=`${(m==null?void 0:m.firstName)||""} ${(m==null?void 0:m.lastName)||""}`.toLowerCase().trim(),Ot=(Zo=((eo=qe.player1)==null?void 0:eo.email)||((to=qe.winner)==null?void 0:to.email))==null?void 0:Zo.toLowerCase(),dr=(Xi=((Ki=qe.player2)==null?void 0:Ki.email)||((Ji=qe.loser)==null?void 0:Ji.email))==null?void 0:Xi.toLowerCase(),ur=Ot===jt||dr===jt,bn=((B=qe.player1)==null?void 0:B.firstName)||((Ne=qe.winner)==null?void 0:Ne.first_name)||"",Un=(($e=qe.player1)==null?void 0:$e.lastName)||((Ge=qe.winner)==null?void 0:Ge.last_name)||"",ms=`${bn} ${Un}`.toLowerCase().trim(),fs=((St=qe.player2)==null?void 0:St.firstName)||((Yt=qe.loser)==null?void 0:Yt.first_name)||"",Cn=((hr=qe.player2)==null?void 0:hr.lastName)||((vr=qe.loser)==null?void 0:vr.last_name)||"",Ur=`${fs} ${Cn}`.toLowerCase().trim(),Cs=ms===Bt||Ur===Bt,Ns=ct&&(qe.winner_id===ct||qe.loser_id===ct||((rn=qe.player1)==null?void 0:rn.id)===ct||((Mn=qe.player2)==null?void 0:Mn.id)===ct||((vn=qe.player1)==null?void 0:vn._id)===ct||((qn=qe.player2)==null?void 0:qn._id)===ct),Ts=ur||Cs||Ns;return Ts?console.log(" Found matching match:",{matchId:qe.id||qe._id,player1Email:Ot,player2Email:dr,userEmail:jt,player1Name:ms,player2Name:Ur,userName:Bt,emailMatch:ur,nameMatch:Cs,idMatch:Ns,winner_id:qe.winner_id,loser_id:qe.loser_id,userId:ct}):Be.length>0&&Be.indexOf(qe)===0&&console.log(" Sample match structure:",{matchId:qe.id||qe._id,hasPlayer1:!!qe.player1,hasPlayer2:!!qe.player2,hasWinner:!!qe.winner,hasLoser:!!qe.loser,player1:qe.player1,player2:qe.player2,winner:qe.winner,loser:qe.loser,winner_id:qe.winner_id,loser_id:qe.loser_id}),Ts}))||[];console.log(" Filtered user scheduled matches:",$t),xt($t)}catch(le){console.error("Error loading challenges:",le)}},Lt=y.useCallback((le,_e="challenge")=>{var Me,he,Be;if(!a){const ct=wo(),$t=ct.isFree,qe=((Me=m==null?void 0:m.membershipStatus)==null?void 0:Me.hasMembership)&&(((he=m==null?void 0:m.membershipStatus)==null?void 0:he.status)==="active"||((Be=m==null?void 0:m.membershipStatus)==null?void 0:Be.status)==="free_phase"),jt=!(m!=null&&m.membershipStatus)&&(m==null?void 0:m.canChallenge);if(!qe&&!jt&&!$t){confirm($t?` Profile Incomplete

To challenge other players, you need to complete your profile by adding available dates and locations.

During Phase 1 (Testing), this is all you need to do!

Would you like to complete your profile now?`:` Membership Required

To challenge other players, you need an active membership (${ct.description}).

Would you like to purchase a membership now?`)&&alert($t?"Please complete your profile by adding available dates and locations in your profile settings.":"Please visit the payment section to purchase a membership.");return}}ae(le),ne(_e),Oe(!0)},[m,a]),yr=le=>{if(!le.isActive)return{status:"inactive",text:"Inactive",className:"inactive"};const _e=le.immunityUntil&&new Date(le.immunityUntil)>new Date;if(le.smackbackEligibleUntil&&new Date(le.smackbackEligibleUntil)>new Date){const qe=new Date(le.smackbackEligibleUntil);return{status:_e?"immune-smackback":"smackback",text:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[_e&&e.jsx("span",{style:{fontSize:"0.75rem",color:"#ff9800",fontWeight:"bold",background:"rgba(255, 152, 0, 0.1)",padding:"2px 6px",borderRadius:"4px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:" Immune"}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#8b5cf6",fontWeight:"bold",background:"rgba(139, 92, 246, 0.1)",padding:"2px 6px",borderRadius:"4px",border:"1px solid rgba(139, 92, 246, 0.3)"},children:" SmackBack"}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"#aaa"},children:["Exp: ",qe.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),className:_e?"immune-smackback":"smackback-eligible"}}if(_e){const qe=new Date(le.immunityUntil);return{status:"immune",text:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"#ff9800",fontWeight:"bold",background:"rgba(255, 152, 0, 0.1)",padding:"2px 6px",borderRadius:"4px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:" Immune"}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"#aaa"},children:["Exp: ",qe.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),className:"immune"}}const he=qe=>{var bn,Un,ms,fs,Cn,Ur,Cs,Ns,Ts;const jt=le.email||((bn=le.unifiedAccount)==null?void 0:bn.email),Bt=le._id;if(jt&&(((Un=qe.challenger)==null?void 0:Un.email)===jt||((ms=qe.defender)==null?void 0:ms.email)===jt)||Bt&&(((fs=qe.challenger)==null?void 0:fs._id)===Bt||((Cn=qe.defender)==null?void 0:Cn._id)===Bt))return!0;const Ot=`${le.firstName} ${le.lastName}`.toLowerCase(),dr=`${((Ur=qe.challenger)==null?void 0:Ur.firstName)||""} ${((Cs=qe.challenger)==null?void 0:Cs.lastName)||""}`.toLowerCase(),ur=`${((Ns=qe.defender)==null?void 0:Ns.firstName)||""} ${((Ts=qe.defender)==null?void 0:Ts.lastName)||""}`.toLowerCase();return dr===Ot||ur===Ot},Be=qe=>{var bn,Un,ms,fs,Cn,Ur,Cs,Ns,Ts;const jt=le.email||((bn=le.unifiedAccount)==null?void 0:bn.email),Bt=le._id;if(jt&&(((Un=qe.player1)==null?void 0:Un.email)===jt||((ms=qe.player2)==null?void 0:ms.email)===jt)||Bt&&(((fs=qe.player1)==null?void 0:fs._id)===Bt||((Cn=qe.player2)==null?void 0:Cn._id)===Bt))return!0;const Ot=`${le.firstName} ${le.lastName}`.toLowerCase(),dr=`${((Ur=qe.player1)==null?void 0:Ur.firstName)||""} ${((Cs=qe.player1)==null?void 0:Cs.lastName)||""}`.toLowerCase(),ur=`${((Ns=qe.player2)==null?void 0:Ns.firstName)||""} ${((Ts=qe.player2)==null?void 0:Ts.lastName)||""}`.toLowerCase();return dr===Ot||ur===Ot};return ye.some(he)||lt.some(he)?{status:"proposal",text:"Challenge Pending",className:"proposal"}:ge.some(Be)?{status:"scheduled",text:"Match Scheduled",className:"scheduled"}:{status:"active",text:"Active",className:"active"}},Sr=y.useCallback(le=>{Jr(le),ua(!0),le.lastMatch?(console.log(" Using existing lastMatch data from player object:",le.lastMatch),zr(le.lastMatch)):(console.log(" No lastMatch data in player object, trying to fetch..."),Bs(le)),le.recentMatches&&le.recentMatches.length>0?(console.log(" Using existing recentMatches data from player object:",le.recentMatches),console.log(" Number of recent matches:",le.recentMatches.length),Xs(le.recentMatches)):(console.log(" No recentMatches data in player object, trying to fetch..."),Za(le)),jr(le)},[An,Dr]),Bs=async le=>{var Me;console.log(" Fetching last match data for player:",le),console.log(" Player unifiedAccount:",le.unifiedAccount),console.log(" Player email:",le.email),console.log(" Player firstName:",le.firstName),console.log(" Player lastName:",le.lastName);const _e=((Me=le.unifiedAccount)==null?void 0:Me.email)||le.email;if(console.log(" Using email for last match:",_e),!_e){console.log(" No email found anywhere, cannot fetch last match data"),zr(null);return}try{console.log(" Fetching last match from Supabase for email:",_e);const he=await mt.getPlayerLastMatch(_e);he.success?(console.log(" Last match data from Supabase:",he.data),zr(he.data)):(console.error(" Error fetching last match:",he.error),zr(null))}catch(he){console.error("Error fetching last match data:",he),zr(null)}},Za=async le=>{var Me;console.log(" Fetching match history for player:",le),console.log(" Player unifiedAccount:",le.unifiedAccount);const _e=((Me=le.unifiedAccount)==null?void 0:Me.email)||le.email;if(console.log(" Using email:",_e),!_e){console.log(" No email found anywhere, cannot fetch match history"),Xs([]);return}try{console.log(" Fetching match history from Supabase for email:",_e);const he=await mt.getPlayerMatchHistory(_e,10);he.success?(console.log(" Match history data from Supabase:",he.data),Xs(he.data)):(console.error(" Error fetching match history:",he.error),Xs([]))}catch(he){console.error("Error fetching player match history:",he),Xs([])}},jr=async le=>{var Me,he,Be,ct;console.log(" Fetching updated player data for:",le);const _e=((Me=le.unifiedAccount)==null?void 0:Me.email)||le.email;if(console.log(" Using email for player data:",_e),!_e){console.log(" No email found anywhere, using original player data"),ps(le);return}try{console.log(" Fetching player data from Supabase for email:",_e);const $t=await mt.getLadderPlayersByName(P);if($t.success&&$t.data){const qe=$t.data.find(jt=>{var Bt,Ot;return((Ot=(Bt=jt.users)==null?void 0:Bt.email)==null?void 0:Ot.toLowerCase())===_e.toLowerCase()});if(qe){console.log(" Found player profile in Supabase:",qe);const jt={...le,_id:qe.id,email:((he=qe.users)==null?void 0:he.email)||_e,firstName:((Be=qe.users)==null?void 0:Be.first_name)||le.firstName,lastName:((ct=qe.users)==null?void 0:ct.last_name)||le.lastName,position:qe.position,fargoRate:qe.fargo_rate||0,totalMatches:qe.total_matches||0,wins:qe.wins||0,losses:qe.losses||0,isActive:qe.is_active,immunityUntil:qe.immunity_until,vacationMode:qe.vacation_mode,vacationUntil:qe.vacation_until};console.log(" Updated player data from Supabase:",jt),console.log(" Updated wins:",jt.wins),console.log(" Updated losses:",jt.losses),ps(jt)}else console.log(" Player not found in Supabase ladder data"),ps(le)}else console.log(" Failed to fetch ladder data from Supabase:",$t.error),ps(le)}catch($t){console.error("Error fetching updated player data:",$t),ps(le)}},Dt=y.useMemo(()=>b.filter(le=>{var Me,he;return(Me=le.unifiedAccount)==null||Me.hasUnifiedAccount,((he=le.unifiedAccount)==null?void 0:he.email)!==(m==null?void 0:m.email)&&le.email!==(m==null?void 0:m.email)&&le.firstName!==(m==null?void 0:m.firstName)}),[b,m==null?void 0:m.email,m==null?void 0:m.firstName]),Ar=y.useCallback(()=>{console.log(" Smart Match clicked"),console.log(" Current ladder data:",b),console.log(" User ladder data:",m),console.log(" Available defenders:",Dt),je(!0)},[b,m,Dt]),$r=y.useCallback(le=>{wt(),nt()},[]),dn=y.useCallback((le,_e)=>{le==="accepted"&&I?ls.showChallengeAcceptedNotification(I):le==="declined"&&I?ls.showChallengeDeclinedNotification(I):le==="counter-proposed"&&I&&ls.showCounterProposalNotification(I),wt(),nt()},[I]);y.useCallback(le=>{X(le),et(!0)},[]);const rs=()=>e.jsxs("div",{className:l?"ladder-view-direct":"ladder-view",style:l?{maxWidth:"none",width:"100%",minWidth:"100%"}:{},children:[l&&e.jsxs("div",{style:{marginBottom:"20px",padding:"16px",background:"rgba(0, 0, 0, 0.8)",borderRadius:"12px",border:"2px solid rgba(255, 193, 7, 0.3)"},children:[e.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(255, 193, 7, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#ffc107",fontSize:"1.1rem"},children:" How to Join the Ladder:"}),e.jsxs("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:["1. Visit ",e.jsx("a",{href:"https://frontrangepool.com",style:{color:"#ffc107",textDecoration:"underline"},children:"FrontRangePool.com"})," to create your account"]}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:"2. Complete your profile with availability and preferred locations"}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:"3. Choose your ladder bracket based on your FargoRate"}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:"4. Start challenging other players to climb the ranks!"})]}),e.jsxs("div",{style:{padding:"12px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid rgba(76, 175, 80, 0.3)"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#4CAF50",fontSize:"1.1rem"},children:" How to Claim Your Position:"}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:" If you see your name on the ladder, you can claim that position"}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:' Look for the green "Claim" button next to available positions'}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:" Complete your profile to unlock all challenge features"}),e.jsx("p",{style:{margin:"0 0 6px 0",fontSize:"0.9rem",color:"#fff"},children:" New players start at the bottom and work their way up"})]}),e.jsxs("div",{style:{marginTop:"16px",padding:"16px",background:"rgba(139, 92, 246, 0.1)",borderRadius:"8px",border:"1px solid rgba(139, 92, 246, 0.3)",textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",color:"#8b5cf6",fontSize:"1.2rem",fontWeight:"bold"},children:" Ready to Join the Competition?"}),e.jsx("p",{style:{margin:"0 0 16px 0",color:"#ccc",fontSize:"0.95rem",lineHeight:"1.4"},children:"Create your account to challenge players, track your progress, and climb the ladder!"}),e.jsx("button",{onClick:()=>{window.location.href="/hub"},style:{background:"linear-gradient(45deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(139, 92, 246, 0.3)",textDecoration:"none",display:"inline-block"},onMouseEnter:le=>{le.target.style.transform="translateY(-2px)",le.target.style.boxShadow="0 6px 20px rgba(139, 92, 246, 0.4)"},onMouseLeave:le=>{le.target.style.transform="translateY(0)",le.target.style.boxShadow="0 4px 15px rgba(139, 92, 246, 0.3)"},children:" Join the Ladder Now"})]})]}),l&&e.jsx("div",{style:{marginBottom:"20px",padding:"0 20px"},children:e.jsx(Dm,{isPublicView:!0})}),e.jsx(li,{children:e.jsx(eN,{selectedLadder:P,setSelectedLadder:D,setHasManuallySelectedLadder:Q,currentView:g,setCurrentView:f,isPublicView:l,setShowMatchCalendar:te,isAdmin:a})}),!l&&m&&e.jsx(mX,{ladderName:P,currentUser:m}),!l&&e.jsx(hX,{}),!l&&e.jsx("div",{className:"match-fee-container",children:e.jsxs("div",{className:"match-fee-info-bar sticky-match-fee",children:[e.jsx("span",{style:{color:"#10b981",fontWeight:"bold"},children:" Match Fee Info:"}),e.jsxs("span",{style:{marginLeft:"8px"},children:["Winner reports match and pays ",e.jsx("strong",{children:"$5 match fee"})," (one fee per match, not per player)"]})]})}),e.jsx(li,{children:e.jsx(tN,{ladderData:b,isPublicView:l,userLadderData:m,canChallengePlayer:or,getChallengeType:Ue,getChallengeReason:ft,handleChallengePlayer:Lt,handlePlayerClick:Sr,getPlayerStatus:yr,isPositionClaimed:u,selectedLadder:P})}),!l&&e.jsx("button",{onClick:()=>f("main"),className:"back-btn",children:" Back to Main Menu"})]}),un=()=>{console.log(" renderMatchesView - playerMatches:",Ea),console.log(" renderMatchesView - playerMatches length:",Ea.length);const le=[...Ea].sort((he,Be)=>{const ct=new Date(he.scheduledDate||he.completedDate);return new Date(Be.scheduledDate||Be.completedDate)-ct});console.log(" sortedMatches:",le);const _e=[...new Set(le.map(he=>he.status))];console.log(" Available status values:",_e),le.forEach((he,Be)=>{var ct,$t,qe,jt;console.log(` Match ${Be+1}:`,{id:he._id,status:he.status,player1:((ct=he.player1)==null?void 0:ct.firstName)+" "+(($t=he.player1)==null?void 0:$t.lastName),player2:((qe=he.player2)==null?void 0:qe.firstName)+" "+((jt=he.player2)==null?void 0:jt.lastName),scheduledDate:he.scheduledDate,completedDate:he.completedDate})});const Me=le.filter(he=>he.status==="completed");return console.log(" completedMatches count:",Me.length),console.log(" completedMatches:",Me),console.log(" COMPLETED MATCHES ONLY:"),Me.forEach((he,Be)=>{var ct,$t,qe,jt;console.log(`  ${Be+1}. ${(ct=he.player1)==null?void 0:ct.firstName} ${($t=he.player1)==null?void 0:$t.lastName} vs ${(qe=he.player2)==null?void 0:qe.firstName} ${(jt=he.player2)==null?void 0:jt.lastName} - Status: ${he.status}`)}),e.jsxs("div",{className:"matches-view",children:[e.jsx("div",{className:"view-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{children:" My Completed Matches"}),e.jsx("p",{children:"View your completed match history"})]}),e.jsx("button",{onClick:()=>qt("main"),style:{background:"linear-gradient(45deg, #ff4444, #ff6b35)",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"8px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(255, 68, 68, 0.3)"},onMouseEnter:he=>{he.target.style.background="linear-gradient(45deg, #ff5722, #ff9800)",he.target.style.boxShadow="0 6px 20px rgba(255, 68, 68, 0.4)",he.target.style.transform="translateY(-2px)"},onMouseLeave:he=>{he.target.style.background="linear-gradient(45deg, #ff4444, #ff6b35)",he.target.style.boxShadow="0 4px 15px rgba(255, 68, 68, 0.3)",he.target.style.transform="translateY(0)"},children:" Back to Ladder"})]})}),Vi?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading your matches..."})]}):Me.length===0?e.jsxs("div",{className:"no-matches",children:[e.jsx("div",{className:"no-matches-icon",children:""}),e.jsx("h3",{children:"No Completed Matches Yet"}),e.jsx("p",{children:"You haven't completed any matches yet. Challenge another player to get started!"}),e.jsx("button",{onClick:()=>qt("ladders"),className:"challenge-button",children:"View Ladder & Challenge Players"})]}):e.jsx("div",{className:"matches-list",children:Me.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"matches-section-header",children:e.jsxs("h3",{children:[" Completed Matches (",Me.length,")"]})}),Me.map((he,Be)=>{var Ot,dr,ur,bn,Un,ms,fs,Cn,Ur,Cs,Ns,Ts,eo,to;const ct=(Ot=m==null?void 0:m.email)==null?void 0:Ot.toLowerCase(),$t=`${m==null?void 0:m.firstName} ${m==null?void 0:m.lastName}`.toLowerCase();let qe=!1;(dr=he.winner)!=null&&dr.email?qe=he.winner.email.toLowerCase()===ct:(ur=he.winner)!=null&&ur.firstName&&((bn=he.winner)!=null&&bn.lastName)&&(qe=`${he.winner.firstName} ${he.winner.lastName}`.toLowerCase()===$t);const jt=((ms=(Un=he.player1)==null?void 0:Un.email)==null?void 0:ms.toLowerCase())===ct||`${(fs=he.player1)==null?void 0:fs.firstName} ${(Cn=he.player1)==null?void 0:Cn.lastName}`.toLowerCase()===$t;((Cs=(Ur=he.player2)==null?void 0:Ur.email)==null?void 0:Cs.toLowerCase())===ct||`${(Ns=he.player2)==null?void 0:Ns.firstName} ${(Ts=he.player2)==null?void 0:Ts.lastName}`.toLowerCase();const Bt=jt?he.player2:he.player1;return e.jsxs("div",{className:`match-card completed ${qe?"win":"loss"}`,children:[e.jsxs("div",{className:"match-header",children:[e.jsx("div",{className:"match-type",children:he.matchType==="challenge"?" Challenge":he.matchType==="ladder-jump"?" Ladder Jump":he.matchType==="smackdown"?" SmackDown":" Match"}),e.jsx("div",{className:"match-status completed",children:" Completed"}),e.jsxs("div",{className:"match-date",children:[" ",he.completedDate?new Date(he.completedDate).toLocaleDateString():he.scheduledDate?new Date(he.scheduledDate).toLocaleDateString():"N/A"]})]}),e.jsx("div",{className:"opponent-info",children:e.jsxs("div",{className:"opponent-name",children:[e.jsx("span",{className:"vs",children:"vs"})," ",Bt==null?void 0:Bt.firstName," ",Bt==null?void 0:Bt.lastName," ",e.jsxs("span",{className:"rank",children:["#",(Bt==null?void 0:Bt.position)||"N/A"]})]})}),e.jsxs("div",{className:"match-result",children:[e.jsx("div",{className:"result-icon",children:qe?"":""}),e.jsx("div",{className:"result-text",children:qe?`Winner: ${m==null?void 0:m.firstName} ${m==null?void 0:m.lastName}`:`Winner: ${(eo=he.winner)==null?void 0:eo.firstName} ${(to=he.winner)==null?void 0:to.lastName}`}),he.score&&e.jsxs("div",{className:"score-display",children:["Score: ",he.score]})]}),e.jsxs("div",{className:"match-details-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"detail-icon",children:""}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-label",children:"Date"}),e.jsx("div",{className:"detail-value",children:he.completedDate?new Date(he.completedDate).toLocaleDateString():he.scheduledDate?new Date(he.scheduledDate).toLocaleDateString():"N/A"})]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"detail-icon",children:""}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-label",children:"Game"}),e.jsx("div",{className:"detail-value",children:he.gameType||"8-Ball"})]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"detail-icon",children:""}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-label",children:"Race to"}),e.jsx("div",{className:"detail-value",children:he.raceLength||"5"})]})]}),he.venue&&e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"detail-icon",children:""}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-label",children:"Location"}),e.jsx("div",{className:"detail-value",children:he.venue})]})]}),he.ladderDisplayName&&e.jsxs("div",{className:"detail-item",children:[e.jsx("div",{className:"detail-icon",children:""}),e.jsxs("div",{className:"detail-content",children:[e.jsx("div",{className:"detail-label",children:"Ladder"}),e.jsx("div",{className:"detail-value",children:he.ladderDisplayName})]})]})]})]},he._id||Be)})]})})]})},Wn=()=>{var le;return e.jsxs(e.Fragment,{children:[e.jsx(li,{children:e.jsx(aN,{userLadderData:He||m,setShowUnifiedSignup:O,setShowProfileModal:h,isAdmin:a,isProfileComplete:Ce,setShowPaymentDashboard:rt,setShowPaymentInfo:Ja})}),e.jsx(li,{children:e.jsx("div",{style:{marginBottom:"20px",padding:"0 20px"},children:e.jsx(Dm,{isAdmin:a})})}),((m==null?void 0:m.needsClaim)||(m==null?void 0:m.playerId)==="unknown"||(m==null?void 0:m.playerId)==="ladder"&&!Ce&&!((le=m==null?void 0:m.unifiedAccount)!=null&&le.unifiedUserId))&&!a&&e.jsx(li,{children:e.jsxs("div",{className:"profile-completion-timeline",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("h3",{children:" Complete Your Profile To Participate in the Ladder!"}),e.jsx("p",{children:"Add your availability and locations to start receiving challenges from other players:"})]}),e.jsxs("div",{className:"timeline-steps",children:[e.jsxs("div",{className:"timeline-step",children:[e.jsx("div",{className:"step-circle",children:e.jsx("span",{className:"step-number",children:"1"})}),e.jsxs("div",{className:"step-content",children:[e.jsx("h4",{children:"Add Profile Info"}),e.jsx("p",{children:"Availability & locations"})]}),e.jsx("div",{className:"step-connector"})]}),e.jsxs("div",{className:"timeline-step",children:[e.jsx("div",{className:"step-circle",children:e.jsx("span",{className:"step-number",children:"2"})}),e.jsxs("div",{className:"step-content",children:[e.jsx("h4",{children:"Start Playing"}),e.jsx("p",{children:"Challenge others!"})]})]})]}),e.jsx("div",{className:"timeline-action",children:e.jsx("button",{className:"complete-profile-btn",onClick:()=>h(!0),children:" Complete My Profile"})})]})}),e.jsx(li,{children:e.jsx(rN,{isPublicView:l,navigateToView:qt,userLadderData:m,handleSmartMatch:Ar,setCurrentView:f,pendingChallenges:ye,setShowMatchReportingModal:Ve,setShowChallengesModal:Ee,setShowPaymentDashboard:rt,setShowPrizePoolModal:Je,setShowUnifiedSignup:O,setShowRulesModal:A,setShowContactAdminModal:Le,isAdmin:a,setShowApplicationsManager:E,setShowMatchCalendar:te,setShowAdminMessagesModal:Ye,selectedLadder:P,setSelectedTournament:z,setShowTournamentRegistrationModal:R,setShowTournamentInfoModal:W})})]})};return x?e.jsx("div",{className:"ladder-app-container",children:e.jsxs("div",{className:"loading-spinner",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading ladder data..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(UJ,{}),e.jsxs("div",{className:`ladder-app-container ${l?"public-view":""}`,style:l?{maxWidth:"none",width:"100%",minWidth:"100%",border:"0",padding:"0",margin:"0"}:{},children:[g==="ladders"&&rs(),g==="challenge"&&renderChallengeView(),g==="matches"&&un(),g==="main"&&Wn(),!l&&!(m!=null&&m.canChallenge)&&!a&&e.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",color:"#ffc107",marginBottom:"20px"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold"},children:" Challenge Features Locked"}),e.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"0.9rem"},children:(tn=m==null?void 0:m.phaseInfo)!=null&&tn.isFree?"Complete your profile (add available dates and locations) to unlock challenge features during Phase 1 (Testing)!":"To challenge other players and report matches, you need an active membership ($5/month)."}),e.jsx("button",{onClick:()=>setShowClaimFormState(!0),style:{background:"#ff4444",color:"white",border:"none",borderRadius:"6px",padding:"6px 12px",cursor:"pointer",fontSize:"0.8rem"},children:"Create Free Account"})]}),!l&&(m==null?void 0:m.canChallenge)&&((ns=m==null?void 0:m.phaseInfo)==null?void 0:ns.isFree)&&!a&&e.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",color:"#4CAF50",marginBottom:"20px"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold"},children:" Phase 1 (Testing) Active"}),e.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"0.9rem"},children:" FREE access to all features during testing phase! All challenge features are unlocked."}),e.jsxs("p",{style:{margin:"0 0 8px 0",fontSize:"0.85rem",color:"#66BB6A"},children:[" ",e.jsx("strong",{children:"Note:"})," You must complete your profile (add availability and locations) to be able to receive challenges from other players."]})]}),e.jsx("div",{className:"ladder-footer",children:l?e.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#fff"},children:[e.jsx("h3",{style:{color:"#8B5CF6",marginBottom:"15px"},children:" Ladder of Legends "}),e.jsx("p",{style:{marginBottom:"10px",fontSize:"16px"},children:e.jsx("strong",{children:"Ready to join the competition?"})}),e.jsx("p",{style:{marginBottom:"15px",fontSize:"14px",color:"#ccc"},children:"Challenge players, climb the ranks, and compete for prizes!"}),e.jsx("p",{style:{fontSize:"14px",color:"#ffc107"},children:e.jsxs("strong",{children:["Visit ",e.jsx("a",{href:"https://frontrangepool.com",style:{color:"#ffc107",textDecoration:"underline"},children:"FrontRangePool.com"})," to get started!"]})}),e.jsx("p",{style:{fontSize:"12px",color:"#888",marginTop:"15px"},children:" 2025 Front Range Pool League"})]}):e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{children:"Challenge your way to the top! "}),e.jsx("p",{style:{fontSize:"12px",color:"#888",marginTop:"10px"},children:" 2025 Front Range Pool League"})]})}),Ae&&e.jsxs(e.Fragment,{children:[console.log(" LadderApp: Rendering SupabaseSignupModal, showUnifiedSignup:",Ae),console.log(" LadderApp: selectedPlayerForStats:",Dr),e.jsx(JC,{isOpen:Ae,onClose:()=>{console.log(" LadderApp: SupabaseSignupModal onClose called"),O(!1)},claimingPlayer:Dr?{firstName:Dr.firstName,lastName:Dr.lastName,fargoRate:Dr.fargoRate,ladderName:Dr.ladderName,position:Dr.position}:null,onSuccess:le=>{console.log("Signup successful:",le),O(!1),window.location.reload()}})]}),oe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999,padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"100%",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.3)"},children:[e.jsx("h2",{style:{margin:"0 0 16px 0",color:"#333"},children:" Complete Your Profile"}),e.jsx("p",{style:{margin:"0 0 24px 0",color:"#666",lineHeight:"1.5"},children:"Please complete your profile with contact information, availability, and preferred locations to get full ladder access."}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>me(!1),style:{padding:"12px 24px",border:"1px solid #ddd",borderRadius:"6px",background:"#f5f5f5",cursor:"pointer",fontSize:"14px"},children:"Later"}),e.jsx("button",{onClick:()=>{me(!1),O(!0)},style:{padding:"12px 24px",border:"none",borderRadius:"6px",background:"#4CAF50",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Complete Profile"})]})]})}),M&&e.jsx(Wb,{onClose:()=>E(!1),onPlayerApproved:()=>{nt()},userToken}),e.jsx(Ub,{isOpen:T,onClose:()=>A(!1),isMobile:!1,onContactAdmin:()=>Le(!0)}),e.jsx(qb,{isOpen:Ft,onClose:()=>Le(!1)}),e.jsx(WJ,{isOpen:Z,onClose:()=>Ye(!1)}),De&&F&&e.jsx(oN,{isOpen:De,onClose:()=>Oe(!1),challenger:m,defender:F,challengeType:fe,onChallengeComplete:$r}),Ze&&I&&e.jsx(tX,{isOpen:Ze,onClose:()=>et(!1),challenge:I,currentUser:m,onChallengeResponse:dn}),re&&e.jsx(rX,{isOpen:re,onClose:()=>je(!1),challenger:m,availableDefenders:Dt,ladderData:b,onChallengeComplete:$r}),ht&&e.jsx(sX,{isOpen:ht,onClose:()=>Je(!1),selectedLadder:P}),it&&e.jsx(dX,{isOpen:it,onClose:()=>rt(!1),playerEmail:(m==null?void 0:m.email)||`${n}@example.com`}),Ct&&e.jsx(kd,{isOpen:Ct,onClose:()=>{console.log(" LadderApp: Closing calendar"),te(!1)}}),e.jsx(li,{children:e.jsx(Cf,{showMobilePlayerStats:An,selectedPlayerForStats:Dr,setShowMobilePlayerStats:ua,updatedPlayerData:ec,lastMatchData:ha,playerMatchHistory:Js,showFullMatchHistory:Pa,setShowFullMatchHistory:Gi,getPlayerStatus:yr,fetchUpdatedPlayerData:jr,setShowUnifiedSignup:O,isPublicView:l,getChallengeReason:ft,userLadderData:m})}),e.jsx(li,{children:e.jsx(sN,{showFullMatchHistory:Pa,selectedPlayerForStats:Dr,setShowFullMatchHistory:Gi,setShowMobilePlayerStats:ua,playerMatchHistory:Js,isPublicView:l})}),ks&&e.jsx(uX,{isOpen:ks,onClose:()=>Ra(!1),onPermissionGranted:()=>{Ra(!1),console.log(" Notification permission granted!")}})]}),V&&e.jsx(oX,{isOpen:V,onClose:()=>Ee(!1),pendingChallenges:ye,sentChallenges:lt,scheduledMatches:ge,onViewChallenge:le=>{Ee(!1),X(le),et(!0)},onReportMatch:le=>{Ee(!1),Re(le._id||le.id),Ve(!0)},onRescheduleRequest:le=>{Ee(!1),Fn(le),Wt(!0)},onReportNoShow:le=>{Ee(!1),Fn(le),pt(!0)}}),e.jsx(aX,{isOpen:Pe,onClose:()=>{Ve(!1),Re(null)},playerName:r,selectedLadder:P,isAdmin:a,userLadderData:m,setShowPaymentDashboard:rt,preselectedMatchId:we,onMatchReported:le=>{nt(),wt()},onPaymentInfoModalReady:le=>{We(()=>le)}}),Fe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e4,overflow:"auto",boxSizing:"border-box"},children:e.jsxs("div",{style:{background:"rgba(20, 20, 20, 0.95)",border:"2px solid rgba(255, 68, 68, 0.3)",borderRadius:"12px",padding:"0.75rem 1rem",maxWidth:"800px",width:"min(6500px, 95vw)",maxHeight:"calc(100vh - 2rem)",overflowY:"auto",position:"relative",margin:"auto"},children:[e.jsx("button",{onClick:()=>st(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",color:"#ccc",fontSize:"1.5rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:le=>{le.target.style.background="rgba(255, 255, 255, 0.1)",le.target.style.color="#fff"},onMouseLeave:le=>{le.target.style.background="none",le.target.style.color="#ccc"},children:""}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"0.75rem"},children:[e.jsx("h2",{style:{color:"#ff4444",margin:"0 0 0.25rem 0",fontSize:"1.35rem"},children:" Payment Information"}),e.jsx("p",{style:{color:"#ccc",margin:0,fontSize:"0.85rem"},children:"Subscription and match reporting fees"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(180px, 1fr))",gap:"0.75rem",margin:"0 auto"},children:[e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#2196f3",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Monthly Membership - $5/mo"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"Includes:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsx("li",{children:"Access to all ladder divisions"}),e.jsx("li",{children:"Challenge other players"}),e.jsx("li",{children:"View ladder standings and statistics"}),e.jsx("li",{children:"Participate in tournaments and events"}),e.jsx("li",{children:"Receive notifications and updates"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Phase 1 (Testing) FREE until Jan 1, 2026."})]})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#4caf50",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Match Fee - $5/match"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"How it works:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsxs("li",{children:["Only the ",e.jsx("strong",{children:"winner"})," pays the $5 fee"]}),e.jsx("li",{children:"One fee per match (not per player)"}),e.jsx("li",{children:"Fee is paid when reporting the match result"}),e.jsx("li",{children:"$3 to prize pool, $2 to platform"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#ff9800",fontSize:"0.75rem"},children:"Winner pays $5; loser pays nothing."}),e.jsx("p",{style:{margin:"0.25rem 0 0 0",fontStyle:"italic",color:"#8b5cf6",fontSize:"0.7rem"},children:" Tournaments fund prize pools too"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#ffc107",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Payment Methods"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"We accept:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsx("li",{children:"CashApp"}),e.jsx("li",{children:"Venmo"}),e.jsx("li",{children:"PayPal"}),e.jsx("li",{children:"Credit/Debit (Square)"}),e.jsx("li",{children:"Credits (pre-purchased)"})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Tip: Buy credits for instant reporting!"})]})]}),e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"8px",padding:"0.6rem 0.75rem"},children:[e.jsx("h3",{style:{color:"#9c27b0",margin:"0 0 0.4rem 0",fontSize:"1rem"},children:" Trust & Verification"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.8rem",lineHeight:"1.4"},children:[e.jsx("p",{style:{margin:"0 0 0.3rem 0"},children:e.jsx("strong",{children:"Verification:"})}),e.jsxs("ul",{style:{margin:"0 0 0.4rem 0",paddingLeft:"1.2rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"New:"})," Admin verify (24-48hrs)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Verified:"})," 3+ payments = auto"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trusted:"})," 10+ = instant"]})]}),e.jsx("p",{style:{margin:0,fontStyle:"italic",color:"#4caf50",fontSize:"0.75rem"},children:"Build trust for faster processing!"})]})]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"0.75rem"},children:e.jsx("button",{onClick:()=>st(!1),style:{background:"rgba(255, 68, 68, 0.8)",color:"#fff",border:"none",padding:"8px 20px",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:le=>{le.target.style.background="rgba(255, 68, 68, 1)"},onMouseLeave:le=>{le.target.style.background="rgba(255, 68, 68, 0.8)"},children:"Close"})})]})}),e.jsx(iX,{isOpen:dt,onClose:()=>{pt(!1),Fn(null)},match:Pr,currentUser:m,onForfeitSubmitted:le=>{console.log("Forfeit submitted:",le),pt(!1),Fn(null),nt()}}),e.jsx(lX,{isOpen:Tt,onClose:()=>{Wt(!1),Fn(null)},match:Pr,currentUser:m,onRescheduleSubmitted:le=>{console.log("Reschedule requested:",le),Wt(!1),Fn(null),nt()}}),e.jsx(cX,{isOpen:ir,onClose:()=>{rr(!1),cn(null)},rescheduleRequest:hs,currentUser:m,onResponseSubmitted:(le,_e)=>{console.log("Reschedule response:",le,_e),rr(!1),cn(null),nt()}}),U&&e.jsx(iN,{isOpen:k,onClose:()=>{R(!1),z(null)},tournamentId:U.id,currentUser:m,onRegistrationComplete:()=>{nt()}}),e.jsx(fX,{isOpen:$,onClose:()=>W(!1),tournament:U})]})},cN=({isOpen:n,onClose:t,onSignup:r})=>{const s=yn(),[a,o]=y.useState([]),[i,l]=y.useState(!0),[c,d]=y.useState("499-under"),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState(!1),[w,x]=y.useState(null),[j,S]=y.useState(!1),[_,C]=y.useState(!1),N=T=>{switch(T){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return T}},M=T=>{if(!T||T==="Unknown")return"Unknown";const A=T.trim().split(" ");if(A.length===1)return A[0];{const k=A[0],R=A[A.length-1];return`${k} ${R.charAt(0)}.`}},E=T=>{console.log("Player clicked:",T),h(T),g(!0),console.log("Modal should be opening...")},P=()=>{g(!1),h(null)};y.useEffect(()=>{n&&D()},[n,c]);const D=async()=>{var T;try{l(!0),console.log("Fetching players for ladder:",c);const A=await mt.getLadderPlayersByName(c);if(console.log(" [LADDER DATA] Supabase result:",A),console.log(` [LADDER DATA] Success: ${A.success}, Player count: ${((T=A.data)==null?void 0:T.length)||0}`),A.success&&Array.isArray(A.data)){console.log(" [LADDER DATA] First 5 players from Supabase:",A.data.slice(0,5).map(z=>{var $,W;return{position:z.position,name:`${(($=z.users)==null?void 0:$.first_name)||""} ${((W=z.users)==null?void 0:W.last_name)||""}`,is_active:z.is_active}}));const k=A.data.map(async z=>{var W,Y,Q,H;let $=null;if((W=z.users)!=null&&W.email)try{const ue=await mt.getPlayerLastMatch(z.users.email);ue.success&&ue.data&&($=ue.data)}catch(ue){console.log(`Error fetching last match for ${z.users.email}:`,ue)}return{_id:z.id,email:((Y=z.users)==null?void 0:Y.email)||"",firstName:((Q=z.users)==null?void 0:Q.first_name)||"",lastName:((H=z.users)==null?void 0:H.last_name)||"",position:z.position,fargoRate:z.fargo_rate||0,totalMatches:z.total_matches||0,wins:z.wins||0,losses:z.losses||0,isActive:z.is_active,immunityUntil:z.immunity_until,vacationMode:z.vacation_mode,vacationUntil:z.vacation_until,lastMatch:$}}),R=await Promise.all(k);console.log(` [LADDER DATA] Transformed ${R.length} players with last matches`);const U=R.sort((z,$)=>z.position-$.position);console.log(" [LADDER DATA] First 5 players after sorting:",U.slice(0,5).map(z=>({position:z.position,name:`${z.firstName} ${z.lastName}`}))),o(U)}else console.error("Failed to fetch players from Supabase:",A.error),o([])}catch(A){console.error("Error fetching players:",A),o([])}finally{l(!1)}};return n?xr.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .standalone-last-match-header {
          transform: none !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          padding-left: 0 !important;
          padding-right: 0 !important;
          text-align: center !important;
          justify-content: center !important;
        }
        
        @media (min-width: 769px) {
          .ladder-table:not(.logged-in-view) .table-cell.name {
            padding-left: 0px !important;
            margin-left: 0px !important;
            transform: translateX(0px) !important;
          }
        }
        
        /* Maximum specificity override for the 80px transform */
        .ladder-table:not(.logged-in-view) .table-cell.name {
          transform: translateX(0px) !important;
        }
        
        .public-ladder-player-name {
          transform: translateX(0px) !important;
        }
        
        @media (max-width: 768px) {
          .w-header-mobile {
            margin-left: -20px !important;
            transform: translateX(-20px) !important;
            position: relative !important;
            left: -20px !important;
            background-color: transparent !important;
          }
          
          .l-header-mobile {
            margin-left: -25px !important;
            transform: translateX(-25px) !important;
            position: relative !important;
            left: -25px !important;
          }
          
          .l-data-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
          
          .last-match-header-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
          
          .last-match-data-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
        }
        
        .quick-action-button.rules-btn {
          background: linear-gradient(45deg, #ff6b35, #f7931e) !important;
          border: 1px solid rgba(255, 107, 53, 0.3) !important;
          color: white !important;
          box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3) !important;
        }
        
        .quick-action-button.rules-btn:hover {
          background: linear-gradient(45deg, #ff5722, #ff9800) !important;
          box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4) !important;
          transform: translateY(-2px) !important;
        }
        
      `}),e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,padding:window.innerWidth<=768?"0px":"20px",boxSizing:"border-box"},onClick:t,children:[e.jsxs("div",{style:{background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",borderRadius:window.innerWidth<=768?"0px":"15px",boxShadow:window.innerWidth<=768?"none":"0 0 40px #8B5CF6, 0 0 60px rgba(0,0,0,0.9)",width:window.innerWidth<=768?"100vw":"50vw",maxWidth:window.innerWidth<=768?"100vw":"1200px",minWidth:window.innerWidth<=768?"100vw":"800px",height:window.innerWidth<=768?"100vh":"95vh",maxHeight:window.innerWidth<=768?"100vh":"95vh",display:"flex",flexDirection:"column",position:"relative",overflow:"auto",boxSizing:"border-box"},onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #c0c0c0 0%, #a8a8a8 100%)",padding:window.innerWidth<=768?"8px 12px":"15px 20px",borderRadius:"0px",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",margin:"0",width:"100%",boxSizing:"border-box"},children:[e.jsx("h2",{style:{margin:0,color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontSize:window.innerWidth<=768?"1.2rem":"1.6rem",fontWeight:"bold",textAlign:"center",paddingRight:window.innerWidth<=768?"50px":"60px",paddingLeft:window.innerWidth<=768?"50px":"60px",letterSpacing:window.innerWidth<=768?"1px":"2px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase"},children:" Ladder of Legends - Public View"}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#333",fontSize:window.innerWidth<=768?"1.5rem":"1.8rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:window.innerWidth<=768?"30px":"35px",height:window.innerWidth<=768?"30px":"35px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease",position:"absolute",right:window.innerWidth<=768?"12px":"20px",top:"50%",transform:"translateY(-50%)"},onMouseOver:T=>T.currentTarget.style.backgroundColor="rgba(0,0,0,0.1)",onMouseOut:T=>T.currentTarget.style.backgroundColor="transparent",children:""})]}),e.jsx("div",{style:{background:"rgba(229, 62, 62, 0.15)",border:window.innerWidth<=768?"1px solid rgba(229, 62, 62, 0.4)":"2px solid rgba(229, 62, 62, 0.4)",padding:window.innerWidth<=768?"8px 10px":"12px 20px",textAlign:"center",flexShrink:0,margin:window.innerWidth<=768?"4px 10px 4px 10px":"10px 20px 10px 20px",borderRadius:window.innerWidth<=768?"6px":"0px"},children:e.jsx("div",{style:{color:"#e53e3e",fontWeight:"600",fontSize:window.innerWidth<=768?"0.75rem":"1rem",lineHeight:window.innerWidth<=768?"1.2":"1.5"},children:window.innerWidth<=768?" Public View - Limited Access":e.jsxs(e.Fragment,{children:[" Public View - Anyone can view the ladder rankings.",e.jsx("br",{}),"Members get access to many more features when logged into the Hub"]})})}),e.jsx("div",{style:{margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0},children:e.jsx(Dm,{userPin:"GUEST",isPublicView:!0})}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",border:"2px solid rgba(255, 193, 7, 0.3)",borderRadius:"12px",padding:window.innerWidth<=768?"12px":"16px",margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0,display:"flex",flexDirection:window.innerWidth<=768?"column":"row",gap:window.innerWidth<=768?"12px":"16px"},children:[e.jsxs("div",{style:{flex:1,padding:window.innerWidth<=768?"8px":"12px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid rgba(76, 175, 80, 0.3)",textAlign:"center"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#4CAF50",fontSize:window.innerWidth<=768?"0.9rem":"1.0rem"},children:" How to Claim Your Position:"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"1. Find your name and click on it"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:'2. Click "Claim My Ladder Position"'}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:'3. Click "Claim with Google" to link your account'}),e.jsx("p",{style:{margin:"0 0 0 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"4. Wait for admin approval  Log in with Google or email!"})]}),e.jsxs("div",{style:{flex:1,padding:window.innerWidth<=768?"8px":"12px",background:"rgba(255, 193, 7, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 193, 7, 0.3)",textAlign:"center"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#ffc107",fontSize:window.innerWidth<=768?"0.9rem":"1.0rem"},children:" How to Join as New Player:"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"1. Click 'Join The Ladder' button below"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"2. Sign up with Google or email (name, email, password)"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"3. Wait for admin approval (usually 24 hours)"}),e.jsx("p",{style:{margin:"0 0 0 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"4. After admin approval, start playing!"})]})]}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:window.innerWidth<=768?"12px":"16px",margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0,textAlign:"center"},children:[e.jsx("h3",{style:{color:"#8b5cf6",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"1rem":"1.2rem",fontWeight:"bold"},children:" Already Have an Account?"}),e.jsx("p",{style:{color:"#ccc",margin:"0 0 12px 0",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",lineHeight:"1.4"},children:"Log in to access the full ladder app with all features!"}),e.jsx("button",{onClick:()=>{t(),s("/hub")},style:{background:"linear-gradient(45deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",padding:window.innerWidth<=768?"10px 16px":"12px 24px",fontSize:window.innerWidth<=768?"0.9rem":"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(139, 92, 246, 0.3)",textDecoration:"none",display:"inline-block"},onMouseEnter:T=>{T.target.style.transform="translateY(-2px)",T.target.style.boxShadow="0 6px 20px rgba(139, 92, 246, 0.4)"},onMouseLeave:T=>{T.target.style.transform="translateY(0)",T.target.style.boxShadow="0 4px 15px rgba(139, 92, 246, 0.3)"},children:" Log In to Ladder"})]}),e.jsxs("div",{className:"ladder-header-section",children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:window.innerWidth<=768?"8px":"15px",display:"flex",gap:window.innerWidth<=768?"15px":"20px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"quick-action-button view-ladder-btn",onClick:()=>{r&&r(),t()},style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Join Ladder":"Join The Ladder"}),e.jsx("button",{className:"quick-action-button calendar-btn",onClick:()=>m(!0),style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Calendar":"Ladder Calendar"}),e.jsx("button",{className:"quick-action-button rules-btn",onClick:()=>S(!0),style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Rules":"View Rules"})]}),e.jsx("h1",{className:"ladder-main-title",style:{color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontWeight:"bold",fontSize:window.innerWidth<=768?"2.2rem":"3.2rem",letterSpacing:window.innerWidth<=768?"2px":"3px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase",marginBottom:"0.2rem",marginTop:"0.5rem"},children:"Ladder of Legends"}),e.jsx("p",{className:"ladder-subtitle",style:{marginBottom:"0.8rem",marginTop:"0rem",fontSize:"0.8rem"},children:"Tournament Series"}),e.jsxs("div",{className:"ladder-selector",style:{marginTop:window.innerWidth<=768?"0.1rem":"0.5rem",padding:window.innerWidth<=768?"0.3rem 0.5rem 0.4rem 0.5rem":"0.6rem",background:"rgba(0, 0, 0, 0.3)",borderRadius:window.innerWidth<=768?"6px":"8px",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:window.innerWidth<=768?"0.2rem":"0.5rem",margin:window.innerWidth<=768?"0.1rem 0.6rem 0 0.6rem":"0",boxSizing:"border-box"},children:[e.jsx("p",{className:"ladder-selection-title",style:{margin:"0",color:"#ffffff",fontSize:window.innerWidth<=768?"0.65rem":"0.9rem",fontWeight:"600",textAlign:"center",order:(window.innerWidth<=768,1),lineHeight:window.innerWidth<=768?"1.0":"normal"},children:window.innerWidth<=768?"Select Ladder":"Select Ladder:"}),e.jsxs("select",{value:c,onChange:T=>d(T.target.value),style:{padding:window.innerWidth<=768?"0.4rem 0.6rem":"0.4rem 0.8rem",borderRadius:window.innerWidth<=768?"4px":"6px",border:"1px solid rgba(255, 255, 255, 0.3)",background:"rgba(0, 0, 0, 0.5)",color:"#ffffff",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",minWidth:window.innerWidth<=768?"120px":"180px",maxWidth:window.innerWidth<=768?"70%":"none",width:(window.innerWidth<=768,"auto"),textAlign:"center",order:(window.innerWidth<=768,2),boxSizing:"border-box"},children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"})]})]}),e.jsx("h2",{className:"ladder-active-title",style:{color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontWeight:"bold",fontSize:window.innerWidth<=768?"1.6rem":"2.4rem",letterSpacing:window.innerWidth<=768?"1px":"2px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase",marginBottom:window.innerWidth<=768?"0.2rem":"0.3rem",marginTop:window.innerWidth<=768?"0.3rem":"0.5rem"},children:N(c).toUpperCase()}),e.jsx("p",{className:"ladder-selection-subtitle",style:{margin:window.innerWidth<=768?"0 0 0.3rem 0":"0 0 0.5rem 0",color:"#cccccc",fontSize:window.innerWidth<=768?"0.8rem":"0.85rem"},children:"Current rankings and positions"})]}),e.jsx("div",{style:{flex:1,overflow:"visible",padding:window.innerWidth<=768?"0 12px 0 12px":"0 20px 0 20px",marginBottom:window.innerWidth<=768?"10px":"20px"},children:i?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#ccc",fontSize:"1.2rem"},children:"Loading ladder data..."}):e.jsx("div",{className:"ladder-table-modal",style:{width:"100%",maxWidth:"100%",minWidth:"100%",overflow:"visible",boxSizing:"border-box"},children:e.jsxs("div",{className:"ladder-table",style:{width:"100%",minWidth:"100%",maxWidth:"100%",overflow:"visible",boxSizing:"border-box",background:"rgba(10, 10, 20, 0.98)",backdropFilter:"blur(15px)",boxShadow:"0 4px 20px rgba(107, 70, 193, 0.4)",borderBottom:"2px solid rgba(107, 70, 193, 0.5)",borderRadius:"8px",padding:"12px 0"},children:[e.jsxs("div",{className:"table-header",style:{display:"flex",width:"100%",minWidth:"100%",padding:window.innerWidth<=768?"8px 15px":"10px 20px",borderBottom:"1px solid rgba(107, 70, 193, 0.3)"},children:[e.jsx("div",{className:"header-cell",style:{width:"80px",padding:window.innerWidth<=768?"6px 0 6px 0":"10px 0",fontWeight:"bold",color:"#FFD700",textAlign:"center",fontSize:window.innerWidth<=768?"0.8rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 6px #FFD700, 0 0 12px #FFD700",marginLeft:window.innerWidth<=768?"-10px":"0",paddingLeft:(window.innerWidth<=768,"0"),transform:window.innerWidth<=768?"translateX(-5px)":"none"},children:"Rank"}),e.jsx("div",{className:"header-cell",style:{flex:"1",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0 10px 10px",fontWeight:"bold",color:"#ffffff",textAlign:"left",fontSize:window.innerWidth<=768?"0.75rem":"1rem",display:"flex",justifyContent:(window.innerWidth<=768,"flex-start"),alignItems:"center",textShadow:"0 0 8px #8B5CF6, 0 0 15px #8B5CF6",marginLeft:window.innerWidth<=768?"-20px":"0"},children:"Player"}),e.jsx("div",{className:"header-cell w-header-mobile",style:{width:"60px",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0",fontWeight:"bold",color:"#4CAF50",textAlign:"center",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 8px #4CAF50, 0 0 15px #4CAF50",marginLeft:window.innerWidth<=768?"-10px":"0",position:"relative",left:window.innerWidth<=768?"-10px":"0"},children:"W"}),e.jsx("div",{className:"header-cell l-header-mobile",style:{width:"60px",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0",fontWeight:"bold",color:"#f44336",textAlign:"center",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 8px #f44336, 0 0 15px #f44336",marginLeft:window.innerWidth<=768?"-5px":"0",position:"relative",left:window.innerWidth<=768?"-5px":"0"},children:"L"}),e.jsx("div",{className:"last-match-header-mobile",style:{flex:"1",fontWeight:"bold",color:"#ffffff",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"6px 0":"10px 0",textShadow:"0 0 8px #8B5CF6, 0 0 15px #8B5CF6"},children:"Last Match"})]}),a.map(T=>e.jsxs("div",{className:`table-row ${T.position===1?"first-place-row":""}`,style:{display:"flex",width:"100%",minWidth:"100%",alignItems:"center",cursor:"pointer",padding:window.innerWidth<=768?"6px 15px":"8px 20px",borderBottom:"1px solid rgba(107, 70, 193, 0.1)"},onClick:()=>E(T),children:[e.jsxs("div",{className:"table-cell rank",style:{width:"80px",padding:window.innerWidth<=768?"3px 0 3px 0":"5px 0",color:T.position===1?"#FFD700":"#ffffff",textAlign:window.innerWidth<=768?"left":"center",fontSize:T.position===1?"1.2rem":window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:window.innerWidth<=768?"block":"flex",justifyContent:window.innerWidth<=768?"flex-start":"center",alignItems:"center",marginLeft:window.innerWidth<=768?"-5px":"0",paddingLeft:window.innerWidth<=768?"8px":"0",textShadow:T.position===1?"0 0 8px #FFD700":"none"},children:[T.position===1?" ":"","#",T.position]}),e.jsxs("div",{className:"table-cell name public-ladder-player-name",style:{flex:"1",padding:window.innerWidth<=768?"3px 0 3px 8px":"5px 0 5px 0px",color:T.position===1?"#FFD700":"#ffffff",fontSize:T.position===1?"1.15rem":window.innerWidth<=768?"1.1rem":"0.9rem",fontWeight:T.position===1?"600":"normal",textShadow:T.position===1?"0 0 5px rgba(255, 215, 0, 0.5)":"none",position:"relative",textAlign:"left",whiteSpace:"nowrap",display:"flex",justifyContent:"flex-start",alignItems:"center",marginLeft:window.innerWidth<=768?"0":"100px",transform:"none",backgroundColor:"transparent",left:window.innerWidth<=768?"0":"100px"},children:[T.position===1&&e.jsx("span",{style:{position:"absolute",top:"-14px",left:"-2px",fontSize:"1.3rem",transform:"rotate(-10deg)",zIndex:10,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:""}),e.jsxs("div",{className:"player-name-clickable",style:{whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",lineHeight:window.innerWidth<=768?"1.3":"1.2"},children:[T.firstName," ",T.lastName?T.lastName.charAt(0)+".":""]})]}),e.jsx("div",{className:"table-cell wins",style:{width:"60px",padding:window.innerWidth<=768?"3px 0":"5px 0",color:"#4CAF50",textAlign:"center",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:"flex",justifyContent:"center",alignItems:"center"},children:T.wins||0}),e.jsx("div",{className:"table-cell losses l-data-mobile",style:{width:"60px",padding:window.innerWidth<=768?"3px 0":"5px 0",color:"#f44336",textAlign:"center",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:"flex",justifyContent:"center",alignItems:"center"},children:T.losses||0}),e.jsx("div",{className:"table-cell last-match last-match-data-mobile",style:{flex:"1",fontSize:window.innerWidth<=768?"0.7rem":"0.9rem",padding:window.innerWidth<=768?"3px 0":"5px 0",whiteSpace:"nowrap",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:T.lastMatch?e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.65rem":"0.9rem",fontWeight:"bold",color:T.lastMatch.result==="W"?"#4CAF50":"#f44336",whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",hyphens:window.innerWidth<=768?"auto":"none",display:window.innerWidth<=768?"block":"inline",lineHeight:window.innerWidth<=768?"1.3":"1.2",maxWidth:window.innerWidth<=768?"none":"auto",minWidth:window.innerWidth<=768?"0":"auto"},children:[T.lastMatch.result==="W"?"W":"L"," vs ",M(T.lastMatch.opponent)]}):e.jsx("span",{style:{fontSize:window.innerWidth<=768?"0.65rem":"0.8rem",color:"#999",whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",hyphens:window.innerWidth<=768?"auto":"none",display:window.innerWidth<=768?"block":"inline",lineHeight:window.innerWidth<=768?"1.3":"1.2",maxWidth:window.innerWidth<=768?"none":"auto",minWidth:window.innerWidth<=768?"0":"auto"},children:"No matches"})})]},T._id))]})})}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:window.innerWidth<=768?"10px":"12px",margin:window.innerWidth<=768?"0 15px 15px 15px":"0 20px 20px 20px",flexShrink:0,clear:"both"},children:[e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 8px 0",fontSize:"0.9rem",fontWeight:"600",textAlign:"center"},children:" Ready to Join the Ladder?"}),e.jsx("p",{style:{color:"#ccc",margin:"0 0 8px 0",fontSize:"0.8rem",fontStyle:"italic",textAlign:"center"},children:"BCA Sanctioned - Fargo Reported Tournament Series"}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"0",color:"#bbb",fontSize:"0.75rem",lineHeight:"1.4",textAlign:"center",listStyle:"none"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BCA Sanctioned"})," - Official tournament play"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Professional System"})," - Advanced ladder management"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fair Competition"})," - Challenge your way up the rankings"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pools"})," + Earn your bragging rights!"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Community"})," - Join Colorado's premier singles play pool community"]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"12px"},children:e.jsx("button",{onClick:()=>{r&&r(),t()},style:{padding:"8px 16px",background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 2px 6px rgba(76, 175, 80, 0.3)"},children:" Join the Ladder Now"})})]})]}),p&&u&&e.jsx("div",{onClick:T=>T.stopPropagation(),children:e.jsx(Cf,{showMobilePlayerStats:p,selectedPlayerForStats:u,setShowMobilePlayerStats:P,updatedPlayerData:u,lastMatchData:u.lastMatch,playerMatchHistory:[],showFullMatchHistory:!1,setShowFullMatchHistory:()=>{},getPlayerStatus:()=>"active",fetchUpdatedPlayerData:()=>{},setShowUnifiedSignup:()=>{x(u?{firstName:u.firstName,lastName:u.lastName,fargoRate:u.fargoRate,ladderName:u.ladderName,position:u.position}:null),b(!0),setTimeout(()=>{g(!1),h(null)},100)},isPublicView:!0})}),e.jsx(kd,{isOpen:f,onClose:()=>m(!1)}),e.jsx(XC,{isOpen:v,onClose:()=>{b(!1),x(null)},claimingPlayer:w}),e.jsx(Ub,{isOpen:j,onClose:()=>S(!1),isMobile:window.innerWidth<=768,onContactAdmin:()=>C(!0)}),e.jsx(qb,{isOpen:_,onClose:()=>C(!1)})]})]}),document.body):null};function gX({onSuccess:n,onShowClaimFlow:t}){const[r,s]=y.useState(""),[a,o]=y.useState(!1);y.useState(!1);const i=async()=>{s(""),o(!0),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const c=typeof window<"u"&&window.location.pathname||"/hub";localStorage.setItem("oauthReturnTo",c||"/hub"),localStorage.setItem("pendingOAuthSignup",JSON.stringify({isNewSignup:!0,ladderName:"499-under",fargoRate:"400"}));try{const d=await Hl.signInWithOAuth("google");d.success||(s(d.message||"Failed to sign in with Google."),o(!1),localStorage.removeItem("pendingOAuthSignup"))}catch(d){console.error("Google OAuth error:",d),s("Failed to sign in. Please try again."),o(!1),localStorage.removeItem("pendingOAuthSignup")}},l=typeof window<"u"&&window.innerWidth<=768;return e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.9), rgba(30, 30, 30, 0.95))",border:"2px solid #e53e3e",borderRadius:l?12:16,padding:l?24:32,width:"100%",maxWidth:420,color:"#fff",boxShadow:"0 10px 40px rgba(0,0,0,0.4)"},children:[e.jsx("h2",{style:{margin:"0 0 8px 0",fontSize:l?"1.4rem":"1.6rem",fontWeight:"bold",textAlign:"center"},children:"Welcome"}),e.jsx("p",{style:{margin:"0 0 24px 0",color:"#aaa",fontSize:"0.95rem",textAlign:"center"},children:"One account for League & Ladder"}),r&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.2)",border:"1px solid rgba(220, 53, 69, 0.5)",padding:12,borderRadius:8,marginBottom:20,color:"#ff6b6b",fontSize:"0.9rem"},children:r}),e.jsxs("button",{type:"button",onClick:i,disabled:a,style:{width:"100%",padding:16,background:"#fff",color:"#333",border:"1px solid #ddd",borderRadius:10,fontSize:"1.05rem",fontWeight:600,cursor:a?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:12,opacity:a?.7:1,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"",style:{height:24,width:24}}),a?"Signing in...":"Continue with Google"]}),t&&e.jsxs("p",{style:{margin:"20px 0 0 0",textAlign:"center",fontSize:"0.9rem",color:"#aaa"},children:["Already on the ladder?"," ",e.jsx("button",{type:"button",onClick:t,style:{background:"none",border:"none",color:"#60a5fa",textDecoration:"underline",cursor:"pointer",fontSize:"inherit"},children:"Claim your position"})]}),e.jsx("p",{style:{margin:"20px 0 0 0",fontSize:"0.8rem",color:"#888",textAlign:"center"},children:"New or returning  same button. Admin approval required for first-time signup."})]})}const xX=()=>{const n=yn(),[t,r]=y.useState("info"),[s,a]=y.useState(null),[o,i]=y.useState(!0),[l,c]=y.useState(null),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[g,f]=y.useState({firstName:"",lastName:"",email:"",phone:"",experience:"beginner",fargoRate:"",currentLeague:"",currentRanking:"",message:"",payNow:!1,paymentMethod:"",availability:"",locations:""});y.useState(!1);const[m,v]=y.useState(null);y.useState(!1);const[b,w]=y.useState(!1),[x,j]=y.useState(null),[S,_]=y.useState("");y.useEffect(()=>{M(),N(),C(),new URLSearchParams(window.location.search).get("openModal")==="true"&&(console.log("Auto-opening ladder modal from URL parameter"),u(!0),window.history.replaceState({},document.title,window.location.pathname))},[]);const C=async()=>{try{if(new URLSearchParams(window.location.search).get("paymentSuccess")==="true"){console.log(" User returned from successful payment!"),alert(" Welcome back! Your payment was successful and your ladder position has been claimed. You now have access to all ladder features!"),window.history.replaceState({},document.title,window.location.pathname);const W=JSON.parse(localStorage.getItem("lastClaimedPosition")||"{}");W.ladder&&W.position&&(R(W.ladder,W.position),localStorage.removeItem("lastClaimedPosition"))}}catch(z){console.error("Error checking payment status:",z)}},N=async()=>{try{const z=await fetch(`${Ie}/api/payment-config`);if(z.ok){const $=await z.json();console.log("Payment config loaded:",$),console.log("Config structure:",$.config),console.log("Promotional message:",$.promotionalMessage),v($)}else console.error("Failed to load payment config:",z.status)}catch(z){console.error("Error loading payment config:",z)}},M=async()=>{try{i(!0);const z=await fetch(`${Ie}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:"guest@frontrangepool.com"})});if(z.ok){const $=await z.json();a($.user),console.log("Guest user authenticated:",$.user)}else{const $=await z.json();console.error("Guest authentication failed:",$),c("Failed to authenticate guest user")}}catch(z){console.error("Error authenticating guest:",z),c("Network error during authentication")}finally{i(!1)}},E=()=>{n("/")},P=()=>{p(!0)},D=z=>{console.log("Opening claim modal for position:",z),j(z),w(!0);const $=Math.floor(1e3+Math.random()*9e3).toString();_($),f({firstName:z.firstName,lastName:z.lastName,email:"",phone:"",experience:"beginner",fargoRate:z.fargoRate||"",currentLeague:"",currentRanking:"",message:"",payNow:!1,paymentMethod:"",availability:"",locations:""}),setShowJoinModal(!0)},[T,A]=y.useState(new Set),k=z=>T.has(`${z.ladder}-${z.position}`),R=(z,$)=>{A(W=>new Set([...W,`${z}-${$}`]))},U={onLogout:()=>{n("/")}};return o?e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" Ladder of Legends - Guest Preview"}),e.jsx("p",{children:"Loading guest access..."}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"})]}),e.jsx("div",{className:"loading-spinner",children:"Authenticating guest user..."})]}):l?e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" Ladder of Legends - Guest Preview"}),e.jsx("p",{children:"Error loading guest access"}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"})]}),e.jsxs("div",{className:"error-message",children:[e.jsxs("p",{children:["Error: ",l]}),e.jsx("button",{onClick:E,className:"back-btn",children:" Back to Hub"})]})]}):e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" Ladder of Legends - Guest Preview"}),e.jsx("p",{children:"Experience the actual Ladder of Legends interface with limited functionality"}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"})]}),e.jsxs("div",{className:"apps-section",children:[e.jsx("h2",{className:"section-title",children:"Available Options"}),e.jsxs("div",{className:"apps-grid active-apps",children:[e.jsxs("div",{className:"app-card active guest-mode",style:{"--app-color":"#4CAF50"},onClick:()=>u(!0),children:[e.jsx("div",{className:"app-icon",children:""}),e.jsxs("div",{className:"app-info",children:[e.jsx("h3",{children:"View Ladder"}),e.jsx("p",{children:"Browse the current ladder rankings and player standings"}),e.jsx("div",{className:"app-status",children:e.jsx("span",{className:"status-guest-preview",children:"Try Demo"})})]})]}),e.jsxs("div",{className:"app-card active guest-mode",style:{"--app-color":"#2196F3"},onClick:()=>r("app"),children:[e.jsx("div",{className:"app-icon",children:""}),e.jsxs("div",{className:"app-info",children:[e.jsx("h3",{children:"Try App Interface"}),e.jsx("p",{children:"Experience the full ladder interface with limited functionality"}),e.jsx("div",{className:"app-status",children:e.jsx("span",{className:"status-guest-preview",children:"Try Demo"})})]})]})]})]}),e.jsxs("div",{className:"guest-actions",style:{textAlign:"center",marginTop:"20px"},children:[e.jsx("button",{type:"button",onClick:E,className:"back-btn",style:{marginRight:"10px"},children:" Back to Hub"}),e.jsx("button",{type:"button",onClick:()=>r("info"),className:"info-btn",style:{marginRight:"10px"},children:" Ladder Info"}),e.jsx("button",{type:"button",onClick:P,className:"join-btn",children:"Join Ladder"})]}),e.jsxs("div",{className:"content-area",children:[console.log("Current view is:",t),t==="app"&&e.jsxs("div",{className:"app-preview-section",children:[e.jsxs("div",{className:"guest-notice",children:[e.jsx("h3",{children:" Interactive App Preview"}),e.jsx("p",{children:"You can explore the actual Ladder of Legends interface below. Try clicking buttons and opening modals to see how it works!"}),e.jsxs("div",{className:"guest-limitations",style:{textAlign:"center"},children:[e.jsx("strong",{children:"Guest Limitations:"}),e.jsxs("ul",{style:{textAlign:"left",display:"inline-block",margin:"0.5rem auto"},children:[e.jsx("li",{children:" Can view all interfaces and modals"}),e.jsx("li",{children:" Cannot submit forms or save data"}),e.jsx("li",{children:" Cannot send real challenges"}),e.jsx("li",{children:" Cannot access admin features"}),e.jsx("li",{children:" Cannot claim ladder positions"})]})]})]}),e.jsx("div",{className:"ladder-preview",children:e.jsx(Yb,{playerName:(s==null?void 0:s.firstName)||"Guest",playerLastName:(s==null?void 0:s.lastName)||"User",senderEmail:(s==null?void 0:s.email)||"guest@frontrangepool.com",userPin:(s==null?void 0:s.pin)||"GUEST",onLogout:U.onLogout,isAdmin:!1,onClaimLadderPosition:D,claimedPositions:T,isPositionClaimed:k})})]}),t==="info"&&e.jsxs("div",{className:"info-section",children:[e.jsx("h2",{children:"Ladder of Legends Tournament Series Information"}),e.jsxs("div",{className:"info-cards",children:[e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Challenge Matches"}),e.jsx("p",{children:"Standard ladder climbing system"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Challenge  other players",e.jsx("br",{}),"up to 4 spots above you on the ladder"]}),e.jsxs("li",{children:["Challenger wins:",e.jsx("br",{})," Players switch positions"]}),e.jsxs("li",{children:["Defender wins:",e.jsx("br",{})," Positions remain unchanged"]}),e.jsx("li",{children:"7-day immunity for winners"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" SmackDown Matches"}),e.jsx("p",{children:"Shuffle up the ladder system"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Call out players up to 5 spots below you on the ladder"}),e.jsxs("li",{children:["Challenger pays full entry",e.jsx("br",{})," Defender pays 50%"]}),e.jsxs("li",{children:["Challenger wins: ",e.jsx("br",{}),"Defender moves 3 down",e.jsx("br",{})," Challenger moves 2 up"]}),e.jsx("li",{children:"Defender wins: Players switch positions"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" SmackBack Matches"}),e.jsx("p",{children:"Jump to 1st place opportunity"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Only available after winning a SmackDown as Defender"}),e.jsx("li",{children:"Must call out 1st place within 7 days"}),e.jsxs("li",{children:["Challenger wins:",e.jsx("br",{})," Challenger claims 1st place",e.jsx("br",{}),"All others move down"]}),e.jsx("li",{children:"Defender wins: Positions unchanged"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Top 5 Exception"}),e.jsx("p",{children:"Special rules for top-ranked players"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Top 5 matches:",e.jsx("br",{})," Saturdays/Sundays only"]}),e.jsx("li",{children:"Location: Legends Brews & Cues (2pm-8pm)"}),e.jsx("li",{children:"Live streamed on Legends Facebook page"}),e.jsx("li",{children:"Admin/TD present as referee"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Match Rules"}),e.jsx("p",{children:"Flexible format with minimum requirements"}),e.jsxs("ul",{children:[e.jsx("li",{children:"All races are even - No handicaps"}),e.jsx("li",{children:"CSI rule set (8, 9, or 10 ball allowed)"}),e.jsx("li",{children:"7 or 9-foot tables by agreement"}),e.jsx("li",{children:"Winner takes all entry fees and prizes"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Payment Structure"}),e.jsx("p",{children:"Simple and transparent pricing"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Creation:"})," Free - no cost to claim a position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ladder Membership:"})," $5/month (required for challenges)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Fees:"})," $5 per match (total)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee Distribution:"})," $3 to prize pool",e.jsx("br",{}),"$2 to platform"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Methods:"})," Venmo, Cashapp, CC/Debit, Cash"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Billing:"})," Monthly automatic renewal"]})]})]}),e.jsxs("div",{className:"info-card signup-section",children:[e.jsx("h3",{className:"signup-title",style:{fontSize:"1.2rem",lineHeight:"1.3",marginBottom:"0.5rem",color:"#4CAF50"},children:" Ready to Join?"}),e.jsx("p",{className:"signup-subtitle",style:{fontSize:"0.9rem",marginBottom:"0.75rem",color:"#ccc"},children:"BCA Sanctioned - Fargo Reported Tournament Series"}),e.jsxs("ul",{className:"signup-benefits",style:{fontSize:"0.85rem",lineHeight:"1.4",paddingLeft:"1.2rem",marginBottom:"1rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BCA Sanctioned"})," - Official tournament play"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Professional System"})," - Advanced ladder management"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fair Competition"})," - Challenge your way up the rankings"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pools"})," + Earn your bragging rights!"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Community"})," - Join Colorado's premier singles play pool community"]})]}),e.jsx("button",{onClick:P,className:"signup-btn",style:{width:"100%",padding:"0.8rem 1rem",background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"8px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(76, 175, 80, 0.3)"},children:" Join the Ladder Now"})]})]}),e.jsxs("div",{className:"join-section",children:[e.jsx("h3",{children:"Ready to Challenge?"}),e.jsx("p",{children:"Join the ladder and start climbing the rankings!"}),e.jsx("button",{onClick:P,className:"join-btn-large",children:" Join the Ladder Today"}),e.jsxs("p",{className:"contact-info",children:["Contact: ",e.jsx("strong",{children:"frbcapl@gmail.com"})]})]})]})]}),!1,e.jsx(cN,{isOpen:d,onClose:()=>u(!1),onSignup:P}),h&&e.jsx(It,{open:!0,onClose:()=>p(!1),title:"Sign in to Ladder",maxWidth:"480px",children:e.jsx("div",{style:{padding:"16px 0"},children:e.jsx(gX,{onSuccess:()=>p(!1)})})})]})};const yX=({onLoginSuccess:n})=>{const[t,r]=y.useState(!1),[s,a]=y.useState(!1),[o,i]=y.useState(!1),[l,c]=y.useState(!1),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[g,f]=y.useState(!1),[m,v]=y.useState(!1),[b,w]=y.useState(!1),[x,j]=y.useState({singlesLeague:!1,ladderOfLegends:!1,keyDifferences:!1,instructions:!1}),[S,_]=y.useState(""),C=yn(),N=qi();y.useEffect(()=>{var k,R;window.location.hash==="#login"&&setTimeout(()=>{const U=document.querySelector(".login-section");U&&U.scrollIntoView({behavior:"smooth",block:"start"})},300),(k=N.state)!=null&&k.signupSuccess&&((R=N.state)!=null&&R.message)&&(_(N.state.message),window.history.replaceState({},document.title),setTimeout(()=>{_("")},1e4))},[N.state]);const M=k=>{j(R=>({...R,[k]:!R[k]}))},E=[{id:"ladder",name:"Ladder of Legends Tournament Series",description:"Independently run, challenge-based ladder system",icon:"",color:"#2196F3",status:"active"},{id:"league",name:"Front Range BCAPL Singles League",description:"Manage league matches, schedules, and standings",icon:"",color:"#4CAF50",status:"active"}],P=(k,R,U,z)=>{let $=k;if(typeof k=="object"&&k!==null){const W=k;$=[W.first_name,W.last_name].filter(Boolean).join(" ")||W.email||"User",R=W.email,U=U||"supabase-auth",z=z||W.userType||"user"}R==="guest@frontrangepool.com"&&U==="GUEST"?r(!0):n($,R,U,z)},D=k=>{k==="league"?C("/guest/league"):k==="ladder"&&C("/guest/ladder")},T=()=>{r(!1),C("/")},A=()=>{v(!0)};return t?e.jsx("div",{className:"logged-out-hub-container",children:e.jsxs("div",{className:"logged-out-hub-header",children:[e.jsxs("div",{className:"hub-title",style:{textAlign:window.innerWidth<=768?"center":"left"},children:[e.jsx("h1",{children:"Front Range Pool Hub"}),e.jsx("p",{children:"Guest Preview Mode"}),e.jsx("div",{style:{marginTop:"10px",padding:"8px 16px",background:"rgba(229, 62, 62, 0.2)",border:"1px solid #e53e3e",borderRadius:"20px",fontSize:"0.9rem",color:"#e53e3e"},children:" Exploring as Guest - Limited functionality"})]}),e.jsxs("div",{className:"apps-section",children:[e.jsx("h2",{className:"section-title",children:"Available Apps"}),e.jsx("div",{className:"apps-grid active-apps",children:E.filter(k=>k.status==="active").map(k=>e.jsxs("div",{className:`app-card ${k.status} guest-mode`,style:{"--app-color":k.color},onClick:()=>D(k.id),children:[e.jsx("div",{className:"app-icon",children:k.icon}),e.jsxs("div",{className:"app-info",children:[e.jsx("h3",{children:k.name}),e.jsx("p",{children:k.description}),e.jsx("div",{className:"app-status",children:e.jsx("span",{className:"status-guest-preview",children:"Try Demo"})})]})]},k.id))})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"20px"},children:e.jsx("button",{onClick:T,style:{background:"transparent",color:"#e53e3e",border:"2px solid #e53e3e",padding:"10px 20px",borderRadius:"8px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold",transition:"all 0.3s ease"},onMouseEnter:k=>{k.target.style.background="#e53e3e",k.target.style.color="white"},onMouseLeave:k=>{k.target.style.background="transparent",k.target.style.color="#e53e3e"},children:" Back to Login"})})]})}):e.jsxs("div",{className:"logged-out-hub-container",children:[e.jsxs("div",{className:"instruction-button",children:[e.jsxs("div",{className:"instruction-button-header",onClick:()=>M("instructions"),children:[e.jsxs("div",{className:"instruction-button-content",children:[e.jsx("span",{className:"instruction-button-icon",children:""}),e.jsx("h3",{className:"instruction-button-title",children:"How to Get Started"})]}),e.jsx("span",{className:`instruction-button-arrow ${x.instructions?"expanded":""}`,children:""})]}),x.instructions&&e.jsxs("div",{className:"instruction-modal",children:[e.jsxs("div",{className:"instruction-modal-content",children:[e.jsxs("div",{className:"instruction-section",children:[e.jsx("span",{className:"instruction-section-icon",children:""}),e.jsxs("div",{children:[e.jsx("strong",{className:"instruction-section-title",children:"Get started"}),e.jsxs("div",{className:"instruction-section-text",children:["Click ",e.jsx("strong",{children:'"Continue with Google"'})," below. New or returning  same button. One account for League and Ladder."]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("span",{className:"instruction-section-icon",children:""}),e.jsxs("div",{children:[e.jsx("strong",{className:"instruction-section-title",style:{color:"#4CAF50"},children:"New player?"}),e.jsx("div",{className:"instruction-section-text",children:'Click "Continue with Google"  Your account is created  Admin approves (usually within 24 hours)  Check email  Log in with Google!'})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("span",{className:"instruction-section-icon",children:""}),e.jsxs("div",{children:[e.jsx("strong",{className:"instruction-section-title",style:{color:"#007bff"},children:"Already on the ladder?"}),e.jsxs("div",{className:"instruction-section-text",children:["Click ",e.jsx("strong",{children:'"Claim your position"'})," (under the Google button)  Enter your name  Find your position  Continue with Google to claim."]})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("span",{className:"instruction-section-icon",children:""}),e.jsxs("div",{children:[e.jsx("strong",{className:"instruction-section-title",style:{color:"#2196F3"},children:"Just browsing?"}),e.jsx("div",{className:"instruction-section-text",children:'Use "Guest Access" buttons below to explore the ladder and league without signing up.'})]})]}),e.jsxs("div",{className:"instruction-section",children:[e.jsx("span",{className:"instruction-section-icon",children:""}),e.jsxs("div",{children:[e.jsx("strong",{className:"instruction-section-title",style:{color:"#FF9800"},children:"Forgot your password?"}),e.jsx("div",{className:"instruction-section-text",children:`Click "Forgot Password?" link below the login form. You'll receive an email to reset your password.`})]})]})]}),e.jsxs("div",{className:"instruction-footer",children:[" ",e.jsx("strong",{children:"Need help?"})," Contact administrators for assistance. After signing up, you'll need admin approval before you can log in. Check your email for the password setup link once approved!"]})]})]}),e.jsxs("div",{id:"pool-table-container",style:{position:"relative",height:window.innerWidth<=768?"400px":"550px",marginBottom:window.innerWidth<=768?"2rem":"3rem",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",borderRadius:window.innerWidth<=768?"12px":"20px",padding:window.innerWidth<=768?"1rem 0":"2rem 0"},children:[e.jsx("div",{style:{position:"absolute",top:window.innerWidth<=768?"50%":"0",left:window.innerWidth<=768?"50%":"0",width:window.innerWidth<=768?"350px":"100%",height:window.innerWidth<=768?"175px":"100%",transform:window.innerWidth<=768?"translate(-50%, -50%)":"none",zIndex:0,pointerEvents:"none",overflow:"hidden",borderRadius:window.innerWidth<=768?"10px":"0"},children:e.jsx("div",{style:{width:"100%",height:"100%",transform:window.innerWidth<=768?"none":"scale(0.8)",transformOrigin:"center center",overflow:"hidden"},children:e.jsx(Zu,{})})}),S&&e.jsxs("div",{style:{position:"absolute",zIndex:3,top:window.innerWidth<=768?"30%":"8%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:"500px",background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",padding:"15px 20px",borderRadius:"8px",boxShadow:"0 4px 15px rgba(76, 175, 80, 0.4)",textAlign:"center",marginBottom:"10px",animation:"slideDown 0.3s ease-out"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",marginBottom:"5px"},children:" Account Created!"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:S}),e.jsx("button",{onClick:()=>_(""),style:{position:"absolute",top:"5px",right:"10px",background:"rgba(255,255,255,0.2)",border:"none",color:"white",fontSize:"1.2rem",cursor:"pointer",padding:"0 8px",borderRadius:"4px"},children:""})]}),e.jsx("div",{className:"login-section",style:{position:"absolute",zIndex:2,top:window.innerWidth<=768?S?"40%":"36%":S?"16%":"13%",left:"50%",transform:"translateX(-50%)",width:window.innerWidth<=768?"280px":"750px",height:window.innerWidth<=768?"120px":"400px",background:"rgba(0, 0, 0, 0)",borderRadius:"12px",padding:window.innerWidth<=768?"10px":"25px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8,width:"100%",maxWidth:window.innerWidth<=768?280:420},children:[e.jsx(gV,{compact:!0,onSuccess:P,onShowSignup:()=>i(!0)}),e.jsx("a",{href:"#claim",onClick:k=>{k.preventDefault(),a(!0)},style:{color:"#7dd3fc",fontSize:"0.85rem",textDecoration:"underline"},children:"Already on the ladder? Claim your position"})]})})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"10px",marginBottom:"55px",padding:"0 10px",width:"100%",boxSizing:"border-box"},children:e.jsx("button",{onClick:()=>c(!0),style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white",border:"none",padding:window.innerWidth<=768?"8px 12px":"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.8rem":"1.2rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(245, 158, 11, 0.3)",transition:"all 0.3s ease",maxWidth:window.innerWidth<=768?"calc(100vw - 40px)":"400px",width:window.innerWidth<=768?"100%":"auto",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box"},onMouseEnter:k=>{k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 6px 20px rgba(245, 158, 11, 0.4)"},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 4px 15px rgba(245, 158, 11, 0.3)"},children:"   Singles League vs Ladder of Legends - What's the Difference    "})}),e.jsxs("div",{className:"logged-out-hub-header",children:[e.jsx("div",{className:"hub-title",children:e.jsx("h1",{children:"Guest Access"})}),e.jsx(XC,{isOpen:s,onClose:()=>a(!1)}),e.jsx(JC,{isOpen:o,onClose:()=>i(!1),onSuccess:()=>i(!1),containerSelector:"#pool-table-container"}),e.jsx("div",{className:"apps-section",children:e.jsx("div",{className:"apps-grid active-apps",children:E.filter(k=>k.status==="active").map(k=>e.jsxs("div",{className:`app-card ${k.status} logged-out ${k.id==="ladder"?"ladder-card":""}`,style:{"--app-color":k.color},children:[k.id==="ladder"&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("button",{className:"view-ladder-btn",onClick:A,style:{background:"transparent",color:"#4CAF50",border:"2px solid #4CAF50",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.75rem":"0.8rem",fontWeight:"bold",transition:"all 0.3s ease",whiteSpace:"nowrap"},onMouseEnter:R=>{R.target.style.background="#4CAF50",R.target.style.color="white"},onMouseLeave:R=>{R.target.style.background="transparent",R.target.style.color="#4CAF50"},children:" View Ladder"}),e.jsx("button",{className:"calendar-btn",onClick:()=>w(!0),style:{background:"rgba(139, 92, 246, 0.1)",color:"#8B5CF6",border:"2px solid #8B5CF6",padding:window.innerWidth<=768?"8px 16px":"10px 20px",borderRadius:"8px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.9rem":"1rem",fontWeight:"600",transition:"all 0.2s ease",whiteSpace:"nowrap"},onMouseEnter:R=>{R.target.style.background="rgba(139, 92, 246, 0.2)",R.target.style.transform="translateY(-1px)"},onMouseLeave:R=>{R.target.style.background="rgba(139, 92, 246, 0.1)",R.target.style.transform="translateY(0)"},children:" Calendar"})]}),e.jsx("div",{className:"app-icon",style:{fontSize:window.innerWidth<=768?"1.5rem":"3rem",marginBottom:window.innerWidth<=768?"0.5rem":"1rem",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",minHeight:window.innerWidth<=768?"2rem":"4rem"},children:k.icon}),e.jsxs("div",{className:"app-info",children:[e.jsx("h3",{style:{fontSize:window.innerWidth<=768?"0.9rem":"1.5rem",lineHeight:window.innerWidth<=768?"1.2":"1.3",marginBottom:window.innerWidth<=768?"0.3rem":"0.5rem"},children:k.id==="ladder"?e.jsxs(e.Fragment,{children:["Ladder of Legends",e.jsx("br",{}),"Tournament Series"]}):k.name}),e.jsx("p",{style:{fontSize:window.innerWidth<=768?"0.8rem":"1rem",lineHeight:window.innerWidth<=768?"1.3":"1.4",marginBottom:window.innerWidth<=768?"0.5rem":"1rem"},children:k.description}),e.jsx("div",{className:"app-actions",children:e.jsx("button",{className:"guest-access-btn",onClick:()=>D(k.id),style:{background:"transparent",color:k.id==="ladder"?"#4CAF50":k.color,border:`2px solid ${k.id==="ladder"?"#4CAF50":k.color}`,padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",fontWeight:"bold",marginTop:"8px",marginBottom:"8px",transition:"all 0.3s ease"},onMouseEnter:R=>{R.target.style.background=k.id==="ladder"?"#4CAF50":k.color,R.target.style.color="white"},onMouseLeave:R=>{R.target.style.background="transparent",R.target.style.color=k.id==="ladder"?"#4CAF50":k.color},children:" Access as Guest"})})]})]},k.id))})})]}),l&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:window.innerWidth<=768?"flex-start":"center",zIndex:1e3,padding:window.innerWidth<=768?"160px 5px 30px 5px":"20px",overflowY:"auto",WebkitOverflowScrolling:"touch"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #f59e0b",borderRadius:"15px",width:window.innerWidth<=768?"95%":"55%",maxWidth:window.innerWidth<=768?"100%":"700px",minWidth:window.innerWidth<=768?"auto":"700px",height:window.innerWidth<=768?"auto":"90vh",maxHeight:window.innerWidth<=768?"calc(100vh - 280px)":"800px",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#ffffff",marginTop:window.innerWidth<=768?"0px":"20px"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"8px":"15px",borderBottom:"2px solid #f59e0b",flexShrink:0},children:[e.jsxs("h2",{style:{margin:0,fontSize:window.innerWidth<=768?"1.2rem":"1.5rem",color:"#ffffff",fontWeight:"bold",textAlign:"center",lineHeight:window.innerWidth<=768?"1.3":"1.4"},children:[" Singles League vs Ladder of Legends ",e.jsx("br",{}),"Seperate & Different Formats"]}),e.jsx("button",{onClick:()=>c(!1),style:{position:"absolute",right:"85px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#ffffff",fontSize:"2rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease"},onMouseEnter:k=>k.target.style.backgroundColor="rgba(255,255,255,0.1)",onMouseLeave:k=>k.target.style.backgroundColor="transparent",children:""})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:window.innerWidth<=768?"8px 5px 5px 5px":"20px",fontSize:window.innerWidth<=768?"0.8rem":"0.95rem",lineHeight:window.innerWidth<=768?"1.3":"1.4"},children:[e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"2px solid #4CAF50",borderRadius:"10px",padding:window.innerWidth<=768?"6px":"15px",marginBottom:window.innerWidth<=768?"8px":"20px",textAlign:"center"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",color:"#4CAF50",fontSize:window.innerWidth<=768?"0.9rem":"1.1rem",fontWeight:"bold"},children:" ONE LOGIN FOR BOTH FORMATS"}),e.jsxs("p",{style:{margin:0,color:"#e0e0e0",fontSize:window.innerWidth<=768?"0.8rem":"1rem"},children:["Use the Front Range Pool Hub to access both the Singles League and Ladder of Legends with a single login.",e.jsx("br",{}),"Your account works across both systems, making it easy to participate in whichever format interests you most."]})]}),e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"2px solid #f59e0b",borderRadius:"10px",padding:window.innerWidth<=768?"6px":"15px",marginBottom:window.innerWidth<=768?"8px":"20px",textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#f59e0b",fontSize:window.innerWidth<=768?"0.9rem":"1.2rem"},children:" IMPORTANT: These are TWO SEPARATE COMPETITION SYSTEMS"}),e.jsx("p",{style:{margin:0,color:"#e0e0e0",fontSize:window.innerWidth<=768?"0.8rem":"1rem"},children:"This detailed comparison helps explain the key differences between these completely separate formats."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:window.innerWidth<=768?"6px":"20px",marginBottom:window.innerWidth<=768?"8px":"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"10px",padding:window.innerWidth<=768?"6px":"18px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("h3",{onClick:()=>M("singlesLeague"),style:{color:"#ff4444",margin:window.innerWidth<=768?"0 0 8px 0":"0 0 15px 0",fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",textAlign:"center",borderBottom:"2px solid #ff4444",paddingBottom:"10px",cursor:"pointer",userSelect:"none"},children:[" Singles League  ",x.singlesLeague?"":""]}),x.singlesLeague&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:window.innerWidth<=768?"4px":"12px"},children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",padding:window.innerWidth<=768?"4px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" League Structure"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Season Length:"})," 10 weeks total"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Phase 1:"})," Weeks 1-6 (6 mandatory matches)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Phase 2:"})," Weeks 7-10 (2-4 challenge matches)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Format:"})," BCAPL Singles Division - Hybrid"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Max Players:"})," 30 players per session"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Phase 1 - Scheduled Matches"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"6 MANDATORY MATCHES"})," against assigned opponents"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flexible Scheduling:"})," Any day, any time, any location"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deadline:"})," Must complete by end of Week 6"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Scoring:"})," BCAPL scoring app required"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"FargoRate:"})," All matches integrated for ratings"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Phase 2 - Challenge System"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Required:"})," 2-4 matches (minimum 2)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Challenge Limit:"})," Up to 4 spots higher in standings"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Weekly Limit:"})," Only 1 match per week"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Defense Rules:"})," Must accept until 2 defenses completed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dynamic Limits:"})," Based on times challenged"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Match Rules"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Race Length:"})," Race to 5 games per match"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Scoring:"})," 10 points per game + 10 bonus for match winner"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Rules:"})," Official CSI rule book"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment:"})," Standard league fees apply"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Communication:"})," League Scheduling Hub required"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#ff4444",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Key Features"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Season-based:"})," Structured competition with deadlines"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Standings-driven:"})," Phase 1 results determine Phase 2 eligibility"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"League Affiliation:"})," Official BCAPL division"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Website:"})," https://frusapl.com"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chat System:"})," League-wide communication"]})]})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"10px",padding:window.innerWidth<=768?"6px":"18px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("h3",{onClick:()=>M("ladderOfLegends"),style:{color:"#a855f7",margin:window.innerWidth<=768?"0 0 8px 0":"0 0 15px 0",fontSize:window.innerWidth<=768?"1.1rem":"1.3rem",textAlign:"center",borderBottom:"2px solid #a855f7",paddingBottom:"10px",cursor:"pointer",userSelect:"none"},children:[" Ladder of Legends  ",x.ladderOfLegends?"":""]}),x.ladderOfLegends&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:window.innerWidth<=768?"4px":"12px"},children:[e.jsxs("div",{style:{background:"rgba(168, 85, 247, 0.1)",padding:window.innerWidth<=768?"4px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Ladder Structure"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Format:"})," Independent tournament series"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Divisions:"})," 3 skill-based ladders"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"499 & Under:"})," Beginner to intermediate"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"500-549:"})," Intermediate to advanced"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"550+:"})," Advanced to expert"]})]})]}),e.jsxs("div",{style:{background:"rgba(168, 85, 247, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Match Types"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Challenge Match:"})," Up to 4 spots above, switch positions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"SmackDown:"})," Call out below, special positioning rules"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"SmackBack:"})," Jump to 1st place opportunity"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No Minimum:"})," Play as many or few as you want"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flexible:"})," Any time, any location by agreement"]})]})]}),e.jsxs("div",{style:{background:"rgba(168, 85, 247, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Payment Structure"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Creation:"})," Free - no cost to claim a position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Membership:"})," $5/month (required for challenges)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Fee:"})," $5 per match (total)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Distribution:"})," $3 to prize pool, $2 to platform"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Periods:"})," Every 2 months"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Winner Takes All:"})," Entry fees + sponsor prizes"]})]})]}),e.jsxs("div",{style:{background:"rgba(168, 85, 247, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Special Rules"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Immunity:"})," 7 days after winning any match"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Top 5 Exception:"})," Saturdays/Sundays at Legends only"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Live Streaming:"})," Top 5 matches on Facebook"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Referee:"})," Admin present for top 5 matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No Greens Fees:"})," Tables open for top 5 matches"]})]})]}),e.jsxs("div",{style:{background:"rgba(168, 85, 247, 0.1)",padding:window.innerWidth<=768?"6px":"10px",borderRadius:"8px"},children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Key Features"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Independent:"})," Not affiliated with any league"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Challenge-based:"})," No mandatory match requirements"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize-focused:"})," Bi-monthly prize distributions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Facebook Group:"}),' "Top Colorado Springs Pool Players"']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Skill-based:"})," FargoRate integrated divisions"]})]})]})]})]})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"2px solid #4CAF50",borderRadius:"10px",padding:window.innerWidth<=768?"10px":"18px",marginBottom:window.innerWidth<=768?"12px":"20px"},children:[e.jsxs("h3",{onClick:()=>M("keyDifferences"),style:{margin:window.innerWidth<=768?"0 0 8px 0":"0 0 15px 0",color:"#4CAF50",fontSize:window.innerWidth<=768?"1.1rem":"1.2rem",textAlign:"center",cursor:"pointer",userSelect:"none"},children:[" Key Differences Summary ",x.keyDifferences?"":""]}),x.keyDifferences&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:window.innerWidth<=768?"6px":"20px"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#4CAF50",margin:"0 0 10px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Singles League"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Structure:"})," Season-based with deadlines"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Requirements:"})," 6+ mandatory matches per season"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Pressure:"})," Must complete matches to advance"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Affiliation:"})," Official BCAPL division"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Focus:"})," League competition and standings"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#a855f7",margin:"0 0 10px 0",fontSize:window.innerWidth<=768?"0.9rem":"1rem"},children:" Ladder of Legends"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"18px",color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Structure:"})," Challenge-based with no deadlines"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Requirements:"})," No minimum matches required"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Pressure:"})," Play at your own pace"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Affiliation:"})," Independent tournament series"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Focus:"})," Individual challenges and prizes"]})]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr 1fr",gap:window.innerWidth<=768?"4px":"15px",marginTop:window.innerWidth<=768?"8px":"20px"},children:[e.jsxs("button",{onClick:()=>{c(!1),u(!0)},style:{background:"linear-gradient(135deg, #ff4444 0%, #cc0000 100%)",color:"white",border:"none",padding:window.innerWidth<=768?"6px 8px":"12px 18px",borderRadius:"8px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(255, 68, 68, 0.3)",transition:"all 0.3s ease"},onMouseEnter:k=>{k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 6px 20px rgba(255, 68, 68, 0.4)"},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 4px 15px rgba(255, 68, 68, 0.3)"},children:[" View Singles League",e.jsx("br",{})," Phase 1 Rules"]}),e.jsxs("button",{onClick:()=>{c(!1),p(!0)},style:{background:"linear-gradient(135deg, #ff8800 0%, #ff6600 100%)",color:"white",border:"none",padding:window.innerWidth<=768?"6px 8px":"12px 18px",borderRadius:"8px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(255, 136, 0, 0.3)",transition:"all 0.3s ease"},onMouseEnter:k=>{k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 6px 20px rgba(255, 136, 0, 0.4)"},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 4px 15px rgba(255, 136, 0, 0.3)"},children:[" View Single League",e.jsx("br",{}),"Phase 2 Rules"]}),e.jsx("button",{onClick:()=>{c(!1),f(!0)},style:{background:"linear-gradient(135deg, #a855f7 0%, #9333ea 100%)",color:"white",border:"none",padding:window.innerWidth<=768?"6px 8px":"12px 18px",borderRadius:"8px",cursor:"pointer",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",fontWeight:"bold",boxShadow:"0 4px 15px rgba(168, 85, 247, 0.3)",transition:"all 0.3s ease"},onMouseEnter:k=>{k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 6px 20px rgba(168, 85, 247, 0.4)"},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 4px 15px rgba(168, 85, 247, 0.3)"},children:" View Ladder Rules"})]})]})]})}),d&&e.jsx(CC,{isOpen:d,onClose:()=>{u(!1),c(!0)}}),h&&e.jsx(kC,{isOpen:h,onClose:()=>{p(!1),c(!0)}}),g&&e.jsx(Ub,{isOpen:g,onClose:()=>{f(!1),c(!0)},isMobile:!1,onContactAdmin:null}),e.jsx(cN,{isOpen:m,onClose:()=>v(!1),onSignup:()=>i(!0)}),e.jsx(kd,{isOpen:b,onClose:()=>w(!1)})]})};const f2="/assets/ball8-b55dbd31.svg",bX=({currentAppName:n,isAdmin:t,isSuperAdmin:r,onLogout:s,userFirstName:a,userLastName:o,onProfileClick:i})=>{const l=yn(),c=qi(),[d,u]=Te.useState(!1),h=typeof window<"u"?window.innerWidth<=768:!1,p=()=>{l("/hub")},g=()=>{l("/admin")},f=()=>{l("/admin/players")},m=()=>{l("/platform-admin")},v=()=>{s&&s(),l("/")},b=c.pathname==="/guest/ladder"||c.pathname==="/ladder"||n==="Ladder of Legends";return e.jsxs("div",{className:`hub-navigation ${b?"ladder-app":""} ${c.pathname==="/"?"homepage-nav":""} ${h?"mobile-nav":""}`,children:[e.jsxs("div",{className:"nav-content",children:[e.jsx("div",{className:`nav-left ${c.pathname==="/"?"hide-on-homepage":""}`,style:{display:"flex",alignItems:"center",justifyContent:"center",flex:"0 0 auto",order:1},children:window.innerWidth>768&&e.jsxs("div",{className:"hub-brand hub-brand-clickable",onClick:()=>l("/"),style:{cursor:"pointer"},children:[e.jsx("img",{src:f2,alt:"8-ball",className:"nav-ball"}),"Front Range",e.jsx("img",{src:wm,alt:"9-ball",className:"nav-ball"}),"Pool.com",e.jsx("img",{src:Qu,alt:"10-ball",className:"nav-ball"})]})}),window.innerWidth<=768&&e.jsxs("div",{className:"mobile-brand-above-title",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",marginTop:"0",marginBottom:"0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"0 1rem"},children:e.jsxs("div",{className:"hub-brand hub-brand-clickable mobile-brand",onClick:()=>l("/"),style:{cursor:"pointer"},children:[e.jsx("img",{src:f2,alt:"8-ball",className:"nav-ball"}),"Front Range",e.jsx("img",{src:wm,alt:"9-ball",className:"nav-ball"}),"Pool.com",e.jsx("img",{src:Qu,alt:"10-ball",className:"nav-ball"})]})}),e.jsxs("div",{className:"nav-center",style:{order:2,display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%",padding:"0 .5rem 0 0rem"},children:[e.jsx("div",{style:{textAlign:"center"},children:e.jsx("span",{className:"app-title",style:c.pathname==="/"?{backgroundColor:"red",color:"yellow",fontSize:"1.4rem",letterSpacing:"0.5px",whiteSpace:"nowrap"}:{},children:c.pathname==="/"?"Front Range Pool.com":c.pathname==="/hub"?a?"THE HUB":"THE HUB - Login":c.pathname==="/guest/ladder"||c.pathname==="/ladder"?"Ladder of Legends":c.pathname==="/cueless"?"Cueless in the Booth":c.pathname==="/admin"?"Admin Panel":c.pathname==="/platform-admin"?"Platform Admin":c.pathname==="/dues-tracker"?"Dues Tracker":c.pathname==="/tournament-bracket"?"Tournament Bracket":c.pathname==="/calendar"?"Match Calendar":n||"Front Range Pool"})}),e.jsx("button",{className:"hamburger-btn",onClick:()=>u(!d),style:{width:"50px",display:"flex",justifyContent:"center",alignItems:"center",marginRight:"3rem"},children:""})]})]}),window.innerWidth>768&&e.jsx("div",{className:"nav-center",style:{order:2},children:e.jsx("div",{children:e.jsx("span",{className:"app-title",style:c.pathname==="/"?{backgroundColor:"red",color:"yellow",fontSize:"2.2rem",letterSpacing:"1px",whiteSpace:"nowrap"}:{},children:c.pathname==="/"?"Front Range Pool.com":c.pathname==="/hub"?a?"THE HUB":"THE HUB - Login":c.pathname==="/guest/ladder"||c.pathname==="/ladder"?"Ladder of Legends":c.pathname==="/cueless"?"Cueless in the Booth":c.pathname==="/admin"?"Admin Panel":c.pathname==="/platform-admin"?"Platform Admin":c.pathname==="/dues-tracker"?"Dues Tracker":c.pathname==="/tournament-bracket"?"Tournament Bracket":c.pathname==="/calendar"?"Match Calendar":n||"Front Range Pool"})})}),a?e.jsx(e.Fragment,{children:!h&&e.jsxs("div",{className:"nav-right",style:{display:"flex",alignItems:"center",justifyContent:"center",flex:"0 0 auto",gap:"0.5rem",order:3},children:[(t||r)&&e.jsxs("div",{className:"admin-dropdown",children:[e.jsx("button",{className:"admin-btn dropdown-toggle",children:" Admin"}),e.jsxs("div",{className:"dropdown-menu",children:[t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:f,className:"dropdown-item",children:" Players"}),e.jsx("button",{onClick:g,className:"dropdown-item",children:" Admin"})]}),r&&e.jsx("button",{onClick:m,className:"dropdown-item",children:" Platform Admin"})]})]}),e.jsx("button",{onClick:i,className:"profile-btn",children:" Profile"}),e.jsx("button",{onClick:p,className:"switch-app-btn",children:" Switch App"}),e.jsx("button",{onClick:v,className:"logout-btn",children:" Logout"})]})}):e.jsx("div",{className:"nav-right",style:{display:"flex",alignItems:"center",justifyContent:"center",flex:"0 0 auto",order:3},children:e.jsx("div",{className:"login-nav-info",style:{display:"none"},children:"  Front Range Pool Hub"})})]}),h&&d&&a&&e.jsx("div",{className:"mobile-menu-dropdown",children:e.jsxs("div",{className:"mobile-menu-content",children:[(t||r)&&e.jsxs("div",{className:"mobile-admin-section",children:[e.jsx("h4",{children:"Admin"}),t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{f(),u(!1)},className:"mobile-menu-item",children:" Players"}),e.jsx("button",{onClick:()=>{g(),u(!1)},className:"mobile-menu-item",children:" Admin"})]}),r&&e.jsx("button",{onClick:()=>{m(),u(!1)},className:"mobile-menu-item",children:" Platform Admin"})]}),e.jsxs("div",{className:"mobile-user-section",children:[e.jsx("button",{onClick:()=>{i(),u(!1)},className:"mobile-menu-item",children:" Profile"}),e.jsx("button",{onClick:()=>{p(),u(!1)},className:"mobile-menu-item",children:" Switch App"}),e.jsx("button",{onClick:()=>{v(),u(!1)},className:"mobile-menu-item logout",children:" Logout"})]})]})})]})},Os=({appName:n,children:t})=>(y.useEffect(()=>{n&&window.dispatchEvent(new CustomEvent("appNameChange",{detail:n}))},[n]),t);const bs="/assets/Culess pic-ea05b0ad.jpg",vX=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>_a(()=>Promise.resolve().then(()=>Cd),void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)};class Gb extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class g2 extends Gb{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class x2 extends Gb{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class y2 extends Gb{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Gx;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Gx||(Gx={}));var wX=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};class jX{constructor(t,{headers:r={},customFetch:s,region:a=Gx.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=vX(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return wX(this,arguments,void 0,function*(r,s={}){var a;try{const{headers:o,method:i,body:l,signal:c}=s;let d={},{region:u}=s;u||(u=this.region);const h=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,h.searchParams.set("forceFunctionRegion",u));let p;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",p=l):typeof l=="string"?(d["Content-Type"]="text/plain",p=l):typeof FormData<"u"&&l instanceof FormData?p=l:(d["Content-Type"]="application/json",p=JSON.stringify(l)));const g=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:p,signal:c}).catch(b=>{throw b.name==="AbortError"?b:new g2(b)}),f=g.headers.get("x-relay-error");if(f&&f==="true")throw new x2(g);if(!g.ok)throw new y2(g);let m=((a=g.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),v;return m==="application/json"?v=yield g.json():m==="application/octet-stream"?v=yield g.blob():m==="text/event-stream"?v=g:m==="multipart/form-data"?v=yield g.formData():v=yield g.text(),{data:v,error:null,response:g}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new g2(o)}:{data:null,error:o,response:o instanceof y2||o instanceof x2?o.context:void 0}}})}}var Ws={},Vb={},Nf={},Ch={},Tf={},Pf={},SX=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},yd=SX();const _X=yd.fetch,dN=yd.fetch.bind(yd),uN=yd.Headers,kX=yd.Request,CX=yd.Response,Cd=Object.freeze(Object.defineProperty({__proto__:null,Headers:uN,Request:kX,Response:CX,default:dN,fetch:_X},Symbol.toStringTag,{value:"Module"})),NX=KN(Cd);var Ef={};Object.defineProperty(Ef,"__esModule",{value:!0});let TX=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ef.default=TX;var hN=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Pf,"__esModule",{value:!0});const PX=hN(NX),EX=hN(Ef);let RX=class{constructor(t){var r,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(s=t.isMaybeSingle)!==null&&s!==void 0?s:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=PX.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,l,c,d;let u=null,h=null,p=null,g=o.status,f=o.statusText;if(o.ok){if(this.method!=="HEAD"){const w=await o.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=w:h=JSON.parse(w))}const v=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),b=(c=o.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");v&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,g=406,f="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const v=await o.text();try{u=JSON.parse(v),Array.isArray(u)&&o.status===404&&(h=[],u=null,g=200,f="OK")}catch{o.status===404&&v===""?(g=204,f="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,g=200,f="OK"),u&&this.shouldThrowOnError)throw new EX.default(u)}return{error:u,data:h,count:p,status:g,statusText:f}});return this.shouldThrowOnError||(a=a.catch(o=>{var i,l,c;return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(l=o==null?void 0:o.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=o==null?void 0:o.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Pf.default=RX;var AX=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Tf,"__esModule",{value:!0});const MX=AX(Pf);let IX=class extends MX.default{select(t){let r=!1;const s=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:s,foreignTable:a,referencedTable:o=a}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:s=!1,buffers:a=!1,wal:o=!1,format:i="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,s?"settings":null,a?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Tf.default=IX;var DX=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ch,"__esModule",{value:!0});const $X=DX(Tf);let LX=class extends $X.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const s=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:s,type:a}={}){let o="";a==="plain"?o="pl":a==="phrase"?o="ph":a==="websearch"&&(o="w");const i=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${o}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(t,r,s){return this.url.searchParams.append(t,`not.${r}.${s}`),this}or(t,{foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,s){return this.url.searchParams.append(t,`${r}.${s}`),this}};Ch.default=LX;var BX=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Nf,"__esModule",{value:!0});const Vd=BX(Ch);let OX=class{constructor(t,{headers:r={},schema:s,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=s,this.fetch=a}select(t,r){const{head:s=!1,count:a}=r??{},o=s?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),a&&this.headers.append("Prefer",`count=${a}`),new Vd.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:s=!0}={}){var a;const o="POST";if(r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Vd.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:s=!1,count:a,defaultToNull:o=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Vd.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var s;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Vd.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:t}={}){var r;const s="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Vd.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Nf.default=OX;var pN=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Vb,"__esModule",{value:!0});const zX=pN(Nf),FX=pN(Ch);let WX=class mN{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new zX.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new mN(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:o}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;s||a?(l=s?"HEAD":"GET",Object.entries(r).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{c.searchParams.append(h,p)})):(l="POST",d=r);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new FX.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Vb.default=WX;var Nd=Is&&Is.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.PostgrestError=Ws.PostgrestBuilder=Ws.PostgrestTransformBuilder=Ws.PostgrestFilterBuilder=Ws.PostgrestQueryBuilder=Ws.PostgrestClient=void 0;const fN=Nd(Vb);Ws.PostgrestClient=fN.default;const gN=Nd(Nf);Ws.PostgrestQueryBuilder=gN.default;const xN=Nd(Ch);Ws.PostgrestFilterBuilder=xN.default;const yN=Nd(Tf);Ws.PostgrestTransformBuilder=yN.default;const bN=Nd(Pf);Ws.PostgrestBuilder=bN.default;const vN=Nd(Ef);Ws.PostgrestError=vN.default;var UX=Ws.default={PostgrestClient:fN.default,PostgrestQueryBuilder:gN.default,PostgrestFilterBuilder:xN.default,PostgrestTransformBuilder:yN.default,PostgrestBuilder:bN.default,PostgrestError:vN.default};const{PostgrestClient:qX,PostgrestQueryBuilder:hne,PostgrestFilterBuilder:pne,PostgrestTransformBuilder:mne,PostgrestBuilder:fne,PostgrestError:gne}=UX;class HX{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const YX="2.74.0",GX=`realtime-js/${YX}`,VX="1.0.0",Vx=1e4,KX=1e3,JX=100;var wu;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(wu||(wu={}));var Gn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Gn||(Gn={}));var Fa;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Fa||(Fa={}));var Kx;(function(n){n.websocket="websocket"})(Kx||(Kx={}));var yl;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(yl||(yl={}));class XX{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),s=new TextDecoder;return this._decodeBroadcast(t,r,s)}_decodeBroadcast(t,r,s){const a=r.getUint8(1),o=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=s.decode(t.slice(i,i+a));i=i+a;const c=s.decode(t.slice(i,i+o));i=i+o;const d=JSON.parse(s.decode(t.slice(i,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class wN{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Yr;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Yr||(Yr={}));const b2=(n,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((o,i)=>(o[i]=QX(i,n,t,a),o),{}):{}},QX=(n,t,r,s)=>{const a=t.find(l=>l.name===n),o=a==null?void 0:a.type,i=r[n];return o&&!s.includes(o)?jN(o,i):Jx(i)},jN=(n,t)=>{if(n.charAt(0)==="_"){const r=n.slice(1,n.length);return rQ(t,r)}switch(n){case Yr.bool:return ZX(t);case Yr.float4:case Yr.float8:case Yr.int2:case Yr.int4:case Yr.int8:case Yr.numeric:case Yr.oid:return eQ(t);case Yr.json:case Yr.jsonb:return tQ(t);case Yr.timestamp:return nQ(t);case Yr.abstime:case Yr.date:case Yr.daterange:case Yr.int4range:case Yr.int8range:case Yr.money:case Yr.reltime:case Yr.text:case Yr.time:case Yr.timestamptz:case Yr.timetz:case Yr.tsrange:case Yr.tstzrange:return Jx(t);default:return Jx(t)}},Jx=n=>n,ZX=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},eQ=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},tQ=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},rQ=(n,t)=>{if(typeof n!="string")return n;const r=n.length-1,s=n[r];if(n[0]==="{"&&s==="}"){let o;const i=n.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>jN(t,l))}return n},nQ=n=>typeof n=="string"?n.replace(" ","T"):n,SN=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Kg{constructor(t,r,s={},a=Vx){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var v2;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(v2||(v2={}));class ju{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ju.syncState(this.state,a,o,i),this.pendingDiffs.forEach(c=>{this.state=ju.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ju.syncDiff(this.state,a,o,i),l())}),this.onJoin((a,o,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:i})}),this.onLeave((a,o,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const o=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(o,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const h=o[d];if(h){const p=u.map(v=>v.presence_ref),g=h.map(v=>v.presence_ref),f=u.filter(v=>g.indexOf(v.presence_ref)<0),m=h.filter(v=>p.indexOf(v.presence_ref)<0);f.length>0&&(l[d]=f),m.length>0&&(c[d]=m)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:c},s,a)}static syncDiff(t,r,s,a){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(o,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const h=t[l].map(g=>g.presence_ref),p=u.filter(g=>h.indexOf(g.presence_ref)<0);t[l].unshift(...p)}s(l,u,c)}),this.map(i,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var w2;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(w2||(w2={}));var Su;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Su||(Su={}));var Do;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Do||(Do={}));class Kb{constructor(t,r={config:{}},s){var a,o;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=Gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Kg(this,Fa.join,this.params,this.timeout),this.rejoinTimer=new wN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gn.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Fa.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new ju(this),this.broadcastEndpointURL=SN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Gn.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Su.PRESENCE]&&this.bindings[Su.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,h={},p={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>t==null?void 0:t(Do.CHANNEL_ERROR,g)),this._onClose(()=>t==null?void 0:t(Do.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var f;if(this.socket.setAuth(),g===void 0){t==null||t(Do.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(f=m==null?void 0:m.length)!==null&&f!==void 0?f:0,b=[];for(let w=0;w<v;w++){const x=m[w],{filter:{event:j,schema:S,table:_,filter:C}}=x,N=g&&g[w];if(N&&N.event===j&&N.schema===S&&N.table===_&&N.filter===C)b.push(Object.assign(Object.assign({},x),{id:N.id}));else{this.unsubscribe(),this.state=Gn.errored,t==null||t(Do.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(Do.SUBSCRIBED);return}}).receive("error",g=>{this.state=Gn.errored,t==null||t(Do.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Do.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===Gn.joined&&t===Su.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,s)}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Gn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fa.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new Kg(this,Fa.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Gn.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,o=setTimeout(()=>a.abort(),s),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(o),i}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Kg(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>JX){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,o;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Fa;if(s&&[l,c,d,u].indexOf(i)>=0&&s!==this._joinRef())return;let p=this._onMessage(i,r,s);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(g=>{var f,m,v;return((f=g.filter)===null||f===void 0?void 0:f.event)==="*"||((v=(m=g.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(g=>g.callback(p,s)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var f,m,v,b,w,x;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const j=g.id,S=(f=g.filter)===null||f===void 0?void 0:f.event;return j&&((m=r.ids)===null||m===void 0?void 0:m.includes(j))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const j=(w=(b=g==null?void 0:g.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return j==="*"||j===((x=r==null?void 0:r.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof p=="object"&&"ids"in p){const f=p.data,{schema:m,table:v,commit_timestamp:b,type:w,errors:x}=f;p=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:b,eventType:w,new:{},old:{},errors:x}),this._getPayloadRecords(f))}g.callback(p,s)})}_isClosed(){return this.state===Gn.closed}_isJoined(){return this.state===Gn.joined}_isJoining(){return this.state===Gn.joining}_isLeaving(){return this.state===Gn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),o={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&Kb.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Fa.close,{},t)}_onError(t){this._on(Fa.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=b2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=b2(t.columns,t.old_record)),r}}const Jg=()=>{},dp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sQ=[1e3,2e3,5e3,1e4],aQ=1e4,oQ=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class iQ{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vx,this.transport=null,this.heartbeatIntervalMs=dp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jg,this.ref=0,this.reconnectTimer=null,this.logger=Jg,this.conn=null,this.sendBuffer=[],this.serializer=new XX,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let o;return a?o=a:typeof fetch>"u"?o=(...i)=>_a(()=>Promise.resolve().then(()=>Cd),void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Kx.websocket}`,this.httpEndpoint=SN(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=HX.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VX}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case wu.connecting:return yl.Connecting;case wu.open:return yl.Open;case wu.closing:return yl.Closing;default:return yl.Closed}}isConnected(){return this.connectionState()===yl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(o=>o.topic===s);if(a)return a;{const o=new Kb(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:s,payload:a,ref:o}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${o})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(KX,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},dp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${s} ${a} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(a,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Fa.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([oQ],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:GX};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Fa.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new wN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},dp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,o,i,l,c,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:Vx,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:dp.HEARTBEAT_INTERVAL,this.worker=(o=t==null?void 0:t.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Jg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:h=>sQ[h-1]||aQ,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(h,p)=>p(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Jb extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ln(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class lQ extends Jb{constructor(t,r,s){super(t),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Xx extends Jb{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var cQ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};const _N=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>_a(()=>Promise.resolve().then(()=>Cd),void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},dQ=()=>cQ(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _a(()=>Promise.resolve().then(()=>Cd),void 0)).Response:Response}),Qx=n=>{if(Array.isArray(n))return n.map(r=>Qx(r));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[a]=Qx(s)}),t},uQ=n=>{if(typeof n!="object"||n===null)return!1;const t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Zl=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};const Xg=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),hQ=(n,t,r)=>Zl(void 0,void 0,void 0,function*(){const s=yield dQ();n instanceof s&&!(r!=null&&r.noResolveJson)?n.json().then(a=>{const o=n.status||500,i=(a==null?void 0:a.statusCode)||o+"";t(new lQ(Xg(a),o,i))}).catch(a=>{t(new Xx(Xg(a),a))}):t(new Xx(Xg(n),n))}),pQ=(n,t,r,s)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"||!s?a:(uQ(s)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Nh(n,t,r,s,a,o){return Zl(this,void 0,void 0,function*(){return new Promise((i,l)=>{n(r,pQ(t,s,a,o)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>hQ(c,l,s))})})}function Lm(n,t,r,s){return Zl(this,void 0,void 0,function*(){return Nh(n,"GET",t,r,s)})}function lo(n,t,r,s,a){return Zl(this,void 0,void 0,function*(){return Nh(n,"POST",t,s,a,r)})}function Zx(n,t,r,s,a){return Zl(this,void 0,void 0,function*(){return Nh(n,"PUT",t,s,a,r)})}function mQ(n,t,r,s){return Zl(this,void 0,void 0,function*(){return Nh(n,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function kN(n,t,r,s,a){return Zl(this,void 0,void 0,function*(){return Nh(n,"DELETE",t,s,a,r)})}var fQ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};class gQ{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return fQ(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ln(t))return{data:null,error:t};throw t}})}}var xQ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};class yQ{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new gQ(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return xQ(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ln(t))return{data:null,error:t};throw t}})}}var zs=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};const bQ={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},j2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class vQ{constructor(t,r={},s,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=s,this.fetch=_N(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,s,a){return zs(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},j2),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",s)):typeof FormData<"u"&&s instanceof FormData?(o=s,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(t=="PUT"?Zx:lo)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ln(o))return{data:null,error:o};throw o}})}upload(t,r,s){return zs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,s)})}uploadToSignedUrl(t,r,s,a){return zs(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:j2.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Zx(this.fetch,l.toString(),c,{headers:u});return{data:{path:o,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Ln(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return zs(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const o=yield lo(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new Jb("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ln(s))return{data:null,error:s};throw s}})}update(t,r,s){return zs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,s)})}move(t,r,s){return zs(this,void 0,void 0,function*(){try{return{data:yield lo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}copy(t,r,s){return zs(this,void 0,void 0,function*(){try{return{data:{path:(yield lo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,s){return zs(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),o=yield lo(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,s){return zs(this,void 0,void 0,function*(){try{const a=yield lo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=o?`?${o}`:"",l=this._getFinalPath(t),c=()=>Lm(this.fetch,`${this.url}/${a}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new yQ(c,this.shouldThrowOnError)}info(t){return zs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const s=yield Lm(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Qx(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ln(s))return{data:null,error:s};throw s}})}exists(t){return zs(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield mQ(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ln(s)&&s instanceof Xx){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,r){const s=this._getFinalPath(t),a=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&a.push(o);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(t){return zs(this,void 0,void 0,function*(){try{return{data:yield kN(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ln(r))return{data:null,error:r};throw r}})}list(t,r,s){return zs(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},bQ),r),{prefix:t||""});return{data:yield lo(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}listV2(t,r){return zs(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield lo(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ln(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const wQ="2.74.0",jQ={"X-Client-Info":`storage-js/${wQ}`};var fc=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};class SQ{constructor(t,r={},s,a){this.shouldThrowOnError=!1;const o=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},jQ),r),this.fetch=_N(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return fc(this,void 0,void 0,function*(){try{return{data:yield Lm(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ln(t))return{data:null,error:t};throw t}})}getBucket(t){return fc(this,void 0,void 0,function*(){try{return{data:yield Lm(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ln(r))return{data:null,error:r};throw r}})}createBucket(t){return fc(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield lo(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ln(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return fc(this,void 0,void 0,function*(){try{return{data:yield Zx(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ln(s))return{data:null,error:s};throw s}})}emptyBucket(t){return fc(this,void 0,void 0,function*(){try{return{data:yield lo(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ln(r))return{data:null,error:r};throw r}})}deleteBucket(t){return fc(this,void 0,void 0,function*(){try{return{data:yield kN(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ln(r))return{data:null,error:r};throw r}})}}class _Q extends SQ{constructor(t,r={},s,a){super(t,r,s,a)}from(t){return new vQ(this.url,this.headers,t,this.fetch)}}const kQ="2.74.0";let ou="";typeof Deno<"u"?ou="deno":typeof document<"u"?ou="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ou="react-native":ou="node";const CQ={"X-Client-Info":`supabase-js-${ou}/${kQ}`},NQ={headers:CQ},TQ={schema:"public"},PQ={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},EQ={};var RQ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};const AQ=n=>{let t;return n?t=n:typeof fetch>"u"?t=dN:t=fetch,(...r)=>t(...r)},MQ=()=>typeof Headers>"u"?uN:Headers,IQ=(n,t,r)=>{const s=AQ(r),a=MQ();return(o,i)=>RQ(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:n;let d=new a(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(o,Object.assign(Object.assign({},i),{headers:d}))})};var DQ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};function $Q(n){return n.endsWith("/")?n:n+"/"}function LQ(n,t){var r,s;const{db:a,auth:o,realtime:i,global:l}=n,{db:c,auth:d,realtime:u,global:h}=t,p={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>DQ(this,void 0,void 0,function*(){return""})};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}function BQ(n){const t=n==null?void 0:n.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL($Q(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const CN="2.74.0",Nc=30*1e3,ey=3,Qg=ey*Nc,OQ="http://localhost:9999",zQ="supabase.auth.token",FQ={"X-Client-Info":`gotrue-js/${CN}`},ty="X-Supabase-Api-Version",NN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},WQ=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,UQ=10*60*1e3;class uh extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Kt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class qQ extends uh{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function HQ(n){return Kt(n)&&n.name==="AuthApiError"}class bl extends uh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Yi extends uh{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class di extends Yi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function YQ(n){return Kt(n)&&n.name==="AuthSessionMissingError"}class gc extends Yi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class up extends Yi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class hp extends Yi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GQ(n){return Kt(n)&&n.name==="AuthImplicitGrantRedirectError"}class S2 extends Yi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ry extends Yi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Zg(n){return Kt(n)&&n.name==="AuthRetryableFetchError"}class _2 extends Yi{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class ny extends Yi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),k2=` 	
\r=`.split(""),VQ=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<k2.length;t+=1)n[k2[t].charCodeAt(0)]=-2;for(let t=0;t<Bm.length;t+=1)n[Bm[t].charCodeAt(0)]=t;return n})();function C2(n,t,r){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Bm[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Bm[s]),t.queuedBits-=6}}function TN(n,t,r){const s=VQ[n];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function N2(n){const t=[],r=i=>{t.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=i=>{XQ(i,s,r)};for(let i=0;i<n.length;i+=1)TN(n.charCodeAt(i),a,o);return t.join("")}function KQ(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function JQ(n,t){for(let r=0;r<n.length;r+=1){let s=n.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(n.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}KQ(s,t)}}function XQ(n,t,r){if(t.utf8seq===0){if(n<=127){r(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function td(n){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<n.length;a+=1)TN(n.charCodeAt(a),r,s);return new Uint8Array(t)}function QQ(n){const t=[];return JQ(n,r=>t.push(r)),new Uint8Array(t)}function Nl(n){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return n.forEach(a=>C2(a,r,s)),C2(null,r,s),t.join("")}function ZQ(n){return Math.round(Date.now()/1e3)+n}function eZ(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const ea=()=>typeof window<"u"&&typeof document<"u",ol={tested:!1,writable:!1},PN=()=>{if(!ea())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ol.tested)return ol.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ol.tested=!0,ol.writable=!0}catch{ol.tested=!0,ol.writable=!1}return ol.writable};function tZ(n){const t={},r=new URL(n);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,o)=>{t[o]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const EN=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>_a(()=>Promise.resolve().then(()=>Cd),void 0).then(({default:s})=>s(...r)):t=fetch,(...r)=>t(...r)},rZ=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Tc=async(n,t,r)=>{await n.setItem(t,JSON.stringify(r))},il=async(n,t)=>{const r=await n.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ci=async(n,t)=>{await n.removeItem(t)};class Rf{constructor(){this.promise=new Rf.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Rf.promiseConstructor=Promise;function e0(n){const t=n.split(".");if(t.length!==3)throw new ny("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!WQ.test(t[s]))throw new ny("JWT not in base64url format");return{header:JSON.parse(N2(t[0])),payload:JSON.parse(N2(t[1])),signature:td(t[2]),raw:{header:t[0],payload:t[1]}}}async function nZ(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function sZ(n,t){return new Promise((s,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await n(o);if(!t(o,null,i)){s(i);return}}catch(i){if(!t(o,i)){a(i);return}}})()})}function aZ(n){return("0"+n.toString(16)).substr(-2)}function oZ(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let o=0;o<56;o++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,aZ).join("")}async function iZ(n){const r=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function lZ(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const r=await iZ(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xc(n,t,r=!1){const s=oZ();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await Tc(n,`${t}-code-verifier`,a);const o=await lZ(s);return[o,s===o?"plain":"s256"]}const cZ=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function dZ(n){const t=n.headers.get(ty);if(!t||!t.match(cZ))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function uZ(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function hZ(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const pZ=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function yc(n){if(!pZ.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function t0(){const n={};return new Proxy(n,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function T2(n){return JSON.parse(JSON.stringify(n))}var mZ=globalThis&&globalThis.__rest||function(n,t){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(r[s[a]]=n[s[a]]);return r};const fl=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),fZ=[502,503,504];async function P2(n){var t;if(!rZ(n))throw new ry(fl(n),0);if(fZ.includes(n.status))throw new ry(fl(n),n.status);let r;try{r=await n.json()}catch(o){throw new bl(fl(o),o)}let s;const a=dZ(n);if(a&&a.getTime()>=NN["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new _2(fl(r),n.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new di}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new _2(fl(r),n.status,r.weak_password.reasons);throw new qQ(fl(r),n.status||500,s)}const gZ=(n,t,r,s)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function ar(n,t,r,s){var a;const o=Object.assign({},s==null?void 0:s.headers);o[ty]||(o[ty]=NN["2024-01-01"].name),s!=null&&s.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const i=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await xZ(n,t,r+l,{headers:o,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function xZ(n,t,r,s,a,o){const i=gZ(t,s,a,o);let l;try{l=await n(r,Object.assign({},i))}catch(c){throw console.error(c),new ry(fl(c),0)}if(l.ok||await P2(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await P2(c)}}function $a(n){var t;let r=null;vZ(n)&&(r=Object.assign({},n),n.expires_at||(r.expires_at=ZQ(n.expires_in)));const s=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:r,user:s},error:null}}function E2(n){const t=$a(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=n.weak_password),t}function bi(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function yZ(n){return{data:n,error:null}}function bZ(n){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o}=n,i=mZ(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function R2(n){return n}function vZ(n){return n.access_token&&n.refresh_token&&n.expires_in}const r0=["global","local","others"];var wZ=globalThis&&globalThis.__rest||function(n,t){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(r[s[a]]=n[s[a]]);return r};class jZ{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=EN(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=r0[0]){if(r0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${r0.join(", ")}`);try{return await ar(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Kt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await ar(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:bi})}catch(s){if(Kt(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=wZ(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await ar(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:bZ,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Kt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ar(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:bi})}catch(r){if(Kt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ar(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:R2});if(u.error)throw u.error;const h=await u.json(),p=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);d[`${v}Page`]=m}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Kt(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){yc(t);try{return await ar(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:bi})}catch(r){if(Kt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){yc(t);try{return await ar(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:bi})}catch(s){if(Kt(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){yc(t);try{return await ar(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:bi})}catch(s){if(Kt(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){yc(t.userId);try{const{data:r,error:s}=await ar(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){yc(t.userId),yc(t.id);try{return{data:await ar(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ar(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:R2});if(u.error)throw u.error;const h=await u.json(),p=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(f=>{const m=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(f.split(";")[1].split("=")[1]);d[`${v}Page`]=m}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Kt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ar(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ar(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await ar(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ar(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}}function A2(n={}){return{getItem:t=>n[t]||null,setItem:(t,r)=>{n[t]=r},removeItem:t=>{delete n[t]}}}const bc={debug:!!(globalThis&&PN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class RN extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class SZ extends RN{}async function _Z(n,t,r){bc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),bc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){bc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await r()}finally{bc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(t===0)throw bc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new SZ(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(bc.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function kZ(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function AN(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function CZ(n){return parseInt(n,16)}function NZ(n){const t=new TextEncoder().encode(n);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function TZ(n){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:o=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:h,version:p}=n;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=n.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const g=AN(n.address),f=u?`${u}://${s}`:s,m=n.statement?`${n.statement}
`:"",v=`${f} wants you to sign in with your Ethereum account:
${g}

${m}`;let b=`URI: ${h}
Version: ${p}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(a&&(b+=`
Expiration Time: ${a.toISOString()}`),l&&(b+=`
Not Before: ${l.toISOString()}`),c&&(b+=`
Request ID: ${c}`),d){let w=`
Resources:`;for(const x of d){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);w+=`
- ${x}`}b+=w}return`${v}
${b}`}class $n extends Error{constructor({message:t,code:r,cause:s,name:a}){var o;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=a??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class Om extends $n{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function PZ({error:n,options:t}){var r,s,a;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new $n({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(t.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new $n({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new $n({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new $n({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new $n({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new $n({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new $n({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(IN(i)){if(o.rp.id!==i)return new $n({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new $n({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function EZ({error:n,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new $n({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const s=window.location.hostname;if(IN(s)){if(r.rpId!==s)return new $n({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}var MN=globalThis&&globalThis.__rest||function(n,t){var r={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(r[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(r[s[a]]=n[s[a]]);return r};class RZ{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const AZ=new RZ;function MZ(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:t,user:r,excludeCredentials:s}=n,a=MN(n,["challenge","user","excludeCredentials"]),o=td(t).buffer,i=Object.assign(Object.assign({},r),{id:td(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:o,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:td(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function IZ(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:t,allowCredentials:r}=n,s=MN(n,["challenge","allowCredentials"]),a=td(t).buffer,o=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},l),{id:td(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function DZ(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n;return{id:n.id,rawId:n.id,response:{attestationObject:Nl(new Uint8Array(n.response.attestationObject)),clientDataJSON:Nl(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function $Z(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n,s=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Nl(new Uint8Array(a.authenticatorData)),clientDataJSON:Nl(new Uint8Array(a.clientDataJSON)),signature:Nl(new Uint8Array(a.signature)),userHandle:a.userHandle?Nl(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function IN(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function M2(){var n,t;return!!(ea()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function LZ(n){try{const t=await navigator.credentials.create(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Om("Browser returned unexpected credential type",t)}:{data:null,error:new Om("Empty credential response",t)}}catch(t){return{data:null,error:PZ({error:t,options:n})}}}async function BZ(n){try{const t=await navigator.credentials.get(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Om("Browser returned unexpected credential type",t)}:{data:null,error:new Om("Empty credential response",t)}}catch(t){return{data:null,error:EZ({error:t,options:n})}}}const OZ={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},zZ={userVerification:"preferred",hints:["security-key"]};function zm(...n){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of n)if(a)for(const o in a){const i=a[o];if(i!==void 0)if(Array.isArray(i))s[o]=i;else if(r(i))s[o]=i;else if(t(i)){const l=s[o];t(l)?s[o]=zm(l,i):s[o]=zm(i)}else s[o]=i}return s}function FZ(n,t){return zm(OZ,n,t||{})}function WZ(n,t){return zm(zZ,n,t||{})}class UZ{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},o){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=a??AZ.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=FZ(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:h}=await LZ({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=WZ(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:h}=await BZ(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return Kt(i)?{data:null,error:i}:{data:null,error:new bl("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}},o){if(!r)return{data:null,error:new uh("rpId is required for WebAuthn authentication")};try{if(!M2())return{data:null,error:new bl("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:o});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return Kt(i)?{data:null,error:i}:{data:null,error:new bl("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a},o){if(!r)return{data:null,error:new uh("rpId is required for WebAuthn registration")};try{if(!M2())return{data:null,error:new bl("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return Kt(i)?{data:null,error:i}:{data:null,error:new bl("Unexpected error in register",i)}}}}kZ();const qZ={url:OQ,storageKey:zQ,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:FQ,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function I2(n,t,r){return await r()}const vc={};class hh{get jwks(){var t,r;return(r=(t=vc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){vc[this.storageKey]=Object.assign(Object.assign({},vc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=vc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){vc[this.storageKey]=Object.assign(Object.assign({},vc[this.storageKey]),{cachedAt:t})}constructor(t){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hh.nextInstanceID,hh.nextInstanceID+=1,this.instanceID>0&&ea()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},qZ),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new jZ({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=EN(a.fetch),this.lock=a.lock||I2,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ea()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=_Z:this.lock=I2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new UZ(this)},this.persistSession?(a.storage?this.storage=a.storage:PN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=A2(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=A2(this.memoryStorage)),ea()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${CN}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=tZ(window.location.href);let s="none";if(this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce"),ea()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),GQ(o)){const c=(t=o.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Kt(r)?{error:r}:{error:new bl("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const o=await ar(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:$a}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Kt(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var r,s,a;try{let o;if("email"in t){const{email:u,password:h,options:p}=t;let g=null,f=null;this.flowType==="pkce"&&([g,f]=await xc(this.storage,this.storageKey)),o=await ar(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:f},xform:$a})}else if("phone"in t){const{phone:u,password:h,options:p}=t;o=await ar(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:$a})}else throw new up("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Kt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:i,options:l}=t;r=await ar(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:E2})}else if("phone"in t){const{phone:o,password:i,options:l}=t;r=await ar(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:E2})}else throw new up("You must provide either an email or phone number and a password");const{data:s,error:a}=r;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new gc}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(Kt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,s,a,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,o,i,l,c,d,u,h,p;let g,f;if("message"in t)g=t.message,f=t.signature;else{const{chain:m,wallet:v,statement:b,options:w}=t;let x;if(ea())if(typeof v=="object")x=v;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")x=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=v}const j=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),S=await x.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=AN(S[0]);let C=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!C){const M=await x.request({method:"eth_chainId"});C=CZ(M)}const N={domain:j.host,address:_,statement:b,uri:j.href,version:"1",chainId:C,nonce:(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.resources};g=TZ(N),f=await x.request({method:"personal_sign",params:[NZ(g),_]})}try{const{data:m,error:v}=await ar(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:f},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:$a});if(v)throw v;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new gc}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:v})}catch(m){if(Kt(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithSolana(t){var r,s,a,o,i,l,c,d,u,h,p,g;let f,m;if("message"in t)f=t.message,m=t.signature;else{const{chain:v,wallet:b,statement:w,options:x}=t;let j;if(ea())if(typeof b=="object")j=b;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))j=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=b}const S=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const _=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let C;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")C=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)C=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)f=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${S.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(s=x==null?void 0:x.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x==null?void 0:x.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const _=await j.signMessage(new TextEncoder().encode(f),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=_}}try{const{data:v,error:b}=await ar(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Nl(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:$a});if(b)throw b;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new gc}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:b})}catch(v){if(Kt(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await il(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{const{data:o,error:i}=await ar(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:$a});if(await ci(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new gc}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:i})}catch(o){if(Kt(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:o,nonce:i}=t,l=await ar(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:$a}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new gc}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Kt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,s,a,o,i;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await xc(this.storage,this.storageKey));const{error:h}=await ar(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await ar(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new up("You must provide either an email or phone number.")}catch(l){if(Kt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,s;try{let a,o;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await ar(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:$a});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Kt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,s,a;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await xc(this.storage,this.storageKey)),await ar(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:yZ})}catch(o){if(Kt(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new di;const{error:a}=await ar(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Kt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:o}=t,{error:i}=await ar(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:s,type:a,options:o}=t,{data:i,error:l}=await ar(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new up("You must provide either an email or phone number and a type")}catch(r){if(Kt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await il(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Qg:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const i=await il(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=t0()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ar(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:bi}):await this._useSession(async r=>{var s,a,o;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new di}:await ar(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:bi})})}catch(r){if(Kt(r))return YQ(r)&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:o}=s;if(o)throw o;if(!a.session)throw new di;const i=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await xc(this.storage,this.storageKey));const{data:d,error:u}=await ar(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:bi});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(Kt(s))return{data:{user:null},error:s};throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new di;const r=Date.now()/1e3;let s=r,a=!0,o=null;const{payload:i}=e0(t.access_token);if(i.exp&&(s=i.exp,a=s<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(Kt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new di;const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Kt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ea())throw new hp("No browser detected.");if(t.error||t.error_description||t.error_code)throw new hp(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new S2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new S2("No code detected.");const{data:w,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=t;if(!o||!l||!i||!d)throw new hp("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let p=u+h;c&&(p=parseInt(c));const g=p-u;g*1e3<=Nc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const f=p-h;u-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,p,u):u-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,p,u);const{data:m,error:v}=await this._getUser(o);if(v)throw v;const b={provider_token:s,provider_refresh_token:a,access_token:o,expires_in:h,expires_at:p,refresh_token:i,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(s){if(Kt(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await il(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return{error:o};const i=(s=a.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(HQ(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await ci(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=eZ(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:o},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await xc(this.storage,this.storageKey,!0));try{return await ar(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Kt(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async o=>{var i,l,c,d,u;const{data:h,error:p}=o;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ar(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return ea()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:t.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Kt(s))return{data:{provider:t.provider,url:null},error:s};throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:o}}=r;if(a)throw a;const{options:i,provider:l,token:c,access_token:d,nonce:u}=t,h=await ar(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o==null?void 0:o.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:$a}),{data:p,error:g}=h;return g?{data:{user:null,session:null},error:g}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new gc}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),{data:p,error:g})}catch(a){if(Kt(a))return{data:{user:null,session:null},error:a};throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:i}=r;if(i)throw i;return await ar(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await sZ(async a=>(a>0&&await nZ(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await ar(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:$a})),(a,o)=>{const i=200*Math.pow(2,a);return o&&Zg(o)&&Date.now()+i-s<Nc})}catch(s){if(this._debug(r,"error",s),Kt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),ea()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await il(this.storage,this.storageKey);if(a&&this.userStorage){let i=await il(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Tc(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:t0()}else if(a&&!a.user&&!a.user){const i=await il(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await ci(this.storage,this.storageKey+"-user"),await Tc(this.storage,this.storageKey,a)):a.user=t0()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const o=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Qg;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${Qg}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Zg(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(a.access_token);!l&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new di;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Rf;const{data:o,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!o.session)throw new di;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(a,"error",o),Kt(o)){const i={data:null,error:o};return Zg(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Tc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const o=T2(a);await Tc(this.storage,this.storageKey,o)}else{const a=T2(r);await Tc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ci(this.storage,this.storageKey),await ci(this.storage,this.storageKey+"-code-verifier"),await ci(this.storage,this.storageKey+"-user"),this.userStorage&&await ci(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ea()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Nc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/Nc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Nc}ms, refresh threshold is ${ey} ticks`),a<=ey&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof RN)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ea()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,i]=await xc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const o=new URLSearchParams(s.queryParams);a.push(o.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;return o?{data:null,error:o}:await ar(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await ar(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?DZ(t.webauthn.credential_response):$Z(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await ar(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const i=await ar(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:MZ(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:IZ(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Kt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?{data:null,error:s}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,s;const{data:{session:a},error:o}=t;if(o)return{data:null,error:o};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=e0(a.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((s=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+UQ>a)return s;const{data:o,error:i}=await ar(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,s=o.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:g,error:f}=await this.getSession();if(f||!g.session)return{data:null,error:f};s=g.session.access_token}const{header:a,payload:o,signature:i,raw:{header:l,payload:c}}=e0(s);r!=null&&r.allowExpired||uZ(o.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:o,header:a,signature:i},error:null}}const u=hZ(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,QQ(`${l}.${c}`)))throw new ny("Invalid JWT signature");return{data:{claims:o,header:a,signature:i},error:null}}catch(s){if(Kt(s))return{data:null,error:s};throw s}}}hh.nextInstanceID=0;const HZ=hh;class YZ extends HZ{constructor(t){super(t)}}var GZ=globalThis&&globalThis.__awaiter||function(n,t,r,s){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):a(u.value).then(l,c)}d((s=s.apply(n,t||[])).next())})};class VZ{constructor(t,r,s){var a,o,i;this.supabaseUrl=t,this.supabaseKey=r;const l=BQ(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:TQ,realtime:EQ,auth:Object.assign(Object.assign({},PQ),{storageKey:c}),global:NQ},u=LQ(s??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=IQ(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new qX(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new _Q(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new jX(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},s={}){return this.rest.rpc(t,r,s)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return GZ(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:o,storageKey:i,flowType:l,lock:c,debug:d},u,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YZ({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:s,storage:a,userStorage:o,flowType:l,lock:c,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new iQ(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,r,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const KZ=(n,t,r)=>new VZ(n,t,r);function JZ(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const t=n.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}JZ()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const XZ="https://vzsbiixeonfmyvjqzvxc.supabase.co",QZ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ6c2JpaXhlb25mbXl2anF6dnhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4ODAzODYsImV4cCI6MjA3NTQ1NjM4Nn0.yGrcfXHsiqEsSMDmIWaDKpNwjIlGYxadk0_FEM4ITUE",xe=KZ(XZ,QZ),ZZ={getCurrentUser:async()=>{const{data:{user:n}}=await xe.auth.getUser();return n},signIn:async(n,t)=>{const{data:r,error:s}=await xe.auth.signInWithPassword({email:n,password:t});return{data:r,error:s}},signOut:async()=>{const{error:n}=await xe.auth.signOut();return{error:n}},getUserProfile:async n=>{const{data:t,error:r}=await xe.from("users").select("*").eq("id",n).single();return{data:t,error:r}},getLeagueProfile:async n=>{const{data:t,error:r}=await xe.from("league_profiles").select("*").eq("user_id",n).maybeSingle();return{data:t,error:r}},getLadderProfile:async n=>{const{data:t,error:r}=await xe.from("ladder_profiles").select("*").eq("user_id",n).maybeSingle();return{data:t,error:r}},getLadderPositions:async n=>{const{data:t,error:r}=await xe.from("ladder_positions").select("*").eq("ladder_id",n).order("position");return{data:t,error:r}},getChallenges:async n=>{const{data:t,error:r}=await xe.from("challenges").select("*").eq("ladder_id",n);return{data:t,error:r}},getMatches:async n=>{const{data:t,error:r}=await xe.from("matches").select("*").eq("ladder_id",n);return{data:t,error:r}}},eee=Object.freeze(Object.defineProperty({__proto__:null,default:xe,supabase:xe,supabaseHelpers:ZZ},Symbol.toStringTag,{value:"Module"}));class tee{constructor(){this.currentUser=null}setCurrentUser(t){this.currentUser=t}async getLadders(){try{const{data:t,error:r}=await xe.from("ladders").select("*").eq("is_active",!0).order("name");if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching ladders:",t),{success:!1,error:t.message}}}async getLadderPlayers(t){try{const{data:r,error:s}=await xe.from("ladder_profiles").select(`
          *,
          users (
            id,
            email,
            first_name,
            last_name
          )
        `).eq("ladder_id",t).eq("is_active",!0).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder players:",r),{success:!1,error:r.message}}}async getLadderPlayersByName(t){try{const{data:r,error:s}=await xe.from("ladder_profiles").select(`
          *,
          users (
            id,
            email,
            first_name,
            last_name
          )
        `).eq("ladder_name",t).eq("is_active",!0).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder players by name:",r),{success:!1,error:r.message}}}async getLadderMatches(t,r={}){try{let s=xe.from("matches").select(`
          *,
          challenger:users!matches_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!matches_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t);r.status&&(s=s.eq("status",r.status)),r.playerId&&(s=s.or(`challenger_id.eq.${r.playerId},defender_id.eq.${r.playerId}`)),r.limit&&(s=s.limit(r.limit)),s=s.order("created_at",{ascending:!1});const{data:a,error:o}=await s;if(o)throw o;return{success:!0,data:a}}catch(s){return console.error("Error fetching ladder matches:",s),{success:!1,error:s.message}}}async getLadderChallenges(t){try{const{data:r,error:s}=await xe.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t).eq("status","pending").order("created_at");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder challenges:",r),{success:!1,error:r.message}}}async getLadderPositions(t){try{const{data:r,error:s}=await xe.from("ladder_positions").select(`
          *,
          user:users!ladder_positions_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("ladder_id",t).order("position");if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching ladder positions:",r),{success:!1,error:r.message}}}async getUsers(){try{const{data:t,error:r}=await xe.from("users").select("*").order("first_name");if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching users:",t),{success:!1,error:t.message}}}async getLeagueProfiles(){try{const{data:t,error:r}=await xe.from("league_profiles").select(`
          *,
          user:users!league_profiles_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `);if(r)throw r;return{success:!0,data:t}}catch(t){return console.error("Error fetching league profiles:",t),{success:!1,error:t.message}}}async createMatch(t){try{const{data:r,error:s}=await xe.from("matches").insert([t]).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error creating match:",r),{success:!1,error:r.message}}}async updateMatch(t,r){try{const{data:s,error:a}=await xe.from("matches").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating match:",s),{success:!1,error:s.message}}}async deleteMatch(t){try{const{error:r}=await xe.from("matches").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting match:",r),{success:!1,error:r.message}}}async createChallenge(t){try{const r=await this.getUserByEmail(t.challengerEmail),s=await this.getUserByEmail(t.defenderEmail);if(!r.success||!s.success)throw new Error("Could not find challenger or defender user");const a=r.data.id,o=s.data.id,{data:i}=await xe.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",a).limit(1).single(),{data:l}=await xe.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",o).limit(1).single(),c={challenger_id:a,challenger_name:`${r.data.first_name} ${r.data.last_name}`,challenger_position:(i==null?void 0:i.position)||null,defender_id:o,defender_name:`${s.data.first_name} ${s.data.last_name}`,defender_position:(l==null?void 0:l.position)||null,ladder_id:null,status:"pending",proposed_date:t.preferredDates&&t.preferredDates.length>0?t.preferredDates[0]:null,proposed_location:t.location||"Legends Brews & Cues",match_format:t.raceLength?`race-to-${t.raceLength}`:"race-to-5",handicap:0,expires_at:new Date(Date.now()+7*24*60*60*1e3).toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:d,error:u}=await xe.from("challenges").insert([c]).select().single();if(u)throw u;return{success:!0,data:d}}catch(r){return console.error("Error creating challenge:",r),{success:!1,error:r.message}}}async updateChallenge(t,r){try{const{data:s,error:a}=await xe.from("challenges").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating challenge:",s),{success:!1,error:s.message}}}async updateLadderPosition(t,r,s){try{const{data:a,error:o}=await xe.from("ladder_positions").update(s).eq("user_id",t).eq("ladder_id",r).select().single();if(o)throw o;return{success:!0,data:a}}catch(a){return console.error("Error updating ladder position:",a),{success:!1,error:a.message}}}async updateLadderProfile(t,r,s){try{const{data:a,error:o}=await xe.from("ladder_profiles").update(s).eq("user_id",t).eq("ladder_id",r).select().single();if(o)throw o;return{success:!0,data:a}}catch(a){return console.error("Error updating ladder profile:",a),{success:!1,error:a.message}}}async getUserByEmail(t){try{const{data:r,error:s}=await xe.from("users").select("*").eq("email",t).single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error fetching user by email:",r),{success:!1,error:r.message}}}async createUser(t){try{const{data:r,error:s}=await xe.from("users").insert([t]).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error creating user:",r),{success:!1,error:r.message}}}async updateUser(t,r){try{const{data:s,error:a}=await xe.from("users").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating user:",s),{success:!1,error:s.message}}}async deleteUser(t){try{const{error:r}=await xe.from("users").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting user:",r),{success:!1,error:r.message}}}async getPendingChallenges(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:[]};const s=r.data.id,{data:a,error:o}=await xe.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("defender_id",s).eq("status","pending").order("created_at");if(o)throw o;return{success:!0,data:a||[]}}catch(r){return console.error("Error fetching pending challenges:",r),{success:!1,error:r.message}}}async getSentChallenges(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:[]};const s=r.data.id,{data:a,error:o}=await xe.from("challenges").select(`
          *,
          challenger:users!challenges_challenger_id_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          defender:users!challenges_defender_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("challenger_id",s).eq("status","pending").order("created_at");if(o)throw o;return{success:!0,data:a||[]}}catch(r){return console.error("Error fetching sent challenges:",r),{success:!1,error:r.message}}}async getPlayerProfileData(t,r="ladder"){try{const s=await this.getUserByEmail(t);if(!s.success)return{success:!1,error:"User not found"};const a=s.data,o=a.id,{data:i,error:l}=await xe.from("ladder_profiles").select("*").eq("user_id",o).maybeSingle(),{data:c,error:d}=await xe.from("league_profiles").select("*").eq("user_id",o).maybeSingle();return{success:!0,data:{user:a,ladderProfile:i||null,leagueProfile:c||null,hasLadderProfile:!!i,hasLeagueProfile:!!c}}}catch(s){return console.error("Error fetching player profile data:",s),{success:!1,error:s.message}}}async getPlayerGracePeriodStatus(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}};const{data:s}=await xe.from("ladder_profiles").select("immunity_until, vacation_until, vacation_mode").eq("user_id",r.data.id).maybeSingle();if(!s)return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}};const a=new Date,o=s.immunity_until?new Date(s.immunity_until):null,i=s.vacation_until?new Date(s.vacation_until):null,l=o&&o>a,c=s.vacation_mode&&i&&i>a;return{success:!0,data:{inGracePeriod:l||c,gracePeriodEnd:l?o:c?i:null,immunityUntil:s.immunity_until,vacationUntil:s.vacation_until,vacationMode:s.vacation_mode}}}catch(r){return console.error("Error fetching grace period status:",r),{success:!1,error:r.message}}}async getPlayerDeclineStatus(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!0,declineStatus:{availableDeclines:0,canDecline:!1,nextResetDate:null,daysUntilNextReset:0}};const{data:s}=await xe.from("ladder_profiles").select("decline_count, last_decline_date").eq("user_id",r.data.id).maybeSingle();if(!s)return{success:!0,declineStatus:{availableDeclines:0,canDecline:!1,nextResetDate:null,daysUntilNextReset:0}};const a=2,o=new Date,i=s.last_decline_date?new Date(s.last_decline_date):null;let l=s.decline_count||0;i&&(i.getMonth()===o.getMonth()&&i.getFullYear()===o.getFullYear()||(l=0));const c=Math.max(0,a-l),d=new Date(o.getFullYear(),o.getMonth()+1,1),u=Math.ceil((d-o)/(1e3*60*60*24));return{success:!0,declineStatus:{availableDeclines:c,canDecline:c>0,declineCount:l,lastDeclineDate:s.last_decline_date,nextResetDate:d.toISOString(),daysUntilNextReset:u}}}catch(r){return console.error("Error fetching decline status:",r),{success:!1,error:r.message}}}async getFastTrackStatus(t){try{return{success:!0,data:{isFastTrack:!1,fastTrackUntil:null}}}catch(r){return console.error("Error fetching fast track status:",r),{success:!1,error:r.message}}}async submitFastTrackPlayerChoice(t,r){try{console.log(" Submitting Fast Track player choice:",{playerEmail:t,choice:r});const s=await this.getUserByEmail(t);if(!s.success)throw new Error("User not found");const a=s.data.id,{data:o,error:i}=await xe.from("ladder_profiles").select("*").eq("user_id",a).single();if(i)throw i;if(!o)throw new Error("Player profile not found");if(r==="stay")return console.log(" Player chose to stay on current ladder"),{success:!0,message:"You will remain on your current ladder",choice:"stay"};if(r==="move_down"){const l=o.ladder_name;let c=null;if(l==="500-549"?c="499-under":l==="550-599"?c="500-549":l==="600-plus"&&(c="550-599"),!c)throw new Error("Cannot move down from current ladder");await xe.from("ladder_profiles").delete().eq("user_id",a).eq("ladder_name",l);const{data:d}=await xe.from("ladder_profiles").select("user_id, position").eq("ladder_name",l).gt("position",o.position).order("position",{ascending:!0});if(d&&d.length>0){const f=d.map(m=>({user_id:m.user_id,ladder_name:l,position:m.position-1}));for(const m of f)await xe.from("ladder_profiles").update({position:m.position}).eq("user_id",m.user_id).eq("ladder_name",m.ladder_name)}const{data:u}=await xe.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1),h=u&&u.length>0?u[0].position+1:1,p=new Date;p.setDate(p.getDate()+28);const{error:g}=await xe.from("ladder_profiles").insert({user_id:a,ladder_name:c,position:h,wins:o.wins||0,losses:o.losses||0,total_matches:o.total_matches||0,is_active:!0,fast_track_challenges:2,fast_track_until:p.toISOString(),fargo_rate:o.fargo_rate});if(g)throw g;return console.log(" Player moved down with Fast Track privileges:",{from:l,to:c,position:h,fastTrackChallenges:2,expiresAt:p}),{success:!0,message:`You have been moved to the ${c} ladder with 2 Fast Track challenges`,choice:"move_down",newLadder:c,newPosition:h,fastTrackChallenges:2,fastTrackExpiration:p.toISOString()}}else throw new Error("Invalid choice")}catch(s){return console.error("Error submitting Fast Track player choice:",s),{success:!1,error:s.message}}}async startFastTrackGracePeriod(t){try{console.log(" Starting Fast Track grace period for:",t);const r=await this.getUserByEmail(t);if(!r.success)throw new Error("User not found");const s=r.data.id,{data:a,error:o}=await xe.from("ladder_profiles").select("*").eq("user_id",s).single();if(o)throw o;if(!a)throw new Error("Player profile not found");const i=new Date;i.setDate(i.getDate()+14);const{error:l}=await xe.from("ladder_profiles").update({grace_period_start:new Date().toISOString(),grace_period_end:i.toISOString()}).eq("user_id",s).eq("ladder_name",a.ladder_name);if(l)throw l;return console.log(" Grace period started:",{userId:s,ladder:a.ladder_name,startDate:new Date().toISOString(),endDate:i.toISOString(),daysRemaining:14}),{success:!0,message:"Grace period started successfully! You have 14 days to maintain your rating.",gracePeriodStart:new Date().toISOString(),gracePeriodEnd:i.toISOString(),daysRemaining:14}}catch(r){return console.error("Error starting Fast Track grace period:",r),{success:!1,error:r.message}}}async getFastTrackGracePeriod(t){try{return{success:!0,data:{inGracePeriod:!1,gracePeriodEnd:null}}}catch(r){return console.error("Error fetching fast track grace period:",r),{success:!1,error:r.message}}}async getPlayerLastMatch(t){try{const r=await this.getUserByEmail(t);if(!r.success||!r.data)return{success:!1,error:"User not found"};const s=r.data.id,{data:a,error:o}=await xe.from("matches").select("*").or(`winner_id.eq.${s},loser_id.eq.${s}`).eq("status","completed").order("match_date",{ascending:!1}).limit(1);if(o)throw o;if(!a||a.length===0)return{success:!0,data:null};const i=a[0];return{success:!0,data:{result:i.winner_id===s?"W":"L",opponent:i.winner_id===s?i.loser_name:i.winner_name,date:i.match_date,venue:i.location||"Unknown",matchType:"challenge",playerRole:i.winner_id===s?"winner":"loser",score:i.score||"N/A",id:i.id,status:i.status||"scheduled",match_date:i.match_date,location:i.location,verified_by:i.verified_by,verified_at:i.verified_at,notes:i.notes}}}catch(r){return console.error("Error fetching player last match:",r),{success:!1,error:r.message}}}async getPlayerMatchHistory(t,r=10){try{const s=await this.getUserByEmail(t);if(!s.success||!s.data)return{success:!1,error:"User not found"};const a=s.data.id,{data:o,error:i}=await xe.from("matches").select("*").or(`winner_id.eq.${a},loser_id.eq.${a}`).eq("status","completed").order("match_date",{ascending:!1}).limit(r);if(i)throw i;return{success:!0,data:o.map(c=>({result:c.winner_id===a?"W":"L",opponent:c.winner_id===a?c.loser_name:c.winner_name,date:c.match_date,venue:c.location||"Unknown",matchType:"challenge",playerRole:c.winner_id===a?"winner":"loser",score:c.score||"N/A",id:c.id,status:c.status||"scheduled",match_date:c.match_date,location:c.location,verified_by:c.verified_by,verified_at:c.verified_at,notes:c.notes,positionBefore:c.winner_position||c.loser_position,positionAfter:null}))}}catch(s){return console.error("Error fetching player match history:",s),{success:!1,error:s.message}}}async acceptChallenge(t,r){try{const{data:s,error:a}=await xe.from("challenges").update({status:"accepted",proposed_date:r.selectedDate||null,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error accepting challenge:",s),{success:!1,error:s.message}}}async declineChallenge(t,r){try{const{data:s,error:a}=await xe.from("challenges").update({status:"declined",updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;if(r.defenderEmail){const o=await this.getUserByEmail(r.defenderEmail);if(o.success&&o.data){const{data:i}=await xe.from("ladder_profiles").select("decline_count").eq("user_id",o.data.id).limit(1),l=i&&i.length>0&&i[0].decline_count||0;await xe.from("ladder_profiles").update({decline_count:l+1,last_decline_date:new Date().toISOString()}).eq("user_id",o.data.id)}}return{success:!0,data:s}}catch(s){return console.error("Error declining challenge:",s),{success:!1,error:s.message}}}async counterProposeChallenge(t,r){try{const{data:s,error:a}=await xe.from("challenges").update({status:"counter-proposed",proposed_date:r.preferredDates&&r.preferredDates.length>0?r.preferredDates[0]:null,proposed_location:r.location||null,match_format:r.raceLength?`race-to-${r.raceLength}`:null,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error submitting counter-proposal:",s),{success:!1,error:s.message}}}async reportMatchResult(t){try{const r=await this.getUserByEmail(t.winnerEmail),s=await this.getUserByEmail(t.loserEmail);if(!r.success||!s.success)throw new Error("Could not find winner or loser user");const a=r.data.id,o=s.data.id,i={league_id:null,ladder_id:null,challenge_id:t.challengeId||null,winner_id:a,winner_name:`${r.data.first_name} ${r.data.last_name}`,winner_position:t.winnerPosition||null,loser_id:o,loser_name:`${s.data.first_name} ${s.data.last_name}`,loser_position:t.loserPosition||null,score:t.score||null,match_date:t.matchDate||new Date().toISOString(),location:t.location||"Legends Brews & Cues",verified_by:t.verifiedBy||null,verified_at:t.verifiedAt||null,notes:t.notes||null,created_at:new Date().toISOString()},{data:l,error:c}=await xe.from("matches").insert([i]).select().single();if(c)throw c;await this.updatePlayerStats(a,{wins:1}),await this.updatePlayerStats(o,{losses:1}),t.challengeId&&await this.updateChallenge(t.challengeId,{status:"completed",updated_at:new Date().toISOString()});try{await(await _a(()=>import("./emailNotificationService-ca9f8bfb.js"),[])).default.sendMatchCompleted({loserEmail:t.loserEmail,loserName:`${s.data.first_name} ${s.data.last_name}`,winnerName:`${r.data.first_name} ${r.data.last_name}`,matchDate:t.matchDate,location:t.location,score:t.score,ladderName:t.ladderName,newPosition:t.loserPosition}),console.log(" Match completed emails sent")}catch(d){console.error("Failed to send match completed email:",d)}return{success:!0,data:l}}catch(r){return console.error("Error reporting match result:",r),{success:!1,error:r.message}}}async updatePlayerStats(t,r){try{const{data:s}=await xe.from("ladder_profiles").select("wins, losses, total_matches").eq("user_id",t).limit(1).single();if(!s)throw new Error("Player profile not found");const a={wins:(s.wins||0)+(r.wins||0),losses:(s.losses||0)+(r.losses||0),total_matches:(s.total_matches||0)+1},{data:o,error:i}=await xe.from("ladder_profiles").update(a).eq("user_id",t).select().single();if(i)throw i;return{success:!0,data:o}}catch(s){return console.error("Error updating player stats:",s),{success:!1,error:s.message}}}async getUserProfileData(t){try{const r=await this.getUserByEmail(t);if(!r.success)return{success:!1,error:"User not found"};const s=r.data,{data:a}=await xe.from("ladder_profiles").select("*").eq("user_id",s.id).maybeSingle(),{data:o}=await xe.from("league_profiles").select("*").eq("user_id",s.id).maybeSingle();return{success:!0,data:{user:s,profile:{email:s.email,firstName:s.first_name,lastName:s.last_name,phone:s.phone,locations:s.locations||"",availability:s.availability||{},divisions:[],ladderInfo:a?{ladderName:a.ladder_name,position:a.position,wins:a.wins,losses:a.losses,fargoRate:a.fargo_rate}:null,leagueInfo:o?{division:o.division,skillLevel:o.skill_level}:null}}}}catch(r){return console.error("Error fetching user profile data:",r),{success:!1,error:r.message}}}async updateUserProfile(t,r){try{const s=await this.getUserByEmail(t);if(!s.success)return{success:!1,error:"User not found"};const a=s.data.id,o={};if(r.firstName&&(o.first_name=r.firstName),r.lastName&&(o.last_name=r.lastName),r.phone!==void 0&&(o.phone=r.phone),r.locations!==void 0&&(o.locations=r.locations),r.availability!==void 0&&(o.availability=r.availability),Object.keys(o).length>0){const{error:i}=await xe.from("users").update(o).eq("id",a);if(i)throw i}return{success:!0,data:{message:"Profile updated successfully"}}}catch(s){return console.error("Error updating user profile:",s),{success:!1,error:s.message}}}async getLocations(){try{return{success:!0,data:[{name:"Legends Brews & Cues"},{name:"Rack'em Billiards"},{name:"Pastime Lounge"},{name:"Murray Street Darts"},{name:"My House"}]}}catch(t){return console.error("Error fetching locations:",t),{success:!1,error:t.message}}}async getAvailableMatches(t){try{const r=t.trim().toLowerCase(),{data:s,error:a}=await xe.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `);if(a)throw a;const o=s.filter(c=>{const d=`${c.users.first_name} ${c.users.last_name}`.toLowerCase(),u=c.users.first_name.toLowerCase(),h=c.users.last_name.toLowerCase(),p=(c.users.email||"").toLowerCase();return d.includes(r)||u.includes(r)||h.includes(r)||p.includes(r)});if(!o||o.length===0)return{success:!1,message:"Player not found. Please check the name and try again."};if(o.length>1)return{success:!0,multipleMatches:!0,playerOptions:o.map(d=>({_id:d.id,fullName:`${d.users.first_name} ${d.users.last_name}`,position:d.position,ladderName:d.ladder_name,fargoRate:d.fargo_rate||"N/A"}))};const i=o[0],l=await this.getPlayerAvailableMatches(i);return{success:!0,player:{_id:i.id,name:`${i.users.first_name} ${i.users.last_name}`,email:i.users.email,phone:i.users.phone,position:i.position,ladderName:i.ladder_name,fargoRate:i.fargo_rate},availableMatches:l}}catch(r){return console.error("Error getting available matches:",r),{success:!1,error:r.message}}}async getPlayerAvailableMatches(t){try{const r=[],{data:s,error:a}=await xe.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `).eq("ladder_name",t.ladder_name).lt("position",t.position).gte("position",Math.max(1,t.position-4)).order("position",{ascending:!0});if(a)throw a;s.forEach(l=>{r.push({defenderName:`${l.users.first_name} ${l.users.last_name}`,defenderEmail:l.users.email,defenderPhone:l.users.phone,defenderPosition:l.position,ladderName:l.ladder_name,matchType:"challenge",color:"#2196F3",icon:"",reason:`Challenge match - Position #${l.position}`})});const{data:o,error:i}=await xe.from("ladder_profiles").select(`
          *,
          users!inner(first_name, last_name, email, phone)
        `).eq("ladder_name",t.ladder_name).gt("position",t.position).lte("position",t.position+5).order("position",{ascending:!0});if(i)throw i;return o.forEach(l=>{r.push({defenderName:`${l.users.first_name} ${l.users.last_name}`,defenderEmail:l.users.email,defenderPhone:l.users.phone,defenderPosition:l.position,ladderName:l.ladder_name,matchType:"smackdown",color:"#FF5722",icon:"",reason:`SmackDown - Position #${l.position}`})}),r}catch(r){return console.error("Error getting player available matches:",r),[]}}async submitMatchSchedulingRequest(t){try{const{data:r,error:s}=await xe.from("match_scheduling_requests").insert({challenger_name:t.challengerName,challenger_email:t.challengerEmail,challenger_phone:t.challengerPhone,defender_name:t.defenderName,defender_email:t.defenderEmail,defender_phone:t.defenderPhone,preferred_date:t.preferredDate,preferred_time:t.preferredTime,location:t.location,game_type:t.gameType,race_length:t.raceLength,notes:t.notes,match_type:t.matchType,status:t.status||"pending_approval",submitted_at:t.submittedAt||new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Error submitting match scheduling request:",r),{success:!1,error:r.message}}}async getPendingMatchSchedulingRequests(){try{const{data:t,error:r}=await xe.from("match_scheduling_requests").select("*").eq("status","pending_approval").order("submitted_at",{ascending:!1});if(r)throw r;return{success:!0,requests:t||[]}}catch(t){return console.error("Error getting pending match scheduling requests:",t),{success:!1,error:t.message}}}async getScheduledMatches(t=null){try{let r=xe.from("matches").select(`
          *,
          winner:users!matches_winner_id_fkey(id, first_name, last_name, email),
          loser:users!matches_loser_id_fkey(id, first_name, last_name, email)
        `).eq("status","scheduled");t&&(r=r.eq("ladder_id",t));const{data:s,error:a}=await r.order("match_date",{ascending:!0});if(a)throw a;return{success:!0,matches:(s||[]).map(i=>{const l=i.winner,c=i.loser,d=p=>{if(!p)return{firstName:"",lastName:""};const g=p.trim().split(" ");return{firstName:g[0]||"",lastName:g.slice(1).join(" ")||""}},u=l?null:d(i.winner_name),h=c?null:d(i.loser_name);return{...i,scheduledDate:i.match_date||i.scheduled_date||i.scheduledDate,raceLength:i.race_length||i.raceLength,gameType:i.game_type||i.gameType,tableSize:i.table_size||i.tableSize,matchType:i.match_type||i.matchType||"challenge",venue:i.location||i.venue,player1:l?{id:l.id,firstName:l.first_name,lastName:l.last_name,email:l.email,_id:l.id}:i.winner_name?{id:i.winner_id,firstName:u.firstName,lastName:u.lastName,email:null,_id:i.winner_id}:null,player2:c?{id:c.id,firstName:c.first_name,lastName:c.last_name,email:c.email,_id:c.id}:i.loser_name?{id:i.loser_id,firstName:h.firstName,lastName:h.lastName,email:null,_id:i.loser_id}:null,winner:l,loser:c,match_date:i.match_date,race_length:i.race_length,game_type:i.game_type,table_size:i.table_size,match_type:i.match_type,winner_name:i.winner_name,loser_name:i.loser_name}})}}catch(r){return console.error("Error getting scheduled matches:",r),{success:!1,error:r.message}}}async getScheduledMatchesForLadder(t){try{if(!t)return console.warn("getScheduledMatchesForLadder called without ladderName"),{success:!0,matches:[]};const{data:r,error:s}=await xe.from("ladder_profiles").select("user_id").eq("ladder_name",t);if(s)throw s;const a=r.map(l=>l.user_id);if(a.length===0)return{success:!0,matches:[]};const{data:o,error:i}=await xe.from("matches").select("*").in("status",["scheduled","completed"]).or(`winner_id.in.(${a.join(",")}),loser_id.in.(${a.join(",")})`).order("match_date",{ascending:!0});if(i)throw i;return{success:!0,matches:o||[]}}catch(r){return console.error("Error getting scheduled matches for ladder:",r),{success:!1,error:r.message}}}async getAllMatchesForLadder(t){try{if(!t)return console.warn("getAllMatchesForLadder called without ladderName"),{success:!0,matches:[]};const{data:r,error:s}=await xe.from("ladder_profiles").select("user_id").eq("ladder_name",t);if(s)throw s;const a=r.map(m=>m.user_id);if(a.length===0)return{success:!0,matches:[]};const{data:o,error:i}=await xe.from("matches").select("*").or(`winner_id.in.(${a.join(",")}),loser_id.in.(${a.join(",")})`).order("match_date",{ascending:!1});if(i)throw i;const l=new Set;(o||[]).forEach(m=>{m.winner_id&&l.add(m.winner_id),m.loser_id&&l.add(m.loser_id),m.challenger_id&&l.add(m.challenger_id),m.defender_id&&l.add(m.defender_id)});const{data:c,error:d}=await xe.from("users").select("id, first_name, last_name").in("id",Array.from(l));if(d)throw d;const{data:u,error:h}=await xe.from("ladder_profiles").select("user_id, position").eq("ladder_name",t);if(h)throw h;const p=new Map,g=new Map;return(c||[]).forEach(m=>{p.set(m.id,`${m.first_name} ${m.last_name}`)}),(u||[]).forEach(m=>{g.set(m.user_id,m.position)}),{success:!0,matches:(o||[]).map(m=>{const v=g.get(m.winner_id),b=g.get(m.loser_id);return{...m,winner_name:m.winner_name||p.get(m.winner_id)||"N/A",loser_name:m.loser_name||p.get(m.loser_id)||"N/A",challenger_name:m.challenger_name||p.get(m.challenger_id)||"N/A",defender_name:m.defender_name||p.get(m.defender_id)||"N/A",winner_position:v,loser_position:b}})}}catch(r){return console.error("Error getting all matches for ladder:",r),{success:!1,error:r.message}}}async getRecentMatchesForPlayer(t,r=5){try{if(!t)return console.warn("getRecentMatchesForPlayer called without playerId"),{success:!0,matches:[]};const{data:s,error:a}=await xe.from("matches").select("*").or(`winner_id.eq.${t},loser_id.eq.${t}`).eq("status","completed").order("match_date",{ascending:!1}).limit(r);if(a)throw a;return{success:!0,matches:s||[]}}catch(s){return console.error("Error getting recent matches for player:",s),{success:!1,error:s.message}}}async getAllPlayerMatches(t,r=["499-under","500-549","550-plus"]){try{if(!t)return console.warn("getAllPlayerMatches called without playerEmail"),{success:!0,matches:[]};console.log(" Getting matches for player:",t,"across ladders:",r);const s=new Set;for(const b of r){const{data:w,error:x}=await xe.from("ladder_profiles").select("user_id").eq("ladder_name",b);if(x){console.error(`Error fetching players from ${b}:`,x);continue}w.forEach(j=>s.add(j.user_id))}if(s.size===0)return{success:!0,matches:[]};const{data:a,error:o}=await xe.from("users").select("id, first_name, last_name, email").eq("email",t.toLowerCase());if(o)throw o;if(!a||a.length===0)return console.log(" No user found with email:",t),{success:!0,matches:[]};const i=a[0].id,{data:l,error:c}=await xe.from("matches").select("*").or(`winner_id.eq.${i},loser_id.eq.${i}`).in("winner_id",Array.from(s)).in("loser_id",Array.from(s)).order("match_date",{ascending:!1});if(c)throw c;const d=new Set;l.forEach(b=>{b.winner_id&&d.add(b.winner_id),b.loser_id&&d.add(b.loser_id),b.challenger_id&&d.add(b.challenger_id),b.defender_id&&d.add(b.defender_id)});const{data:u,error:h}=await xe.from("users").select("id, first_name, last_name, email").in("id",Array.from(d));if(h)throw h;const p=new Map;u.forEach(b=>{p.set(b.id,{firstName:b.first_name,lastName:b.last_name,email:b.email})});const{data:g,error:f}=await xe.from("ladder_profiles").select("user_id, ladder_name, position").in("ladder_name",r);if(f)throw f;const m=new Map;g.forEach(b=>{m.set(`${b.user_id}_${b.ladder_name}`,b.position)});const v=l.map(b=>{const w=p.get(b.winner_id),x=p.get(b.loser_id),j=p.get(b.challenger_id),S=p.get(b.defender_id);let _="unknown";for(const C of r)if(m.has(`${b.winner_id}_${C}`)||m.has(`${b.loser_id}_${C}`)){_=C;break}return{...b,_id:b.id,player1:w?{firstName:w.firstName,lastName:w.lastName,email:w.email,id:b.winner_id}:null,player2:x?{firstName:x.firstName,lastName:x.lastName,email:x.email,id:b.loser_id}:null,challenger:j?{firstName:j.firstName,lastName:j.lastName,email:j.email,id:b.challenger_id}:null,defender:S?{firstName:S.firstName,lastName:S.lastName,email:S.email,id:b.defender_id}:null,ladderName:_,ladderDisplayName:_==="499-under"?"499 & Under":_==="500-549"?"500-549":_==="550-plus"?"550+":_,matchType:b.match_type,status:b.status,matchDate:b.match_date,scheduledDate:b.scheduled_date,location:b.location,notes:b.notes,score:b.score}});return console.log(" Transformed matches for player:",v.length),{success:!0,matches:v}}catch(s){return console.error("Error getting all player matches:",s),{success:!1,error:s.message}}}async getScheduledMatchesForPlayer(t,r){try{if(!t||!r)return console.warn("getScheduledMatchesForPlayer called without playerEmail or ladderName"),{success:!0,matches:[]};console.log(" Getting scheduled matches for player:",t,"on ladder:",r);const{data:s,error:a}=await xe.from("users").select("id, first_name, last_name, email").eq("email",t.toLowerCase());if(a)throw a;if(!s||s.length===0)return console.log(" No user found with email:",t),{success:!0,matches:[]};const o=s[0].id,{data:i,error:l}=await xe.from("ladder_profiles").select("user_id").eq("ladder_name",r);if(l)throw l;const c=i.map(w=>w.user_id);if(c.length===0)return{success:!0,matches:[]};const{data:d,error:u}=await xe.from("matches").select("*").eq("status","scheduled").or(`winner_id.eq.${o},loser_id.eq.${o}`).in("winner_id",c).in("loser_id",c),h=(d==null?void 0:d.filter(w=>!w.ladder_id||w.ladder_id===r))||[];h.sort((w,x)=>{const j=w.match_date?new Date(w.match_date):new Date(0),S=x.match_date?new Date(x.match_date):new Date(0);return j-S});const p=h;if(u)throw u;const g=new Set;d.forEach(w=>{w.winner_id&&g.add(w.winner_id),w.loser_id&&g.add(w.loser_id),w.challenger_id&&g.add(w.challenger_id),w.defender_id&&g.add(w.defender_id)});const{data:f,error:m}=await xe.from("users").select("id, first_name, last_name, email").in("id",Array.from(g));if(m)throw m;const v=new Map;f.forEach(w=>{v.set(w.id,{firstName:w.first_name,lastName:w.last_name,email:w.email,id:w.id})});const b=d.map(w=>{const x=v.get(w.winner_id),j=v.get(w.loser_id),S=v.get(w.challenger_id),_=v.get(w.defender_id),C=M=>{if(!M)return"";const E=new Date(M),P=E.getFullYear(),D=String(E.getMonth()+1).padStart(2,"0"),T=String(E.getDate()).padStart(2,"0");return`${P}-${D}-${T}`},N=w.match_date||w.scheduled_date||w.scheduledDate;return console.log(" Transforming match date:",{match_id:w.id,match_date:w.match_date,scheduled_date:w.scheduled_date,selected:N,formatted:C(N)}),{_id:w.id,senderName:x?`${x.firstName} ${x.lastName}`:"Unknown",receiverName:j?`${j.firstName} ${j.lastName}`:"Unknown",senderId:w.winner_id,receiverId:w.loser_id,date:C(N),match_date:w.match_date,scheduled_date:w.scheduled_date,scheduledDate:N,time:N?new Date(N).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",location:w.location||"TBD",status:w.status,createdAt:w.created_at||new Date().toISOString(),matchFormat:w.game_type||"9-ball",raceLength:w.race_length||"7",player1:x?{firstName:x.firstName,lastName:x.lastName,email:x.email,_id:x.id}:null,player2:j?{firstName:j.firstName,lastName:j.lastName,email:j.email,_id:j.id}:null,challenger:S?{firstName:S.firstName,lastName:S.lastName,email:S.email,_id:S.id}:null,defender:_?{firstName:_.firstName,lastName:_.lastName,email:_.email,_id:_.id}:null,scheduledDate:w.scheduled_date,matchType:w.match_type}});return console.log(" Transformed scheduled matches for player:",b.length),{success:!0,matches:b}}catch(s){return console.error("Error getting scheduled matches for player:",s),{success:!1,error:s.message}}}async createScheduledMatch(t){var r;try{let s=null,a=null;const o=3;for(let h=1;h<=o;h++){console.log(` Authentication check attempt ${h}/${o}`);const{data:p,error:g}=await xe.auth.getSession();if(!g&&(p!=null&&p.session)){a=p.session,s=p.session.user,console.log(" Session found:",s.id);break}else{console.log(` No session on attempt ${h}, error:`,g);const{data:{user:f},error:m}=await xe.auth.getUser();if(!m&&f){s=f,console.log(" User found via getUser:",s.id);break}else console.log(` No user on attempt ${h}, error:`,m),h<o&&await new Promise(v=>setTimeout(v,1e3*h))}}if(!s){console.error(" Authentication error - no session or user after retries"),await new Promise(p=>setTimeout(p,2e3));const{data:h}=await xe.auth.getSession();if((r=h==null?void 0:h.session)!=null&&r.user)s=h.session.user,console.log(" Session found on final retry:",s.id);else throw new Error("User not authenticated. Please log in again. If you just logged in, please wait a moment and try again.")}console.log(" Looking up user IDs for:",{challengerEmail:t.challengerEmail,defenderEmail:t.defenderEmail});const i=await this.getUserIdByEmail(t.challengerEmail),l=await this.getUserIdByEmail(t.defenderEmail);if(console.log(" User IDs found:",{challengerId:i,defenderId:l}),!i||!l)throw new Error("Could not find user IDs for challenger or defender");const c={ladder_id:t.ladderName,winner_id:i,winner_name:t.challengerName,winner_position:t.challengerPosition,loser_id:l,loser_name:t.defenderName,loser_position:t.defenderPosition,score:null,match_date:t.preferredDate,location:t.location,match_type:t.matchType,game_type:t.gameType,race_length:t.raceLength,notes:t.notes,status:"scheduled"};console.log(" Attempting to insert match:",c);const{data:d,error:u}=await xe.from("matches").insert(c).select().single();if(u)throw console.error(" Supabase insert error:",u),console.error(" Error code:",u.code),console.error(" Error message:",u.message),console.error(" Error details:",u.details),console.error(" Error hint:",u.hint),u;return console.log(" Match created successfully:",d),{success:!0,data:d}}catch(s){console.error(" Error creating scheduled match:",s);const a=s.message||s.toString();return console.error(" Full error object:",s),{success:!1,error:a}}}async getUserIdByEmail(t){try{let r=null;const{data:s,error:a}=await xe.auth.getSession();if(!a&&(s!=null&&s.session))r=s.session.user;else{const{data:{user:l},error:c}=await xe.auth.getUser();if(!c&&l)r=l;else throw console.error(" Not authenticated when getting user ID:",{sessionError:a,authError:c}),new Error("User not authenticated")}if(!r)throw new Error("User not authenticated");console.log(" Looking up user ID for email:",t);const{data:o,error:i}=await xe.from("users").select("id").eq("email",t).single();if(i)throw console.error(" Error querying users table:",i),console.error(" Error code:",i.code),console.error(" Error message:",i.message),i;return console.log(" Found user ID:",o==null?void 0:o.id),o==null?void 0:o.id}catch(r){return console.error(" Error getting user ID by email:",r),null}}async getAllUsersForAdmin(){try{const{data:t,error:r}=await xe.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses,
            is_active
          ),
          league_profiles (
            id,
            division,
            divisions,
            total_matches,
            wins,
            losses
          )
        `).order("created_at",{ascending:!1});if(r)throw r;return{success:!0,users:t||[]}}catch(t){return console.error("Error getting all users for admin:",t),{success:!1,error:t.message}}}async searchUsersForAdmin(t){try{const r=t.trim().toLowerCase(),{data:s,error:a}=await xe.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses,
            is_active
          ),
          league_profiles (
            id,
            division,
            divisions,
            total_matches,
            wins,
            losses
          )
        `).order("created_at",{ascending:!1});if(a)throw a;return{success:!0,users:s.filter(i=>{const l=(i.first_name||"").toLowerCase(),c=(i.last_name||"").toLowerCase(),d=(i.email||"").toLowerCase(),u=`${l} ${c}`.toLowerCase();return l.includes(r)||c.includes(r)||d.includes(r)||u.includes(r)})||[]}}catch(r){return console.error("Error searching users for admin:",r),{success:!1,error:r.message}}}async getAdminUserData(t){var r,s;try{const{data:a,error:o}=await xe.from("users").select(`
          *,
          ladder_profiles (*),
          league_profiles (*)
        `).eq("id",t).single();if(o)throw o;return{success:!0,user:a,ladderProfile:((r=a.ladder_profiles)==null?void 0:r[0])||null,leagueProfile:((s=a.league_profiles)==null?void 0:s[0])||null}}catch(a){return console.error("Error getting admin user data:",a),{success:!1,error:a.message}}}async updateAdminUser(t,r){try{const{data:s,error:a}=await xe.from("users").update({first_name:r.firstName,last_name:r.lastName,email:r.email,phone:r.phone,is_active:r.isActive,is_approved:r.isApproved,is_admin:r.isAdmin,locations:r.locations,availability:r.availability}).eq("id",t).select().single();if(a)throw a;return{success:!0,user:s}}catch(s){return console.error("Error updating admin user:",s),{success:!1,error:s.message}}}async deleteAdminUser(t){try{const{error:r}=await xe.from("users").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting admin user:",r),{success:!1,error:r.message}}}async getPendingUsers(){try{const{data:t,error:r}=await xe.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position
          )
        `).eq("is_pending_approval",!0).order("created_at",{ascending:!1});if(r)throw r;return{success:!0,users:t||[]}}catch(t){return console.error("Error getting pending users:",t),{success:!1,error:t.message}}}async isOAuthUser(t){try{return!1}catch(r){return console.error("Error checking OAuth user:",r),!1}}async approveUser(t){try{const{data:r,error:s}=await xe.from("users").update({is_pending_approval:!1,is_approved:!0,is_active:!0,approval_date:new Date().toISOString()}).eq("id",t).select().single();if(s)throw s;let a=!1;try{const o=r}catch{console.log("Could not check OAuth status, defaulting to password reset")}return{success:!0,user:r,isOAuthUser:a}}catch(r){return console.error("Error approving user:",r),{success:!1,error:r.message}}}async rejectUser(t){try{const{data:r,error:s}=await xe.from("users").update({is_pending_approval:!1,is_approved:!1,is_active:!1}).eq("id",t).select().single();if(s)throw s;return{success:!0,user:r}}catch(r){return console.error("Error rejecting user:",r),{success:!1,error:r.message}}}async getAdminStats(){try{const[t,r,s,a]=await Promise.all([xe.from("users").select("*",{count:"exact",head:!0}),xe.from("ladders").select("*",{count:"exact",head:!0}),xe.from("matches").select("*",{count:"exact",head:!0}),xe.from("challenges").select("*",{count:"exact",head:!0})]),[o,i,l]=await Promise.all([xe.from("users").select("*",{count:"exact",head:!0}).eq("is_pending_approval",!0),xe.from("users").select("*",{count:"exact",head:!0}).eq("is_active",!0),xe.from("users").select("*",{count:"exact",head:!0}).eq("is_admin",!0)]);return{success:!0,stats:{totalUsers:t.count||0,pendingUsers:o.count||0,activeUsers:i.count||0,adminUsers:l.count||0,totalLadders:r.count||0,totalMatches:s.count||0,totalChallenges:a.count||0}}}catch(t){return console.error("Error getting admin stats:",t),{success:!1,error:t.message}}}async getLadderApplications(){try{const{data:t,error:r}=await xe.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            is_active,
            fargo_rate
          )
        `).eq("is_pending_approval",!0).order("created_at",{ascending:!1});if(r)throw r;return console.log(" Raw applications data from Supabase:",t),{success:!0,applications:(t||[]).map(a=>{var o,i;return{...a,firstName:a.first_name,lastName:a.last_name,phone:a.phone,experience:a.experience,fargoRate:((i=(o=a.ladder_profiles)==null?void 0:o[0])==null?void 0:i.fargo_rate)||a.fargoRate,currentLeague:a.currentLeague,currentRanking:a.currentRanking,payNow:a.payNow,paymentMethod:a.paymentMethod,status:a.status||(a.is_pending_approval?"pending":"approved")}})}}catch(t){return console.error("Error getting ladder applications:",t),{success:!1,error:t.message}}}async addUserToLadder(t,r,s=null){try{const{data:a}=await xe.from("ladder_profiles").select("*").eq("user_id",t).eq("ladder_name",r).single();if(!s){const{data:i}=await xe.from("ladder_profiles").select("position").eq("ladder_name",r).eq("is_active",!0).not("position","is",null).lt("position",900).order("position",{ascending:!1}).limit(1);s=(i&&i.length>0?i[0].position:0)+1}let o;if(a){const{data:i,error:l}=await xe.from("ladder_profiles").update({position:s,is_active:!0}).eq("user_id",t).eq("ladder_name",r).select().single();if(l)throw l;o=i}else{const{data:i,error:l}=await xe.from("ladder_profiles").insert({user_id:t,ladder_name:r,position:s,wins:0,losses:0,total_matches:0,is_active:!0}).select().single();if(l)throw l;o=i}return await xe.from("users").update({is_pending_approval:!1,is_approved:!0,is_active:!0}).eq("id",t),{success:!0,ladderProfile:o}}catch(a){return console.error("Error adding user to ladder:",a),{success:!1,error:a.message}}}async reportForfeit(t){try{const{data:r,error:s}=await xe.from("forfeit_requests").insert({match_id:t.matchId,reported_by:t.reportedBy,no_show_player:t.noShowPlayer,message:t.message,photo_proof:t.photoProof,status:"pending",created_at:new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,forfeitRequest:r}}catch(r){return console.error("Error reporting forfeit:",r),{success:!1,error:r.message}}}async getPendingForfeitRequests(){try{const{data:t,error:r}=await xe.from("forfeit_requests").select(`
          *,
          match:matches (
            id,
            winner_name,
            loser_name,
            match_date,
            location
          ),
          reporter:users!forfeit_requests_reported_by_fkey (
            id,
            first_name,
            last_name,
            email
          ),
          no_show_user:users!forfeit_requests_no_show_player_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("status","pending").order("created_at",{ascending:!1});if(r)throw r;return{success:!0,requests:t||[]}}catch(t){return console.error("Error getting pending forfeit requests:",t),{success:!1,error:t.message}}}async approveForfeitRequest(t,r,s){try{const{data:a,error:o}=await xe.from("forfeit_requests").select("*").eq("id",t).single();if(o)throw o;const{error:i}=await xe.from("forfeit_requests").update({status:"approved",admin_notes:r,reviewed_by:s,reviewed_at:new Date().toISOString()}).eq("id",t);if(i)throw i;if(a.penalty_applied){const{data:l,error:c}=await xe.from("ladder_profiles").select("*").eq("user_id",a.no_show_player).single();if(!c&&l){const d=Math.min(l.position+3,999);await xe.from("ladder_profiles").update({position:d,updated_at:new Date().toISOString()}).eq("id",l.id)}}return{success:!0}}catch(a){return console.error("Error approving forfeit request:",a),{success:!1,error:a.message}}}async denyForfeitRequest(t,r,s){try{const{error:a}=await xe.from("forfeit_requests").update({status:"denied",admin_notes:r,reviewed_by:s,reviewed_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0}}catch(a){return console.error("Error denying forfeit request:",a),{success:!1,error:a.message}}}async getPlayerForfeitHistory(t){try{const{data:r,error:s}=await xe.from("forfeit_requests").select(`
          *,
          match:matches (
            id,
            winner_name,
            loser_name,
            match_date,
            location
          ),
          reporter:users!forfeit_requests_reported_by_fkey (
            id,
            first_name,
            last_name
          )
        `).eq("no_show_player",t).order("created_at",{ascending:!1});if(s)throw s;return{success:!0,forfeits:r||[]}}catch(r){return console.error("Error getting player forfeit history:",r),{success:!1,error:r.message}}}async getPlayerPayments(t,r=null){try{let s=xe.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("user_id",t).order("payment_date",{ascending:!1});r&&(s=s.eq("session",r));const{data:a,error:o}=await s;if(o)throw o;return{success:!0,payments:a||[]}}catch(s){return console.error("Error getting player payments:",s),{success:!1,error:s.message}}}async getDivisionPayments(t,r=null){try{const{data:s,error:a}=await xe.from("users").select("id, first_name, last_name, email").contains("divisions",[t]);if(a)throw a;const o=s.map(u=>u.id);let i=xe.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).in("user_id",o).order("payment_date",{ascending:!1});r&&(i=i.eq("session",r));const{data:l,error:c}=await i;if(c)throw c;const d={totalPlayers:s.length,totalPayments:(l==null?void 0:l.length)||0,totalAmount:(l==null?void 0:l.reduce((u,h)=>u+(h.amount||0),0))||0,pendingPayments:(l==null?void 0:l.filter(u=>u.status==="pending").length)||0,paidPlayers:new Set(l==null?void 0:l.filter(u=>u.status==="completed").map(u=>u.user_id)).size||0};return{success:!0,payments:l||[],summary:d}}catch(s){return console.error("Error getting division payments:",s),{success:!1,error:s.message}}}async recordPayment(t){try{const{data:r,error:s}=await xe.from("payments").insert({user_id:t.playerId||t.userId,amount:parseFloat(t.amount),payment_type:t.paymentType||"weekly_dues",payment_method:t.paymentMethod||"cash",session:t.session,division:t.division,week_number:t.weekNumber,reference_number:t.referenceNumber,location:t.location,notes:t.notes,status:"completed",payment_date:t.dueDate||new Date().toISOString()}).select().single();if(s)throw s;return{success:!0,payment:r}}catch(r){return console.error("Error recording payment:",r),{success:!1,error:r.message}}}async getPendingPayments(){try{const{data:t,error:r}=await xe.from("payments").select(`
          *,
          player:users!payments_user_id_fkey (
            id,
            first_name,
            last_name,
            email
          )
        `).eq("status","pending").order("created_at",{ascending:!1});if(r)throw r;const s={total:(t==null?void 0:t.length)||0,matchFees:(t==null?void 0:t.filter(a=>a.payment_type==="match_fee").length)||0,memberships:(t==null?void 0:t.filter(a=>a.payment_type==="membership").length)||0,creditsPurchases:(t==null?void 0:t.filter(a=>a.payment_type==="credits_purchase").length)||0,weeklyDues:(t==null?void 0:t.filter(a=>a.payment_type==="weekly_dues").length)||0};return{success:!0,pendingPayments:t||[],stats:s}}catch(t){return console.error("Error getting pending payments:",t),{success:!1,error:t.message}}}async verifyPayment(t,r,s=""){try{const{data:a,error:o}=await xe.from("payments").update({status:r?"completed":"rejected",admin_notes:s,verified_at:new Date().toISOString(),verified_by:"admin"}).eq("id",t).select().single();if(o)throw o;return{success:!0,payment:a}}catch(a){return console.error("Error verifying payment:",a),{success:!1,error:a.message}}}async checkMatchEligibility(t,r=null){try{let s=xe.from("payments").select("*").eq("user_id",t).eq("status","completed");r&&(s=s.eq("session",r));const{data:a,error:o}=await s;if(o)throw o;const i=a==null?void 0:a.find(d=>d.payment_type==="registration_fee"),l=a==null?void 0:a.filter(d=>d.payment_type==="weekly_dues");return{success:!0,eligibility:{canPlayMatches:!!(i&&l&&l.length>0),hasRegistrationFee:!!i,weeklyDuesPaid:(l==null?void 0:l.length)||0,totalPaid:(a==null?void 0:a.reduce((d,u)=>d+(u.amount||0),0))||0}}}catch(s){return console.error("Error checking match eligibility:",s),{success:!1,error:s.message}}}async recordWeeklyDues(t,r,s){try{const{data:a,error:o}=await xe.from("users").select("id").contains("divisions",[t]);if(o)throw o;const i=a.map(d=>({user_id:d.id,amount:10,payment_type:"weekly_dues",payment_method:"pending",session:r,division:t,week_number:s,status:"pending",payment_date:new Date().toISOString()})),{data:l,error:c}=await xe.from("payments").insert(i);if(c)throw c;return{success:!0,recordsCreated:i.length}}catch(a){return console.error("Error recording weekly dues:",a),{success:!1,error:a.message}}}async applyLateFees(t,r){try{const{data:s,error:a}=await xe.from("payments").select("*").eq("division",t).eq("session",r).eq("status","pending").lt("payment_date",new Date(Date.now()-6048e5).toISOString());if(a)throw a;const o=s.map(i=>({user_id:i.user_id,amount:5,payment_type:"late_fee",payment_method:"system",session:r,division:t,notes:`Late fee for overdue payment - Week ${i.week_number}`,status:"pending",payment_date:new Date().toISOString()}));if(o.length>0){const{error:i}=await xe.from("payments").insert(o);if(i)throw i}return{success:!0,lateFeesApplied:o.length}}catch(s){return console.error("Error applying late fees:",s),{success:!1,error:s.message}}}async getRecentCompletedMatches(t=10,r=null){try{let s=xe.from("matches").select(`
          *,
          winner:users!matches_winner_id_fkey(first_name, last_name),
          loser:users!matches_loser_id_fkey(first_name, last_name)
        `).not("score","is",null).order("match_date",{ascending:!1}).limit(t);r&&r.length>0&&(s=s.or(`ladder_id.in.(${r.join(",")}),ladder_id.is.null`));const{data:a,error:o}=await s;if(o)throw o;return{success:!0,matches:a.map(l=>{var c,d,u,h,p,g,f,m,v,b,w,x;return{_id:l.id,winner:{_id:l.winner_id,firstName:((c=l.winner)==null?void 0:c.first_name)||((d=l.winner_name)==null?void 0:d.split(" ")[0])||"Unknown",lastName:((u=l.winner)==null?void 0:u.last_name)||((h=l.winner_name)==null?void 0:h.split(" ").slice(1).join(" "))||""},player1:{_id:l.winner_id,firstName:((p=l.winner)==null?void 0:p.first_name)||((g=l.winner_name)==null?void 0:g.split(" ")[0])||"Unknown",lastName:((f=l.winner)==null?void 0:f.last_name)||((m=l.winner_name)==null?void 0:m.split(" ").slice(1).join(" "))||""},player2:{_id:l.loser_id,firstName:((v=l.loser)==null?void 0:v.first_name)||((b=l.loser_name)==null?void 0:b.split(" ")[0])||"Unknown",lastName:((w=l.loser)==null?void 0:w.last_name)||((x=l.loser_name)==null?void 0:x.split(" ").slice(1).join(" "))||""},completedDate:l.match_date,gameType:l.game_type||"9-Ball",raceLength:l.race_length||"7",score:l.score||"N/A",ladderName:l.ladder_id,ladderDisplayName:l.ladder_id==="499-under"?"499 & Under":l.ladder_id==="500-549"?"500-549":l.ladder_id==="550-plus"?"550+":l.ladder_id}})}}catch(s){return console.error("Error getting recent completed matches:",s),{success:!1,error:s.message,matches:[]}}}async getPrizePoolData(t){try{console.log(" Supabase: Getting prize pool data for ladder:",t);const{data:r,error:s}=await xe.from("matches").select("ladder_id").not("ladder_id","is",null);if(!s){const v=[...new Set(r.map(b=>b.ladder_id))];console.log(" Supabase: Available ladder_ids in matches:",v),console.log(" Supabase: Searching for ladder_id:",t),console.log(" Supabase: Does it match?",v.includes(t))}const a=new Date;a.setMonth(a.getMonth()-2),console.log(" Supabase: Looking for matches since:",a.toISOString());const{data:o,error:i}=await xe.from("matches").select("status, ladder_id, match_date").eq("ladder_id",t);if(!i){const v=[...new Set(o.map(w=>w.status))];console.log(" Supabase: Available statuses for",t,":",v),console.log(" Supabase: Total matches for this ladder:",o.length);const b=o.filter(w=>w.status==="completed");console.log(" Supabase: Completed matches (all time):",b.length),b.length>0&&console.log(" Supabase: Completed match dates:",b.map(w=>w.match_date))}const{data:l,error:c}=await xe.from("matches").select("id, score, match_date, ladder_id, status").eq("ladder_id",t).eq("status","completed").gte("match_date",a.toISOString());if(c)throw c;console.log(" Supabase: Found COMPLETED matches in last 2 months:",(l==null?void 0:l.length)||0,l);const d=(l==null?void 0:l.length)||0,u=d*3,h=new Date,p=h.getMonth(),g=Math.floor(p/2)*2,f=new Date(h.getFullYear(),g+2,1),m={success:!0,data:{currentPrizePool:u,totalMatches:d,nextDistribution:f.toISOString(),isEstimated:!1}};return console.log(" Supabase: Returning prize pool data:",m),m}catch(r){return console.error("Error getting prize pool data:",r),{success:!1,error:r.message}}}async getPrizePoolHistory(t){try{return{success:!0,data:[]}}catch(r){return console.error("Error getting prize pool history:",r),{success:!1,error:r.message}}}async getPrizePoolWinners(t){try{return{success:!0,data:[]}}catch(r){return console.error("Error getting prize pool winners:",r),{success:!1,error:r.message}}}async checkExistingPlayer(t,r,s=null){try{let a=xe.from("users").select(`
          *,
          ladder_profiles (
            id,
            ladder_name,
            position,
            wins,
            losses
          ),
          league_profiles (
            id,
            division
          )
        `).ilike("first_name",t).ilike("last_name",r);const{data:o,error:i}=await a;if(i)throw i;let l=null;if(s){const{data:c}=await xe.from("users").select("*").eq("email",s).maybeSingle();l=c}return{success:!0,hasExistingPlayers:o.length>0||!!l,foundPlayers:o,emailMatch:l,hasUnifiedAccount:!!l,showPlayerSelection:o.length>1,hasPartialMatch:o.length===1&&!l}}catch(a){return console.error("Error checking existing player:",a),{success:!1,error:a.message}}}async createNewPlayerSignup(t){var r,s,a,o,i;try{const{data:l,error:c}=await xe.from("users").select("id, email, is_approved, is_active").eq("email",t.email.toLowerCase()).maybeSingle();if(c&&c.code!=="PGRST116")throw c;if(l)return{success:!1,error:"An account with this email already exists. Please use the login page or contact admin if you need help accessing your account."};const d=Math.random().toString(36).slice(-8)+"Aa1!",{data:u,error:h}=await xe.auth.signUp({email:t.email.toLowerCase(),password:d,options:{emailRedirectTo:`${window.location.origin}/#/confirm-email`,data:{first_name:t.firstName,last_name:t.lastName}}});let p=!1;if(h){const v=((r=h.message)==null?void 0:r.toLowerCase())||"",b=h.code||"";if(v.includes("user already registered")||v.includes("email already exists")||v.includes("already registered")||b==="signup_disabled"||b==="user_already_exists")return{success:!1,error:"An account with this email already exists. Please use the login page or contact admin if you need help accessing your account."};if(v.includes("rate limit")||v.includes("too many")||v.includes("email"))console.warn(" Supabase email rate limit reached:",h.message),p=!0;else{let w=h.message;return v.includes("password")?w="Password requirements not met. Please contact admin for assistance.":v.includes("invalid")&&(w="Invalid email address. Please check your email and try again."),{success:!1,error:w}}}if(!u.user)throw p?new Error("Account creation may have been affected by email rate limits. Please try again in an hour or contact admin."):new Error("Failed to create user account");console.log(" Signup response (full):",JSON.stringify({user:{email:(s=u.user)==null?void 0:s.email,id:(a=u.user)==null?void 0:a.id,email_confirmed_at:(o=u.user)==null?void 0:o.email_confirmed_at,created_at:(i=u.user)==null?void 0:i.created_at},session:u.session?"Session created (email confirmation disabled)":"No session (email confirmation required)",needsConfirmation:!u.session,rateLimitReached:p,error:(h==null?void 0:h.message)||null},null,2)),u.session?console.warn(" Email confirmation appears to be DISABLED in Supabase settings. User can log in immediately."):u.user&&!u.user.email_confirmed_at?(console.log(" Email confirmation is ENABLED. User will receive confirmation email."),console.log(" Check email inbox for confirmation link.")):console.log(" User email already confirmed or confirmation disabled.");const{data:g,error:f}=await xe.from("users").insert({id:u.user.id,email:t.email,first_name:t.firstName,last_name:t.lastName,phone:t.phone,is_pending_approval:!0,is_approved:!1,is_active:!1,created_at:new Date().toISOString()}).select().single();if(f)throw f;t.joinLadder&&await xe.from("ladder_profiles").insert({user_id:u.user.id,ladder_name:t.ladderName||"499-under",position:999,fargo_rate:t.fargoRate||400,wins:0,losses:0,total_matches:0,is_active:!1});let m="Signup successful! ";return p?(m+=" Due to email rate limits, your confirmation email may be delayed. ",m+="Your account has been created and is pending admin approval. ",m+="You'll receive a password setup email once approved (may take up to an hour due to rate limits)."):u.session?(m+="Your account has been created. It is pending admin approval. ",m+="You'll receive a password setup email once approved."):(m+="Please check your email and click the confirmation link. ",m+="After confirming your email, your account will be pending admin approval. ",m+="You'll receive a password setup email once approved."),{success:!0,user:g,message:m,rateLimitReached:p}}catch(l){return console.error("Error creating new player signup:",l),{success:!1,error:l.message}}}async searchLadderPlayer(t,r){var s;try{const{data:a,error:o}=await xe.from("ladder_profiles").select(`
          *,
          users!inner (
            id,
            first_name,
            last_name,
            email,
            is_approved,
            is_active
          )
        `).ilike("users.first_name",`%${t}%`).ilike("users.last_name",`%${r}%`);if(o)throw o;if(!a||a.length===0)return{success:!1,error:'No ladder player found with that name. Please check your spelling or choose "New User" instead.'};const i=`${t} ${r}`.toLowerCase(),c=a.find(g=>{var m,v;return`${((m=g.users)==null?void 0:m.first_name)||""} ${((v=g.users)==null?void 0:v.last_name)||""}`.toLowerCase()===i})||a[0],d=c.users,u=(d==null?void 0:d.email)&&(d.email.includes("@ladder.local")||d.email.includes("@example.com")||d.email.includes("placeholder")),h=(d==null?void 0:d.email)&&!u,p=h&&d.email.toLowerCase()===((s=claimData==null?void 0:claimData.email)==null?void 0:s.toLowerCase());return{success:!0,player:{_id:c.id,id:c.id,firstName:d.first_name,lastName:d.last_name,email:d.email,position:c.position,ladderName:c.ladder_name,fargoRate:c.fargo_rate,isClaimed:h,isClaimedBySamePerson:p,userId:d.id}}}catch(a){return console.error("Error searching ladder player:",a),{success:!1,error:a.message}}}async claimLadderPosition(t){var r;try{const s=await this.searchLadderPlayer(t.firstName,t.lastName);if(!s.success)return s;const a=s.player;if(a.isClaimed&&!a.isClaimedBySamePerson)return{success:!1,error:"This position has already been claimed by another player. Please contact admin if you believe this is an error."};if(a.isClaimedBySamePerson)return{success:!1,error:"You have already claimed this position. Please use the login page or contact admin if you need help accessing your account."};const{data:o,error:i}=await xe.from("ladder_profiles").select("*, users(*)").eq("id",a.id).single();if(i)throw i;if(!o)throw new Error("Ladder position not found.");const l=o.users,c=(l==null?void 0:l.email)&&(l.email.includes("@ladder.local")||l.email.includes("@example.com")||l.email.includes("placeholder")),{data:d,error:u}=await xe.from("users").select("id, email, is_approved, is_active").eq("email",t.email.toLowerCase()).maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(d&&!c)return d.id===l.id?{success:!1,error:"You have already claimed this position. Please use the login page or contact admin if you need help accessing your account."}:{success:!1,error:'This email is already registered. Please log in or use "Forgot Password".'};const h=o.user_id,p=Math.random().toString(36).slice(-8)+"Aa1!",{data:g,error:f}=await xe.auth.signUp({email:t.email.toLowerCase(),password:p,options:{emailRedirectTo:`${window.location.origin}/#/confirm-email`,data:{first_name:t.firstName,last_name:t.lastName}}});if(f){const j=((r=f.message)==null?void 0:r.toLowerCase())||"",S=f.code||"";return j.includes("user already registered")||j.includes("email already exists")||j.includes("already registered")||S==="user_already_exists"?{success:!1,error:'This email is already registered. Please log in or use "Forgot Password".'}:{success:!1,error:f.message||"Failed to create account. Please try again."}}if(!(g!=null&&g.user))return{success:!1,error:"Failed to create user account. Please try again."};const m=g.user.id;c&&h&&h!==m&&await xe.from("users").delete().eq("id",h);const{data:v,error:b}=await xe.from("users").upsert({id:m,email:t.email.toLowerCase(),first_name:t.firstName,last_name:t.lastName,phone:t.phone||null,is_pending_approval:!0,is_approved:!1,is_active:!1,claim_message:t.message||null,created_at:new Date().toISOString()},{onConflict:"id"}).select().single();if(b)throw b;const{error:w}=await xe.from("ladder_profiles").update({user_id:m}).eq("id",o.id);if(w)throw w;let x=" Claim submitted! ";return g.session?(x+="Your account has been created. It is pending admin approval. ",x+="You'll receive a password setup email once approved."):(x+="Please check your email and click the confirmation link. ",x+="After confirming your email, your claim will be pending admin approval. ",x+="You'll receive a password setup email once approved."),{success:!0,user:v,message:x}}catch(s){return console.error("Error claiming ladder position:",s),{success:!1,error:s.message}}}async claimLadderPositionWithOAuth(t){var r,s;try{const{data:a,error:o}=await xe.from("ladder_profiles").select(`
          *,
          users!inner (id, first_name, last_name, email)
        `).ilike("users.first_name",`%${t.firstName}%`).ilike("users.last_name",`%${t.lastName}%`);if(o)throw o;const i=`${(t.firstName||"").trim()} ${(t.lastName||"").trim()}`.toLowerCase(),l=(a==null?void 0:a.find(f=>{var v,b;return`${((v=f.users)==null?void 0:v.first_name)||""} ${((b=f.users)==null?void 0:b.last_name)||""}`.trim().toLowerCase()===i}))||(a==null?void 0:a[0]);if(!l)throw new Error("Ladder position not found. Please check the spelling of your name.");const c=((r=l.users)==null?void 0:r.email)&&(l.users.email.includes("@ladder.local")||l.users.email.includes("@example.com"));if(((s=l.users)==null?void 0:s.email)&&!c&&l.users.email!==t.email)throw new Error("This position is already claimed by another email. If this is you, please contact admin.");c&&l.user_id!==t.userId&&await xe.from("users").delete().eq("id",l.user_id);const{data:u}=await xe.from("users").select("is_approved, is_active, is_admin").eq("id",t.userId).single(),h=u&&(u.is_admin===!0||u.is_admin==="true"||u.is_admin===1||u.is_approved===!0&&u.is_active===!0),p={phone:t.phone||null,claim_message:t.message||null};h||(p.is_pending_approval=!0,p.is_approved=!1,p.is_active=!1);const{error:g}=await xe.from("users").update(p).eq("id",t.userId);if(g)throw g;return await xe.from("ladder_profiles").update({user_id:t.userId}).eq("id",l.id),{success:!0,message:" Position claimed successfully! Your account is pending admin approval."}}catch(a){return console.error("Error claiming ladder position with OAuth:",a),{success:!1,error:a.message}}}async getPaymentStatus(t){var s,a,o,i,l,c;const r={hasMembership:!1,status:"inactive",isPromotionalPeriod:!1};try{const{data:d,error:u}=await xe.from("payment_status").select("*").eq("email",t).single();if(u){if(u.code==="PGRST116")return d||r;if(u.code==="PGRST205"||u.code==="PGRST301"||(s=u.message)!=null&&s.includes("404")||(a=u.message)!=null&&a.includes("not find")||(o=u.message)!=null&&o.includes("payment_status"))return r;throw u}return d||r}catch(d){return(d==null?void 0:d.code)==="PGRST205"||(d==null?void 0:d.code)==="PGRST301"||((i=d==null?void 0:d.message)==null?void 0:i.includes("404"))||((l=d==null?void 0:d.message)==null?void 0:l.includes("payment_status"))||((c=d==null?void 0:d.message)==null?void 0:c.includes("not find"))||console.error("Error fetching payment status:",d),r}}async updateMatchStatus(t,r,s=null,a=null,o=null,i=null){try{const{data:l,error:c}=await xe.from("matches").select("id, status, winner_id, winner_name, loser_id, loser_name, score, notes, match_date, match_type, game_type, race_length, location, created_at, challenge_id, league_id, ladder_id, winner_position, loser_position, verified_by, verified_at").eq("id",t).single();if(c)throw c;console.log(" Current match from database:",l);const d={status:r};if(r==="completed"&&s){const m=s.winnerId,v=l.winner_id,b=l.loser_id;if(console.log(" Match update logic:",{selectedWinnerId:m,currentPlayer1Id:v,currentPlayer2Id:b,currentPlayer1Name:l.winner_name,currentPlayer2Name:l.loser_name,needsSwap:m===b}),m===b)l.loser_id&&(d.winner_id=l.loser_id),l.loser_name&&(d.winner_name=String(l.loser_name)),l.winner_id&&(d.loser_id=l.winner_id),l.winner_name&&(d.loser_name=String(l.winner_name)),console.log(" Swapping: Selected winner was in loser field, moving to winner field");else if(m===v)l.winner_id&&(d.winner_id=l.winner_id),l.winner_name&&(d.winner_name=String(l.winner_name)),l.loser_id&&(d.loser_id=l.loser_id),l.loser_name&&(d.loser_name=String(l.loser_name)),console.log(" Selected winner already in winner field - no swap needed");else throw console.error(" Selected winner ID does not match either player!",{selectedWinnerId:m,currentPlayer1Id:v,currentPlayer2Id:b}),new Error("Selected winner does not match either player in the match");if(i)try{const w=new Date(i);isNaN(w.getTime())||(d.match_date=w.toISOString())}catch(w){console.error(" Invalid date format:",i,w)}a!=null&&a!==""&&(d.score=String(a)),o!=null&&o!==""&&(d.notes=String(o))}const u={};for(const[m,v]of Object.entries(d))v!=null&&m!=="updated_at"&&(u[m]=v);console.log(" Sending update to Supabase:",u),console.log(" Update data JSON stringified:",JSON.stringify(u));const{error:h}=await xe.from("matches").update(u).eq("id",t);if(h)throw console.error(" Supabase update error details:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;console.log(" Update successful, fetching updated match...");let p=null;const{data:g,error:f}=await xe.from("matches").select("id, status, winner_id, winner_name, loser_id, loser_name, score, notes, match_date, match_type, game_type, race_length, location, created_at, challenge_id, league_id, ladder_id, winner_position, loser_position, verified_by, verified_at").eq("id",t).maybeSingle();if(f){console.warn(" Could not fetch updated match, but update was successful:",{message:f.message,details:f.details,hint:f.hint,code:f.code});const{updated_at:m,...v}=l||{};p={...v,...u,id:t},console.log(" Using constructed match data:",p)}else p=g,console.log(" Successfully fetched updated match:",p);if(r==="completed"&&p){console.log(" Match completed - starting ladder updates..."),console.log(" Match data:",{winner_id:p.winner_id,loser_id:p.loser_id,match_type:p.match_type});const m=String(p.winner_id),v=String(p.loser_id);console.log(" Looking up ladder profiles with IDs:",{winnerId:m,loserId:v});const{data:b,error:w}=await xe.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",m).maybeSingle(),{data:x,error:j}=await xe.from("ladder_profiles").select("position, ladder_name, user_id").eq("user_id",v).maybeSingle();if(console.log(" Ladder profile lookup:",{winnerProfile:b,winnerProfileError:w,loserProfile:x,loserProfileError:j}),!b||!x){console.error(" Could not find ladder profiles for position updates",{winnerFound:!!b,loserFound:!!x,winnerId:p.winner_id,loserId:p.loser_id});try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success&&console.log(" Winner stats updated (no profile found for positions)")}catch(_){console.error(" Error updating winner stats (no profile):",_)}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success&&console.log(" Loser stats updated (no profile found for positions)")}catch(_){console.error(" Error updating loser stats (no profile):",_)}return{success:!0,data:p}}if(b.ladder_name!==x.ladder_name){console.log(" Players on different ladders - no position updates",{winnerLadder:b.ladder_name,loserLadder:x.ladder_name});try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success&&console.log(" Winner stats updated (different ladders)")}catch(_){console.error(" Error updating winner stats (different ladders):",_)}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success&&console.log(" Loser stats updated (different ladders)")}catch(_){console.error(" Error updating loser stats (different ladders):",_)}return{success:!0,data:p}}try{const _=await this.updatePlayerMatchStats(p.winner_id,!0);_&&_.success?console.log(" Winner stats updated successfully"):console.error(" Winner stats update returned failure:",_)}catch(_){console.error(" Error updating winner stats:",_),console.error(" Match was completed but winner stats may not have been updated")}try{const _=await this.updatePlayerMatchStats(p.loser_id,!1);_&&_.success?console.log(" Loser stats updated successfully"):console.error(" Loser stats update returned failure:",_)}catch(_){console.error(" Error updating loser stats:",_),console.error(" Match was completed but loser stats may not have been updated")}const S=p.match_type||"challenge";console.log(` Updating ladder positions for match type: ${S}`),console.log(`   Winner: ${b.user_id} at position #${b.position}`),console.log(`   Loser: ${x.user_id} at position #${x.position}`);try{const _=await this.updateLadderPositions(S,p.winner_id,p.loser_id,b,x);console.log(" Position update result:",_)}catch(_){console.error(" Error updating ladder positions:",_)}try{const{error:_}=await xe.from("ladder_profiles").update({immunity_until:new Date(Date.now()+6048e5).toISOString()}).eq("user_id",p.winner_id);_?console.error(" Error setting immunity:",_):console.log(" Immunity set for winner")}catch(_){console.error(" Error setting immunity:",_)}}return{success:!0,data:p}}catch(l){return console.error("Error updating match status:",l),{success:!1,error:l.message}}}async updateLadderPositions(t,r,s,a,o){try{const i=a.position,l=o.position,c=a.ladder_name;if(console.log(` Processing position updates for ${t} match`),console.log(`   Winner: #${i}, Loser: #${l}`),t==="fast-track"||t==="reverse-fast-track")if(i>l){console.log(` Fast Track: Challenger won! Winner inserting at position #${l}`),console.log(`   Winner at #${i}, Defender at #${l}`),console.log(" Calling reindexLadder with:",[{userId:r,newPosition:l},{userId:s,newPosition:l+1}]);try{await this.reindexLadder(c,[{userId:r,newPosition:l},{userId:s,newPosition:l+1}]),console.log(" reindexLadder completed successfully")}catch(d){throw console.error(" reindexLadder failed:",d),d}console.log(` Fast Track complete: Winner inserted at #${l}, Defender moved to #${l+1}`)}else console.log(" Fast Track: Defender won - no position changes needed");else if(t==="smackdown")if(i<l){console.log(" SmackDown: Challenger won - applying full ladder re-index"),console.log(`   Challenger at #${i}, Defender at #${l}`);const d=Math.max(i-2,2),u=l+3;console.log(`   Target: Challenger #${i}#${d}, Defender #${l}#${u}`),await this.reindexLadder(c,[{userId:r,newPosition:d},{userId:s,newPosition:u}]),console.log(" SmackDown complete with full re-index")}else{console.log(" SmackDown: Challenger lost - swapping positions"),await this.swapPositions(r,s,i,l);const d=new Date(Date.now()+7*24*60*60*1e3);await xe.from("ladder_profiles").update({smackback_eligible_until:d.toISOString()}).eq("user_id",r),console.log(` SmackBack eligibility granted to defender until ${d.toLocaleDateString()}`)}else t==="smackback"?i>1?(console.log(" SmackBack: Moving winner to 1st place with full re-index"),console.log(`   Winner currently at #${i}`),await this.reindexLadder(c,[{userId:r,newPosition:1}]),await xe.from("ladder_profiles").update({smackback_eligible_until:null}).eq("user_id",r),console.log(" SmackBack complete: Winner now at #1, eligibility cleared")):(console.log(" SmackBack: Defender wins, no position change"),await xe.from("ladder_profiles").update({smackback_eligible_until:null}).eq("user_id",s)):i>l?(console.log(" Challenge: Challenger won - swapping positions"),await this.swapPositions(r,s,i,l)):console.log(" Challenge: Defender wins, no position change");return{success:!0}}catch(i){return console.error("Error updating ladder positions:",i),{success:!1,error:i.message}}}async swapPositions(t,r,s,a){console.log(` Swapping positions: Player1 (#${s})  Player2 (#${a})`);const{error:o}=await xe.from("ladder_profiles").update({position:a}).eq("user_id",t);if(o)throw console.error(" Error updating player1 position:",o),o;const{error:i}=await xe.from("ladder_profiles").update({position:s}).eq("user_id",r);if(i)throw console.error(" Error updating player2 position:",i),i;console.log(` Positions swapped: #${s}  #${a}`)}async reindexLadder(t,r){try{console.log(" Starting full ladder re-index");const{data:s}=await xe.from("ladder_profiles").select("user_id, position").eq("ladder_name",t).order("position");if(!s||s.length===0){console.log("No players found for re-indexing");return}const a=[];for(const c of s){const d=r.find(u=>u.userId===c.user_id);if(d){const u=d.newPosition>s.length?999:d.newPosition;a.push({userId:c.user_id,oldPosition:c.position,targetPosition:d.newPosition,sortValue:u}),console.log(`   Player moving: #${c.position}  #${d.newPosition} (sortValue: ${u})`)}else a.push({userId:c.user_id,oldPosition:c.position,targetPosition:null,sortValue:c.position+.5})}a.sort((c,d)=>c.sortValue-d.sortValue);for(let c=0;c<a.length;c++)a[c].targetPosition&&console.log(`   #${c+1}: Player (was #${a[c].oldPosition}, targeted #${a[c].targetPosition})`);const o=a.map((c,d)=>xe.from("ladder_profiles").update({position:d+1}).eq("user_id",c.userId));console.log(` Executing ${o.length} position updates...`);const i=await Promise.all(o),l=i.filter(c=>c.error);if(l.length>0)throw console.error(" Errors in position updates:",l),new Error(`Failed to update ${l.length} positions`);console.log(` All ${i.length} position updates completed successfully`),console.log(" Ladder re-index complete")}catch(s){throw console.error("Error re-indexing ladder:",s),s}}async updatePlayerMatchStats(t,r){try{const s=String(t);console.log(` Updating player match stats for user: ${s}, isWin: ${r}`);const{data:a,error:o}=await xe.from("ladder_profiles").select("wins, losses, total_matches, user_id").eq("user_id",s).maybeSingle();if(o)throw console.error(" Error fetching player profile for stats update:",o),new Error(`Failed to fetch profile: ${o.message}`);if(!a)throw console.error(` No ladder profile found for user_id: ${s}`),new Error(`No ladder profile found for user: ${s}`);console.log(` Current stats for user ${s}:`,{wins:a.wins,losses:a.losses,total_matches:a.total_matches});const i=a.wins||0,l=a.losses||0,c=a.total_matches||0,d={wins:r?i+1:i,losses:r?l:l+1,total_matches:c+1};console.log(` New stats for user ${s}:`,d);const{error:u,data:h}=await xe.from("ladder_profiles").update(d).eq("user_id",s).select();if(u)throw console.error(" Error updating stats in database:",u),new Error(`Failed to update stats: ${u.message}`);return console.log(` Successfully updated stats for user ${s}`),{success:!0}}catch(s){throw console.error(" Error updating player match stats:",s),s}}async deleteMatch(t){try{const{error:r}=await xe.from("matches").delete().eq("id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error deleting match:",r),{success:!1,error:r.message}}}async updateMatch(t,r){try{const{data:s,error:a}=await xe.from("matches").update(r).eq("id",t).select().single();if(a)throw a;return{success:!0,data:s}}catch(s){return console.error("Error updating match:",s),{success:!1,error:s.message}}}async checkSmackBackEligibility(t){try{const{data:r,error:s}=await xe.from("ladder_profiles").select("smackback_eligible_until").eq("user_id",t).single();if(s)throw s;if(!r||!r.smackback_eligible_until)return{eligible:!1,reason:"No SmackBack eligibility"};const a=new Date(r.smackback_eligible_until),o=new Date;if(o>a)return{eligible:!1,reason:"SmackBack eligibility expired"};const i=Math.ceil((a-o)/(1e3*60*60*24));return{eligible:!0,eligibleUntil:a,daysRemaining:i}}catch(r){return console.error("Error checking SmackBack eligibility:",r),{eligible:!1,reason:"Error checking eligibility"}}}async createMatch(t){try{if(t.matchType==="smackback"){const h=await this.checkSmackBackEligibility(t.player1Id);if(!h.eligible)return console.log(` SmackBack validation failed: ${h.reason}`),{success:!1,error:`SmackBack not allowed: ${h.reason}. Defender must have won a SmackDown within the last 7 days.`};console.log(` SmackBack eligibility verified (${h.daysRemaining} days remaining)`)}const r=await this.getUserById(t.player1Id),s=await this.getUserById(t.player2Id);if(!r.success||!s.success)throw new Error("Could not find player information");const a=`${r.data.first_name} ${r.data.last_name}`,o=`${s.data.first_name} ${s.data.last_name}`,{data:{user:i},error:l}=await xe.auth.getUser();if(l||!i)throw console.error(" Authentication error:",l),new Error("User not authenticated. Please log in again.");console.log(" User authenticated:",i.id);const c={ladder_id:t.ladderName,winner_id:t.player1Id,winner_name:a,loser_id:t.player2Id,loser_name:o,match_date:t.matchDate,location:t.location||null,notes:t.notes||null,race_length:t.raceLength||5,game_type:t.gameType||"9-ball",match_type:t.matchType||"challenge",status:"scheduled"};console.log(" Attempting to insert match:",c);const{data:d,error:u}=await xe.from("matches").insert(c).select().single();if(u)throw console.error(" Supabase insert error:",u),console.error(" Error code:",u.code),console.error(" Error message:",u.message),console.error(" Error details:",u.details),console.error(" Error hint:",u.hint),u;return console.log(" Match created successfully:",d),{success:!0,data:d}}catch(r){console.error(" Error creating match:",r);const s=r.message||r.toString();return console.error(" Full error:",r),{success:!1,error:s}}}async getScheduledMatches(t=null){try{let r=xe.from("matches").select("*").in("status",["scheduled","completed"]).order("match_date",{ascending:!0});t&&(r=r.eq("ladder_id",t));const{data:s,error:a}=await r;if(a)throw a;return{success:!0,matches:s||[]}}catch(r){return console.error("Error fetching scheduled matches:",r),{success:!1,matches:[],error:r.message}}}async registerPlayer(t){try{const{firstName:r,lastName:s,email:a,phone:o,fargoRate:i,location:l,isActive:c,ladderName:d}=t;let{data:u,error:h}=await xe.from("users").select("id").eq("email",a).single(),p;if(h&&h.code!=="PGRST116")throw h;if(u){const{data:m}=await xe.from("ladder_profiles").select("*").eq("user_id",u.id).eq("ladder_name",d).single();if(m)return{success:!1,error:"Player is already registered on this ladder"};p=u.id}else{const{data:m,error:v}=await xe.from("users").insert({first_name:r,last_name:s,email:a,phone:o||null,is_active:!1,is_pending_approval:!0}).select().single();if(v)throw v;p=m.id}const{data:g,error:f}=await xe.from("ladder_profiles").insert({user_id:p,ladder_name:d,position:null,wins:0,losses:0,total_matches:0,is_active:!1,fargo_rate:i?parseInt(i):null}).select().single();if(f)throw f;return{success:!0,message:"Application submitted successfully! Awaiting admin approval.",data:g}}catch(r){return console.error("Error registering player:",r),{success:!1,error:r.message}}}async quickAddPlayerToLadder(t){try{const{firstName:r,lastName:s,email:a,phone:o,fargoRate:i,location:l,ladderName:c,position:d,notes:u}=t;let{data:h,error:p}=await xe.from("users").select("id").eq("email",a).single(),g;if(p&&p.code!=="PGRST116")throw p;if(h)g=h.id;else{const{data:w,error:x}=await xe.from("users").insert({first_name:r,last_name:s,email:a,phone:o||null}).select().single();if(x)throw x;g=w.id}const{data:f}=await xe.from("ladder_profiles").select("*").eq("user_id",g).eq("ladder_name",c).single();if(f)return{success:!1,error:"Player is already on this ladder"};let m=d?parseInt(d):null;if(m)await xe.from("ladder_profiles").update({position:xe.rpc("increment",{x:1})}).eq("ladder_name",c).gte("position",m);else{const{data:w}=await xe.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1);m=(w&&w.length>0?w[0].position:0)+1}const{data:v,error:b}=await xe.from("ladder_profiles").insert({user_id:g,ladder_name:c,position:m,wins:0,losses:0,total_matches:0,is_active:!0,fargo_rate:i?parseInt(i):null}).select().single();if(b)throw b;return{success:!0,message:`Player added to ${c} ladder at position #${m}`,data:v}}catch(r){return console.error("Error quick adding player:",r),{success:!1,error:r.message}}}async updatePlayer(t,r){try{const{email:s,firstName:a,lastName:o,fargoRate:i,position:l,ladderName:c,isActive:d,sanctioned:u,sanctionYear:h,lmsName:p,currentLadderName:g}=r,f={};if(a&&(f.first_name=a),o&&(f.last_name=o),s&&(f.email=s),Object.keys(f).length>0){const{error:v}=await xe.from("users").update(f).eq("id",t);if(v)throw v}if(console.log(` Debug updatePlayer: ladderName=${c}, currentLadderName=${g}`),c&&g&&c!==g){console.log(` Transferring player from ${g} to ${c}`);const{data:v}=await xe.from("ladder_profiles").select("*").eq("user_id",t).eq("ladder_name",g).single();if(v){console.log(" Current profile found:",v);const{error:b}=await xe.from("ladder_profiles").delete().eq("user_id",t).eq("ladder_name",g);if(b)throw b;console.log(` Deleted from old ladder: ${g}`),v.position&&await xe.from("ladder_profiles").update({position:xe.rpc("decrement",{x:1})}).eq("ladder_name",g).gt("position",v.position);const{data:w}=await xe.from("ladder_profiles").select("position").eq("ladder_name",c).not("position","is",null).order("position",{ascending:!1}).limit(1),j=(w&&w.length>0?w[0].position:0)+1,S={user_id:t,ladder_name:c,position:j,wins:v.wins||0,losses:v.losses||0,total_matches:v.total_matches||0,is_active:d!==void 0?d:v.is_active,fargo_rate:i!==void 0?i?parseInt(i):null:v.fargo_rate,sanctioned:u!==void 0?u:v.sanctioned,sanction_year:h!==void 0?h:v.sanction_year,lms_name:p!==void 0?p:v.lms_name};console.log(" Creating new profile with data:",S);const{data:_,error:C}=await xe.from("ladder_profiles").insert(S).select().single();if(C)throw console.error(" Error creating new profile:",C),C;return console.log(" Successfully created new profile:",_),{success:!0,message:`Player transferred from ${g} to ${c} successfully`}}else throw console.error(` Current profile not found for user ${t} on ladder ${g}`),new Error(`Player profile not found on ${g} ladder`)}const m={};if(d!==void 0&&(m.is_active=d),i!==void 0&&(m.fargo_rate=i?parseInt(i):null),l!==void 0&&(m.position=l?parseInt(l):null),u!==void 0&&(m.sanctioned=u),h!==void 0&&(m.sanction_year=h),p!==void 0&&(m.lms_name=p),Object.keys(m).length>0&&c){const{error:v}=await xe.from("ladder_profiles").update(m).eq("user_id",t).eq("ladder_name",c);if(v)throw v}return{success:!0,message:"Player updated successfully"}}catch(s){return console.error("Error updating player:",s),{success:!1,error:s.message,message:s.message}}}async removePlayerFromLadder(t,r){try{const{data:s,error:a}=await xe.from("users").select("id").eq("email",t).single();if(a)throw a;if(!s)return{success:!1,error:"User not found",message:"User not found"};const{data:o}=await xe.from("ladder_profiles").select("position").eq("user_id",s.id).eq("ladder_name",r).single(),{error:i}=await xe.from("ladder_profiles").delete().eq("user_id",s.id).eq("ladder_name",r);if(i)throw i;if(o!=null&&o.position){const{data:l,error:c}=await xe.from("ladder_profiles").select("id, position").eq("ladder_name",r).gt("position",o.position).order("position",{ascending:!0});if(!c&&l){for(const d of l)await xe.from("ladder_profiles").update({position:d.position-1}).eq("id",d.id);console.log(` Renumbered ${l.length} players to fill the gap`)}}return{success:!0,message:"Player removed from ladder successfully"}}catch(s){return console.error("Error removing player from ladder:",s),{success:!1,error:s.message,message:s.message}}}}const Fo=new tee,D2=Object.freeze(Object.defineProperty({__proto__:null,default:Fo,supabaseDataService:Fo},Symbol.toStringTag,{value:"Module"}));const Ao={async signIn(n,t){return await xe.auth.signInWithPassword({email:n,password:t})},async getUserProfile(n){try{const{data:t,error:r}=await xe.from("users").select("*").eq("id",n).single();if(r&&r.code==="42P17"){console.log("RLS recursion detected, trying alternative query...");const{data:s,error:a}=await xe.from("users").select("id, email, first_name, last_name, created_at").eq("id",n).single();return{data:s,error:a}}return{data:t,error:r}}catch(t){return console.error("Error in getUserProfile:",t),{data:null,error:t}}},async getLeagueProfile(n){const{data:t,error:r}=await xe.from("league_profiles").select("*").eq("user_id",n).single();return{data:t,error:r}},async getLadderProfile(n){const{data:t,error:r}=await xe.from("ladder_profiles").select("*").eq("user_id",n).single();return{data:t,error:r}},async signOut(){return await xe.auth.signOut()}};class ree{constructor(){this.currentUser=null,this.isAuthenticated=!1}async signIn(t,r){var s,a;try{console.log(" Supabase sign in attempt for:",t);const{data:o,error:i}=await Ao.signIn(t,r);if(i)return console.error(" Supabase sign in error:",i.message),{success:!1,message:this.getErrorMessage(i)};if(o.user){console.log(" Supabase sign in successful:",t);const l={id:o.user.id,email:o.user.email,first_name:((s=o.user.user_metadata)==null?void 0:s.first_name)||"User",last_name:((a=o.user.user_metadata)==null?void 0:a.last_name)||"Name",created_at:o.user.created_at};return this.currentUser={...l,leagueProfile:null,ladderProfile:null},this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:"user"}}return{success:!1,message:"Authentication failed"}}catch(o){return console.error(" Supabase authentication error:",o),{success:!1,message:"Authentication failed. Please try again."}}}async signOut(){try{const{error:t}=await Ao.signOut();return t?(console.error(" Supabase sign out error:",t),{success:!1,message:t.message}):(this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),console.log(" Supabase sign out successful"),{success:!0})}catch(t){return console.error(" Sign out error:",t),{success:!1,message:t.message}}}async checkAuthStatus(){try{const{data:{session:t}}=await xe.auth.getSession();if(t!=null&&t.user){const s=await Ao.getUserProfile(t.user.id);if(s.data){const[a,o]=await Promise.all([Ao.getLeagueProfile(t.user.id),Ao.getLadderProfile(t.user.id)]);return this.currentUser={...s.data,leagueProfile:a.data,ladderProfile:o.data},this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:this.determineUserType(a.data,o.data)}}}const r=localStorage.getItem("supabaseAuth");if(r){const s=JSON.parse(r);return this.currentUser=s.user,this.isAuthenticated=!0,{success:!0,user:this.currentUser,userType:s.userType}}return this.isAuthenticated=!1,{success:!1}}catch(t){return console.error(" Auth status check error:",t),this.isAuthenticated=!1,{success:!1}}}getCurrentUser(){return this.currentUser}isUserAuthenticated(){return this.isAuthenticated}determineUserType(t,r){return t&&r?"both":t?"league":r?"ladder":"user"}getErrorMessage(t){switch(t.message){case"Invalid login credentials":return"Invalid email or password. Please try again.";case"Email not confirmed":return"Please check your email and click the confirmation link.";case"Too many requests":return"Too many login attempts. Please wait a moment and try again.";default:return t.message||"Login failed. Please try again."}}storeAuthData(t,r){const s={user:t,userType:r,timestamp:Date.now()};localStorage.setItem("supabaseAuth",JSON.stringify(s)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("userData",JSON.stringify(t))}async resetPassword(t){try{console.log(" Requesting password reset for:",t);const r=`${window.location.origin}/#/reset-password`;console.log(" Password reset redirect URL:",r);const{data:s,error:a}=await xe.auth.resetPasswordForEmail(t,{redirectTo:r});return a?(console.error(" Password reset error:",a),console.error(" Error details:",JSON.stringify(a,null,2)),{error:a,message:a.message||"Failed to send password reset email. Check if SMTP is configured in Supabase."}):(console.log(" Password reset email sent successfully"),{success:!0,data:s,message:"Password reset email sent! Check your inbox."})}catch(r){return console.error(" Password reset exception:",r),{error:r,message:r.message||"Failed to send password reset email."}}}async signInWithOAuth(t,r={}){try{console.log(` Signing in with ${t}...`),console.log(" Clearing existing session before OAuth..."),await xe.auth.signOut(),this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),localStorage.removeItem("userFirstName"),localStorage.removeItem("userLastName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userPin"),localStorage.removeItem("userToken"),localStorage.removeItem("userType");const s=`${window.location.origin}/#/auth/callback`,a=typeof window<"u"&&window.self!==window.top;console.log(" OAuth redirectTo (must be in Supabase URL Configuration):",s),a&&console.log(" In iframe  using iframe origin for Google (this origin must be in Google Authorized JavaScript origins):",window.location.origin);const{data:o,error:i}=await xe.auth.signInWithOAuth({provider:t,options:{redirectTo:s,queryParams:{access_type:"offline",prompt:"consent"}}});if(i)return console.error(` ${t} OAuth error:`,i),{success:!1,message:i.message||`Failed to sign in with ${t}.`};if(o!=null&&o.url)if(a){const l=r.popupWindow;if(l&&!l.closed)l.location.href=o.url;else{const c=window.open(o.url,"_blank");(!c||c.closed)&&console.warn(" Popup may have been blocked. Allow pop-ups for this site and try again.")}}else window.location.href=o.url;return{success:!0,message:`Redirecting to ${t}...`}}catch(s){return console.error(` ${t} OAuth exception:`,s),{success:!1,message:`Failed to sign in with ${t}.`}}}async handleOAuthCallback(){var t,r,s;try{console.log(" Processing OAuth callback, checking for session..."),console.log(" Current URL hash:",window.location.hash);const{data:a}=await xe.auth.getSession();(t=a==null?void 0:a.session)!=null&&t.user?console.log(" Already have a valid session, skipping signOut"):(console.log(" Clearing any existing session before processing OAuth callback..."),await xe.auth.signOut(),this.currentUser=null,this.isAuthenticated=!1,localStorage.removeItem("supabaseAuth"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userData"),localStorage.removeItem("userFirstName"),localStorage.removeItem("userLastName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userPin"),localStorage.removeItem("userToken"),localStorage.removeItem("userType"));const o=window.location.hash;console.log(" Full URL hash:",o);const i=o.split("#"),l=i[i.length-1];if(l&&l.includes("access_token")){const u=new URLSearchParams(l),h=u.get("access_token"),p=u.get("refresh_token");if(console.log(" Found tokens in URL hash:",{accessToken:h?"Found":"Missing",refreshToken:p?"Found":"Missing"}),h&&p){const{data:g,error:f}=await xe.auth.setSession({access_token:h,refresh_token:p});if(f)return console.error(" Error setting session from tokens:",f),{success:!1,message:f.message||"Failed to establish session from OAuth tokens."};if((r=g==null?void 0:g.session)!=null&&r.user)return console.log(" Session established from tokens! User:",g.session.user.email),console.log(" User ID:",g.session.user.id),window.history.replaceState({},document.title,window.location.pathname+window.location.search),await this.processOAuthSession(g.session)}}console.log(" No tokens in URL hash, checking getSession..."),await new Promise(u=>setTimeout(u,500));let{data:c,error:d}=await xe.auth.getSession();return(s=c==null?void 0:c.session)!=null&&s.user?(console.log(" Session found via getSession! User:",c.session.user.email),console.log(" User ID:",c.session.user.id),await this.processOAuthSession(c.session)):(console.error(" No session found after OAuth callback"),{success:!1,message:"No session found after OAuth. Please try logging in again."})}catch(a){return console.error(" OAuth callback exception:",a),{success:!1,message:a.message||"Authentication failed."}}}async processOAuthSession(t){var r,s,a,o,i,l,c,d,u,h,p,g;try{if(!(t!=null&&t.user))return{success:!1,message:"Invalid session."};console.log(" OAuth sign in successful:",t.user.email);const f=await Ao.getUserProfile(t.user.id);if(f.data){const m=f.data.is_admin,v=m===!0||m==="true"||m===1,b=f.data.is_approved,w=f.data.is_active,x=v||(b===!0||b==="true"||b===1)&&(w===!0||w==="true"||w===1);if(console.log(" Existing user approval check:",{email:f.data.email,is_admin:f.data.is_admin,is_approved:f.data.is_approved,is_active:f.data.is_active,isApproved:x,rawData:JSON.stringify(f.data,null,2)}),!x)return console.log(" Existing user pending approval - signing out and not authenticating"),console.log(" Approval status:",{is_approved:f.data.is_approved,is_active:f.data.is_active,is_pending_approval:f.data.is_pending_approval}),await xe.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account is pending admin approval. Please wait for approval before logging in.",isNewUser:!1,requiresApproval:!0,user:{...f.data,leagueProfile:null,ladderProfile:null}};console.log(" User is approved - proceeding with authentication");const[j,S]=await Promise.all([Ao.getLeagueProfile(t.user.id),Ao.getLadderProfile(t.user.id)]);return this.currentUser={...f.data,leagueProfile:j.data,ladderProfile:S.data},this.isAuthenticated=!0,this.storeAuthData(this.currentUser,this.determineUserType(j.data,S.data)),{success:!0,user:this.currentUser,userType:this.determineUserType(j.data,S.data)}}else{console.log(" New OAuth user detected, creating user profile...");const m=((r=t.user.user_metadata)==null?void 0:r.full_name)||((s=t.user.user_metadata)==null?void 0:s.name)||((a=t.user.user_metadata)==null?void 0:a.display_name)||"",v=((o=t.user.user_metadata)==null?void 0:o.first_name)||((i=t.user.user_metadata)==null?void 0:i.given_name)||(m?m.split(" ")[0]:"")||((l=t.user.email)==null?void 0:l.split("@")[0])||"User",b=((c=t.user.user_metadata)==null?void 0:c.last_name)||((d=t.user.user_metadata)==null?void 0:d.family_name)||(m?m.split(" ").slice(1).join(" "):"")||"",w=v.trim()||((u=t.user.email)==null?void 0:u.split("@")[0])||"User",x=b.trim()||"";console.log(" Extracted OAuth user info:",{firstName:w,lastName:x,email:t.user.email,metadata:t.user.user_metadata});const j=((h=t.user.app_metadata)==null?void 0:h.provider)||((p=t.user.user_metadata)==null?void 0:p.provider)||t.user.identities&&((g=t.user.identities[0])==null?void 0:g.provider)||"oauth",{data:S,error:_}=await xe.from("users").insert({id:t.user.id,email:t.user.email,first_name:w,last_name:x||"Name",is_pending_approval:!0,is_approved:!1,is_active:!1,auth_provider:j,created_at:new Date().toISOString()}).select().single();if(_)if(_.code==="23505"){console.log(" User already exists, fetching profile...");const C=await Ao.getUserProfile(t.user.id);if(C.data){if(this.currentUser={...C.data,leagueProfile:null,ladderProfile:null},!(C.data.is_admin===!0||C.data.is_admin==="true"||C.data.is_admin===1||C.data.is_approved===!0&&C.data.is_active===!0))return console.log(" Existing user pending approval - signing out and not authenticating"),await xe.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account is pending admin approval. Please wait for approval before logging in.",isNewUser:!1,requiresApproval:!0,user:{...C.data,leagueProfile:null,ladderProfile:null}}}else throw new Error("Failed to create or fetch user profile")}else throw console.error(" Error creating OAuth user profile:",_),_;else{console.log(" New user created:",{id:S.id,email:S.email,is_approved:S.is_approved,is_active:S.is_active,is_pending_approval:S.is_pending_approval}),this.currentUser={...S,leagueProfile:null,ladderProfile:null};const C=S.is_approved,N=S.is_active,M=(C===!0||C==="true"||C===1)&&(N===!0||N==="true"||N===1);if(console.log(" Checking approval status:",{is_approved:S.is_approved,is_approved_type:typeof S.is_approved,is_active:S.is_active,is_active_type:typeof S.is_active,isApproved:M}),!M)return console.log(" New user pending approval - signing out and not authenticating"),await xe.auth.signOut(),this.isAuthenticated=!1,this.currentUser=null,{success:!1,message:"Your account has been created and is pending admin approval. Please wait for approval before logging in.",isNewUser:!0,requiresApproval:!0,user:{...S,leagueProfile:null,ladderProfile:null}};console.log(" User is approved - proceeding with authentication")}return this.isAuthenticated=!0,this.storeAuthData(this.currentUser,"user"),{success:!0,user:this.currentUser,userType:"user",isNewUser:!1}}}catch(f){return console.error(" Error processing OAuth session:",f),{success:!1,message:f.message||"Failed to process authentication."}}}}const sy=new ree,DN=({isOpen:n,onClose:t,claimingPlayer:r=null,containerSelector:s=null})=>{const[a,o]=y.useState(r?"claim":"check"),[i,l]=y.useState({firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",phone:"",fargoRate:(r==null?void 0:r.fargoRate)||"400",ladderName:(r==null?void 0:r.ladderName)||"499-under",message:""}),[c,d]=y.useState(!1),[u,h]=y.useState(""),[p,g]=y.useState(""),[f,m]=y.useState(null);y.useEffect(()=>{r?(o("claim"),l({firstName:r.firstName||"",lastName:r.lastName||"",phone:"",fargoRate:r.fargoRate||"400",ladderName:r.ladderName||"499-under",message:""})):(o("check"),l({firstName:"",lastName:"",phone:"",fargoRate:"400",ladderName:"499-under",message:""}))},[r]);const v=M=>{const{name:E,value:P}=M.target;l(D=>({...D,[E]:P}))},b=async M=>{h(""),d(!0);const E={firstName:i.firstName,lastName:i.lastName,phone:i.phone,fargoRate:i.fargoRate,ladderName:i.ladderName,message:i.message,isNewSignup:!0};localStorage.setItem("pendingOAuthSignup",JSON.stringify(E));const P=typeof window<"u"&&window.self!==window.top,D=P?window.open("about:blank","_blank"):null;P&&!D&&h("Please allow pop-ups for this site, then try again.");try{const T=await sy.signInWithOAuth(M,{popupWindow:D});T.success||(h(T.message||`Failed to sign in with ${M}.`),d(!1),localStorage.removeItem("pendingOAuthSignup"))}catch(T){console.error(`${M} OAuth error:`,T),h(`Failed to sign in with ${M}. Please try again.`),d(!1),localStorage.removeItem("pendingOAuthSignup")}},w=async M=>{var T,A,k;h(""),d(!0);const E={firstName:i.firstName,lastName:i.lastName,phone:i.phone,message:i.message,position:((T=f==null?void 0:f[0])==null?void 0:T.position)||(r==null?void 0:r.position),ladderName:((A=f==null?void 0:f[0])==null?void 0:A.ladder_name)||(r==null?void 0:r.ladderName)||"499-under",fargoRate:((k=f==null?void 0:f[0])==null?void 0:k.fargo_rate)||(r==null?void 0:r.fargoRate),isClaiming:!0};localStorage.setItem("pendingClaim",JSON.stringify(E));const P=typeof window<"u"&&window.self!==window.top,D=P?window.open("about:blank","_blank"):null;P&&!D&&h("Please allow pop-ups for this site, then try again.");try{const R=await sy.signInWithOAuth(M,{popupWindow:D});R.success||(h(R.message||`Failed to sign in with ${M}.`),d(!1),localStorage.removeItem("pendingClaim"))}catch(R){console.error(`${M} OAuth error:`,R),h(`Failed to sign in with ${M}. Please try again.`),d(!1),localStorage.removeItem("pendingClaim")}},x=async M=>{var E;if(M.preventDefault(),!i.firstName||!i.lastName){h("Please enter both first and last name");return}d(!0),h("");try{const P=await Fo.checkExistingPlayer(i.firstName.trim(),i.lastName.trim(),null);if(P.success&&P.hasExistingPlayers&&P.foundPlayers.length>0){const D=P.foundPlayers.find(A=>A.ladder_profiles&&A.ladder_profiles.length>0)||P.foundPlayers[0],T=(E=D.ladder_profiles)==null?void 0:E[0];m([{first_name:D.first_name,last_name:D.last_name,position:(T==null?void 0:T.position)||999,ladder_name:(T==null?void 0:T.ladder_name)||"499-under",fargo_rate:(T==null?void 0:T.fargo_rate)||null,user_id:D.id}]),l(A=>({...A,firstName:D.first_name,lastName:D.last_name,fargoRate:(T==null?void 0:T.fargo_rate)||"400",ladderName:(T==null?void 0:T.ladder_name)||"499-under"})),o("claim")}else h(`We couldn't find you on the ladder. Try "I'm a New Player" instead.`)}catch{h("Error checking. Please try again.")}finally{d(!1)}},j=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"10px",textAlign:"center"},children:"Join the Ladder"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"30px",fontSize:"0.9rem",textAlign:"center"},children:"Choose how you want to join:"}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"10px",borderRadius:"4px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginBottom:"30px"},children:[e.jsxs("button",{type:"button",onClick:()=>o("new"),style:{width:"100%",padding:"20px",background:"#4CAF50",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1.1rem",textAlign:"left",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"I'm a New Player"}),e.jsx("div",{style:{fontSize:"0.85rem",opacity:.9},children:"Create a new account and join the ladder"})]})]}),e.jsxs("button",{type:"button",onClick:()=>o("checkName"),style:{width:"100%",padding:"20px",background:"#007bff",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1.1rem",textAlign:"left",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"I'm Already on the Ladder"}),e.jsx("div",{style:{fontSize:"0.85rem",opacity:.9},children:"Claim your existing position"})]})]})]})]}),S=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:" New Player Signup"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"0.95rem",textAlign:"center",lineHeight:"1.6"},children:"Sign up with Google or Facebook to create your account. Your account will be sent to admin for approval."}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{marginBottom:"25px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{type:"button",onClick:()=>b("google"),disabled:c,style:{width:"100%",padding:"14px",background:"#ffffff",color:"#333",border:"1px solid #ddd",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"Google",style:{height:"24px"}}),"Sign Up with Google"]}),e.jsxs("button",{type:"button",onClick:()=>b("facebook"),disabled:c,style:{width:"100%",padding:"14px",background:"#1877F2",color:"#ffffff",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/facebook-new.png",alt:"Facebook",style:{height:"24px"}}),"Sign Up with Facebook"]})]}),e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"20px",marginTop:"25px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#FF9800",marginTop:"0",marginBottom:"10px"},children:" Don't have Google or Facebook?"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"15px",fontSize:"0.9rem",lineHeight:"1.6"},children:"Contact the admin to set up your account manually."}),e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline",fontWeight:"bold"},children:"admin@frontrangepool.com"})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",padding:"15px",borderRadius:"6px",marginTop:"20px",fontSize:"0.85rem",color:"#ccc"},children:[e.jsx("strong",{style:{color:"#4CAF50"},children:"What happens next?"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0,lineHeight:"1.8"},children:[e.jsx("li",{children:"Sign in with Google or Facebook"}),e.jsx("li",{children:"Your account will be created automatically"}),e.jsx("li",{children:"Admin will approve your account (usually within 24 hours)"}),e.jsx("li",{children:"You'll receive an email once approved"}),e.jsx("li",{children:"Log in with Google/Facebook to access the ladder!"})]})]}),e.jsx("button",{type:"button",onClick:()=>o("check"),style:{width:"100%",marginTop:"20px",padding:"12px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"})]}),_=()=>e.jsxs("form",{onSubmit:x,style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"10px",textAlign:"center"},children:" Check Your Name"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"0.95rem",textAlign:"center"},children:"Enter your name as it appears on the ladder to find your position"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontWeight:"bold"},children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:i.firstName,onChange:v,required:!0,style:{width:"100%",padding:"12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"},placeholder:"Enter your first name",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"25px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontWeight:"bold"},children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:i.lastName,onChange:v,required:!0,style:{width:"100%",padding:"12px",borderRadius:"6px",border:"2px solid #444",background:"#2a2a2a",color:"#fff",fontSize:"1rem"},placeholder:"Enter your last name"})]}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>o("check"),style:{flex:1,padding:"14px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"}),e.jsx("button",{type:"submit",disabled:c||!i.firstName||!i.lastName,style:{flex:2,padding:"14px",background:c||!i.firstName||!i.lastName?"#666":"linear-gradient(135deg, #007bff 0%, #0056b3 100%)",color:"#fff",border:"none",borderRadius:"6px",cursor:c||!i.firstName||!i.lastName?"not-allowed":"pointer",fontWeight:"bold",fontSize:"1.1rem",boxShadow:c||!i.firstName||!i.lastName?"none":"0 4px 15px rgba(0, 123, 255, 0.4)"},children:c?"Checking...":" Find My Position"})]})]}),C=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:" Claim Your Ladder Position"}),(r||f&&f.length>0||i.firstName&&i.lastName)&&e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"2px solid #4CAF50",borderRadius:"8px",padding:"15px",marginBottom:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#4CAF50",marginBottom:"5px"},children:[i.firstName," ",i.lastName]}),f&&f.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{color:"#aaa",fontSize:"0.9rem"},children:["Position #",f[0].position,"  ",f[0].ladder_name||"499-under"," Ladder"]}),f[0].fargo_rate&&e.jsxs("div",{style:{color:"#aaa",fontSize:"0.85rem",marginTop:"5px"},children:["Fargo: ",f[0].fargo_rate]})]}),r&&(!f||f.length===0)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{color:"#aaa",fontSize:"0.9rem"},children:["Position #",r.position,"  ",r.ladderName||"499-under"," Ladder"]}),r.fargoRate&&e.jsxs("div",{style:{color:"#aaa",fontSize:"0.85rem",marginTop:"5px"},children:["Fargo: ",r.fargoRate]})]})]}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"0.95rem",lineHeight:"1.6",textAlign:"center"},children:"Sign in with Google or Facebook to claim this position instantly."}),u&&e.jsx("div",{style:{background:"rgba(220, 53, 69, 0.1)",border:"1px solid rgba(220, 53, 69, 0.3)",padding:"12px",borderRadius:"6px",marginBottom:"20px",color:"#dc3545"},children:u}),e.jsxs("div",{style:{marginBottom:"25px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("button",{type:"button",onClick:()=>w("google"),disabled:c,style:{width:"100%",padding:"14px",background:"#ffffff",color:"#333",border:"1px solid #ddd",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/google-logo.png",alt:"Google",style:{height:"24px"}}),"Claim with Google"]}),e.jsxs("button",{type:"button",onClick:()=>w("facebook"),disabled:c,style:{width:"100%",padding:"14px",background:"#1877F2",color:"#ffffff",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",opacity:c?.6:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("img",{src:"https://img.icons8.com/color/24/000000/facebook-new.png",alt:"Facebook",style:{height:"24px"}}),"Claim with Facebook"]})]}),e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"20px",marginTop:"25px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"#FF9800",marginTop:"0",marginBottom:"10px"},children:" Don't have Google or Facebook?"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"15px",fontSize:"0.9rem",lineHeight:"1.6"},children:"Contact the admin to claim your position manually."}),e.jsx("a",{href:"mailto:admin@frontrangepool.com",style:{color:"#FF9800",textDecoration:"underline",fontWeight:"bold"},children:"admin@frontrangepool.com"})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",padding:"15px",borderRadius:"6px",marginTop:"20px",fontSize:"0.85rem",color:"#ccc"},children:[e.jsx("strong",{style:{color:"#4CAF50"},children:"What happens next?"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0,lineHeight:"1.8"},children:[e.jsx("li",{children:"Sign in with Google or Facebook"}),e.jsx("li",{children:"Your position will be claimed automatically"}),e.jsx("li",{children:"Admin will approve your claim (usually within 24 hours)"}),e.jsx("li",{children:"You'll receive an email once approved"}),e.jsx("li",{children:"Log in with Google/Facebook to access the ladder!"})]})]}),e.jsx("button",{type:"button",onClick:()=>o("check"),style:{width:"100%",marginTop:"20px",padding:"12px",background:"transparent",color:"#fff",border:"2px solid #666",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Back"})]}),N=()=>e.jsxs("div",{style:{padding:"40px 20px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:""}),e.jsx("h3",{style:{color:"#4CAF50",marginBottom:"15px"},children:"Success!"}),e.jsx("p",{style:{color:"#ccc",marginBottom:"25px",fontSize:"1rem",lineHeight:"1.6"},children:p||"Your request has been submitted successfully!"}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"20px",marginBottom:"25px",textAlign:"left"},children:[e.jsx("h4",{style:{color:"#4CAF50",marginTop:"0",marginBottom:"15px"},children:" Next Steps:"}),e.jsxs("ol",{style:{color:"#ccc",lineHeight:"1.8",margin:"0",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Wait for approval"})," - Admin will approve your account (usually within 24 hours)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Check your email"})," - You'll receive an email once approved"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Log in"})," - Use Google or Facebook to log in"]})]})]}),e.jsx("button",{onClick:t,style:{padding:"14px 28px",background:"linear-gradient(135deg, #007bff 0%, #0056b3 100%)",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"1rem",boxShadow:"0 4px 15px rgba(0, 123, 255, 0.4)"},children:"Got it! Close"})]});return e.jsxs(Uo,{open:n,onClose:t,title:a==="success"?"":" Join the Ladder",maxWidth:"600px",containerSelector:s||null,children:[a==="check"&&j(),a==="checkName"&&_(),a==="new"&&S(),a==="claim"&&C(),a==="success"&&N()]})};function nee({isOpen:n,onClose:t,isMobile:r,onContactAdmin:s}){const[a,o]=y.useState({introduction:!1,brackets:!1,challengeAcceptance:!1,matchTypes:!1,matchReporting:!1,fargoReporting:!1,membership:!1,winnerTakesAll:!1,immunity:!1,prizeDistribution:!1,contact:!1}),i=c=>{o(d=>({...d,[c]:!d[c]}))},l=({sectionKey:c,title:d,children:u,isExpanded:h})=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{onClick:()=>i(c),style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.3s ease",userSelect:"none"},onMouseEnter:p=>{p.target.style.background="rgba(255, 68, 68, 0.2)"},onMouseLeave:p=>{p.target.style.background="rgba(255, 68, 68, 0.1)"},children:[e.jsx("h3",{style:{color:"#ff4444",margin:0,fontSize:"1.2rem",fontWeight:"bold"},children:d}),e.jsx("span",{style:{color:"#ff4444",fontSize:"1.5rem",fontWeight:"bold",transform:h?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:""})]}),h&&e.jsx("div",{style:{padding:"15px",background:"rgba(0, 0, 0, 0.2)",borderRadius:"0 0 8px 8px",border:"1px solid rgba(255, 68, 68, 0.2)",borderTop:"none"},children:u})]});return xr.createPortal(e.jsx(Uo,{open:n,onClose:t,title:" Ladder of Legends Rules",maxWidth:"600px",maxHeight:"90vh",borderColor:"#ff4444",textColor:"#ffffff",glowColor:"#ff4444",zIndex:1e5,style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",color:"#ffffff"},children:e.jsxs("div",{style:{lineHeight:"1.5",fontSize:"1rem"},children:[e.jsxs(l,{sectionKey:"introduction",title:" Welcome to the Ladder of Legends",isExpanded:a.introduction,children:[e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"What is the Ladder of Legends?"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"10px"},children:"The Ladder of Legends is a unquiely formatted tournament series that is a sanctioned BCAPL singles pool league. With skill-based brackets, and a dynamic ranking system. Players compete to climb the ladder through strategic challenges and matches, with prizes awarded every 3 months."})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#4CAF50",marginBottom:"8px",fontSize:"1.1rem"},children:"How It Works"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Three Skill Brackets:"})," 499-under, 500-549, and 550+ (based on FargoRate)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Challenge System:"})," Challenge players up to 4 spots above you to climb the ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Types:"})," Challenge matches, SmackDown matches, and SmackBack matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Membership Required:"})," $5/month membership + $5 per match reporting fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pools:"})," Awards every 3 months with scaled payouts based on ladder size"]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Getting Started"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Join the Community:"}),' Facebook group "Ladder of Legends" for updates and match coordination']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Claim Your Position:"})," Free account creation to claim a ladder position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Get Active:"})," Purchase membership and start challenging other players"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Play Matches:"})," Schedule matches anywhere, anytime (except top 5 players - see special rules)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Report Results:"})," Winner reports the match and pays the $5 fee"]})]})]}),e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h4",{style:{color:"#9c27b0",marginBottom:"8px",fontSize:"1.1rem"},children:"Important Notes"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Player Responsibility:"})," You are responsible for knowing and following all rules"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Age Requirement:"})," Players under 18 require parental approval"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Participation Agreement:"})," Joining implies agreement to all rules listed here"]})]})]})]}),e.jsxs(l,{sectionKey:"brackets",title:" Brackets & Race Requirements",isExpanded:a.brackets,children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"15px",fontSize:"1rem"},children:"Players are placed in brackets based on skill levels:"}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"499 and under"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 5 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $20"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"500-549"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 7 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $25"})]})]}),e.jsxs("div",{style:{background:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"6px",padding:"8px 12px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{color:"#ffc107",margin:0,fontSize:"1.1rem"},children:"550+"}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{color:"#e0e0e0",margin:"0 0 2px 0",fontSize:"0.9rem"},children:"Race to 7 (minimum)"}),e.jsx("p",{style:{color:"#e0e0e0",margin:0,fontSize:"0.9rem"},children:"Entry Fee: $25"})]})]}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#8b5cf6",marginBottom:"8px",fontSize:"1.1rem"},children:" Bracket Transition Rules"}),e.jsxs("p",{style:{color:"#e0e0e0",fontSize:"0.95rem",marginBottom:"10px"},children:["When your FargoRate exceeds ladder limits, you receive a ",e.jsx("strong",{children:"14-day grace period"}),":"]}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Rating Goes Over Bracket Max:"})," Automatically move up after 14 days if rating stays over (enter at bottom of new bracket)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Rating Drops Below Bracket Min:"})," Choose to stay or move down after 14 days"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"During Grace Period:"})," Can continue playing normally while you decide or recover your rating"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Status:"})," Shown in your User Status panel with countdown timer"]})]}),e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.15)",border:"1px solid rgba(16, 185, 129, 0.4)",borderRadius:"6px",padding:"8px"},children:e.jsx("p",{style:{color:"#10b981",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:' Players moving to lower brackets receive Fast Track privileges - see "Types of Matches" for details'})})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Additional Information"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Brackets are determined using FargoRate"}),e.jsx("li",{children:"If no FargoRate, known skill level equivalent applies"}),e.jsx("li",{children:"Higher races are allowed by mutual agreement"}),e.jsxs("li",{children:[e.jsx("strong",{children:"Note:"})," All matches have a flat $5 reporting fee regardless of bracket"]})]})]}),e.jsxs(l,{sectionKey:"challengeAcceptance",title:" Challenge Acceptance & Decline Policy",isExpanded:a.challengeAcceptance,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Challenge Acceptance"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem",marginBottom:"15px"},children:"For all match types, players must accept a challenge or use a decline when called out."}),e.jsx("p",{children:"Medical and emergenccy stipulations apply."}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Decline Challenge Policy"}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Allowance:"})," Each player gets 2 declines total"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Decline Effect:"})," When a challenge is declined, the challenger moves up one position and the defender moves down one position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reset System:"})," Each decline resets 30 days after it was used (not all at once)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Strategic Use:"})," Use your declines wisely - they have immediate position consequences"]})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"6px",padding:"8px",marginTop:"8px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.9rem",margin:0,fontWeight:"bold"},children:" Important: Declining a challenge results in immediate position changes regardless of match outcome."})})]})]}),e.jsxs(l,{sectionKey:"matchTypes",title:" Types of Matches",isExpanded:a.matchTypes,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"CHALLENGE MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Players can challenge opponents up to 4 spots above them"}),e.jsx("li",{children:"Challenger wins: Players switch positions"}),e.jsx("li",{children:"Defender wins: Ladder positions remain unchanged"})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"SMACKDOWN MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:'Any player can call out a "SmackDown"'}),e.jsx("li",{children:"Player calls out an opponent no more than 5 spots below them"}),e.jsxs("li",{children:["The Challenger ",e.jsx("em",{children:"(Person calling out the SmackDown)"})," pays the full entry fee; the Defender pays 50% of the entry fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Wins:"})," Opponent moves THREE spots down, challenger moves TWO spots up (but not into first place)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Loses:"})," Players switch positions"]}),e.jsx("li",{children:"First place must be earned via a Challenge Match or SmackBack match"})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"SMACKBACK MATCH:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"If the SmackDown defender wins, they can challenge for 1st place in their next match with a SmackBack"}),e.jsxs("li",{children:["The Challenger ",e.jsx("em",{children:"(Person calling out the SmackBack)"})," pays the full entry fee; the Defender pays 50% of the entry fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Challenger Wins:"})," Moves into 1st place, all other positions move down one spot"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Defender Wins:"})," Ladder positions remain unchanged"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"FAST TRACK MATCHES:"}),e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#2196F3",marginBottom:"8px",fontSize:"1rem"},children:" Fast Track Re-entry System"}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.95rem",marginBottom:"10px"},children:"Special matches for players crossing the 500 Fargo rating boundary, designed to be fair to existing ladder players."}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Grace Periods (14 days):"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Over Ladder Max:"})," When your Fargo goes over your ladder's maximum, a 14-day grace period starts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Under Ladder Min:"})," When your Fargo drops below your ladder's minimum, a 14-day grace period starts"]}),e.jsx("li",{children:"Grace status appears in your User Status panel with countdown"})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"What Happens After Grace Period:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Over Max:"})," If still over max after 14 days  ",e.jsx("strong",{children:"Automatically move UP"})," to next ladder"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Back Under Max:"})," If you recover  Stay on current ladder, nothing happens"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Under Min:"})," If still under min after 14 days  Choose to stay or move down with Fast Track"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Back Above Min:"})," If you recover  Stay on current ladder, nothing happens"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Bottom Entry Rule:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:["If you choose to move down to 499-under ladder, you enter at the ",e.jsx("strong",{children:"bottom"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No existing players are bumped"})," - this protects current ladder positions"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Fast Track Privileges:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"2 special challenges"})," (must be used within 4 weeks)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Extended range:"})," Can challenge up to ",e.jsx("strong",{children:"6 spots above"})," (normal limit is 4)"]}),e.jsx("li",{children:'Shown as green tile in User Status panel (e.g., "2 challenges left")'})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Match Mechanics:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"10px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"If Fast Track challenger wins:"})," They ",e.jsx("strong",{children:"insert"})," into defender's exact position"]}),e.jsx("li",{children:"The Defender and all other players below the move down one spot"}),e.jsxs("li",{children:[e.jsx("strong",{children:"If Fast Track challenger loses:"})," Ladder positions do not change"]})]}),e.jsx("h6",{style:{color:"#ffc107",marginBottom:"6px",fontSize:"0.9rem"},children:"Eligibility:"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",fontSize:"0.9rem"},children:[e.jsx("li",{children:"Must be on the same ladder for Fast Track challenges"}),e.jsx("li",{children:"Range must be within 6 positions above challenger"}),e.jsx("li",{children:"Cannot create challenges if 2 uses are exhausted or 4-week window expired"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 193, 7, 0.1)",border:"1px solid rgba(255, 193, 7, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"TOP 5 PLAYER SPECIAL RULES"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Location Requirement:"})," Matches involving top 5 players must be played at Legends Brews & Cues (2790 Hancock Expwy, Colorado Springs)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Schedule:"})," Top 5 matches are played on SATURDAYS OR SUNDAYS only"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time Window:"})," Match start times between 2pm-8pm, by mutual agreement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Live Streaming:"})," Top 5 matches will be live-streamed on the Legends Facebook page"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No Greens Fees:"})," Tables for top 5 matches are open - no table fees"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin Presence:"})," An admin/TD will be present to referee and make final decisions on disputes"]})]})]})]}),e.jsxs(l,{sectionKey:"matchReporting",title:" Match Reporting Process",isExpanded:a.matchReporting,children:[e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Reporting Requirements"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Active membership required:"})," You must have an active $5/month membership to report matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Winner reports:"})," The winner of each match is responsible for reporting the match result"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Required information:"})," Winner selection, final score, race format, and any notes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment required:"})," $5 match fee must be paid when reporting (winner pays the fee)"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Reporting Process"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Step 1:"}),' Winner goes to "Report Match" in the ladder app']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 2:"})," Select the match from pending matches list"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 3:"})," Enter match details (winner, score, race format)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 4:"})," Pay the $5 match fee (via cash, Stripe, or credits)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Step 5:"})," Match is automatically processed and ladder positions updated"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Payment Options"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"15px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Credits:"})," Use account credits if you have $5+ available"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cash:"})," Pay in person at Legends - drop payment in the red dropbox (NOT processed until admin receives and approves payment)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Stripe:"})," Pay directly with credit card through Stripe"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Manual payment:"})," Contact admin for manual payment processing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trust levels:"})," New users require admin verification, trusted users get instant processing"]})]}),e.jsx("h4",{style:{color:"#ffc107",marginBottom:"8px",fontSize:"1.1rem"},children:"Important Notes"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Membership check:"})," System automatically checks if your membership is active before allowing reporting"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee distribution:"})," $3 goes to prize pool, $2 goes to platform maintenance"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cash payments:"})," Cash payments are recorded but NOT processed until admin physically receives and approves the payment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Admin override:"})," Admins can report matches without payment requirements"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Disputes:"})," Contact ladder administrators for any match reporting issues"]})]})]}),e.jsxs(l,{sectionKey:"fargoReporting",title:" BCA Sanctioning & FargoRate Reporting",isExpanded:a.fargoReporting,children:[e.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#dc2626",marginBottom:"8px",fontSize:"1rem"},children:" MANDATORY BCA SANCTIONING REQUIREMENT"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Effective Date:"})," January 1, 2026 - ALL players must be BCA-sanctioned to participate"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Enforcement:"})," Players without sanctioning cannot challenge, accept challenges, or report matches"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Grace Period:"})," Current players have until January 1, 2026 to get sanctioned"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"New Players:"})," Must be sanctioned before joining the ladder"]})]}),e.jsx("div",{style:{background:"rgba(220, 38, 38, 0.2)",border:"1px solid rgba(220, 38, 38, 0.4)",borderRadius:"6px",padding:"8px",marginTop:"8px"},children:e.jsx("p",{style:{color:"#fca5a5",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" League-wide requirement - no exceptions after January 1, 2026"})})]}),e.jsxs("div",{style:{background:"rgba(107, 70, 193, 0.1)",border:"1px solid rgba(107, 70, 193, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#8b5cf6",marginBottom:"8px",fontSize:"1rem"},children:"How to Get BCA-Sanctioned"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Cost:"})," $25.00 for the current calendar year"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment:"})," Credit card (instant) or cash (dropbox at Legends)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Where:"}),' Click " Get Sanctioned" in your player status on the ladder page']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Already Sanctioned?"})," Contact admin if you've paid elsewhere - they can verify and update your status"]})]})]}),e.jsxs("div",{style:{background:"rgba(0, 188, 212, 0.1)",border:"1px solid rgba(0, 188, 212, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#00BCD4",marginBottom:"8px",fontSize:"1rem"},children:"FargoRate Reporting (Until Jan 1, 2026)"}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Current Policy:"})," Matches are sent to FargoRate when BOTH players are sanctioned"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status Indicators:"}),"  Green = sanctioned,  Red = not sanctioned (check player status in ladder)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Important:"})," All matches count for ladder standings regardless of sanctioning status"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"After Jan 1, 2026:"})," ALL matches will be automatically reported to FargoRate since all players must be sanctioned"]})]})]}),e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"12px"},children:e.jsx("p",{style:{color:"#10b981",fontSize:"0.9rem",margin:0,fontWeight:"bold",textAlign:"center"},children:" Get BCA-sanctioned to have your ladder matches count toward your official FargoRate!"})})]}),e.jsx(l,{sectionKey:"membership",title:" Membership & Payment Structure",isExpanded:a.membership,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Creation:"})," Free - no cost to claim a ladder position"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ladder Membership:"})," $5/month (required for challenges and match reporting)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Fees:"})," $5 per match (total, not per player)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Who Pays:"})," The WINNER reports the match and pays the $5 fee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Important:"})," Only ONE $5 fee per match - not per player!"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee Distribution:"})," $3 to prize pool, $2 to platform"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Methods:"})," Credit card (Stripe) or manual payment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Billing:"})," Monthly automatic renewal for membership"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Match Reporting:"})," Requires active membership and match fee payment"]})]})}),e.jsx(l,{sectionKey:"winnerTakesAll",title:" Winner Takes All",isExpanded:a.winnerTakesAll,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsx("li",{children:"Entry fees"}),e.jsx("li",{children:"Any added sponsor prizes/money (TBD)"}),e.jsx("li",{children:"Ladder position"}),e.jsx("li",{children:"Bragging rights"})]})}),e.jsx(l,{sectionKey:"immunity",title:" Immunity",isExpanded:a.immunity,children:e.jsx("p",{style:{color:"#e0e0e0",fontSize:"1rem"},children:"Winners receive 7 day immunity from new challenges."})}),e.jsx(l,{sectionKey:"prizeDistribution",title:" Prize Distribution",isExpanded:a.prizeDistribution,children:e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"12px",fontSize:"0.95rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Period:"})," Every 3 months (4 times per year)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Separate Prize Pools:"})," Each ladder (499-under, 500-549, 550+) has its own prize pool"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pool Funding:"})," $12 per active member (added by league every reset) + $3.00 per match played (from $5 match fee: $0.50 to climber, $2.50 to places)"]}),e.jsx("li",{children:e.jsx("strong",{children:"Prize Distribution:"})}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"8px",fontSize:"0.9rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Climber:"})," $1 per active player at period start + $0.50 per match played"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Top Players:"})," 15% of field gets paid (minimum 1, no maximum cap)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dynamic Payouts:"})," Prize fund distributed based on field size:"]}),e.jsxs("ul",{style:{color:"#e0e0e0",paddingLeft:"15px",marginBottom:"8px",fontSize:"0.85rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1 place paid:"})," 1st gets 100%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2 places paid:"})," 1st gets 60%, 2nd gets 40%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3 places paid:"})," 1st gets 50%, 2nd gets 30%, 3rd gets 20%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4 places paid:"})," 1st gets 50%, 2nd gets 30%, 3rd gets 15%, 4th gets 5%"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5+ places paid:"})," 1st gets 40%, 2nd gets 25%, 3rd gets 15%, 4th gets 10%, 5th gets 5%, additional places split remaining %"]})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Climber:"})," Player who climbed the most ladder positions during the 3-month period"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Eligibility:"})," Must have active membership and played at least 3 matches during the period"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Example:"})," With 25 players and $450 prize pool ($300 from added money + $150 from matches): Climber gets $25 (from added money) + $30 (from 60 matches) = $55. Remaining $395 split among top 3 (15% of 25 = 3 places): 1st gets $197.50 (50%), 2nd gets $118.50 (30%), 3rd gets $79 (20%)"]})]})}),e.jsxs(l,{sectionKey:"contact",title:" Questions?",isExpanded:a.contact,children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"15px",fontSize:"1rem"},children:'Join the Facebook group: "Top Colorado Springs Pool Players - The Ladder of Legends" for more information and to participate.'}),e.jsxs("div",{style:{background:"rgba(255, 68, 68, 0.1)",border:"1px solid rgba(255, 68, 68, 0.3)",borderRadius:"8px",padding:"12px",textAlign:"center"},children:[e.jsx("p",{style:{color:"#e0e0e0",marginBottom:"12px",fontSize:"1rem"},children:"Need help or have questions about the rules?"}),e.jsx("button",{onClick:()=>{t(),s?setTimeout(()=>{s()},100):alert("Contact Admin feature is not available in this context. Please use the Contact Admin card on the main ladder page.")},style:{background:"linear-gradient(45deg, #ff4444, #ff6b35)",color:"#fff",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(255, 68, 68, 0.3)"},onMouseEnter:c=>{c.target.style.background="linear-gradient(45deg, #ff5722, #ff9800)",c.target.style.boxShadow="0 6px 20px rgba(255, 68, 68, 0.4)",c.target.style.transform="translateY(-2px)"},onMouseLeave:c=>{c.target.style.background="linear-gradient(45deg, #ff4444, #ff6b35)",c.target.style.boxShadow="0 4px 15px rgba(255, 68, 68, 0.3)",c.target.style.transform="translateY(0)"},children:" Contact Admin"})]})]})]})}),document.body)}const $N=({isOpen:n,onClose:t,onSignup:r})=>{const s=yn(),[a,o]=y.useState([]),[i,l]=y.useState(!0),[c,d]=y.useState("499-under"),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState(!1),[v,b]=y.useState(!1),[w,x]=y.useState(null),[j,S]=y.useState(!1),[_,C]=y.useState(!1);y.useEffect(()=>{console.log(" StandaloneLadderModal: showUnifiedSignup changed to:",v)},[v]);const N=T=>{switch(T){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return T}},M=T=>{if(!T||T==="Unknown")return"Unknown";const A=T.trim().split(" ");if(A.length===1)return A[0];{const k=A[0],R=A[A.length-1];return`${k} ${R.charAt(0)}.`}},E=T=>{console.log("Player clicked:",T),h(T),g(!0),console.log("Modal should be opening...")},P=()=>{g(!1),h(null)};y.useEffect(()=>{n&&D()},[n,c]);const D=async()=>{var T;try{l(!0),console.log("Fetching players for ladder:",c);const A=await Fo.getLadderPlayersByName(c);if(console.log(" [LADDER DATA] Supabase result:",A),console.log(` [LADDER DATA] Success: ${A.success}, Player count: ${((T=A.data)==null?void 0:T.length)||0}`),A.success&&Array.isArray(A.data)){console.log(" [LADDER DATA] First 5 players from Supabase:",A.data.slice(0,5).map(z=>{var $,W;return{position:z.position,name:`${(($=z.users)==null?void 0:$.first_name)||""} ${((W=z.users)==null?void 0:W.last_name)||""}`,is_active:z.is_active}}));const k=A.data.map(async z=>{var W,Y,Q,H;let $=null;if((W=z.users)!=null&&W.email)try{const ue=await Fo.getPlayerLastMatch(z.users.email);ue.success&&ue.data&&($=ue.data)}catch(ue){console.log(`Error fetching last match for ${z.users.email}:`,ue)}return{_id:z.id,email:((Y=z.users)==null?void 0:Y.email)||"",firstName:((Q=z.users)==null?void 0:Q.first_name)||"",lastName:((H=z.users)==null?void 0:H.last_name)||"",position:z.position,fargoRate:z.fargo_rate||0,totalMatches:z.total_matches||0,wins:z.wins||0,losses:z.losses||0,isActive:z.is_active,immunityUntil:z.immunity_until,vacationMode:z.vacation_mode,vacationUntil:z.vacation_until,lastMatch:$}}),R=await Promise.all(k);console.log(` [LADDER DATA] Transformed ${R.length} players with last matches`);const U=R.sort((z,$)=>z.position-$.position);console.log(" [LADDER DATA] First 5 players after sorting:",U.slice(0,5).map(z=>({position:z.position,name:`${z.firstName} ${z.lastName}`}))),o(U)}else console.error("Failed to fetch players from Supabase:",A.error),o([])}catch(A){console.error("Error fetching players:",A),o([])}finally{l(!1)}};return n?xr.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .standalone-last-match-header {
          transform: none !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          padding-left: 0 !important;
          padding-right: 0 !important;
          text-align: center !important;
          justify-content: center !important;
        }
        
        @media (min-width: 769px) {
          .ladder-table:not(.logged-in-view) .table-cell.name {
            padding-left: 0px !important;
            margin-left: 0px !important;
            transform: translateX(0px) !important;
          }
        }
        
        /* Maximum specificity override for the 80px transform */
        .ladder-table:not(.logged-in-view) .table-cell.name {
          transform: translateX(0px) !important;
        }
        
        .public-ladder-player-name {
          transform: translateX(0px) !important;
        }
        
        @media (max-width: 768px) {
          .w-header-mobile {
            margin-left: -20px !important;
            transform: translateX(-20px) !important;
            position: relative !important;
            left: -20px !important;
            background-color: transparent !important;
          }
          
          .l-header-mobile {
            margin-left: -25px !important;
            transform: translateX(-25px) !important;
            position: relative !important;
            left: -25px !important;
          }
          
          .l-data-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
          
          .last-match-header-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
          
          .last-match-data-mobile {
            margin-left: -10px !important;
            transform: translateX(-10px) !important;
            position: relative !important;
            left: -10px !important;
          }
        }
        
        .quick-action-button.rules-btn {
          background: linear-gradient(45deg, #ff6b35, #f7931e) !important;
          border: 1px solid rgba(255, 107, 53, 0.3) !important;
          color: white !important;
          box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3) !important;
        }
        
        .quick-action-button.rules-btn:hover {
          background: linear-gradient(45deg, #ff5722, #ff9800) !important;
          box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4) !important;
          transform: translateY(-2px) !important;
        }
        
      `}),e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,padding:window.innerWidth<=768?"0px":"20px",boxSizing:"border-box"},onClick:t,children:[e.jsxs("div",{style:{background:"linear-gradient(120deg, #232323 80%, #2a0909 100%)",borderRadius:window.innerWidth<=768?"0px":"15px",boxShadow:window.innerWidth<=768?"none":"0 0 40px #8B5CF6, 0 0 60px rgba(0,0,0,0.9)",width:window.innerWidth<=768?"100vw":"50vw",maxWidth:window.innerWidth<=768?"100vw":"1200px",minWidth:window.innerWidth<=768?"100vw":"800px",height:window.innerWidth<=768?"100vh":"95vh",maxHeight:window.innerWidth<=768?"100vh":"95vh",display:"flex",flexDirection:"column",position:"relative",overflow:"auto",boxSizing:"border-box"},onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #c0c0c0 0%, #a8a8a8 100%)",padding:window.innerWidth<=768?"8px 12px":"15px 20px",borderRadius:"0px",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",margin:"0",width:"100%",boxSizing:"border-box"},children:[e.jsx("h2",{style:{margin:0,color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontSize:window.innerWidth<=768?"1.2rem":"1.6rem",fontWeight:"bold",textAlign:"center",paddingRight:window.innerWidth<=768?"50px":"60px",paddingLeft:window.innerWidth<=768?"50px":"60px",letterSpacing:window.innerWidth<=768?"1px":"2px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase"},children:" Ladder of Legends - Public View"}),e.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#333",fontSize:window.innerWidth<=768?"1.5rem":"1.8rem",cursor:"pointer",padding:"5px",borderRadius:"50%",width:window.innerWidth<=768?"30px":"35px",height:window.innerWidth<=768?"30px":"35px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease",position:"absolute",right:window.innerWidth<=768?"12px":"20px",top:"50%",transform:"translateY(-50%)"},onMouseOver:T=>T.currentTarget.style.backgroundColor="rgba(0,0,0,0.1)",onMouseOut:T=>T.currentTarget.style.backgroundColor="transparent",children:""})]}),e.jsx("div",{style:{background:"rgba(229, 62, 62, 0.15)",border:window.innerWidth<=768?"1px solid rgba(229, 62, 62, 0.4)":"2px solid rgba(229, 62, 62, 0.4)",padding:window.innerWidth<=768?"8px 10px":"12px 20px",textAlign:"center",flexShrink:0,margin:window.innerWidth<=768?"4px 10px 4px 10px":"10px 20px 10px 20px",borderRadius:window.innerWidth<=768?"6px":"0px"},children:e.jsx("div",{style:{color:"#e53e3e",fontWeight:"600",fontSize:window.innerWidth<=768?"0.75rem":"1rem",lineHeight:window.innerWidth<=768?"1.2":"1.5"},children:window.innerWidth<=768?" Public View - Limited Access":e.jsxs(e.Fragment,{children:[" Public View - Anyone can view the ladder rankings.",e.jsx("br",{}),"Members get access to many more features when logged into the Hub"]})})}),e.jsx("div",{style:{margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0},children:e.jsx(Dm,{userPin:"GUEST",isPublicView:!0})}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",border:"2px solid rgba(255, 193, 7, 0.3)",borderRadius:"12px",padding:window.innerWidth<=768?"12px":"16px",margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0,display:"flex",flexDirection:window.innerWidth<=768?"column":"row",gap:window.innerWidth<=768?"12px":"16px"},children:[e.jsxs("div",{style:{flex:1,padding:window.innerWidth<=768?"8px":"12px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",border:"1px solid rgba(76, 175, 80, 0.3)",textAlign:"center"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#4CAF50",fontSize:window.innerWidth<=768?"0.9rem":"1.0rem"},children:" How to Claim Your Position:"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"1. Find your name and click on it"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:'2. Click "Claim My Ladder Position"'}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"3. Enter your email and phone number"}),e.jsx("p",{style:{margin:"0 0 0 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"4. Check email to set your password!"})]}),e.jsxs("div",{style:{flex:1,padding:window.innerWidth<=768?"8px":"12px",background:"rgba(255, 193, 7, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 193, 7, 0.3)",textAlign:"center"},children:[e.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"bold",color:"#ffc107",fontSize:window.innerWidth<=768?"0.9rem":"1.0rem"},children:" How to Join as New Player:"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"1. Click 'Join The Ladder' button below"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"2. Enter your name and email address"}),e.jsx("p",{style:{margin:"0 0 4px 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"3. Check email for password setup link"}),e.jsx("p",{style:{margin:"0 0 0 0",fontSize:window.innerWidth<=768?"0.75rem":"0.85rem",color:"#fff"},children:"4. After admin approval, start playing!"})]})]}),e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:window.innerWidth<=768?"12px":"16px",margin:window.innerWidth<=768?"8px 10px":"12px 20px",flexShrink:0,textAlign:"center"},children:[e.jsx("h3",{style:{color:"#8b5cf6",margin:"0 0 8px 0",fontSize:window.innerWidth<=768?"1rem":"1.2rem",fontWeight:"bold"},children:" Already Have an Account?"}),e.jsx("p",{style:{color:"#ccc",margin:"0 0 12px 0",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",lineHeight:"1.4"},children:"Log in to access the full ladder app with all features!"}),e.jsx("button",{onClick:()=>{t(),s("/hub")},style:{background:"linear-gradient(45deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"8px",padding:window.innerWidth<=768?"10px 16px":"12px 24px",fontSize:window.innerWidth<=768?"0.9rem":"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(139, 92, 246, 0.3)",textDecoration:"none",display:"inline-block"},onMouseEnter:T=>{T.target.style.transform="translateY(-2px)",T.target.style.boxShadow="0 6px 20px rgba(139, 92, 246, 0.4)"},onMouseLeave:T=>{T.target.style.transform="translateY(0)",T.target.style.boxShadow="0 4px 15px rgba(139, 92, 246, 0.3)"},children:" Log In to Ladder"})]}),e.jsxs("div",{className:"ladder-header-section",children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:window.innerWidth<=768?"8px":"15px",display:"flex",gap:window.innerWidth<=768?"15px":"20px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"quick-action-button view-ladder-btn",onClick:()=>{r&&r(),t()},style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Join Ladder":"Join The Ladder"}),e.jsx("button",{className:"quick-action-button calendar-btn",onClick:()=>m(!0),style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Calendar":"Ladder Calendar"}),e.jsx("button",{className:"quick-action-button rules-btn",onClick:()=>S(!0),style:{fontSize:window.innerWidth<=768?"0.8rem":"1.1rem",padding:window.innerWidth<=768?"12px 16px":"16px 24px",minWidth:window.innerWidth<=768?"140px":"200px",maxWidth:window.innerWidth<=768?"160px":"220px",whiteSpace:"normal",lineHeight:"1.2"},children:window.innerWidth<=768?"Rules":"View Rules"})]}),e.jsx("h1",{className:"ladder-main-title",style:{color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontWeight:"bold",fontSize:window.innerWidth<=768?"2.2rem":"3.2rem",letterSpacing:window.innerWidth<=768?"2px":"3px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase",marginBottom:"0.2rem",marginTop:"0.5rem"},children:"Ladder of Legends"}),e.jsx("p",{className:"ladder-subtitle",style:{marginBottom:"0.8rem",marginTop:"0rem",fontSize:"0.8rem"},children:"Tournament Series"}),e.jsxs("div",{className:"ladder-selector",style:{marginTop:window.innerWidth<=768?"0.1rem":"0.5rem",padding:window.innerWidth<=768?"0.3rem 0.5rem 0.4rem 0.5rem":"0.6rem",background:"rgba(0, 0, 0, 0.3)",borderRadius:window.innerWidth<=768?"6px":"8px",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:window.innerWidth<=768?"0.2rem":"0.5rem",margin:window.innerWidth<=768?"0.1rem 0.6rem 0 0.6rem":"0",boxSizing:"border-box"},children:[e.jsx("p",{className:"ladder-selection-title",style:{margin:"0",color:"#ffffff",fontSize:window.innerWidth<=768?"0.65rem":"0.9rem",fontWeight:"600",textAlign:"center",order:(window.innerWidth<=768,1),lineHeight:window.innerWidth<=768?"1.0":"normal"},children:window.innerWidth<=768?"Select Ladder":"Select Ladder:"}),e.jsxs("select",{value:c,onChange:T=>d(T.target.value),style:{padding:window.innerWidth<=768?"0.4rem 0.6rem":"0.4rem 0.8rem",borderRadius:window.innerWidth<=768?"4px":"6px",border:"1px solid rgba(255, 255, 255, 0.3)",background:"rgba(0, 0, 0, 0.5)",color:"#ffffff",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",minWidth:window.innerWidth<=768?"120px":"180px",maxWidth:window.innerWidth<=768?"70%":"none",width:(window.innerWidth<=768,"auto"),textAlign:"center",order:(window.innerWidth<=768,2),boxSizing:"border-box"},children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"})]})]}),e.jsx("h2",{className:"ladder-active-title",style:{color:"#000000",WebkitTextStroke:"0.5px #8B5CF6",textShadow:"0 0 20px rgba(139, 92, 246, 0.8), 0 0 40px rgba(139, 92, 246, 0.6), 0 0 60px rgba(139, 92, 246, 0.4), 0 0 80px rgba(139, 92, 246, 0.2)",fontWeight:"bold",fontSize:window.innerWidth<=768?"1.6rem":"2.4rem",letterSpacing:window.innerWidth<=768?"1px":"2px",fontFamily:'"Bebas Neue", "Orbitron", "Exo 2", "Arial Black", sans-serif',textTransform:"uppercase",marginBottom:window.innerWidth<=768?"0.2rem":"0.3rem",marginTop:window.innerWidth<=768?"0.3rem":"0.5rem"},children:N(c).toUpperCase()}),e.jsx("p",{className:"ladder-selection-subtitle",style:{margin:window.innerWidth<=768?"0 0 0.3rem 0":"0 0 0.5rem 0",color:"#cccccc",fontSize:window.innerWidth<=768?"0.8rem":"0.85rem"},children:"Current rankings and positions"})]}),e.jsx("div",{style:{flex:1,overflow:"visible",padding:window.innerWidth<=768?"0 12px 0 12px":"0 20px 0 20px",marginBottom:window.innerWidth<=768?"10px":"20px"},children:i?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#ccc",fontSize:"1.2rem"},children:"Loading ladder data..."}):e.jsx("div",{className:"ladder-table-modal",style:{width:"100%",maxWidth:"100%",minWidth:"100%",overflow:"visible",boxSizing:"border-box"},children:e.jsxs("div",{className:"ladder-table",style:{width:"100%",minWidth:"100%",maxWidth:"100%",overflow:"visible",boxSizing:"border-box",background:"rgba(10, 10, 20, 0.98)",backdropFilter:"blur(15px)",boxShadow:"0 4px 20px rgba(107, 70, 193, 0.4)",borderBottom:"2px solid rgba(107, 70, 193, 0.5)",borderRadius:"8px",padding:"12px 0"},children:[e.jsxs("div",{className:"table-header",style:{display:"flex",width:"100%",minWidth:"100%",padding:window.innerWidth<=768?"8px 15px":"10px 20px",borderBottom:"1px solid rgba(107, 70, 193, 0.3)"},children:[e.jsx("div",{className:"header-cell",style:{width:"80px",padding:window.innerWidth<=768?"6px 0 6px 0":"10px 0",fontWeight:"bold",color:"#FFD700",textAlign:"center",fontSize:window.innerWidth<=768?"0.8rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 6px #FFD700, 0 0 12px #FFD700",marginLeft:window.innerWidth<=768?"-10px":"0",paddingLeft:(window.innerWidth<=768,"0"),transform:window.innerWidth<=768?"translateX(-5px)":"none"},children:"Rank"}),e.jsx("div",{className:"header-cell",style:{flex:"1",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0 10px 10px",fontWeight:"bold",color:"#ffffff",textAlign:"left",fontSize:window.innerWidth<=768?"0.75rem":"1rem",display:"flex",justifyContent:(window.innerWidth<=768,"flex-start"),alignItems:"center",textShadow:"0 0 8px #8B5CF6, 0 0 15px #8B5CF6",marginLeft:window.innerWidth<=768?"-20px":"0"},children:"Player"}),e.jsx("div",{className:"header-cell w-header-mobile",style:{width:"60px",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0",fontWeight:"bold",color:"#4CAF50",textAlign:"center",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 8px #4CAF50, 0 0 15px #4CAF50",marginLeft:window.innerWidth<=768?"-10px":"0",position:"relative",left:window.innerWidth<=768?"-10px":"0"},children:"W"}),e.jsx("div",{className:"header-cell l-header-mobile",style:{width:"60px",padding:window.innerWidth<=768?"6px 0 6px -5px":"10px 0",fontWeight:"bold",color:"#f44336",textAlign:"center",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",textShadow:"0 0 8px #f44336, 0 0 15px #f44336",marginLeft:window.innerWidth<=768?"-5px":"0",position:"relative",left:window.innerWidth<=768?"-5px":"0"},children:"L"}),e.jsx("div",{className:"last-match-header-mobile",style:{flex:"1",fontWeight:"bold",color:"#ffffff",fontSize:window.innerWidth<=768?"0.7rem":"1rem",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"6px 0":"10px 0",textShadow:"0 0 8px #8B5CF6, 0 0 15px #8B5CF6"},children:"Last Match"})]}),a.map(T=>e.jsxs("div",{className:`table-row ${T.position===1?"first-place-row":""}`,style:{display:"flex",width:"100%",minWidth:"100%",alignItems:"center",cursor:"pointer",padding:window.innerWidth<=768?"6px 15px":"8px 20px",borderBottom:"1px solid rgba(107, 70, 193, 0.1)"},onClick:()=>E(T),children:[e.jsxs("div",{className:"table-cell rank",style:{width:"80px",padding:window.innerWidth<=768?"3px 0 3px 0":"5px 0",color:T.position===1?"#FFD700":"#ffffff",textAlign:window.innerWidth<=768?"left":"center",fontSize:T.position===1?"1.2rem":window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:window.innerWidth<=768?"block":"flex",justifyContent:window.innerWidth<=768?"flex-start":"center",alignItems:"center",marginLeft:window.innerWidth<=768?"-5px":"0",paddingLeft:window.innerWidth<=768?"8px":"0",textShadow:T.position===1?"0 0 8px #FFD700":"none"},children:[T.position===1?" ":"","#",T.position]}),e.jsxs("div",{className:"table-cell name public-ladder-player-name",style:{flex:"1",padding:window.innerWidth<=768?"3px 0 3px 8px":"5px 0 5px 0px",color:T.position===1?"#FFD700":"#ffffff",fontSize:T.position===1?"1.15rem":window.innerWidth<=768?"1.1rem":"0.9rem",fontWeight:T.position===1?"600":"normal",textShadow:T.position===1?"0 0 5px rgba(255, 215, 0, 0.5)":"none",position:"relative",textAlign:"left",whiteSpace:"nowrap",display:"flex",justifyContent:"flex-start",alignItems:"center",marginLeft:window.innerWidth<=768?"0":"100px",transform:"none",backgroundColor:"transparent",left:window.innerWidth<=768?"0":"100px"},children:[T.position===1&&e.jsx("span",{style:{position:"absolute",top:"-14px",left:"-2px",fontSize:"1.3rem",transform:"rotate(-10deg)",zIndex:10,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:""}),e.jsxs("div",{className:"player-name-clickable",style:{whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",lineHeight:window.innerWidth<=768?"1.3":"1.2"},children:[T.firstName," ",T.lastName?T.lastName.charAt(0)+".":""]})]}),e.jsx("div",{className:"table-cell wins",style:{width:"60px",padding:window.innerWidth<=768?"3px 0":"5px 0",color:"#4CAF50",textAlign:"center",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:"flex",justifyContent:"center",alignItems:"center"},children:T.wins||0}),e.jsx("div",{className:"table-cell losses l-data-mobile",style:{width:"60px",padding:window.innerWidth<=768?"3px 0":"5px 0",color:"#f44336",textAlign:"center",fontSize:window.innerWidth<=768?"0.75rem":"0.9rem",fontWeight:"bold",display:"flex",justifyContent:"center",alignItems:"center"},children:T.losses||0}),e.jsx("div",{className:"table-cell last-match last-match-data-mobile",style:{flex:"1",fontSize:window.innerWidth<=768?"0.7rem":"0.9rem",padding:window.innerWidth<=768?"3px 0":"5px 0",whiteSpace:"nowrap",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:T.lastMatch?e.jsxs("div",{style:{fontSize:window.innerWidth<=768?"0.65rem":"0.9rem",fontWeight:"bold",color:T.lastMatch.result==="W"?"#4CAF50":"#f44336",whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",hyphens:window.innerWidth<=768?"auto":"none",display:window.innerWidth<=768?"block":"inline",lineHeight:window.innerWidth<=768?"1.3":"1.2",maxWidth:window.innerWidth<=768?"none":"auto",minWidth:window.innerWidth<=768?"0":"auto"},children:[T.lastMatch.result==="W"?"W":"L"," vs ",M(T.lastMatch.opponent)]}):e.jsx("span",{style:{fontSize:window.innerWidth<=768?"0.65rem":"0.8rem",color:"#999",whiteSpace:window.innerWidth<=768?"normal":"nowrap",wordWrap:window.innerWidth<=768?"break-word":"normal",overflowWrap:window.innerWidth<=768?"break-word":"normal",hyphens:window.innerWidth<=768?"auto":"none",display:window.innerWidth<=768?"block":"inline",lineHeight:window.innerWidth<=768?"1.3":"1.2",maxWidth:window.innerWidth<=768?"none":"auto",minWidth:window.innerWidth<=768?"0":"auto"},children:"No matches"})})]},T._id))]})})}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:window.innerWidth<=768?"10px":"12px",margin:window.innerWidth<=768?"0 15px 15px 15px":"0 20px 20px 20px",flexShrink:0,clear:"both"},children:[e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 8px 0",fontSize:"0.9rem",fontWeight:"600",textAlign:"center"},children:" Ready to Join the Ladder?"}),e.jsx("p",{style:{color:"#ccc",margin:"0 0 8px 0",fontSize:"0.8rem",fontStyle:"italic",textAlign:"center"},children:"BCA Sanctioned - Fargo Reported Tournament Series"}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"0",color:"#bbb",fontSize:"0.75rem",lineHeight:"1.4",textAlign:"center",listStyle:"none"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"BCA Sanctioned"})," - Official tournament play"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Professional System"})," - Advanced ladder management"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fair Competition"})," - Challenge your way up the rankings"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Prize Pools"})," + Earn your bragging rights!"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Community"})," - Join Colorado's premier singles play pool community"]})]}),e.jsx("div",{style:{textAlign:"center",marginTop:"12px"},children:e.jsx("button",{onClick:()=>{r&&r(),t()},style:{padding:"8px 16px",background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 2px 6px rgba(76, 175, 80, 0.3)"},children:" Join the Ladder Now"})})]})]}),p&&u&&e.jsx("div",{onClick:T=>T.stopPropagation(),children:e.jsx(Cf,{showMobilePlayerStats:p,selectedPlayerForStats:u,setShowMobilePlayerStats:P,updatedPlayerData:u,lastMatchData:u.lastMatch,playerMatchHistory:[],showFullMatchHistory:!1,setShowFullMatchHistory:()=>{},getPlayerStatus:()=>"active",fetchUpdatedPlayerData:()=>{},setShowUnifiedSignup:()=>{console.log(" StandaloneLadderModal: Claim button clicked!"),console.log(" StandaloneLadderModal: selectedPlayer before close:",u),x(u?{firstName:u.firstName,lastName:u.lastName,fargoRate:u.fargoRate,ladderName:u.ladderName,position:u.position}:null),console.log(" StandaloneLadderModal: Stored claimingPlayerData:",w),console.log(" StandaloneLadderModal: About to call setShowUnifiedSignup(true)"),b(!0),console.log(" StandaloneLadderModal: Called setShowUnifiedSignup(true)"),setTimeout(()=>{g(!1),h(null)},100)},isPublicView:!0})}),e.jsx(kd,{isOpen:f,onClose:()=>m(!1)}),console.log(" StandaloneLadderModal: About to render SupabaseSignupModal with claimingPlayerData:",w),console.log(" StandaloneLadderModal: showUnifiedSignup state:",v),e.jsx(DN,{isOpen:v,onClose:()=>{b(!1),x(null)},claimingPlayer:w,onSuccess:T=>{console.log("Signup successful:",T),b(!1),x(null)}}),e.jsx(nee,{isOpen:j,onClose:()=>S(!1),isMobile:window.innerWidth<=768,onContactAdmin:()=>C(!0)}),e.jsx(qb,{isOpen:_,onClose:()=>C(!1)})]})]}),document.body):null},LN=({isOpen:n,onClose:t})=>{const[r,s]=y.useState(1),[a,o]=y.useState(""),[i,l]=y.useState(null),[c,d]=y.useState([]),[u,h]=y.useState([]),[p,g]=y.useState(null),[f,m]=y.useState({challengerName:"",challengerEmail:"",challengerPhone:"",defenderName:"",defenderEmail:"",defenderPhone:"",preferredDate:"",preferredTime:"",location:"",gameType:"9-ball",raceLength:"7",notes:"",matchType:"challenge"}),[v,b]=y.useState(!1),[w,x]=y.useState(""),[j,S]=y.useState(""),[_,C]=y.useState(!1),[N,M]=y.useState(null),[E,P]=y.useState(!1),[D,T]=y.useState(null),[A,k]=y.useState(null),[R,U]=y.useState([]),[z,$]=y.useState(!1),[W,Y]=y.useState(""),[Q,H]=y.useState(""),[ue,J]=y.useState("");y.useEffect(()=>{n&&Ae()},[n]);const be=()=>{const ae=[];for(let I=10;I<=22;I++)for(let X=0;X<60&&!(I===22&&X>0);X+=30){const fe=`${I.toString().padStart(2,"0")}:${X.toString().padStart(2,"0")}`,ne=new Date(`2000-01-01T${fe}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});ae.push({value:fe,label:ne})}return ae},Ae=async()=>{$(!0);try{const ae=await Fo.getLocations();ae.success&&U(ae.data||[])}catch(ae){console.error("Error fetching locations:",ae)}finally{$(!1)}},O=ae=>({challenge:{title:"Challenge Match",description:"A standard ladder challenge where you challenge a player above you on the ladder. Win to move up in position!",rules:["Players can challenge opponents up to 4 spots above them","Challenger wins: Players switch positions","Defender wins: Ladder positions remain unchanged","Must be accepted when called out","Standard entry fee applies"]},smackdown:{title:"SmackDown Match",description:"An intense match with special rules and higher stakes. The challenger pays full entry fee, defender pays 50%.",rules:['Any player can call out a "SmackDown"',"Player calls out an opponent no more than 5 spots below them","The Challenger pays the full entry fee; the Defender pays 50% of the entry fee","If Challenger Wins: Opponent moves THREE spots down, challenger moves TWO spots up (but not into first place)","If Challenger Loses: Players switch positions","First place must be earned via a Challenge Match or SmackBack match","High stakes, high reward match!"]},smackback:{title:"SmackBack Match",description:"A special match where a SmackDown defender can challenge for 1st place in their next match.",rules:["If the SmackDown defender wins, they can challenge for 1st place in their next match with a SmackBack","The Challenger pays the full entry fee; the Defender pays 50% of the entry fee","If Challenger Wins: Moves into 1st place, all other positions move down one spot","If Defender Wins: Ladder positions remain unchanged","Only available after winning a SmackDown as defender within 7 days"]},"fast-track":{title:"Fast Track Challenge",description:"Special challenge for players who moved down to 499-under ladder with Fast Track privileges.",rules:["Can challenge up to 6 spots above (normal limit is 4)","Winner takes defender's position, others move down one spot","Limited to 2 challenges within 4 weeks","Must be on same ladder for Fast Track challenges"]},"reverse-fast-track":{title:"Reverse Fast Track Challenge",description:"Special challenge for players who moved down to 499-under ladder with Reverse Fast Track privileges.",rules:["Can challenge up to 6 spots above (normal limit is 4)","Winner takes defender's position, others move down one spot","Limited to 2 challenges within 4 weeks","Must be on same ladder for Fast Track challenges"]}})[ae]||{title:"Unknown Match Type",description:"This match type is not recognized.",rules:["Contact an administrator for more information."]},oe=ae=>{const{name:I,value:X}=ae.target;m(fe=>({...fe,[I]:X}))},me=async ae=>{C(!0),S("");try{const I=u.find(X=>X._id===ae);if(I){const X=await Fo.getAvailableMatches(I.fullName);X.success?(l(X.player),d(X.availableMatches||[]),s(3)):S(X.message||"Failed to load player matches.")}else S("Player not found.")}catch(I){console.error("Error looking up player by ID:",I),S("Failed to lookup player matches. Please try again.")}finally{C(!1)}},Ce=async()=>{if(!a.trim()){S("Please enter your name");return}C(!0),S("");try{const ae=await Fo.getAvailableMatches(a.trim());ae.success?ae.multipleMatches?(h(ae.playerOptions||[]),s(2)):(l(ae.player),d(ae.availableMatches||[]),s(3)):S(ae.message||"Player not found. Please check your name and try again.")}catch(ae){console.error("Error looking up player:",ae),S("Failed to lookup player. Please try again.")}finally{C(!1)}},ve=ae=>{g(ae),m(I=>({...I,challengerName:i.name,challengerEmail:i.email||"",challengerPhone:i.phone||"",defenderName:ae.defenderName,defenderEmail:ae.defenderEmail||"",defenderPhone:ae.defenderPhone||"",matchType:ae.matchType||"challenge"})),P(!0)},De=ae=>{T(ae),ae?(P(!1),s(4)):k(null)},Oe=()=>{P(!1),T(null),k(null),Y(""),H("")},Ze=ae=>{k(ae),ae?(Oe(),s(4)):(Oe(),S("You must have opponent agreement or make a Facebook callout post before scheduling a match. Please contact your opponent first."))},et=()=>{s(1),o(""),l(null),d([]),g(null),m({challengerName:"",challengerEmail:"",challengerPhone:"",defenderName:"",defenderEmail:"",defenderPhone:"",preferredDate:"",preferredTime:"",location:"",notes:"",matchType:"challenge"}),x(""),S(""),M(null),P(!1),T(null),k(null),Y(""),H("")},re=async ae=>{ae.preventDefault(),b(!0),S("");try{const I=await Fo.submitMatchSchedulingRequest({...f,status:"pending_approval",submittedAt:new Date().toISOString()});I.success?(x(" Match scheduling request submitted successfully! You will receive an email and in-app notification when an admin reviews your request."),setTimeout(()=>{et(),t()},3e3)):S(I.error||"Failed to submit match scheduling request")}catch(I){console.error("Error submitting match scheduling request:",I),S("Failed to submit match scheduling request. Please try again.")}finally{b(!1)}};if(!n)return null;const je=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#2196F3",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Smart Match Scheduling"}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.9rem",lineHeight:"1.4"},children:"Enter your name to see available matches based on ladder positions and rules. The system will show you who you can challenge!"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#ccc",fontSize:"1rem",fontWeight:"600"},children:"Your Name *"}),e.jsx("input",{type:"text",value:a,onChange:ae=>o(ae.target.value),placeholder:"Enter your full name as it appears on the ladder",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #555",background:"#333",color:"#fff",fontSize:"1rem",boxSizing:"border-box"},onKeyPress:ae=>ae.key==="Enter"&&Ce()})]}),j&&e.jsx("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"15px",color:"#f44336",fontSize:"0.9rem"},children:j}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:t,style:{padding:"12px 24px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"8px",cursor:"pointer",fontSize:"1rem"},children:"Cancel"}),e.jsx("button",{type:"button",onClick:Ce,disabled:_||!a.trim(),style:{padding:"12px 24px",background:_||!a.trim()?"#666":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:_||!a.trim()?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"600"},children:_?"Looking up...":"Find My Matches"})]})]}),V=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"20px",textAlign:"center"},children:"Multiple Players Found"}),e.jsxs("p",{style:{color:"#ccc",marginBottom:"20px",textAlign:"center"},children:["We found ",u.length," players with similar names. Please select the correct player:"]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:u.map((ae,I)=>e.jsx("div",{onClick:()=>me(ae._id),style:{background:"rgba(255, 255, 255, 0.05)",border:"2px solid #555",borderRadius:"8px",padding:"15px",marginBottom:"10px",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:X=>{X.target.style.background="rgba(255, 255, 255, 0.1)",X.target.style.borderColor="#2196F3"},onMouseLeave:X=>{X.target.style.background="rgba(255, 255, 255, 0.05)",X.target.style.borderColor="#555"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"600"},children:ae.fullName}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:["Position #",ae.position,"  ",ae.ladderName,"  Fargo: ",ae.fargoRate]})]}),e.jsx("div",{style:{color:"#2196F3",fontSize:"1.2rem"},children:""})]})},ae._id))}),e.jsx("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between",marginTop:"20px"},children:e.jsx("button",{type:"button",onClick:()=>{s(1),h([])},style:{padding:"10px 20px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"6px",cursor:"pointer"},children:" Back"})})]}),Ee=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#4CAF50",margin:"0 0 10px 0",fontSize:"1.1rem"},children:[" Available Matches for ",i==null?void 0:i.name]}),e.jsx("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"10px"},children:e.jsxs("p",{style:{color:"#2196F3",margin:"0",fontSize:"0.9rem",fontWeight:"600"},children:[" Position: #",i==null?void 0:i.position,"  ",i==null?void 0:i.ladderName,"  FargoRate: ",i==null?void 0:i.fargoRate]})}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.9rem",lineHeight:"1.4"},children:"Based on your ladder position, here are the players you can challenge:"})]}),c.length===0?e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"20px",textAlign:"center",color:"#FF9800"},children:[e.jsx("h4",{style:{margin:"0 0 10px 0"},children:"No Available Matches"}),e.jsx("p",{style:{margin:"0",fontSize:"0.9rem"},children:"There are currently no valid challenges available for your ladder position."})]}):e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:c.map((ae,I)=>e.jsx("div",{onClick:()=>ve(ae),style:{background:"rgba(255, 255, 255, 0.05)",border:`2px solid ${ae.color||"#555"}`,borderRadius:"8px",padding:"15px",marginBottom:"10px",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:X=>{X.target.style.borderColor=ae.color||"#2196F3",X.target.style.background=`${ae.color||"#2196F3"}20`,X.target.style.transform="translateY(-2px)",X.target.style.boxShadow=`0 4px 15px ${ae.color||"#2196F3"}40`},onMouseLeave:X=>{X.target.style.borderColor=ae.color||"#555",X.target.style.background="rgba(255, 255, 255, 0.05)",X.target.style.transform="translateY(0)",X.target.style.boxShadow="none"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"1.2rem",marginRight:"8px",color:ae.color||"#2196F3"},children:ae.icon||""}),e.jsx("h4",{style:{color:"#fff",margin:"0",fontSize:"1.1rem",textTransform:"uppercase",letterSpacing:"0.5px",flex:1},children:ae.matchType==="challenge"?"Standard Challenge":ae.matchType==="smackdown"?"SmackDown":ae.matchType==="smackback"?"SmackBack":ae.matchType==="fast-track"?"Fast Track Challenge":ae.matchType==="reverse-fast-track"?"Reverse Fast Track Challenge":"Match"}),e.jsx("button",{onClick:X=>{X.stopPropagation(),M(ae.matchType)},style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"50%",width:"24px",height:"24px",color:"#fff",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"8px"},title:"Learn more about this match type",children:""})]}),e.jsxs("h5",{style:{color:"#fff",margin:"0 0 5px 0",fontSize:"1rem"},children:["vs ",ae.defenderName]}),e.jsxs("p",{style:{color:"#ccc",margin:"0 0 5px 0",fontSize:"0.9rem"},children:["Position: #",ae.defenderPosition,"  ",ae.ladderName]}),ae.reason&&e.jsx("p",{style:{color:ae.color||"#4CAF50",margin:"5px 0 0 0",fontSize:"0.8rem",fontStyle:"italic"},children:ae.reason})]}),e.jsx("div",{style:{color:ae.color||"#2196F3",fontSize:"1.5rem",marginLeft:"15px"},children:""})]})},I))}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between",marginTop:"20px"},children:[e.jsx("button",{type:"button",onClick:()=>{Oe(),s(1)},style:{padding:"12px 24px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"8px",cursor:"pointer",fontSize:"1rem"},children:" Back"}),e.jsx("button",{type:"button",onClick:t,style:{padding:"12px 24px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"8px",cursor:"pointer",fontSize:"1rem"},children:"Cancel"})]})]}),F=()=>e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#9C27B0",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Schedule Match Details"}),e.jsxs("div",{style:{background:"rgba(156, 39, 176, 0.1)",border:"1px solid rgba(156, 39, 176, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"10px"},children:[e.jsx("p",{style:{color:"#9C27B0",margin:"0 0 5px 0",fontSize:"0.9rem",fontWeight:"600"},children:f.matchType==="challenge"?" Standard Challenge":f.matchType==="smackdown"?" SmackDown":f.matchType==="smackback"?" SmackBack":f.matchType==="fast-track"?" Fast Track Challenge":f.matchType==="reverse-fast-track"?" Reverse Fast Track Challenge":" Match"}),e.jsxs("p",{style:{color:"#ccc",margin:"0",fontSize:"0.9rem",lineHeight:"1.4"},children:[f.challengerName," vs ",f.defenderName]})]})]}),e.jsxs("form",{onSubmit:re,children:[e.jsxs("div",{style:{marginBottom:"25px"},children:[e.jsx("h4",{style:{color:"#9C27B0",margin:"0 0 15px 0",fontSize:"1rem"},children:" Match Details"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:"Match Date *"}),e.jsx("input",{type:"date",name:"preferredDate",value:f.preferredDate,onChange:oe,required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:["Start Time * ",e.jsx("span",{style:{color:"#888",fontSize:"0.8rem"},children:"(Mountain Time)"})]}),e.jsxs("select",{name:"preferredTime",value:f.preferredTime,onChange:ae=>{ae.target.value==="other"?m(I=>({...I,preferredTime:""})):(m(I=>({...I,preferredTime:ae.target.value})),Y(""))},required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Select a time"}),be().map((ae,I)=>e.jsx("option",{value:ae.value,children:ae.label},I)),e.jsx("option",{value:"other",children:"Other (specify below)"})]}),f.preferredTime===""&&e.jsx("input",{type:"text",value:W,onChange:ae=>{Y(ae.target.value),m(I=>({...I,preferredTime:ae.target.value}))},placeholder:"Enter custom time (e.g., 9:30 AM)",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem",marginTop:"5px"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:"Location *"}),e.jsxs("select",{name:"location",value:f.location,onChange:ae=>{ae.target.value==="other"?m(I=>({...I,location:""})):(m(I=>({...I,location:ae.target.value})),H(""))},required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Select a location"}),z?e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."}):R.map((ae,I)=>e.jsx("option",{value:ae.name,children:ae.name},I)),e.jsx("option",{value:"other",children:"Other (specify below)"})]}),f.location===""&&e.jsx("input",{type:"text",value:Q,onChange:ae=>{H(ae.target.value),m(I=>({...I,location:ae.target.value}))},placeholder:"Enter custom location",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem",marginTop:"5px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:"Game Type *"}),e.jsxs("select",{name:"gameType",value:f.gameType,onChange:oe,required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"8-ball",children:"8-Ball"}),e.jsx("option",{value:"9-ball",children:"9-Ball"}),e.jsx("option",{value:"10-ball",children:"10-Ball"}),e.jsx("option",{value:"mixed",children:"Mixed (Multiple Games)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:"Race Length *"}),e.jsxs("select",{name:"raceLength",value:f.raceLength,onChange:ae=>{ae.target.value==="other"?m(I=>({...I,raceLength:""})):(m(I=>({...I,raceLength:ae.target.value})),J(""))},required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem"},children:[e.jsx("option",{value:"7",children:"Race to 7"}),e.jsx("option",{value:"9",children:"Race to 9"}),e.jsx("option",{value:"11",children:"Race to 11"}),e.jsx("option",{value:"13",children:"Race to 13"}),e.jsx("option",{value:"15",children:"Race to 15"}),e.jsx("option",{value:"other",children:"Other (specify below)"})]}),f.raceLength===""&&e.jsx("input",{type:"number",value:ue,onChange:ae=>{J(ae.target.value),m(I=>({...I,raceLength:ae.target.value}))},placeholder:"Enter custom race length (e.g., 21)",min:"1",max:"100",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem",marginTop:"5px"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#ccc",fontSize:"0.9rem"},children:"Additional Notes"}),e.jsx("textarea",{name:"notes",value:f.notes,onChange:oe,rows:"3",placeholder:"Any additional information about the match...",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #555",background:"#333",color:"#fff",fontSize:"0.9rem",resize:"vertical"}})]})]})]}),j&&e.jsx("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"15px",color:"#f44336",fontSize:"0.9rem"},children:j}),w&&e.jsx("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"6px",padding:"10px",marginBottom:"15px",color:"#4CAF50",fontSize:"0.9rem"},children:w}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between"},children:[e.jsx("button",{type:"button",onClick:()=>{Oe(),s(3)},style:{padding:"10px 20px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem"},children:" Back"}),e.jsx("button",{type:"submit",disabled:v,style:{padding:"10px 20px",background:v?"#666":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",color:"white",border:"none",borderRadius:"6px",cursor:v?"not-allowed":"pointer",fontSize:"0.9rem",fontWeight:"600"},children:v?"Submitting...":"Submit Match Request"})]})]})]});return xr.createPortal(e.jsxs(e.Fragment,{children:[e.jsxs(Uo,{open:n,onClose:()=>{et(),t()},title:` Schedule Ladder Match ${r>1?`- Step ${r}`:""}`,maxWidth:"600px",maxHeight:"700px",children:[r===1&&je(),r===2&&V(),r===3&&Ee(),r===4&&F()]}),N&&e.jsx(Uo,{open:!!N,onClose:()=>M(null),title:`${O(N).title} - Match Rules`,maxWidth:"500px",maxHeight:"600px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#2196F3",margin:"0 0 10px 0",fontSize:"1.2rem"},children:[N==="challenge"?"":N==="smackdown"?"":N==="smackback"?"":""," ",O(N).title]}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.95rem",lineHeight:"1.5"},children:O(N).description})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{color:"#9C27B0",margin:"0 0 15px 0",fontSize:"1.1rem"},children:" Match Rules:"}),e.jsx("ul",{style:{color:"#ccc",paddingLeft:"20px",margin:"0"},children:O(N).rules.map((ae,I)=>e.jsx("li",{style:{marginBottom:"8px",lineHeight:"1.4",fontSize:"0.9rem"},children:ae},I))})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"20px"},children:e.jsx("button",{onClick:()=>M(null),style:{padding:"10px 20px",background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"600"},children:"Got it!"})})]})}),E&&p&&e.jsx(Uo,{open:E,onClose:()=>P(!1),title:"Opponent Agreement Required",maxWidth:"500px",maxHeight:"600px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#FF9800",margin:"0 0 10px 0",fontSize:"1.2rem"},children:" Opponent Agreement Required"}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.95rem",lineHeight:"1.5"},children:"Before scheduling a match, you must have your opponent's agreement. This ensures fair play and proper match etiquette."})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("h4",{style:{color:"#fff",margin:"0 0 15px 0",fontSize:"1.1rem"},children:["Has ",p.defenderName," agreed to this match?"]}),D===null&&e.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>De(!0),style:{padding:"12px 24px",background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:" Yes, They Agreed"}),e.jsx("button",{onClick:()=>De(!1),style:{padding:"12px 24px",background:"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:" No, They Haven't"})]}),D===!1&&A===null&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#f44336",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Facebook Callout Post"}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.9rem",lineHeight:"1.5"},children:"If your opponent hasn't agreed yet, you can make a Facebook callout post to publicly challenge them. This is the proper way to issue a challenge when direct agreement isn't possible."})]}),e.jsx("h4",{style:{color:"#fff",margin:"0 0 15px 0",fontSize:"1.1rem"},children:"Have you made a Facebook callout post for this match?"}),e.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>Ze(!0),style:{padding:"12px 24px",background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:" Yes, I Posted"}),e.jsx("button",{onClick:()=>Ze(!1),style:{padding:"12px 24px",background:"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"600"},children:" No, I Haven't"})]})]}),A===!0&&e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#2196F3",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Important Notice"}),e.jsx("p",{style:{color:"#ccc",margin:"0",fontSize:"0.9rem",lineHeight:"1.5"},children:"Your opponent must still agree to the match before admin approval. The Facebook post serves as a public challenge, but the opponent needs to confirm their participation."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("button",{onClick:()=>Oe(),style:{padding:"10px 20px",background:"transparent",color:"#ccc",border:"1px solid #555",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem"},children:"Cancel"}),(D===!0||A===!0)&&e.jsx("button",{onClick:()=>{Oe(),s(4)},style:{padding:"10px 20px",background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"600"},children:"Continue to Schedule"})]})]})})]}),document.body)},see=()=>{const n=yn(),[t,r]=y.useState(!1),[s,a]=y.useState(!1),[o,i]=y.useState(!1),[l,c]=y.useState(!1),[d,u]=y.useState(!1),[h,p]=y.useState(!1),[g,f]=y.useState({x:0,y:0}),[m,v]=y.useState(!1),[b,w]=y.useState({x:0,y:0}),[x,j]=y.useState({x:0,y:0}),[S,_]=y.useState(!1),[C,N]=y.useState({x:0,y:0}),[M,E]=y.useState(!1),P=()=>{console.log("Navigating to /hub"),n("/hub")},D=()=>{window.open("https://frusapl.com","_blank")},T=()=>{n("/tournament-bracket")},A=()=>{window.location.href="/dues-tracker/index.html"},k=H=>{H.stopPropagation(),r(!0)},R=H=>{H.stopPropagation(),a(!0)},U=H=>{H.stopPropagation(),u(!0)},z=()=>{u(!1),p(!0)},$=H=>{m&&f({x:H.clientX-b.x,y:H.clientY-b.y})},W=()=>{v(!1)},Y=H=>{S&&j({x:H.clientX-C.x,y:H.clientY-C.y})},Q=()=>{_(!1)};return y.useEffect(()=>(E((()=>{try{return window.self!==window.top}catch{return!0}})()),m&&(document.addEventListener("mousemove",$),document.addEventListener("mouseup",W)),S&&(document.addEventListener("mousemove",Y),document.addEventListener("mouseup",Q)),()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",W),document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",Q)}),[m,b,S,C]),e.jsxs("div",{className:`homepage ${M?"iframe-mode":""}`,children:[e.jsx("h2",{className:"section-title",children:"Choose Your Destination"}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"quick-action-button view-ladder-btn",onClick:k,children:"View The Ladder of Legends"}),e.jsx("button",{className:"quick-action-button match-scheduling-btn",onClick:()=>c(!0),children:"Schedule A Ladder Match"}),e.jsx("button",{className:"quick-action-button calendar-btn",onClick:R,children:"Ladder of Legends Calendar"})]}),e.jsxs("div",{className:"homepage-container",children:[e.jsxs("div",{className:"homepage-navigation",children:[e.jsxs("div",{className:"nav-cards",children:[e.jsxs("div",{className:"nav-card usapool-card",onClick:D,children:[e.jsxs("div",{className:"nav-card-logos",children:[e.jsx("img",{src:vu,alt:"BCAPL Logo",className:"league-logo"}),e.jsx("img",{src:dh,alt:"Front Range Logo",className:"league-logo"}),e.jsx("img",{src:VC,alt:"Fargorate Logo",className:"league-logo"}),e.jsx("img",{src:GC,alt:"USAPL Logo",className:"league-logo"}),e.jsx("img",{src:Wx,alt:"USAPL Nationals Logo",className:"league-logo"})]}),e.jsxs("div",{className:"nav-card-content",children:[e.jsx("h2",{children:"Front Range USA Pool League"}),e.jsx("p",{children:"Click here to go to the Front Range USA Pool League website."}),e.jsxs("div",{className:"nav-card-features",children:[e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag vegas-tag",children:"All things USAPL in one place"})}),e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag vegas-tag",id:"vegas-trip-tag",children:"1 in 12 Teams Win a Trip to Las Vegas!"})}),e.jsxs("div",{className:"feature-tag-row",children:[e.jsx("span",{className:"feature-tag",children:"Team Play"}),e.jsx("span",{className:"feature-tag",children:"Structured Format"}),e.jsx("span",{className:"feature-tag",children:"Scheduled Opponents"}),e.jsx("span",{className:"feature-tag",children:"Assigned Locations"}),e.jsx("span",{className:"feature-tag",children:"Dual Sanctioned"}),e.jsx("span",{className:"feature-tag",children:"Official Rules"}),e.jsx("span",{className:"feature-tag",children:"Registration"}),e.jsx("span",{className:"feature-tag",children:"Information"}),e.jsx("span",{className:"feature-tag",children:"Resources"})]})]}),e.jsxs("div",{className:"bottom-logos",children:[e.jsx("img",{src:vu,alt:"BCAPL Logo",className:"bottom-logo"}),e.jsx("img",{src:Wx,alt:"USAPL Nationals Logo",className:"bottom-logo"})]})]}),e.jsx("div",{className:"nav-card-arrow",children:""})]}),e.jsxs("div",{className:"nav-card hub-card",onClick:P,children:[e.jsxs("div",{className:"nav-card-logos",children:[e.jsx("img",{src:dh,alt:"Front Range Logo",className:"league-logo"}),e.jsx("img",{src:vu,alt:"BCAPL Logo",className:"league-logo"})]}),e.jsx("div",{className:"nav-card-features",children:e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to the Ladder of Legends"})})}),e.jsxs("div",{className:"nav-card-content",children:[e.jsx("div",{className:"hub-ladder-tag-mobile",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to the Ladder of Legends"})}),e.jsx("h2",{children:"The Hub"}),e.jsx("p",{children:"One place to access both singles play formats."}),e.jsx("div",{className:"nav-card-features",children:e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to Front Range BCA Singles Pool League"})})}),e.jsxs("div",{className:"nav-card-features",children:[e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag independent-formats-tag",children:"Seperate and Independent Singles Formats"})}),e.jsxs("div",{className:"feature-tag-row",children:[e.jsx("span",{className:"feature-tag",children:"Singles Play"}),e.jsx("span",{className:"feature-tag",children:"Flexible Schedule"}),e.jsx("span",{className:"feature-tag",children:"Play Anyday/Anywhere"}),e.jsx("span",{className:"feature-tag",children:"BCAPL Sanctioned"}),e.jsx("span",{className:"feature-tag",children:"Registration"}),e.jsx("span",{className:"feature-tag",children:"Player Tools"}),e.jsx("span",{className:"feature-tag",children:"Statistics"})]})]})]}),e.jsx("div",{className:"nav-card-arrow",children:""})]}),e.jsxs("div",{className:"nav-card future-card cueless-card",onClick:()=>n("/cueless"),children:[e.jsxs("div",{className:"nav-card-logos cueless-cube-logos",children:[e.jsx("div",{className:"cueless-cube cueless-cube-left",children:e.jsxs("div",{className:"cueless-cube-inner",children:[e.jsx("div",{className:"cueless-cube-face front",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face right",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face back",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face left",children:e.jsx("img",{src:bs,alt:""})})]})}),e.jsx("div",{className:"cueless-cube cueless-cube-right",children:e.jsxs("div",{className:"cueless-cube-inner",children:[e.jsx("div",{className:"cueless-cube-face front",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face right",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face back",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face left",children:e.jsx("img",{src:bs,alt:""})})]})})]}),e.jsx("div",{className:"cueless-clapper-icon",children:""}),e.jsx("div",{className:"cueless-camera-icon",children:""}),e.jsxs("div",{className:"nav-card-content",children:[e.jsx("h2",{children:"Cueless in the Booth"}),e.jsxs("div",{className:"cueless-flashing-tag",children:[e.jsx("span",{className:"line-1",children:"Got game?"}),e.jsx("span",{className:"line-2",children:"Want it streamed?"}),e.jsx("span",{className:"line-3",children:"We got you covered!"})]}),e.jsx("p",{children:'Live stream your pool matches with... "commentary" '}),e.jsx("p",{children:"Book a match to be Live Streamed at Legends Brews & Cues"}),e.jsx("p",{children:"Have Cueless come to your event"}),e.jsx("div",{className:"nav-card-features",children:e.jsxs("div",{className:"feature-tag-row",children:[e.jsx("span",{className:"feature-tag",children:"Live Streaming"}),e.jsx("span",{className:"feature-tag",children:"At Legends Brews & Cues"}),e.jsx("span",{className:"feature-tag",children:"On-Location Available"}),e.jsx("span",{className:"feature-tag",children:"Equipment Provided"}),e.jsx("span",{className:"feature-tag",children:'"Expert" Commentary'}),e.jsx("span",{className:"feature-tag",children:"Unfiltered & Real"}),e.jsx("span",{className:"feature-tag",children:"No League or Ladder Membership Required"})]})})]})]})]}),e.jsxs("div",{className:"dues-tracker-banner",onClick:A,children:[e.jsx("span",{className:"dues-tracker-banner-icon","aria-hidden":"true",children:""}),e.jsxs("div",{className:"dues-tracker-banner-content",children:[e.jsx("h2",{children:"Duezy"}),e.jsx("p",{children:"Dues tracking made easy"}),e.jsx("div",{className:"dues-tracker-banner-actions",children:e.jsx("button",{type:"button",className:"dues-tracker-banner-learn-btn",onClick:U,children:"What is Duezy?"})}),e.jsxs("div",{className:"dues-tracker-banner-tags",children:[e.jsx("span",{className:"feature-tag dues-highlight-tag",children:"League operator tools"}),e.jsx("span",{className:"feature-tag",children:"Financial Breakdowns"}),e.jsx("span",{className:"feature-tag",children:"Export & Reports"}),e.jsx("span",{className:"feature-tag",children:"FargoRate Import"}),e.jsx("span",{className:"feature-tag",children:"Dues & Payments"}),e.jsx("span",{className:"feature-tag",children:"Sanction Fees"})]})]}),e.jsx("span",{className:"dues-tracker-banner-arrow",children:""})]})]}),e.jsx("div",{className:"legends-tracker-small tournament-bracket-link",children:e.jsx("button",{className:"legends-tracker-small-btn tournament-bracket-btn",onClick:T,children:" Tournament Bracket"})}),e.jsx("footer",{className:"homepage-footer",children:e.jsx("p",{children:"Thanks for visiting www.frontrangepool.com"})})]}),e.jsx($N,{isOpen:t,onClose:()=>r(!1),onSignup:()=>i(!0)}),e.jsx(kd,{isOpen:s,onClose:()=>a(!1)}),e.jsx(DN,{isOpen:o,onClose:()=>i(!1),onSuccess:H=>{console.log("Signup successful:",H),i(!1)}}),e.jsx(LN,{isOpen:l,onClose:()=>c(!1)}),d&&e.jsx("div",{className:"what-is-duezy-overlay",onClick:()=>u(!1),role:"dialog","aria-modal":"true","aria-label":"What is Duezy?",children:e.jsxs("div",{className:"what-is-duezy-box",onClick:H=>H.stopPropagation(),children:[e.jsxs("div",{className:"what-is-duezy-header",children:[e.jsx("h2",{className:"what-is-duezy-title",children:"What is Duezy?"}),e.jsx("button",{type:"button",className:"what-is-duezy-close",onClick:()=>u(!1),"aria-label":"Close",children:""})]}),e.jsxs("div",{className:"what-is-duezy-body",children:[e.jsxs("p",{children:["Duezy is a dues-tracking app for league operators.",e.jsx("br",{}),"You can track who's paid, who's behind, and more. ",e.jsx("br",{}),"Record payments (Cash, Venmo, Cash App, Check, etc.).",e.jsx("br",{}),"See where the money goes",e.jsx("br",{}),"(prize fund, sanction fees, league income). ",e.jsx("br",{}),"Import divisions and teams from FargoRate LMS, and export or backup your data."]}),e.jsx("div",{className:"what-is-duezy-actions",children:e.jsx("button",{type:"button",className:"dues-tracker-banner-learn-btn",onClick:z,children:"Learn more"})})]})]})}),e.jsx(Uo,{open:h,onClose:()=>p(!1),title:"Discover Duezy - Making Dues Easy!",borderColor:"#6366f1",glowColor:"#6366f1",textColor:"#fff",maxWidth:"640px",children:e.jsxs("div",{style:{padding:"0.75rem 1.25rem",maxHeight:"85vh",overflowY:"auto"},children:[e.jsx("h3",{style:{margin:"0 0 0.25rem 0",color:"#fff",fontSize:"1.25rem",fontWeight:700},children:"Stop chasing. Start knowing."}),e.jsxs("p",{style:{margin:"0 0 0.6rem 0",fontSize:"1rem",lineHeight:1.4,color:"#c7d2fe"},children:["Duezy gives league operators a single place to see who's paid, who's behind, and more. ",e.jsx("br",{}),"See where every dollar goesno spreadsheets, no guesswork."]}),e.jsxs("div",{style:{marginBottom:"0.6rem"},children:[e.jsx("p",{style:{margin:"0 0 0.25rem 0",fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.08em",color:"#a5b4fc"},children:"What you get"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.1rem",lineHeight:1.55,color:"#e0e7ff",fontSize:"0.9rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.4rem 0.75rem",listStylePosition:"inside"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Know who's behindinstantly."})," See teams owed, amounts due, and payment history at a glance."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Smart builder for LMS Leagues."})," League Operator account required. Import divisions and teams from LMS reports websites."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Record payments in seconds."})," Paid, bye week, makeupone click. No digging through spreedsheets or emails."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom division builder."})," Create/edit divisions with custom dues rates, players/matches-per-week, and much more."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom payment methods."})," Cash, Venmo, Cash App, check, you name it."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Easily add/edit teams."})," Add teams, add players, edit team names, assign captain, and more."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"See where the money goes."})," Prize fund, sanction fees, league income, parent orgall broken down automatically."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Date range reports."})," View expected, collected, and owed dues for any date range."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Sanction fees, done right."})," Track which players are sanctioned, who's paid, and what you owe."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Archive teams."})," Preserve history when a team dropsrestore later if they return."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Enable individual player payments."})," Split a week's dues across multiple playersor enter amounts per player."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Export, backup, report."})," CSV, Excel, PDF. Full backups. "]})]})]}),e.jsxs("div",{style:{marginBottom:"0.6rem"},children:[e.jsx("p",{style:{margin:"0 0 0.25rem 0",fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.08em",color:"#a5b4fc"},children:"Built to fit your league"}),e.jsx("p",{style:{margin:"0 0 0.35rem 0",fontSize:"1rem",lineHeight:1.4,color:"#e0e7ff"},children:"Duezy adapts to how you run thingsnot the other way around."}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.1rem",lineHeight:1.55,color:"#e0e7ff",fontSize:"0.9rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.4rem 0.75rem",listStylePosition:"inside"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Customize per division."})," Dues rates, players-per-week, matches-per-weekeach division can have its own setup. ",e.jsx("br",{}),e.jsx("strong",{children:e.jsx("center",{children:"DUEZY is designed to fit your league."})})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Your way to split dues."})," User default settings or customize each division. Percentage-based (prize fund %, org %) or fixed dollar amounts per team or per player."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom org labels."}),' Name your first and second organization (e.g. "Home Office", "National") so reports make sense.']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Double-play support."})," Combine and track teams in two divisions at once. One payment entry for both divisions."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Division colors."})," Color-code divisions in the teams table so you can scan at a glance."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dark or light mode."})," Use what works for you."]})]}),e.jsx("center",{children:e.jsxs("strong",{children:[" ~ Try DUEZY Today~ ",e.jsx("br",{}),"MAKE DUES EASY!"]})})]}),e.jsxs("div",{style:{padding:"0.6rem 1rem",background:"rgba(99, 102, 241, 0.15)",borderRadius:10,border:"1px solid rgba(99, 102, 241, 0.35)"},children:[e.jsx("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e0e7ff"},children:e.jsx("a",{href:"/dues-tracker/index.html",className:"duezy-learn-more-signup-link",children:"Get started freesign up with Google or email."})}),e.jsx("p",{style:{margin:"0.2rem 0 0 0",fontSize:"0.9rem",color:"#a5b4fc"},children:"Built by league operators for league operators. Ditch the spreadsheets and start knowing."})]})]})})]})};const aee=()=>{const n=typeof window<"u"?window.location.origin:"",t=`${n}/#/hub`,r=`${n}/#/cueless`,s=`${n}/dues-tracker/index.html`,[a,o]=y.useState(!1),[i,l]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[p,g]=y.useState(!1);return e.jsxs("div",{className:"embed-landing homepage",children:[e.jsx("h2",{className:"section-title",children:"Choose Your Destination"}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{type:"button",className:"quick-action-button view-ladder-btn",onClick:()=>o(!0),children:"View The Ladder of Legends"}),e.jsx("button",{type:"button",className:"quick-action-button match-scheduling-btn",onClick:()=>l(!0),children:"Schedule A Ladder Match"}),e.jsx("button",{type:"button",className:"quick-action-button calendar-btn",onClick:()=>d(!0),children:"Ladder of Legends Calendar"})]}),e.jsx("div",{className:"homepage-container embed-landing-container",children:e.jsxs("div",{className:"homepage-navigation",children:[e.jsxs("div",{className:"nav-cards embed-landing-cards",children:[e.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"nav-card hub-card embed-landing-card",children:[e.jsxs("div",{className:"nav-card-logos",children:[e.jsx("img",{src:dh,alt:"Front Range Logo",className:"league-logo"}),e.jsx("img",{src:vu,alt:"BCAPL Logo",className:"league-logo"})]}),e.jsx("div",{className:"nav-card-features",children:e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to the Ladder of Legends"})})}),e.jsxs("div",{className:"nav-card-content",children:[e.jsx("div",{className:"hub-ladder-tag-mobile",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to the Ladder of Legends"})}),e.jsx("h2",{children:"The Hub"}),e.jsx("p",{children:"One place to access both singles play formats."}),e.jsx("div",{className:"nav-card-features",children:e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag hub-highlight-tag",children:"Access to Front Range BCA Singles Pool League"})})}),e.jsxs("div",{className:"nav-card-features",children:[e.jsx("div",{className:"feature-tag-row",children:e.jsx("span",{className:"feature-tag independent-formats-tag",children:"Seperate and Independent Singles Formats"})}),e.jsxs("div",{className:"feature-tag-row",children:[e.jsx("span",{className:"feature-tag",children:"Singles Play"}),e.jsx("span",{className:"feature-tag",children:"Flexible Schedule"}),e.jsx("span",{className:"feature-tag",children:"Play Anyday/Anywhere"}),e.jsx("span",{className:"feature-tag",children:"BCAPL Sanctioned"}),e.jsx("span",{className:"feature-tag",children:"Registration"}),e.jsx("span",{className:"feature-tag",children:"Player Tools"}),e.jsx("span",{className:"feature-tag",children:"Statistics"})]})]})]}),e.jsx("div",{className:"nav-card-arrow",children:""})]}),e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"nav-card future-card cueless-card embed-landing-card",children:[e.jsxs("div",{className:"nav-card-logos cueless-cube-logos",children:[e.jsx("div",{className:"cueless-cube cueless-cube-left",children:e.jsxs("div",{className:"cueless-cube-inner",children:[e.jsx("div",{className:"cueless-cube-face front",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face right",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face back",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face left",children:e.jsx("img",{src:bs,alt:""})})]})}),e.jsx("div",{className:"cueless-cube cueless-cube-right",children:e.jsxs("div",{className:"cueless-cube-inner",children:[e.jsx("div",{className:"cueless-cube-face front",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face right",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face back",children:e.jsx("img",{src:bs,alt:""})}),e.jsx("div",{className:"cueless-cube-face left",children:e.jsx("img",{src:bs,alt:""})})]})})]}),e.jsx("div",{className:"cueless-clapper-icon",children:""}),e.jsx("div",{className:"cueless-camera-icon",children:""}),e.jsxs("div",{className:"nav-card-content",children:[e.jsx("h2",{children:"Cueless in the Booth"}),e.jsxs("div",{className:"cueless-flashing-tag",children:[e.jsx("span",{className:"line-1",children:"Got game?"}),e.jsx("span",{className:"line-2",children:"Want it streamed?"}),e.jsx("span",{className:"line-3",children:"We got you covered!"})]}),e.jsx("p",{children:'Live stream your pool matches with... "commentary" '}),e.jsx("p",{children:"Book a match to be Live Streamed at Legends Brews & Cues"}),e.jsx("p",{children:"Have Cueless come to your event"}),e.jsx("div",{className:"nav-card-features",children:e.jsxs("div",{className:"feature-tag-row",children:[e.jsx("span",{className:"feature-tag",children:"Live Streaming"}),e.jsx("span",{className:"feature-tag",children:"At Legends Brews & Cues"}),e.jsx("span",{className:"feature-tag",children:"On-Location Available"}),e.jsx("span",{className:"feature-tag",children:"Equipment Provided"}),e.jsx("span",{className:"feature-tag",children:'"Expert" Commentary'}),e.jsx("span",{className:"feature-tag",children:"Unfiltered & Real"}),e.jsx("span",{className:"feature-tag",children:"No League or Ladder Membership Required"})]})})]})]})]}),e.jsxs("div",{className:"dues-tracker-banner embed-landing-duezy",onClick:()=>window.open(s,"_blank"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&window.open(s,"_blank"),style:{cursor:"pointer"},children:[e.jsx("span",{className:"dues-tracker-banner-icon","aria-hidden":"true",children:""}),e.jsxs("div",{className:"dues-tracker-banner-content",children:[e.jsx("h2",{children:"Duezy"}),e.jsx("p",{children:"Dues tracking made easy"}),e.jsx("div",{className:"dues-tracker-banner-actions",children:e.jsx("button",{type:"button",className:"dues-tracker-banner-learn-btn",onClick:f=>{f.stopPropagation(),h(!0)},children:"What is Duezy?"})}),e.jsxs("div",{className:"dues-tracker-banner-tags",children:[e.jsx("span",{className:"feature-tag dues-highlight-tag",children:"League operator tools"}),e.jsx("span",{className:"feature-tag",children:"Financial Breakdowns"}),e.jsx("span",{className:"feature-tag",children:"Export & Reports"}),e.jsx("span",{className:"feature-tag",children:"FargoRate Import"}),e.jsx("span",{className:"feature-tag",children:"Dues & Payments"}),e.jsx("span",{className:"feature-tag",children:"Sanction Fees"})]})]}),e.jsx("span",{className:"dues-tracker-banner-arrow",children:""})]})]})}),e.jsx($N,{isOpen:a,onClose:()=>o(!1),onSignup:()=>window.open(`${n}/#/`,"_blank")}),e.jsx(LN,{isOpen:i,onClose:()=>l(!1)}),e.jsx(kd,{isOpen:c,onClose:()=>d(!1)}),u&&e.jsx("div",{className:"what-is-duezy-overlay",onClick:()=>h(!1),role:"dialog","aria-modal":"true","aria-label":"What is Duezy?",children:e.jsxs("div",{className:"what-is-duezy-box",onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:"what-is-duezy-header",children:[e.jsx("h2",{className:"what-is-duezy-title",children:"What is Duezy?"}),e.jsx("button",{type:"button",className:"what-is-duezy-close",onClick:()=>h(!1),"aria-label":"Close",children:""})]}),e.jsxs("div",{className:"what-is-duezy-body",children:[e.jsxs("p",{children:["Duezy is a dues-tracking app for league operators.",e.jsx("br",{}),"You can track who's paid, who's behind, and more. ",e.jsx("br",{}),"Record payments (Cash, Venmo, Cash App, Check, etc.).",e.jsx("br",{}),"See where the money goes",e.jsx("br",{}),"(prize fund, sanction fees, league income). ",e.jsx("br",{}),"Import divisions and teams from FargoRate LMS, and export or backup your data."]}),e.jsx("div",{className:"what-is-duezy-actions",children:e.jsx("button",{type:"button",className:"dues-tracker-banner-learn-btn",onClick:()=>{h(!1),g(!0)},children:"Learn more"})})]})]})}),e.jsx(Uo,{open:p,onClose:()=>g(!1),title:"Discover Duezy - Making Dues Easy!",borderColor:"#6366f1",glowColor:"#6366f1",textColor:"#fff",maxWidth:"640px",children:e.jsxs("div",{style:{padding:"0.75rem 1.25rem",maxHeight:"85vh",overflowY:"auto"},children:[e.jsx("h3",{style:{margin:"0 0 0.25rem 0",color:"#fff",fontSize:"1.25rem",fontWeight:700},children:"Stop chasing. Start knowing."}),e.jsxs("p",{style:{margin:"0 0 0.6rem 0",fontSize:"1rem",lineHeight:1.4,color:"#c7d2fe"},children:["Duezy gives league operators a single place to see who's paid, who's behind, and more. ",e.jsx("br",{}),"See where every dollar goesno spreadsheets, no guesswork."]}),e.jsxs("div",{style:{marginBottom:"0.6rem"},children:[e.jsx("p",{style:{margin:"0 0 0.25rem 0",fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.08em",color:"#a5b4fc"},children:"What you get"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.1rem",lineHeight:1.55,color:"#e0e7ff",fontSize:"0.9rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.4rem 0.75rem",listStylePosition:"inside"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Know who's behindinstantly."})," See teams owed, amounts due, and payment history at a glance."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Smart builder for LMS Leagues."})," League Operator account required. Import divisions and teams from LMS reports websites."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Record payments in seconds."})," Paid, bye week, makeupone click. No digging through spreedsheets or emails."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom division builder."})," Create/edit divisions with custom dues rates, players/matches-per-week, and much more."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom payment methods."})," Cash, Venmo, Cash App, check, you name it."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Easily add/edit teams."})," Add teams, add players, edit team names, assign captain, and more."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"See where the money goes."})," Prize fund, sanction fees, league income, parent orgall broken down automatically."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Date range reports."})," View expected, collected, and owed dues for any date range."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Sanction fees, done right."})," Track which players are sanctioned, who's paid, and what you owe."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Archive teams."})," Preserve history when a team dropsrestore later if they return."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Enable individual player payments."})," Split a week's dues across multiple playersor enter amounts per player."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Export, backup, report."})," CSV, Excel, PDF. Full backups. "]})]})]}),e.jsxs("div",{style:{marginBottom:"0.6rem"},children:[e.jsx("p",{style:{margin:"0 0 0.25rem 0",fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.08em",color:"#a5b4fc"},children:"Built to fit your league"}),e.jsx("p",{style:{margin:"0 0 0.35rem 0",fontSize:"1rem",lineHeight:1.4,color:"#e0e7ff"},children:"Duezy adapts to how you run thingsnot the other way around."}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.1rem",lineHeight:1.55,color:"#e0e7ff",fontSize:"0.9rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.4rem 0.75rem",listStylePosition:"inside"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Customize per division."})," Dues rates, players-per-week, matches-per-weekeach division can have its own setup. ",e.jsx("br",{}),e.jsx("strong",{children:e.jsx("center",{children:"DUEZY is designed to fit your league."})})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Your way to split dues."})," User default settings or customize each division. Percentage-based (prize fund %, org %) or fixed dollar amounts per team or per player."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Custom org labels."}),' Name your first and second organization (e.g. "Home Office", "National") so reports make sense.']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Double-play support."})," Combine and track teams in two divisions at once. One payment entry for both divisions."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Division colors."})," Color-code divisions in the teams table so you can scan at a glance."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Dark or light mode."})," Use what works for you."]})]}),e.jsx("center",{children:e.jsxs("strong",{children:[" ~ Try DUEZY Today~ ",e.jsx("br",{}),"MAKE DUES EASY!"]})})]}),e.jsxs("div",{style:{padding:"0.6rem 1rem",background:"rgba(99, 102, 241, 0.15)",borderRadius:10,border:"1px solid rgba(99, 102, 241, 0.35)"},children:[e.jsx("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e0e7ff"},children:e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"duezy-learn-more-signup-link",children:"Get started freesign up with Google or email."})}),e.jsx("p",{style:{margin:"0.2rem 0 0 0",fontSize:"0.9rem",color:"#a5b4fc"},children:"Built by league operators for league operators. Ditch the spreadsheets and start knowing."})]})]})})]})},oee=({open:n,onClose:t,children:r,title:s})=>{const[a,o]=y.useState(window.innerWidth<=768),[i,l]=y.useState({x:0,y:0}),[c,d]=y.useState(!1),u=y.useRef({x:0,y:0});y.useEffect(()=>{const f=()=>{o(window.innerWidth<=768)};return window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]),y.useEffect(()=>{n&&l({x:0,y:0})},[n]);const h=f=>{a||(d(!0),u.current={x:f.clientX-i.x,y:f.clientY-i.y},document.body.style.userSelect="none")},p=f=>{!c||a||l({x:f.clientX-u.current.x,y:f.clientY-u.current.y})},g=()=>{d(!1),document.body.style.userSelect=""};return y.useEffect(()=>(c?(window.addEventListener("mousemove",p),window.addEventListener("mouseup",g)):(window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)}),[c]),n?e.jsxs("div",{className:"modal-overlay",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",padding:a?"10px":"40px",zIndex:1e3,backdropFilter:"blur(3px)",WebkitBackdropFilter:"blur(3px)"},children:[e.jsxs("div",{style:{transform:a?"translate(0px, 0px)":`translate(${i.x}px, ${i.y}px)`,cursor:c?"grabbing":"default",background:"linear-gradient(135deg, #000000 0%, #0a192f 100%)",color:"#fff",border:"2px solid #00ff41",borderRadius:a?"0.5rem":"1.2rem",boxShadow:"0 0 32px #00ff41, 0 0 40px rgba(0,0,0,0.85)",width:a?"95vw":"650px",maxWidth:a?"95vw":"650px",minWidth:a?"280px":"400px",margin:"0 auto",animation:"modalBounceIn 0.5s cubic-bezier(.21,1.02,.73,1.01)",padding:0,position:"relative",fontFamily:"inherit",boxSizing:"border-box",textAlign:"center",height:"800px",maxHeight:"500px",overflowY:"auto",display:"flex",flexDirection:"column"},onClick:f=>f.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":s,tabIndex:-1,children:[e.jsxs("div",{onMouseDown:h,style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",background:"#00ff41",padding:a?"0.3rem 0.5rem":"0.4rem 0.6rem",borderTopLeftRadius:a?"0.5rem":"1.2rem",borderTopRightRadius:a?"0.5rem":"1.2rem",position:"relative",cursor:a?"default":"grab",userSelect:"none",gap:a?"0.3rem":"0.4rem"},children:[e.jsx("h2",{style:{margin:0,fontSize:a?"1.1rem":"1.3rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.02em",textShadow:"0 1px 12px #000a",zIndex:2,flex:1,wordBreak:"break-word",minWidth:0,color:"#fff"},children:s}),e.jsx("button",{onClick:t,"aria-label":"Close",style:{background:"none",border:"none",color:"#fff",fontSize:a?"1.2em":"1.5em",fontWeight:"bold",cursor:"pointer",zIndex:10,alignSelf:"flex-start",marginTop:"0",lineHeight:1,transition:"color 0.2s, transform 0.2s",padding:0,marginLeft:"1rem"},onMouseEnter:f=>{f.target.style.color="#000000",f.target.style.transform="scale(1.2) rotate(10deg)"},onMouseLeave:f=>{f.target.style.color="#fff",f.target.style.transform="scale(1) rotate(0deg)"},children:""})]}),e.jsx("div",{style:{flex:"1 1 auto",minHeight:0,overflowY:"auto",padding:0,background:"none"},children:r})]}),e.jsx("style",{children:`
        @keyframes modalBounceIn {
          0% { opacity: 0; transform: scale(0.95) translateY(-40px);}
          70% { opacity: 1; transform: scale(1.02) translateY(8px);}
          100% { opacity: 1; transform: scale(1) translateY(0);}
        }
      `})]}):null};const iee="/assets/Culess pic-ea05b0ad.jpg",lee=()=>{const n=yn(),[t,r]=y.useState(!1),[s,a]=y.useState(""),[o,i]=y.useState(!1),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState(null),[g,f]=y.useState(window.innerWidth<=768),[m,v]=y.useState(!1),[b,w]=y.useState(!1),[x,j]=y.useState({name:"",email:"",phone:"",eventType:"",eventDate:"",endDate:"",setupDate:"",eventTime:"",endTime:"",location:"",numberOfMatches:"",playerNames:"",player1:"",player2:"",teamName:"",opponentTeamName:"",leagueName:"",matchType:"",format1:"",format2:"",eventDescription:"",tournamentDirector:"",assistantDirector:"",tournamentName:"",specialRequests:"",budget:"",agreeToTerms:!1,venueName:"",venueCity:"Colorado Springs",venueState:"CO",venueAwareness:"",venueContactName:"",venueContactEmail:"",venueContactPhone:"",isMultiDay:!1,numberOfCameras:"2"}),[S,_]=y.useState([]),[C,N]=y.useState(!1),[M,E]=y.useState([]),[P,D]=y.useState(0),T=re=>{const{name:je,value:V,type:Ee,checked:F}=re.target;j(ae=>{const I={...ae,[je]:Ee==="checkbox"?F:V};if((je==="eventDate"||je==="endDate")&&A(I.eventDate,I.endDate),je==="eventDate"||je==="endDate"){const X=I.eventDate&&I.endDate&&I.eventDate!==I.endDate;N(X)}if(je==="eventType"&&(V==="ladderMatch"||s==="legends")&&(I.location="Legends Brews & Cues"),je==="eventDate"&&I.eventTime&&(I.eventTime=""),je==="eventDate"){console.log(" handleInputChange: Date changed to:",V);const X=U(V);console.log(" handleInputChange: Generated slots:",X.length,"slots"),E(X),D(fe=>fe+1),console.log(" handleInputChange: State updated, key incremented")}return I})},A=(re,je)=>{if(!re||!je){_([]);return}const V=new Date(re),Ee=new Date(je),F=[];for(let ae=new Date(V);ae<=Ee;ae.setDate(ae.getDate()+1))F.push({date:ae.toISOString().split("T")[0],startTime:"",endTime:"",description:""});_(F)},k=(re,je,V)=>{_(ae=>ae.map((I,X)=>{if(X===re){const fe={...I,[je]:V};if(je==="startTime"&&V&&V!=="no-stream"){const ye=parseInt(V.split(":")[0])+2,ot=ye===24?"00:00":ye.toString().padStart(2,"0")+":00";fe.endTime=ot}else je==="startTime"&&V==="no-stream"&&(fe.endTime="");return fe}return I}));const Ee=`tournamentDay${re}${je}`,F=`tournamentDay${re}endTime`;j(ae=>{const I={...ae,[Ee]:V};if(je==="startTime"&&V==="no-stream")I[F]="";else if(je==="startTime"&&V&&V!=="no-stream"){const fe=parseInt(V.split(":")[0])+2,ne=fe===24?"00:00":fe.toString().padStart(2,"0")+":00";I[F]=ne}return I})},R=()=>x.name&&x.email&&x.agreeToTerms,U=re=>{if(!re)return[];const[je,V,Ee]=re.split("-").map(Number),F=new Date(je,V-1,Ee),ae=F.getDay();console.log(" generateTimeSlots called with date:",re),console.log(" Parsed as:",F.toDateString()),console.log(" Day of week:",ae,"(0=Sunday, 6=Saturday)");const I=ae===0||ae===6,X=I?14:17,fe=23;console.log(" Is weekend:",I),console.log(" Start hour:",X,"End hour:",fe);const ne=[];for(let ye=X;ye<fe;ye++)ne.push({value:`${ye.toString().padStart(2,"0")}:00`,label:`${ye>12?ye-12:ye}:00 ${ye>=12?"PM":"AM"}`}),ye<fe-1&&ne.push({value:`${ye.toString().padStart(2,"0")}:30`,label:`${ye>12?ye-12:ye}:30 ${ye>=12?"PM":"AM"}`});return console.log(" Generated",ne.length,"time slots"),console.log(" First few slots:",ne.slice(0,3)),ne},z=()=>{const re=[];for(let je=10;je<=19;je++){const V=je.toString().padStart(2,"0")+":00",Ee=je===12?"12:00 PM":je>12?`${je-12}:00 PM`:`${je}:00 AM`;re.push({value:V,label:Ee})}return re},$=re=>{if(!re)return[];const[je,V,Ee]=re.split("-").map(Number);new Date(je,V-1,Ee).getDay();const ae=10,I=23,X=[];for(let fe=ae;fe<I;fe++)X.push({value:`${fe.toString().padStart(2,"0")}:00`,label:`${fe>12?fe-12:fe}:00 ${fe>=12?"PM":"AM"}`}),fe<I-1&&X.push({value:`${fe.toString().padStart(2,"0")}:30`,label:`${fe>12?fe-12:fe}:30 ${fe>=12?"PM":"AM"}`});return X},W=re=>{if(!re)return[];const je=[],Ee=parseInt(re.split(":")[0])+2,F=24;for(let ae=Ee;ae<=F;ae++){const I=ae===24?"00:00":ae.toString().padStart(2,"0")+":00",X=ae===12?"12:00 PM":ae===24?"12:00 AM (Midnight)":ae>12?`${ae-12}:00 PM`:`${ae}:00 AM`;je.push({value:I,label:X})}return je},Y=(re,je,V)=>{if(!re||!V)return{hours:0,totalPrice:0,setupFee:0,hourlyRate:0,totalSetupFee:0,cameras:0,additionalCameras:0,additionalCameraSetupFee:0,baseHourlyRate:0,hourlyCameraFee:0,totalHourlyCost:0};const Ee=je||(re?(()=>{const Pe=parseInt(re.split(":")[0])+2;return Pe===24?"00:00":Pe.toString().padStart(2,"0")+":00"})():"");if(!Ee)return{hours:0,totalPrice:0,setupFee:0,hourlyRate:0,totalSetupFee:0,cameras:0,additionalCameras:0,additionalCameraSetupFee:0,baseHourlyRate:0,hourlyCameraFee:0,totalHourlyCost:0};const F=parseInt(re.split(":")[0]),I=parseInt(Ee.split(":")[0])-F,X=parseInt(V),fe=50,ne=Math.max(0,X-1),ye=ne*10,ot=50,lt=Math.max(0,X-1)*5,tt=ot+lt,ge=fe+ye,xt=I*tt,ht=ge+xt;return{hours:I,cameras:X,additionalCameras:ne,setupFee:fe,additionalCameraSetupFee:ye,totalSetupFee:ge,baseHourlyRate:ot,hourlyCameraFee:lt,hourlyRate:tt,totalHourlyCost:xt,totalPrice:ht}},Q=re=>{if(!re)return"";const[je,V,Ee]=re.split("-").map(Number),ae=new Date(je,V-1,Ee).getDay();return ae===0||ae===6?"Weekend hours: 2:00 PM - 10:00 PM":"Weekday hours: 5:00 PM - 10:00 PM"},H=(re,je,V)=>{if(!re)return{hours:0,totalPrice:0,setupFee:0,hourlyRate:0,totalSetupFee:0,cameras:0,additionalCameras:0,additionalCameraSetupFee:0,baseHourlyRate:0,hourlyCameraFee:0,totalHourlyCost:0,noStreamDays:0,noStreamCost:0};const Ee=parseInt(re),F=parseFloat(je)||0,ae=parseInt(V)||0,I=100,X=Math.max(0,Ee-2),fe=X*20,ne=50,ye=Math.max(0,Ee-2)*10,ot=ne+ye,lt=ae*50,tt=I+fe,ge=F*ot,xt=tt+ge+lt;return{hours:F,cameras:Ee,additionalCameras:X,setupFee:I,additionalCameraSetupFee:fe,totalSetupFee:tt,baseHourlyRate:ne,hourlyCameraFee:ye,hourlyRate:ot,totalHourlyCost:ge,noStreamDays:ae,noStreamCost:lt,totalPrice:xt}},ue=re=>{if(!re)return"";const[je,V,Ee]=re.split("-").map(Number);return`${je}-${V.toString().padStart(2,"0")}-${Ee.toString().padStart(2,"0")}`},J=re=>{const{name:je,value:V}=re.target;j(V?Ee=>({...Ee,[je]:V}):Ee=>({...Ee,[je]:""}))},be=re=>{switch(re){case"ladderMatch":return"Ladder Match (Not top 5) - Legends";case"privateMatch":return"Private Match - Legends";case"tournament":return"Tournament - Legends";case"leagueNight":return"Team League Night - Legends";case"other":return"Custom Event";default:return re}},Ae=re=>re?new Date(re).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"",O=re=>{if(!re)return"";const[je,V]=re.split(":"),Ee=parseInt(je),F=Ee>=12?"PM":"AM";return`${Ee%12||12}:${V} ${F}`},oe=()=>{if(!x.eventDate||!x.endDate)return[];const[re,je,V]=x.eventDate.split("-").map(Number),[Ee,F,ae]=x.endDate.split("-").map(Number),I=[];let X=re,fe=je,ne=V;const ye=(ot,lt,tt)=>`${ot}-${lt.toString().padStart(2,"0")}-${tt.toString().padStart(2,"0")}`;for(;;){const ot=ye(X,fe,ne),tt=new Date(X,fe-1,ne).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});if(I.push({date:ot,dateString:tt,startTime:x[`tournamentDay${I.length}startTime`]||"",endTime:x[`tournamentDay${I.length}endTime`]||"",description:x[`tournamentDay${I.length}description`]||""}),X===Ee&&fe===F&&ne===ae)break;ne++;const ge=new Date(X,fe,0).getDate();ne>ge&&(ne=1,fe++,fe>12&&(fe=1,X++))}return I},me=()=>{const re=oe();let je=0;return re.forEach(V=>{if(!(V.startTime==="no-stream"||V.endTime==="no-stream")&&V.startTime&&V.endTime){const Ee=new Date(`2000-01-01T${V.startTime}:00`),ae=(new Date(`2000-01-01T${V.endTime}:00`)-Ee)/(1e3*60*60);ae>0&&(je+=ae)}}),je.toFixed(1)},Ce=()=>{const re=parseFloat(me()),V=Math.max(4,re);return Math.round(V*30)};y.useEffect(()=>{if(x.eventDate){console.log(" useEffect: Date changed to:",x.eventDate);const re=U(x.eventDate);console.log(" useEffect: Generated slots:",re.length,"slots"),E(re),console.log(" useEffect: State updated")}},[x.eventDate]),y.useEffect(()=>{const re=()=>{f(window.innerWidth<=768)};return window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]);const ve=()=>{if(!x.name||!x.email||!x.eventType||!x.agreeToTerms)return!1;if(x.eventType==="ladderMatch")return x.player1&&x.player2&&x.eventDate&&x.eventTime;if(x.eventType==="privateMatch")return x.player1&&x.player2&&x.eventDate&&x.eventTime&&x.numberOfMatches&&parseInt(x.numberOfMatches)>=2;if(x.eventType==="tournament")return x.eventDate&&x.endDate&&x.tournamentDirector&&x.tournamentName&&me()>=0;if(x.eventType==="leagueNight"){const re=x.eventDate&&x.eventTime&&x.teamName&&x.opponentTeamName&&x.leagueName&&x.matchType;return x.matchType==="single"?re&&x.format1:x.matchType==="doublePlay"?re&&x.format1&&x.format2:re}if(x.eventType==="other")return x.eventDate&&x.eventTime&&x.eventDescription;if(x.eventType==="onLocationPrivate"){const re=x.player1&&x.player2&&x.eventDate&&x.eventTime&&x.venueName&&x.venueCity&&x.venueState&&x.venueAwareness&&x.numberOfCameras;return x.isMultiDay?re&&x.endDate:re}return x.eventType==="onLocationTournament"?x.eventDate&&x.endDate&&x.venueName&&x.venueCity&&x.venueState&&x.venueAwareness&&x.numberOfCameras:x.eventType==="onLocationOther"?x.eventDate&&x.eventTime&&x.venueName&&x.venueCity&&x.venueState&&x.venueAwareness&&x.numberOfCameras:!0},De=re=>{a(re),j(re==="legends"?je=>({...je,eventType:"",location:"Legends Brews & Cues",numberOfMatches:"",budget:"25",specialRequests:"Professional streaming setup with multiple camera angles and multiview on stream capabilities. Live commentary (unfiltered!) - No League or Ladder membership required.",endDate:"",endTime:"",playerNames:"",player1:"",player2:"",tournamentDirector:"",assistantDirector:"",tournamentName:""}):re==="onLocation"?je=>({...je,location:"",numberOfMatches:"",budget:"discuss",specialRequests:"Mobile streaming setup - Travel to your location - Event commentary - Custom branding options",endDate:"",endTime:"",playerNames:"",player1:"",player2:"",tournamentDirector:"",assistantDirector:"",tournamentName:""}):je=>({...je,eventType:"",location:"",numberOfMatches:"",budget:"",specialRequests:"",endDate:"",endTime:"",playerNames:"",player1:"",player2:"",tournamentDirector:"",assistantDirector:"",tournamentName:""})),r(!0)},Oe=()=>{r(!1),a(""),c(""),u(""),p(null),_([]),N(!1),j({name:"",email:"",phone:"",eventType:"",eventDate:"",endDate:"",setupDate:"",eventTime:"",endTime:"",location:"",numberOfMatches:"",playerNames:"",player1:"",player2:"",teamName:"",opponentTeamName:"",leagueName:"",matchType:"",format1:"",format2:"",eventDescription:"",tournamentDirector:"",assistantDirector:"",tournamentName:"",budget:"",specialRequests:"",agreeToTerms:!1,venueName:"",venueCity:"Colorado Springs",venueState:"CO",venueAwareness:"",venueContactName:"",venueContactEmail:"",venueContactPhone:"",isMultiDay:!1,numberOfCameras:"2"})},Ze=async re=>{if(re.preventDefault(),u(""),c(""),!x.name||!x.email||!x.eventDate||!x.eventTime||!x.location||!x.agreeToTerms){u("Please fill in all required fields and acknowledge our commentary style.");return}i(!0);try{const V=await(await fetch(`${{}.REACT_APP_API_URL||"http://localhost:5000"}/api/cueless/bookings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)})).json();V.success?(p({id:V.booking.id,...x,submittedAt:new Date().toLocaleString()}),j({name:"",email:"",phone:"",eventType:"",eventDate:"",endDate:"",eventTime:"",endTime:"",location:"",numberOfMatches:"",playerNames:"",player1:"",player2:"",teamName:"",opponentTeamName:"",leagueName:"",matchType:"",format1:"",format2:"",eventDescription:"",tournamentDirector:"",assistantDirector:"",tournamentName:"",budget:"",specialRequests:"",agreeToTerms:!1,venueName:"",venueCity:"Colorado Springs",venueState:"CO",venueAwareness:"",venueContactName:"",venueContactEmail:"",venueContactPhone:"",isMultiDay:!1,numberOfCameras:"2"})):u(V.message||"Failed to submit booking request. Please try again.")}catch(je){console.error("Error submitting booking:",je),u("Failed to submit booking request. Please check your connection and try again.")}finally{i(!1)}},et=()=>{n("/")};return e.jsxs("div",{className:"cueless-page",children:[e.jsxs("div",{className:`cueless-nav ${g?"mobile-nav":""}`,children:[e.jsxs("button",{className:"back-button",onClick:et,children:[e.jsx("span",{className:"back-arrow",children:""}),e.jsx("span",{className:"back-text",children:"Back to Front Range Pool.com"}),e.jsx("span",{className:"back-text-mobile",children:" Back"})]}),e.jsx("h1",{className:"cueless-title",children:"Cueless in the Booth"})]}),e.jsx("div",{className:"cueless-hero",children:e.jsxs("div",{className:"hero-content",children:[e.jsx("h2",{children:"Live Stream Your Pool Matches"}),e.jsx("div",{className:"hero-logo-container",children:e.jsx("img",{src:iee,alt:"Cueless in the Booth",className:"cueless-hero-logo"})}),e.jsx("p",{className:"hero-subtitle",children:'Book Cueless in the Booth for live streaming with... "commentary" '}),e.jsxs("div",{className:"hero-features",children:[e.jsx("span",{className:"feature-badge",children:"Live Streaming"}),e.jsx("span",{className:"feature-badge",children:"Multi Camera Options"}),e.jsx("span",{className:"feature-badge",children:"Telestrator"}),e.jsx("span",{className:"feature-badge",children:"Instant Replay"}),e.jsx("span",{className:"feature-badge",children:'Not really "Expert" - But it is Commentary'}),e.jsx("span",{className:"feature-badge",children:"Mark & Don - Unfiltered & Real"})]})]})}),e.jsxs("div",{className:"services-section",children:[e.jsx("h3",{children:"Our Services"}),e.jsxs("div",{className:"services-grid",children:[e.jsxs("div",{className:"service-card",onClick:()=>De("legends"),children:[e.jsxs("div",{className:"service-tag",children:["Got game?",e.jsx("br",{}),"Want it streamed?",e.jsx("br",{}),"We got you covered!"]}),e.jsx("h4",{style:{color:"#9c27b0",fontFamily:'Orbitron, "Courier New", monospace',fontWeight:"900",fontSize:"1.8rem",textShadow:"2px 2px 0px #000000, -2px -2px 0px #000000, 2px -2px 0px #000000, -2px 2px 0px #000000, 0 0 15px #9c27b0, 0 0 25px #9c27b0",letterSpacing:"2px",textTransform:"uppercase"},children:"At Legends Brews & Cues"}),e.jsx("div",{className:"service-logo",children:e.jsx("img",{src:$m,alt:"Legends Brews & Cues",className:"legends-logo"})}),e.jsxs("p",{children:["Book a match to be live streamed at our home location.",e.jsx("br",{}),'Legends provides all of the equipment and we do the "commentary".']}),e.jsxs("ul",{children:[e.jsx("li",{children:"Professional streaming setup with multiple camera angles and multiview on stream capabilities"}),e.jsx("li",{children:"Live commentary (unfiltered!)"}),e.jsx("li",{children:"No League or Ladder membership required"})]}),e.jsx("div",{className:"book-now-btn",children:"Book Now"})]}),e.jsxs("div",{className:"service-card",onClick:()=>{console.log("Cueless card clicked!"),v(!0),w(!0),setTimeout(()=>{De("onLocation")},1300)},children:[e.jsxs("div",{className:"service-icon",style:{fontSize:"4rem",textShadow:"0 0 15px rgba(0, 255, 65, 0.8)",filter:"drop-shadow(0 0 10px rgba(0, 255, 65, 0.5))",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px"},children:[e.jsx("span",{className:`truck-left-drives-left ${m?"truck-clicked":""}`,children:""}),e.jsx("span",{className:`truck-right-drives-right ${b?"truck-clicked":""}`,children:""})]}),e.jsx("h4",{style:{color:"#00ff41",fontFamily:'Orbitron, "Courier New", monospace',fontWeight:"900",fontSize:"1.6rem",textShadow:"2px 2px 0px #000000, -2px -2px 0px #000000, 2px -2px 0px #000000, -2px 2px 0px #000000, 0 0 15px #00ff41, 0 0 25px #00ff41",letterSpacing:"1px",textTransform:"uppercase",marginBottom:"15px"},children:"On-Location Events"}),e.jsx("p",{children:"Have Cueless come to your event, tournament, or venue with our equipment."}),e.jsxs("div",{style:{margin:"20px 0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",color:"#00ff41",fontSize:"1rem",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.8)"},children:[e.jsx("span",{style:{marginRight:"8px",color:"#00ff41",fontWeight:"bold",fontSize:"1.2rem",textShadow:"0 0 10px rgba(0, 255, 65, 0.8)"},children:""}),"Mobile streaming setup"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",color:"#00ff41",fontSize:"1rem",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.8)"},children:[e.jsx("span",{style:{marginRight:"8px",color:"#00ff41",fontWeight:"bold",fontSize:"1.2rem",textShadow:"0 0 10px rgba(0, 255, 65, 0.8)"},children:""}),"Travel to your location"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",color:"#00ff41",fontSize:"1rem",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.8)"},children:[e.jsx("span",{style:{marginRight:"8px",color:"#00ff41",fontWeight:"bold",fontSize:"1.2rem",textShadow:"0 0 10px rgba(0, 255, 65, 0.8)"},children:""}),"Event commentary"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",color:"#00ff41",fontSize:"1rem",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.8)"},children:[e.jsx("span",{style:{marginRight:"8px",color:"#00ff41",fontWeight:"bold",fontSize:"1.2rem",textShadow:"0 0 10px rgba(0, 255, 65, 0.8)"},children:""}),"Custom branding options"]})]}),e.jsx("div",{className:"book-now-btn",children:"Book Now"})]})]}),e.jsx("div",{className:"disclaimer-section",children:e.jsxs("div",{className:"disclaimer-content",children:[e.jsx("h4",{children:" Important Notice  "}),e.jsxs("p",{children:[e.jsx("strong",{children:"Please Note:"})," We are not your typical pool commentators.",e.jsx("br",{}),"Modern equipment, professional experience, but we are not professional commentators - and we do not pretend to be.",e.jsx("br",{}),"Our commentary is unfiltered and may contain adult language.",e.jsx("br",{}),"We are just two pool players who love the game, and are not afraid to call it as they see it.",e.jsx("br",{}),"Whether it's with each other, the players, or the shots! "]}),e.jsx("p",{children:"By booking our services, you agree that Cueless in the Booth provides unfiltered commentary and understand the nature of our content."})]})})]}),e.jsxs("div",{className:"contact-section",children:[e.jsx("h3",{children:"Get in Touch"}),e.jsxs("div",{className:"contact-info",children:[e.jsxs("div",{className:"contact-item",children:[e.jsx("span",{className:"contact-icon",children:""}),e.jsx("span",{children:"frbcapl@gmail.com"})]}),e.jsxs("div",{className:"contact-item",children:[e.jsx("span",{className:"contact-icon",children:""}),e.jsx("span",{children:"Text or call for immediate booking"})]}),e.jsxs("div",{className:"contact-item",children:[e.jsx("span",{className:"contact-icon",children:""}),e.jsx("span",{children:"Based at Legends Brews & Cues"})]})]})]}),e.jsx("div",{className:"cueless-footer",children:e.jsx("p",{children:" 2025 Cueless in the Booth. Unfiltered commentary for the love of pool! "})}),e.jsx(oee,{open:t,onClose:Oe,title:s==="legends"?" Book Cueless at Legends":s==="onLocation"?" Book On-Location Stream":" Book Your Stream",children:h?e.jsx("div",{style:{width:"100%",padding:"1rem 1.2rem 0.8rem 1.2rem",boxSizing:"border-box"},children:h&&e.jsxs("div",{className:"success-page",style:{background:"rgba(0, 255, 0, 0.1)",border:"2px solid rgba(0, 255, 0, 0.3)",borderRadius:"12px",padding:"25px",marginTop:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:""}),e.jsx("h3",{style:{color:"#00ff00",fontSize:"1.8rem",margin:"0 0 10px 0",textShadow:"0 0 10px rgba(0, 255, 0, 0.5)"},children:"Request Submitted!"}),e.jsx("p",{style:{color:"#ccc",fontSize:"1rem",margin:"0"},children:"Your Cueless streaming request has been received and will be reviewed"})]}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"20px",marginBottom:"20px",textAlign:"left"},children:[e.jsx("h4",{style:{color:"#00ffff",margin:"0 0 15px 0",textAlign:"center",fontSize:"1.2rem"},children:" Request Details"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Request ID:"}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#e0f7fa",fontFamily:"monospace"},children:["#",h.id]})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Contact Name:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:h.name})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Email:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:h.email})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Phone:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:h.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Event Type:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:be(h.eventType)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Date:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:Ae(h.eventDate)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Time:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:O(h.eventTime)})]}),h.endDate&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"End Date:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:Ae(h.endDate)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Location:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:h.location})]})]}),h.eventType==="ladderMatch"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Players:"}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#e0f7fa"},children:[h.player1," vs ",h.player2]})]}),h.eventType==="tournament"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Tournament:"})," ",h.tournamentName,e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Director:"})," ",h.tournamentDirector,h.assistantDirector&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Assistant:"})," ",h.assistantDirector]})]}),h.eventType==="leagueNight"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Teams:"})," ",h.teamName," vs ",h.opponentTeamName,e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"League:"})," ",h.leagueName,h.matchType&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Format:"})," ",h.format1]})]}),h.eventType==="other"&&h.eventDescription&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Event Description:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa",fontStyle:"italic"},children:h.eventDescription})]})]}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",borderRadius:"8px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffa500",margin:"0 0 15px 0",textAlign:"center",fontSize:"1.2rem"},children:" What Happens Next?"}),e.jsxs("div",{style:{color:"#e0f7fa",fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"1."})," We'll review your streaming request as soon as possible"]}),e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"2."})," We'll contact you to discuss availability and logistics"]}),e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"3."})," If we can accommodate your request, we'll send a confirmation"]}),e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"4."})," If not available, we may suggest alternative dates or options"]}),e.jsxs("p",{style:{margin:"0"},children:[e.jsx("strong",{children:"5."})," Once confirmed, get ready to be live streamed! "]})]})]}),e.jsxs("div",{style:{background:"rgba(0, 255, 255, 0.1)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#00ffff",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Questions About Your Request?"}),e.jsxs("div",{style:{color:"#e0f7fa",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{margin:"0 0 5px 0"},children:[e.jsx("strong",{children:"Email:"})," cuelessinthebooth@gmail.com"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.8rem",color:"#ccc"},children:["Reference your request ID: #",h.id]})]})]}),e.jsx("button",{onClick:Oe,style:{background:"linear-gradient(135deg, #00ff00, #00cc00)",color:"#000",border:"none",borderRadius:"8px",padding:"12px 30px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(0, 255, 0, 0.3)",transition:"all 0.3s ease"},onMouseOver:re=>{re.target.style.transform="translateY(-2px)",re.target.style.boxShadow="0 6px 20px rgba(0, 255, 0, 0.4)"},onMouseOut:re=>{re.target.style.transform="translateY(0)",re.target.style.boxShadow="0 4px 15px rgba(0, 255, 0, 0.3)"},children:" Close & Return to Home"})]})}):e.jsxs("form",{className:"booking-form",onSubmit:Ze,style:{width:"100%",padding:"1rem 1.2rem 0.8rem 1.2rem",boxSizing:"border-box"},children:[!R()&&e.jsxs("div",{className:"contact-billing-section",style:{background:"rgba(0, 255, 255, 0.05)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#00ffff",marginBottom:"10px",fontSize:"1.1rem",textAlign:"center",textShadow:"0 0 10px rgba(0, 255, 255, 0.3)"},children:" Contact/Billing Info"}),e.jsxs("div",{style:{background:"rgba(0, 255, 255, 0.08)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"6px",padding:"12px",marginBottom:"15px",textAlign:"center"},children:[e.jsxs("p",{style:{color:"#ffffff",fontSize:"0.9rem",margin:"0 0 8px 0",fontWeight:"500"},children:[e.jsx("strong",{children:"Step 1:"})," Please fill out your contact information below and check the box to acknowledge that you understand our unique and unfiltered commentary style before you can submit your booking request."]}),e.jsx("p",{style:{color:"#b0e0e6",fontSize:"0.8rem",margin:"0",fontStyle:"italic"},children:"Once complete, you'll proceed to select your event type and provide event details"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Full Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:x.name,onChange:T,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email *"}),e.jsx("input",{type:"email",id:"email",name:"email",value:x.email,onChange:T,required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:x.phone,onChange:T,className:"form-input"})]}),e.jsx("div",{className:"form-group"})]})]}),R()&&e.jsxs("div",{className:"event-type-section",style:{background:"rgba(0, 255, 255, 0.05)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("div",{className:"contact-summary",style:{background:"rgba(0, 255, 255, 0.03)",border:"1px solid rgba(0, 255, 255, 0.1)",borderRadius:"6px",padding:"10px",marginBottom:"15px"},children:e.jsxs("p",{style:{color:"#00ffff",fontSize:"0.85rem",margin:0,textAlign:"center"},children:[e.jsx("strong",{children:"Contact:"})," ",x.name,"  ",x.email,x.phone&&`  ${x.phone}`]})}),e.jsx("h4",{style:{color:"#00ffff",marginBottom:"10px",fontSize:"1.1rem",textAlign:"center",textShadow:"0 0 10px rgba(0, 255, 255, 0.3)"},children:" Select Event Type"}),e.jsxs("div",{style:{background:"rgba(0, 255, 255, 0.03)",border:"1px solid rgba(0, 255, 255, 0.15)",borderRadius:"6px",padding:"12px",marginBottom:"15px",textAlign:"center"},children:[e.jsx("p",{style:{color:"#b0e0e6",fontSize:"0.85rem",margin:"0 0 8px 0",lineHeight:"1.4"},children:e.jsx("strong",{style:{color:"#00ffff"},children:s==="onLocation"?"Choose the type of event you'd like us to stream at your location:":"Choose the type of event you'd like us to live stream:"})}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#a0d0d6",lineHeight:"1.3"},children:[s==="onLocation"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Private Match - Your Location:"})," Personal games at your venue"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Tournament - Your Location:"})," Multi-day competitive events at your venue"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Other Event - Your Location:"})," Special events or custom requests at your venue"]}),e.jsx("p",{style:{margin:"4px 0",color:"#ffa500"},children:e.jsx("strong",{children:" We bring all equipment and travel to your location!"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Ladder Match:"})," Ladder Of Legends match that is not top 5"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Private Match:"})," Personal games between opponents"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Tournament:"})," Organized competitive events"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Team League Night:"})," Team-based league matches"]}),e.jsxs("p",{style:{margin:"4px 0"},children:[e.jsx("strong",{children:" Other:"})," Special events or custom requests"]})]}),e.jsx("p",{style:{margin:"4px 0"},children:e.jsx("strong",{children:"After selecting your event type, you will be prompted to provide additional details"})})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"20px"},children:e.jsxs("div",{style:{maxWidth:"400px",width:"100%",display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:"eventType",style:{textAlign:"center",display:"block",marginBottom:"8px",color:"#00ffff",fontSize:"0.9rem",fontWeight:"500"},children:"Event Type *"}),e.jsxs("select",{id:"eventType",name:"eventType",value:x.eventType,onChange:T,required:!0,className:"form-input",style:{textAlign:"center",width:"100%",backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem"},children:[e.jsx("option",{value:"",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Select event type"}),s!=="onLocation"&&e.jsx("option",{value:"ladderMatch",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Ladder Match (Not top 5) - Legends"}),s==="onLocation"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"onLocationPrivate",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Private Match - Your Location"}),e.jsx("option",{value:"onLocationTournament",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Tournament - Your Location"}),e.jsx("option",{value:"onLocationOther",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Other Event - Your Location"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"privateMatch",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Private Match - Legends"}),e.jsx("option",{value:"tournament",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Tournament - Legends"}),e.jsx("option",{value:"leagueNight",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Team League Night - Legends"}),e.jsx("option",{value:"other",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Other"})]})]})]})})]}),!x.agreeToTerms&&e.jsxs("div",{className:"form-disclaimer",style:{background:"rgba(255, 165, 0, 0.05)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffa500",marginBottom:"10px",fontSize:"1rem",textAlign:"center",textShadow:"0 0 10px rgba(255, 165, 0, 0.3)"},children:" Important Notice"}),e.jsxs("p",{style:{margin:0,fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsx("strong",{children:"Please Note:"})," We are not your typical pool commentators.",e.jsx("br",{}),"We are not professional commentators - and we do not pretend to be.",e.jsx("br",{}),"Our commentary is unfiltered and may contain adult language.",e.jsx("br",{}),"We are just two pool players who love the game,",e.jsx("br",{}),"and are not afraid to call it as they see it.",e.jsx("br",{}),"Whether it's with each other, the players, or the shots! ",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500",fontSize:"1rem"},children:" IMPORTANT: You must check the checkbox below to acknowledge that you understand our unique and unfiltered commentary style before you can submit your booking request."})]})]}),x.eventType&&!x.eventType.startsWith("onLocation")&&e.jsxs("div",{className:"smart-conditional-fields",style:{background:"rgba(0, 255, 255, 0.03)",border:"1px solid rgba(0, 255, 255, 0.1)",borderRadius:"8px",padding:"15px",marginBottom:"15px"},children:[e.jsx("h5",{style:{color:"#00ffff",marginBottom:"10px",fontSize:"1rem",textAlign:"center"},children:" Event-Specific Details"}),e.jsxs("div",{className:"player-names-subsection",style:{background:"rgba(255, 165, 0, 0.05)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"6px",padding:"12px",marginBottom:"15px"},children:[x.eventType!=="other"&&!x.eventType.startsWith("onLocation")&&e.jsx("h6",{style:{color:"#ffa500",marginBottom:"10px",fontSize:"0.9rem",textAlign:"center",textShadow:"0 0 8px rgba(255, 165, 0, 0.3)"},children:" Player Names"}),x.eventType==="ladderMatch"&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player1",children:"Player 1 Name *"}),e.jsx("input",{type:"text",id:"player1",name:"player1",value:x.player1,onChange:T,placeholder:"Enter first player name",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player2",children:"Player 2 Name *"}),e.jsx("input",{type:"text",id:"player2",name:"player2",value:x.player2,onChange:T,placeholder:"Enter second player name",required:!0,className:"form-input"})]})]}),x.eventType==="privateMatch"&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player1",children:"Player 1 Name *"}),e.jsx("input",{type:"text",id:"player1",name:"player1",value:x.player1,onChange:T,placeholder:"Enter first player name",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player2",children:"Player 2 Name *"}),e.jsx("input",{type:"text",id:"player2",name:"player2",value:x.player2,onChange:T,placeholder:"Enter second player name",required:!0,className:"form-input"})]})]}),x.eventType==="tournament"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"tournamentDirector",children:"Tournament Director *"}),e.jsx("input",{type:"text",id:"tournamentDirector",name:"tournamentDirector",value:x.tournamentDirector||"",onChange:T,placeholder:"Enter tournament director name",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"assistantDirector",children:"Assistant Director (Optional)"}),e.jsx("input",{type:"text",id:"assistantDirector",name:"assistantDirector",value:x.assistantDirector||"",onChange:T,placeholder:"Enter assistant director name",className:"form-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"tournamentName",children:"Tournament Name *"}),e.jsx("input",{type:"text",id:"tournamentName",name:"tournamentName",value:x.tournamentName||"",onChange:T,placeholder:"Enter tournament name (e.g., Spring 8-Ball Championship)",required:!0,className:"form-input"})]})]}),x.eventType==="leagueNight"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"teamName",children:"Your Team Name *"}),e.jsx("input",{type:"text",id:"teamName",name:"teamName",value:x.teamName||"",onChange:T,placeholder:"e.g., Team Alpha, APA Team 1",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"opponentTeamName",children:"Opponent Team Name *"}),e.jsx("input",{type:"text",id:"opponentTeamName",name:"opponentTeamName",value:x.opponentTeamName||"",onChange:T,placeholder:"e.g., Team Beta, APA Team 2",required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"leagueName",children:"League *"}),e.jsxs("select",{id:"leagueName",name:"leagueName",value:x.leagueName||"",onChange:T,required:!0,className:"form-input",children:[e.jsx("option",{value:"",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Select League"}),e.jsx("option",{value:"USAPL",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"USAPL (USA Pool League)"}),e.jsx("option",{value:"APA",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"APA (American Poolplayers Association)"}),e.jsx("option",{value:"BCA",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"BCA (BCA Pool League)"}),e.jsx("option",{value:"TAP",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"TAP (The Association for Pool)"}),e.jsx("option",{value:"NPL",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"NPL (National Pool League)"}),e.jsx("option",{value:"VNEA",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"VNEA (Valley National 8-Ball League)"}),e.jsx("option",{value:"other",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Other League"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"matchType",children:"Match Type *"}),e.jsxs("select",{id:"matchType",name:"matchType",value:x.matchType||"",onChange:T,required:!0,className:"form-input",children:[e.jsx("option",{value:"",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Select Match Type"}),e.jsx("option",{value:"single",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Single Match"}),e.jsx("option",{value:"doublePlay",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Double Play (2 formats)"})]})]})]}),x.matchType==="single"&&e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"format1",children:"Game Format *"}),e.jsxs("select",{id:"format1",name:"format1",value:x.format1||"",onChange:T,required:!0,className:"form-input",children:[e.jsx("option",{value:"",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Select Game Format"}),e.jsx("option",{value:"8ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"8-Ball"}),e.jsx("option",{value:"9ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"9-Ball"}),e.jsx("option",{value:"10ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"10-Ball"}),e.jsx("option",{value:"straightPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Straight Pool"}),e.jsx("option",{value:"onePocket",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"One Pocket"}),e.jsx("option",{value:"bankPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Bank Pool"})]})]})}),x.matchType==="doublePlay"&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"format1",children:"Format 1 *"}),e.jsxs("select",{id:"format1",name:"format1",value:x.format1||"",onChange:T,required:!0,className:"form-input",children:[e.jsx("option",{value:"",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Select First Format"}),e.jsx("option",{value:"8ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"8-Ball"}),e.jsx("option",{value:"9ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"9-Ball"}),e.jsx("option",{value:"10ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"10-Ball"}),e.jsx("option",{value:"straightPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Straight Pool"}),e.jsx("option",{value:"onePocket",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"One Pocket"}),e.jsx("option",{value:"bankPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Bank Pool"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"format2",children:"Format 2 *"}),e.jsxs("select",{id:"format2",name:"format2",value:x.format2||"",onChange:T,required:!0,className:"form-input",children:[e.jsx("option",{value:"",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Select Second Format"}),e.jsx("option",{value:"8ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"8-Ball"}),e.jsx("option",{value:"9ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"9-Ball"}),e.jsx("option",{value:"10ball",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"10-Ball"}),e.jsx("option",{value:"straightPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Straight Pool"}),e.jsx("option",{value:"onePocket",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"One Pocket"}),e.jsx("option",{value:"bankPool",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Bank Pool"})]})]})]})]}),x.eventType==="other"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDescription",children:"What would you like to have live streamed? *"}),e.jsx("textarea",{id:"eventDescription",name:"eventDescription",value:x.eventDescription||"",onChange:T,rows:"4",placeholder:"Describe your event, tournament, match, or activity that you'd like to have live streamed...",required:!0,className:"form-input",style:{backgroundColor:"rgba(255, 165, 0, 0.1)",color:"#ffa500",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",width:"100%",resize:"vertical"}})]})]}),x.eventType==="tournament"&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"tournamentFormat",children:"Tournament Format"}),e.jsxs("select",{id:"tournamentFormat",name:"tournamentFormat",className:"form-input",children:[e.jsx("option",{value:"",children:"Select format"}),e.jsx("option",{value:"singleElimination",children:"Single Elimination"}),e.jsx("option",{value:"doubleElimination",children:"Double Elimination"}),e.jsx("option",{value:"roundRobin",children:"Round Robin"}),e.jsx("option",{value:"swiss",children:"Swiss System"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"expectedPlayers",children:"Expected Players"}),e.jsx("input",{type:"number",id:"expectedPlayers",name:"expectedPlayers",placeholder:"e.g., 16, 32, 64",className:"form-input"})]})]}),x.eventType==="tournament"&&s!=="legends"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"setupRequirements",children:"Setup Requirements"}),e.jsxs("select",{id:"setupRequirements",name:"setupRequirements",className:"form-input",children:[e.jsx("option",{value:"",children:"Select setup needs"}),e.jsx("option",{value:"basic",children:"Basic streaming (2 cameras)"}),e.jsx("option",{value:"standard",children:"Standard setup (3-4 cameras)"}),e.jsx("option",{value:"premium",children:"Premium setup (5+ cameras, multiple angles)"}),e.jsx("option",{value:"custom",children:"Custom requirements"})]})]}),x.eventType==="privateMatch"&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"matchType",children:"Match Type"}),e.jsxs("select",{id:"matchType",name:"matchType",className:"form-input",children:[e.jsx("option",{value:"",children:"Select match type"}),e.jsx("option",{value:"8ball",children:"8-Ball"}),e.jsx("option",{value:"9ball",children:"9-Ball"}),e.jsx("option",{value:"10ball",children:"10-Ball"}),e.jsx("option",{value:"straightPool",children:"Straight Pool"}),e.jsx("option",{value:"onePocket",children:"One Pocket"}),e.jsx("option",{value:"bankPool",children:"Bank Pool"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"skillLevel",children:"Skill Level"}),e.jsxs("select",{id:"skillLevel",name:"skillLevel",className:"form-input",children:[e.jsx("option",{value:"",children:"Select skill level"}),e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"}),e.jsx("option",{value:"professional",children:"Professional"})]})]})]})]}),x.eventType&&e.jsxs("div",{className:"quote-builder-section",style:{background:"rgba(255, 165, 0, 0.05)",border:"2px solid rgba(255, 165, 0, 0.2)",borderRadius:"10px",padding:"20px",marginBottom:"20px"},children:[e.jsxs("h4",{style:{color:"#ffa500",marginBottom:"15px",fontSize:"1.2rem",textAlign:"center",textShadow:"0 0 10px rgba(255, 165, 0, 0.3)"},children:[" Quote Builder - ",x.eventType==="ladderMatch"?"Ladder Match":x.eventType==="tournament"?"Tournament":x.eventType==="leagueNight"?"Team League Night":x.eventType==="privateMatch"?"Private Match":x.eventType==="onLocationPrivate"?"Private Match - Your Location":x.eventType==="onLocationTournament"?"Tournament - Your Location":x.eventType==="onLocationOther"?"Other Event - Your Location":x.eventType==="onLocation"?"On-Location Event":"Event"]}),x.eventType==="ladderMatch"&&e.jsxs("div",{className:"ladder-match-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Match Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:x.eventDate,onChange:T,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventTime",children:"Start Time *"}),e.jsxs("select",{id:"eventTime",name:"eventTime","data-date":x.eventDate,value:x.eventTime,onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select start time"}),M.map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je))]},`time-picker-${P}-${x.eventDate}`),x.eventDate&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#00ffff",marginTop:"4px",textAlign:"center"},children:[Q(x.eventDate),e.jsx("br",{}),e.jsx("em",{style:{color:"#ccc"},children:"Special times available upon request"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"Fixed Price"}),e.jsx("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"5px",padding:"12px",color:"#ffa500",fontWeight:"bold",fontSize:"1.1rem",textAlign:"center"},children:"$25.00 Per Match"}),e.jsx("input",{type:"hidden",name:"budget",value:"25"})]}),e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"Important Notice"}),e.jsx("div",{style:{background:"rgba(0, 255, 255, 0.08)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"5px",padding:"12px",color:"#00ffff",fontSize:"0.85rem",textAlign:"center",lineHeight:"1.4",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{children:[e.jsx("strong",{children:" Important:"}),e.jsx("br",{}),"Ladder matches involving one or more top 5 players do not need to be scheduled through this form. All top 5 matches are automatically held at Legends and live streamed."]})})]})]})]}),x.eventType==="privateMatch"&&e.jsxs("div",{className:"private-match-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Match Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:x.eventDate,onChange:T,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventTime",children:"Start Time *"}),e.jsxs("select",{id:"eventTime",name:"eventTime","data-date":x.eventDate,value:x.eventTime,onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select start time"}),M.map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je))]},`time-picker-${P}-${x.eventDate}`),x.eventDate&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#00ffff",marginTop:"4px",textAlign:"center"},children:[Q(x.eventDate),e.jsx("br",{}),e.jsx("em",{style:{color:"#ccc"},children:"Special times available upon request"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"numberOfMatches",children:"Estimated Number of Hours *"}),e.jsx("input",{type:"number",id:"numberOfMatches",name:"numberOfMatches",value:x.numberOfMatches,onChange:T,placeholder:"Minimum 2 hours",min:"2",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price Calculation"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"5px",padding:"12px",color:"#ffa500",fontWeight:"bold",fontSize:"1.1rem",textAlign:"center"},children:["$",x.numberOfMatches&&parseInt(x.numberOfMatches)>=2?parseInt(x.numberOfMatches)*30:"60",".00",e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"normal",marginTop:"5px"},children:"$30.00 per hour (2-hour minimum)"})]})]})]})]}),x.eventType==="tournament"&&e.jsxs("div",{className:"tournament-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Tournament Start Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:ue(x.eventDate),onChange:J,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",children:"Tournament End Date *"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",value:ue(x.endDate),onChange:J,required:!0,className:"form-input"})]})]}),x.eventDate&&x.endDate&&e.jsxs("div",{className:"daily-stream-schedule",children:[e.jsx("h5",{style:{color:"#00ffff",marginBottom:"15px",textAlign:"center"},children:" Daily Stream Schedule"}),oe().map((re,je)=>e.jsx("div",{className:"form-row",style:{marginBottom:"15px"},children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{color:"#ffa500",fontWeight:"bold"},children:re.dateString}),e.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center",alignItems:"center",marginTop:"10px"},children:[e.jsx("div",{style:{width:"200px"},children:e.jsxs("select",{name:`day_${je}_startTime`,value:re.startTime||"",onChange:V=>k(je,"startTime",V.target.value),className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",children:"Select start time"}),e.jsx("option",{value:"no-stream",style:{backgroundColor:"#1a1a1a",color:"#ff6b6b"},children:" No Stream"}),$(re.date).map((V,Ee)=>e.jsx("option",{value:V.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:V.label},Ee))]})}),re.startTime!=="no-stream"&&e.jsx("div",{style:{width:"200px"},children:e.jsxs("select",{name:`day_${je}_endTime`,value:re.endTime||"",onChange:V=>k(je,"endTime",V.target.value),className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",children:"Select end time"}),$(re.date).map((V,Ee)=>e.jsx("option",{value:V.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:V.label},Ee))]})})]}),e.jsx("div",{style:{marginTop:"15px"},children:e.jsx("input",{type:"text",name:`day_${je}_description`,value:re.description||"",onChange:V=>k(je,"description",V.target.value),placeholder:"e.g., Qualifying rounds, Finals, Championship matches...",className:"form-input",style:{backgroundColor:"rgba(255, 165, 0, 0.1)",color:"#ffa500",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",maxWidth:"420px"}})})]})},je)),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"10px",padding:"15px",marginTop:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#ffa500",fontWeight:"bold",fontSize:"1.2rem"},children:["Total Stream Hours: ",me()]}),e.jsxs("div",{style:{color:"#ffa500",fontWeight:"bold",fontSize:"1.4rem",marginTop:"8px"},children:["$",Ce(),".00"]}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#ccc",marginTop:"5px"},children:"$30.00 per hour (4-hour minimum)"})]})]})]}),x.eventType==="leagueNight"&&e.jsxs("div",{className:"league-night-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"League Night Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:x.eventDate,onChange:T,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventTime",children:"Start Time *"}),e.jsxs("select",{id:"eventTime",name:"eventTime","data-date":x.eventDate,value:x.eventTime,onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select start time"}),M.map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je))]},`time-picker-${P}-${x.eventDate}`),x.eventDate&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#00ffff",marginTop:"4px",textAlign:"center"},children:[Q(x.eventDate),e.jsx("br",{}),e.jsx("em",{style:{color:"#ccc"},children:"Special times available upon request"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endTime",children:"End Time"}),e.jsx("input",{type:"time",id:"endTime",name:"endTime",value:x.endTime,onChange:T,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Fixed Price"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"5px",padding:"12px",color:"#ffa500",fontWeight:"bold",fontSize:"1.1rem",textAlign:"center"},children:["$100.00",e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"normal",marginTop:"5px"},children:"Flat rate for team league night"})]}),e.jsx("input",{type:"hidden",name:"budget",value:"100"})]})]})]}),x.eventType==="onLocationPrivate"&&e.jsxs("div",{className:"player-names-section",style:{background:"rgba(255, 165, 0, 0.05)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h5",{style:{color:"#ffa500",marginBottom:"10px",fontSize:"1rem",textAlign:"center",textShadow:"0 0 8px rgba(255, 165, 0, 0.3)"},children:" Player Names"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player1",children:"Player 1 Name *"}),e.jsx("input",{type:"text",id:"player1",name:"player1",value:x.player1||"",onChange:T,required:!0,placeholder:"First player's name",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"player2",children:"Player 2 Name *"}),e.jsx("input",{type:"text",id:"player2",name:"player2",value:x.player2||"",onChange:T,required:!0,placeholder:"Second player's name",className:"form-input"})]})]})]}),x.eventType==="onLocationTournament"&&e.jsxs("div",{className:"on-location-tournament-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Tournament Start Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:ue(x.eventDate),onChange:J,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",children:"Tournament End Date *"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",value:ue(x.endDate),onChange:J,required:!0,className:"form-input"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"setupDate",children:"Location Setup Date"}),e.jsx("input",{type:"date",id:"setupDate",name:"setupDate",value:ue(x.setupDate),onChange:J,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Setup Date Notice"}),e.jsx("div",{style:{background:"rgba(255, 165, 0, 0.08)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"8px",padding:"12px 15px",color:"#ffa500",fontSize:"0.85rem",textAlign:"center",lineHeight:"1.4",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{children:[e.jsx("strong",{children:" $50/day charge"}),e.jsx("br",{}),"for equipment on location",e.jsx("br",{}),"without streaming",e.jsx("br",{}),e.jsx("em",{style:{fontSize:"0.75rem",color:"#ffcc80"},children:"Allow at least 4 hours for setup"})]})})]})]}),x.eventDate&&x.endDate&&e.jsxs("div",{className:"daily-stream-schedule",children:[e.jsx("h5",{style:{color:"#00ffff",marginBottom:"15px",textAlign:"center"},children:" Daily Stream Schedule"}),oe().map((re,je)=>e.jsx("div",{className:"form-row",style:{marginBottom:"15px"},children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{color:"#ffa500",fontWeight:"bold"},children:re.dateString}),e.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center",alignItems:"center",marginTop:"10px"},children:[e.jsx("div",{style:{width:"200px"},children:e.jsxs("select",{name:`day_${je}_startTime`,value:re.startTime||"",onChange:V=>k(je,"startTime",V.target.value),className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",children:"Select start time"}),e.jsx("option",{value:"no-stream",style:{backgroundColor:"#1a1a1a",color:"#ff6b6b"},children:" No Stream"}),$(re.date).map((V,Ee)=>e.jsx("option",{value:V.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:V.label},Ee))]})}),re.startTime!=="no-stream"&&e.jsx("div",{style:{width:"200px"},children:e.jsxs("select",{name:`day_${je}_endTime`,value:re.endTime||"",onChange:V=>k(je,"endTime",V.target.value),className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",children:"Select end time"}),$(re.date).map((V,Ee)=>e.jsx("option",{value:V.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:V.label},Ee))]})})]}),re.startTime&&re.startTime!=="no-stream"&&e.jsx("div",{style:{fontSize:"0.8rem",color:"#ffa500",marginTop:"8px",textAlign:"center",fontWeight:"bold",background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"4px",padding:"6px 8px"},children:" 2 Hour Minimum Per Stream Day"}),e.jsx("div",{style:{marginTop:"15px"},children:e.jsx("input",{type:"text",name:`day_${je}_description`,value:re.description||"",onChange:V=>k(je,"description",V.target.value),placeholder:"e.g., Qualifying rounds, Finals, Championship matches...",className:"form-input",style:{backgroundColor:"rgba(255, 165, 0, 0.1)",color:"#ffa500",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",maxWidth:"420px"}})})]})},je)),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"10px",padding:"15px",marginTop:"20px",textAlign:"center"},children:[e.jsx("div",{style:{color:"#ffa500",fontSize:"1.1rem",fontWeight:"bold"},children:"Custom Quote Required"}),e.jsx("div",{style:{color:"#e0f7fa",fontSize:"0.9rem",marginTop:"8px"},children:"Pricing based on tournament duration, setup requirements, and travel distance"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueName",children:"Venue Name *"}),e.jsx("input",{type:"text",id:"venueName",name:"venueName",value:x.venueName||"",onChange:T,required:!0,placeholder:"e.g., Legends Brews & Cues, Private Residence, Community Center",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueCity",children:"City *"}),e.jsx("input",{type:"text",id:"venueCity",name:"venueCity",value:x.venueCity||"",onChange:T,required:!0,placeholder:"City",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueState",children:"State *"}),e.jsx("input",{type:"text",id:"venueState",name:"venueState",value:x.venueState||"",onChange:T,required:!0,placeholder:"e.g., CO, CA, TX",className:"form-input"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.08)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"8px",padding:"15px 20px",color:"#ffa500",fontSize:"0.9rem",textAlign:"center",lineHeight:"1.4",margin:"15px 0"},children:[e.jsx("strong",{children:" Venue Approval Required:"})," We must have venue approval before confirming any on-location bookings. Please ensure the venue is aware of your request."]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{htmlFor:"venueAwareness",children:"Venue Awareness *"}),e.jsxs("select",{id:"venueAwareness",name:"venueAwareness",value:x.venueAwareness||"",onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Select option"}),e.jsx("option",{value:"yes",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Yes - Venue has approved the booking"}),e.jsx("option",{value:"no",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"No - Venue is not yet aware"}),e.jsx("option",{value:"pending",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Pending - Working on getting approval"})]})]}),e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{htmlFor:"venueContactName",children:"Venue Contact Name"}),e.jsx("input",{type:"text",id:"venueContactName",name:"venueContactName",value:x.venueContactName||"",onChange:T,placeholder:"Name of venue contact person",className:"form-input"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"numberOfCameras",children:"Number of Cameras *"}),e.jsxs("select",{id:"numberOfCameras",name:"numberOfCameras",value:x.numberOfCameras||"",onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Select number of cameras"}),e.jsx("option",{value:"2",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"2 Cameras ($100 setup, $50/hour)"}),e.jsx("option",{value:"3",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"3 Cameras ($120 setup, $60/hour)"}),e.jsx("option",{value:"4",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"4 Cameras ($140 setup, $70/hour)"}),e.jsx("option",{value:"5",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"5 Cameras ($160 setup, $80/hour)"})]})]})}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"What's Included"}),e.jsxs("div",{style:{background:"rgba(0, 255, 255, 0.05)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",color:"#e0f7fa",fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Mobile streaming setup"})," - Professional cameras and equipment"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Travel"})," - We come to your location"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Live commentary"})," - Unfiltered, entertaining coverage"]}),e.jsxs("div",{children:[" ",e.jsx("strong",{children:"Branding"})," - Cueless in the Booth graphics + custom branding options"]})]})]}),e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"Camera Pricing"}),e.jsx("div",{style:{background:"rgba(0, 255, 255, 0.05)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",color:"#e0f7fa",fontSize:"0.9rem",lineHeight:"1.6",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{textAlign:"center"},children:x.numberOfCameras?(()=>{const re=oe(),je=x.setupDate,V=re.filter(ne=>ne.startTime==="no-stream"&&ne.date!==je).length,{totalSetupFee:Ee,hourlyRate:F,totalPrice:ae,hours:I,noStreamCost:X}=H(x.numberOfCameras,me(),V),fe=I>0?`${I} hour${I!==1?"s":""}`:"2-hour minimum per day";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:"bold",color:"#ffa500",fontSize:"1.2rem",marginBottom:"10px"},children:["Total: $",ae.toFixed(2)]}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#e0f7fa",marginBottom:"8px"},children:I>0?`${fe} of streaming`:"2-hour minimum per day"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"6px",padding:"8px",fontSize:"0.8rem",textAlign:"left"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",marginBottom:"4px"},children:"Price Breakdown:"}),e.jsxs("div",{style:{marginBottom:"2px"},children:[" Setup Fee: $",Ee.toFixed(2)," (one-time)"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[" Hourly Rate: $",F.toFixed(2),"/hour  ",I," hours = $",(F*I).toFixed(2)]}),X>0&&e.jsxs("div",{style:{marginBottom:"2px"},children:[" Equipment on location: $",X.toFixed(2)," ($",(X/V).toFixed(0),"/day)"]}),e.jsxs("div",{style:{marginTop:"4px",fontWeight:"bold",color:"#00ff41"},children:["Total: $",ae.toFixed(2)]})]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"#ffcc80",marginTop:"6px"},children:["Setup includes 2 cameras + $",(Ee-100).toFixed(0)," for ",Math.max(0,x.numberOfCameras-2)," additional camera",Math.max(0,x.numberOfCameras-2)!==1?"s":""]})]})})():e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",fontSize:"1.1rem",marginBottom:"10px"},children:"Tournament Pricing"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"6px",padding:"10px",fontSize:"0.8rem",textAlign:"left"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",marginBottom:"6px"},children:"Base Pricing:"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Setup Fee: $100 (includes 2 cameras)"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Additional cameras: +$20 setup each"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Hourly rate: $50/hour base"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Additional cameras: +$10/hour each"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Equipment on location: $50/day"}),e.jsx("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#ffcc80",fontStyle:"italic"},children:"Select cameras and dates to see your quote"})]})]})})})]})]})]}),(x.eventType==="onLocation"||x.eventType==="onLocationPrivate"||x.eventType==="onLocationOther")&&e.jsxs("div",{className:"on-location-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Event Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:ue(x.eventDate),onChange:J,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventTime",children:"Start Time *"}),e.jsxs("select",{id:"eventTime",name:"eventTime",value:x.eventTime,onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select start time"}),z().map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je))]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#00ffff",marginTop:"4px",textAlign:"center"},children:["Available times: 10:00 AM - 7:00 PM",e.jsx("br",{}),e.jsx("em",{style:{color:"#ccc"},children:"Special times available upon request"})]})]})]}),e.jsxs("div",{className:"form-row",children:[x.eventType==="onLocationPrivate"?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"isMultiDay",children:"Is this a multi-day event?"}),e.jsxs("select",{id:"isMultiDay",name:"isMultiDay",value:x.isMultiDay?"true":"false",onChange:re=>T({target:{name:"isMultiDay",value:re.target.value==="true"}}),className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"false",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"No - Single Day"}),e.jsx("option",{value:"true",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Yes - Multi-Day"})]})]}):e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",children:"End Date"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",value:x.endDate,onChange:T,className:"form-input"})]}),x.eventType==="onLocationPrivate"&&x.isMultiDay&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endDate",children:"End Date *"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",value:x.endDate,onChange:T,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"endTime",children:"End Time"}),e.jsxs("select",{id:"endTime",name:"endTime",value:x.endTime,onChange:T,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select end time (optional)"}),x.eventType==="onLocationPrivate"?W(x.eventTime).map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je)):z().map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:re.label},je))]}),x.eventType==="onLocationPrivate"&&e.jsx("div",{style:{fontSize:"0.8rem",color:"#ffa500",marginTop:"6px",textAlign:"center",fontWeight:"bold",background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"4px",padding:"6px 8px"},children:" 2 Hour Minimum Required"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueName",children:"Venue Name *"}),e.jsx("input",{type:"text",id:"venueName",name:"venueName",value:x.venueName||"",onChange:T,required:!0,placeholder:"e.g., Legends Brews & Cues, Private Residence, Community Center",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"numberOfMatches",children:"Expected Number of Matches"}),e.jsxs("select",{id:"numberOfMatches",name:"numberOfMatches",value:x.numberOfMatches,onChange:T,className:"form-input",children:[e.jsx("option",{value:"",children:"Select range"}),e.jsx("option",{value:"1-5",children:"1-5 matches"}),e.jsx("option",{value:"6-10",children:"6-10 matches"}),e.jsx("option",{value:"11-20",children:"11-20 matches"}),e.jsx("option",{value:"20+",children:"20+ matches"}),e.jsx("option",{value:"all-day",children:"All day event"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueCity",children:"City *"}),e.jsx("input",{type:"text",id:"venueCity",name:"venueCity",value:x.venueCity||"",onChange:T,required:!0,placeholder:"e.g., Colorado Springs, Denver, Pueblo",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueState",children:"State *"}),e.jsx("input",{type:"text",id:"venueState",name:"venueState",value:x.venueState||"",onChange:T,required:!0,placeholder:"e.g., CO, CA, TX",className:"form-input"})]})]}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.08)",border:"1px solid rgba(255, 165, 0, 0.2)",borderRadius:"8px",padding:"15px 20px",color:"#ffa500",fontSize:"0.9rem",textAlign:"center",lineHeight:"1.4",margin:"15px 0"},children:[e.jsx("strong",{children:" Venue Approval Required:"})," We must have venue approval before confirming any on-location bookings. Please ensure the venue is aware of your request."]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{htmlFor:"venueAwareness",children:"Venue Awareness *"}),e.jsxs("select",{id:"venueAwareness",name:"venueAwareness",value:x.venueAwareness||"",onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Select option"}),e.jsx("option",{value:"yes",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Yes - Venue has approved the booking"}),e.jsx("option",{value:"no",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"No - Venue is not yet aware"}),e.jsx("option",{value:"pending",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Pending - Working on getting approval"})]})]}),e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{htmlFor:"venueContactName",children:"Venue Contact Name"}),e.jsx("input",{type:"text",id:"venueContactName",name:"venueContactName",value:x.venueContactName||"",onChange:T,placeholder:"Name of venue contact person",className:"form-input"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueContactPhone",children:"Venue Contact Phone"}),e.jsx("input",{type:"tel",id:"venueContactPhone",name:"venueContactPhone",value:x.venueContactPhone||"",onChange:T,placeholder:"(555) 123-4567",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"venueContactEmail",children:"Venue Contact Email"}),e.jsx("input",{type:"email",id:"venueContactEmail",name:"venueContactEmail",value:x.venueContactEmail||"",onChange:T,placeholder:"venue@example.com",className:"form-input"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"numberOfCameras",children:"Number of Cameras *"}),e.jsxs("select",{id:"numberOfCameras",name:"numberOfCameras",value:x.numberOfCameras||"",onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%"},children:[e.jsx("option",{value:"",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"Select number of cameras"}),e.jsx("option",{value:"1",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"1 Camera ($50 setup, $50/hour)"}),e.jsx("option",{value:"2",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"2 Cameras ($60 setup, $55/hour)"}),e.jsx("option",{value:"3",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"3 Cameras ($70 setup, $60/hour)"}),e.jsx("option",{value:"4",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"4 Cameras ($80 setup, $65/hour)"}),e.jsx("option",{value:"5",style:{backgroundColor:"#1a1a1a",color:"#e0f7fa"},children:"5 Cameras ($90 setup, $70/hour)"})]})]})}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"What's Included"}),e.jsx("div",{style:{background:"rgba(0, 255, 255, 0.08)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"5px",padding:"12px",color:"#00ffff",fontSize:"0.85rem",textAlign:"center",lineHeight:"1.4",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{children:[e.jsx("strong",{children:" Mobile Setup:"}),e.jsx("br",{})," Full streaming equipment",e.jsx("br",{})," Travel to your location",e.jsx("br",{})," Live commentary",e.jsx("br",{})," Cueless in the Booth graphics"]})})]}),e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"Camera Pricing"}),e.jsx("div",{style:{background:"rgba(0, 255, 255, 0.05)",border:"1px solid rgba(0, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",color:"#e0f7fa",fontSize:"0.9rem",lineHeight:"1.6",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#00ffff"},children:"$50/hour (includes 1 camera)"}),e.jsx("div",{style:{fontSize:"0.8rem",marginTop:"5px"},children:"Additional cameras: $10/hour each"}),e.jsx("div",{style:{fontSize:"0.8rem",marginTop:"3px"},children:"Up to 5 cameras maximum"})]})})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",style:{flex:"1"},children:[e.jsx("label",{children:"Pricing Information"}),e.jsx("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"5px",padding:"12px",color:"#ffa500",fontWeight:"bold",fontSize:"1.1rem",textAlign:"center"},children:x.eventType==="onLocationPrivate"?x.numberOfCameras?(()=>{const{totalSetupFee:re,hourlyRate:je,totalPrice:V,hours:Ee}=Y(x.eventTime,x.endTime,x.numberOfCameras),F=Ee>0?`${Ee} hour${Ee!==1?"s":""}`:"2-hour example";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:"bold",color:"#ffa500",fontSize:"1.2rem",marginBottom:"10px"},children:["Total: $",V.toFixed(2)]}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#e0f7fa",marginBottom:"8px"},children:Ee>0?`${F} of streaming`:"2-hour example"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"6px",padding:"8px",fontSize:"0.8rem",textAlign:"left"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",marginBottom:"4px"},children:"Price Breakdown:"}),e.jsxs("div",{style:{marginBottom:"2px"},children:[" Setup Fee: $",re.toFixed(2)," (one-time)"]}),e.jsxs("div",{style:{marginBottom:"2px"},children:[" Hourly Rate: $",je.toFixed(2),"/hour  ",Ee," hours = $",(je*Ee).toFixed(2)]}),e.jsxs("div",{style:{marginTop:"4px",fontWeight:"bold",color:"#00ff41"},children:["Total: $",V.toFixed(2)]})]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"#ffcc80",marginTop:"6px"},children:["Setup includes 1 camera + $",(re-50).toFixed(0)," for ",Math.max(0,x.numberOfCameras-1)," additional camera",Math.max(0,x.numberOfCameras-1)!==1?"s":""]})]})})():e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",fontSize:"1.1rem",marginBottom:"10px"},children:"Private Match Pricing"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"6px",padding:"10px",fontSize:"0.8rem",textAlign:"left"},children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ffa500",marginBottom:"6px"},children:"Base Pricing:"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Setup Fee: $50 (includes 1 camera)"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Additional cameras: +$10 setup each"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Hourly rate: $50/hour base"}),e.jsx("div",{style:{marginBottom:"3px"},children:" Additional cameras: +$5/hour each"}),e.jsx("div",{style:{marginTop:"6px",fontSize:"0.7rem",color:"#ffcc80",fontStyle:"italic"},children:"Select cameras and time to see your quote"})]})]}):"Custom Quote Required"})]})})]}),x.eventType==="other"&&e.jsxs("div",{className:"other-event-quote",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventDate",children:"Event Date *"}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:ue(x.eventDate),onChange:J,required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"eventTime",children:"Start Time *"}),e.jsxs("select",{id:"eventTime",name:"eventTime","data-date":x.eventDate,value:x.eventTime,onChange:T,required:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#e0f7fa",border:"1px solid rgba(0, 255, 255, 0.3)",borderRadius:"8px",padding:"0.75rem",fontSize:"1rem",textAlign:"center",width:"100%",minWidth:"180px"},children:[e.jsx("option",{value:"",children:"Select start time"}),M.map((re,je)=>e.jsx("option",{value:re.value,style:{backgroundColor:"#000000",color:"#e0f7fa"},children:re.label},je))]},`time-picker-${P}-${x.eventDate}`),x.eventDate&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#00ffff",marginTop:"4px",textAlign:"center"},children:[Q(x.eventDate),e.jsx("br",{}),e.jsx("em",{style:{color:"#ccc"},children:"Special times available upon request"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"budget",children:"Budget Range (Optional)"}),e.jsxs("select",{id:"budget",name:"budget",value:x.budget,onChange:T,className:"form-input",children:[e.jsx("option",{value:"",children:"Select budget range"}),e.jsx("option",{value:"under-100",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Under $100"}),e.jsx("option",{value:"100-200",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"$100 - $200"}),e.jsx("option",{value:"200-300",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"$200 - $300"}),e.jsx("option",{value:"300-500",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"$300 - $500"}),e.jsx("option",{value:"500-plus",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"$500+"}),e.jsx("option",{value:"custom",style:{backgroundColor:"#000000",color:"#e0f7fa"},children:"Let's discuss"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Next Steps"}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"5px",padding:"12px",color:"#ffa500",fontWeight:"bold",fontSize:"1.1rem",textAlign:"center"},children:["We'll Contact You",e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"normal",marginTop:"5px"},children:"For a custom quote"})]})]})]})]})]}),x.eventType&&!x.eventType.startsWith("onLocation")&&e.jsxs("div",{style:{marginBottom:"20px"},children:[x.eventType==="ladderMatch"||s==="legends"?e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("label",{htmlFor:"location",style:{textAlign:"center",display:"block",marginBottom:"8px",color:"#00ffff",fontSize:"0.9rem",fontWeight:"500"},children:"Location"}),e.jsx("input",{type:"text",id:"location",name:"location",value:"Legends Brews & Cues",readOnly:!0,className:"form-input",style:{backgroundColor:"rgba(0, 255, 255, 0.1)",color:"#00ffff",cursor:"not-allowed",opacity:"0.9",textAlign:"center",fontWeight:"500",width:"100%",maxWidth:"400px",padding:"12px",fontSize:"1rem"}})]}):e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"location",children:"Location *"}),e.jsx("input",{type:"text",id:"location",name:"location",value:x.location,onChange:T,placeholder:"e.g., Legends Brews & Cues, Private Residence",required:!0,className:"form-input"})]})}),x.eventType!=="ladderMatch"&&s!=="legends"&&!x.eventType.startsWith("onLocation")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"numberOfMatches",children:"Number of Matches/Hours"}),e.jsx("input",{type:"text",id:"numberOfMatches",name:"numberOfMatches",value:x.numberOfMatches,onChange:T,placeholder:"e.g., 2 matches, 3 hours",className:"form-input"})]})]}),x.eventType&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"specialRequests",children:"Special Requests or Additional Info"}),e.jsx("textarea",{id:"specialRequests",name:"specialRequests",value:x.specialRequests,onChange:T,rows:"3",placeholder:"Any special requests, equipment needs, or additional information...",className:"form-input"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",name:"agreeToTerms",checked:x.agreeToTerms,onChange:T,required:!0,className:"form-checkbox"}),"I understand and acknowledge that Cueless in the Booth provides unfiltered commentary and may use adult language during live streams."]})}),x.eventType&&e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[e.jsx("button",{type:"submit",className:"submit-button",disabled:o||!ve(),style:{flex:1,opacity:!ve()||o?.6:1,cursor:!ve()||o?"not-allowed":"pointer"},children:o?"Submitting...":ve()?"SUBMIT BOOKING REQUEST":"Complete Required Fields"}),e.jsx("button",{type:"button",onClick:()=>{const re={id:"REQ123",name:x.name||"John Doe",email:x.email||"john@example.com",phone:x.phone||"555-1234",eventType:x.eventType,eventDate:x.eventDate||"2025-09-25",endDate:x.endDate||"",eventTime:x.eventTime||"18:00",endTime:x.endTime||"",location:x.location||"Legends Brews & Cues",numberOfMatches:x.numberOfMatches||"",playerNames:x.playerNames||"",player1:x.player1||"John Doe",player2:x.player2||"Jane Smith",teamName:x.teamName||"Shark Attack",opponentTeamName:x.opponentTeamName||"Ball Busters",leagueName:x.leagueName||"USAPL",matchType:x.matchType||"single",format1:x.format1||"8ball",format2:x.format2||"",eventDescription:x.eventDescription||"Live streaming a charity pool tournament with 16 players, multiple tables, and celebrity commentary",tournamentDirector:x.tournamentDirector||"Mike Johnson",assistantDirector:x.assistantDirector||"Sarah Wilson",tournamentName:x.tournamentName||"Legends Championship",budget:x.budget||"100",specialRequests:x.specialRequests||"",agreeToTerms:!0,submittedAt:new Date().toLocaleString()};p(re)},style:{padding:"12px 16px",fontSize:"0.9rem",fontWeight:"bold",borderRadius:"8px",border:"none",cursor:"pointer",background:"linear-gradient(135deg, #ffa500, #ff8c00)",color:"#000",boxShadow:"0 4px 15px rgba(255, 165, 0, 0.3)",transition:"all 0.3s ease",whiteSpace:"nowrap"},onMouseOver:re=>{re.target.style.transform="translateY(-2px)",re.target.style.boxShadow="0 6px 20px rgba(255, 165, 0, 0.4)"},onMouseOut:re=>{re.target.style.transform="translateY(0)",re.target.style.boxShadow="0 4px 15px rgba(255, 165, 0, 0.3)"},children:" Preview"})]}),h&&e.jsxs("div",{className:"success-page",style:{background:"rgba(0, 255, 0, 0.1)",border:"2px solid rgba(0, 255, 0, 0.3)",borderRadius:"12px",padding:"25px",marginTop:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:""}),e.jsx("h3",{style:{color:"#00ff00",fontSize:"1.8rem",margin:"0 0 10px 0",textShadow:"0 0 10px rgba(0, 255, 0, 0.5)"},children:"Booking Confirmed!"}),e.jsx("p",{style:{color:"#ccc",fontSize:"1rem",margin:"0"},children:"Your Cueless streaming request has been submitted successfully"})]}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"20px",marginBottom:"20px",textAlign:"left"},children:[e.jsx("h4",{style:{color:"#00ffff",margin:"0 0 15px 0",textAlign:"center",fontSize:"1.2rem"},children:" Booking Details"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Booking ID:"}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#e0f7fa",fontFamily:"monospace"},children:["#",h.id]})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Event Type:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:be(h.eventType)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Date:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:Ae(h.eventDate)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Time:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:O(h.eventTime)})]}),h.endDate&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"End Date:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:Ae(h.endDate)})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Location:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa"},children:h.location})]})]}),h.eventType==="ladderMatch"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Players:"}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#e0f7fa"},children:[h.player1," vs ",h.player2]})]}),h.eventType==="tournament"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Tournament:"})," ",h.tournamentName,e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Director:"})," ",h.tournamentDirector,h.assistantDirector&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Assistant:"})," ",h.assistantDirector]})]}),h.eventType==="leagueNight"&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Teams:"})," ",h.teamName," vs ",h.opponentTeamName,e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"League:"})," ",h.leagueName,h.matchType&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{style:{color:"#ffa500"},children:"Format:"})," ",h.format1]})]}),h.eventType==="other"&&h.eventDescription&&e.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid rgba(255, 165, 0, 0.3)"},children:[e.jsx("strong",{style:{color:"#ffa500"},children:"Event Description:"}),e.jsx("br",{}),e.jsx("span",{style:{color:"#e0f7fa",fontStyle:"italic"},children:h.eventDescription})]})]}),e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",borderRadius:"8px",padding:"20px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#ffa500",margin:"0 0 15px 0",textAlign:"center",fontSize:"1.2rem"},children:" What Happens Next?"}),e.jsxs("div",{style:{color:"#e0f7fa",fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"1."})," We'll review your booking request as soon as possible"]}),e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"2."})," We'll contact you to confirm details and discuss logistics"]}),e.jsxs("p",{style:{margin:"0 0 10px 0"},children:[e.jsx("strong",{children:"3."})," We'll send you a final confirmation with all the details"]}),e.jsxs("p",{style:{margin:"0"},children:[e.jsx("strong",{children:"4."})," Show up and get ready to be live streamed! "]})]})]}),e.jsxs("div",{style:{background:"rgba(0, 255, 255, 0.1)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#00ffff",margin:"0 0 10px 0",fontSize:"1.1rem"},children:" Questions? Contact Us"}),e.jsxs("div",{style:{color:"#e0f7fa",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{margin:"0 0 5px 0"},children:[e.jsx("strong",{children:"Email:"})," cuelessinthebooth@gmail.com"]}),e.jsxs("p",{style:{margin:"0",fontSize:"0.8rem",color:"#ccc"},children:["Reference your booking ID: #",h.id]})]})]}),e.jsx("button",{onClick:Oe,style:{background:"linear-gradient(135deg, #00ff00, #00cc00)",color:"#000",border:"none",borderRadius:"8px",padding:"12px 30px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(0, 255, 0, 0.3)",transition:"all 0.3s ease"},onMouseOver:re=>{re.target.style.transform="translateY(-2px)",re.target.style.boxShadow="0 6px 20px rgba(0, 255, 0, 0.4)"},onMouseOut:re=>{re.target.style.transform="translateY(0)",re.target.style.boxShadow="0 4px 15px rgba(0, 255, 0, 0.3)"},children:" Close & Return to Home"})]}),l&&e.jsx("div",{className:"success-message",children:l}),d&&e.jsx("div",{className:"error-message",children:d})]})})]})},cee=(n,t={})=>{const r=n.trim().split(`
`),s=r[0].split(",").map(i=>i.trim().replace(/"/g,"")),a={position:"Position",firstName:"First Name",lastName:"Last Name",name:"Name",email:"Email",fargoRate:"FargoRate",...t},o=[];for(let i=1;i<r.length;i++){const l=r[i].split(",").map(d=>d.trim().replace(/"/g,"")),c={};s.forEach((d,u)=>{const h=l[u];let p=null;for(const[g,f]of Object.entries(a))if(d.toLowerCase()===f.toLowerCase()){p=g;break}if(p)switch(p){case"position":case"fargoRate":c[p]=parseInt(h)||0;break;case"firstName":case"lastName":case"email":c[p]=h||"";break;case"name":const g=h.split(" ");c.firstName=g[0]||"",c.lastName=g.slice(1).join(" ")||"";break;default:c[p]=h}}),c.email&&o.push(c)}return o},dee=()=>`Position,Name,Email,FargoRate
1,John Doe,john@example.com,485
2,Jane Smith,jane@example.com,472
3,Bob Johnson,bob@example.com,458`,uee=n=>{const t={valid:[],errors:[]};return n.forEach((r,s)=>{const a=[];r.email||a.push("Email is required"),!r.firstName&&!r.name&&a.push("Name is required"),r.email&&!hee(r.email)&&a.push("Invalid email format"),r.fargoRate&&(r.fargoRate<0||r.fargoRate>9999)&&a.push("FargoRate must be between 0 and 9999"),a.length>0?t.errors.push({row:s+1,player:r,errors:a}):t.valid.push(r)}),t},hee=n=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n);const pee=({userEmail:n,userPin:t})=>{var Oe,Ze,et,re,je,V,Ee,F,ae;const r="front-range-pool-hub",[s,a]=y.useState("499-under"),[o,i]=y.useState([]),[l,c]=y.useState(""),[d,u]=y.useState("json"),[h,p]=y.useState(!1),[g,f]=y.useState(""),[m,v]=y.useState(!1),[b,w]=y.useState({player1Id:"",player1Name:"",player1Position:"",player2Id:"",player2Name:"",player2Position:"",winnerId:"",score:"",matchDate:new Date().toISOString().split("T")[0],matchFormat:"best-of-5",location:"",notes:""}),[x,j]=y.useState([]),[S,_]=y.useState(!1),[C,N]=y.useState(null),[M,E]=y.useState(!1),[P,D]=y.useState({}),[T,A]=y.useState(!1),[k,R]=y.useState(null),U=[{name:"499-under",displayName:"499 & Under"},{name:"500-549",displayName:"500-549"},{name:"550-plus",displayName:"550+"}];y.useEffect(()=>{z()},[s]);const z=async()=>{try{p(!0);const I=await fetch(`${Ie}/api/ladder/admin/${s}`);if(I.ok){const X=await I.json();i(X)}else f("Failed to load ladder data")}catch(I){console.error("Error loading ladder data:",I),f("Error loading ladder data")}finally{p(!1)}},$=async()=>{try{p(!0),f("");let I;if(d==="csv")try{const ne=cee(l),ye=uee(ne);if(ye.errors.length>0){f(`Validation errors found: ${ye.errors.length} errors. Please check your data.`);return}I=ye.valid}catch{f("Invalid CSV format. Please check your data.");return}else try{I=JSON.parse(l)}catch{f("Invalid JSON format. Please check your data.");return}const X=await fetch(`${Ie}/api/ladder/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ladderData:I,ladderName:s})}),fe=await X.json();X.ok?(f(`Import completed! Imported: ${fe.results.imported}, Skipped: ${fe.results.skipped}`),c(""),z()):f(`Import failed: ${fe.error}`)}catch(I){console.error("Error importing data:",I),f("Error importing data")}finally{p(!1)}},W=async()=>{try{p(!0),f("");const I=o.map((ne,ye)=>({email:ne.email,position:ye+1})),X=await fetch(`${Ie}/api/ladder/update-positions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ladderName:s,positions:I})}),fe=await X.json();X.ok?(f(`Positions updated! Updated: ${fe.results.updated}`),z()):f(`Update failed: ${fe.error}`)}catch(I){console.error("Error updating positions:",I),f("Error updating positions")}finally{p(!1)}},Y=()=>{const I=[["Position","Name","Email","FargoRate","Status"],...o.map(ye=>[ye.position,`${ye.firstName} ${ye.lastName}`,ye.email,ye.fargoRate,ye.isActive?"Active":"Inactive"])].map(ye=>ye.join(",")).join(`
`),X=new Blob([I],{type:"text/csv"}),fe=window.URL.createObjectURL(X),ne=document.createElement("a");ne.href=fe,ne.download=`${s}-ladder.csv`,ne.click(),window.URL.revokeObjectURL(fe)},Q=()=>{const I=`${Ie.replace("/api","")}/static/fargo-updater.html`;window.open(I,"_blank","width=1200,height=800,scrollbars=yes,resizable=yes")},H=I=>{const{name:X,value:fe}=I.target;w(ne=>({...ne,[X]:fe}))},ue=I=>{const X=I.target.value,fe=o.find(ne=>ne._id===X);fe&&w(ne=>({...ne,player1Id:X,player1Name:`${fe.firstName} ${fe.lastName}`,player1Position:fe.position}))},J=I=>{const X=I.target.value,fe=o.find(ne=>ne._id===X);fe&&w(ne=>({...ne,player2Id:X,player2Name:`${fe.firstName} ${fe.lastName}`,player2Position:fe.position}))},be=I=>{const X=I.target.value;w(fe=>({...fe,winnerId:X}))},Ae=async I=>{if(I.preventDefault(),!b.player1Id||!b.player2Id||!b.winnerId){f("Please select both players and a winner");return}if(b.player1Id===b.player2Id){f("Players must be different");return}try{p(!0),f("");const X=await fetch(`${Ie}/api/ladder/${r}/ladders/${s}/matches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...b,matchDate:new Date(b.matchDate).toISOString()})}),fe=await X.json();X.ok?(f(`Match result recorded successfully! ${fe.message}`),v(!1),w({player1Id:"",player1Name:"",player1Position:"",player2Id:"",player2Name:"",player2Position:"",winnerId:"",score:"",matchDate:new Date().toISOString().split("T")[0],matchFormat:"best-of-5",location:"",notes:""}),z()):f(`Match recording failed: ${fe.message||fe.error}`)}catch(X){console.error("Error recording match result:",X),f("Error recording match result")}finally{p(!1)}},O=async()=>{try{p(!0);const I=await fetch(`${Ie}/api/ladder/${r}/ladders/${s}/matches`);if(I.ok){const X=await I.json();j(X.matches||[])}else f("Failed to load match history")}catch(I){console.error("Error loading match history:",I),f("Error loading match history")}finally{p(!1)}},oe=async I=>{var X;try{const fe=await fetch(`${Ie}/api/ladder/${r}/ladders/${s}/matches/${I.id}`);if(fe.ok){const ne=await fe.json();N(ne.match),D({winner:((X=ne.match.winner)==null?void 0:X.id)||"",score:ne.match.score||"",notes:ne.match.notes||"",adminNotes:ne.match.adminNotes||"",completedDate:ne.match.completedDate?new Date(ne.match.completedDate).toISOString().split("T")[0]:"",scheduledDate:ne.match.scheduledDate?new Date(ne.match.scheduledDate).toISOString().split("T")[0]:"",venue:ne.match.venue||"",entryFee:ne.match.entryFee||0,raceLength:ne.match.raceLength||5,gameType:ne.match.gameType||"8-ball",tableSize:ne.match.tableSize||"7-foot",status:ne.match.status||"scheduled"}),E(!0)}else f("Failed to load match details")}catch(fe){console.error("Error loading match details:",fe),f("Error loading match details")}},me=I=>{R(I),A(!0)},Ce=async()=>{if(k)try{p(!0);const I=await fetch(`${Ie}/api/ladder/${r}/ladders/${s}/matches/${k.id}`,{method:"DELETE"});if(I.ok)f("Match deleted successfully"),await O(),await z();else{const X=await I.json();f(`Failed to delete match: ${X.message||"Unknown error"}`)}}catch(I){console.error("Error deleting match:",I),f("Error deleting match")}finally{p(!1),A(!1),R(null)}},ve=async I=>{if(I.preventDefault(),!!C)try{p(!0);const X=await fetch(`${Ie}/api/ladder/${r}/ladders/${s}/matches/${C.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(X.ok)f("Match updated successfully"),E(!1),N(null),await O(),await z();else{const fe=await X.json();f(`Failed to update match: ${fe.message||"Unknown error"}`)}}catch(X){console.error("Error updating match:",X),f("Error updating match")}finally{p(!1)}},De=I=>{const{name:X,value:fe}=I.target;D(ne=>({...ne,[X]:fe}))};return e.jsxs("div",{className:"ladder-management",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"Ladder Management"}),e.jsx("p",{children:"Import and manage ladder data from Google Sheets"})]}),e.jsxs("div",{className:"ladder-selector",children:[e.jsx("label",{children:"Select Ladder:"}),e.jsx("select",{value:s,onChange:I=>a(I.target.value),children:U.map(I=>e.jsx("option",{value:I.name,children:I.displayName},I.name))})]}),e.jsxs("div",{className:"import-section",children:[e.jsx("h3",{children:"Import Data from Google Sheets"}),e.jsxs("div",{className:"import-instructions",children:[e.jsx("p",{children:e.jsx("strong",{children:"Instructions:"})}),e.jsxs("ol",{children:[e.jsx("li",{children:"Export your Google Sheet as CSV"}),e.jsx("li",{children:"Choose your import format below"}),e.jsx("li",{children:"Paste the data and click Import"})]}),e.jsxs("div",{className:"import-mode-selector",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"csv",checked:d==="csv",onChange:I=>u(I.target.value)}),"CSV Format (from Google Sheets)"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"json",checked:d==="json",onChange:I=>u(I.target.value)}),"JSON Format"]})]}),d==="csv"?e.jsxs("div",{children:[e.jsx("p",{children:e.jsx("strong",{children:"Expected CSV format:"})}),e.jsx("pre",{children:dee()}),e.jsx("p",{children:"Supported columns: Position, Name, Email, FargoRate"})]}):e.jsxs("div",{children:[e.jsx("p",{children:e.jsx("strong",{children:"Expected JSON format:"})}),e.jsx("pre",{children:`[
  {
    "firstName": "John",
    "lastName": "Doe", 
    "email": "john@example.com",
    "fargoRate": 485,
    "position": 1
  }
]`})]})]}),e.jsxs("div",{className:"import-form",children:[e.jsx("textarea",{value:l,onChange:I=>c(I.target.value),placeholder:d==="csv"?"Paste your CSV data here...":"Paste your JSON data here...",rows:10}),e.jsx("button",{onClick:$,disabled:h||!l.trim(),className:"import-btn",children:h?"Importing...":"Import Data"})]})]}),e.jsxs("div",{className:"ladder-data-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:["Current ",(Oe=U.find(I=>I.name===s))==null?void 0:Oe.displayName," Ladder"]}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:Y,className:"export-btn",children:"Export to CSV"}),e.jsx("button",{onClick:W,disabled:h,className:"update-btn",children:h?"Updating...":"Update Positions"}),e.jsx("button",{onClick:Q,className:"fargo-btn",children:" Update Fargo Ratings"})]})]}),g&&e.jsx("div",{className:`message ${g.includes("Error")?"error":"success"}`,children:g}),h?e.jsx("div",{className:"loading",children:"Loading ladder data..."}):e.jsxs("div",{className:"ladder-table",children:[e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"FargoRate"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Immunity"})]})}),e.jsx("tbody",{children:o.map((I,X)=>e.jsxs("tr",{children:[e.jsx("td",{children:I.position}),e.jsxs("td",{children:[I.firstName," ",I.lastName]}),e.jsx("td",{children:I.email}),e.jsx("td",{children:I.fargoRate}),e.jsx("td",{children:e.jsx("span",{className:`status ${I.isActive?"active":"inactive"}`,children:I.isActive?"Active":"Inactive"})}),e.jsx("td",{children:I.immunityUntil?Ss(I.immunityUntil):"None"})]},I._id||X))})]}),o.length===0&&e.jsx("div",{className:"no-data",children:"No players found in this ladder. Import some data to get started!"})]})]}),e.jsxs("div",{className:"match-management-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"Match Result Management"}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>v(!0),className:"add-match-btn",disabled:o.length<2,children:"Report Match Result"}),e.jsx("button",{onClick:()=>{_(!S),S||O()},className:"view-history-btn",children:S?"Hide Match History":"View Match History"})]})]}),o.length<2&&e.jsx("div",{className:"message warning",children:"Need at least 2 players on the ladder to report match results."}),m&&e.jsx("div",{className:"match-form-overlay",children:e.jsxs("div",{className:"match-form",children:[e.jsx("h4",{children:"Report Match Result"}),e.jsxs("form",{onSubmit:Ae,children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Player 1:"}),e.jsxs("select",{value:b.player1Id,onChange:ue,required:!0,children:[e.jsx("option",{value:"",children:"Select Player 1"}),o.map(I=>e.jsxs("option",{value:I._id,children:["#",I.position," - ",I.firstName," ",I.lastName]},I._id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Player 2:"}),e.jsxs("select",{value:b.player2Id,onChange:J,required:!0,children:[e.jsx("option",{value:"",children:"Select Player 2"}),o.map(I=>e.jsxs("option",{value:I._id,children:["#",I.position," - ",I.firstName," ",I.lastName]},I._id))]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Winner:"}),e.jsxs("select",{value:b.winnerId,onChange:be,required:!0,children:[e.jsx("option",{value:"",children:"Select Winner"}),b.player1Id&&e.jsx("option",{value:b.player1Id,children:b.player1Name}),b.player2Id&&e.jsx("option",{value:b.player2Id,children:b.player2Name})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Score:"}),e.jsx("input",{type:"text",name:"score",value:b.score,onChange:H,placeholder:"e.g., 3-1, 5-3",required:!0})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Match Date:"}),e.jsx("input",{type:"date",name:"matchDate",value:b.matchDate,onChange:H,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Match Format:"}),e.jsxs("select",{name:"matchFormat",value:b.matchFormat,onChange:H,required:!0,children:[e.jsx("option",{value:"best-of-3",children:"Best of 3"}),e.jsx("option",{value:"best-of-5",children:"Best of 5"}),e.jsx("option",{value:"best-of-7",children:"Best of 7"}),e.jsx("option",{value:"best-of-9",children:"Best of 9"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Location:"}),e.jsx("input",{type:"text",name:"location",value:b.location,onChange:H,placeholder:"Pool hall or venue"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes:"}),e.jsx("input",{type:"text",name:"notes",value:b.notes,onChange:H,placeholder:"Optional match notes"})]})]}),e.jsxs("div",{className:"form-buttons",children:[e.jsx("button",{type:"submit",disabled:h,className:"submit-btn",children:h?"Recording...":"Record Match Result"}),e.jsx("button",{type:"button",onClick:()=>v(!1),className:"cancel-btn",children:"Cancel"})]})]})]})}),M&&C&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h3",{children:"Edit Match"}),e.jsxs("form",{onSubmit:ve,children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Player 1:"}),e.jsx("input",{type:"text",value:((Ze=C.player1)==null?void 0:Ze.name)||"",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Player 2:"}),e.jsx("input",{type:"text",value:((et=C.player2)==null?void 0:et.name)||"",disabled:!0})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Winner:"}),e.jsxs("select",{name:"winner",value:P.winner,onChange:De,children:[e.jsx("option",{value:"",children:"Select Winner"}),e.jsx("option",{value:(re=C.player1)==null?void 0:re.id,children:(je=C.player1)==null?void 0:je.name}),e.jsx("option",{value:(V=C.player2)==null?void 0:V.id,children:(Ee=C.player2)==null?void 0:Ee.name})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Score:"}),e.jsx("input",{type:"text",name:"score",value:P.score,onChange:De,placeholder:"e.g., 3-1"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status:"}),e.jsxs("select",{name:"status",value:P.status,onChange:De,children:[e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"forfeited",children:"Forfeited"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Completed Date:"}),e.jsx("input",{type:"date",name:"completedDate",value:P.completedDate,onChange:De})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Venue:"}),e.jsx("input",{type:"text",name:"venue",value:P.venue,onChange:De,placeholder:"Pool hall or venue"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Entry Fee:"}),e.jsx("input",{type:"number",name:"entryFee",value:P.entryFee,onChange:De,min:"0",step:"0.01"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Race Length:"}),e.jsx("input",{type:"number",name:"raceLength",value:P.raceLength,onChange:De,min:"1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Game Type:"}),e.jsxs("select",{name:"gameType",value:P.gameType,onChange:De,children:[e.jsx("option",{value:"8-ball",children:"8-ball"}),e.jsx("option",{value:"9-ball",children:"9-ball"}),e.jsx("option",{value:"10-ball",children:"10-ball"}),e.jsx("option",{value:"mixed",children:"Mixed"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Table Size:"}),e.jsxs("select",{name:"tableSize",value:P.tableSize,onChange:De,children:[e.jsx("option",{value:"7-foot",children:"7-foot"}),e.jsx("option",{value:"9-foot",children:"9-foot"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Scheduled Date:"}),e.jsx("input",{type:"date",name:"scheduledDate",value:P.scheduledDate,onChange:De})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes:"}),e.jsx("textarea",{name:"notes",value:P.notes,onChange:De,placeholder:"Match notes",rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Admin Notes:"}),e.jsx("textarea",{name:"adminNotes",value:P.adminNotes,onChange:De,placeholder:"Admin-only notes",rows:"3"})]})]}),e.jsxs("div",{className:"form-buttons",children:[e.jsx("button",{type:"submit",disabled:h,className:"submit-btn",children:h?"Updating...":"Update Match"}),e.jsx("button",{type:"button",onClick:()=>{E(!1),N(null)},className:"cancel-btn",children:"Cancel"})]})]})]})}),T&&k&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h3",{children:"Confirm Delete Match"}),e.jsx("p",{children:"Are you sure you want to delete this match?"}),e.jsxs("div",{className:"match-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Players:"})," ",(F=k.winner)==null?void 0:F.name," vs ",(ae=k.loser)==null?void 0:ae.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Score:"})," ",k.score]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",Ss(k.matchDate)]})]}),e.jsx("p",{className:"warning-text",children:" This action cannot be undone and will reverse any position changes."}),e.jsxs("div",{className:"form-buttons",children:[e.jsx("button",{onClick:Ce,disabled:h,className:"delete-btn",children:h?"Deleting...":"Delete Match"}),e.jsx("button",{onClick:()=>{A(!1),R(null)},className:"cancel-btn",children:"Cancel"})]})]})}),S&&e.jsxs("div",{className:"match-history-section",children:[e.jsx("h4",{children:"Match History"}),x.length===0?e.jsx("div",{className:"no-data",children:"No matches recorded yet."}):e.jsx("div",{className:"match-history-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Winner"}),e.jsx("th",{children:"Loser"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Format"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.map((I,X)=>e.jsxs("tr",{children:[e.jsx("td",{children:Ss(I.matchDate)}),e.jsxs("td",{children:[e.jsx("strong",{children:I.winner.name})," (#",I.winner.position,")"]}),e.jsxs("td",{children:[I.loser.name," (#",I.loser.position,")"]}),e.jsx("td",{children:I.score}),e.jsx("td",{children:I.matchFormat||"N/A"}),e.jsx("td",{children:I.location||"N/A"}),e.jsx("td",{children:e.jsx("span",{className:`status ${I.verificationStatus}`,children:I.verificationStatus})}),e.jsx("td",{children:e.jsxs("div",{className:"match-actions",children:[e.jsx("button",{className:"edit-btn",onClick:()=>oe(I),title:"Edit Match",children:""}),e.jsx("button",{className:"delete-btn",onClick:()=>me(I),title:"Delete Match",children:""})]})})]},I.id||X))})]})})]})]})]})};const mee=({userPin:n})=>{var T,A,k,R,U,z,$,W,Y,Q,H,ue,J,be,Ae,O,oe,me,Ce,ve,De,Oe,Ze,et,re,je,V,Ee,F,ae,I,X,fe,ne,ye,ot,lt,tt;const[t,r]=y.useState([]),[s,a]=y.useState(!1),[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(null),[h,p]=y.useState(!1),[g,f]=y.useState(!1),[m,v]=y.useState({player1:"",player2:"",winner:"",score:"",scheduledDate:"",completedDate:"",status:"completed",paymentVerified:!1,gameType:"8-ball",raceLength:5}),[b,w]=y.useState(""),x={}.VITE_BACKEND_URL||"http://localhost:8080";y.useEffect(()=>{j()},[]);const j=async()=>{a(!0);try{const ge=await fetch(`${x}/api/ladder/matches`,{headers:ed(n)});if(ge.ok){const ht=(await ge.json()||[]).sort((Je,Pe)=>{const Ve=new Date(Je.completedDate||Je.scheduledDate||Je.createdAt);return new Date(Pe.completedDate||Pe.scheduledDate||Pe.createdAt)-Ve});r(ht)}else{const xt=await ge.text();i(`Failed to load matches: ${ge.status} - ${xt}`)}}catch(ge){i("Error loading matches: "+ge.message)}finally{a(!1)}},S=ge=>{u(ge),v({player1:ge.player1?`${ge.player1.firstName} ${ge.player1.lastName}`:"",player2:ge.player2?`${ge.player2.firstName} ${ge.player2.lastName}`:"",winner:ge.winner?`${ge.winner.firstName} ${ge.winner.lastName}`:"",score:ge.score||"",scheduledDate:E(ge.scheduledDate),completedDate:E(ge.completedDate),status:ge.status||"completed",paymentVerified:ge.paymentVerified||!1,gameType:ge.gameType||"8-ball",raceLength:ge.raceLength||5}),p(!0)},_=async ge=>{var Ve,we,Re,it,rt,yt,kt;if(!ge.score||ge.score==="N/A"){alert("Cannot determine winner: No valid score found");return}const xt=ge.score.split("-");if(xt.length!==2){alert("Cannot determine winner: Invalid score format");return}const ht=parseInt(xt[0]),Je=parseInt(xt[1]);let Pe=null;if(ht>Je)Pe=(Ve=ge.player1)==null?void 0:Ve._id;else if(Je>ht)Pe=(we=ge.player2)==null?void 0:we._id;else{alert("Cannot determine winner: Scores are tied");return}if(!Pe){alert("Cannot determine winner: Player information missing");return}try{const Ct=await fetch(`${x}/api/ladder/matches/${ge._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({winner:Pe,score:ge.score,status:ge.status})});if(Ct.ok)alert(`Winner set to: ${Pe===((Re=ge.player1)==null?void 0:Re._id)?`${(it=ge.player1)==null?void 0:it.firstName} ${(rt=ge.player1)==null?void 0:rt.lastName}`:`${(yt=ge.player2)==null?void 0:yt.firstName} ${(kt=ge.player2)==null?void 0:kt.lastName}`}`),j();else{const te=await Ct.json();alert(`Failed to set winner: ${te.error||"Unknown error"}`)}}catch(Ct){console.error("Error setting winner:",Ct),alert(`Failed to set winner: ${Ct.message}`)}},C=async()=>{var ge,xt,ht;if(d){if(m.status==="completed"){if(!m.winner||m.winner.trim()===""){i("Winner is required when marking match as completed");return}if(!m.score||m.score.trim()===""){i("Score is required when marking match as completed");return}}a(!0);try{const Je=(we,Re)=>{var yt,kt,Ct,te,ke,We,Fe;if(!we||we.trim()==="")return Re;const it=((yt=d.player1)==null?void 0:yt._id)===Re?d.player1:d.player2;if(it&&we===`${it.firstName} ${it.lastName}`)return Re;const rt=t.find(st=>{var Ft,Le,Z,Ye;return`${(Ft=st.player1)==null?void 0:Ft.firstName} ${(Le=st.player1)==null?void 0:Le.lastName}`===we||`${(Z=st.player2)==null?void 0:Z.firstName} ${(Ye=st.player2)==null?void 0:Ye.lastName}`===we});if(rt){if(`${(kt=rt.player1)==null?void 0:kt.firstName} ${(Ct=rt.player1)==null?void 0:Ct.lastName}`===we)return(te=rt.player1)==null?void 0:te._id;if(`${(ke=rt.player2)==null?void 0:ke.firstName} ${(We=rt.player2)==null?void 0:We.lastName}`===we)return(Fe=rt.player2)==null?void 0:Fe._id}return Re},Pe={...m,player1:Je(m.player1,(ge=d.player1)==null?void 0:ge._id),player2:Je(m.player2,(xt=d.player2)==null?void 0:xt._id),winner:m.winner?Je(m.winner,(ht=d.winner)==null?void 0:ht._id):"",scheduledDate:m.scheduledDate?`${m.scheduledDate}T12:00:00`:null,completedDate:m.completedDate?`${m.completedDate}T12:00:00`:null,paymentVerified:m.paymentVerified},Ve=await fetch(`${x}/api/ladder/matches/${d._id}`,{method:"PUT",headers:{...ed(n),"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(Ve.ok){const we=await Ve.json();console.log(" Match update successful:",we),c("Match updated successfully"),p(!1),j(),window.dispatchEvent(new CustomEvent("matchesUpdated",{detail:{action:"update",matchId:d._id}}))}else{const we=await Ve.json();console.error(" Match update failed:",we),i(`Failed to update match: ${we.error||"Unknown error"}`)}}catch(Je){i("Error updating match: "+Je.message)}finally{a(!1)}}},N=async()=>{var ge,xt,ht,Je;if(d){a(!0);try{const Pe=await fetch(`${x}/api/ladder/matches/${d._id}`,{method:"DELETE",headers:ed(n)});if(Pe.ok){const Ve=await Pe.json();console.log(" MatchManager: Match deleted successfully from backend"),console.log(" MatchManager: Backend response:",Ve),console.log(" MatchManager: Deleted match details:",{id:d._id,player1:((ge=d.player1)==null?void 0:ge.firstName)+" "+((xt=d.player1)==null?void 0:xt.lastName),player2:((ht=d.player2)==null?void 0:ht.firstName)+" "+((Je=d.player2)==null?void 0:Je.lastName),scheduledDate:d.scheduledDate,completedDate:d.completedDate}),c("Match deleted successfully"),f(!1),j(),console.log(" MatchManager: Dispatching matchesUpdated event for deleted match:",d._id);const we=new CustomEvent("matchesUpdated",{detail:{action:"delete",matchId:d._id}});console.log(" MatchManager: Event created:",we),window.dispatchEvent(we),console.log(" MatchManager: Event dispatched successfully")}else{const Ve=await Pe.text();console.log(" MatchManager: Delete failed with status:",Pe.status),console.log(" MatchManager: Error response:",Ve),i(`Failed to delete match: ${Pe.status} - ${Ve}`)}}catch(Pe){i("Error deleting match: "+Pe.message)}finally{a(!1)}}},M=ge=>ge?new Date(ge).toLocaleDateString():"N/A",E=ge=>{if(!ge)return"";const xt=new Date(ge),ht=xt.getFullYear(),Je=String(xt.getMonth()+1).padStart(2,"0"),Pe=String(xt.getDate()).padStart(2,"0");return`${ht}-${Je}-${Pe}`},P=t.filter(ge=>{var we,Re,it,rt;if(!b)return!0;const xt=b.toLowerCase(),ht=`${((we=ge.player1)==null?void 0:we.firstName)||""} ${((Re=ge.player1)==null?void 0:Re.lastName)||""}`.toLowerCase(),Je=`${((it=ge.player2)==null?void 0:it.firstName)||""} ${((rt=ge.player2)==null?void 0:rt.lastName)||""}`.toLowerCase(),Pe=ge._id.toLowerCase(),Ve=ge.status.toLowerCase();return ht.includes(xt)||Je.includes(xt)||Pe.includes(xt)||Ve.includes(xt)}),D=ge=>{switch(ge){case"completed":return"#4CAF50";case"scheduled":return"#2196F3";case"cancelled":return"#f44336";default:return"#666"}};return s&&t.length===0?e.jsx("div",{className:"loading",children:"Loading matches..."}):e.jsxs("div",{className:"match-manager",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h2",{children:"Match Manager"}),e.jsx("button",{onClick:j,className:"refresh-btn",children:" Refresh"})]}),o&&e.jsxs("div",{className:"error-message",children:[o,e.jsx("button",{onClick:()=>i(""),children:""})]}),l&&e.jsxs("div",{className:"success-message",children:[l,e.jsx("button",{onClick:()=>c(""),children:""})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("input",{type:"text",placeholder:"Search matches by player name, match ID, or status...",value:b,onChange:ge=>w(ge.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}}),e.jsxs("div",{style:{marginTop:"5px",fontSize:"12px",color:"#666"},children:["Showing ",P.length," of ",t.length," matches"]})]}),e.jsxs("div",{className:"matches-list",children:[e.jsx("div",{className:"matches-header",children:e.jsxs("h3",{children:["All Matches (",P.length," of ",t.length,")"]})}),P.length===0?e.jsx("div",{className:"no-matches",children:"No matches found"}):e.jsx("div",{className:"matches-grid",children:P.map(ge=>{var xt,ht,Je,Pe,Ve,we,Re,it;return e.jsxs("div",{className:"match-card",children:[e.jsxs("div",{className:"match-header",children:[e.jsx("span",{className:"status-badge",style:{backgroundColor:D(ge.status)},children:ge.status.replace("_"," ").toUpperCase()}),ge.status==="pending_payment_verification"&&e.jsx("span",{style:{backgroundColor:"#FF9800",color:"white",padding:"2px 8px",borderRadius:"12px",fontSize:"10px",fontWeight:"bold",marginLeft:"8px"},children:" PAYMENT NEEDED"}),e.jsxs("div",{className:"match-actions",children:[ge.score&&ge.score!=="N/A"&&!ge.winner&&ge.status==="pending_payment_verification"&&e.jsx("button",{onClick:()=>_(ge),className:"quick-fix-btn",title:"Auto-set winner from score",style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",cursor:"pointer",marginRight:"4px"},children:" Set Winner"}),e.jsx("button",{onClick:()=>S(ge),className:"edit-btn",title:"Edit Match",children:""}),e.jsx("button",{onClick:()=>alert("DELETE FUNCTION DISABLED - BUG FIXING IN PROGRESS"),className:"delete-btn",title:"Delete Match (DISABLED - Bug Fixing)",disabled:!0,style:{opacity:.5,cursor:"not-allowed"},children:" (DISABLED)"})]})]}),e.jsxs("div",{className:"match-players",children:[e.jsxs("div",{className:"player",children:[e.jsxs("strong",{children:[(xt=ge.player1)==null?void 0:xt.firstName," ",(ht=ge.player1)==null?void 0:ht.lastName]}),((Je=ge.winner)==null?void 0:Je._id)===((Pe=ge.player1)==null?void 0:Pe._id)&&e.jsx("span",{className:"winner",children:""})]}),e.jsx("div",{className:"vs",children:"vs"}),e.jsxs("div",{className:"player",children:[e.jsxs("strong",{children:[(Ve=ge.player2)==null?void 0:Ve.firstName," ",(we=ge.player2)==null?void 0:we.lastName]}),((Re=ge.winner)==null?void 0:Re._id)===((it=ge.player2)==null?void 0:it._id)&&e.jsx("span",{className:"winner",children:""})]})]}),e.jsxs("div",{className:"match-details",children:[e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Match ID:"})," ",ge._id]}),e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Score:"})," ",ge.score||"N/A"]}),e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Winner:"})," ",ge.winner?`${ge.winner.firstName} ${ge.winner.lastName}`:ge.score&&ge.score!=="N/A"?(()=>{var yt,kt,Ct,te;const rt=ge.score.split("-");if(rt.length===2){const ke=parseInt(rt[0]),We=parseInt(rt[1]);if(ke>We)return`${(yt=ge.player1)==null?void 0:yt.firstName} ${(kt=ge.player1)==null?void 0:kt.lastName} (Auto-detected from ${ge.score})`;if(We>ke)return`${(Ct=ge.player2)==null?void 0:Ct.firstName} ${(te=ge.player2)==null?void 0:te.lastName} (Auto-detected from ${ge.score})`}return"Not Set"})():"Not Set"]}),e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Date:"})," ",M(ge.scheduledDate||ge.completedDate)]}),e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{style:{color:ge.status==="completed"?"#4CAF50":ge.status==="pending_payment_verification"?"#FF9800":ge.status==="scheduled"?"#2196F3":"#666",fontWeight:"bold",marginLeft:"5px"},children:ge.status.replace("_"," ").toUpperCase()})]}),ge.paymentMethod&&e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Payment Method:"})," ",ge.paymentMethod]}),ge.paymentVerified!==void 0&&e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Payment Verified:"}),e.jsx("span",{style:{color:ge.paymentVerified?"#4CAF50":"#FF9800",fontWeight:"bold",marginLeft:"5px"},children:ge.paymentVerified?"YES":"NO"})]}),ge.reportedBy&&e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Reported By:"})," ",ge.reportedBy.firstName?`${ge.reportedBy.firstName} ${ge.reportedBy.lastName}`:ge.reportedBy]}),ge.notes&&e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Notes:"})," ",ge.notes]}),e.jsxs("div",{className:"detail",children:[e.jsx("strong",{children:"Ladder:"})," ",ge.ladder||"N/A"]})]})]},ge._id)})})]}),h&&d&&xr.createPortal(e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"modal-content",style:{backgroundColor:"#2a2a2a",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},children:[e.jsxs("div",{className:"modal-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 20px",borderBottom:"1px solid #444",backgroundColor:"#333"},children:[e.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px"},children:"Edit Match"}),e.jsx("button",{onClick:()=>p(!1),style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),e.jsxs("div",{style:{padding:"10px 20px",backgroundColor:"#333",borderBottom:"1px solid #444",fontSize:"12px",color:"#ccc"},children:[" ",e.jsx("strong",{children:"Tip:"})," Use the dropdowns to select players. This prevents typos and ensures accurate player selection.",e.jsx("br",{}),e.jsx("strong",{children:"Available Players:"})," ",(T=d.player1)==null?void 0:T.firstName," ",(A=d.player1)==null?void 0:A.lastName," | ",(k=d.player2)==null?void 0:k.firstName," ",(R=d.player2)==null?void 0:R.lastName,m.status==="completed"&&e.jsxs("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#2d4a2d",borderRadius:"4px",border:"1px solid #4CAF50"},children:[" ",e.jsx("strong",{children:"To complete a match:"})," Winner and Score are required"]}),d.status==="pending_payment_verification"&&e.jsxs("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#4a3c2d",borderRadius:"4px",border:"1px solid #ff9800"},children:[" ",e.jsx("strong",{children:"Payment Verification:"}),' Check the "Verify Payment" box to confirm payment has been received. If match has winner/score, it will auto-complete.']})]}),e.jsxs("div",{className:"modal-body",style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px",marginBottom:"15px"},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#fff",fontSize:"14px",fontWeight:"bold"},children:"Player 1:"}),e.jsxs("div",{style:{marginBottom:"8px",color:"#888",fontSize:"12px"},children:["Current: ",(U=d.player1)==null?void 0:U.firstName," ",(z=d.player1)==null?void 0:z.lastName]}),e.jsxs("select",{value:m.player1,onChange:ge=>v({...m,player1:ge.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #555",backgroundColor:"#333",color:"#fff",fontSize:"14px"},children:[e.jsx("option",{value:"",children:"Select Player 1"}),e.jsxs("option",{value:`${($=d.player1)==null?void 0:$.firstName} ${(W=d.player1)==null?void 0:W.lastName}`,children:[(Y=d.player1)==null?void 0:Y.firstName," ",(Q=d.player1)==null?void 0:Q.lastName]}),e.jsxs("option",{value:`${(H=d.player2)==null?void 0:H.firstName} ${(ue=d.player2)==null?void 0:ue.lastName}`,children:[(J=d.player2)==null?void 0:J.firstName," ",(be=d.player2)==null?void 0:be.lastName]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Player 2:"}),e.jsxs("div",{style:{marginBottom:"8px",color:"#888",fontSize:"12px"},children:["Current: ",(Ae=d.player2)==null?void 0:Ae.firstName," ",(O=d.player2)==null?void 0:O.lastName]}),e.jsxs("select",{value:m.player2,onChange:ge=>v({...m,player2:ge.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #555",backgroundColor:"#333",color:"#fff",fontSize:"14px"},children:[e.jsx("option",{value:"",children:"Select Player 2"}),e.jsxs("option",{value:`${(oe=d.player1)==null?void 0:oe.firstName} ${(me=d.player1)==null?void 0:me.lastName}`,children:[(Ce=d.player1)==null?void 0:Ce.firstName," ",(ve=d.player1)==null?void 0:ve.lastName]}),e.jsxs("option",{value:`${(De=d.player2)==null?void 0:De.firstName} ${(Oe=d.player2)==null?void 0:Oe.lastName}`,children:[(Ze=d.player2)==null?void 0:Ze.firstName," ",(et=d.player2)==null?void 0:et.lastName]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Winner:"}),e.jsxs("div",{style:{marginBottom:"8px",color:"#888",fontSize:"12px"},children:["Current: ",(re=d.winner)==null?void 0:re.firstName," ",((je=d.winner)==null?void 0:je.lastName)||"Not Set",!d.winner&&d.score&&e.jsx("div",{style:{color:"#ff9800",marginTop:"4px"},children:" Match has score but no winner set. Please select the winner."})]}),e.jsxs("select",{value:m.winner,onChange:ge=>v({...m,winner:ge.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #555",backgroundColor:"#333",color:"#fff",fontSize:"14px"},children:[e.jsx("option",{value:"",children:"Select Winner"}),e.jsxs("option",{value:`${(V=d.player1)==null?void 0:V.firstName} ${(Ee=d.player1)==null?void 0:Ee.lastName}`,children:[(F=d.player1)==null?void 0:F.firstName," ",(ae=d.player1)==null?void 0:ae.lastName]}),e.jsxs("option",{value:`${(I=d.player2)==null?void 0:I.firstName} ${(X=d.player2)==null?void 0:X.lastName}`,children:[(fe=d.player2)==null?void 0:fe.firstName," ",(ne=d.player2)==null?void 0:ne.lastName]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Score:"}),e.jsx("input",{type:"text",value:m.score,onChange:ge=>v({...m,score:ge.target.value}),placeholder:"e.g., 8-5"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Scheduled Date:"}),e.jsx("input",{type:"date",value:m.scheduledDate,onChange:ge=>v({...m,scheduledDate:ge.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Completed Date:"}),e.jsx("input",{type:"date",value:m.completedDate,onChange:ge=>v({...m,completedDate:ge.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status:"}),e.jsxs("select",{value:m.status,onChange:ge=>v({...m,status:ge.target.value}),children:[e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"pending_payment_verification",children:"Pending Payment Verification"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Game Type:"}),e.jsxs("select",{value:m.gameType,onChange:ge=>v({...m,gameType:ge.target.value}),children:[e.jsx("option",{value:"8-ball",children:"8-ball"}),e.jsx("option",{value:"9-ball",children:"9-ball"}),e.jsx("option",{value:"10-ball",children:"10-ball"}),e.jsx("option",{value:"mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Race Length:"}),e.jsx("input",{type:"number",value:m.raceLength,onChange:ge=>v({...m,raceLength:parseInt(ge.target.value)||5}),min:"1",max:"21",placeholder:"5"})]})]}),d.status==="pending_payment_verification"&&e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("input",{type:"checkbox",checked:m.paymentVerified,onChange:ge=>v({...m,paymentVerified:ge.target.checked}),style:{transform:"scale(1.2)"}}),e.jsx("span",{children:" Verify Payment"})]}),e.jsx("div",{style:{marginTop:"4px",color:"#888",fontSize:"12px"},children:"Check this box to verify that the payment has been received (cash in dropbox, online payment confirmed, etc.)"})]})]}),e.jsxs("div",{className:"modal-footer",style:{display:"flex",justifyContent:"flex-end",gap:"10px",padding:"15px 20px",borderTop:"1px solid #444",backgroundColor:"#333"},children:[e.jsx("button",{onClick:()=>p(!1),className:"cancel-btn",style:{padding:"8px 16px",backgroundColor:"#666",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),e.jsx("button",{onClick:C,className:"save-btn",disabled:s,style:{padding:"8px 16px",backgroundColor:s?"#666":"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:s?"not-allowed":"pointer",fontSize:"14px"},children:s?"Saving...":"Save Changes"})]})]})}),document.body),g&&d&&xr.createPortal(e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Delete Match"}),e.jsx("button",{onClick:()=>f(!1),children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{children:"Are you sure you want to delete this match?"}),e.jsxs("div",{className:"match-preview",children:[e.jsxs("strong",{children:[(ye=d.player1)==null?void 0:ye.firstName," ",(ot=d.player1)==null?void 0:ot.lastName]})," vs"," ",e.jsxs("strong",{children:[(lt=d.player2)==null?void 0:lt.firstName," ",(tt=d.player2)==null?void 0:tt.lastName]}),e.jsx("br",{}),e.jsxs("small",{children:["Date: ",M(d.completedDate)]}),e.jsx("br",{}),e.jsxs("small",{children:["Status: ",d.status]})]}),e.jsx("p",{className:"warning",children:" This will permanently delete the match and cannot be undone."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:()=>f(!1),className:"cancel-btn",children:"Cancel"}),e.jsx("button",{onClick:N,className:"delete-btn",disabled:s,children:s?"Deleting...":"Delete Match"})]})]})}),document.body)]})};const pp={}.VITE_BACKEND_URL||"http://localhost:8080",fee=({userPin:n})=>{const[t,r]=y.useState([]),[s,a]=y.useState([]),[o,i]=y.useState("test"),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState(!1),[m,v]=y.useState(""),[b,w]=y.useState(null);if(b)return e.jsxs("div",{className:"emailManager",children:[e.jsxs("div",{className:"header",children:[e.jsx("h2",{children:" Email Manager"}),e.jsx("p",{children:"Error loading email manager"})]}),e.jsxs("div",{className:"message error",children:["Error: ",b.message]}),e.jsx("button",{onClick:()=>w(null),children:"Try Again"})]});const x={test:{name:"Test Email",subject:"Test Email from Ladder Admin",template:"This is a test email to verify the email system is working correctly."},matchApproval:{name:"Match Approval",subject:" Match Request Approved!",template:`Hi [PLAYER_NAME],

Great news! Your match scheduling request has been approved.

Match Details:
- Opponent: [OPPONENT_NAME]
- Date: [MATCH_DATE]
- Time: [MATCH_TIME]
- Location: [LOCATION]

What's Next?
- Mark your calendar for the match date
- Arrive at the location on time
- Contact your opponent if needed
- Play your best game!

Good luck with your match! 
Front Range Pool Hub - Ladder of Legends`},matchScheduled:{name:"Match Scheduled",subject:" Match Scheduled - You're Playing!",template:`Hi [PLAYER_NAME],

A match has been scheduled and you're playing! Here are the details:

Match Details:
- Opponent: [OPPONENT_NAME]
- Date: [MATCH_DATE]
- Time: [MATCH_TIME]
- Location: [LOCATION]

What's Next?
- Mark your calendar for the match date
- Arrive at the location on time
- Contact your opponent if you need to reschedule
- Play your best game!

Good luck with your match! 
Front Range Pool Hub - Ladder of Legends`},allLadderEmails:{name:" Test ALL Ladder Emails",subject:" Test: All Ladder System Emails",template:`This will send test versions of ALL ladder system emails to your email address for review.

Including:
- Match Scheduling (Approval, Rejection, Defender Notification, Don's Business Email)
- Challenge System (Challenge Notification, Challenge Confirmation, Counter Proposals)
- Account Management (Ladder Application Approval)
- Total: 8 different email types`},challengeNotification:{name:"Challenge Notification",subject:" Challenge Received!",template:`Hi [PLAYER_NAME],

[CHALLENGER_NAME] has challenged you to a match! Here are the details:

Ladder Positions:
- [CHALLENGER_NAME] (Position [CHALLENGER_POSITION]) vs You (Position [DEFENDER_POSITION])
- [LADDER_NAME] Ladder

Match Details:
- Challenge Type: [CHALLENGE_TYPE]
- Entry Fee: $[ENTRY_FEE]
- Race Length: [RACE_LENGTH]
- Game Type: [GAME_TYPE]
- Table Size: [TABLE_SIZE]
- Location: [LOCATION]

Preferred Match Dates:
[DATES_LIST]

Message from [CHALLENGER_NAME]:
"[MESSAGE]"

You have 48 hours to respond to this challenge.

Good luck! 
Front Range Pool Hub - Ladder of Legends`},challengeConfirmation:{name:"Challenge Confirmation",subject:" Challenge Accepted - Match Confirmed!",template:`Hi [PLAYER_NAME],

Great news! Your challenge has been accepted and the match is confirmed.

Match Details:
- Opponent: [OPPONENT_NAME]
- Challenge Type: [CHALLENGE_TYPE]
- Entry Fee: $[ENTRY_FEE]
- Race Length: [RACE_LENGTH]
- Game Type: [GAME_TYPE]
- Table Size: [TABLE_SIZE]
- Location: [LOCATION]
- Match Date: [MATCH_DATE]

What's Next?
- Mark your calendar for the match date
- Arrive at the location on time
- Contact your opponent if needed
- Play your best game!

Good luck with your match! 
Front Range Pool Hub - Ladder of Legends`},counterProposal:{name:"Counter Proposal",subject:" Counter-Proposal from [FROM_NAME]",template:`Hi [PLAYER_NAME],

[FROM_NAME] has sent you a counter-proposal for your challenge.

Original Challenge:
- Challenge Type: [CHALLENGE_TYPE]
- Entry Fee: $[ENTRY_FEE]
- Race Length: [RACE_LENGTH]

Counter-Proposal:
- New Entry Fee: $[NEW_ENTRY_FEE]
- New Race Length: [NEW_RACE_LENGTH]
- Message: "[MESSAGE]"

Please review the counter-proposal and respond accordingly.

Good luck! 
Front Range Pool Hub - Ladder of Legends`},ladderApproval:{name:"Ladder Position Approval",subject:" Ladder Position Approved - Welcome to the Ladder!",template:`Hi [PLAYER_NAME],

Congratulations! Your ladder position claim has been approved.

Position Details:
- Ladder: [LADDER_NAME]
- Position: #[POSITION]

 Setting Up Your Account:
A password reset link has been sent to your email. Please check your inbox and set your password to access your account.

You can now:
- Set your password using the reset link
- View the ladder standings
- Challenge other players (with membership)
- Report match results (with membership)
- Track your match history

Login URL: [LOGIN_URL]

Welcome to the ladder! 
Front Range Pool Hub - Ladder of Legends`},custom:{name:"Custom Message",subject:"",template:""}};y.useEffect(()=>{n&&j()},[n]);const j=async()=>{try{f(!0),w(null);const D=await fetch(`${pp}/api/ladder/players`,{headers:ed(n)});if(D.ok){const T=await D.json();r(T||[])}else v("Error loading players")}catch(D){console.error("Error loading players:",D),w(D),v("Error loading players")}finally{f(!1)}},S=D=>{i(D);const T=x[D];u(T.subject),p(T.template)},_=D=>{a(T=>T.includes(D)?T.filter(A=>A!==D):[...T,D])},C=()=>{a(t.map(D=>D._id))},N=()=>{a([])},M=async()=>{if(o==="allLadderEmails"){await E();return}if(!l&&s.length===0){v("Please select recipients or enter an email address");return}if(!d.trim()){v("Please enter a subject");return}if(!h.trim()){v("Please enter a message");return}try{f(!0),v("");const D={emailType:o,subject:d.trim(),message:h.trim(),recipientEmail:l.trim()||null,selectedPlayers:s.length>0?s:null,players:s.length>0?t.filter(k=>s.includes(k._id)):[]},A=await(await fetch(`${pp}/api/admin/send-email`,{method:"POST",headers:{...ed(n),"Content-Type":"application/json"},body:JSON.stringify(D)})).json();A.success?(v(` Email sent successfully! ${A.emailsSent} email(s) sent.`),c(""),a([]),u(""),p("")):v(` Error: ${A.message}`)}catch(D){console.error("Error sending email:",D),v(" Error sending email")}finally{f(!1)}},E=async()=>{if(!l){v("Please enter an email address to receive the test emails");return}try{f(!0),v("Sending all ladder test emails...");const T=await(await fetch(`${pp}/api/match-scheduling/test-emails`,{method:"POST",headers:{...ed(n),"Content-Type":"application/json"},body:JSON.stringify({testEmail:l})})).json();T.success?(v(` All ladder test emails sent successfully! Check ${l} for the test emails.`),c(""),a([]),u(""),p("")):v(` Error: ${T.message}`)}catch(D){console.error("Error sending all ladder test emails:",D),v(" Error sending test emails")}finally{f(!1)}},P=()=>l?1:s.length;return e.jsxs("div",{className:"emailManager",children:[e.jsxs("div",{className:"header",children:[e.jsx("h2",{children:" Email Manager"}),e.jsx("p",{children:"Send test emails, player notifications, and mass mailings"})]}),m&&e.jsx("div",{className:`message ${m.includes("")?"success":"error"}`,children:m}),e.jsxs("div",{className:"emailForm",children:[e.jsxs("div",{className:"formGroup",children:[e.jsx("label",{children:"Email Type:"}),e.jsx("select",{value:o,onChange:D=>S(D.target.value),className:"select",children:Object.entries(x).map(([D,T])=>e.jsx("option",{value:D,children:T.name},D))})]}),e.jsxs("div",{className:"recipientsSection",children:[e.jsx("h3",{children:"Recipients"}),e.jsxs("div",{className:"formGroup",children:[e.jsx("label",{children:"Send to specific email address:"}),e.jsx("input",{type:"email",value:l,onChange:D=>c(D.target.value),placeholder:"Enter email address (e.g., test@example.com)",className:"input"})]}),e.jsxs("div",{className:"playerSelection",children:[e.jsxs("div",{className:"playerSelectionHeader",children:[e.jsx("h4",{children:"Or select players:"}),e.jsxs("div",{className:"playerActions",children:[e.jsx("button",{onClick:C,className:"actionBtn",children:"Select All"}),e.jsx("button",{onClick:N,className:"actionBtn",children:"Clear All"})]})]}),e.jsx("div",{className:"playersList",children:t.length>0?t.map(D=>{var T;return e.jsx("div",{className:"playerItem",children:e.jsxs("label",{className:"playerLabel",children:[e.jsx("input",{type:"checkbox",checked:s.includes(D._id),onChange:()=>_(D._id),className:"checkbox"}),e.jsxs("span",{className:"playerName",children:[D.firstName," ",D.lastName]}),e.jsx("span",{className:"playerEmail",children:D.email||((T=D.unifiedAccount)==null?void 0:T.email)||"No email"})]})},D._id)}):e.jsx("div",{className:"playerItem",children:e.jsx("p",{children:"No players loaded. You can still send emails to specific addresses."})})})]}),e.jsx("div",{className:"recipientCount",children:e.jsxs("strong",{children:["Total Recipients: ",P()]})})]}),e.jsxs("div",{className:"formGroup",children:[e.jsx("label",{children:"Subject:"}),e.jsx("input",{type:"text",value:d,onChange:D=>u(D.target.value),className:"input",placeholder:"Email subject"})]}),e.jsxs("div",{className:"formGroup",children:[e.jsx("label",{children:"Message:"}),e.jsx("textarea",{value:h,onChange:D=>p(D.target.value),className:"textarea",rows:10,placeholder:"Email message content"})]}),e.jsx("div",{className:"sendSection",children:e.jsx("button",{onClick:M,disabled:g||P()===0,className:"sendBtn",children:g?"Sending...":` Send Email${P()>1?"s":""} (${P()})`})})]}),e.jsxs("div",{className:"quickActions",children:[e.jsx("h3",{children:"Quick Actions"}),e.jsxs("div",{className:"actionButtons",children:[e.jsx("button",{onClick:()=>{i("test"),c("sslampro@gmail.com"),S("test")},className:"quickBtn",children:" Send Test Email"}),e.jsx("button",{onClick:()=>{i("custom"),c("sacodo752@gmail.com"),u("Business Update"),p(`Hello Don,

This is a business update from the ladder system.

Best regards,
Admin`)},className:"quickBtn",children:" Send to Don"}),e.jsx("button",{onClick:()=>{i("custom"),C(),u("Important Ladder Update"),p(`Hello Players,

This is an important update about the ladder system.

Thank you,
Admin`)},className:"quickBtn",children:" Mass Email All Players"}),e.jsx("button",{onClick:()=>{i("allLadderEmails"),c("sslampro@gmail.com"),u(" Test: All Ladder System Emails"),p(`This will send test versions of ALL ladder system emails to your email address for review.

Including:
- Match Scheduling (Approval, Rejection, Defender Notification, Don's Business Email)
- Challenge System (Challenge Notification, Challenge Confirmation, Counter Proposals)
- Account Management (Ladder Application Approval)
- Total: 8 different email types`)},className:"quickBtn",style:{background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"},children:" Test ALL Ladder Emails"}),e.jsx("button",{onClick:async()=>{const D=l||"sslampro@gmail.com";f(!0),v("Sending test ladder approval email...");try{const A=await(await fetch(`${pp}/api/email/test-ladder-approval`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({testEmail:D})})).json();A.success?v(` Test ladder approval email sent to ${D}`):v(` Failed to send test email: ${A.message}`)}catch(T){console.error("Error sending test email:",T),v(" Error sending test email")}finally{f(!1)}},className:"quickBtn",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},children:" Test Ladder Approval Email"})]})]})]})};const gee=({userPin:n})=>{const[t,r]=y.useState([]),[s,a]=y.useState(!0),[o,i]=y.useState(null),[l,c]=y.useState(""),[d,u]=y.useState(!1),[h,p]=y.useState("");y.useEffect(()=>{g()},[]);const g=async()=>{a(!0);try{const v=await mt.getPendingForfeitRequests();v.success?r(v.requests):console.error("Failed to load forfeit requests:",v.error)}catch(v){console.error("Error loading forfeit requests:",v)}finally{a(!1)}},f=async v=>{const b=v.no_show_user?`${v.no_show_user.first_name} ${v.no_show_user.last_name}`:"Unknown Player";if(confirm(`Approve forfeit request?

No-show player: ${b}
This will move the player down 3 positions.`)){u(!0),p("");try{const w=await mt.approveForfeitRequest(v.id,l.trim()||"Forfeit approved",n);if(!w.success)throw new Error(w.error||"Failed to approve forfeit");p(" Forfeit approved successfully!"),i(null),c(""),await g()}catch(w){console.error("Error approving forfeit:",w),p(` Error: ${w.message}`)}finally{u(!1)}}},m=async v=>{const b=prompt("Reason for denying this forfeit request?");if(b){u(!0),p("");try{const w=await mt.denyForfeitRequest(v.id,b,n);if(!w.success)throw new Error(w.error||"Failed to deny forfeit");p(" Forfeit request denied"),i(null),c(""),await g()}catch(w){console.error("Error denying forfeit:",w),p(` Error: ${w.message}`)}finally{u(!1)}}};return s?e.jsx("div",{style:{padding:"20px",color:"#e0e0e0"},children:"Loading forfeit requests..."}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("h2",{style:{color:"#e0e0e0",marginBottom:"20px"},children:[" Forfeit Requests (",t.length," pending)"]}),h&&e.jsx("div",{style:{padding:"12px",background:h.startsWith("")?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:`1px solid ${h.startsWith("")?"rgba(16, 185, 129, 0.3)":"rgba(220, 38, 38, 0.3)"}`,borderRadius:"4px",color:h.startsWith("")?"#10b981":"#ff6b6b",marginBottom:"20px"},children:h}),t.length===0?e.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:" No pending forfeit requests"}):e.jsx("div",{style:{display:"grid",gap:"20px"},children:t.map(v=>{var b,w,x,j,S;return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("h3",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"1.1rem"},children:[v.reportedBy.firstName," ",v.reportedBy.lastName," vs ",v.noShowPlayer.firstName," ",v.noShowPlayer.lastName]}),e.jsxs("div",{style:{color:"#999",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Reported:"})," ",new Date(v.reportedAt).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled:"})," ",new Date((b=v.matchId)==null?void 0:b.scheduledDate).toLocaleString()]}),((w=v.matchId)==null?void 0:w.venue)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",v.matchId.venue]})]})]}),e.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[e.jsxs("h4",{style:{color:"#dc2626",margin:"0 0 8px 0",fontSize:"1rem"},children:[" No-Show Player: ",v.noShowPlayer.firstName," ",v.noShowPlayer.lastName]}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Current Position:"})," #",v.noShowPlayer.position]}),e.jsxs("div",{children:[e.jsx("strong",{children:"No-Shows in Last 60 Days:"})," ",((x=v.noShowPlayerInfo)==null?void 0:x.recentNoShows)||0]}),e.jsxs("div",{children:[e.jsx("strong",{children:"This Would Be:"})," ",v.noShowOffenseNumber,v.noShowOffenseNumber===1?"st":v.noShowOffenseNumber===2?"nd":"rd"," offense"]})]})]}),e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[e.jsx("h4",{style:{color:"#f59e0b",margin:"0 0 8px 0",fontSize:"1rem"},children:" Recommended Penalty"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Positions Down:"})," ",((j=v.recommendedPenalty)==null?void 0:j.positionsDown)||1]}),((S=v.recommendedPenalty)==null?void 0:S.suspended)&&e.jsxs("div",{style:{color:"#dc2626",fontWeight:"bold"},children:[e.jsx("strong",{children:" SUSPENSION:"})," 14 days"]})]})]}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[e.jsxs("h5",{style:{color:"#3b82f6",margin:"0 0 8px 0",fontSize:"0.9rem"},children:["Message from ",v.reportedBy.firstName," ",v.reportedBy.lastName,":"]}),e.jsx("p",{style:{color:"#e0e0e0",fontSize:"0.9rem",margin:"0",whiteSpace:"pre-wrap"},children:v.message})]}),v.photoUrl&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("h5",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"0.9rem"},children:" Photo Proof:"}),e.jsxs("div",{style:{border:"2px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",overflow:"hidden",cursor:"pointer"},onClick:()=>window.open(v.photoUrl,"_blank"),children:[e.jsx("img",{src:v.photoUrl,alt:"Forfeit proof",style:{width:"100%",height:"auto",maxHeight:"300px",objectFit:"contain",background:"#000"}}),e.jsx("div",{style:{padding:"8px",background:"rgba(59, 130, 246, 0.1)",borderTop:"1px solid rgba(59, 130, 246, 0.3)",color:"#3b82f6",fontSize:"0.85rem",textAlign:"center"},children:"Click to view full size"})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{color:"#e0e0e0",display:"block",marginBottom:"4px",fontSize:"0.9rem"},children:"Admin Notes (Optional)"}),e.jsx("textarea",{value:l,onChange:_=>c(_.target.value),rows:"2",placeholder:"Add any notes about this decision...",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #444",background:"#333",color:"#fff",resize:"vertical",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>m(v),disabled:d,style:{padding:"10px 20px",background:d?"#666":"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer",fontSize:"0.95rem",fontWeight:"bold"},children:" Deny"}),e.jsx("button",{onClick:()=>f(v),disabled:d,style:{padding:"10px 20px",background:d?"#666":"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer",fontSize:"0.95rem",fontWeight:"bold"},children:d?"Processing...":" Approve Forfeit"})]})]},v._id)})})]})};const xee=({selectedLadder:n,userPin:t})=>{const[r,s]=y.useState([]),[a,o]=y.useState(!0),[i,l]=y.useState("");y.useEffect(()=>{c()},[n]);const c=async()=>{o(!0);try{const h=await fetch(`${Ie}/api/ladder/front-range-pool-hub/ladders/${n}/matches`);if(h.ok){const g=(await h.json()).filter(f=>f.status==="overdue");s(g)}else console.error("Failed to load matches")}catch(h){console.error("Error loading overdue matches:",h)}finally{o(!1)}},d=async(h,p)=>{var f,m,v,b;let g="";switch(p){case"cancel":g=`Cancel this match?

${(f=h.player1)==null?void 0:f.firstName} ${(m=h.player1)==null?void 0:m.lastName} vs ${(v=h.player2)==null?void 0:v.firstName} ${(b=h.player2)==null?void 0:b.lastName}

This will remove the match from the system with no position changes.`;break;case"reschedule":const w=prompt("Reschedule this match to (YYYY-MM-DD):");if(!w)return;try{(await fetch(`${Ie}/api/ladder/front-range-pool-hub/ladders/${n}/matches/${h._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduledDate:new Date(w).toISOString(),status:"scheduled"})})).ok?(l(` Match rescheduled to ${w}`),await c()):l(" Failed to reschedule match")}catch(x){console.error("Error rescheduling match:",x),l(" Error rescheduling match")}return}if(confirm(g))try{p==="cancel"&&((await fetch(`${Ie}/api/ladder/front-range-pool-hub/ladders/${n}/matches/${h._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"cancelled",adminNotes:"Match cancelled due to being overdue"})})).ok?(l(" Match cancelled"),await c()):l(" Failed to cancel match"))}catch(w){console.error("Error resolving match:",w),l(" Error resolving match")}},u=h=>{const p=new Date(h),g=new Date,f=3,m=Math.floor((g-p)/(1e3*60*60*24))-f;return Math.max(0,m)};return a?e.jsx("div",{style:{padding:"20px",color:"#e0e0e0"},children:"Loading overdue matches..."}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("h2",{style:{color:"#e0e0e0",marginBottom:"20px"},children:[" Overdue Matches (",r.length,")"]}),i&&e.jsx("div",{style:{padding:"12px",background:i.startsWith("")?"rgba(16, 185, 129, 0.1)":"rgba(220, 38, 38, 0.1)",border:`1px solid ${i.startsWith("")?"rgba(16, 185, 129, 0.3)":"rgba(220, 38, 38, 0.3)"}`,borderRadius:"4px",color:i.startsWith("")?"#10b981":"#ff6b6b",marginBottom:"20px"},children:i}),r.length===0?e.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#999",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px"},children:" No overdue matches"}):e.jsx("div",{style:{display:"grid",gap:"20px"},children:r.map(h=>{var g,f,m,v,b,w,x,j,S,_,C,N;const p=u(h.scheduledDate);return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"2px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("h3",{style:{color:"#e0e0e0",margin:"0 0 8px 0",fontSize:"1.1rem"},children:[(g=h.player1)==null?void 0:g.firstName," ",(f=h.player1)==null?void 0:f.lastName," vs ",(m=h.player2)==null?void 0:m.firstName," ",(v=h.player2)==null?void 0:v.lastName]}),e.jsxs("div",{style:{display:"inline-block",padding:"4px 12px",background:"rgba(245, 158, 11, 0.2)",border:"1px solid rgba(245, 158, 11, 0.4)",borderRadius:"4px",color:"#f59e0b",fontSize:"0.85rem",fontWeight:"bold"},children:[" ",p," day",p!==1?"s":""," overdue"]})]}),e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.2)",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:e.jsxs("div",{style:{color:"#999",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Match Type:"})," ",h.matchType||"challenge"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scheduled Date:"})," ",new Date(h.scheduledDate).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})]}),h.venue&&e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",h.venue]}),h.rescheduleCount>0&&e.jsxs("div",{style:{color:"#f59e0b"},children:[e.jsx("strong",{children:"Reschedules:"})," ",h.rescheduleCount,"/2 used"]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"16px"},children:[e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#3b82f6",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Player 1"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[(b=h.player1)==null?void 0:b.firstName," ",(w=h.player1)==null?void 0:w.lastName]})}),e.jsxs("div",{children:["Position #",(x=h.player1)==null?void 0:x.position]}),((j=h.player1)==null?void 0:j.email)&&e.jsx("div",{children:h.player1.email})]})]}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#3b82f6",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"Player 2"}),e.jsxs("div",{style:{color:"#e0e0e0",fontSize:"0.85rem"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[(S=h.player2)==null?void 0:S.firstName," ",(_=h.player2)==null?void 0:_.lastName]})}),e.jsxs("div",{children:["Position #",(C=h.player2)==null?void 0:C.position]}),((N=h.player2)==null?void 0:N.email)&&e.jsx("div",{children:h.player2.email})]})]})]}),e.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"12px"},children:[e.jsx("h5",{style:{color:"#f59e0b",margin:"0 0 12px 0",fontSize:"0.9rem"},children:"Admin Actions"}),e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>d(h,"reschedule"),style:{padding:"8px 16px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:" Reschedule"}),e.jsx("button",{onClick:()=>d(h,"cancel"),style:{padding:"8px 16px",background:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:" Cancel Match"}),e.jsx("button",{onClick:()=>{var M,E;return window.open(`mailto:${(M=h.player1)==null?void 0:M.email},${(E=h.player2)==null?void 0:E.email}?subject=Overdue Match Follow-up&body=Your match scheduled for ${new Date(h.scheduledDate).toLocaleDateString()} is overdue. Please contact me to resolve.`,"_blank")},style:{padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",fontWeight:"bold"},children:" Email Both Players"})]}),e.jsx("p",{style:{color:"#999",fontSize:"0.8rem",margin:"8px 0 0 0"},children:" Contact players to determine what happened, then reschedule or cancel as appropriate"})]})]},h._id)})})]})},yee=({backendUrl:n})=>{const[t,r]=y.useState(null),[s,a]=y.useState(!1),[o,i]=y.useState(null),l=async()=>{a(!0),i(null),r(null);try{const d=await fetch(`${n}/api/test/comprehensive-real-user`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`}});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const u=await d.json();r(u)}catch(d){i(d.message),console.error("Test execution error:",d)}finally{a(!1)}},c=d=>d?e.jsxs("div",{style:{marginTop:"20px",padding:"20px",backgroundColor:"#1a1a1a",borderRadius:"8px",color:"#fff",fontFamily:"monospace",fontSize:"14px",whiteSpace:"pre-wrap",maxHeight:"600px",overflow:"auto"},children:[e.jsx("h3",{style:{color:"#4CAF50",marginBottom:"15px"},children:" Comprehensive Test Results"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("strong",{children:"Test Status:"})," ",d.success?" PASSED":" FAILED"]}),d.summary&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("strong",{children:"Summary:"}),e.jsx("br",{}),d.summary]}),d.details&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("strong",{children:"Details:"}),e.jsx("br",{}),d.details]}),d.errors&&d.errors.length>0&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("strong",{style:{color:"#ff6b6b"},children:"Errors Found:"}),e.jsx("br",{}),d.errors.map((u,h)=>e.jsxs("div",{style:{color:"#ff6b6b",marginLeft:"20px"},children:[" ",u]},h))]}),d.warnings&&d.warnings.length>0&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("strong",{style:{color:"#ffa726"},children:"Warnings:"}),e.jsx("br",{}),d.warnings.map((u,h)=>e.jsxs("div",{style:{color:"#ffa726",marginLeft:"20px"},children:[" ",u]},h))]}),d.fullOutput&&e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("strong",{children:"Full Test Output:"}),e.jsx("br",{}),e.jsx("div",{style:{backgroundColor:"#000",padding:"10px",borderRadius:"4px",marginTop:"10px",fontSize:"12px"},children:d.fullOutput})]})]}):null;return e.jsxs("div",{style:{padding:"20px",backgroundColor:"#2a2a2a",borderRadius:"8px",margin:"20px 0"},children:[e.jsx("h2",{style:{color:"#fff",marginBottom:"20px"},children:" Comprehensive Ladder Test Suite"}),e.jsxs("p",{style:{color:"#ccc",marginBottom:"20px"},children:["This test simulates real user interactions with the ladder system, including:",e.jsx("br",{})," User registration and login",e.jsx("br",{})," Ladder signup and player management",e.jsx("br",{})," Challenge creation and match reporting",e.jsx("br",{})," Payment processing and admin functions"]}),e.jsx("button",{onClick:l,disabled:s,style:{background:s?"linear-gradient(135deg, #666, #888)":"linear-gradient(135deg, #ff6b35, #f7931e)",color:"white",border:"none",padding:"12px 24px",borderRadius:"6px",cursor:s?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.3s ease"},children:s?" Running Test...":" Run Comprehensive Test"}),o&&e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#ff4444",color:"white",borderRadius:"6px"},children:[e.jsx("strong",{children:" Test Execution Error:"}),e.jsx("br",{}),o]}),t&&c(t),e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#1a1a1a",borderRadius:"6px",color:"#ccc",fontSize:"14px"},children:[e.jsx("strong",{children:" Note:"})," This test creates temporary test users and data. The test data is automatically cleaned up after completion."]})]})};function BN(n,t="double"){let r=[...n];r.length%2!==0&&r.push({id:null,name:"Bye",isBye:!0});const a=r.length,o=a-1,i=a/2,l=[];for(let c=0;c<o;c++){const d=[];for(let u=0;u<i;u++){const h=r[u],p=r[a-1-u];(!h.isBye||!p.isBye)&&d.push({player1:h,player2:p,isBye:h.isBye||p.isBye})}l.push({roundNumber:c+1,matches:d}),r.splice(1,0,r.pop())}if(t==="double"){const c=l.length;for(let d=0;d<c;d++){const h=l[d].matches.map(p=>({player1:p.player2,player2:p.player1,isBye:p.isBye}));l.push({roundNumber:l.length+1,matches:h})}}if(t==="triple"){const c=o;for(let d=0;d<c;d++){const h=l[d].matches.map(p=>({player1:p.player2,player2:p.player1,isBye:p.isBye}));l.push({roundNumber:l.length+1,matches:h})}for(let d=0;d<c;d++){const u=l[d];l.push({roundNumber:l.length+1,matches:[...u.matches]})}}return l}function bee(n,t){const a=n*.2,o=n-a,i=[];let l=0;for(let h=1;h<t;h++){const p=2+(h-1)/(t-2)*1.5;i.push(p),l+=p}const c=i.map(h=>Math.round(h/l*o));c.push(Math.round(a));const d=c.reduce((h,p)=>h+p,0),u=n-d;return c[c.length-1]+=u,c}function ON(n,t,r){const s=t+.5*r,a=s>0?Math.floor(n/s*100)/100:0,o=Math.floor(a/2*100)/100;return{perMatch:a,perBye:o,basePerMatch:a}}function vee(n){return n<=3?"triple":n<=8?"double":"single"}function wee(n,t,r){return BN(n,t).map((a,o)=>({...a,roundNumber:r+o}))}function jee(n){const t=[...n];for(let r=t.length-1;r>0;r--){const s=Math.floor(Math.random()*(r+1));[t[r],t[s]]=[t[s],t[r]]}return t}function zN(n,t){return t!=="mixed"?t:["8-Ball","9-Ball","10-Ball"][(n-1)%3]}function See(n,t,r,s){const a=[],o=[];return t.forEach((i,l)=>{const c=crypto.randomUUID(),d=zN(i.roundNumber,s),u=r[l]||0,h=i.matches.filter(f=>f.isBye).length,p=i.matches.length-h,g=ON(u,p,h);a.push({id:c,tournament_id:n,round_number:i.roundNumber,round_name:`Round ${i.roundNumber} (${d})`,game_type:d,prize_per_round:u,status:"pending"}),i.matches.forEach((f,m)=>{const v=f.isBye?g.perBye:g.perMatch;o.push({tournament_id:n,round_id:c,round_number:i.roundNumber,match_number:m+1,player1_id:f.player1.id,player1_name:f.player1.name,player2_id:f.player2.isBye?null:f.player2.id,player2_name:f.player2.isBye?null:f.player2.name,is_bye:f.isBye,payout_amount:v,status:f.isBye?"completed":"pending",winner_id:f.isBye?f.player1.id:null,winner_name:f.isBye?f.player1.name:null})})}),{rounds:a,matches:o}}const n0={generateRoundRobin:BN,calculatePrizeDistribution:bee,calculateMatchPayouts:ON,determineRoundRobinType:vee,regenerateBracket:wee,shuffleArray:jee,getRoundGameType:zN,prepareDatabaseObjects:See},_ee={async seedLadderFromTournament(n,t){try{console.log(` Seeding ${t} ladder from tournament ${n}`);const{data:r,error:s}=await K.from("tournament_player_stats").select("*").eq("tournament_id",n).order("final_standing",{ascending:!0});if(s)throw s;if(!r||r.length===0)throw new Error("No tournament standings found");console.log(`Found ${r.length} players to seed`);const a=await mt.getLadderPlayersByName(t);if(!a.success)throw new Error("Failed to get current ladder players");const o=a.data||[];console.log(`Found ${o.length} existing ladder players`);const i=new Map;o.forEach(h=>{i.set(h.id,h)});const l=[],c=[];for(let h=0;h<r.length;h++){const p=r[h],g=h+1;i.has(p.player_id)?l.push({player_id:p.player_id,new_position:g,player_name:p.player_name}):(console.log(`Player ${p.player_name} not found in ladder, should be added`),c.push({player_id:p.player_id,position:g,player_name:p.player_name}))}console.log(`Updating ${l.length} player positions`);for(const h of l){const{error:p}=await K.from("ladder_players").update({position:h.new_position,updated_at:new Date().toISOString()}).eq("id",h.player_id).eq("ladder_name",t);p?console.error(`Failed to update ${h.player_name}:`,p):console.log(` Updated ${h.player_name} to position ${h.new_position}`)}const d=r.map(h=>h.player_id),u=o.filter(h=>!d.includes(h.id));console.log(`Shifting ${u.length} non-tournament players down`),u.sort((h,p)=>h.position-p.position);for(let h=0;h<u.length;h++){const p=r.length+h+1,{error:g}=await K.from("ladder_players").update({position:p,updated_at:new Date().toISOString()}).eq("id",u[h].id).eq("ladder_name",t);g&&console.error(`Failed to shift ${u[h].firstName}:`,g)}return console.log(" Ladder seeding complete!"),{success:!0,seededPlayers:r.length,shiftedPlayers:u.length,standings:r}}catch(r){return console.error("Error seeding ladder:",r),{success:!1,error:r.message}}},async initializeNewPeriod(n){try{const t=new Date().toISOString(),{data:r,error:s}=await K.from("ladder_players").select("*").eq("ladder_name",n).eq("is_active",!0);if(s)throw s;for(const a of r)await K.from("ladder_players").update({period_start_position:a.position,period_start_date:t,positions_climbed:0}).eq("id",a.id);return console.log(` Initialized new period for ${r.length} players in ${n}`),{success:!0,playersInitialized:r.length}}catch(t){return console.error("Error initializing period:",t),{success:!1,error:t.message}}},async completeTournamentAndSeedLadder(n,t){try{const{data:r}=await K.from("tournament_events").select("*").eq("id",n).single();if(!r)throw new Error("Tournament not found");const s=await this.seedLadderFromTournament(n,t);if(!s.success)throw new Error(s.error);const a=await this.initializeNewPeriod(t);return a.success||console.warn("Failed to initialize period:",a.error),await K.from("tournament_events").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",n),console.log(" Tournament complete and ladder seeded!"),{success:!0,seededPlayers:s.seededPlayers,shiftedPlayers:s.shiftedPlayers,standings:s.standings,periodInitialized:a.success}}catch(r){return console.error("Error completing tournament and seeding ladder:",r),{success:!1,error:r.message}}}},kee=({match:n,onResultSubmitted:t,onCancel:r})=>{const[s,a]=y.useState(""),[o,i]=y.useState(""),[l,c]=y.useState(!1),[d,u]=y.useState(null),h=async()=>{if(!s){u("Please select a winner");return}c(!0),u(null);try{const g=s==="player1"?n.player1_id:n.player2_id,f=s==="player1"?n.player1_name:n.player2_name,m=s==="player1"?n.player2_id:n.player1_id,v=s==="player1"?n.player2_name:n.player1_name,b=await Gr.updateMatchResult(n.id,g,f,m,v,o||null);b.success?t&&t(b.data):u(b.error||"Failed to submit result")}catch(g){console.error("Error submitting result:",g),u("An error occurred while submitting the result")}finally{c(!1)}},p=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g);return e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.95)",borderRadius:"12px",padding:"1.5rem",border:"2px solid #00ff00",maxWidth:"500px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#00ff00",margin:"0 0 0.5rem 0",fontSize:"1.3rem"},children:"Enter Match Result"}),e.jsxs("div",{style:{color:"#8b5cf6",fontSize:"0.9rem"},children:["Round ",n.round_number,"  Match ",n.match_number]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[e.jsx("div",{style:{color:"#ffc107",fontSize:"1.2rem",fontWeight:"bold"},children:p(n.payout_amount)}),e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Prize Money"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},children:[e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"0.75rem",background:s==="player1"?"rgba(0, 255, 0, 0.2)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:s==="player1"?"2px solid #00ff00":"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>a("player1"),children:[e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"bold"},children:n.player1_name}),s==="player1"&&e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginTop:"0.25rem"},children:" Winner"})]}),e.jsx("div",{style:{color:"#666",fontSize:"1.5rem",fontWeight:"bold"},children:"VS"}),e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"0.75rem",background:s==="player2"?"rgba(0, 255, 0, 0.2)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:s==="player2"?"2px solid #00ff00":"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>a("player2"),children:[e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"bold"},children:n.player2_name}),s==="player2"&&e.jsx("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginTop:"0.25rem"},children:" Winner"})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{color:"#ccc",fontSize:"0.9rem",display:"block",marginBottom:"0.5rem"},children:"Score (Optional)"}),e.jsxs("select",{value:o,onChange:g=>i(g.target.value),style:{width:"100%",padding:"0.75rem",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",fontSize:"1rem"},children:[e.jsx("option",{value:"",children:"Select Score (Optional)"}),e.jsx("option",{value:"7-0",children:"7-0"}),e.jsx("option",{value:"7-1",children:"7-1"}),e.jsx("option",{value:"7-2",children:"7-2"}),e.jsx("option",{value:"7-3",children:"7-3"}),e.jsx("option",{value:"7-4",children:"7-4"}),e.jsx("option",{value:"7-5",children:"7-5"}),e.jsx("option",{value:"7-6",children:"7-6"}),e.jsx("option",{value:"8-0",children:"8-0"}),e.jsx("option",{value:"8-1",children:"8-1"}),e.jsx("option",{value:"8-2",children:"8-2"}),e.jsx("option",{value:"8-3",children:"8-3"}),e.jsx("option",{value:"8-4",children:"8-4"}),e.jsx("option",{value:"8-5",children:"8-5"}),e.jsx("option",{value:"8-6",children:"8-6"}),e.jsx("option",{value:"8-7",children:"8-7"}),e.jsx("option",{value:"9-0",children:"9-0"}),e.jsx("option",{value:"9-1",children:"9-1"}),e.jsx("option",{value:"9-2",children:"9-2"}),e.jsx("option",{value:"9-3",children:"9-3"}),e.jsx("option",{value:"9-4",children:"9-4"}),e.jsx("option",{value:"9-5",children:"9-5"}),e.jsx("option",{value:"9-6",children:"9-6"}),e.jsx("option",{value:"9-7",children:"9-7"}),e.jsx("option",{value:"9-8",children:"9-8"}),e.jsx("option",{value:"10-0",children:"10-0"}),e.jsx("option",{value:"10-1",children:"10-1"}),e.jsx("option",{value:"10-2",children:"10-2"}),e.jsx("option",{value:"10-3",children:"10-3"}),e.jsx("option",{value:"10-4",children:"10-4"}),e.jsx("option",{value:"10-5",children:"10-5"}),e.jsx("option",{value:"10-6",children:"10-6"}),e.jsx("option",{value:"10-7",children:"10-7"}),e.jsx("option",{value:"10-8",children:"10-8"}),e.jsx("option",{value:"10-9",children:"10-9"})]})]}),d&&e.jsx("div",{style:{background:"rgba(255, 0, 0, 0.1)",border:"1px solid rgba(255, 0, 0, 0.3)",borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:"#ff4444",textAlign:"center"},children:d}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsx("button",{onClick:r,disabled:l,style:{padding:"0.75rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"1rem",fontWeight:"bold",cursor:l?"not-allowed":"pointer",opacity:l?.5:1},children:"Cancel"}),e.jsx("button",{onClick:h,disabled:l||!s,style:{padding:"0.75rem",background:s&&!l?"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)":"rgba(100, 100, 100, 0.3)",border:"none",borderRadius:"8px",color:s&&!l?"#000":"#666",fontSize:"1rem",fontWeight:"bold",cursor:s&&!l?"pointer":"not-allowed"},children:l?"Submitting...":"Submit Result"})]})]})},$2=({tournamentId:n,autoRefresh:t=!0,standingsData:r=null,currentRound:s=null,tournament:a=null})=>{const[o,i]=y.useState([]),[l,c]=y.useState(!0),[d,u]=y.useState(null),[h,p]=y.useState(null),g=s&&s.round_name==="King of the Hill";console.log(" TournamentStandingsTable - isKingOfTheHill:",g,"round_name:",s==null?void 0:s.round_name),y.useEffect(()=>{if(r){console.log(" Using provided standings data (instant update)"),i(r),c(!1);return}},[r]),y.useEffect(()=>{if(!r&&(f(),t)){const x=Gr.subscribeToStandings(n,m);p(x);const j=setInterval(f,3e4);return()=>{x&&Gr.unsubscribe(x),clearInterval(j)}}},[n,t,r]);const f=async()=>{try{const x=await Gr.getTournamentStandings(n);x.success?i(x.data):u("Failed to load standings")}catch(x){console.error("Error fetching standings:",x),u("Error loading standings")}finally{c(!1)}},m=x=>{console.log("Standings update:",x),f()},v=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),b=(x,j)=>{const S=x+j;return S===0?0:Math.round(x/S*100)},w=x=>{switch(x){case 0:return"";case 1:return"";case 2:return"";default:return""}};return l?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#00ff00"},children:"Loading standings..."}):d?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#ff4444"},children:d}):e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",borderRadius:"12px",border:"1px solid rgba(0, 255, 0, 0.3)",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)",padding:"1rem",textAlign:"center"},children:[e.jsx("h3",{style:{color:"#000",margin:0,fontSize:"1.3rem",fontWeight:"bold"},children:" Live Standings"}),t&&e.jsxs("div",{style:{color:"rgba(0,0,0,0.7)",fontSize:"0.8rem",marginTop:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#000",animation:"pulse 2s infinite"}}),"Live Updates"]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.95rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(0, 255, 0, 0.1)",borderBottom:"2px solid rgba(0, 255, 0, 0.3)"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#00ff00",fontWeight:"bold"},children:"Rank"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#00ff00",fontWeight:"bold"},children:"Player"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#00ff00",fontWeight:"bold"},children:"W-L"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#00ff00",fontWeight:"bold"},children:"Win %"}),g&&e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#ff9800",fontWeight:"bold"},children:" KOH Losses"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",color:"#00ff00",fontWeight:"bold"},children:"Earned"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#00ff00",fontWeight:"bold"},children:"Status"})]})}),e.jsx("tbody",{children:o.map((x,j)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",background:x.eliminated?"rgba(255, 0, 0, 0.1)":j<3?"rgba(0, 255, 0, 0.05)":"transparent",opacity:x.eliminated?.6:1},children:[e.jsxs("td",{style:{padding:"0.75rem",color:"#fff",fontWeight:"bold"},children:[w(j)," #",j+1]}),e.jsxs("td",{style:{padding:"0.75rem",color:x.eliminated?"#999":"#fff",fontWeight:"bold"},children:[x.player_name,x.eliminated&&e.jsx("span",{style:{textDecoration:"line-through",marginLeft:"0.5rem",color:"#ff4444"},children:""})]}),e.jsxs("td",{style:{padding:"0.75rem",textAlign:"center",color:x.eliminated?"#999":"#fff"},children:[e.jsx("span",{style:{color:"#00ff00"},children:x.wins})," - ",e.jsx("span",{style:{color:"#ff4444"},children:x.losses})]}),e.jsxs("td",{style:{padding:"0.75rem",textAlign:"center",color:x.eliminated?"#999":"#ffc107",fontWeight:"bold"},children:[b(x.wins,x.losses),"%"]}),g&&e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",color:x.eliminated?"#999":"#ff9800",fontWeight:"bold",background:(x.koh_losses||0)>=2?"rgba(255, 152, 0, 0.2)":"transparent"},children:x.koh_losses||0}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",color:x.eliminated?"#999":"#00ff00",fontWeight:"bold",fontSize:"1.1rem"},children:v(x.total_payout)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:x.eliminated?e.jsx("span",{style:{background:"rgba(255, 0, 0, 0.2)",border:"1px solid rgba(255, 0, 0, 0.5)",borderRadius:"12px",padding:"0.25rem 0.75rem",fontSize:"0.85rem",color:"#ff4444",fontWeight:"bold"},children:"Eliminated"}):g&&(x.koh_losses||0)===1?e.jsx("span",{style:{background:"rgba(255, 152, 0, 0.2)",border:"1px solid rgba(255, 152, 0, 0.5)",borderRadius:"12px",padding:"0.25rem 0.75rem",fontSize:"0.85rem",color:"#ff9800",fontWeight:"bold"},children:" 1 KOH Loss Away"}):!g&&x.losses===2?e.jsx("span",{style:{background:"rgba(255, 152, 0, 0.2)",border:"1px solid rgba(255, 152, 0, 0.5)",borderRadius:"12px",padding:"0.25rem 0.75rem",fontSize:"0.85rem",color:"#ff9800",fontWeight:"bold"},children:" 1 Loss Away"}):!g&&x.losses===1?e.jsx("span",{style:{background:"rgba(255, 193, 7, 0.2)",border:"1px solid rgba(255, 193, 7, 0.5)",borderRadius:"12px",padding:"0.25rem 0.75rem",fontSize:"0.85rem",color:"#ffc107",fontWeight:"bold"},children:" 2 Losses Away"}):e.jsx("span",{style:{background:"rgba(0, 255, 0, 0.2)",border:"1px solid rgba(0, 255, 0, 0.5)",borderRadius:"12px",padding:"0.25rem 0.75rem",fontSize:"0.85rem",color:"#00ff00",fontWeight:"bold"},children:"Active"})})]},x.id))})]})}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",justifyContent:"space-around",textAlign:"center",fontSize:"0.9rem",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontWeight:"bold",fontSize:"1.2rem"},children:o.filter(x=>!x.eliminated).length}),e.jsx("div",{style:{color:"#ccc"},children:"Active"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ff4444",fontWeight:"bold",fontSize:"1.2rem"},children:o.filter(x=>x.eliminated).length}),e.jsx("div",{style:{color:"#ccc"},children:"Eliminated"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontWeight:"bold",fontSize:"1.1rem"},children:v(a.total_prize_pool)}),e.jsx("div",{style:{color:"#ccc"},children:"Prize Pool"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ffd700",fontWeight:"bold",fontSize:"1.1rem"},children:v(a.first_place_prize||0)}),e.jsx("div",{style:{color:"#ccc"},children:"1st Place"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ffc107",fontWeight:"bold",fontSize:"1.1rem"},children:(()=>{const x=o.reduce((j,S)=>j+(S.total_payout||0),0);return v(x)})()}),e.jsx("div",{style:{color:"#ccc"},children:"Total Paid"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"1.1rem"},children:(()=>{const x=o.reduce((S,_)=>S+(_.total_payout||0),0),j=a.first_place_prize||0;return v(a.total_prize_pool-x-j)})()}),e.jsx("div",{style:{color:"#ccc"},children:"Remaining"})]})]})]}),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})},Cee=n=>n<=1?0:n===2?1:(n-1)*2,Nee=()=>{const[n,t]=y.useState([]),[r,s]=y.useState(null),[a,o]=y.useState(null),[i,l]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState(!1),[p,g]=y.useState([]),[f,m]=y.useState(null),[v,b]=y.useState(!0),[w,x]=y.useState(null),[j,S]=y.useState(!1),[_,C]=y.useState(null),N=Te.useRef(r),M=Te.useRef(_);Te.useEffect(()=>{N.current=r},[r]),Te.useEffect(()=>{M.current=_},[_]),y.useEffect(()=>{console.log(" TournamentAdminDashboard mounted!"),E();const O=setInterval(()=>{const oe=N.current,me=M.current,Ce=oe&&oe.status==="in-progress",ve=Date.now(),De=me&&ve-me<=5e3;Ce&&!De?(console.log(" Auto-updating tournament stats..."),k()):Ce&&De&&console.log(" Skipping auto-update (recent match update)")},3e4);return m(O),()=>{O&&clearInterval(O)}},[]),y.useEffect(()=>{r&&P()},[r==null?void 0:r.id]);const E=async()=>{b(!0);try{const{data:O,error:oe}=await K.from("tournament_events").select("*").order("tournament_date",{ascending:!0});if(oe)throw oe;const me=await Promise.all((O||[]).map(async Ce=>{const{data:ve}=await K.from("tournament_rounds").select("prize_per_round").eq("tournament_id",Ce.id).eq("round_name","King of the Hill").eq("status","in-progress").limit(1),{data:De}=await K.from("tournament_player_stats").select("total_payout").eq("tournament_id",Ce.id),Oe=(De||[]).reduce((Ze,et)=>Ze+(et.total_payout||0),0);return ve&&ve.length>0?{...Ce,in_koh:!0,koh_bonus_for_first:0,total_paid_to_players:Oe}:{...Ce,total_paid_to_players:Oe}}));t(me)}catch(O){console.error("Error loading tournaments:",O)}finally{b(!1)}},P=async()=>{try{const{data:O}=await K.from("tournament_events").select("*").eq("id",r.id).single();if(O&&s(O),!O||O.status!=="completed"){await D();const me=await Gr.getCurrentRound(r.id);me.success&&me.data&&(o(me.data),l(me.data.matches||[]))}else o(null),l([]);const oe=await Gr.getTournamentStandings(r.id);oe.success&&d(oe.data||[])}catch(O){console.error("Error loading tournament details:",O)}},D=async()=>{var O,oe,me,Ce,ve;try{const De=await Gr.getCurrentRound(r.id);if(!De.success||!De.data)return;const Oe=De.data,Ze=Oe.matches||[];if(Ze.every(re=>re.status==="completed")&&Ze.length>0){console.log(` Round ${Oe.round_number} complete! Processing matches and checking eliminations...`),await k(),await T();const{data:re}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id).eq("eliminated",!1).order("wins",{ascending:!1});console.log(` Remaining active players: ${(re==null?void 0:re.length)||0}`),console.log(" Active players:",re==null?void 0:re.map(I=>`${I.player_name} (${I.losses} losses)`));const je=c.length;let V;if(je<=6?V=3:je<=10||je<=15?V=4:V=6,Oe&&Oe.round_name==="King of the Hill"){console.log(" King of the Hill round - creating new matches for remaining players");const I=c.reduce((ht,Je)=>ht+(Je.total_payout||0),0),X=r.first_place_prize||0,fe=r.total_prize_pool-X,ne=Math.max(0,fe-I),{data:ye}=await K.from("tournament_matches").select("*").eq("round_id",Oe.id).eq("status","completed").order("completed_at",{ascending:!1}).limit(1);let ot=2;try{const{data:ht}=await K.from("tournament_rounds").select("koh_round_number").eq("id",Oe.id).single();ot=((ht==null?void 0:ht.koh_round_number)||1)+1}catch{console.log(" KOH round tracking column not available yet, using default round 2")}const{data:lt}=await K.from("tournament_rounds").select("prize_per_round").eq("tournament_id",r.id).eq("round_name","King of the Hill").order("created_at",{ascending:!0}).limit(1),tt=((O=lt==null?void 0:lt[0])==null?void 0:O.prize_per_round)||ne,ge={id:crypto.randomUUID(),tournament_id:r.id,round_number:999+ot,round_name:"King of the Hill",koh_round_number:ot,prize_per_round:tt,status:"in-progress",created_at:new Date().toISOString()},{error:xt}=await K.from("tournament_rounds").insert(ge);if(xt){console.error("Error creating new KOH round:",xt);return}if(await K.from("tournament_rounds").update({status:"completed"}).eq("id",Oe.id),Object.assign(Oe,ge),re&&re.length===1){console.log(" KING OF THE HILL COMPLETE! Only 1 player remaining - declaring winner!");const ht=re[0],{data:Je}=await K.from("tournament_rounds").select("prize_per_round").eq("tournament_id",r.id).eq("round_name","King of the Hill").order("created_at",{ascending:!0}).limit(1),Pe=((oe=Je==null?void 0:Je[0])==null?void 0:oe.prize_per_round)||0,{data:Ve}=await K.from("tournament_matches").select("payout_amount, tournament_rounds!inner(round_name)").eq("tournament_id",r.id).eq("tournament_rounds.round_name","King of the Hill").eq("status","completed"),we=(Ve==null?void 0:Ve.reduce((rt,yt)=>rt+(yt.payout_amount||0),0))||0,Re=Math.max(0,Pe-we);console.log(` DEBUG COMPLETION: KOH Pool=${H(Pe)}, KOH Matches Paid=${H(we)}, Remaining for Winner=${H(Re)}`),console.log(` Final Winner Award: Total Remaining=${H(Re)} (all goes to winner)`),Re>0?(await K.from("tournament_player_stats").update({total_payout:(ht.total_payout||0)+Re}).eq("id",ht.id),console.log(` Awarded ALL remaining ${H(Re)} to ${ht.player_name}`)):console.log(" No remaining prize pool to award"),await K.from("tournament_rounds").update({status:"completed"}).eq("id",Oe.id),await K.from("tournament_events").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",r.id),console.log(` KING OF THE HILL WINNER: ${ht.player_name}!`),s({...r,status:"completed"}),o(null),l([]),alert(` CASH CLIMB COMPLETE!

Winner: ${ht.player_name}

Final Payout: ${H(Re)}
(Includes 1st place prize + all remaining funds)

Tournament has been marked as completed.`);const it=await Gr.getTournamentStandings(r.id);it.success&&d(it.data||[]);return}if(re&&re.length>=2){const ht=[],Je=re,{data:Pe}=await K.from("tournament_rounds").select("prize_per_round").eq("tournament_id",r.id).eq("round_name","King of the Hill").order("created_at",{ascending:!0}).limit(1),Ve=((me=Pe==null?void 0:Pe[0])==null?void 0:me.prize_per_round)||ne,{data:we}=await K.from("tournament_player_stats").select("player_id").eq("tournament_id",r.id).eq("in_koh",!0),it=((we==null?void 0:we.length)||Je.length)*2,rt=Ve,yt=[];let kt=0;for(let Le=1;Le<=it;Le++){const Z=1+(Le-1)/Math.max(1,it-1)*.5;yt.push(Z),kt+=Z}const Ct=yt.map(Le=>Math.round(Le/kt*rt*100)/100),te=Ct.reduce((Le,Z)=>Le+Z,0),ke=rt-te;Ct[Ct.length-1]+=ke;const{data:We}=await K.from("tournament_matches").select("id").eq("tournament_id",r.id).in("round_number",[999,1e3,1001,1002,1003,1004]).eq("status","completed");let st=(We==null?void 0:We.length)||0,Ft=1;if(Je.length===2){console.log(" Head-to-head mode: 2 players remaining");const Le=Ct[st]||Ct[Ct.length-1]||0;console.log(` KOH Match ${st+1} payout: ${H(Le)} (index: ${st}, array length: ${Ct.length})`);const Z={id:crypto.randomUUID(),tournament_id:r.id,round_id:Oe.id,round_number:Oe.round_number,match_number:Ft++,player1_id:Je[0].player_id,player1_name:Je[0].player_name,player2_id:Je[1].player_id,player2_name:Je[1].player_name,is_bye:!1,status:"pending",payout_amount:Le};ht.push(Z)}else if(Je.length===3){console.log(" Winner stays mode: 3 players remaining");let Le,Z;if(ye&&ye.length>0){const pt=ye[0],Tt=pt.winner_id,Wt=pt.loser_id;console.log(` Last match: Winner ${pt.winner_name}, Loser ${pt.loser_name}`),console.log(" All players:",Je.map(Pr=>`${Pr.player_name} (${Pr.player_id})`));const ir=Je.find(Pr=>Pr.player_id===Tt),rr=Je.find(Pr=>Pr.player_id!==Tt&&Pr.player_id!==Wt);ir&&rr?(Le=ir,Z=rr,console.log(` Winner ${ir.player_name} stays, plays sitting player ${rr.player_name}`)):(console.log(` Could not find winner or sitting player. Winner: ${ir==null?void 0:ir.player_name}, Sitting: ${rr==null?void 0:rr.player_name}`),Le=Je[0],Z=Je[1],console.log(` Fallback - starting with ${Le.player_name} vs ${Z.player_name}`))}else Le=Je[0],Z=Je[1],console.log(` First KOH match with 3 players: ${Le.player_name} vs ${Z.player_name}`);const Ye=Ct[st]||Ct[Ct.length-1]||0;console.log(` KOH Match ${st+1} payout: ${H(Ye)} (index: ${st}, array length: ${Ct.length})`);const dt={id:crypto.randomUUID(),tournament_id:r.id,round_id:Oe.id,round_number:Oe.round_number,match_number:Ft++,player1_id:Le.player_id,player1_name:Le.player_name,player2_id:Z.player_id,player2_name:Z.player_name,is_bye:!1,status:"pending",payout_amount:Ye};ht.push(dt)}else{console.log(" Round-robin mode: 4+ players remaining");for(let Le=0;Le<Je.length;Le+=2)if(Le+1<Je.length){const Z=Ct[st]||Ct[Ct.length-1]||0;console.log(` KOH Match ${st+1} payout: ${H(Z)} (index: ${st}, array length: ${Ct.length})`);const Ye={id:crypto.randomUUID(),tournament_id:r.id,round_id:Oe.id,round_number:Oe.round_number,match_number:Ft++,player1_id:Je[Le].player_id,player1_name:Je[Le].player_name,player2_id:Je[Le+1].player_id,player2_name:Je[Le+1].player_name,is_bye:!1,status:"pending",payout_amount:Z};ht.push(Ye),st++}}if(console.log(` Created ${ht.length} match(es) for ${Je.length} players in KOH continuation`),ht.length>0){const{error:Le}=await K.from("tournament_matches").insert(ht);if(Le)console.error("Error creating new King of the Hill matches:",Le);else{console.log(` Created ${ht.length} new King of the Hill matches for ${Je.length} players`),console.log(" Reloading round after KOH continuation match creation...");const Z=await Gr.getCurrentRound(r.id);console.log(" Round result:",Z),Z.success&&Z.data?(console.log(" Setting current round and matches:",Z.data),o(Z.data),l(Z.data.matches||[]),console.log(" Matches set:",((Ce=Z.data.matches)==null?void 0:Ce.length)||0)):console.error(" Failed to load round after KOH continuation match creation:",Z)}}}return}if(re&&re.length<=V&&re.length>=2){const{data:I}=await K.from("tournament_rounds").select("*").eq("tournament_id",r.id).eq("round_name","King of the Hill");if(I&&I.length>0){console.log(" King of the Hill round already exists, skipping creation");return}console.log(` KING OF THE HILL! Starting final ${re.length}-player round...`),await K.from("tournament_rounds").update({status:"completed"}).eq("id",Oe.id);for(const Le of re){const{data:Z}=await K.from("tournament_player_stats").select("wins, losses").eq("id",Le.id).single();Z?(await K.from("tournament_player_stats").update({koh_wins:Z.wins,koh_losses:0,in_koh:!0}).eq("id",Le.id),console.log(` Initialized ${Le.player_name} for King of the Hill: ${Z.wins} wins, 0 KOH losses`)):console.error(` Could not fetch fresh data for ${Le.player_name}`)}const X=await Gr.getTournamentStandings(r.id),ne=(X.success?X.data:c).reduce((Le,Z)=>Le+(Z.total_payout||0),0),ye=r.first_place_prize||0,ot=r.total_prize_pool,lt=Math.max(0,ot-ne-ye);console.log(` KOH Prize Pool Calculation: Total=${H(ot)}, Paid Out=${H(ne)}, 1st Place Reserve=${H(ye)}, KOH Pool=${H(lt)}`),console.log(` DEBUG: totalPrizePool=${ot}, totalPaidOut=${ne}, firstPlacePrize=${ye}, remainingPrizePool=${lt}`);const tt=lt,ge=re.length*2;console.log(` KOH Breakdown: 100% distributed across ${ge} possible matches, winner gets leftover if tournament ends early`);const xt=[];let ht=0;for(let Le=1;Le<=ge;Le++){const Z=1+(Le-1)/Math.max(1,ge-1)*.5;xt.push(Z),ht+=Z,console.log(` Weight ${Le}: ${Z}`)}console.log(` Total weight: ${ht}`);const Je=xt.map(Le=>Math.round(Le/ht*tt*100)/100),Pe=Je.reduce((Le,Z)=>Le+Z,0),Ve=tt-Pe;Je[Je.length-1]+=Ve,console.log(` KOH Escalating Payouts (${ge} matches total):`,Je.map(Le=>H(Le))),console.log(` DEBUG: kohMatchPool=${tt}, maxKOHMatches=${ge}, totalDistributed=${Je.reduce((Le,Z)=>Le+Z,0)}`),console.log(" DEBUG RAW PAYOUTS:",Je);let we,Re=1;try{const{data:Le}=await K.from("tournament_rounds").select("koh_round_number").eq("tournament_id",r.id).eq("round_name","King of the Hill").not("koh_round_number","is",null).order("koh_round_number",{ascending:!1}).limit(1);Re=Le&&Le.length>0?Le[0].koh_round_number+1:1}catch{console.log(" KOH round tracking column not available yet, using default round 1")}we={id:crypto.randomUUID(),tournament_id:r.id,round_number:999+Re,round_name:"King of the Hill",koh_round_number:Re,prize_per_round:lt,status:"in-progress",created_at:new Date().toISOString()};const{error:it}=await K.from("tournament_rounds").insert(we);if(it)if(console.error("Error creating King of the Hill round:",it),it.code==="23505"){console.log(" Duplicate key error - trying to find existing King of the Hill round...");const{data:Le}=await K.from("tournament_rounds").select("*").eq("tournament_id",r.id).eq("round_name","King of the Hill");if(Le&&Le.length>0)console.log(" Found existing King of the Hill round after duplicate error"),we=Le[0];else{console.error(" Could not find existing King of the Hill round");return}}else return;console.log(" Created King of the Hill round");const{data:rt}=await K.from("tournament_matches").select("*").eq("round_id",we.id);if(rt&&rt.length>0){console.log(" King of the Hill matches already exist, skipping creation"),alert(` CASH CLIMB!

Final ${re.length} players - losses reset to 0!

Each player gets 2 losses in this round.

Prize Structure:
 100% of Cash Climb pool for escalating match payouts
 Payouts increase each match!
 Winner takes all remaining funds!

Let the climbing begin!`);return}const{data:yt}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id).eq("eliminated",!1).order("wins",{ascending:!1});if(console.log(" Fresh active players for King of the Hill:",yt==null?void 0:yt.map(Le=>`${Le.player_name} (eliminated: ${Le.eliminated})`)),!yt||yt.length<2){console.error(" Need at least 2 active players for King of the Hill, got:",yt==null?void 0:yt.length),alert(" Error: Need at least 2 active players for Cash Climb");return}console.log(` King of the Hill Prize Pool: ${H(lt)}`),console.log(` 100% for escalating match payouts: ${H(tt)}`),console.log(" Winner gets remaining funds");const{data:kt}=await K.from("tournament_matches").select("id").eq("tournament_id",r.id).in("round_number",[999,1e3,1001,1002,1003,1004]).eq("status","completed"),Ct=(kt==null?void 0:kt.length)||0;console.log(` Current KOH match counter: ${Ct}`);const te=[],ke=yt;let We=1,Fe=Ct;if(ke.length===2){console.log(" Initial KOH setup - Head-to-head mode: 2 players");const Le=Je[Fe]||Je[Je.length-1]||0;console.log(` Match ${Fe+1} payout: ${H(Le)} (index: ${Fe}, array length: ${Je.length})`),te.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:we.id,round_number:we.round_number,match_number:We++,player1_id:ke[0].player_id,player1_name:ke[0].player_name,player2_id:ke[1].player_id,player2_name:ke[1].player_name,is_bye:!1,status:"pending",payout_amount:Le})}else if(ke.length===3){console.log(" Initial KOH setup - Winner stays mode: 3 players");const Le=Je[Fe]||Je[Je.length-1]||0;console.log(` Match ${Fe+1} payout: ${H(Le)} (index: ${Fe}, array length: ${Je.length})`),te.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:we.id,round_number:we.round_number,match_number:We++,player1_id:ke[0].player_id,player1_name:ke[0].player_name,player2_id:ke[1].player_id,player2_name:ke[1].player_name,is_bye:!1,status:"pending",payout_amount:Le})}else{console.log(" Initial KOH setup - Round-robin mode: 4+ players");for(let Le=0;Le<ke.length;Le+=2)if(Le+1<ke.length){const Z=Je[Fe]||Je[Je.length-1]||0;console.log(` Match ${Fe+1} payout: ${H(Z)} (index: ${Fe}, array length: ${Je.length})`),te.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:we.id,round_number:we.round_number,match_number:We++,player1_id:ke[Le].player_id,player1_name:ke[Le].player_name,player2_id:ke[Le+1].player_id,player2_name:ke[Le+1].player_name,is_bye:!1,status:"pending",payout_amount:Z}),Fe++}}console.log(` Created ${te.length} match(es) for ${ke.length} players in initial KOH setup`);const{error:st}=await K.from("tournament_matches").insert(te);if(st){console.error("Error creating King of the Hill matches:",st);return}console.log(` Created ${te.length} King of the Hill matches`),console.log(" Reloading round after KOH match creation...");const Ft=await Gr.getCurrentRound(r.id);console.log(" Round result:",Ft),Ft.success&&Ft.data?(console.log(" Setting current round and matches:",Ft.data),o(Ft.data),l(Ft.data.matches||[]),console.log(" Matches set:",((ve=Ft.data.matches)==null?void 0:ve.length)||0)):console.error(" Failed to load round after KOH match creation:",Ft),alert(` CASH CLIMB!

Final ${re.length} players - losses reset to 0!
Each player gets 2 losses in this round.
Winner takes the remaining prize pool!`),await E();return}if(re&&re.length<=1){if(console.log(" TOURNAMENT OVER! Only 1 player remaining - declaring winner!"),await K.from("tournament_rounds").update({status:"completed"}).eq("id",Oe.id),await K.from("tournament_events").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",r.id),re.length===1){const I=re[0],X=r.first_place_prize||0;if(X>0){const ye=c.reduce((ge,xt)=>ge+(xt.total_payout||0),0),ot=r.total_prize_pool,lt=ot-ye,tt=Math.min(X,Math.max(0,lt));console.log(` Prize Pool Check: Total Pool: ${H(ot)}, Already Paid: ${H(ye)}, Remaining: ${H(lt)}, 1st Place Prize: ${H(tt)}`),tt>0?(await K.from("tournament_player_stats").update({total_payout:(I.total_payout||0)+tt}).eq("id",I.id),console.log(` Awarded 1st place prize of ${H(tt)} to ${I.player_name}`)):console.log(" Cannot award 1st place prize - would exceed total prize pool")}console.log(` TOURNAMENT WINNER: ${I.player_name}!`);const fe=X>0?Math.min(X,Math.max(0,r.total_prize_pool-c.reduce((ye,ot)=>ye+(ot.total_payout||0),0))):0;s({...r,status:"completed"}),o(null),l([]),alert(` TOURNAMENT COMPLETE!

Winner: ${I.player_name}

1st Place Prize: ${H(fe)}

Tournament has been marked as completed.`);const ne=await Gr.getTournamentStandings(r.id);ne.success&&d(ne.data||[])}else{console.log(" No players remaining - tournament ended with no winner"),s({...r,status:"completed"}),o(null),l([]),alert(" Tournament ended with no players remaining.");const I=await Gr.getTournamentStandings(r.id);I.success&&d(I.data||[])}return}await K.from("tournament_rounds").update({status:"completed"}).eq("id",Oe.id);const{data:F,error:ae}=await K.from("tournament_rounds").select("*").eq("tournament_id",r.id).eq("round_number",Oe.round_number+1).single();F&&!ae?(re&&re.length>1&&await A(F,re),await K.from("tournament_rounds").update({status:"in-progress"}).eq("id",F.id),console.log(` Advanced to Round ${F.round_number}`)):console.log(" Tournament complete - no more rounds!")}}catch(De){console.error("Error checking eliminations and advancing round:",De)}},T=async()=>{try{console.log(" Checking for eliminated players...");const O=await Gr.getCurrentRound(r.id),oe=O.success&&O.data&&O.data.round_name==="King of the Hill",me=oe?2:3;console.log(` Elimination threshold: ${me} losses (${oe?"King of the Hill":"Regular"})`);const{data:Ce,error:ve}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id);if(ve)throw ve;for(const De of Ce||[]){const Oe=oe?De.koh_losses||0:De.losses;Oe>=me&&!De.eliminated&&(console.log(` Player ${De.player_name} eliminated (${Oe} losses in ${oe?"King of the Hill":"regular"} round)`),await K.from("tournament_player_stats").update({eliminated:!0,eliminated_at:new Date().toISOString()}).eq("id",De.id))}}catch(O){console.error("Error checking eliminations:",O)}},A=async(O,oe)=>{try{console.log(` Adjusting bye matches for Round ${O.round_number}...`);const{data:Ce}=await K.from("tournament_player_stats").select("player_id, player_name").eq("tournament_id",r.id).eq("eliminated",!0),ve=(Ce==null?void 0:Ce.map(ne=>ne.player_id))||[];console.log(` Eliminated players: ${ve.length}`,Ce==null?void 0:Ce.map(ne=>ne.player_name));const{data:De}=await K.from("tournament_matches").select("*").eq("round_id",O.id);console.log(` Existing matches in Round ${O.round_number}: ${(De==null?void 0:De.length)||0}`);const Oe=(De==null?void 0:De.filter(ne=>ve.includes(ne.player1_id)||ne.player2_id&&ve.includes(ne.player2_id)))||[];if(Oe.length>0){console.log(` Deleting ${Oe.length} matches involving eliminated players...`);for(const ne of Oe)await K.from("tournament_matches").delete().eq("id",ne.id),console.log(`    Deleted: ${ne.player1_name} vs ${ne.player2_name}`)}const{data:Ze}=await K.from("tournament_matches").select("*").eq("round_id",O.id);console.log(` Remaining matches after deletion: ${(Ze==null?void 0:Ze.length)||0}`),Ze&&Ze.length>0&&Ze.forEach(ne=>{console.log(`   - ${ne.player1_name} vs ${ne.player2_name} (${ne.is_bye?"BYE":"REGULAR"})`)});const et=oe.length,re=et%2===1;if(console.log(` Active players: ${et} (${re?"ODD":"EVEN"})`),re){const ne=(Ze==null?void 0:Ze.filter(ye=>ye.is_bye))||[];if(ne.length===0){console.log(" Odd number of players - inserting bye match...");const ye=new Set;Ze==null||Ze.forEach(rt=>{rt.is_bye||(ye.add(rt.player1_id),rt.player2_id&&ye.add(rt.player2_id))}),console.log(" Players already in matches:",Array.from(ye));const ot={},{data:lt}=await K.from("tournament_matches").select("*").eq("tournament_id",r.id).eq("is_bye",!0);for(const rt of lt||[])ot[rt.player1_id]=(ot[rt.player1_id]||0)+1;console.log("Player bye counts:",ot);const tt=oe.filter(rt=>!ye.has(rt.player_id));if(console.log(" Available players for bye:",tt.map(rt=>rt.player_name)),tt.length===0){console.error(" No available players for bye match!");return}let ge=tt[0],xt=ot[ge.player_id]||0;for(const rt of tt){const yt=ot[rt.player_id]||0;yt<xt&&(xt=yt,ge=rt)}console.log(`Selected player for bye: ${ge.player_name} (${xt} previous byes)`);const{data:ht}=await K.from("tournament_matches").select("match_number").eq("round_id",O.id).order("match_number",{ascending:!1}).limit(1),Je=ht&&ht.length>0?ht[0].match_number+1:1,Pe=De==null?void 0:De.find(rt=>!rt.is_bye),Ve=(Pe==null?void 0:Pe.payout_amount)||0,we=Math.floor(Ve/2*100)/100,Re={id:crypto.randomUUID(),tournament_id:r.id,round_id:O.id,round_number:O.round_number,match_number:Je,player1_id:ge.player_id,player1_name:ge.player_name,player2_id:null,player2_name:"BYE",is_bye:!0,status:"completed",winner_id:ge.player_id,winner_name:ge.player_name,score:"BYE",payout_amount:we,processed:!1};console.log("Inserting bye match:",Re);const{error:it}=await K.from("tournament_matches").insert(Re);if(it)throw console.error("Error inserting bye match:",it),console.error("Bye match data that failed:",Re),console.error("Full error details:",JSON.stringify(it,null,2)),it;console.log(` Created bye match for ${ge.player_name}`);var me=!0}else{console.log(` Bye match already exists for this round (${ne.length} found)`);var me=!1}}else{console.log(" Even number of players - removing bye matches...");var me=!1;const ye=(De==null?void 0:De.filter(ge=>ge.is_bye))||[];if(ye.length>0){for(const ge of ye)await K.from("tournament_matches").delete().eq("id",ge.id);console.log(` Removed ${ye.length} bye matches`)}const{data:ot}=await K.from("tournament_matches").select("*").eq("round_id",O.id),lt=new Set;(ot||[]).forEach(ge=>{ge.is_bye||(lt.add(ge.player1_id),ge.player2_id&&lt.add(ge.player2_id))});const tt=oe.filter(ge=>!lt.has(ge.player_id));if(console.log(` Unscheduled players this round: ${tt.map(ge=>ge.player_name).join(", ")||"None"}`),tt.length>=2){const{data:ge}=await K.from("tournament_matches").select("match_number").eq("round_id",O.id).order("match_number",{ascending:!1}).limit(1);let xt=ge&&ge.length>0?(ge[0].match_number||0)+1:1;const ht=Ze==null?void 0:Ze.find(Ve=>!Ve.is_bye),Je=(ht==null?void 0:ht.payout_amount)||0;console.log(` Round ${O.round_number}: Using payout from existing matches = ${H(Je)}`);const Pe=[];for(let Ve=0;Ve+1<tt.length;Ve+=2){const we=tt[Ve],Re=tt[Ve+1];Pe.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:O.id,round_number:O.round_number,match_number:xt++,player1_id:we.player_id,player1_name:we.player_name,player2_id:Re.player_id,player2_name:Re.player_name,is_bye:!1,status:"pending",payout_amount:Je})}if(Pe.length>0){const{error:Ve}=await K.from("tournament_matches").insert(Pe);Ve?console.error(" Error inserting missing even-pair matches:",Ve):console.log(` Inserted ${Pe.length} missing match(es) to complete the round`)}}}const{data:je}=await K.from("tournament_matches").select("*").eq("round_id",O.id),V=(je==null?void 0:je.filter(ne=>ne.is_bye).length)||0,Ee=((je==null?void 0:je.length)||0)-V,F=O.prize_per_round||0,ae=Ee+.5*V,I=ae>0?Math.floor(F/ae*100)/100:0,X=Math.floor(I/2*100)/100;console.log(` Recalculating Round ${O.round_number} payouts: ${Ee} regular + ${V} bye, regular=${H(I)}, bye=${H(X)}`);const fe=new Set;for(const ne of je||[]){const ye=ne.is_bye?X:I;ne.payout_amount!==ye&&(ne.status==="completed"&&ne.winner_id&&fe.add(ne.winner_id),await K.from("tournament_matches").update({payout_amount:ye}).eq("id",ne.id))}if(fe.size>0||me){console.log(` Reloading standings after payout recalculation (affected: ${fe.size}, bye created: ${me})`);const ne=await Gr.getTournamentStandings(r.id);ne.success&&d(ne.data||[])}}catch(Ce){console.error("Error adjusting bye matches:",Ce)}},k=async()=>{try{if(!r||!r.id){console.log(" No tournament selected, skipping processCompletedMatches");return}const{data:O,error:oe}=await K.from("tournament_matches").select("*").eq("tournament_id",r.id).eq("status","completed").or("processed.is.null,processed.eq.false");if(oe)throw oe;console.log(" Processing completed matches:",O);const me=await Gr.getCurrentRound(r.id),Ce=me.success&&me.data&&me.data.round_name==="King of the Hill";for(const ve of O||[]){const{data:De,error:Oe}=await K.from("tournament_player_stats").select("wins, koh_wins, total_payout").eq("tournament_id",r.id).eq("player_id",ve.winner_id).single();if(Oe)throw Oe;if(Ce){const{error:et}=await K.from("tournament_player_stats").update({koh_wins:(De.koh_wins||0)+1,total_payout:(De.total_payout||0)+ve.payout_amount}).eq("tournament_id",r.id).eq("player_id",ve.winner_id);if(et)throw et}else{const{error:et}=await K.from("tournament_player_stats").update({wins:(De.wins||0)+1,total_payout:(De.total_payout||0)+ve.payout_amount}).eq("tournament_id",r.id).eq("player_id",ve.winner_id);if(et)throw et}if(!ve.is_bye&&ve.player2_id){const{data:et,error:re}=await K.from("tournament_player_stats").select("losses, koh_losses").eq("tournament_id",r.id).eq("player_id",ve.player2_id).single();if(re)throw re;if(Ce){const{error:je}=await K.from("tournament_player_stats").update({koh_losses:(et.koh_losses||0)+1}).eq("tournament_id",r.id).eq("player_id",ve.player2_id);if(je)throw je}else{const{error:je}=await K.from("tournament_player_stats").update({losses:(et.losses||0)+1}).eq("tournament_id",r.id).eq("player_id",ve.player2_id);if(je)throw je}}const{error:Ze}=await K.from("tournament_matches").update({processed:!0}).eq("id",ve.id);if(Ze)throw Ze}}catch(O){console.error("Error processing completed matches:",O)}},R=async()=>{if(r)try{const O=await Gr.getTournamentRegistrations(r.id);if(!O.success){alert("Failed to load registrations");return}const oe=O.data.filter(X=>X.payment_status==="paid");if(oe.length<2){alert("Need at least 2 paid players to generate bracket");return}const me=oe.map(X=>({id:X.player_id,name:X.player_name,email:X.email,fargoRate:X.fargo_rate})),Ce=n0.generateRoundRobin(me,r.round_robin_type),ve=r.first_place_prize||0,De=r.total_prize_pool-ve,Oe=n0.calculatePrizeDistribution(De,Ce.length),{rounds:Ze,matches:et}=n0.prepareDatabaseObjects(r.id,Ce,Oe,r.game_type),{data:re,error:je}=await K.from("tournament_rounds").insert(Ze).select();if(je)throw je;const V={};re.forEach(X=>{V[X.id]=X.id});const Ee=et.map(X=>{var fe;return{...X,round_id:(fe=re.find(ne=>ne.round_number===X.round_number))==null?void 0:fe.id}}),{error:F}=await K.from("tournament_matches").insert(Ee);if(F)throw F;const ae=me.map(X=>({tournament_id:r.id,player_id:X.id,player_name:X.name,wins:0,losses:0,total_payout:0,is_eliminated:!1})),{error:I}=await K.from("tournament_player_stats").insert(ae);if(I)throw I;await K.from("tournament_events").update({status:"in-progress"}).eq("id",r.id),alert(`Bracket generated! ${Ce.length} rounds with ${et.length} matches created.`),s({...r,status:"in-progress"}),P()}catch(O){console.error("Error generating bracket:",O),alert("Failed to generate bracket: "+O.message)}},U=async(O,oe,me,Ce,ve,De)=>{try{C(Date.now()),x(null),console.log(" Match completed - updating UI INSTANTLY..."),l(V=>V.map(Ee=>Ee.id===O.id?{...Ee,status:"completed",winner_id:oe,winner_name:me,loser_id:Ce,loser_name:ve,score:De,completed_at:new Date().toISOString()}:Ee)),console.log(" Matches updated immediately"),console.log(" Updating standings state immediately...");const Oe=a&&a.round_name==="King of the Hill";if(console.log(` Match result - isKingOfTheHill: ${Oe}, currentRound: ${a==null?void 0:a.round_name}`),d(V=>{const Ee=V.map(F=>{if(F.player_id===oe)return Oe?{...F,koh_wins:(F.koh_wins||F.wins)+1,total_payout:F.total_payout+(O.payout_amount||0)}:{...F,wins:F.wins+1,total_payout:F.total_payout+(O.payout_amount||0)};if(Ce&&F.player_id===Ce)if(Oe){const ae=(F.koh_losses||0)+1;return{...F,koh_losses:ae,eliminated:ae>=2,eliminated_at:ae>=2?new Date().toISOString():null}}else{const ae=F.losses+1;return{...F,losses:ae,eliminated:ae>=3,eliminated_at:ae>=3?new Date().toISOString():null}}return F});return console.log(" Standings updated immediately in state"),Ee}),console.log(" Saving to database in background..."),!(await Gr.updateMatchResult(O.id,oe,me,Ce,ve,De)).success){alert("Failed to update match");return}await K.from("tournament_matches").update({processed:!0}).eq("id",O.id);const{data:et}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id).eq("player_id",oe).single();if(et){const V=a&&a.round_name==="King of the Hill";if(console.log(` DB Update - isKingOfTheHill: ${V}, currentRound: ${a==null?void 0:a.round_name}`),V){console.log(` Updating KOH winner stats in DB: ${me} (${et.koh_wins||0}  ${(et.koh_wins||0)+1} KOH wins)`),console.log(` DEBUG KOH PAYOUT: ${me} getting ${H(O.payout_amount)} (was ${H(et.total_payout)}, now ${H(et.total_payout+O.payout_amount)})`);const{error:Ee}=await K.from("tournament_player_stats").update({koh_wins:(et.koh_wins||0)+1,total_payout:et.total_payout+O.payout_amount}).eq("id",et.id);Ee?console.error("Error updating winner stats:",Ee):console.log(" Winner KOH stats saved to DB")}else{console.log(` Updating winner stats in DB: ${me} (${et.wins}  ${et.wins+1} wins)`);const{error:Ee}=await K.from("tournament_player_stats").update({wins:et.wins+1,total_payout:et.total_payout+O.payout_amount}).eq("id",et.id);Ee?console.error("Error updating winner stats:",Ee):console.log(" Winner stats saved to DB")}}else console.error(` Winner stats not found for ${me} (${oe})`);if(Ce){const{data:V}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id).eq("player_id",Ce).single();if(V){const Ee=a&&a.round_name==="King of the Hill";if(console.log(` DB Loser Update - isKingOfTheHill: ${Ee}, currentRound: ${a==null?void 0:a.round_name}`),Ee){const F=(V.koh_losses||0)+1;console.log(` Updating KOH loser stats in DB: ${ve} (${V.koh_losses||0}  ${F} KOH losses)`);const{error:ae}=await K.from("tournament_player_stats").update({koh_losses:F,eliminated:F>=2,eliminated_at:F>=2?new Date().toISOString():null}).eq("id",V.id);ae?console.error("Error updating loser KOH stats:",ae):console.log(" Loser KOH stats saved to DB")}else{const F=V.losses+1;console.log(` Updating loser stats in DB: ${ve} (${V.losses}  ${F} losses)`);const{error:ae}=await K.from("tournament_player_stats").update({losses:F,eliminated:F>=3,eliminated_at:F>=3?new Date().toISOString():null}).eq("id",V.id);ae?console.error("Error updating loser stats:",ae):console.log(" Loser stats saved to DB"),F>=3&&alert(`${ve} has been eliminated! (${F} losses)`)}}else console.error(` Loser stats not found for ${ve} (${Ce})`)}console.log(" All database updates complete"),console.log(" Checking if round is complete..."),await D();const re=await Gr.getCurrentRound(r.id);re.success&&re.data&&(o(re.data),l(re.data.matches||[]),console.log(` Loaded Round ${re.data.round_number} matches`));const je=await Gr.getTournamentStandings(r.id);je.success&&(d(je.data||[]),console.log(" Standings reloaded from database"))}catch(Oe){console.error("Error processing match result:",Oe),alert("Failed to process match result")}},z=async()=>{try{const{data:O,error:oe}=await K.from("tournament_matches").select(`
          *,
          round:tournament_rounds(round_number, round_name)
        `).eq("tournament_id",r.id).order("round_number",{ascending:!0}).order("match_number",{ascending:!0});if(oe)throw oe;g(O||[]),h(!0)}catch(O){console.error("Error loading match history:",O),alert("Failed to load match history")}},$=async()=>{if(!(!r||!window.confirm(`Delete "${r.ladder_name} Tournament"?

This will permanently delete:
- All tournament data
- All matches and results
- All player stats
- All rounds and brackets

This action cannot be undone!`)))try{await K.from("tournament_matches").delete().eq("tournament_id",r.id),await K.from("tournament_player_stats").delete().eq("tournament_id",r.id),await K.from("tournament_rounds").delete().eq("tournament_id",r.id),await K.from("tournament_registrations").delete().eq("tournament_id",r.id),await K.from("tournament_events").delete().eq("id",r.id),alert(" Tournament deleted successfully!"),s(null),await E()}catch(oe){console.error("Error deleting tournament:",oe),alert("Failed to delete tournament: "+oe.message)}},W=async()=>{try{console.log(" Creating new test tournament...");const O=new Date,oe=60,me=Math.floor(oe*.1*100)/100,Ce={ladder_name:"500-549",tournament_date:O.toISOString(),registration_open_date:O.toISOString(),registration_close_date:new Date(O.getTime()+24*60*60*1e3).toISOString(),game_type:"8-Ball",round_robin_type:"double",total_prize_pool:oe,first_place_prize:me,entry_fee:20,ladder_seed_amount:30,status:"registration"};console.log("Tournament data:",Ce);const{data:ve,error:De}=await K.from("tournament_events").insert(Ce).select().single();if(De)throw console.error("Tournament creation error:",De),De;console.log(" Tournament created:",ve);const Oe=[{player_id:crypto.randomUUID(),player_name:"Alice Johnson",email:"alice@test.com",fargo_rate:525,payment_status:"paid"},{player_id:crypto.randomUUID(),player_name:"Bob Smith",email:"bob@test.com",fargo_rate:510,payment_status:"paid"},{player_id:crypto.randomUUID(),player_name:"Carol Davis",email:"carol@test.com",fargo_rate:520,payment_status:"paid"},{player_id:crypto.randomUUID(),player_name:"Dave Wilson",email:"dave@test.com",fargo_rate:515,payment_status:"paid"},{player_id:crypto.randomUUID(),player_name:"Eve Martinez",email:"eve@test.com",fargo_rate:530,payment_status:"paid"},{player_id:crypto.randomUUID(),player_name:"Frank Brown",email:"frank@test.com",fargo_rate:535,payment_status:"paid"}];console.log("Adding test players...");for(const Ze of Oe){const et={tournament_id:ve.id,...Ze};console.log("Adding player:",et);const{error:re}=await K.from("tournament_registrations").insert(et);if(re)throw console.error("Player registration error:",re),re}console.log(" All players added successfully"),alert(" New test tournament created successfully!"),await E(),s(ve)}catch(O){console.error("Error creating test tournament:",O),alert("Failed to create test tournament: "+O.message)}},Y=async()=>{if(!(!r||!window.confirm(`Complete this tournament and seed TEST LADDER positions?

This will:
- Calculate final standings
- Assign ladder positions to "TOURNAMENT-TEST-LADDER"
- Initialize new 3-month competition period
- Mark tournament as completed

 SAFE: This will NOT affect your real ladder data!

This action cannot be undone.`)))try{const oe="TOURNAMENT-TEST-LADDER",me=await _ee.completeTournamentAndSeedLadder(r.id,oe);if(!me.success){alert("Failed to complete tournament: "+me.error);return}alert(` Tournament Complete!

Ladder Seeded:
 ${me.seededPlayers} tournament players positioned
 ${me.shiftedPlayers} existing players shifted down
 New 3-month period initialized

Top 3:
`+me.standings.slice(0,3).map((Ce,ve)=>`${ve+1}. ${Ce.player_name} (${Ce.wins}-${Ce.losses}) - $${Ce.total_payout.toFixed(2)}`).join(`
`)),E(),s(null)}catch(oe){console.error("Error completing tournament:",oe),alert("Failed to complete tournament: "+oe.message)}},Q=O=>new Date(O).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),H=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),ue=O=>{switch(O){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return O}},J=i.filter(O=>O.status==="pending"),be=i.filter(O=>O.status==="completed"),Ae=c.filter(O=>!O.is_eliminated).length;return e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.9)",minHeight:"100vh",padding:"2rem",color:"#fff"},children:[e.jsxs("div",{style:{marginBottom:"2rem",textAlign:"center"},children:[e.jsx("h1",{style:{color:"#00ff00",margin:"0 0 0.5rem 0"},children:" Tournament Management"}),e.jsx("p",{style:{color:"#ccc",margin:0},children:"Admin Dashboard"})]}),r?e.jsxs("div",{children:[e.jsx("button",{onClick:()=>s(null),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",padding:"0.5rem 1rem",color:"#fff",cursor:"pointer",marginBottom:"1.5rem"},children:" Back to All Tournaments"}),e.jsxs("div",{style:{background:"rgba(0, 255, 0, 0.1)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",border:"1px solid rgba(0, 255, 0, 0.3)"},children:[e.jsxs("h2",{style:{color:"#00ff00",margin:"0 0 1rem 0"},children:[ue(r.ladder_name)," Tournament"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Date"}),e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"bold"},children:Q(r.tournament_date)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Status"}),e.jsx("div",{style:{color:"#ffc107",fontSize:"1.1rem",fontWeight:"bold"},children:r.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Prize Pool"}),e.jsx("div",{style:{color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold"},children:H(r.total_prize_pool)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"1st Place Prize"}),e.jsx("div",{style:{color:"#ffd700",fontSize:"1.1rem",fontWeight:"bold"},children:H(r.first_place_prize||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Total Paid Out"}),e.jsx("div",{style:{color:"#ffc107",fontSize:"1.1rem",fontWeight:"bold"},children:(()=>{const O=c.reduce((oe,me)=>oe+(me.total_payout||0),0);return H(O)})()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Remaining"}),e.jsx("div",{style:{color:"#ff9800",fontSize:"1.1rem",fontWeight:"bold"},children:(()=>{const oe=r.first_place_prize||0,me=c.reduce((Ce,ve)=>Ce+(ve.total_payout||0),0);return H(r.total_prize_pool-me-oe)})()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Players"}),e.jsxs("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"bold"},children:[c.length," total / ",Ae," active"]})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem",display:"flex",gap:"1rem"},children:[r.status==="registration"&&e.jsx("button",{onClick:R,style:{background:"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#000",fontWeight:"bold",cursor:"pointer"},children:" Generate Bracket"}),r.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:z,style:{background:"linear-gradient(135deg, #2196f3 0%, #1976d2 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer",marginRight:"1rem"},children:" Match History"}),e.jsx("button",{onClick:Y,style:{background:"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#000",fontWeight:"bold",cursor:"pointer",marginRight:"1rem"},children:" Complete Tournament & Seed Ladder"})]}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[e.jsx("button",{onClick:$,style:{background:"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer"},children:" Delete Test Tournament"}),e.jsx("button",{onClick:W,style:{background:"linear-gradient(135deg, #4caf50 0%, #388e3c 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer"},children:" Create New Test Tournament"}),r.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:async()=>{console.log(" Manual refresh - updating stats..."),await k(),await P()},style:{background:"linear-gradient(135deg, #2196f3 0%, #1976d2 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer",marginRight:"1rem"},children:" Refresh Stats"}),e.jsx("button",{onClick:async()=>{console.log(" Manual King of the Hill trigger..."),await D()},style:{background:"linear-gradient(135deg, #ff9800 0%, #f57c00 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer",marginRight:"1rem"},children:" Check Cash Climb"}),e.jsx("button",{onClick:async()=>{console.log(" FORCE King of the Hill - manual trigger...");const{data:O}=await K.from("tournament_player_stats").select("*").eq("tournament_id",r.id).eq("eliminated",!1).order("wins",{ascending:!1});if(console.log(" Current active players:",O==null?void 0:O.length,O==null?void 0:O.map(oe=>oe.player_name)),O&&O.length>=2){const oe=c.length;let me;oe<=6?me=3:oe<=10||oe<=15?me=4:me=6;const Ce=Math.min(O.length,me),ve=O.slice(0,Ce);console.log(` Forcing King of the Hill with ${ve.length} players (threshold: ${me}):`,ve.map(I=>I.player_name));for(const I of ve){const{data:X}=await K.from("tournament_player_stats").select("wins, losses").eq("id",I.id).single();X?(await K.from("tournament_player_stats").update({koh_wins:X.wins,koh_losses:0,in_koh:!0}).eq("id",I.id),console.log(` Initialized ${I.player_name} for King of the Hill: ${X.wins} wins, 0 KOH losses`)):console.error(` Could not fetch fresh data for ${I.player_name}`)}const De={id:crypto.randomUUID(),tournament_id:r.id,round_number:999,round_name:"King of the Hill",status:"in-progress",created_at:new Date().toISOString()},{error:Oe}=await K.from("tournament_rounds").insert(De);if(Oe){console.error("Error creating King of the Hill round:",Oe),alert(" Error creating Cash Climb round");return}const Ze=c.reduce((I,X)=>I+(X.total_payout||0),0),et=r.first_place_prize||0,je=r.total_prize_pool-et-Ze,V=Cee(ve.length),Ee=Math.floor(je*.8/V*100)/100;console.log(` King of the Hill Prize Pool: ${H(je)}`),console.log(` Max Possible Matches: ${V}`),console.log(` Per Match Payout: ${H(Ee)}`);const F=[];let ae=1;if(ve.length===2)console.log(" FORCE KOH - Head-to-head mode: 2 players"),F.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:De.id,match_number:ae++,player1_id:ve[0].player_id,player1_name:ve[0].player_name,player2_id:ve[1].player_id,player2_name:ve[1].player_name,status:"pending",payout_amount:Ee,created_at:new Date().toISOString()});else if(ve.length===3)console.log(" FORCE KOH - Winner stays mode: 3 players"),F.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:De.id,match_number:ae++,player1_id:ve[0].player_id,player1_name:ve[0].player_name,player2_id:ve[1].player_id,player2_name:ve[1].player_name,status:"pending",payout_amount:Ee,created_at:new Date().toISOString()});else{console.log(" FORCE KOH - Round-robin mode: 4+ players");for(let I=0;I<ve.length;I+=2)I+1<ve.length&&F.push({id:crypto.randomUUID(),tournament_id:r.id,round_id:De.id,match_number:ae++,player1_id:ve[I].player_id,player1_name:ve[I].player_name,player2_id:ve[I+1].player_id,player2_name:ve[I+1].player_name,status:"pending",payout_amount:Ee,created_at:new Date().toISOString()})}console.log(` Created ${F.length} match(es) for ${ve.length} players in FORCE KOH`);for(const I of F)await K.from("tournament_matches").insert(I);console.log(" Created King of the Hill round and matches"),await P(),alert(` CASH CLIMB FORCED!

Top ${ve.length} players - losses reset to 0!
Each player gets 2 losses in this round.
Winner takes the remaining prize pool!`)}else alert(" Need at least 2 players for Cash Climb")},style:{background:"linear-gradient(135deg, #e91e63 0%, #c2185b 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#fff",fontWeight:"bold",cursor:"pointer"},children:" FORCE Cash Climb"})]})]})]})]}),r.status==="completed"&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #4caf50 0%, #388e3c 100%)",color:"#fff",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem",textAlign:"center",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.4)"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",marginBottom:"0.5rem"},children:" TOURNAMENT COMPLETE! "}),e.jsx("div",{style:{fontSize:"1.1rem",opacity:.9},children:"Final Standings Below"})]}),r.status==="in-progress"&&a&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{style:{color:a.round_name==="King of the Hill"?"#ff9800":"#8b5cf6",marginBottom:"1rem",fontSize:a.round_name==="King of the Hill"?"1.8rem":"1.2rem",fontWeight:a.round_name==="King of the Hill"?"bold":"normal",textShadow:a.round_name==="King of the Hill"?"2px 2px 4px rgba(0,0,0,0.3)":"none"},children:[a.round_name==="King of the Hill"?" ":"",a.round_name==="King of the Hill"?"CASH CLIMB":a.round_name,a.round_name==="King of the Hill"?" ":""," - ",a.round_name==="King of the Hill"?(()=>{const O=c.reduce((ve,De)=>ve+(De.total_payout||0),0),oe=r.total_prize_pool,me=r.first_place_prize||0,Ce=Math.max(0,oe-O-me);return H(Ce)})():H(a.prize_per_round)]}),a.round_name==="King of the Hill"&&e.jsx("div",{style:{background:"linear-gradient(135deg, #ff9800 0%, #f57c00 100%)",color:"#000",padding:"0.75rem 1.5rem",borderRadius:"8px",marginBottom:"1rem",fontWeight:"bold",textAlign:"center",boxShadow:"0 4px 8px rgba(255, 152, 0, 0.3)"},children:" FINAL ROUND: 2 losses = eliminated | Escalating payouts - later matches pay more! "}),e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:J.map(O=>e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"1rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.9rem",color:"#ccc",marginBottom:"0.5rem"},children:["Match ",O.match_number]}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold"},children:[O.player1_name,e.jsx("span",{style:{color:"#666",margin:"0 0.5rem"},children:"vs"}),O.player2_name||"BYE"]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{color:"#ffc107",fontSize:"1.2rem",fontWeight:"bold"},children:H(O.payout_amount)}),!O.is_bye&&e.jsx("button",{onClick:()=>x(O),style:{background:"rgba(0, 255, 0, 0.2)",border:"1px solid #00ff00",borderRadius:"6px",padding:"0.5rem 1rem",color:"#00ff00",fontWeight:"bold",cursor:"pointer",marginTop:"0.5rem"},children:"Enter Result"})]})]})},O.id))}),be.length>0&&e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsxs("h4",{style:{color:"#666",marginBottom:"0.75rem"},children:["Completed Matches (",be.length,")"]}),e.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:be.map(O=>e.jsx("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"6px",padding:"0.75rem",border:"1px solid rgba(255, 255, 255, 0.05)",opacity:.6},children:e.jsx("div",{style:{fontSize:"0.9rem"},children:O.is_bye?e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"#00ff00"},children:[" ",O.winner_name]}),e.jsx("span",{style:{color:"#666",margin:"0 0.5rem"},children:"def."}),e.jsx("span",{style:{color:"#ffc107",fontStyle:"italic"},children:"BYE"}),e.jsxs("span",{style:{color:"#666",marginLeft:"0.5rem",fontSize:"0.8rem"},children:["(automatic win - ",H(O.payout_amount||0),")"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"#00ff00"},children:[" ",O.winner_name]}),e.jsx("span",{style:{color:"#666",margin:"0 0.5rem"},children:"def."}),e.jsx("span",{style:{color:"#ff4444"},children:O.loser_name}),O.score&&e.jsxs("span",{style:{color:"#ccc",marginLeft:"0.5rem"},children:["(",O.score,")"]})]})})},O.id))})]})]}),u&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"flex-start",justifyContent:"center",zIndex:1e3,padding:"2rem 1rem 1rem 1rem",overflow:"auto"},children:e.jsxs("div",{style:{background:"#1a1a1a",borderRadius:"12px",padding:"1.5rem",width:"100%",maxWidth:"800px",maxHeight:"80vh",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",flexShrink:0},children:[e.jsx("h2",{style:{color:"#fff",margin:0,fontSize:"1.5rem"},children:" Tournament Match History"}),e.jsx("button",{onClick:()=>h(!1),style:{background:"#ff4444",border:"none",borderRadius:"6px",padding:"0.5rem 1rem",color:"#fff",cursor:"pointer",fontSize:"0.9rem"},children:" Close"})]}),e.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"0.5rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{color:"#fff",fontSize:"1.1rem",fontWeight:"bold",marginBottom:"0.5rem"},children:"Tournament Summary"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{color:"#00ff00",fontWeight:"bold"},children:p.filter(O=>O.status==="completed").length}),e.jsx("div",{style:{color:"#ccc"},children:"Completed"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ffc107",fontWeight:"bold"},children:p.filter(O=>O.status==="pending").length}),e.jsx("div",{style:{color:"#ccc"},children:"Pending"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"#ff9800",fontWeight:"bold"},children:p.length}),e.jsx("div",{style:{color:"#ccc"},children:"Total Matches"})]})]})]}),Array.from(new Set(p.map(O=>O.round_number))).sort((O,oe)=>O-oe).map(O=>{const oe=p.filter(ve=>ve.round_number===O),me=oe.filter(ve=>ve.status==="completed").length,Ce=oe.length;return e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{color:"#8b5cf6",fontWeight:"bold",fontSize:"1rem",marginBottom:"0.75rem",padding:"0.5rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"6px",textAlign:"center"},children:["Round ",O," (",me,"/",Ce," completed)"]}),e.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:oe.map(ve=>e.jsxs("div",{style:{background:ve.status==="completed"?"rgba(0, 255, 0, 0.1)":"rgba(255, 255, 255, 0.05)",border:`1px solid ${ve.status==="completed"?"rgba(0, 255, 0, 0.3)":"rgba(255, 255, 255, 0.1)"}`,borderRadius:"6px",padding:"0.75rem",fontSize:"0.85rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[e.jsxs("div",{style:{color:"#ccc",fontWeight:"bold"},children:["Match ",ve.match_number]}),e.jsx("div",{style:{color:ve.status==="completed"?"#00ff00":"#ffc107",fontSize:"0.8rem",fontWeight:"bold"},children:ve.status==="completed"?"":""})]}),ve.is_bye?e.jsxs("div",{style:{color:"#fff",textAlign:"center",fontSize:"0.8rem"},children:[e.jsx("span",{style:{color:"#00ff00"},children:ve.player1_name}),e.jsx("span",{style:{color:"#666",margin:"0 0.25rem"},children:"def."}),e.jsx("span",{style:{color:"#ffc107",fontStyle:"italic"},children:"BYE"}),e.jsx("span",{style:{color:"#666",marginLeft:"0.25rem",fontSize:"0.75rem"},children:"(bye win)"})]}):ve.status==="completed"?e.jsxs("div",{style:{color:"#fff",textAlign:"center",fontSize:"0.8rem"},children:[e.jsx("span",{style:{color:"#00ff00"},children:ve.winner_name}),e.jsx("span",{style:{color:"#666",margin:"0 0.25rem"},children:"def."}),e.jsx("span",{style:{color:"#ff4444"},children:ve.player1_id===ve.winner_id?ve.player2_name:ve.player1_name}),ve.score&&e.jsxs("span",{style:{color:"#ccc",marginLeft:"0.25rem"},children:["(",ve.score,")"]})]}):e.jsxs("div",{style:{color:"#fff",textAlign:"center",fontSize:"0.8rem"},children:[e.jsx("span",{children:ve.player1_name}),e.jsx("span",{style:{color:"#666",margin:"0 0.25rem"},children:"vs"}),e.jsx("span",{children:ve.player2_name})]}),e.jsx("div",{style:{color:"#ffc107",fontSize:"0.75rem",textAlign:"center",marginTop:"0.25rem"},children:H(ve.payout_amount)})]},ve.id))})]},O)})]})]})}),r.status==="in-progress"&&e.jsx("div",{style:{marginTop:"1.5rem"},children:e.jsx($2,{tournamentId:r.id,autoRefresh:!0,standingsData:c,currentRound:a,tournament:r})}),r.status==="completed"&&e.jsx("div",{style:{marginTop:"1.5rem"},children:e.jsx($2,{tournamentId:r.id,autoRefresh:!1,standingsData:c,currentRound:null,tournament:r})})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{color:"#fff",margin:0},children:"All Tournaments"}),e.jsx("button",{onClick:()=>S(!0),style:{background:"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",color:"#000",fontWeight:"bold",cursor:"pointer"},children:"+ Create Tournament"})]}),v?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"#00ff00"},children:"Loading tournaments..."}):n.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"#ccc"},children:["No tournaments found. Create one to get started!",e.jsx("div",{style:{marginTop:"2rem"},children:e.jsx("button",{onClick:W,style:{background:"linear-gradient(135deg, #4caf50 0%, #388e3c 100%)",border:"none",borderRadius:"8px",padding:"1rem 2rem",color:"#fff",fontWeight:"bold",cursor:"pointer",fontSize:"1.1rem"},children:" Create Test Tournament (6 Players)"})})]}):e.jsx("div",{style:{display:"grid",gap:"1rem"},children:n.map(O=>e.jsx("div",{onClick:()=>s(O),style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:oe=>{oe.currentTarget.style.background="rgba(0, 255, 0, 0.1)",oe.currentTarget.style.borderColor="#00ff00"},onMouseLeave:oe=>{oe.currentTarget.style.background="rgba(255, 255, 255, 0.05)",oe.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#00ff00",margin:"0 0 0.5rem 0"},children:[ue(O.ladder_name)," Ladder"]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[" ",Q(O.tournament_date)]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[" ",O.round_robin_type==="double"?"Double":O.round_robin_type==="triple"?"Triple":"Single"," Round Robin  ",O.game_type]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{background:O.status==="registration"?"rgba(0, 255, 0, 0.2)":O.status==="in-progress"?"rgba(255, 193, 7, 0.2)":"rgba(100, 100, 100, 0.2)",border:`1px solid ${O.status==="registration"?"#00ff00":O.status==="in-progress"?"#ffc107":"#666"}`,borderRadius:"12px",padding:"0.5rem 1rem",fontSize:"0.9rem",fontWeight:"bold",color:O.status==="registration"?"#00ff00":O.status==="in-progress"?"#ffc107":"#ccc",marginBottom:"0.5rem"},children:O.status.toUpperCase()}),e.jsx("div",{style:{color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold",marginBottom:"0.25rem"},children:H(O.total_prize_pool)}),e.jsxs("div",{style:{color:"#ffd700",fontSize:"0.9rem",fontWeight:"bold",marginBottom:"0.25rem"},children:["1st: ",H(O.first_place_prize||0)]}),e.jsxs("div",{style:{color:"#ffc107",fontSize:"0.8rem",marginBottom:"0.25rem"},children:["Paid: ",H(c.reduce((oe,me)=>oe+(me.total_payout||0),0))]}),e.jsxs("div",{style:{color:"#ff9800",fontSize:"0.8rem",marginBottom:"0.5rem"},children:["Left: ",H(O.total_prize_pool-c.reduce((oe,me)=>oe+(me.total_payout||0),0)-(O.first_place_prize||0))]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:[O.total_players," players"]})]})]})},O.id))})]}),w&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>x(null),children:e.jsx("div",{onClick:O=>O.stopPropagation(),children:e.jsx(kee,{match:w,onResultSubmitted:O=>{U(w,O.winner_id,O.winner_name,O.loser_id,O.loser_name,O.score)},onCancel:()=>x(null)})})})]})},Tee="_container_s6m15_1",Pee="_header_s6m15_14",Eee="_headerContent_s6m15_23",Ree="_ladderSelector_s6m15_30",Aee="_ladderSelect_s6m15_30",Mee="_headerButtons_s6m15_63",Iee="_addButton_s6m15_75",Dee="_createMatchButton_s6m15_91",$ee="_pendingMatchesButton_s6m15_113",Lee="_matchButton_s6m15_129",Bee="_historyButton_s6m15_151",Oee="_formOverlay_s6m15_167",zee="_form_s6m15_167",Fee="_formRow_s6m15_257",Wee="_formGroup_s6m15_264",Uee="_checkboxes_s6m15_325",qee="_formButtons_s6m15_344",Hee="_playersList_s6m15_374",Yee="_laddersContainer_s6m15_379",Gee="_ladderSection_s6m15_385",Vee="_ladderTitle_s6m15_392",Kee="_noPlayers_s6m15_402",Jee="_table_s6m15_413",Xee="_status_s6m15_442",Qee="_active_s6m15_451",Zee="_inactive_s6m15_456",ete="_pending_s6m15_113",tte="_matchType_s6m15_467",rte="_challenge_s6m15_477",nte="_smackdown_s6m15_483",ste="_smackback_s6m15_489",ate="_editButton_s6m15_502",ote="_deleteButton_s6m15_503",ite="_reportResultButton_s6m15_536",lte="_approveButton_s6m15_554",cte="_rejectButton_s6m15_555",dte="_moreOptionsButton_s6m15_592",ute="_pendingMatchesModal_s6m15_610",hte="_pendingMatchesTable_s6m15_618",pte="_playerName_s6m15_688",mte="_playerRole_s6m15_694",fte="_pendingMatchesSection_s6m15_701",gte="_matchHistorySection_s6m15_714",xte="_matchHistoryTable_s6m15_726",yte="_noData_s6m15_755",bte="_messageDisplay_s6m15_826",vte="_error_s6m15_837",wte="_matchActions_s6m15_844",jte="_editPendingMatchForm_s6m15_894",Ste="_submitButton_s6m15_955",_te="_cancelButton_s6m15_977",kte="_deleteConfirmModal_s6m15_995",Cte="_matchDetails_s6m15_1006",Nte="_warningText_s6m15_1021",at={container:Tee,header:Pee,headerContent:Eee,ladderSelector:Ree,ladderSelect:Aee,headerButtons:Mee,addButton:Iee,createMatchButton:Dee,pendingMatchesButton:$ee,matchButton:Lee,historyButton:Bee,formOverlay:Oee,form:zee,formRow:Fee,formGroup:Wee,checkboxes:Uee,formButtons:qee,playersList:Hee,laddersContainer:Yee,ladderSection:Gee,ladderTitle:Vee,noPlayers:Kee,table:Jee,status:Xee,active:Qee,inactive:Zee,pending:ete,matchType:tte,challenge:rte,smackdown:nte,smackback:ste,"fast-track":"_fast-track_s6m15_495",editButton:ate,deleteButton:ote,reportResultButton:ite,approveButton:lte,rejectButton:cte,moreOptionsButton:dte,pendingMatchesModal:ute,pendingMatchesTable:hte,playerName:pte,playerRole:mte,pendingMatchesSection:fte,matchHistorySection:gte,matchHistoryTable:xte,noData:yte,messageDisplay:bte,error:vte,matchActions:wte,editPendingMatchForm:jte,submitButton:Ste,cancelButton:_te,deleteConfirmModal:kte,matchDetails:Cte,warningText:Nte};function Tte({userToken:n}){var wt,Lt,yr,Sr,Bs,Za,jr,Dt,Ar,$r,dn,rs,un,Wn,tn,ns,le,_e,Me,he,Be,ct,$t,qe,jt,Bt,Ot,dr,ur,bn,Un,ms,fs,Cn,Ur,Cs,Ns,Ts,eo,to,Zo,Ki,Ji,Xi;const t="front-range-pool-hub",[r,s]=y.useState([]),[a,o]=y.useState("players"),[i,l]=y.useState([]),[c,d]=y.useState(!0),[u,h]=y.useState(null),[p,g]=y.useState(!1),[f,m]=y.useState({firstName:"",lastName:"",email:"",phone:"",fargoRate:"",location:"",isActive:!0,ladderName:"499-under",position:1,sanctioned:!1,sanctionYear:new Date().getFullYear(),lmsName:""}),[v,b]=y.useState("499-under"),[w,x]=y.useState(!1),[j,S]=y.useState({firstName:"",lastName:"",ladderName:"499-under",position:"",email:"",phone:"",fargoRate:"",location:"",notes:""}),[_,C]=y.useState(!1),[N,M]=y.useState(!1),[E,P]=y.useState(null),[D,T]=y.useState({matchId:"",challengerId:"",challengerName:"",challengerPosition:"",defenderId:"",defenderName:"",defenderPosition:"",winnerId:"",score:"",matchDate:Bp(),matchFormat:"race-to-5",matchType:"challenge",location:"",notes:""}),[A,k]=y.useState([]),[R,U]=y.useState(!1),[z,$]=y.useState([]),[W,Y]=y.useState(!1),[Q,H]=y.useState("all"),[ue,J]=y.useState(!1),[be,Ae]=y.useState({matchType:"challenge",challengerId:"",defenderId:"",matchFormat:"race-to-5",proposedDate:Bp(),location:"",notes:""}),[O,oe]=y.useState([]),[me,Ce]=y.useState(!1),[ve,De]=y.useState(!1),[Oe,Ze]=y.useState(!1),[et,re]=y.useState(null),[je,V]=y.useState(!1),[Ee,F]=y.useState({}),[ae,I]=y.useState(!1),[X,fe]=y.useState(null),[ne,ye]=y.useState(""),[ot,lt]=y.useState(!1),[tt,ge]=y.useState([]),[xt,ht]=y.useState(0),[Je,Pe]=y.useState(!1),[Ve,we]=y.useState({player1Id:"",player2Id:""}),[Re,it]=y.useState(!1),[rt,yt]=y.useState([]),[kt,Ct]=y.useState(!1),[te,ke]=y.useState(null),[We,Fe]=y.useState(!1),[st,Ft]=y.useState(null),Le=()=>{setTimeout(()=>{ye("")},5e3)},Z=B=>xr.createPortal(B,document.body),Ye=async()=>{try{const B=await mt.getLocations();B.success&&Array.isArray(B.data)?(s(B.data),console.log(`Loaded ${B.data.length} locations from Supabase`)):(console.error("Invalid locations response format:",B),s([]))}catch(B){console.error("Error fetching locations:",B),s([])}},dt=async()=>{try{const B=await mt.getLadderPlayersByName(v);if(B.success&&Array.isArray(B.data)){const Ne=B.data.map($e=>{var Ge,St,Yt;return{_id:$e.user_id,firstName:((Ge=$e.users)==null?void 0:Ge.first_name)||"Unknown",lastName:((St=$e.users)==null?void 0:St.last_name)||"Unknown",email:((Yt=$e.users)==null?void 0:Yt.email)||"unknown@email.com",position:$e.position,fargoRate:$e.fargo_rate||0,totalMatches:$e.total_matches||0,wins:$e.wins||0,losses:$e.losses||0,isActive:$e.is_active,ladderName:$e.ladder_name,immunityUntil:$e.immunity_until,vacationMode:$e.vacation_mode,vacationUntil:$e.vacation_until,isAdmin:$e.is_admin||!1,isSuspended:$e.is_suspended||!1,suspensionReason:$e.suspension_reason,suspensionUntil:$e.suspension_until,createdAt:$e.created_at,updatedAt:$e.updated_at}});l(Ne),console.log(`Loaded ${Ne.length} ladder players from Supabase`)}else console.error("Error fetching ladder players from Supabase:",B.error),l([])}catch(B){console.error("Error fetching ladder players:",B),l([])}finally{d(!1)}};y.useEffect(()=>{window.scrollTo(0,0),Ye(),dt()},[]),y.useEffect(()=>{dt()},[v]),y.useEffect(()=>{let B=null;const Ne=K.channel("admin-ladder-updates").on("postgres_changes",{event:"*",schema:"public",table:"ladder_profiles"},async $e=>{$e.new&&$e.new.ladder_name===v&&(B&&clearTimeout(B),B=setTimeout(async()=>{await dt()},500))}).subscribe();return()=>{B&&clearTimeout(B),K.removeChannel(Ne)}},[v]);const pt=B=>{const{name:Ne,value:$e,type:Ge,checked:St}=B.target;m(Yt=>({...Yt,[Ne]:Ge==="checkbox"?St:$e}))},Tt=B=>{const{name:Ne,value:$e}=B.target;S(Ge=>({...Ge,[Ne]:$e}))},Wt=async B=>{B.preventDefault();try{const Ne=await mt.registerPlayer(f);Ne.success?(g(!1),m({firstName:"",lastName:"",email:"",phone:"",fargoRate:"",location:"",isActive:!0,ladderName:"499-under"}),dt(),alert("Ladder player added successfully!")):alert("Error adding ladder player: "+(Ne.error||Ne.message))}catch(Ne){console.error("Error adding ladder player:",Ne),alert("Error adding ladder player")}},ir=async B=>{B.preventDefault();try{d(!0),ye(" Adding player to ladder...");const Ne=await mt.quickAddPlayerToLadder(j);Ne.success?(ye(` ${Ne.message}`),S({firstName:"",lastName:"",ladderName:v,position:"",email:"",phone:"",fargoRate:"",location:"",notes:""}),await dt(),setTimeout(()=>{x(!1),Le()},2e3)):(ye(` Error: ${Ne.error||Ne.message||"Unknown error"}`),setTimeout(()=>Le(),5e3))}catch(Ne){console.error("Error adding player to ladder:",Ne),ye(` Error adding player to ladder: ${Ne.message}`),setTimeout(()=>Le(),5e3)}finally{d(!1)}},rr=async B=>{B.preventDefault();try{console.log(` Frontend Debug: formData.ladderName=${f.ladderName}, editingPlayer.ladderName=${u.ladderName}`);const Ne=await mt.updatePlayer(u._id,{email:f.email,firstName:f.firstName,lastName:f.lastName,isActive:f.isActive,fargoRate:f.fargoRate,position:f.position,ladderName:f.ladderName,currentLadderName:u.ladderName,sanctioned:f.sanctioned,sanctionYear:f.sanctionYear,lmsName:f.lmsName});Ne.success?(h(null),m({name:"",email:"",phone:"",skillLevel:"",location:"",isActive:!0}),dt(),alert("Ladder player updated successfully!")):alert("Error updating ladder player: "+Ne.message)}catch(Ne){console.error("Error updating ladder player:",Ne),alert("Error updating ladder player")}},Pr=B=>{var Ne;h(B),m({firstName:B.firstName||"",lastName:B.lastName||"",email:((Ne=B.unifiedAccount)==null?void 0:Ne.email)||B.email||"",phone:B.phone||"",fargoRate:B.fargoRate||"",location:B.location||"",isActive:B.isActive!==!1,ladderName:B.ladderName||"499-under",position:B.position||1,sanctioned:B.sanctioned||!1,sanctionYear:B.sanctionYear||new Date().getFullYear(),lmsName:B.lmsName||""})},Fn=async B=>{if(confirm("Are you sure you want to remove this player from the ladder?"))try{const Ne=await mt.removePlayerFromLadder(B,v);Ne.success?(dt(),alert("Player removed from ladder successfully!")):alert("Error removing player: "+Ne.message)}catch(Ne){console.error("Error deleting ladder player:",Ne),alert("Error removing player from ladder")}},hs=B=>{const{name:Ne,value:$e}=B.target;T(Ge=>({...Ge,[Ne]:$e}))},cn=B=>{const Ne=B.target.value,$e=i.find(Ge=>Ge._id===Ne);$e&&T(Ge=>({...Ge,player1Id:Ne,player1Name:`${$e.firstName} ${$e.lastName}`,player1Position:$e.position}))},Ja=B=>{const Ne=B.target.value,$e=i.find(Ge=>Ge._id===Ne);$e&&T(Ge=>({...Ge,player2Id:Ne,player2Name:`${$e.firstName} ${$e.lastName}`,player2Position:$e.position}))},Dr=B=>{const Ne=B.target.value;T($e=>({...$e,winnerId:Ne}))},Jr=B=>{P(B),M(!0)},An=async B=>{if(B.preventDefault(),!E)return;const Ne=B.target,$e=Ne.winnerId.value,Ge=Ne.score.value,St=Ne.notes.value,Yt=Ne.matchDate.value;if(!$e||!Ge){alert("Please select a winner and enter a score");return}try{d(!0);const hr=await mt.updateMatchStatus(E.id,"completed",{winnerId:$e},Ge,St,Yt);hr.success?(alert("Match scored successfully!"),M(!1),P(null),await dt(),await zr()):alert(`Failed to score match: ${hr.error}`)}catch(hr){console.error("Error scoring match:",hr),alert("Error scoring match")}finally{d(!1)}},ua=async B=>{if(B.preventDefault(),!D.player1Id||!D.player2Id||!D.winnerId){alert("Please select both players and a winner");return}if(D.player1Id===D.player2Id){alert("Players must be different");return}try{if(d(!0),D.matchId){console.log(" Completing match in Supabase:",{matchId:D.matchId,winnerId:D.winnerId,player1Id:D.player1Id,player2Id:D.player2Id,score:D.score});const $e=await mt.updateMatchStatus(D.matchId,"completed",{winnerId:D.winnerId},D.score,D.notes);$e.success?(alert("Match result recorded successfully!"),C(!1),T({matchId:"",player1Id:"",player1Name:"",player1Position:"",player2Id:"",player2Name:"",player2Position:"",winnerId:"",score:"",matchDate:new Date().toISOString().split("T")[0],matchFormat:"race-to-5",matchType:"challenge",location:"",notes:""}),dt(),zr()):alert(`Match recording failed: ${$e.error}`)}else{const $e=await mt.createMatch({player1Id:D.player1Id,player2Id:D.player2Id,ladderName:v,matchType:D.matchType||"challenge",matchDate:new Date(D.matchDate).toISOString(),raceLength:parseInt(D.matchFormat.replace(/\D/g,""))||5,gameType:"9-ball",location:D.location,notes:D.notes});$e.success?(alert("Match created successfully!"),C(!1),T({matchId:"",player1Id:"",player1Name:"",player1Position:"",player2Id:"",player2Name:"",player2Position:"",winnerId:"",score:"",matchDate:new Date().toISOString().split("T")[0],matchFormat:"race-to-5",matchType:"challenge",location:"",notes:""}),dt(),zr()):alert(`Match creation failed: ${$e.error}`)}}catch(Ne){console.error("Error recording match result:",Ne),alert("Error recording match result")}finally{d(!1)}},ha=async()=>{try{d(!0),console.log(" Loading match history for ladder:",v);const B=await mt.getAllMatchesForLadder(v);if(B.success){console.log(" Match history data from Supabase:",B.matches);const Ne=B.matches.map($e=>{const Ge=$e.winner_name||"N/A",St=$e.loser_name||"N/A",[Yt,...hr]=Ge.split(" "),[vr,...rn]=St.split(" ");return{_id:$e.id,id:$e.id,challengerId:$e.challenger_id,defenderId:$e.defender_id,winnerId:$e.winner_id,loserId:$e.loser_id,challengerName:$e.challenger_name,defenderName:$e.defender_name,winnerName:Ge,loserName:St,winner:Ge!=="N/A"?{firstName:Yt,lastName:hr.join(" "),position:$e.winner_position||"removed"}:null,loser:St!=="N/A"?{firstName:vr,lastName:rn.join(" "),position:$e.loser_position||"removed"}:null,status:$e.status,matchType:$e.match_type,matchDate:$e.match_date,scheduledDate:$e.scheduled_date,completedDate:$e.match_date,location:$e.location,venue:$e.location,notes:$e.notes,score:$e.score,createdAt:$e.created_at,updatedAt:$e.updated_at}});k(Ne)}else console.error(" Supabase Error:",B.error),alert(`Failed to load match history: ${B.error}`)}catch(B){console.error("Error loading match history:",B),alert(`Error loading match history: ${B.message}`)}finally{d(!1)}},zr=async()=>{try{d(!0);const B=await mt.getScheduledMatchesForLadder(v);if(!B.success)throw new Error(B.error||"Failed to fetch matches");const $e=(B.matches||[]).filter(Ge=>Ge.status==="scheduled"||Ge.status==="pending").map(Ge=>{var St,Yt,hr,vr,rn,Mn,vn,qn;return{...Ge,_id:Ge.id,type:"regular",source:"supabase",matchType:Ge.match_type||"challenge",challenger:{_id:Ge.winner_id,firstName:((St=Ge.winner_name)==null?void 0:St.split(" ")[0])||"",lastName:((Yt=Ge.winner_name)==null?void 0:Yt.split(" ").slice(1).join(" "))||"",position:Ge.winner_position},defender:{_id:Ge.loser_id,firstName:((hr=Ge.loser_name)==null?void 0:hr.split(" ")[0])||"",lastName:((vr=Ge.loser_name)==null?void 0:vr.split(" ").slice(1).join(" "))||"",position:Ge.loser_position},player1:{_id:Ge.winner_id,firstName:((rn=Ge.winner_name)==null?void 0:rn.split(" ")[0])||"",lastName:((Mn=Ge.winner_name)==null?void 0:Mn.split(" ").slice(1).join(" "))||""},player2:{_id:Ge.loser_id,firstName:((vn=Ge.loser_name)==null?void 0:vn.split(" ")[0])||"",lastName:((qn=Ge.loser_name)==null?void 0:qn.split(" ").slice(1).join(" "))||""},scheduledDate:Ge.match_date,matchFormat:Ge.race_length||"best-of-5",raceLength:Ge.race_length,location:Ge.location||"",venue:Ge.location||"",notes:Ge.notes||""}});$e.sort((Ge,St)=>{const Yt=new Date(Ge.scheduledDate||Ge.match_date);return new Date(St.scheduledDate||St.match_date)-Yt}),console.log("Loaded pending ladder matches from Supabase:",$e),oe($e)}catch(B){console.error("Error loading pending matches:",B),alert("Error loading pending matches")}finally{d(!1)}},Js=async B=>{try{const Ne=await mt.getRecentMatchesForPlayer(B,5);return Ne.success?!!(Ne.matches||[]).find(St=>St.status==="completed"&&St.match_type==="smackdown"&&St.loser_id===B&&St.winner_id===B&&new Date(St.match_date)>new Date(Date.now()-7*24*60*60*1e3)):!1}catch(Ne){return console.error("Error checking SmackBack eligibility:",Ne),!1}},Xs=async B=>{if(B.preventDefault(),!be.challengerId||!be.defenderId){alert("Please select both challenger and defender");return}if(be.challengerId===be.defenderId){alert("Challenger and defender must be different players");return}const Ne=i.find(Ge=>Ge._id===be.challengerId),$e=i.find(Ge=>Ge._id===be.defenderId);if(Ne&&$e){const Ge=Ne.position||0,St=$e.position||0;switch(be.matchType){case"challenge":if(Ge<=St){alert("For Challenge Matches: Challenger must have a lower position number than defender");return}break;case"smackdown":if(Ge>=St||St-Ge>5){alert("For SmackDown Matches: Challenger must have a higher position number than defender (up to 5 positions below)");return}break;case"smackback":if(St!==1){alert("For SmackBack Matches: Can only challenge the player in 1st place");return}if(!await Js(be.challengerId)){alert("For SmackBack Matches: Challenger must have just won a SmackDown match as a defender within the last 7 days");return}break;case"defense":if(Ge>=St){alert("For Defense Matches: Challenger must have a higher position number than defender");return}break;case"position":if(Ge!==St){alert("For Position Matches: Both players must be at the same position");return}break;case"exhibition":break;default:alert("Please select a valid match type");return}}try{d(!0);const Ge=i.find(hr=>hr._id===be.challengerId),St=i.find(hr=>hr._id===be.defenderId);if(!Ge||!St){alert("Could not find challenger or defender data");return}const Yt=await mt.createScheduledMatch({challengerEmail:Ge.email,challengerName:`${Ge.firstName} ${Ge.lastName}`,challengerPosition:Ge.position,defenderEmail:St.email,defenderName:`${St.firstName} ${St.lastName}`,defenderPosition:St.position,preferredDate:Yx(be.proposedDate),location:be.location,matchType:be.matchType,gameType:be.gameType||"9-ball",raceLength:be.raceLength||"7",notes:be.notes,ladderName:v});Yt.success?(alert("Match created successfully! Players can now play and report the result."),J(!1),Ae({matchType:"challenge",challengerId:"",defenderId:"",matchFormat:"race-to-5",proposedDate:Bp(),location:"",notes:""}),zr()):alert(`Match creation failed: ${Yt.error}`)}catch(Ge){console.error("Error creating match:",Ge),alert("Error creating match")}finally{d(!1)}},Pa=B=>{const{name:Ne,value:$e}=B.target;Ae(Ge=>({...Ge,[Ne]:$e}))},Gi=B=>{const Ne=B.target.value;Ae($e=>({...$e,challengerId:Ne}))},ec=B=>{const Ne=B.target.value;Ae($e=>({...$e,defenderId:Ne}))},ps=()=>{const B=`${Ie.replace("/api","")}/static/fargo-updater.html`;window.open(B,"_blank","width=1200,height=800,scrollbars=yes,resizable=yes")},Ea=()=>{const B=`${Ie.replace("/api","")}/static/ladder-promotion.html`;window.open(B,"_blank","width=1200,height=800,scrollbars=yes,resizable=yes")},Xa=B=>{re(B),F({matchType:B.matchType||"challenge",matchFormat:B.matchFormat||"race-to-5",raceLength:B.raceLength||5,scheduledDate:B.scheduledDate?m2(new Date(B.scheduledDate)):B.proposedDate?m2(new Date(B.proposedDate)):"",location:B.location||B.venue||"",notes:B.notes||"",entryFee:B.entryFee||0,gameType:B.gameType||"8-ball",tableSize:B.tableSize||"7-foot"}),V(!0)},Vi=B=>{fe(B),I(!0)},_o=async()=>{if(X)try{d(!0);const B=X._id||X.id;console.log("Deleting match ID from Supabase:",B);const Ne=await mt.deleteMatch(B);Ne.success?(await zr(),ye("Pending match deleted successfully")):ye(`Failed to delete pending match: ${Ne.error}`)}catch(B){console.error("Error deleting pending match:",B),ye("Error deleting pending match")}finally{d(!1),I(!1),fe(null)}},ks=async B=>{var Ne,$e,Ge,St,Yt,hr,vr,rn,Mn,vn,qn,In,Aa,ko,Qi,ei;if(confirm(`Approve match request: ${(Ne=B.challenger)==null?void 0:Ne.firstName} ${($e=B.challenger)==null?void 0:$e.lastName} vs ${(Ge=B.defender)==null?void 0:Ge.firstName} ${(St=B.defender)==null?void 0:St.lastName}?

This will add the match to the calendar.`))try{d(!0);const Co=await fetch(`${Ie}/api/match-scheduling/${B._id}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewedBy:"Admin",adminNotes:"Approved by ladder admin"})});if(Co.ok){try{const No=await fetch(`${Ie}/api/calendar/add-match`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:`${(Yt=B.challenger)==null?void 0:Yt.firstName} ${(hr=B.challenger)==null?void 0:hr.lastName} vs ${(vr=B.defender)==null?void 0:vr.firstName} ${(rn=B.defender)==null?void 0:rn.lastName}`,description:`Match Type: ${B.matchType}
Location: ${B.location}
Notes: ${B.notes||"N/A"}`,location:B.location,startDateTime:B.scheduledDate,endDateTime:new Date(new Date(B.scheduledDate).getTime()+72e5).toISOString(),matchDetails:{challenger:`${(Mn=B.challenger)==null?void 0:Mn.firstName} ${(vn=B.challenger)==null?void 0:vn.lastName}`,defender:`${(qn=B.defender)==null?void 0:qn.firstName} ${(In=B.defender)==null?void 0:In.lastName}`,matchType:B.matchType,division:v,proposalId:B._id}})});let pa=null;if(B.challengerId&&B.defenderId&&B.challengerId!=="unknown"&&B.defenderId!=="unknown"){const tc={challenger_id:B.challengerId,defender_id:B.defenderId,challenger_name:`${(Aa=B.challenger)==null?void 0:Aa.firstName} ${(ko=B.challenger)==null?void 0:ko.lastName}`,defender_name:`${(Qi=B.defender)==null?void 0:Qi.firstName} ${(ei=B.defender)==null?void 0:ei.lastName}`,match_type:B.matchType||"challenge",scheduled_date:B.scheduledDate,location:B.location,notes:B.notes||"",status:"scheduled"};pa=await mt.createMatch(tc)}else console.warn(" Skipping ladder match creation - missing or invalid player IDs:",{challengerId:B.challengerId,defenderId:B.defenderId});No.ok&&(pa===null||pa.success)?(ye(pa===null?" Match approved and added to individual calendars! (Skipped main ladder calendar due to missing player IDs)":" Match approved and added to both individual calendars and main ladder calendar!"),zr()):No.ok?(ye(" Match approved and added to individual calendars, but failed to add to main ladder calendar."),zr()):pa&&pa.success?(ye(" Match approved and added to main ladder calendar, but failed to add to individual calendars."),zr()):(ye(" Match approved, but failed to add to calendars. Please add manually."),zr())}catch(No){console.error("Error adding to calendar:",No),ye(" Match approved, but failed to add to calendars. Please add manually.")}await zr()}else{const No=await Co.json();ye(` Failed to approve request: ${No.message||"Unknown error"}`)}}catch(Co){console.error("Error approving match scheduling request:",Co),ye(" Error approving match scheduling request")}finally{d(!1)}},Ra=async B=>{var $e,Ge,St,Yt;const Ne=prompt(`Reject match request: ${($e=B.challenger)==null?void 0:$e.firstName} ${(Ge=B.challenger)==null?void 0:Ge.lastName} vs ${(St=B.defender)==null?void 0:St.firstName} ${(Yt=B.defender)==null?void 0:Yt.lastName}?

Please provide a reason:`);if(Ne)try{d(!0);const hr=await fetch(`${Ie}/api/match-scheduling/${B._id}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewedBy:"Admin",adminNotes:Ne})});if(hr.ok)ye(" Match scheduling request rejected."),await zr();else{const vr=await hr.json();ye(` Failed to reject request: ${vr.message||"Unknown error"}`)}}catch(hr){console.error("Error rejecting match scheduling request:",hr),ye(" Error rejecting match scheduling request")}finally{d(!1)}},Qa=async B=>{if(B.preventDefault(),!!et)try{d(!0);const Ne={match_date:Ee.scheduledDate?new Date(Ee.scheduledDate+"T12:00:00").toISOString():null,location:Ee.location||null,notes:Ee.notes||null,game_type:Ee.gameType||"8-ball",race_length:parseInt(Ee.raceLength)||5};console.log("Sending update data to Supabase:",JSON.stringify(Ne,null,2)),console.log("Original form data:",JSON.stringify(Ee,null,2));const $e=et._id||et.id;console.log("Editing match ID in Supabase:",$e);const Ge=await mt.updateMatch($e,Ne);Ge.success?(console.log("Match update successful:",Ge.data),ye(" Pending match updated successfully"),Le(),V(!1),re(null),await zr()):(console.error("Failed to update pending match:",Ge.error),ye(` Failed to update pending match: ${Ge.error}`),Le())}catch(Ne){console.error("Error updating pending match:",Ne),ye(" Error updating pending match"),Le()}finally{d(!1)}},Se=B=>{const{name:Ne,value:$e}=B.target;F(Ge=>({...Ge,[Ne]:$e}))},G=async()=>{try{const B=await fetch(`${Ie}/api/ladder/${t}/ladders/${v}/matches`);if(B.ok){const $e=(await B.json()).matches.filter(Ge=>Ge.status==="completed"&&(!Ge.lmsStatus||Ge.lmsStatus==="not_entered"||Ge.lmsStatus==="scheduled"));$e.sort((Ge,St)=>{const Yt=new Date(Ge.completedDate||Ge.scheduledDate);return new Date(St.completedDate||St.scheduledDate)-Yt}),console.log("LMS Matches data:",$e),$e.length>0&&console.log("First match date data:",{completedDate:$e[0].completedDate,scheduledDate:$e[0].scheduledDate,completedDateType:typeof $e[0].completedDate,scheduledDateType:typeof $e[0].scheduledDate,fullMatch:$e[0]}),ge($e),ht(Date.now())}}catch(B){console.error("Error loading LMS matches:",B)}},He=async B=>{try{(await fetch(`${Ie}/api/ladder/${t}/ladders/${v}/matches/${B}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({lmsStatus:"scheduled",lmsScheduledAt:new Date().toISOString()})})).ok&&(ye(" Match marked as scheduled in LMS"),Le(),await G())}catch(Ne){console.error("Error updating LMS status:",Ne),ye(" Error updating LMS status"),Le()}},Xe=async B=>{try{(await fetch(`${Ie}/api/ladder/${t}/ladders/${v}/matches/${B}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({lmsStatus:"completed",lmsCompletedAt:new Date().toISOString()})})).ok&&(ye(" Match marked as scored in LMS"),Le(),await G())}catch(Ne){console.error("Error updating LMS status:",Ne),ye(" Error updating LMS status"),Le()}},nt=async()=>{if(confirm("This will renumber all ladder positions sequentially from 1. Continue?"))try{ye(" Fixing all positions..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/ladders/${v}/fix-positions`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();Ne.success?(ye(` Positions fixed! ${Ne.message}`),Le(),await dt()):(ye(` Error: ${Ne.error||"Failed to fix positions"}`),Le())}catch(B){console.error("Error fixing positions:",B),ye(" Error fixing positions"),Le()}finally{d(!1)}},At=async()=>{if(confirm("This will create a backup of the current ladder data. Continue?"))try{ye(" Creating backup..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/ladders/${v}/backup`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`}})).json();Ne.success?(ye(` Backup created successfully! ${Ne.message}`),Le()):(ye(` Error: ${Ne.error||"Failed to create backup"}`),Le())}catch(B){console.error("Error creating backup:",B),ye(" Error creating backup"),Le()}finally{d(!1)}},vt=async()=>{try{ye(" Loading backups..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/ladders/${v}/backups`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`}})).json();Ne.success?(yt(Ne.backups),it(!0),ye(" Backups loaded successfully"),Le()):(ye(` Error: ${Ne.error||"Failed to load backups"}`),Le())}catch(B){console.error("Error loading backups:",B),ye(" Error loading backups"),Le()}finally{d(!1)}},Nt=async B=>{try{ye(" Loading backup preview..."),d(!0);const $e=await(await fetch(`${Ie}/api/ladder/admin/ladders/${v}/restore-preview`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`},body:JSON.stringify({backupId:B})})).json();$e.success?(ke($e),Ct(!0),ye(" Preview loaded successfully"),Le()):(ye(` Error: ${$e.error||"Failed to load preview"}`),Le())}catch(Ne){console.error("Error loading preview:",Ne),ye(" Error loading preview"),Le()}finally{d(!1)}},tr=async B=>{if(confirm(" WARNING: This will restore the ladder to the state it was in when this backup was created. This will overwrite all current ladder data. Are you absolutely sure you want to continue?")&&confirm(" FINAL WARNING: This action cannot be undone. All current ladder data will be lost and replaced with the backup data. Continue?"))try{ye(" Restoring backup..."),d(!0);const $e=await(await fetch(`${Ie}/api/ladder/admin/ladders/${v}/restore`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`},body:JSON.stringify({backupId:B})})).json();$e.success?(ye(" Backup restored successfully! Refreshing ladder data..."),Le(),setTimeout(()=>{window.location.reload()},2e3)):(ye(` Error: ${$e.error||"Failed to restore backup"}`),Le())}catch(Ne){console.error("Error restoring backup:",Ne),ye(" Error restoring backup"),Le()}finally{d(!1)}},qt=async B=>{var $e,Ge;const Ne=(($e=B.unifiedAccount)==null?void 0:$e.email)||B.email;if(console.log(" Starting email resend for:",B.firstName,B.lastName,Ne),!!confirm(`Resend welcome email to ${B.firstName} ${B.lastName} (${Ne})?`))try{ye(" Sending welcome email...");const St=((Ge=B.unifiedAccount)==null?void 0:Ge.id)||B.userId;let Yt=!1,hr=null;if(St)try{const{data:vr}=await K.from("users").select("auth_provider").eq("id",St).single();vr!=null&&vr.auth_provider&&vr.auth_provider!=="email"&&(Yt=!0,hr=vr.auth_provider)}catch(vr){console.log("Could not check OAuth status:",vr)}if(Yt)console.log(" OAuth user detected - skipping password reset email");else{console.log(" Sending password reset email to:",Ne);const{error:vr}=await K.auth.resetPasswordForEmail(Ne,{redirectTo:`${window.location.origin}/#/reset-password`});if(vr){console.error(" Failed to send password reset:",vr),ye(" Failed to send password reset email"),Le();return}console.log(" Password reset email sent successfully")}try{const vr={to_email:Ne,to_name:`${B.firstName} ${B.lastName}`,ladder_name:B.ladderName||v,position:B.position||"TBD",app_url:window.location.origin,isOAuthUser:Yt,authProvider:hr};console.log(" Sending approval email with data:",vr),console.log(" Backend URL:",Ie);const rn=await fetch(`${Ie}/api/email/send-ladder-approval`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(vr)});if(console.log(" Email response status:",rn.status),console.log(" Email response ok:",rn.ok),rn.ok){const Mn=await rn.json();console.log(" Welcome email sent successfully:",Mn),ye(" Welcome emails sent successfully!")}else{const Mn=await rn.json();console.error(" Email sending failed:",Mn),ye(` Password reset sent, but approval email failed: ${Mn.error||"Unknown error"}`)}}catch(vr){console.error(" Failed to send approval email:",vr),ye(" Password reset sent, but approval email failed")}Le()}catch(St){console.error("Error sending welcome email:",St),ye(" Error sending welcome email"),Le()}},or=async()=>{try{ye(" Checking auto backup status..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/auto-backup/status`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`}})).json();Ne.success?(Ft(Ne.status),Fe(!0),ye(" Auto backup status loaded"),Le()):(ye(` Error: ${Ne.error||"Failed to load auto backup status"}`),Le())}catch(B){console.error("Error checking auto backup status:",B),ye(" Error checking auto backup status"),Le()}finally{d(!1)}},Ht=async()=>{if(confirm("This will create automatic backups for all ladders. Continue?"))try{ye(" Triggering auto backup for all ladders..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/auto-backup/trigger`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||localStorage.getItem("userToken")}`}})).json();Ne.success?(ye(` Auto backup completed! ${Ne.result.successful} ladders backed up successfully`),Le(),setTimeout(()=>{or()},1e3)):(ye(` Error: ${Ne.error||"Failed to trigger auto backup"}`),Le())}catch(B){console.error("Error triggering auto backup:",B),ye(" Error triggering auto backup"),Le()}finally{d(!1)}},Rt=async()=>{if(!Ve.player1Id||!Ve.player2Id){alert("Please select both players to swap");return}if(Ve.player1Id===Ve.player2Id){alert("Cannot swap a player with themselves");return}try{ye(" Swapping player positions..."),d(!0);const Ne=await(await fetch(`${Ie}/api/ladder/admin/players/swap-positions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({player1Id:Ve.player1Id,player2Id:Ve.player2Id})})).json();Ne.success?(ye(" Positions swapped successfully!"),Le(),Pe(!1),we({player1Id:"",player2Id:""}),await dt()):(ye(` Error: ${Ne.error||"Failed to swap positions"}`),Le())}catch(B){console.error("Error swapping positions:",B),ye(" Error swapping positions"),Le()}finally{d(!1)}},Ue=async()=>{Y(!0);try{const B=await fetch(`${Ie}/api/monetization/pending-payments?t=${Date.now()}`);if(B.ok){const Ne=await B.json();console.log(" Pending payments response:",Ne),$(Ne.pendingPayments||[])}else ye("Failed to load pending payments")}catch(B){console.error("Error loading pending payments:",B),ye("Error loading pending payments")}finally{Y(!1)}},ft=async(B,Ne)=>{try{(await fetch(`${Ie}/api/monetization/verify-payment/${B}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verified:Ne,adminNotes:Ne?"Approved by ladder admin":"Rejected by ladder admin"})})).ok?(ye(` Payment ${Ne?"approved":"rejected"} successfully!`),Le(),await Ue()):(ye(" Failed to update payment status"),Le())}catch($e){console.error("Error updating payment:",$e),ye(" Error updating payment status"),Le()}};return c?e.jsx("div",{className:at.container,children:"Loading ladder players..."}):e.jsxs("div",{className:at.container,children:[e.jsxs("div",{className:at.header,children:[e.jsx("h2",{children:a==="players"?"Ladder Player Management":a==="matches"?"Ladder Match Manager":a==="emails"?"Email Manager":a==="payments"?"Payment Approvals":a==="forfeits"?"Forfeit Requests":a==="overdue"?"Overdue Matches":a==="tournaments"?"Tournament Management":a==="test-environment"?"Test Environment":a==="comprehensive-test"?"Comprehensive Test Suite":"Ladder Admin"}),e.jsxs("div",{className:at.headerContent,children:[e.jsxs("div",{className:at.ladderSelector,children:[e.jsx("label",{htmlFor:"ladderSelect",children:"Select Ladder:"}),e.jsxs("select",{id:"ladderSelect",value:v,onChange:B=>b(B.target.value),className:at.ladderSelect,children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"}),e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]})]}),e.jsxs("div",{className:at.headerButtons,style:{display:"flex",flexWrap:"wrap",gap:"10px",justifyContent:"center",marginBottom:"15px"},children:[e.jsx("button",{className:at.addButton,onClick:()=>{window.scrollTo(0,0),g(!0)},style:{background:"linear-gradient(135deg, #28a745, #20c997)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Add Player"}),e.jsx("button",{onClick:()=>{alert("Button clicked!"),console.log(" Setting message state..."),x(!0),ye(" Test message - Quick Add form opened"),console.log(" Message state should be set now"),setTimeout(()=>{console.log(" Clearing message..."),Le()},3e3)},style:{background:"linear-gradient(135deg, #28a745, #20c997)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Quick Add Player"}),e.jsx("button",{className:at.createMatchButton,onClick:()=>{window.scrollTo(0,0),J(!0)},disabled:i.filter(B=>B.ladderName===v).length<2,style:{background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Create Match"}),e.jsx("button",{className:at.pendingMatchesButton,onClick:()=>{Ce(!0),zr()},style:{background:"linear-gradient(135deg, #f093fb, #f5576c)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Pending Matches"})]})]})]}),a==="players"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center",marginTop:"10px",padding:"15px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h5",{style:{width:"100%",textAlign:"center",color:"#fff",margin:"0 0 10px 0",fontSize:"14px",fontWeight:"bold"},children:" Management Views"}),e.jsx("button",{className:at.matchManagerButton,onClick:()=>o("matches"),style:{background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Match Manager"}),e.jsx("button",{className:at.emailManagerButton,onClick:()=>o("emails"),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Email Manager"}),e.jsx("button",{className:at.paymentManagerButton,onClick:()=>o("payments"),style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Payment Approvals"}),e.jsx("button",{className:at.forfeitManagerButton,onClick:()=>o("forfeits"),style:{background:"linear-gradient(135deg, #dc2626 0%, #991b1b 100%)",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Forfeit Requests"}),e.jsx("button",{className:at.overdueManagerButton,onClick:()=>o("overdue"),style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Overdue Matches"}),e.jsx("button",{className:at.tournamentManagerButton,onClick:()=>{console.log(" Tournaments button clicked"),console.log(" Current view before:",a),o("tournaments"),console.log(" Setting view to tournaments")},style:{background:"linear-gradient(135deg, #00ff00 0%, #00cc00 100%)",color:"black",border:"none",padding:"8px 12px",borderRadius:"5px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Tournaments"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginTop:"20px",padding:"20px",background:"rgba(0, 0, 0, 0.1)",borderRadius:"10px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("h4",{style:{color:"#fff",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold",textAlign:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"8px",borderRadius:"5px"},children:" Player Management"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{className:at.addButton,onClick:()=>g(!0),style:{background:"linear-gradient(135deg, #28a745, #20c997)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Add Player"}),e.jsx("button",{className:at.applicationsButton,onClick:()=>Ze(!0),style:{background:"linear-gradient(135deg, #ff6b6b, #ee5a24)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" View Applications"}),e.jsx("button",{onClick:Ea,style:{background:"linear-gradient(135deg, #28a745, #20c997)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Promote Players"})]})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("h4",{style:{color:"#fff",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold",textAlign:"center",background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",padding:"8px",borderRadius:"5px"},children:" Match Management"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{className:at.matchButton,onClick:()=>{window.scrollTo(0,0),C(!0)},disabled:i.filter(B=>B.ladderName===v).length<2,style:{background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Score Match"}),e.jsx("button",{onClick:async()=>{const B=prompt("Enter Player 1 ID (from Supabase users table) to check SmackBack eligibility:");if(B){const Ne=await mt.checkSmackBackEligibility(B);Ne.eligible?alert(` SmackBack ELIGIBLE!

Expires: ${Ne.eligibleUntil.toLocaleString()}
Days remaining: ${Ne.daysRemaining}`):alert(` NOT Eligible for SmackBack

Reason: ${Ne.reason}`)}},style:{background:"linear-gradient(135deg, #8b5cf6, #6d28d9)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Check SmackBack Eligibility"}),e.jsxs("button",{className:at.historyButton,onClick:()=>{U(!R),R||ha()},style:{background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:[" ",R?"Hide History":"View History"]}),e.jsx("button",{onClick:()=>{lt(!0),ge([]),setTimeout(()=>{G()},100)},style:{background:"linear-gradient(135deg, #6c5ce7, #a29bfe)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" LMS Tracking"})]})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("h4",{style:{color:"#fff",margin:"0 0 10px 0",fontSize:"16px",fontWeight:"bold",textAlign:"center",background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",padding:"8px",borderRadius:"5px"},children:" System Tools"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{const B=`${Ie.replace("/api","")}/static/fargo-copy-paste-admin.html`;window.open(B,"_blank","width=1200,height=800,scrollbars=yes,resizable=yes")},style:{background:"linear-gradient(135deg, #e74c3c, #c0392b)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Bulk Fargo Update"}),e.jsx("button",{onClick:ps,style:{background:"linear-gradient(135deg, #ff6b6b, #ee5a24)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Individual Fargo Update"}),e.jsx("button",{onClick:nt,style:{background:"linear-gradient(135deg, #00b894, #00cec9)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Fix Positions"}),e.jsx("button",{onClick:At,style:{background:"linear-gradient(135deg, #6c5ce7, #a29bfe)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Backup Ladder"}),e.jsx("button",{onClick:vt,style:{background:"linear-gradient(135deg, #fd79a8, #fdcb6e)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" View Backups"}),e.jsx("button",{onClick:()=>o("comprehensive-test"),style:{background:"linear-gradient(135deg, #ff6b35, #f7931e)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Run Comprehensive Test"}),e.jsx("button",{onClick:()=>o("test-environment"),style:{background:"linear-gradient(135deg, #f59e0b, #d97706)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Test Environment"}),e.jsx("button",{onClick:or,style:{background:"linear-gradient(135deg, #00b894, #00a085)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Auto Backup Status"}),e.jsx("button",{onClick:()=>Pe(!0),style:{background:"linear-gradient(135deg, #f39c12, #e67e22)",color:"white",border:"none",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"all 0.3s ease"},children:" Swap Positions"})]})]})]}),ne&&e.jsx("div",{style:{background:"#4CAF50",color:"white",padding:"20px",borderRadius:"8px",margin:"20px 0",textAlign:"center",fontSize:"18px",fontWeight:"bold",position:"fixed",top:"100px",left:"50%",transform:"translateX(-50%)",zIndex:99999,boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:ne}),p&&Z(e.jsx(It,{open:p,onClose:()=>g(!1),title:"Add New Ladder Player",maxWidth:"600px",maxHeight:"90vh",children:e.jsxs("form",{onSubmit:Wt,children:[e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:f.firstName,onChange:pt,required:!0}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:f.lastName,onChange:pt,required:!0}),e.jsx("input",{type:"text",name:"email",placeholder:"Email",value:f.email,onChange:pt,required:!0}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone",value:f.phone,onChange:pt}),e.jsx("input",{type:"number",name:"fargoRate",placeholder:"Fargo Rate",value:f.fargoRate,onChange:pt,required:!0}),e.jsxs("select",{name:"ladderName",value:f.ladderName,onChange:pt,required:!0,children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"}),e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]}),e.jsxs("select",{name:"location",value:f.location,onChange:pt,required:!0,children:[e.jsx("option",{value:"",children:"Select Preferred Location"}),r.length>0?r.map(B=>e.jsx("option",{value:B.name,children:B.name},B._id)):e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."})]}),e.jsx("div",{className:at.checkboxes,children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:f.isActive,onChange:pt}),"Active on Ladder"]})}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",children:"Add Player"}),e.jsx("button",{type:"button",onClick:()=>g(!1),children:"Cancel"})]})]})})),w&&Z(e.jsx(It,{open:w,onClose:()=>x(!1),title:" Quick Add Player to Ladder",maxWidth:"500px",children:e.jsx("div",{className:at.formContainer,children:e.jsxs("form",{onSubmit:ir,children:[e.jsxs("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"5px",fontSize:"14px",color:"#333"},children:[e.jsx("strong",{children:" Quick Add:"})," This adds a player directly to the selected ladder at a specific position. The system will automatically shift other players' positions to make room."]}),e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name *",value:j.firstName,onChange:Tt,required:!0}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name *",value:j.lastName,onChange:Tt,required:!0}),e.jsxs("select",{name:"ladderName",value:j.ladderName,onChange:Tt,required:!0,children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"}),e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[e.jsx("input",{type:"number",name:"position",placeholder:"Position on Ladder *",value:j.position,onChange:Tt,required:!0,min:"1",style:{flex:1}}),e.jsx("button",{type:"button",onClick:()=>{const Ne=i.filter($e=>$e.ladderName===j.ladderName).length+1;S($e=>({...$e,position:Ne.toString()}))},style:{background:"#6c757d",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap"},children:"Last Position"})]}),e.jsx("input",{type:"email",name:"email",placeholder:"Email (optional - will auto-find from unified account)",value:j.email,onChange:Tt}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone (optional - will auto-find from unified account)",value:j.phone,onChange:Tt}),e.jsx("input",{type:"number",name:"fargoRate",placeholder:"Fargo Rate (optional)",value:j.fargoRate,onChange:Tt,min:"0",max:"850"}),e.jsxs("select",{name:"location",value:j.location,onChange:Tt,children:[e.jsx("option",{value:"",children:"Select Preferred Location (optional)"}),r.length>0?r.map(B=>e.jsx("option",{value:B.name,children:B.name},B._id)):e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."})]}),e.jsx("textarea",{name:"notes",placeholder:"Notes (optional)",value:j.notes,onChange:Tt,rows:"3"}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",disabled:c,children:c?"Adding...":" Add Player"}),e.jsx("button",{type:"button",onClick:()=>x(!1),children:"Cancel"})]})]})})})),ue&&Z(e.jsx(It,{open:ue,onClose:()=>J(!1),title:"Create New Match",maxWidth:"700px",maxHeight:"90vh",children:e.jsxs("form",{onSubmit:Xs,children:[e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Type:"}),e.jsxs("select",{name:"matchType",value:be.matchType,onChange:Pa,required:!0,children:[e.jsx("option",{value:"challenge",children:"Challenge Match"}),e.jsx("option",{value:"smackdown",children:"SmackDown"}),e.jsx("option",{value:"smackback",children:"SmackBack"})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Race to:"}),e.jsxs("select",{name:"matchFormat",value:be.matchFormat,onChange:Pa,required:!0,children:[e.jsx("option",{value:"race-to-5",children:"Race to 5"}),e.jsx("option",{value:"race-to-7",children:"Race to 7"}),e.jsx("option",{value:"race-to-9",children:"Race to 9"}),ve&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"race-to-6",children:"Race to 6"}),e.jsx("option",{value:"race-to-8",children:"Race to 8"}),e.jsx("option",{value:"race-to-10",children:"Race to 10"}),e.jsx("option",{value:"race-to-11",children:"Race to 11"}),e.jsx("option",{value:"race-to-12",children:"Race to 12"}),e.jsx("option",{value:"race-to-13",children:"Race to 13"}),e.jsx("option",{value:"race-to-14",children:"Race to 14"}),e.jsx("option",{value:"race-to-15",children:"Race to 15"}),e.jsx("option",{value:"race-to-16",children:"Race to 16"}),e.jsx("option",{value:"race-to-17",children:"Race to 17"}),e.jsx("option",{value:"race-to-18",children:"Race to 18"}),e.jsx("option",{value:"race-to-19",children:"Race to 19"}),e.jsx("option",{value:"race-to-20",children:"Race to 20"}),e.jsx("option",{value:"race-to-21",children:"Race to 21"})]})]}),e.jsx("button",{type:"button",className:at.moreOptionsButton,onClick:()=>De(!ve),children:ve?"Hide Options":"More Options"})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Challenger :"}),e.jsxs("select",{value:be.challengerId,onChange:Gi,required:!0,children:[e.jsx("option",{value:"",children:"Select Challenger"}),i.filter(B=>B.ladderName===v).sort((B,Ne)=>(B.position||0)-(Ne.position||0)).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Defender :"}),e.jsxs("select",{value:be.defenderId,onChange:ec,required:!0,children:[e.jsx("option",{value:"",children:"Select Defender"}),i.filter(B=>B.ladderName===v).sort((B,Ne)=>(B.position||0)-(Ne.position||0)).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Date:"}),e.jsx("input",{type:"date",name:"proposedDate",value:be.proposedDate,onChange:Pa,required:!0})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Location:"}),e.jsxs("select",{name:"location",value:be.location,onChange:Pa,required:!0,children:[e.jsx("option",{value:"",children:"Select Location"}),r.length>0?r.map(B=>e.jsx("option",{value:B.name,children:B.name},B._id)):e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Notes:"}),e.jsx("input",{type:"text",name:"notes",value:be.notes,onChange:Pa,placeholder:"Optional match notes"})]})]}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",disabled:c,children:c?"Creating...":"Create Match"}),e.jsx("button",{type:"button",onClick:()=>J(!1),children:"Cancel"})]})]})})),u&&xr.createPortal(e.jsx(It,{open:!0,onClose:()=>h(null),title:`Edit Player: ${u.firstName} ${u.lastName}`,maxWidth:"600px",maxHeight:"90vh",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",maxHeight:"70vh",overflowY:"auto",padding:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:f.firstName,onChange:pt,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:f.lastName,onChange:pt,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Email *"}),e.jsx("input",{type:"text",name:"email",placeholder:"Email",value:f.email,onChange:pt,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Phone"}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone",value:f.phone,onChange:pt})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Fargo Rate *"}),e.jsx("input",{type:"number",name:"fargoRate",placeholder:"Fargo Rate",value:f.fargoRate,onChange:pt,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold",backgroundColor:"#8b5cf6",padding:"5px 10px",borderRadius:"4px"},children:" Ladder Position *"}),e.jsx("input",{type:"number",name:"position",placeholder:"Ladder Position",value:f.position,onChange:pt,required:!0,min:"1",style:{backgroundColor:"#ffffff",color:"#000",border:"2px solid #8b5cf6",fontWeight:"bold",fontSize:"16px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Ladder *"}),e.jsxs("select",{name:"ladderName",value:f.ladderName,onChange:pt,required:!0,children:[e.jsx("option",{value:"499-under",children:"499 & Under"}),e.jsx("option",{value:"500-549",children:"500-549"}),e.jsx("option",{value:"550-plus",children:"550+"}),e.jsx("option",{value:"test-ladder",children:" Test Ladder"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Preferred Location"}),e.jsxs("select",{name:"location",value:f.location,onChange:pt,children:[e.jsx("option",{value:"",children:"Select Preferred Location"}),r.length>0?r.map(B=>e.jsx("option",{value:B.name,children:B.name},B._id)):e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"Sanction Year"}),e.jsx("input",{type:"number",name:"sanctionYear",placeholder:"Sanction Year",value:f.sanctionYear,onChange:pt,min:"2020",max:"2030"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#fff",marginBottom:"5px",fontWeight:"bold"},children:"LMS Name"}),e.jsx("input",{type:"text",name:"lmsName",placeholder:"LMS Name (for Fargo matching)",value:f.lmsName,onChange:pt})]}),e.jsx("div",{style:{gridColumn:"1 / -1"},children:e.jsxs("div",{style:{display:"flex",gap:"15px",marginTop:"10px"},children:[e.jsxs("label",{style:{color:"#fff",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:f.isActive,onChange:pt}),"Active on Ladder"]}),e.jsxs("label",{style:{color:"#fff",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("input",{type:"checkbox",name:"sanctioned",checked:f.sanctioned,onChange:pt}),"BCA Sanctioned"]})]})}),e.jsx("div",{style:{gridColumn:"1 / -1",marginTop:"20px"},children:e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:rr,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",fontWeight:"bold"},children:"Update Player"}),e.jsx("button",{type:"button",onClick:()=>h(null),style:{background:"linear-gradient(135deg, #dc2626 0%, #991b1b 100%)",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer",fontWeight:"bold"},children:"Cancel"})]})})]})}),document.body),Je&&Z(e.jsx(It,{open:Je,onClose:()=>Pe(!1),title:"Swap Player Positions",maxWidth:"500px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("p",{children:"Select two players to swap their ladder positions:"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{children:"Player 1:"}),e.jsxs("select",{value:Ve.player1Id,onChange:B=>we({...Ve,player1Id:B.target.value}),style:{width:"100%",padding:"8px",marginTop:"5px"},children:[e.jsx("option",{value:"",children:"Select first player"}),i.filter(B=>B.ladderName===v).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{children:"Player 2:"}),e.jsxs("select",{value:Ve.player2Id,onChange:B=>we({...Ve,player2Id:B.target.value}),style:{width:"100%",padding:"8px",marginTop:"5px"},children:[e.jsx("option",{value:"",children:"Select second player"}),i.filter(B=>B.ladderName===v).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:Rt,style:{background:"#f39c12",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer"},children:"Swap Positions"}),e.jsx("button",{onClick:()=>Pe(!1),style:{background:"#95a5a6",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"pointer"},children:"Cancel"})]})]})})),_&&Z(e.jsx(It,{open:_,onClose:()=>C(!1),title:"Report Match Result",maxWidth:"700px",maxHeight:"90vh",children:e.jsxs("form",{onSubmit:ua,children:[!D.matchId&&e.jsx("div",{className:at.formRow,children:e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Type:"}),e.jsxs("select",{name:"matchType",value:D.matchType,onChange:hs,required:!0,children:[e.jsx("option",{value:"challenge",children:" Challenge Match"}),e.jsx("option",{value:"smackdown",children:" SmackDown Match"}),e.jsx("option",{value:"smackback",children:" SmackBack Match"}),e.jsx("option",{value:"fast-track",children:" Fast Track Challenge"}),e.jsx("option",{value:"reverse-fast-track",children:" Reverse Fast Track"})]})]})}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Player 1:"}),e.jsxs("select",{value:D.player1Id,onChange:cn,required:!0,children:[e.jsx("option",{value:"",children:"Select Player 1"}),i.filter(B=>B.ladderName===v).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Player 2:"}),e.jsxs("select",{value:D.player2Id,onChange:Ja,required:!0,children:[e.jsx("option",{value:"",children:"Select Player 2"}),i.filter(B=>B.ladderName===v).map(B=>e.jsxs("option",{value:B._id,children:["#",B.position," - ",B.firstName," ",B.lastName]},B._id))]})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Winner:"}),e.jsxs("select",{value:D.winnerId,onChange:Dr,required:!0,children:[e.jsx("option",{value:"",children:"Select Winner"}),D.player1Id&&e.jsx("option",{value:D.player1Id,children:D.player1Name}),D.player2Id&&e.jsx("option",{value:D.player2Id,children:D.player2Name})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Score:"}),e.jsx("input",{type:"text",name:"score",value:D.score,onChange:hs,placeholder:"e.g., 3-1, 5-3",required:!0})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Date:"}),e.jsx("input",{type:"date",name:"matchDate",value:D.matchDate,onChange:hs,required:!0})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Race to:"}),e.jsxs("select",{name:"matchFormat",value:D.matchFormat,onChange:hs,required:!0,children:[e.jsx("option",{value:"race-to-5",children:"Race to 5"}),e.jsx("option",{value:"race-to-7",children:"Race to 7"}),e.jsx("option",{value:"race-to-9",children:"Race to 9"}),ve&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"race-to-6",children:"Race to 6"}),e.jsx("option",{value:"race-to-8",children:"Race to 8"}),e.jsx("option",{value:"race-to-10",children:"Race to 10"}),e.jsx("option",{value:"race-to-11",children:"Race to 11"}),e.jsx("option",{value:"race-to-12",children:"Race to 12"}),e.jsx("option",{value:"race-to-13",children:"Race to 13"}),e.jsx("option",{value:"race-to-14",children:"Race to 14"}),e.jsx("option",{value:"race-to-15",children:"Race to 15"}),e.jsx("option",{value:"race-to-16",children:"Race to 16"}),e.jsx("option",{value:"race-to-17",children:"Race to 17"}),e.jsx("option",{value:"race-to-18",children:"Race to 18"}),e.jsx("option",{value:"race-to-19",children:"Race to 19"}),e.jsx("option",{value:"race-to-20",children:"Race to 20"}),e.jsx("option",{value:"race-to-21",children:"Race to 21"})]})]}),e.jsx("button",{type:"button",className:at.moreOptionsButton,onClick:()=>De(!ve),children:ve?"Hide Options":"More Options"})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Location:"}),e.jsxs("select",{name:"location",value:D.location,onChange:hs,required:!0,children:[e.jsx("option",{value:"",children:"Select Location"}),r.length>0?r.map(B=>e.jsx("option",{value:B.name,children:B.name},B._id)):e.jsx("option",{value:"",disabled:!0,children:"Loading locations..."})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Notes:"}),e.jsx("input",{type:"text",name:"notes",value:D.notes,onChange:hs,placeholder:"Optional match notes"})]})]}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",disabled:c,children:c?"Recording...":"Record Match Result"}),e.jsx("button",{type:"button",onClick:()=>C(!1),children:"Cancel"})]})]})})),N&&E&&Z(e.jsx(It,{open:N,onClose:()=>{M(!1),P(null)},title:`Score ${(E.match_type||E.matchType)==="smackdown"?" SmackDown":(E.match_type||E.matchType)==="smackback"?" SmackBack":(E.match_type||E.matchType)==="fast-track"?" Fast Track":(E.match_type||E.matchType)==="reverse-fast-track"?" Reverse Fast Track":" Challenge"} Match`,maxWidth:"600px",maxHeight:"90vh",children:e.jsxs("form",{onSubmit:An,children:[e.jsxs("div",{style:{background:"rgba(139, 92, 246, 0.1)",border:"1px solid rgba(139, 92, 246, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#8b5cf6",marginTop:0,marginBottom:"10px"},children:"Match Details"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",color:"#e0e0e0"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Challenger:"})," ",((wt=E.challenger)==null?void 0:wt.firstName)||((Lt=E.player1)==null?void 0:Lt.firstName)," ",((yr=E.challenger)==null?void 0:yr.lastName)||((Sr=E.player1)==null?void 0:Sr.lastName),(((Bs=E.challenger)==null?void 0:Bs.position)||((Za=E.player1)==null?void 0:Za.position))&&` (#${((jr=E.challenger)==null?void 0:jr.position)||((Dt=E.player1)==null?void 0:Dt.position)})`]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Defender:"})," ",((Ar=E.defender)==null?void 0:Ar.firstName)||(($r=E.player2)==null?void 0:$r.firstName)," ",((dn=E.defender)==null?void 0:dn.lastName)||((rs=E.player2)==null?void 0:rs.lastName),(((un=E.defender)==null?void 0:un.position)||((Wn=E.player2)==null?void 0:Wn.position))&&` (#${((tn=E.defender)==null?void 0:tn.position)||((ns=E.player2)==null?void 0:ns.position)})`]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",E.scheduledDate?new Date(E.scheduledDate).toLocaleDateString():"TBD"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",E.location||E.venue||"TBD"]})]})]}),e.jsxs("div",{className:at.formGroup,style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Match Date:"}),e.jsx("input",{type:"date",name:"matchDate",defaultValue:E.scheduledDate?new Date(E.scheduledDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px"}}),e.jsx("small",{style:{color:"#aaa",fontSize:"12px",display:"block",marginTop:"5px"},children:" Adjust if the match was played on a different date than scheduled"})]}),e.jsxs("div",{className:at.formGroup,style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Winner:"}),e.jsxs("select",{name:"winnerId",required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px"},children:[e.jsx("option",{value:"",children:"Select Winner"}),e.jsxs("option",{value:((le=E.challenger)==null?void 0:le._id)||((_e=E.player1)==null?void 0:_e._id),children:[((Me=E.challenger)==null?void 0:Me.firstName)||((he=E.player1)==null?void 0:he.firstName)," ",((Be=E.challenger)==null?void 0:Be.lastName)||((ct=E.player1)==null?void 0:ct.lastName),((($t=E.challenger)==null?void 0:$t.position)||((qe=E.player1)==null?void 0:qe.position))&&` (#${((jt=E.challenger)==null?void 0:jt.position)||((Bt=E.player1)==null?void 0:Bt.position)})`]}),e.jsxs("option",{value:((Ot=E.defender)==null?void 0:Ot._id)||((dr=E.player2)==null?void 0:dr._id),children:[((ur=E.defender)==null?void 0:ur.firstName)||((bn=E.player2)==null?void 0:bn.firstName)," ",((Un=E.defender)==null?void 0:Un.lastName)||((ms=E.player2)==null?void 0:ms.lastName),(((fs=E.defender)==null?void 0:fs.position)||((Cn=E.player2)==null?void 0:Cn.position))&&` (#${((Ur=E.defender)==null?void 0:Ur.position)||((Cs=E.player2)==null?void 0:Cs.position)})`]})]})]}),e.jsxs("div",{className:at.formGroup,style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Score:"}),e.jsx("input",{type:"text",name:"score",placeholder:"e.g., 7-5, 9-3",required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px"}})]}),e.jsxs("div",{className:at.formGroup,style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Notes (Optional):"}),e.jsx("input",{type:"text",name:"notes",placeholder:"Any match notes",style:{width:"100%",padding:"8px",borderRadius:"4px"}})]}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",disabled:c,style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:"bold"},children:c?"Submitting...":" Submit Score"}),e.jsx("button",{type:"button",onClick:()=>{M(!1),P(null)},style:{background:"#6b7280",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},children:"Cancel"})]})]})})),me&&Z(e.jsx(It,{open:me,onClose:()=>Ce(!1),title:"Pending Matches",maxWidth:"95vw",width:"95vw",height:"85vh",children:e.jsx("div",{className:at.pendingMatchesModal,children:O.length===0?e.jsx("div",{className:at.noData,children:"No pending matches for this ladder."}):e.jsx("div",{className:at.pendingMatchesTable,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Challenger"}),e.jsx("th",{children:"Defender"}),e.jsx("th",{children:"Format"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Notes"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:O.map((B,Ne)=>{var $e,Ge,St,Yt,hr,vr,rn,Mn,vn,qn,In,Aa,ko,Qi,ei,Co;return e.jsxs("tr",{children:[e.jsx("td",{children:B.scheduledDate?new Date(B.scheduledDate).toLocaleDateString():B.proposedDate?new Date(B.proposedDate).toLocaleDateString():"TBD"}),e.jsx("td",{children:e.jsx("span",{className:`${at.matchType} ${at[B.match_type||B.matchType||"challenge"]}`,children:(B.match_type||B.matchType)==="challenge"?" Challenge":(B.match_type||B.matchType)==="smackdown"?" SmackDown":(B.match_type||B.matchType)==="smackback"?" SmackBack":(B.match_type||B.matchType)==="fast-track"?" Fast Track":(B.match_type||B.matchType)==="reverse-fast-track"?" Rev Fast Track":" Challenge"})}),e.jsxs("td",{children:[e.jsxs("span",{className:at.playerName,children:[(($e=B.challenger)==null?void 0:$e.firstName)||((Ge=B.player1)==null?void 0:Ge.firstName)," ",((St=B.challenger)==null?void 0:St.lastName)||((Yt=B.player1)==null?void 0:Yt.lastName),(((hr=B.challenger)==null?void 0:hr.position)||((vr=B.player1)==null?void 0:vr.position))&&` (#${((rn=B.challenger)==null?void 0:rn.position)||((Mn=B.player1)==null?void 0:Mn.position)})`]}),e.jsx("span",{className:at.playerRole,style:{color:"#06b6d4"},children:"Challenger"})]}),e.jsxs("td",{children:[e.jsxs("span",{className:at.playerName,children:[((vn=B.defender)==null?void 0:vn.firstName)||((qn=B.player2)==null?void 0:qn.firstName)," ",((In=B.defender)==null?void 0:In.lastName)||((Aa=B.player2)==null?void 0:Aa.lastName),(((ko=B.defender)==null?void 0:ko.position)||((Qi=B.player2)==null?void 0:Qi.position))&&` (#${((ei=B.defender)==null?void 0:ei.position)||((Co=B.player2)==null?void 0:Co.position)})`]}),e.jsx("span",{className:at.playerRole,style:{color:"#f59e0b"},children:"Defender"})]}),e.jsx("td",{children:B.matchFormat||B.raceLength||"N/A"}),e.jsx("td",{children:B.location||B.venue||"N/A"}),e.jsx("td",{children:B.notes||"N/A"}),e.jsx("td",{children:e.jsx("span",{className:`${at.status} ${at.pending}`,children:B.type==="scheduling_request"?" Request":" Pending"})}),e.jsx("td",{children:e.jsx("div",{className:at.matchActions,children:B.type==="scheduling_request"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:at.approveButton,onClick:()=>ks(B),title:"Approve Match Request",children:""}),e.jsx("button",{className:at.rejectButton,onClick:()=>Ra(B),title:"Reject Match Request",children:""})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:at.reportResultButton,onClick:()=>{Jr(B),Ce(!1)},title:"Report Result",children:""}),e.jsx("button",{className:at.editButton,onClick:()=>Xa(B),title:"Edit Match",children:""}),e.jsx("button",{className:at.deleteButton,onClick:()=>Vi(B),title:"Delete Match",children:""})]})})})]},B._id||B.id||Ne)})})]})})})})),je&&et&&Z(e.jsx(It,{open:je,onClose:()=>{V(!1),re(null)},title:"Edit Pending Match",maxWidth:"60vw",children:e.jsx("div",{className:at.editPendingMatchForm,children:e.jsxs("form",{onSubmit:Qa,children:[e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Type:"}),e.jsxs("select",{name:"matchType",value:Ee.matchType,onChange:Se,children:[e.jsx("option",{value:"challenge",children:"Challenge"}),e.jsx("option",{value:"smackdown",children:"SmackDown"}),e.jsx("option",{value:"smackback",children:"SmackBack"}),e.jsx("option",{value:"defense",children:"Defense"})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Match Format:"}),e.jsxs("select",{name:"matchFormat",value:Ee.matchFormat,onChange:Se,children:[e.jsx("option",{value:"race-to-3",children:"Race to 3"}),e.jsx("option",{value:"race-to-5",children:"Race to 5"}),e.jsx("option",{value:"race-to-7",children:"Race to 7"}),e.jsx("option",{value:"race-to-9",children:"Race to 9"}),e.jsx("option",{value:"best-of-3",children:"Best of 3"}),e.jsx("option",{value:"best-of-5",children:"Best of 5"}),e.jsx("option",{value:"best-of-7",children:"Best of 7"})]})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Scheduled Date:"}),e.jsx("input",{type:"date",name:"scheduledDate",value:Ee.scheduledDate,onChange:Se})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Location:"}),e.jsxs("select",{name:"location",value:Ee.location,onChange:Se,children:[e.jsx("option",{value:"",children:"Select Location"}),r.map((B,Ne)=>e.jsx("option",{value:B.name,children:B.name},Ne))]})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Entry Fee:"}),e.jsx("input",{type:"number",name:"entryFee",value:Ee.entryFee,onChange:Se,min:"0",step:"0.01"})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Table Size:"}),e.jsxs("select",{name:"tableSize",value:Ee.tableSize,onChange:Se,children:[e.jsx("option",{value:"7-foot",children:"7-foot"}),e.jsx("option",{value:"9-foot",children:"9-foot"})]})]})]}),e.jsxs("div",{className:at.formRow,children:[e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Game Type:"}),e.jsxs("select",{name:"gameType",value:Ee.gameType,onChange:Se,children:[e.jsx("option",{value:"8-ball",children:"8-ball"}),e.jsx("option",{value:"9-ball",children:"9-ball"}),e.jsx("option",{value:"10-ball",children:"10-ball"}),e.jsx("option",{value:"mixed",children:"Mixed"})]})]}),e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Race Length:"}),e.jsx("input",{type:"number",name:"raceLength",value:Ee.raceLength,onChange:Se,min:"1",max:"21",placeholder:"5"})]})]}),e.jsx("div",{className:at.formRow,children:e.jsxs("div",{className:at.formGroup,children:[e.jsx("label",{children:"Notes:"}),e.jsx("textarea",{name:"notes",value:Ee.notes,onChange:Se,placeholder:"Match notes",rows:"3"})]})}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{type:"submit",disabled:c,className:at.submitButton,children:c?"Updating...":"Update Match"}),e.jsx("button",{type:"button",onClick:()=>{V(!1),re(null)},className:at.cancelButton,children:"Cancel"})]})]})})})),ae&&X&&Z(e.jsx(It,{open:ae,onClose:()=>{I(!1),fe(null)},title:"Confirm Delete Pending Match",maxWidth:"40vw",children:e.jsxs("div",{className:at.deleteConfirmModal,children:[e.jsx("p",{children:"Are you sure you want to delete this pending match?"}),e.jsxs("div",{className:at.matchDetails,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Players:"})," ",((Ns=X.challenger)==null?void 0:Ns.firstName)||((Ts=X.player1)==null?void 0:Ts.firstName)," ",((eo=X.challenger)==null?void 0:eo.lastName)||((to=X.player1)==null?void 0:to.lastName)," vs ",((Zo=X.defender)==null?void 0:Zo.firstName)||((Ki=X.player2)==null?void 0:Ki.firstName)," ",((Ji=X.defender)==null?void 0:Ji.lastName)||((Xi=X.player2)==null?void 0:Xi.lastName)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",X.matchType||"Challenge"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",X.scheduledDate?new Date(X.scheduledDate).toLocaleDateString():X.proposedDate?new Date(X.proposedDate).toLocaleDateString():"TBD"]})]}),e.jsx("p",{className:at.warningText,children:" This action cannot be undone."}),e.jsxs("div",{className:at.formButtons,children:[e.jsx("button",{onClick:_o,disabled:c,className:at.deleteButton,children:c?"Deleting...":"Delete Match"}),e.jsx("button",{onClick:()=>{I(!1),fe(null)},className:at.cancelButton,children:"Cancel"})]})]})})),e.jsxs("div",{children:[e.jsxs("div",{className:at.ladderSection,children:[e.jsxs("h3",{className:at.ladderTitle,children:[v==="499-under"?"499 & Under":v==="500-549"?"500-549":v==="550-plus"?"550+":v," Ladder"]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{color:"#fff",marginRight:"10px",fontSize:"14px"},children:"Filter by Payment Type:"}),e.jsxs("select",{value:Q,onChange:B=>H(B.target.value),style:{background:"rgba(255, 255, 255, 0.1)",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"6px",padding:"8px 12px",fontSize:"14px",minWidth:"200px"},children:[e.jsx("option",{value:"all",children:"All Payment Types"}),e.jsx("option",{value:"credits_purchase",children:" Credits Purchase"}),e.jsx("option",{value:"membership",children:" Membership"}),e.jsx("option",{value:"match_reporting",children:" Match Reporting"}),e.jsx("option",{value:"sanction",children:" Sanction"})]})]}),(()=>{const B=z.reduce(($e,Ge)=>(Q!=="all"&&Ge.type!==Q||Ge.type==="match_reporting"&&Ge.ladderName!==v||(["credits_purchase","membership","sanction"].includes(Ge.type)?$e[Ge.type]=($e[Ge.type]||0)+1:Ge.type==="match_reporting"&&($e.match_reporting=($e.match_reporting||0)+1)),$e),{}),Ne=Object.values(B).reduce(($e,Ge)=>$e+Ge,0);return Ne>0?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",padding:"15px",marginBottom:"20px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"10px"},children:[" Payment Summary (",Ne," total)"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"15px"},children:Object.entries(B).map(([$e,Ge])=>{const Yt={credits_purchase:{label:"Credits",color:"#10b981",icon:""},membership:{label:"Membership",color:"#3b82f6",icon:""},match_reporting:{label:"Match Reporting",color:"#f59e0b",icon:""},sanction:{label:"Sanction",color:"#8b5cf6",icon:""}}[$e];return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",color:(Yt==null?void 0:Yt.color)||"#fff",fontSize:"14px"},children:[Yt==null?void 0:Yt.icon," ",Yt==null?void 0:Yt.label,": ",Ge]},$e)})})]}):null})(),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:Ue,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},children:" Refresh Pending Payments"}),e.jsx("button",{onClick:async()=>{if(window.confirm("This will remove duplicate membership payments for the same player, keeping only the latest one. Continue?"))try{const B=await fetch(`${Ie}/api/monetization/cleanup-duplicates`,{method:"POST",headers:{"Content-Type":"application/json"}});if(B.ok){const Ne=await B.json();alert(` ${Ne.message}`),await Ue()}else alert(" Failed to cleanup duplicates")}catch(B){console.error("Error cleaning up duplicates:",B),alert(" Error cleaning up duplicates")}},style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},children:" Cleanup Duplicates"})]}),W?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#fff"},children:"Loading pending payments..."}):(()=>z.filter(Ne=>!(Q!=="all"&&Ne.type!==Q||Ne.type==="match_reporting"&&Ne.ladderName!==v)).length===0?e.jsxs("div",{style:{padding:"20px",background:"rgba(76, 175, 80, 0.1)",borderRadius:"8px",color:"#4caf50",textAlign:"center"},children:[" No pending payments requiring approval",Q!=="all"&&` for ${Q.replace("_"," ")}`,Q==="match_reporting"&&` in ${v}`]}):e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:(()=>{const $e=z.filter(St=>!(Q!=="all"&&St.type!==Q||St.type==="match_reporting"&&St.ladderName!==v)).reduce((St,Yt)=>{const hr=Yt.type;return St[hr]||(St[hr]=[]),St[hr].push(Yt),St},{}),Ge={credits_purchase:{label:"Credits Purchase",color:"#10b981",icon:""},membership:{label:"Membership",color:"#3b82f6",icon:""},match_reporting:{label:"Match Reporting",color:"#f59e0b",icon:""},sanction:{label:"Sanction",color:"#8b5cf6",icon:""}};return Object.entries($e).map(([St,Yt])=>{var hr,vr,rn,Mn,vn,qn;return e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{background:`linear-gradient(135deg, ${((hr=Ge[St])==null?void 0:hr.color)||"#6b7280"}20, ${((vr=Ge[St])==null?void 0:vr.color)||"#6b7280"}10)`,border:`1px solid ${((rn=Ge[St])==null?void 0:rn.color)||"#6b7280"}40`,borderRadius:"8px",padding:"10px",marginBottom:"10px"},children:e.jsxs("h4",{style:{color:((Mn=Ge[St])==null?void 0:Mn.color)||"#fff",margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"8px"},children:[((vn=Ge[St])==null?void 0:vn.icon)||""," ",((qn=Ge[St])==null?void 0:qn.label)||St.replace("_"," ").toUpperCase()," (",Yt.length,")"]})}),Yt.map(In=>{var Aa,ko;return e.jsx("div",{style:{padding:"15px",marginBottom:"10px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:`1px solid ${((Aa=Ge[St])==null?void 0:Aa.color)||"rgba(255, 255, 255, 0.1)"}40`},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[e.jsxs("div",{style:{flex:"1",minWidth:"200px"},children:[e.jsxs("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"5px"},children:["$",In.amount," - ",((ko=Ge[St])==null?void 0:ko.label)||In.type.replace("_"," ").toUpperCase()]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:["Player: ",In.playerEmail]}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:["Method: ",In.paymentMethod,"  Date: ",new Date(In.createdAt).toLocaleDateString()]}),In.ladderName&&e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:["Ladder: ",In.ladderName]}),In.description&&e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:["Description: ",In.description]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>ft(In._id,!0),style:{background:"#4CAF50",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:" Approve"}),e.jsx("button",{onClick:()=>ft(In._id,!1),style:{background:"#f44336",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:" Reject"})]})]})},In._id)})]},St)})})()}))()]}),e.jsx("div",{className:at.playersList,children:i.filter(B=>B.ladderName===v).length>0?e.jsxs("table",{className:at.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"8%"},children:"Position"}),e.jsx("th",{style:{width:"18%"},children:"Name"}),e.jsx("th",{style:{width:"25%"},children:"Email"}),e.jsx("th",{style:{width:"12%"},children:"Phone"}),e.jsx("th",{style:{width:"10%"},children:"Fargo Rate"}),e.jsx("th",{style:{width:"12%"},children:"Location"}),e.jsx("th",{style:{width:"8%"},children:"Status"}),e.jsx("th",{style:{width:"7%"},children:"Actions"})]})}),e.jsx("tbody",{children:i.filter(B=>B.ladderName===v).sort((B,Ne)=>(B.position||0)-(Ne.position||0)).map((B,Ne)=>{var $e;return e.jsxs("tr",{children:[e.jsx("td",{children:B.position||Ne+1}),e.jsxs("td",{children:[B.firstName," ",B.lastName]}),e.jsx("td",{style:{whiteSpace:"normal",wordBreak:"break-all"},children:($e=B.unifiedAccount)!=null&&$e.email?e.jsx("span",{style:{color:/@(ladder\.local|ladder\.temp|test|temp|local|fake|example|dummy)/i.test(B.unifiedAccount.email)?"#dc2626":"inherit"},children:B.unifiedAccount.email}):"No email"}),e.jsx("td",{children:B.phone}),e.jsx("td",{children:B.fargoRate}),e.jsx("td",{children:B.location}),e.jsx("td",{children:e.jsx("span",{className:`${at.status} ${B.isActive?at.active:at.inactive}`,children:B.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsx("button",{className:at.editButton,onClick:()=>Pr(B),style:{fontSize:"11px",padding:"4px 8px"},children:"Edit"}),e.jsx("button",{className:at.deleteButton,onClick:()=>Fn(B.email),style:{fontSize:"11px",padding:"4px 8px"},children:"Remove"}),e.jsx("button",{onClick:()=>qt(B),style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold"},title:"Resend welcome and password reset emails",children:" Email"})]})})]},B._id||B.email)})})]}):e.jsx("div",{className:at.noPlayers,children:"No players in this ladder yet"})})]})]}):a==="matches"?e.jsx(mee,{userToken:n}):a==="emails"?e.jsx(fee,{userToken:n}):a==="comprehensive-test"?e.jsx(yee,{backendUrl:Ie}):a==="test-environment"?e.jsx(TestEnvironmentSection,{backendUrl:Ie}):a==="payments"?e.jsx(PaymentApprovalsManager,{userToken:n}):a==="forfeits"?e.jsx(gee,{userToken:n}):a==="overdue"?e.jsx(xee,{selectedLadder:v,userToken:n}):a==="tournaments"?e.jsx(Nee,{}):null,R&&xr.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e5,padding:"20px"},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(42, 42, 42, 0.95), rgba(26, 26, 26, 0.98))",border:"2px solid #8B5CF6",borderRadius:"12px",width:"95vw",maxWidth:"1400px",minWidth:"800px",height:"85vh",display:"flex",flexDirection:"column",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",color:"#ffffff"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #8B5CF6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h2",{style:{color:"#8B5CF6",margin:0},children:[" Match History - ",v==="499-under"?"499 & Under":v==="500-549"?"500-549":v==="550-plus"?"550+":v," Ladder"]}),e.jsx("button",{onClick:()=>U(!1),style:{background:"none",border:"none",color:"#8B5CF6",fontSize:"24px",cursor:"pointer",padding:"5px"},children:""})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#8B5CF6 rgba(255, 255, 255, 0.1)"},children:c?e.jsx("div",{style:{textAlign:"center",color:"#ccc",padding:"40px",fontSize:"16px"},children:"Loading match history..."}):A.length===0?e.jsx("div",{style:{textAlign:"center",color:"#ccc",padding:"40px",fontSize:"16px"},children:"No matches recorded yet."}):e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",overflow:"hidden"},children:[e.jsx("style",{jsx:!0,children:`
                    div::-webkit-scrollbar {
                      width: 8px;
                    }
                    div::-webkit-scrollbar-track {
                      background: rgba(255, 255, 255, 0.1);
                      border-radius: 4px;
                    }
                    div::-webkit-scrollbar-thumb {
                      background: #8B5CF6;
                      border-radius: 4px;
                    }
                    div::-webkit-scrollbar-thumb:hover {
                      background: #7C3AED;
                    }
                  `}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"rgba(139, 92, 246, 0.2)"},children:[e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Date"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Winner"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Loser"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Score"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Type"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Location"}),e.jsx("th",{style:{padding:"10px 8px",textAlign:"left",borderBottom:"1px solid rgba(139, 92, 246, 0.3)",fontSize:"14px",fontWeight:"bold"},children:"Status"})]})}),e.jsx("tbody",{children:A.map((B,Ne)=>e.jsxs("tr",{style:{borderBottom:Ne<A.length-1?"1px solid rgba(255, 255, 255, 0.1)":"none",minHeight:"50px"},children:[e.jsx("td",{style:{padding:"8px",fontSize:"13px"},children:new Date(B.completedDate||B.scheduledDate).toLocaleDateString()}),e.jsxs("td",{style:{padding:"8px",fontSize:"13px"},children:[e.jsx("strong",{style:{color:"#22c55e"},children:B.winner?`${B.winner.firstName} ${B.winner.lastName}`:"N/A"}),B.winner&&B.winner.position!=="removed"?` (#${B.winner.position})`:""]}),e.jsxs("td",{style:{padding:"8px",fontSize:"13px"},children:[e.jsx("span",{style:{color:"#ef4444"},children:B.loser?`${B.loser.firstName} ${B.loser.lastName}`:"N/A"}),B.loser&&B.loser.position!=="removed"?` (#${B.loser.position})`:""]}),e.jsx("td",{style:{padding:"8px",fontSize:"13px"},children:B.score}),e.jsx("td",{style:{padding:"8px",fontSize:"13px"},children:B.matchType||"N/A"}),e.jsx("td",{style:{padding:"8px",fontSize:"13px"},children:B.venue||"N/A"}),e.jsx("td",{style:{padding:"8px",fontSize:"13px"},children:e.jsx("span",{style:{padding:"3px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold",background:B.status==="completed"?"rgba(34, 197, 94, 0.2)":B.status==="scheduled"?"rgba(59, 130, 246, 0.2)":"rgba(107, 114, 128, 0.2)",color:B.status==="completed"?"#22c55e":B.status==="scheduled"?"#3b82f6":"#6b7280"},children:B.status})})]},B.id||Ne))})]})]})})]})}),document.body),Oe&&e.jsx(Wb,{onClose:()=>Ze(!1),userToken:n}),ot&&Z(e.jsx(It,{open:ot,onClose:()=>lt(!1),title:"LMS Tracking - Matches Status",maxWidth:"90vw",maxHeight:"90vh",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#6c5ce7",marginBottom:"10px"},children:" LMS Match Status Tracking"}),e.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"Track which completed matches need to be entered into LMS for FargoRate reporting."})]}),tt.length===0?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#22c55e",fontSize:"16px"},children:" All matches are up to date with LMS!"}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#6c5ce7",color:"white"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Date"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Winner"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Loser"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Score"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Location"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"LMS Status"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Actions"})]})}),e.jsx("tbody",{children:tt.map((B,Ne)=>e.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:Ne%2===0?"#f9fafb":"white"},children:[e.jsxs("td",{style:{padding:"12px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:"blue"},children:B.completedDate?new Date(B.completedDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):new Date(B.scheduledDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:B.completedDate?"Played":"Scheduled"})]}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("strong",{style:{color:"#22c55e"},children:B.winner?typeof B.winner=="object"?`${B.winner.firstName} ${B.winner.lastName}`:B.winner:"N/A"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("span",{style:{color:"#ef4444"},children:B.loser?typeof B.loser=="object"?`${B.loser.firstName} ${B.loser.lastName}`:B.loser:"N/A"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("span",{style:{fontSize:"14px",fontWeight:"bold",color:B.score?"#1f2937":"#9ca3af"},children:B.score||"No Score"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("span",{style:{fontSize:"13px",color:B.venue?"#1f2937":"#9ca3af"},children:B.venue||"No Location"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:B.lmsStatus==="scheduled"?"#dbeafe":B.lmsStatus==="completed"?"#dcfce7":"#fef3c7",color:B.lmsStatus==="scheduled"?"#1d4ed8":B.lmsStatus==="completed"?"#16a34a":"#d97706"},children:B.lmsStatus==="scheduled"?" Scheduled in LMS":B.lmsStatus==="completed"?" Scored in LMS":" Not Entered"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[(!B.lmsStatus||B.lmsStatus==="not_entered")&&e.jsx("button",{onClick:()=>He(B._id||B.id),style:{background:"#3b82f6",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:" Mark as Scheduled"}),B.lmsStatus==="scheduled"&&e.jsx("button",{onClick:()=>Xe(B._id||B.id),style:{background:"#22c55e",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:" Scored in LMS"}),B.lmsStatus==="completed"&&e.jsx("span",{style:{color:"#16a34a",fontSize:"12px",fontWeight:"bold"},children:" Done"})]})})]},`${B._id||B.id}-${xt}`))})]})}),e.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#f0f9ff",borderRadius:"8px",border:"1px solid #0ea5e9"},children:[e.jsx("h4",{style:{color:"#0ea5e9",marginBottom:"10px"},children:" LMS Entry Instructions:"}),e.jsxs("ol",{style:{color:"#374151",fontSize:"14px",lineHeight:"1.6"},children:[e.jsx("li",{children:"Log into your LMS account"}),e.jsx("li",{children:"Go to your division/league"}),e.jsx("li",{children:"Add each match to the schedule"}),e.jsx("li",{children:"After the match is played, enter the winner and score"}),e.jsx("li",{children:`Click "Scheduled" when you've added it to LMS`}),e.jsx("li",{children:`Click "Completed" when you've entered the result`})]})]})]})})),Re&&Z(e.jsx(It,{open:Re,onClose:()=>it(!1),title:"Ladder Backups",maxWidth:"800px",maxHeight:"80vh",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h3",{style:{color:"#fff",margin:0},children:[" Backups for ",v," Ladder"]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsxs("span",{style:{color:"#ccc",fontSize:"14px"},children:[rt.length," backup",rt.length!==1?"s":""," found"]}),e.jsx("button",{onClick:vt,style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Refresh"})]})]}),rt.length===0?e.jsx("p",{style:{color:"#ccc",textAlign:"center",padding:"20px"},children:"No backups found for this ladder."}):e.jsxs("div",{style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"10px",scrollbarWidth:"thin",scrollbarColor:"#8B5CF6 rgba(255, 255, 255, 0.1)"},children:[e.jsx("style",{children:`
                  .backup-list::-webkit-scrollbar {
                    width: 8px;
                  }
                  .backup-list::-webkit-scrollbar-track {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 4px;
                  }
                  .backup-list::-webkit-scrollbar-thumb {
                    background: #8B5CF6;
                    border-radius: 4px;
                  }
                  .backup-list::-webkit-scrollbar-thumb:hover {
                    background: #7C3AED;
                  }
                `}),e.jsx("div",{className:"backup-list",children:rt.map((B,Ne)=>e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"15px",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{color:"#fff",margin:"0 0 5px 0"},children:["Backup #",rt.length-Ne]}),e.jsxs("p",{style:{color:"#ccc",margin:"0",fontSize:"14px"},children:["Created: ",new Date(B.backupDate).toLocaleString()]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{color:"#4ade80",fontSize:"12px",marginBottom:"5px"},children:[" ",B.summary.totalPlayers," players"]}),e.jsxs("div",{style:{color:"#60a5fa",fontSize:"12px"},children:[" ",B.summary.totalMatches," matches"]})]})]}),e.jsxs("div",{style:{marginTop:"10px",fontSize:"12px",color:"#ccc"},children:[e.jsxs("div",{children:["Active Players: ",B.summary.activePlayers]}),e.jsxs("div",{children:["Completed Matches: ",B.summary.completedMatches]})]}),e.jsxs("div",{style:{marginTop:"10px",textAlign:"right"},children:[e.jsx("button",{onClick:()=>Nt(B.id),style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold",marginRight:"8px"},children:" Preview Changes"}),e.jsx("button",{onClick:()=>tr(B.id),style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Restore"})]})]},B.id))})]}),e.jsx("div",{style:{marginTop:"20px",textAlign:"center"},children:e.jsx("button",{onClick:()=>it(!1),style:{background:"linear-gradient(135deg, #6b7280, #4b5563)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Close"})})]})})),kt&&te&&Z(e.jsx(It,{open:kt,onClose:()=>Ct(!1),title:"Restore Preview",maxWidth:"900px",maxHeight:"90vh",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("h3",{style:{color:"#fff",marginBottom:"20px"},children:[" Preview: Restoring from ",new Date(te.backupDate).toLocaleString()]}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#60a5fa",margin:"0 0 10px 0"},children:" Summary"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[e.jsxs("div",{children:["Backup Date: ",new Date(te.backupDate).toLocaleString()]}),e.jsxs("div",{children:["Players in Backup: ",te.backupPlayers.length]}),e.jsxs("div",{children:["Current Players: ",te.currentPlayers.length]}),e.jsxs("div",{children:["Changes: ",te.changes.length]})]})]}),e.jsxs("div",{style:{maxHeight:"400px",overflowY:"auto"},children:[e.jsx("h4",{style:{color:"#fff",marginBottom:"15px"},children:" Position Changes"}),te.changes.length===0?e.jsx("p",{style:{color:"#ccc",textAlign:"center",padding:"20px"},children:"No changes detected - backup matches current state"}):e.jsx("div",{children:te.changes.map((B,Ne)=>e.jsx("div",{style:{background:B.positionChange===0?"rgba(34, 197, 94, 0.1)":B.positionChange>0?"rgba(239, 68, 68, 0.1)":"rgba(34, 197, 94, 0.1)",border:B.positionChange===0?"1px solid rgba(34, 197, 94, 0.3)":B.positionChange>0?"1px solid rgba(239, 68, 68, 0.3)":"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"6px",padding:"12px",marginBottom:"8px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#fff"},children:B.name}),e.jsx("div",{style:{color:"#ccc",fontSize:"12px",marginTop:"2px"},children:B.email})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{color:B.positionChange===0?"#22c55e":B.positionChange>0?"#ef4444":"#22c55e",fontSize:"14px",fontWeight:"bold"},children:B.positionChange===0?"No Change":B.positionChange>0?` ${B.positionChange} spots`:` ${Math.abs(B.positionChange)} spots`}),e.jsxs("div",{style:{color:"#ccc",fontSize:"12px"},children:[B.currentPosition,"  ",B.backupPosition]})]})]})},Ne))})]}),e.jsxs("div",{style:{marginTop:"20px",textAlign:"center"},children:[e.jsx("button",{onClick:()=>Ct(!1),style:{background:"linear-gradient(135deg, #6b7280, #4b5563)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",marginRight:"10px"},children:"Cancel"}),e.jsx("button",{onClick:()=>{Ct(!1),tr(te.backupId)},style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Confirm Restore"})]})]})})),We&&st&&Z(e.jsx(It,{open:We,onClose:()=>Fe(!1),title:"Auto Backup Service Status",maxWidth:"600px",children:e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"20px"},children:" Automatic Backup Service"}),e.jsxs("div",{style:{background:"rgba(0, 184, 148, 0.1)",border:"1px solid rgba(0, 184, 148, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#00b894",margin:"0 0 10px 0"},children:" Service Status"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{style:{color:st.isRunning?"#00b894":"#ef4444",marginLeft:"8px"},children:st.isRunning?" Running":" Stopped"})]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Schedule:"}),e.jsx("span",{style:{color:"#60a5fa",marginLeft:"8px"},children:st.nextScheduledBackup})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Last Backup:"}),e.jsx("span",{style:{color:"#fbbf24",marginLeft:"8px"},children:st.lastBackupTime?new Date(st.lastBackupTime).toLocaleString():"Never"})]})]})]}),e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsx("h4",{style:{color:"#60a5fa",margin:"0 0 10px 0"},children:" How It Works"}),e.jsxs("div",{style:{color:"#ccc",fontSize:"14px",lineHeight:"1.5"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Automatic:"})," Backs up all ladders daily at 2:00 AM Mountain Time"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Complete:"})," Captures all player positions, stats, and match data"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[" ",e.jsx("strong",{children:"Safe:"})," Creates timestamped backups without affecting current data"]}),e.jsxs("div",{children:[" ",e.jsx("strong",{children:"Recovery:"}),' Use "View Backups" to restore from any backup']})]})]}),e.jsxs("div",{style:{marginTop:"20px",textAlign:"center"},children:[e.jsx("button",{onClick:()=>Fe(!1),style:{background:"linear-gradient(135deg, #6b7280, #4b5563)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",marginRight:"10px"},children:"Close"}),e.jsx("button",{onClick:Ht,style:{background:"linear-gradient(135deg, #00b894, #00a085)",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Backup All Ladders Now"})]})]})}))]})}const Pte=()=>e.jsx("div",{style:{width:"100%",minHeight:"100vh",background:"#000",overflow:"auto",padding:"20px",margin:0,position:"relative",top:0,left:0,boxSizing:"border-box"},children:e.jsx(Yb,{playerName:"Guest",playerLastName:"User",senderEmail:"guest@frontrangepool.com",userPin:"GUEST",onLogout:()=>{},isAdmin:!1,showClaimForm:!1,initialView:"ladders",isPublicView:!0,onClaimLadderPosition:()=>{},claimedPositions:[],isPositionClaimed:()=>!1})}),L2=()=>{const[n]=sb(),t=n.get("ladder")||"499-under",[r,s]=y.useState([]),[a,o]=y.useState(!0),[i,l]=y.useState(null);y.useEffect(()=>{c()},[t]);const c=async()=>{try{o(!0);const u=await mt.getLadderPlayersByName(t);if(u.success&&Array.isArray(u.data)){const h=u.data.map(p=>{var g,f;return{_id:p.user_id,firstName:((g=p.users)==null?void 0:g.first_name)||"Unknown",lastName:((f=p.users)==null?void 0:f.last_name)||"Unknown",position:p.position,fargoRate:p.fargo_rate||0,wins:p.wins||0,losses:p.losses||0,isActive:p.is_active,immunityUntil:p.immunity_until}});s(h)}else l("Failed to load ladder data")}catch(u){console.error("Error loading ladder data:",u),l("Error loading ladder data")}finally{o(!1)}},d=u=>{switch(u){case"499-under":return"499 & Under";case"500-549":return"500-549";case"550-plus":return"550+";default:return u}};return a?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontFamily:"Arial, sans-serif",background:"#1a1a1a",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"24px",marginBottom:"10px"},children:""}),e.jsx("div",{children:"Loading ladder data..."})]})}):i?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#e53e3e",fontFamily:"Arial, sans-serif",background:"#1a1a1a",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"24px",marginBottom:"10px"},children:""}),e.jsx("div",{children:i})]})}):e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",color:"#fff",minHeight:"100vh",padding:"10px",boxSizing:"border-box"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"20px",borderBottom:"2px solid #e53e3e",paddingBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0 0 5px 0",fontSize:"24px",color:"#e53e3e",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:"Ladder of Legends"}),e.jsxs("h2",{style:{margin:"0",fontSize:"18px",color:"#ccc",fontWeight:"normal"},children:[d(t)," Ladder"]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 80px 50px 50px 80px",background:"linear-gradient(135deg, #e53e3e, #c53030)",color:"white",fontWeight:"bold",fontSize:"14px",padding:"12px 8px",textAlign:"center"},children:[e.jsx("div",{children:"Rank"}),e.jsx("div",{children:"Player"}),e.jsx("div",{children:"Fargo"}),e.jsx("div",{children:"W"}),e.jsx("div",{children:"L"}),e.jsx("div",{children:"Status"})]}),r.map((u,h)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 80px 50px 50px 80px",padding:"10px 8px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",fontSize:"14px",alignItems:"center",background:h%2===0?"rgba(255, 255, 255, 0.02)":"transparent",transition:"background-color 0.2s ease"},onMouseEnter:p=>{p.currentTarget.style.background="rgba(229, 62, 62, 0.1)"},onMouseLeave:p=>{p.currentTarget.style.background=h%2===0?"rgba(255, 255, 255, 0.02)":"transparent"},children:[e.jsxs("div",{style:{textAlign:"center",fontWeight:"bold",color:"#e53e3e"},children:["#",u.position]}),e.jsxs("div",{style:{paddingLeft:"8px",fontWeight:"500"},children:[u.firstName," ",u.lastName]}),e.jsx("div",{style:{textAlign:"center",color:"#ccc"},children:u.fargoRate===0?"N/A":u.fargoRate}),e.jsx("div",{style:{textAlign:"center",color:"#4CAF50",fontWeight:"bold"},children:u.wins||0}),e.jsx("div",{style:{textAlign:"center",color:"#f44336",fontWeight:"bold"},children:u.losses||0}),e.jsx("div",{style:{textAlign:"center"},children:u.isActive?u.immunityUntil&&new Date(u.immunityUntil)>new Date?e.jsx("span",{style:{color:"#ff9800",fontSize:"12px"},children:"Immune"}):e.jsx("span",{style:{color:"#4CAF50",fontSize:"12px"},children:"Active"}):e.jsx("span",{style:{color:"#f44336",fontSize:"12px"},children:"Inactive"})})]},u._id||h))]}),e.jsxs("div",{style:{textAlign:"center",marginTop:"20px",fontSize:"12px",color:"#888",borderTop:"1px solid rgba(255, 255, 255, 0.1)",paddingTop:"15px"},children:[e.jsxs("p",{style:{margin:"5px 0"},children:[e.jsx("strong",{children:"Challenge Rules:"})," Standard challenges up to 4 positions above, SmackDown up to 5 positions below"]}),e.jsx("p",{style:{margin:"5px 0"},children:e.jsx("strong",{children:"Anyone can view the ladder - no account required!"})})]})]})},Ete=()=>e.jsx(l_,{children:e.jsxs(i_,{children:[e.jsx(Rr,{path:"/ladder-embed",element:e.jsx("div",{style:{position:"relative",minHeight:"100vh",width:"100%",background:"#000",padding:0,margin:0},children:e.jsx(L2,{})})}),e.jsx(Rr,{path:"*",element:e.jsx("div",{style:{position:"relative",minHeight:"100vh",width:"100%",background:"#000",padding:0,margin:0},children:e.jsx(L2,{})})})]})}),Rte="_container_1uhx5_1",Ate="_header_1uhx5_23",Mte="_addButton_1uhx5_53",Ite="_formOverlay_1uhx5_85",Dte="_form_1uhx5_85",$te="_formRow_1uhx5_145",Lte="_checkboxes_1uhx5_201",Bte="_formButtons_1uhx5_239",Ote="_playersList_1uhx5_299",zte="_table_1uhx5_307",Fte="_status_1uhx5_357",Wte="_approved_1uhx5_375",Ute="_pending_1uhx5_385",qte="_active_1uhx5_395",Hte="_inactive_1uhx5_405",Yte="_editButton_1uhx5_415",Gte="_deleteButton_1uhx5_417",an={container:Rte,header:Ate,addButton:Mte,formOverlay:Ite,form:Dte,formRow:$te,checkboxes:Lte,formButtons:Bte,playersList:Ote,table:zte,status:Fte,approved:Wte,pending:Ute,active:qte,inactive:Hte,editButton:Yte,deleteButton:Gte};function Vte(){const[n,t]=y.useState([]),[r,s]=y.useState(!0),[a,o]=y.useState(null),[i,l]=y.useState(!1),[c,d]=y.useState({firstName:"",lastName:"",email:"",phone:"",pin:"",division:"",locations:"",isApproved:!0,isActive:!0}),u=async()=>{try{const b=await(await fetch(`${Ie}/api/unified-auth/all-users`)).json();b.success&&t(b.users)}catch(v){console.error("Error fetching unified players:",v)}finally{s(!1)}};y.useEffect(()=>{u()},[]);const h=v=>{const{name:b,value:w,type:x,checked:j}=v.target;d(S=>({...S,[b]:x==="checkbox"?j:w}))},p=async v=>{v.preventDefault();try{const w=await(await fetch(`${Ie}/api/unified-auth/admin/add-user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();w.success?(l(!1),d({firstName:"",lastName:"",email:"",phone:"",pin:"",division:"",locations:"",isApproved:!0,isActive:!0}),u(),alert("Player added successfully!")):alert("Error adding player: "+w.message)}catch(b){console.error("Error adding player:",b),alert("Error adding player")}},g=async v=>{v.preventDefault();try{const w=await(await fetch(`${Ie}/api/unified-auth/admin/update-user/${a._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();w.success?(o(null),d({firstName:"",lastName:"",email:"",phone:"",pin:"",division:"",locations:"",isApproved:!0,isActive:!0}),u(),alert("Player updated successfully!")):alert("Error updating player: "+w.message)}catch(b){console.error("Error updating player:",b),alert("Error updating player")}},f=v=>{o(v),d({firstName:v.firstName||"",lastName:v.lastName||"",email:v.email||"",phone:v.phone||"",pin:v.pin||"",division:v.division||"",locations:v.locations||"",isApproved:v.isApproved||!1,isActive:v.isActive||!0})},m=async v=>{if(confirm("Are you sure you want to delete this player?"))try{const w=await(await fetch(`${Ie}/api/unified-auth/admin/delete-user/${v}`,{method:"DELETE"})).json();w.success?(u(),alert("Player deleted successfully!")):alert("Error deleting player: "+w.message)}catch(b){console.error("Error deleting player:",b),alert("Error deleting player")}};return r?e.jsx("div",{className:an.container,children:"Loading unified players..."}):e.jsxs("div",{className:an.container,children:[e.jsxs("div",{className:an.header,children:[e.jsx("h2",{children:"Unified Player Management"}),e.jsx("button",{className:an.addButton,onClick:()=>l(!0),children:"Add New Player"})]}),i&&e.jsx("div",{className:an.formOverlay,children:e.jsxs("div",{className:an.form,children:[e.jsx("h3",{children:"Add New Unified Player"}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:an.formRow,children:[e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:c.firstName,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:c.lastName,onChange:h,required:!0})]}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",value:c.email,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone",value:c.phone,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"pin",placeholder:"PIN",value:c.pin,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"division",placeholder:"Division",value:c.division,onChange:h}),e.jsx("input",{type:"text",name:"locations",placeholder:"Locations",value:c.locations,onChange:h}),e.jsxs("div",{className:an.checkboxes,children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"isApproved",checked:c.isApproved,onChange:h}),"Approved"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:c.isActive,onChange:h}),"Active"]})]}),e.jsxs("div",{className:an.formButtons,children:[e.jsx("button",{type:"submit",children:"Add Player"}),e.jsx("button",{type:"button",onClick:()=>l(!1),children:"Cancel"})]})]})]})}),a&&xr.createPortal(e.jsx("div",{className:an.formOverlay,children:e.jsxs("div",{className:an.form,children:[e.jsxs("h3",{children:["Edit Unified Player: ",a.firstName," ",a.lastName]}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:an.formRow,children:[e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:c.firstName,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:c.lastName,onChange:h,required:!0})]}),e.jsx("input",{type:"email",name:"email",placeholder:"Email",value:c.email,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone",value:c.phone,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"pin",placeholder:"PIN",value:c.pin,onChange:h,required:!0}),e.jsx("input",{type:"text",name:"division",placeholder:"Division",value:c.division,onChange:h}),e.jsx("input",{type:"text",name:"locations",placeholder:"Locations",value:c.locations,onChange:h}),e.jsxs("div",{className:an.checkboxes,children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"isApproved",checked:c.isApproved,onChange:h}),"Approved"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:c.isActive,onChange:h}),"Active"]})]}),e.jsxs("div",{className:an.formButtons,children:[e.jsx("button",{type:"submit",children:"Update Player"}),e.jsx("button",{type:"button",onClick:()=>o(null),children:"Cancel"})]})]})]})}),document.body),e.jsx("div",{className:an.playersList,children:e.jsxs("table",{className:an.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"PIN"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map(v=>e.jsxs("tr",{children:[e.jsxs("td",{children:[v.firstName," ",v.lastName]}),e.jsx("td",{children:v.email}),e.jsx("td",{children:v.phone}),e.jsx("td",{children:v.pin?"***":"Not Set"}),e.jsx("td",{children:v.role||"player"}),e.jsxs("td",{children:[e.jsx("span",{className:`${an.status} ${v.isApproved?an.approved:an.pending}`,children:v.isApproved?"Approved":"Pending"}),e.jsx("span",{className:`${an.status} ${v.isActive?an.active:an.inactive}`,children:v.isActive?"Active":"Inactive"})]}),e.jsxs("td",{children:[e.jsx("button",{className:an.editButton,onClick:()=>f(v),children:"Edit"}),e.jsx("button",{className:an.deleteButton,onClick:()=>m(v._id),children:"Delete"})]})]},v._id))})]})})]})}const Kte=()=>(y.useEffect(()=>{(()=>{const t=document.createElement("iframe");t.src="/dues-tracker/index.html",t.style.width="100%",t.style.height="100vh",t.style.border="none",t.style.overflow="auto",t.style.maxWidth="none";const r=document.getElementById("dues-tracker-container");r&&(r.innerHTML="",r.appendChild(t))})()},[]),e.jsx("div",{id:"dues-tracker-container",style:{width:"100vw",height:"100vh",overflow:"auto",maxWidth:"none",margin:"0 auto",padding:"0",position:"relative",zIndex:"1000"},children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"1.2rem"},children:"Loading original dues tracker..."})}));const Jte=()=>{var it,rt,yt,kt,Ct;const n=()=>window.location.hostname==="localhost"?"http://localhost:8080":"https://atlasbackend-bnng.onrender.com",[t,r]=y.useState(!1),[s,a]=y.useState(""),[o,i]=y.useState(!0),[l,c]=y.useState("teams"),[d,u]=y.useState([]),[h,p]=y.useState([]),[g,f]=y.useState([]),[m,v]=y.useState([]),[b,w]=y.useState(!1),[x,j]=y.useState(!1),[S,_]=y.useState(!1),[C,N]=y.useState(!1),[M,E]=y.useState(null),[P,D]=y.useState(null),[T,A]=y.useState(!1),[k,R]=y.useState(!1),[U,z]=y.useState(null),[$,W]=y.useState(null),[Y,Q]=y.useState(!1),[H,ue]=y.useState(!1),[J,be]=y.useState([]),[Ae,O]=y.useState(!1),[oe,me]=y.useState(!1),[Ce,ve]=y.useState(null);useEffect(()=>{console.log(" Component mounted - User Agent:",navigator.userAgent),console.log(" Is Mobile:",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));const te=localStorage.getItem("legends-tracker-auth");console.log(" Saved auth status:",te),te==="authenticated"&&(r(!0),i(!1),De(),et())},[]);const De=()=>{try{const te=localStorage.getItem("legends-teams"),ke=localStorage.getItem("legends-tables"),We=localStorage.getItem("legends-matches"),Fe=localStorage.getItem("legends-teams-main"),st=localStorage.getItem("legends-tables-main"),Ft=localStorage.getItem("legends-matches-main");te&&!Fe&&(localStorage.setItem("legends-teams-main",te),console.log("Migrated teams data")),ke&&!st&&(localStorage.setItem("legends-tables-main",ke),console.log("Migrated tables data")),We&&!Ft&&(localStorage.setItem("legends-matches-main",We),console.log("Migrated matches data"))}catch(te){console.error("Error migrating data:",te)}},Oe=te=>{te.preventDefault(),s==="lbcleagues"?(r(!0),i(!1),localStorage.setItem("legends-tracker-auth","authenticated"),et()):(alert("Incorrect password. Please try again."),a(""))},Ze=()=>{r(!1),i(!0),a(""),localStorage.removeItem("legends-tracker-auth")},et=async()=>{try{console.log(" Loading data from MongoDB..."),console.log(" Device type:",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"Mobile":"Desktop");const te=n();console.log(" API Base URL:",te);const[ke,We,Fe,st]=await Promise.all([fetch(`${te}/api/legends/teams`),fetch(`${te}/api/legends/tables`),fetch(`${te}/api/legends/matches`),fetch(`${te}/api/legends/inactive-teams`)]);if(console.log(" API Response Status:",{teams:ke.status,tables:We.status,matches:Fe.status,inactiveTeams:st.status}),ke.ok&&We.ok&&Fe.ok&&st.ok){const Ft=await ke.json(),Le=await We.json(),Z=await Fe.json(),Ye=await st.json();u(Ft),p(Le),f(Z),v(Ye),console.log(" Loaded data from MongoDB:",{teams:Ft.length,tables:Le.length,matches:Z.length,inactiveTeams:Ye.length}),console.log(" Teams data:",Ft),Ft.forEach(dt=>{var pt;console.log(` Team: ${dt.name}, Players: ${((pt=dt.players)==null?void 0:pt.length)||0}`,dt.players)})}else{console.log(" Database not available, using localStorage fallback");const Ft=localStorage.getItem("legends-teams"),Le=localStorage.getItem("legends-tables"),Z=localStorage.getItem("legends-matches");Ft&&u(JSON.parse(Ft)),Le&&p(JSON.parse(Le)),Z&&f(JSON.parse(Z))}}catch(te){console.error(" Error loading data:",te),console.log(" Error details:",{message:te.message,stack:te.stack,deviceType:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"Mobile":"Desktop"}),console.log(" Falling back to localStorage...");const ke=localStorage.getItem("legends-teams"),We=localStorage.getItem("legends-tables"),Fe=localStorage.getItem("legends-matches");ke&&u(JSON.parse(ke)),We&&p(JSON.parse(We)),Fe&&f(JSON.parse(Fe))}},re=async()=>{try{localStorage.setItem("legends-teams",JSON.stringify(d)),localStorage.setItem("legends-tables",JSON.stringify(h)),localStorage.setItem("legends-matches",JSON.stringify(g)),console.log(" Data saved to localStorage as backup")}catch(te){console.error(" Error saving to localStorage:",te)}},je=async te=>{te.preventDefault();const ke=new FormData(te.target),We={name:ke.get("team-name"),captain:ke.get("team-captain"),players:ke.get("team-players").split(",").map(Fe=>Fe.trim()).filter(Fe=>Fe),contact:ke.get("team-contact"),location:ke.get("team-location")||"Legends Brews & Cues",playDay:ke.get("team-play-day"),league:ke.get("team-league")||"Unknown",division:ke.get("team-division")||"Unknown",doublePlay:ke.get("team-double-play")==="on"};try{if(console.log(" Adding team to database:",We),(await fetch("${getApiBaseUrl()}/api/legends/teams",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)})).ok)await et(),w(!1),te.target.reset(),console.log(" Team added to database");else throw new Error("Failed to save team to database")}catch(Fe){console.error(" Error adding team:",Fe);const st={...We,id:Date.now()};u([...d,st]),w(!1),te.target.reset(),alert("Team added locally (database unavailable)")}},V=te=>{E(te),j(!0)},Ee=async te=>{te.preventDefault();const ke=new FormData(te.target),We={name:ke.get("edit-team-name"),captain:ke.get("edit-team-captain"),players:ke.get("edit-team-players").split(",").map(Fe=>Fe.trim()).filter(Fe=>Fe),contact:ke.get("edit-team-contact"),location:ke.get("edit-team-location"),playDay:ke.get("edit-team-play-day"),league:ke.get("edit-team-league")||"Unknown",division:ke.get("edit-team-division")||"Unknown",doublePlay:ke.get("edit-team-double-play")==="on"};try{if(console.log(" Updating team in database:",M._id,We),(await fetch(`${n()}/api/legends/teams/${M._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)})).ok)await et(),j(!1),E(null),console.log(" Team updated in database");else throw new Error("Failed to update team in database")}catch(Fe){console.error(" Error updating team:",Fe);const st={...We,_id:M._id};u(d.map(Ft=>Ft._id===M._id?st:Ft)),j(!1),E(null),alert("Team updated locally (database unavailable)")}},F=async te=>{if(window.confirm("Are you sure you want to deactivate this team? It will be moved to inactive teams and can be restored later."))try{if(console.log(" Soft deleting team from database:",te),(await fetch(`${n()}/api/legends/teams/${te}`,{method:"DELETE"})).ok)await et(),console.log(" Team moved to inactive teams"),alert("Team has been deactivated and moved to inactive teams. You can restore it later if needed.");else throw new Error("Failed to deactivate team from database")}catch(ke){console.error(" Error deactivating team:",ke),u(d.filter(We=>We._id!==te)),f(g.filter(We=>We.team1Id!==te&&We.team2Id!==te)),alert("Team deactivated locally (database unavailable)")}},ae=te=>{var ke;console.log(" Opening team modal for:",te),console.log(" Team players:",te.players),console.log(" Players length:",((ke=te.players)==null?void 0:ke.length)||0),D(te),A(!0),R(!1)},I=()=>{D(null),A(!1)},X=te=>{console.log(" Opening team schedule modal for:",te),console.log(" Available matches:",g.length),console.log(" Team matches:",g.filter(ke=>ke.team1===te.name||ke.team2===te.name)),ve(te),me(!0)},fe=()=>{ve(null),me(!1)},ne=async te=>{te.preventDefault();const ke=new FormData(te.target),We={number:parseInt(ke.get("table-number")),location:ke.get("table-location"),condition:ke.get("table-condition")};try{console.log(" Adding table to database:",We);const Fe=await fetch("${getApiBaseUrl()}/api/legends/tables",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)});if(Fe.ok){const st=await Fe.json();p([...h,st]),_(!1),te.target.reset(),console.log(" Table added to database:",st)}else throw new Error("Failed to save table to database")}catch(Fe){console.error(" Error adding table:",Fe);const st={...We,id:Date.now()};p([...h,st]),_(!1),te.target.reset(),alert("Table added locally (database unavailable)")}},ye=async te=>{if(window.confirm("Are you sure you want to delete this table?"))try{if(console.log(" Deleting table from database:",te),(await fetch(`/api/legends/tables/${te}`,{method:"DELETE"})).ok)p(h.filter(We=>We._id!==te)),console.log(" Table deleted from database");else throw new Error("Failed to delete table from database")}catch(ke){console.error(" Error deleting table:",ke),p(h.filter(We=>We._id!==te)),alert("Table deleted locally (database unavailable)")}},ot=async te=>{te.preventDefault();const ke=new FormData(te.target),We={team1:ke.get("match-team1"),team2:ke.get("match-team2"),table:parseInt(ke.get("match-table")),date:ke.get("match-date"),time:ke.get("match-time"),status:"scheduled"};try{if(console.log(" Adding match to database:",We),(await fetch("${getApiBaseUrl()}/api/legends/matches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)})).ok)await et(),N(!1),te.target.reset(),console.log(" Match added to database");else throw new Error("Failed to save match to database")}catch(Fe){console.error(" Error adding match:",Fe);const st={...We,id:Date.now()};f([...g,st]),N(!1),te.target.reset(),alert("Match added locally (database unavailable)")}},lt=async te=>{if(window.confirm("Are you sure you want to delete this match?"))try{if(console.log(" Deleting match from database:",te),(await fetch(`${n()}/api/legends/matches/${te}`,{method:"DELETE"})).ok)await et(),console.log(" Match deleted from database");else throw new Error("Failed to delete match from database")}catch(ke){console.error(" Error deleting match:",ke),f(g.filter(We=>We._id!==te)),alert("Match deleted locally (database unavailable)")}},tt=async()=>{if(window.confirm(`Are you sure you want to delete ALL ${g.length} matches?`))try{console.log(" Deleting all matches from database...");const te=g.map(Fe=>fetch(`${n()}/api/legends/matches/${Fe._id}`,{method:"DELETE"})),We=(await Promise.all(te)).filter(Fe=>!Fe.ok);We.length>0&&(console.warn(` ${We.length} matches failed to delete from database`),alert(`Warning: ${We.length} matches could not be deleted from database`)),await et(),console.log(" All matches deleted from database"),alert(`Successfully deleted ${g.length} matches`)}catch(te){console.error(" Error deleting all matches:",te),f([]),alert("All matches deleted locally (database unavailable)")}};useEffect(()=>{re()},[d,h,g]);const ge=async te=>{te.preventDefault();const ke=new FormData(te.target),We=ke.get("schedule-text"),Fe=ke.get("division")||"",st=ke.get("doublePlay")==="on";if(!We.trim()){alert("Please enter schedule text");return}try{console.log(" Parsing schedule text...");const Ft=await fetch("${getApiBaseUrl()}/api/legends/schedule/parse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduleText:We,division:Fe,doublePlay:st})});if(Ft.ok){const Le=await Ft.json();z(Le),console.log(" Schedule parsed successfully:",Le)}else throw new Error("Failed to parse schedule")}catch(Ft){console.error(" Error parsing schedule:",Ft),alert("Error parsing schedule. Please check the format and try again.")}},xt=async te=>{te.preventDefault();const We=new FormData(te.target).get("roster-text");if(!We.trim()){alert("Please enter roster text");return}try{console.log(" Parsing roster text...");const Fe=await fetch("${getApiBaseUrl()}/api/legends/roster/parse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rosterText:We})});if(Fe.ok){const st=await Fe.json();console.log(" Roster parsed successfully:",st),W(st);const Ft=ht(st.teams);console.log(" Team matches found:",Ft),be(Ft),Ft.length>0?O(!0):console.log(" No team matches found - showing roster results only")}else{const st=await Fe.json();throw console.error(" Roster parse failed:",st),new Error(`Failed to parse roster: ${st.error||"Unknown error"}`)}}catch(Fe){console.error(" Error parsing roster:",Fe),alert("Error parsing roster. Please check the format and try again.")}},ht=te=>{const ke=[];return te.forEach(We=>{const Fe=d.filter(st=>st.name.toLowerCase()===We.name.toLowerCase()||Je(st.name.toLowerCase(),We.name.toLowerCase())>.7||st.teamNumber===We.teamNumber);Fe.length>0&&ke.push({rosterTeam:We,potentialMatches:Fe,needsVerification:!0})}),ke},Je=(te,ke)=>{const We=te.length>ke.length?te:ke,Fe=te.length>ke.length?ke:te;if(We.length===0)return 1;const st=Pe(We,Fe);return(We.length-st)/We.length},Pe=(te,ke)=>{const We=[];for(let Fe=0;Fe<=ke.length;Fe++)We[Fe]=[Fe];for(let Fe=0;Fe<=te.length;Fe++)We[0][Fe]=Fe;for(let Fe=1;Fe<=ke.length;Fe++)for(let st=1;st<=te.length;st++)ke.charAt(Fe-1)===te.charAt(st-1)?We[Fe][st]=We[Fe-1][st-1]:We[Fe][st]=Math.min(We[Fe-1][st-1]+1,We[Fe][st-1]+1,We[Fe-1][st]+1);return We[ke.length][te.length]},Ve=async()=>{try{console.log(" Confirming team matches...");const te=[];if(J.forEach((ke,We)=>{var st;const Fe=(st=document.querySelector(`input[name="team-match-${We}"]:checked`))==null?void 0:st.value;Fe&&te.push({rosterTeam:ke.rosterTeam,existingTeamId:Fe})}),te.length===0){alert("Please select at least one team match to confirm");return}for(const ke of te){console.log(` Importing players for team: ${ke.rosterTeam.name}`);const We=await fetch(`${n()}/api/legends/teams/${ke.existingTeamId}/players`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({players:ke.rosterTeam.players})});if(We.ok)console.log(` Successfully imported players for ${ke.rosterTeam.name}`);else{const Fe=await We.json();console.error(` Failed to import players for ${ke.rosterTeam.name}:`,Fe)}}await et(),O(!1),alert(`Successfully imported players for ${te.length} team(s)!`)}catch(te){console.error(" Error confirming team matches:",te),alert("Error importing players. Please try again.")}},we=async()=>{if(!U){alert("No parsed data to import");return}try{if(console.log(" Importing parsed data to database..."),U.teams&&U.teams.length>0){console.log(" Importing teams...");for(const te of U.teams){const ke={...te};delete ke.id,ke.source="APA Schedule Parser";const We=await fetch("${getApiBaseUrl()}/api/legends/teams",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)});if(We.ok){const Fe=await We.json();console.log(" Team imported:",Fe.name)}else console.error(" Failed to import team:",te.name)}}if(U.schedules&&U.schedules.length>0){console.log(" Importing matches...");for(const te of U.schedules){const ke={...te};delete ke.id,ke.table=ke.table==="TBD"?1:parseInt(ke.table),ke.date=new Date(ke.date),ke.source="APA Schedule Parser",(await fetch("${getApiBaseUrl()}/api/legends/matches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)})).ok?console.log(" Match imported:",`${te.team1} vs ${te.team2}`):console.error(" Failed to import match:",`${te.team1} vs ${te.team2}`)}}await et(),alert("Data imported successfully!")}catch(te){console.error(" Error importing data:",te),alert("Error importing data. Please try again.")}},Re=g.filter(te=>{const ke=d.find(Fe=>Fe.name===te.team1||Fe.name===te.team2),We=ke&&te.team1===ke.name;return ke&&ke.location&&ke.location.toLowerCase().includes("legends")&&We});return t?e.jsxs("div",{className:"legends-tracker",children:[e.jsxs("div",{className:"tracker-header",children:[e.jsxs("h1",{children:[e.jsx("img",{src:Ux,alt:"Legends Logo",className:"legends-logo"})," Pool League Tracker"]}),e.jsx("p",{children:"Track teams, tables, and matches at Legends Brews & Cues"}),e.jsx("button",{className:"logout-btn",onClick:Ze,children:"Logout"})]}),e.jsxs("div",{className:"tracker-nav",children:[e.jsx("button",{className:`nav-tab ${l==="teams"?"active":""}`,onClick:()=>c("teams"),children:"Teams"}),e.jsx("button",{className:`nav-tab ${l==="tables"?"active":""}`,onClick:()=>c("tables"),children:"Tables"}),e.jsx("button",{className:`nav-tab ${l==="matches"?"active":""}`,onClick:()=>c("matches"),children:"Matches"}),e.jsx("button",{className:`nav-tab ${l==="apa-sync"?"active":""}`,onClick:()=>c("apa-sync"),children:"APA Teams/Rosters"}),e.jsx("button",{className:`nav-tab ${l==="inactive-teams"?"active":""}`,onClick:()=>c("inactive-teams"),children:"Inactive Teams"})]}),l==="teams"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"Teams"}),e.jsx("button",{className:"add-btn",onClick:()=>w(!0),children:"+ Add Team"})]}),b&&e.jsxs("div",{className:"form-container",children:[e.jsx("h3",{children:"Add New Team"}),e.jsxs("form",{onSubmit:je,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Team Name:"}),e.jsx("input",{type:"text",name:"team-name",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Captain:"}),e.jsx("input",{type:"text",name:"team-captain",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Players (comma-separated):"}),e.jsx("textarea",{name:"team-players",rows:"3",placeholder:"Player 1, Player 2, Player 3..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Contact Info:"}),e.jsx("input",{type:"text",name:"team-contact",placeholder:"Phone or email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Play Day:"}),e.jsxs("select",{name:"team-play-day",required:!0,children:[e.jsx("option",{value:"Monday",children:"Monday"}),e.jsx("option",{value:"Tuesday",children:"Tuesday"}),e.jsx("option",{value:"Wednesday",children:"Wednesday"}),e.jsx("option",{value:"Thursday",children:"Thursday"}),e.jsx("option",{value:"Friday",children:"Friday"}),e.jsx("option",{value:"Saturday",children:"Saturday"}),e.jsx("option",{value:"Sunday",children:"Sunday"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"League:"}),e.jsx("input",{type:"text",name:"team-league",placeholder:"e.g., APA, BCA, Local League"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Division:"}),e.jsx("input",{type:"text",name:"team-division",placeholder:"e.g., Division A, 8-Ball, 9-Ball"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"team-double-play"}),"Double Play Team (requires 2 tables)"]})}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",children:"Add Team"}),e.jsx("button",{type:"button",onClick:()=>w(!1),children:"Cancel"})]})]})]}),x&&M&&e.jsxs("div",{className:"form-container",children:[e.jsx("h3",{children:"Edit Team"}),e.jsxs("form",{onSubmit:Ee,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Team Name:"}),e.jsx("input",{type:"text",name:"edit-team-name",defaultValue:M.name,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Captain:"}),e.jsx("input",{type:"text",name:"edit-team-captain",defaultValue:M.captain,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Players (comma-separated):"}),e.jsx("textarea",{name:"edit-team-players",rows:"3",defaultValue:M.players.join(", ")})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Contact Info:"}),e.jsx("input",{type:"text",name:"edit-team-contact",defaultValue:M.contact})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Location:"}),e.jsx("input",{type:"text",name:"edit-team-location",defaultValue:M.location||""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Play Day:"}),e.jsxs("select",{name:"edit-team-play-day",required:!0,children:[e.jsx("option",{value:"Monday",selected:M.playDay==="Monday",children:"Monday"}),e.jsx("option",{value:"Tuesday",selected:M.playDay==="Tuesday",children:"Tuesday"}),e.jsx("option",{value:"Wednesday",selected:M.playDay==="Wednesday",children:"Wednesday"}),e.jsx("option",{value:"Thursday",selected:M.playDay==="Thursday",children:"Thursday"}),e.jsx("option",{value:"Friday",selected:M.playDay==="Friday",children:"Friday"}),e.jsx("option",{value:"Saturday",selected:M.playDay==="Saturday",children:"Saturday"}),e.jsx("option",{value:"Sunday",selected:M.playDay==="Sunday",children:"Sunday"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"League:"}),e.jsx("input",{type:"text",name:"edit-team-league",defaultValue:M.league||"",placeholder:"e.g., APA, BCA, Local League"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Division:"}),e.jsx("input",{type:"text",name:"edit-team-division",defaultValue:M.division||"",placeholder:"e.g., Division A, 8-Ball, 9-Ball"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"edit-team-double-play",defaultChecked:M.doublePlay}),"Double Play Team (requires 2 tables)"]})}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",children:"Update Team"}),e.jsx("button",{type:"button",onClick:()=>j(!1),children:"Cancel"})]})]})]}),e.jsx("div",{className:"teams-grid",children:d.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No teams yet"}),e.jsx("p",{children:"Add your first team to get started!"})]}):d.map(te=>e.jsx("div",{className:"team-card compact",children:e.jsxs("div",{className:"team-header",onClick:()=>ae(te),children:[e.jsxs("div",{className:"team-title",children:[e.jsx("h3",{children:te.name}),e.jsxs("div",{className:"team-summary",children:[e.jsxs("span",{className:"captain",children:[" ",te.captain]}),e.jsxs("span",{className:"play-day",children:[" ",te.playDay||"Monday"]}),e.jsxs("span",{className:"league",children:[" ",te.league||"Unknown",te.division&&te.division!=="Unknown"?` - ${te.division}`:""]}),te.doublePlay&&e.jsx("span",{className:"double-play-badge",children:" 2 Tables"})]})]}),e.jsxs("div",{className:"team-actions",onClick:ke=>ke.stopPropagation(),children:[e.jsx("button",{className:"schedule-btn",onClick:()=>X(te),title:"See schedule",children:""}),e.jsx("button",{className:"edit-btn",onClick:()=>V(te),title:"Edit team",children:""}),e.jsx("button",{className:"delete-btn",onClick:()=>F(te._id||te.id),title:"Delete team",children:""})]})]})},te._id||te.id))})]}),l==="tables"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"Tables"}),e.jsx("button",{className:"add-btn",onClick:()=>_(!0),children:"+ Add Table"})]}),S&&e.jsxs("div",{className:"form-container",children:[e.jsx("h3",{children:"Add New Table"}),e.jsxs("form",{onSubmit:ne,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Table Number:"}),e.jsx("input",{type:"number",name:"table-number",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Location:"}),e.jsx("input",{type:"text",name:"table-location",placeholder:"e.g., Legends Brews & Cues"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Condition:"}),e.jsxs("select",{name:"table-condition",children:[e.jsx("option",{value:"excellent",children:"Excellent"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",children:"Add Table"}),e.jsx("button",{type:"button",onClick:()=>_(!1),children:"Cancel"})]})]})]}),e.jsx("div",{className:"tables-grid",children:h.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No tables yet"}),e.jsx("p",{children:"Add your first table to get started!"})]}):h.map(te=>e.jsxs("div",{className:"table-card",children:[e.jsxs("div",{className:"table-header",children:[e.jsxs("h3",{children:["Table ",te.number]}),e.jsx("button",{className:"delete-btn",onClick:()=>ye(te._id||te.id),title:"Delete table",children:""})]}),e.jsxs("div",{className:"table-info",children:[e.jsx("strong",{children:"Location:"})," ",te.location||"Unknown"]}),e.jsxs("div",{className:"table-info",children:[e.jsx("strong",{children:"Condition:"})," ",te.condition]})]},te._id||te.id))})]}),l==="matches"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"Matches"}),e.jsxs("div",{className:"header-buttons",children:[e.jsx("button",{className:"add-btn",onClick:()=>N(!0),children:"+ Schedule Match"}),g.length>0&&e.jsx("button",{className:"delete-all-btn",onClick:tt,children:" Delete All"})]})]}),C&&e.jsxs("div",{className:"form-container",children:[e.jsx("h3",{children:"Schedule New Match"}),e.jsxs("form",{onSubmit:ot,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Team 1:"}),e.jsxs("select",{name:"match-team1",required:!0,children:[e.jsx("option",{value:"",children:"Select Team 1"}),d.map(te=>e.jsx("option",{value:te.name,children:te.name},te._id||te.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Team 2:"}),e.jsxs("select",{name:"match-team2",required:!0,children:[e.jsx("option",{value:"",children:"Select Team 2"}),d.map(te=>e.jsx("option",{value:te.name,children:te.name},te._id||te.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Table:"}),e.jsxs("select",{name:"match-table",required:!0,children:[e.jsx("option",{value:"",children:"Select Table"}),h.map(te=>e.jsxs("option",{value:te.number,children:["Table ",te.number]},te.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Date:"}),e.jsx("input",{type:"date",name:"match-date",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Time:"}),e.jsx("input",{type:"time",name:"match-time",required:!0})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",children:"Schedule Match"}),e.jsx("button",{type:"button",onClick:()=>N(!1),children:"Cancel"})]})]})]}),e.jsx("div",{className:"matches-list",children:Re.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No Legends matches scheduled"}),e.jsx("p",{children:"Your Legends teams don't have any matches yet!"})]}):Re.map(te=>{const ke=d.find(Ft=>Ft.name===te.team1||Ft.name===te.team2),We=te.team1===(ke==null?void 0:ke.name)?te.team2:te.team1,Fe=te.team1===(ke==null?void 0:ke.name),st=ke==null?void 0:ke.doublePlay;return e.jsxs("div",{className:`match-card ${Fe?"home-game":"away-game"}`,children:[e.jsxs("div",{className:"match-teams",children:[e.jsxs("div",{className:"team-header",children:[e.jsxs("h3",{children:[ke==null?void 0:ke.name,"  vs ",We]}),e.jsx("button",{className:"delete-btn",onClick:()=>lt(te._id||te.id),title:"Delete match",children:""})]}),e.jsxs("div",{className:"match-info",children:[e.jsx("strong",{children:"Opponent:"})," ",We]}),e.jsxs("div",{className:"match-info",children:[e.jsx("strong",{children:"Game Type:"})," ",Fe?" Home Game":" Away Game"]}),e.jsxs("div",{className:"match-info",children:[e.jsx("strong",{children:"Table:"})," ",te.table]}),st&&e.jsxs("div",{className:"match-info double-play-info",children:[e.jsx("strong",{children:" Double Play:"})," 2 tables needed"]}),e.jsxs("div",{className:"match-info",children:[e.jsx("strong",{children:"Location:"})," Legends"]})]}),e.jsxs("div",{className:"match-details",children:[e.jsxs("div",{className:"match-time",children:[new Date(te.date).toLocaleDateString()," at ",te.time]}),e.jsx("div",{className:"match-status",children:te.status})]})]},te._id||te.id)})})]}),l==="apa-sync"&&e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"parser-options",children:[e.jsxs("div",{className:"parser-card",children:[e.jsx("h3",{children:" Schedule Parser"}),e.jsx("p",{children:"Parse APA schedule text to extract team and match information for Legends teams."}),e.jsx("button",{className:"parser-btn",onClick:()=>Q(!0),children:"Open Schedule Parser"})]}),e.jsxs("div",{className:"parser-card",children:[e.jsx("h3",{children:" Roster Parser"}),e.jsx("p",{children:"Parse APA roster text to extract player information and match to existing teams."}),e.jsx("button",{className:"parser-btn",onClick:()=>ue(!0),children:"Open Roster Parser"})]})]}),Y&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content parser-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"APA Schedule Parser"}),e.jsx("button",{className:"close-btn",onClick:()=>{Q(!1),z(null)},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"parser-instructions",children:[e.jsx("h4",{children:" How to use the Schedule Parser:"}),e.jsxs("ol",{children:[e.jsx("li",{children:'Go to your APA league page and click "Print Schedule"'}),e.jsx("li",{children:"Copy the entire schedule text (including team list and matchups)"}),e.jsx("li",{children:"Paste the text into the textarea below"}),e.jsx("li",{children:'Optionally enter a division name (e.g., "8-Ball", "9-Ball", "Mixed")'}),e.jsx("li",{children:'Check "Double Play Teams" if all teams require 2 tables'}),e.jsx("li",{children:'Click "Parse Schedule" to extract Legends teams and matches'}),e.jsx("li",{children:'Review the results and click "Import All Data" to save'})]})]}),e.jsxs("form",{onSubmit:ge,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Schedule Text:"}),e.jsx("textarea",{name:"schedule-text",rows:"10",placeholder:"Paste the APA schedule text here...",style:{width:"100%",minHeight:"200px",padding:"12px",border:"2px solid #ddd",borderRadius:"8px",fontSize:"14px",fontFamily:"Courier New, monospace",backgroundColor:"#fafafa",color:"#333",resize:"vertical",transition:"border-color 0.3s ease"},onFocus:te=>te.target.style.borderColor="#007bff",onBlur:te=>te.target.style.borderColor="#ddd"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Division (Optional):"}),e.jsx("input",{type:"text",name:"division",placeholder:"e.g., 8-Ball, 9-Ball, Mixed, etc."}),e.jsx("small",{children:"This will be applied to all teams found in the schedule"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",name:"doublePlay"}),"Double Play Teams"]}),e.jsx("small",{children:"Check this if all teams in the schedule are double play teams"})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",children:"Parse Schedule"})})]}),U&&e.jsxs("div",{className:"sync-results",children:[e.jsx("h3",{children:"Parse Results"}),e.jsxs("div",{className:"results-summary",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Teams Found:"})," ",((it=U.teams)==null?void 0:it.length)||0]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Matches Found:"})," ",((rt=U.schedules)==null?void 0:rt.length)||0]}),U.errors&&U.errors.length>0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Errors:"})," ",U.errors.length]})]}),U.teams&&U.teams.length>0&&e.jsxs("div",{className:"results-section",children:[e.jsx("h4",{children:"Teams Found:"}),e.jsx("ul",{children:U.teams.map((te,ke)=>e.jsxs("li",{children:[e.jsx("strong",{children:te.name})," (",te.teamNumber,") - ",te.location,te.doublePlay&&e.jsx("span",{className:"double-play-badge",children:" Double Play"})]},ke))})]}),U.schedules&&U.schedules.length>0&&e.jsxs("div",{className:"results-section",children:[e.jsx("h4",{children:"Matches Found:"}),e.jsxs("ul",{children:[U.schedules.slice(0,10).map((te,ke)=>e.jsxs("li",{children:[e.jsx("strong",{children:te.team1})," vs ",e.jsx("strong",{children:te.team2}),"- ",new Date(te.date).toLocaleDateString()," (Week ",te.week,")"]},ke)),U.schedules.length>10&&e.jsxs("li",{children:["... and ",U.schedules.length-10," more matches"]})]})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{className:"import-btn",onClick:we,children:"Import All Data"})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"cancel-btn",onClick:()=>{Q(!1),z(null)},children:"Close"})})]})}),H&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content parser-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"APA Roster Parser"}),e.jsx("button",{className:"close-btn",onClick:()=>ue(!1),children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"parser-instructions",children:[e.jsx("h4",{children:" How to use the Roster Parser:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Go to your APA league page and navigate to roster information"}),e.jsx("li",{children:"Copy the roster text that includes team names and player lists"}),e.jsx("li",{children:"Paste the text into the textarea below"}),e.jsx("li",{children:'Click "Parse Roster" to extract player information'}),e.jsx("li",{children:"If matches are found with existing teams, verify the correct matches"}),e.jsx("li",{children:"Confirm matches to import players into your existing teams"})]})]}),e.jsxs("form",{onSubmit:xt,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Roster Text:"}),e.jsx("textarea",{name:"roster-text",rows:"15",placeholder:"Paste the APA roster text here...",required:!0,style:{width:"100%",minHeight:"300px",padding:"12px",border:"2px solid #ddd",borderRadius:"8px",fontSize:"14px",fontFamily:"Courier New, monospace",backgroundColor:"#fafafa",color:"#333",resize:"vertical",transition:"border-color 0.3s ease"},onFocus:te=>te.target.style.borderColor="#007bff",onBlur:te=>te.target.style.borderColor="#ddd"})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",children:"Parse Roster"})})]}),$&&e.jsxs("div",{className:"sync-results",children:[e.jsx("h3",{children:"Roster Parse Results"}),e.jsxs("div",{className:"results-summary",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Teams Found:"})," ",((yt=$.teams)==null?void 0:yt.length)||0]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Players:"})," ",((kt=$.teams)==null?void 0:kt.reduce((te,ke)=>{var We;return te+(((We=ke.players)==null?void 0:We.length)||0)},0))||0]}),$.errors&&$.errors.length>0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Errors:"})," ",$.errors.length]})]}),$.teams&&$.teams.length>0&&e.jsxs("div",{className:"results-section",children:[e.jsx("h4",{children:"Teams with Rosters:"}),e.jsx("ul",{children:$.teams.map((te,ke)=>{var We,Fe;return e.jsxs("li",{children:[e.jsx("strong",{children:te.name})," (",te.teamNumber,") - ",((We=te.players)==null?void 0:We.length)||0," players",e.jsxs("ul",{children:[(Fe=te.players)==null?void 0:Fe.slice(0,3).map((st,Ft)=>e.jsxs("li",{children:[st.name," (Skill: ",st.skillLevel,")"]},Ft)),te.players&&te.players.length>3&&e.jsxs("li",{children:["... and ",te.players.length-3," more players"]})]})]},ke)})})]})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"cancel-btn",onClick:()=>ue(!1),children:"Close"})})]})})]}),Ae&&J.length>0&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content team-verification-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Team Verification Required"}),e.jsx("button",{className:"close-btn",onClick:()=>O(!1),children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{children:"We found potential matches between roster teams and existing teams. Please verify the correct matches:"}),J.map((te,ke)=>{var We;return e.jsxs("div",{className:"team-match-section",children:[e.jsxs("h4",{children:["Roster Team: ",te.rosterTeam.name," (",te.rosterTeam.teamNumber,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Players:"})," ",((We=te.rosterTeam.players)==null?void 0:We.length)||0]}),e.jsxs("div",{className:"potential-matches",children:[e.jsx("h5",{children:"Potential Matches:"}),te.potentialMatches.map((Fe,st)=>e.jsx("div",{className:"match-option",children:e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:`team-match-${ke}`,value:Fe._id||Fe.id}),e.jsx("strong",{children:Fe.name}),Fe.teamNumber&&` (${Fe.teamNumber})`,e.jsx("br",{}),e.jsxs("small",{children:["Captain: ",Fe.captain," | Location: ",Fe.location]})]})},st))]})]},ke)})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>O(!1),children:"Cancel"}),e.jsx("button",{className:"confirm-btn",onClick:Ve,children:"Confirm Matches"})]})]})}),T&&P&&e.jsx("div",{className:"modal-overlay",onClick:I,children:e.jsxs("div",{className:"modal-content",onClick:te=>te.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:P.name}),e.jsx("button",{className:"close-btn",onClick:I,children:""})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"team-details-grid",children:[e.jsxs("div",{className:"detail-section",children:[e.jsx("h3",{children:" Team Information"}),e.jsxs("div",{className:"detail-row",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Captain:"})," ",P.captain]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Play Day:"})," ",P.playDay||"Monday"]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"League:"})," ",P.league||"Unknown",P.division&&P.division!=="Unknown"?` - ${P.division}`:""]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Location:"})," ",P.location||"Unknown"]})]}),e.jsx("div",{className:"detail-row",children:e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Double Play:"})," ",P.doublePlay?"Yes (2 tables needed)":"No"]})})]}),e.jsxs("div",{className:"detail-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:[" Players (",P.players.length,")"]}),e.jsx("button",{className:"toggle-btn",onClick:()=>R(!k),title:k?"Hide players":"Show players",children:k?"":""})]}),k&&(P.players.length>0?e.jsx("div",{className:"players-list",children:P.players.map((te,ke)=>e.jsxs("div",{className:"player-item",children:[ke+1,". ",te]},ke))}):e.jsx("div",{className:"no-players",children:"No players listed"}))]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h3",{children:" Additional Information"}),e.jsxs("div",{className:"detail-row",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Contact:"})," ",P.contact||"No contact info"]}),P.teamNumber&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Team Number:"})," ",P.teamNumber]})]}),P.source&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Source:"})," ",P.source]})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"edit-btn",onClick:()=>{I(),V(P)},children:" Edit Team"}),e.jsx("button",{className:"delete-btn",onClick:()=>{I(),F(P._id||P.id)},children:" Delete Team"})]})]})}),oe&&Ce&&e.jsx("div",{className:"modal-overlay",onClick:fe,children:e.jsxs("div",{className:"modal-content team-schedule-modal",onClick:te=>te.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[Ce.name," - Full Schedule"]}),e.jsx("button",{className:"close-btn",onClick:fe,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"schedule-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Team:"})," ",Ce.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Captain:"})," ",Ce.captain]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Play Day:"})," ",Ce.playDay||"Monday"]})]}),e.jsxs("div",{className:"schedule-matches",children:[e.jsxs("h3",{children:["All Matches (",g?g.filter(te=>te.team1===Ce.name||te.team2===Ce.name).length:0,")"]}),!g||g.filter(te=>te.team1===Ce.name||te.team2===Ce.name).length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No matches scheduled for this team yet."})}):e.jsx("div",{className:"matches-list",children:(Ct=g==null?void 0:g.filter(te=>te.team1===Ce.name||te.team2===Ce.name))==null?void 0:Ct.map(te=>{const ke=te.team1===Ce.name,We=ke?te.team2:te.team1,Fe=d.find(Ft=>Ft.name===We);let st;return ke?st="Legends":te.location&&te.location!=="Legends"?st=te.location:Fe!=null&&Fe.location&&Fe.location!=="Unknown"?st=Fe.location:st=`@ ${We}`,e.jsxs("div",{className:`schedule-match-card ${ke?"home-game":"away-game"}`,children:[e.jsxs("div",{className:"match-header",children:[e.jsxs("h4",{children:[ke?"":""," ",ke?"HOME":"AWAY"," vs ",We]}),e.jsx("button",{className:"delete-btn",onClick:()=>lt(te._id||te.id),title:"Delete match",children:""})]}),e.jsxs("div",{className:"match-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(te.date).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",te.time||"TBD"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Table:"})," ",te.table||"TBD"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",st]}),!ke&&(Fe==null?void 0:Fe.location)&&e.jsxs("p",{children:[e.jsx("strong",{children:"Opponent Location:"})," ",Fe.location]})]})]},te._id||te.id)})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"cancel-btn",onClick:fe,children:"Close"})})]})})]}):e.jsx("div",{className:"legends-tracker",children:e.jsx("div",{className:"password-container",children:e.jsxs("div",{className:"password-form",children:[e.jsxs("div",{className:"password-header",children:[e.jsxs("h1",{children:[e.jsx("img",{src:Ux,alt:"Legends Logo",className:"legends-logo"})," Legends Pool League Tracker"]}),e.jsx("p",{children:"Enter password to access"})]}),e.jsxs("form",{onSubmit:Oe,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password:"}),e.jsx("input",{type:"password",id:"password",value:s,onChange:te=>a(te.target.value),placeholder:"Enter password",required:!0,autoFocus:!0})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",children:"Access Tracker"})})]})]})})})};function FN(n){const t=n.length,r=Math.pow(2,Math.ceil(Math.log2(Math.max(2,t)))),s=r-t,a=[...n];for(let h=0;h<s;h++)a.push("Bye");const o=[];let i=0;const l=()=>`m${++i}`,c=[];for(let h=0;h<r/2;h++){const p=l();c.push({matchId:p,slot1:a[h*2]||"",slot2:a[h*2+1]||"",winner:null,nextMatchId:null})}o.push({roundIndex:0,name:"Round 1",matches:c});let d=c,u=1;for(;d.length>1;){const h=d.length/2,p=[];for(let g=0;g<h;g++){const f=l(),m=d[g*2],v=d[g*2+1];m&&(m.nextMatchId=f),v&&(v.nextMatchId=f),p.push({matchId:f,slot1:"",slot2:"",winner:null,nextMatchId:null})}o.push({roundIndex:u,name:`Round ${u+1}`,matches:p}),d=p,u++}return d.length===1&&(d[0].nextMatchId=null),{rounds:o}}function Xte(n){var g,f;const r=FN(n).rounds,s=r[0].matches.length,a=Math.max(1,s/2),o=(f=(g=r[r.length-1])==null?void 0:g.matches)==null?void 0:f[0];o&&(o.nextMatchId="gf"),r[0].matches.forEach((m,v)=>{m.loserNextMatchId=`lm-1-${Math.floor(v/2)}`,m.loserSlot=v%2===0?1:2}),r.length>=2&&r[1].matches.forEach((v,b)=>{v.loserNextMatchId=`lm-2-${b}`,v.loserSlot=2});const i={matchId:"gf",slot1:"",slot2:"",winner:null},l=[];for(let m=0;m<a;m++)l.push({matchId:`lm-1-${m}`,slot1:"",slot2:"",winner:null,nextMatchId:a===1?"lm-2-0":`lm-2-${m}`});const c=[{roundIndex:0,name:"Losers Round 1",matches:l}],d=a,u=[];for(let m=0;m<d;m++)u.push({matchId:`lm-2-${m}`,slot1:"",slot2:"",winner:null,nextMatchId:d===1?"gf":"lm-3-0"});c.push({roundIndex:1,name:"Losers Round 2",matches:u});let h=u,p=2;for(;h.length>1;){const m=h.length/2,v=[];for(let b=0;b<m;b++){const w=h[b*2],x=h[b*2+1];w&&(w.nextMatchId=`lm-${p+1}-${b}`),x&&(x.nextMatchId=`lm-${p+1}-${b}`),v.push({matchId:`lm-${p+1}-${b}`,slot1:"",slot2:"",winner:null,nextMatchId:m===1?"gf":`lm-${p+2}-0`})}if(c.push({roundIndex:p,name:`Losers Round ${p+1}`,matches:v}),h=v,p++,h.length===1){h[0].nextMatchId="gf";break}}return{winnersRounds:r,loserRounds:c,grandFinal:i}}function ay(n,t){for(const r of n){const s=r.matches.find(a=>a.matchId===t);if(s)return s}return null}function oy(n,t,r){if(r==="gf")return t||null;for(const s of n||[]){const a=s.matches.find(o=>o.matchId===r);if(a)return a}return null}function Qte(n,t,r,s){const a=ay(n,t);if(a){if(a.winner=r,a.nextMatchId==="gf"&&s){s.slot1?s.slot2=r:s.slot1=r;return}if(a.nextMatchId){const o=ay(n,a.nextMatchId);o&&(o.slot1?o.slot2||(o.slot2=r):o.slot1=r)}}}function Zte(n,t,r,s){const a=ay(n,t);if(!a||!a.loserNextMatchId)return;const o=a.winner===a.slot1?a.slot2:a.slot1;if(!o||o==="Bye")return;const i=oy(r,s,a.loserNextMatchId);if(!i)return;a.loserSlot===1?i.slot1=o:i.slot2=o}function ere(n,t,r,s){const a=oy(n,null,t);if(a){if(a.winner=r,a.nextMatchId==="gf"&&s){s.slot2||(s.slot2=r);return}if(a.nextMatchId){const o=oy(n,s,a.nextMatchId);o&&(o.slot1?o.slot2||(o.slot2=r):o.slot1=r)}}}const Kd=160,wc=32,Jd=48,jc=8;function iy({rounds:n,onUpdate:t,grandFinalRef:r,bracketKind:s="winners"}){const a=y.useRef(null),[o,i]=y.useState({width:0,height:0}),l=y.useRef({}),c=(p,g)=>{t&&(s==="losers"?ere(n,p,g,r):Qte(n,p,g,r),t([...n]))},d=y.useMemo(()=>{if(!(n!=null&&n.length))return null;const g=n[0].matches.length*2,f={};return n.forEach((m,v)=>{const b=Math.pow(2,v+1);m.matches.forEach((w,x)=>{const j=x*b;f[w.matchId]={roundIndex:v,row:j,span:b,col:v}})}),{totalRows:g,numCols:n.length,matchPositions:f}},[n]);if(y.useEffect(()=>{if(!a.current||!d)return;a.current;const p=d.numCols*Kd+(d.numCols-1)*Jd,g=d.totalRows*wc+(d.totalRows-1)*jc;i({width:p,height:g})},[d]),!(n!=null&&n.length))return null;const u=d.totalRows,h=d.numCols;return e.jsx("div",{className:"bracket-paper-wrap",children:e.jsxs("div",{className:"bracket-paper",ref:a,style:{width:o.width,minHeight:o.height},children:[e.jsxs("svg",{className:"bracket-connectors",width:o.width,height:o.height,children:[e.jsx("defs",{children:e.jsx("marker",{id:"bracket-arrow",markerWidth:"6",markerHeight:"6",refX:"5",refY:"3",orient:"auto",children:e.jsx("path",{d:"M0,0 L6,3 L0,6 Z",fill:"rgba(148, 163, 184, 0.6)"})})}),n.slice(0,-1).map(p=>p.matches.map(g=>{if(!g.nextMatchId)return null;const f=d.matchPositions[g.matchId],m=n[f.roundIndex+1].matches.find(_=>_.matchId===g.nextMatchId),v=m&&d.matchPositions[m.matchId];if(!f||!v)return null;const b=(f.col+1)*Kd+f.col*Jd,w=v.col*(Kd+Jd),x=(f.row+f.span/2)*(wc+jc)-jc/2+wc/2,j=(v.row+v.span/2)*(wc+jc)-jc/2+wc/2,S=(b+w)/2;return e.jsx("path",{d:`M ${b} ${x} L ${S} ${x} L ${S} ${j} L ${w} ${j}`,fill:"none",stroke:"rgba(120, 113, 108, 0.55)",strokeWidth:"1.5",strokeLinecap:"round"},`line-${g.matchId}`)}))]}),e.jsx("div",{className:"bracket-round-labels",style:{width:o.width,gridTemplateColumns:`repeat(${h}, ${Kd}px)`,gap:`0 ${Jd}px`},children:n.map(p=>e.jsx("div",{className:"bracket-round-label",children:p.name},p.roundIndex))}),e.jsx("div",{className:"bracket-grid",style:{gridTemplateColumns:`repeat(${h}, ${Kd}px)`,gridTemplateRows:`repeat(${u}, ${wc}px)`,gap:`${jc}px ${Jd}px`,width:o.width,height:o.height},children:n.map(p=>p.matches.map((g,f)=>{const m=Math.pow(2,p.roundIndex+1),v=f*m;return e.jsx("div",{ref:b=>{b&&(l.current[g.matchId]=b)},className:"bracket-grid-cell",style:{gridColumn:p.roundIndex+1,gridRow:`${v+1} / span ${m}`},children:e.jsx(tre,{match:g,onSetWinner:c,roundName:p.name})},g.matchId)}))})]})})}function tre({match:n,onSetWinner:t,roundName:r}){const s=n.slot1||"",a=n.slot2||"",o=n.winner,i=s||"",l=a||"",c=d=>{d==="Bye"||!d||t(n.matchId,d)};return e.jsxs("div",{className:"bracket-match-paper",children:[e.jsx("div",{className:`bracket-slot-paper top ${o===n.slot1?"winner":""}`,onClick:()=>n.slot1&&c(n.slot1),title:n.slot1?`Click to set ${n.slot1} as winner`:"",children:i}),e.jsx("div",{className:"bracket-match-divider"}),e.jsx("div",{className:`bracket-slot-paper bottom ${o===n.slot2?"winner":""}`,onClick:()=>n.slot2&&c(n.slot2),title:n.slot2?`Click to set ${n.slot2} as winner`:"",children:l})]})}function rre({data:n,onUpdate:t}){const{winnersRounds:r,loserRounds:s,grandFinal:a}=n,o=c=>{const d=s.map(u=>({...u,matches:u.matches.map(h=>({...h}))}));c.forEach(u=>u.matches.forEach(h=>{h.winner&&h.loserNextMatchId&&Zte(c,h.matchId,d,a)})),t&&t({...n,winnersRounds:c,loserRounds:d})},i=c=>{t&&t({...n,loserRounds:c})},l=c=>{!c||!a.slot1||!a.slot2||(a.winner=c,t&&t({...n}))};return e.jsxs("div",{className:"double-elim-display",children:[e.jsxs("section",{className:"winners-bracket-section",children:[e.jsx("h2",{className:"bracket-section-title",children:"Winner's Bracket"}),e.jsx(iy,{rounds:r,onUpdate:o,grandFinalRef:a,bracketKind:"winners"})]}),s&&s.length>0&&e.jsxs("section",{className:"losers-bracket-section",children:[e.jsx("h2",{className:"bracket-section-title",children:"Loser's Bracket"}),e.jsx(iy,{rounds:s,onUpdate:i,grandFinalRef:a,bracketKind:"losers"})]}),e.jsxs("section",{className:"grand-final-section",children:[e.jsx("h2",{className:"bracket-section-title",children:"Grand Final"}),e.jsxs("div",{className:"bracket-match-paper grand-final-cell",children:[e.jsx("div",{className:`bracket-slot-paper top ${a.winner===a.slot1?"winner":""}`,onClick:()=>l(a.slot1),children:a.slot1||"TBD"}),e.jsx("div",{className:"bracket-match-divider"}),e.jsx("div",{className:`bracket-slot-paper bottom ${a.winner===a.slot2?"winner":""}`,onClick:()=>l(a.slot2),children:a.slot2||"TBD"}),a.winner&&e.jsxs("div",{className:"bracket-winner-badge",children:["Champion: ",a.winner]})]})]})]})}function nre({isOpen:n,onClose:t,onAdd:r}){const[s,a]=y.useState(""),[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState(""),g=()=>{a(""),i(""),c(""),u(""),p("")},f=()=>{g(),t()},m=v=>{v.preventDefault();const b=s.trim();if(!b){alert("Please enter a name.");return}r({name:b,email:o.trim()||"",league:l.trim()||"",rank:d.trim()||"",fargorate:h.trim()||""}),g(),t()};return n?e.jsx("div",{className:"add-player-modal-overlay",onClick:f,role:"dialog","aria-modal":"true","aria-label":"Add player",children:e.jsxs("div",{className:"add-player-modal",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"add-player-modal-header",children:[e.jsx("h3",{children:"Add Player"}),e.jsx("button",{type:"button",className:"add-player-modal-close",onClick:f,"aria-label":"Close",children:""})]}),e.jsxs("form",{onSubmit:m,className:"add-player-modal-form",children:[e.jsxs("label",{children:["Name ",e.jsx("span",{className:"required",children:"*"}),e.jsx("input",{type:"text",value:s,onChange:v=>a(v.target.value),placeholder:"Player name",autoFocus:!0})]}),e.jsxs("label",{children:["Email",e.jsx("input",{type:"email",value:o,onChange:v=>i(v.target.value),placeholder:"email@example.com"})]}),e.jsxs("label",{children:["League",e.jsx("input",{type:"text",value:l,onChange:v=>c(v.target.value),placeholder:"e.g. Front Range BCA"})]}),e.jsxs("label",{children:["Rank",e.jsx("input",{type:"text",value:d,onChange:v=>u(v.target.value),placeholder:"e.g. A, B, C or 500"})]}),e.jsxs("label",{children:["FargoRate",e.jsx("input",{type:"text",value:h,onChange:v=>p(v.target.value),placeholder:"e.g. 550"})]}),e.jsxs("div",{className:"add-player-modal-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:f,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Add Player"})]})]})]})}):null}function sre({onSubmit:n,onCancel:t}){const[r,s]=y.useState(""),[a,o]=y.useState("single"),[i,l]=y.useState([]),[c,d]=y.useState(!1),u=f=>{l(m=>[...m,f])},h=f=>{l(m=>m.filter((v,b)=>b!==f))},p=f=>{if(f.preventDefault(),i.length<2){alert("Please add at least 2 players using the Add Player button.");return}const m=i.map(v=>v.name);n({name:r||"Pool Tournament",type:a,entrantNames:m,entrants:i})},g=()=>{t&&t()};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"create-tournament-form",onSubmit:p,children:[e.jsx("h3",{children:"New Tournament"}),e.jsxs("label",{children:["Tournament name",e.jsx("input",{type:"text",value:r,onChange:f=>s(f.target.value),placeholder:"e.g. Friday Night 8-Ball"})]}),e.jsxs("label",{children:["Format",e.jsxs("select",{value:a,onChange:f=>o(f.target.value),children:[e.jsx("option",{value:"single",children:"Single elimination"}),e.jsx("option",{value:"double",children:"Double elimination"})]})]}),e.jsxs("label",{children:["Players",e.jsxs("div",{className:"players-section",children:[e.jsx("button",{type:"button",className:"add-player-btn",onClick:()=>d(!0),children:"+ Add Player"}),i.length>0&&e.jsx("ul",{className:"players-list",children:i.map((f,m)=>e.jsxs("li",{className:"player-list-item",children:[e.jsx("span",{className:"player-list-name",children:f.name}),(f.league||f.rank||f.fargorate)&&e.jsx("span",{className:"player-list-detail",children:[f.league,f.rank,f.fargorate].filter(Boolean).join("  ")}),e.jsx("button",{type:"button",className:"player-list-remove",onClick:()=>h(m),"aria-label":`Remove ${f.name}`,children:""})]},m))}),i.length>0&&e.jsxs("p",{className:"players-count",children:[i.length," player",i.length!==1?"s":""," added"]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:g,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Create bracket"})]})]}),e.jsx(nre,{isOpen:c,onClose:()=>d(!1),onAdd:u})]})}const s0="frontrange-tournament-bracket";function are(){var c;const n=yn(),[t,r]=y.useState(()=>{try{const d=localStorage.getItem(s0);if(d){const u=JSON.parse(d);if(u&&u.entrantNames&&u.entrantNames.length>=2)return u}}catch{}return null}),s=y.useCallback(d=>{r(d);try{d?localStorage.setItem(s0,JSON.stringify(d)):localStorage.removeItem(s0)}catch{}},[]),a=d=>{if(d.type==="single"){const{rounds:u}=FN(d.entrantNames);s({name:d.name,type:"single",entrantNames:d.entrantNames,entrants:d.entrants||d.entrantNames.map(h=>({name:h})),rounds:u})}else{const{winnersRounds:u,loserRounds:h,grandFinal:p}=Xte(d.entrantNames);s({name:d.name,type:"double",entrantNames:d.entrantNames,entrants:d.entrants||d.entrantNames.map(g=>({name:g})),winnersRounds:u,loserRounds:h,grandFinal:p})}},o=d=>{t&&t.type==="single"&&s({...t,rounds:d})},i=d=>{!t||t.type!=="double"||s({...t,...d})},l=()=>{s(null)};return t?e.jsxs("div",{className:"tournament-bracket-app",children:[e.jsxs("header",{className:"tb-header",children:[e.jsx("h1",{children:t.name}),e.jsxs("p",{children:[t.type==="single"?"Single elimination":"Double elimination"," "," ",((c=t.entrantNames)==null?void 0:c.length)||0," entrants"]}),e.jsx("button",{type:"button",className:"tb-btn-new",onClick:l,children:"New tournament"})]}),t.type==="single"&&e.jsx(iy,{rounds:t.rounds,onUpdate:o}),t.type==="double"&&e.jsx(rre,{data:{winnersRounds:t.winnersRounds,loserRounds:t.loserRounds,grandFinal:t.grandFinal},onUpdate:i})]}):e.jsxs("div",{className:"tournament-bracket-app",children:[e.jsxs("header",{className:"tb-header",children:[e.jsx("h1",{children:"Tournament Bracket"}),e.jsx("p",{children:"Run single or double elimination pool tournaments."})]}),e.jsx("div",{className:"tb-create",children:e.jsx(sre,{onSubmit:a,onCancel:()=>n("/")})})]})}const ore=()=>{const n=yn(),[t,r]=y.useState("info"),[s,a]=y.useState(null),[o,i]=y.useState(!0),[l,c]=y.useState(null),[d,u]=y.useState(!1),[h,p]=y.useState({firstName:"",lastName:"",email:"",phone:"",experience:"beginner",fargoRate:"",currentLeague:"",currentRanking:"",message:""}),[g,f]=y.useState(!1);y.useEffect(()=>{m()},[]);const m=async()=>{try{i(!0);const j=await fetch(`${Ie}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:"guest@frontrangepool.com"})});if(j.ok){const S=await j.json();a(S.user),console.log("Guest user authenticated:",S.user)}else{const S=await j.json();console.error("Guest authentication failed:",S),c("Failed to authenticate guest user")}}catch(j){console.error("Error authenticating guest:",j),c("Network error during authentication")}finally{i(!1)}},v=()=>{n("/")},b=()=>{console.log("Opening join modal..."),u(!0)},w=async j=>{if(j.preventDefault(),!h.firstName||!h.lastName||!h.email){alert("Please fill in all required fields (First Name, Last Name, and Email)");return}f(!0);try{await new Promise(S=>setTimeout(S,1e3)),alert(` Thank you for your interest in joining the Front Range Pool League BCAPL Singles Division!

We've received your application:

Name: ${h.firstName} ${h.lastName}
Email: ${h.email}
Experience: ${h.experience}${h.fargoRate?`
FargoRate: ${h.fargoRate}`:""}${h.currentLeague?`
Current League: ${h.currentLeague}`:""}${h.currentRanking?`
Current Ranking: ${h.currentRanking}`:""}

We'll contact you at ${h.email} within 24-48 hours to set up your player profile and get you started in the BCAPL singles division!

In the meantime, you can also reach us directly at: frbcapl@gmail.com`),p({firstName:"",lastName:"",email:"",phone:"",experience:"beginner",fargoRate:"",currentLeague:"",currentRanking:"",message:""}),u(!1)}catch{alert("There was an error submitting your application. Please try again or contact us directly at frbcapl@gmail.com")}finally{f(!1)}},x={onScheduleMatch:()=>{alert(` Schedule Match

This feature is available to members only.

Contact frbcapl@gmail.com to join and start scheduling matches!`)},onOpenChat:()=>{alert(` Chat System

This feature is available to members only.

Contact frbcapl@gmail.com to join and start chatting with opponents!`)},onLogout:()=>{n("/")},onGoToAdmin:()=>{alert(` Admin Access

Admin features are only available to approved administrators.

Contact frbcapl@gmail.com for admin access requests.`)},onGoToPlatformAdmin:()=>{alert(` Platform Admin

Platform admin features are only available to super administrators.

Contact frbcapl@gmail.com for platform admin access requests.`)},onOpenOpponentsModal:()=>{alert(` Opponents Modal

This feature is available to members only.

Contact frbcapl@gmail.com to join and view your opponents!`)},onOpenCompletedMatchesModal:()=>{alert(` Completed Matches

This feature is available to members only.

Contact frbcapl@gmail.com to join and view your completed matches!`)},onOpenStandingsModal:()=>{alert(` Standings

This feature is available to members only.

Contact frbcapl@gmail.com to join and view the standings!`)},onOpenAllMatchesModal:()=>{alert(` All Matches

This feature is available to members only.

Contact frbcapl@gmail.com to join and view all matches!`)},onOpenProposalListModal:()=>{alert(` Proposals

This feature is available to members only.

Contact frbcapl@gmail.com to join and view your proposals!`)},onOpenSentProposalListModal:()=>{alert(` Sent Proposals

This feature is available to members only.

Contact frbcapl@gmail.com to join and view your sent proposals!`)},onMatchClick:()=>{alert(` Match Details

This feature is available to members only.

Contact frbcapl@gmail.com to join and view match details!`)},onOpenMessageCenter:()=>{alert(` Message Center

This feature is available to members only.

Contact frbcapl@gmail.com to join and access the message center!`)},onSmartMatchClick:()=>{alert(` Smart Match

This feature is available to members only.

Contact frbcapl@gmail.com to join and use smart matchmaking!`)},onOpenCalendar:()=>{alert(` Calendar

This feature is available to members only.

Contact frbcapl@gmail.com to join and access the calendar!`)}};return o?e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" League App - Guest Preview"}),e.jsx("p",{children:"Loading guest access..."}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"})]}),e.jsx("div",{className:"loading-spinner",children:"Authenticating guest user..."})]}):l?e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" League App - Guest Preview"}),e.jsx("p",{children:"Error loading guest access"}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"})]}),e.jsxs("div",{className:"error-message",children:[e.jsxs("p",{children:["Error: ",l]}),e.jsx("button",{onClick:v,className:"back-btn",children:" Back to Hub"})]})]}):e.jsxs("div",{className:"guest-app-container",children:[e.jsxs("div",{className:"guest-app-header",children:[e.jsx("h1",{children:" League App - Guest Preview"}),e.jsx("p",{children:"Experience the actual League App interface with limited functionality"}),e.jsx("div",{className:"guest-badge",children:" Guest Mode - Limited Access"}),e.jsxs("div",{className:"guest-actions",children:[e.jsx("button",{onClick:v,className:"back-btn",children:" Back to Hub"}),e.jsx("button",{onClick:b,className:"join-btn",children:"Join League"})]})]}),e.jsxs("div",{className:"view-tabs",children:[e.jsx("button",{className:`tab-btn ${t==="info"?"active":""}`,onClick:()=>r("info"),children:" League Info"}),e.jsx("button",{className:`tab-btn ${t==="app"?"active":""}`,onClick:()=>r("app"),children:" Try App Interface"})]}),e.jsxs("div",{className:"content-area",children:[t==="app"&&e.jsxs("div",{className:"app-preview-section",children:[e.jsxs("div",{className:"guest-notice",children:[e.jsx("h3",{children:" Interactive App Preview"}),e.jsx("p",{children:"You can explore the actual League App interface below. Try clicking buttons and opening modals to see how it works!"}),e.jsxs("div",{className:"guest-limitations",style:{textAlign:"center"},children:[e.jsx("strong",{children:"Guest Limitations:"}),e.jsxs("ul",{style:{textAlign:"left",display:"inline-block",margin:"0.5rem auto"},children:[e.jsx("li",{children:" Can view all interfaces and modals"}),e.jsx("li",{children:" Cannot submit forms or save data"}),e.jsx("li",{children:" Cannot access chat or messaging"}),e.jsx("li",{children:" Cannot schedule real matches"}),e.jsx("li",{children:" Cannot access admin features"})]})]})]}),e.jsxs("div",{className:"dashboard-preview",children:[(()=>(console.log(" Guest App Debug - Dashboard Props:",{effectivePhase:"scheduled",hasSeasonData:!0,completedMatches:[{_id:"guest-match-1",player1Id:"Guest User",player2Id:"John Smith",winner:"Guest User",score:"5-3",matchDate:new Date(Date.now()-7*24*60*60*1e3),status:"completed"},{_id:"guest-match-2",player1Id:"Guest User",player2Id:"Jane Doe",winner:"Jane Doe",score:"3-5",matchDate:new Date(Date.now()-14*24*60*60*1e3),status:"completed"}],totalRequiredMatches:6,pendingCount:2,sentCount:1}),null))(),e.jsx(HC,{playerName:(s==null?void 0:s.firstName)||"Guest",playerLastName:(s==null?void 0:s.lastName)||"User",senderEmail:(s==null?void 0:s.email)||"guest@frontrangepool.com",onScheduleMatch:x.onScheduleMatch,onOpenChat:x.onOpenChat,onLogout:x.onLogout,userPin:(s==null?void 0:s.pin)||"GUEST",onGoToAdmin:x.onGoToAdmin,onGoToPlatformAdmin:x.onGoToPlatformAdmin,effectivePhase:"scheduled",seasonData:{_id:"guest-season-1",name:"BCAPL Singles Division - Guest Preview",division:"FRBCAPL TEST",startDate:new Date,endDate:new Date(Date.now()+60*24*60*60*1e3),phase1EndDate:new Date(Date.now()+42*24*60*60*1e3),totalWeeks:10,currentWeek:3,isActive:!0},completedMatches:[{_id:"guest-match-1",player1Id:"Guest User",player2Id:"John Smith",winner:"Guest User",score:"5-3",matchDate:new Date(Date.now()-7*24*60*60*1e3),status:"completed"},{_id:"guest-match-2",player1Id:"Guest User",player2Id:"Jane Doe",winner:"Jane Doe",score:"3-5",matchDate:new Date(Date.now()-14*24*60*60*1e3),status:"completed"}],totalRequiredMatches:6,selectedDivision:"FRBCAPL TEST",pendingCount:2,sentCount:1,upcomingMatches:[{_id:"guest-upcoming-1",player1Id:"Guest User",player2Id:"Mike Johnson",proposedDate:new Date(Date.now()+7*24*60*60*1e3),status:"pending"}],allPlayers:[{firstName:"Guest",lastName:"User",email:"guest@frontrangepool.com"},{firstName:"John",lastName:"Smith",email:"john@example.com"},{firstName:"Jane",lastName:"Doe",email:"jane@example.com"},{firstName:"Mike",lastName:"Johnson",email:"mike@example.com"}],standings:[{rank:1,playerName:"John Smith",points:120,matchesPlayed:6},{rank:2,playerName:"Jane Doe",points:110,matchesPlayed:6},{rank:3,playerName:"Guest User",points:100,matchesPlayed:6},{rank:4,playerName:"Mike Johnson",points:90,matchesPlayed:6}],onOpenOpponentsModal:x.onOpenOpponentsModal,onOpenCompletedMatchesModal:x.onOpenCompletedMatchesModal,onOpenStandingsModal:x.onOpenStandingsModal,onOpenAllMatchesModal:x.onOpenAllMatchesModal,onOpenProposalListModal:x.onOpenProposalListModal,onOpenSentProposalListModal:x.onOpenSentProposalListModal,onMatchClick:x.onMatchClick,onOpenMessageCenter:x.onOpenMessageCenter,onSmartMatchClick:x.onSmartMatchClick,onOpenCalendar:x.onOpenCalendar})]})]}),t==="info"&&e.jsxs("div",{className:"info-section",children:[e.jsx("h2",{children:"League Information"}),e.jsxs("div",{className:"info-cards",children:[e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" League Structure"}),e.jsx("p",{children:"BCAPL Singles Division - Hybrid Format"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Maximum 30 players per session"}),e.jsx("li",{children:"10-week sessions with two phases"}),e.jsxs("li",{children:["Phase 1 - Weeks 1-6: ",e.jsx("br",{}),"Scheduled opponents (6 matches)"]}),e.jsxs("li",{children:["Phase 2 - Weeks 7-10: ",e.jsx("br",{}),"Challenge matches (2-4 matches)"]}),e.jsx("li",{children:"FargoRate integrated rankings"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Match System"}),e.jsx("p",{children:"Flexible scheduling with two distinct phases"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Phase 1: 6 assigned opponents (any time, any location)"}),e.jsx("li",{children:"Phase 2: Challenge matches (up to 4 spots higher)"}),e.jsx("li",{children:"Race to 5 games per match"}),e.jsx("li",{children:"10 points per game won + 10 bonus for match winner"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Communication"}),e.jsx("p",{children:"Official scheduling hub and coordination system"}),e.jsxs("ul",{children:[e.jsx("li",{children:"League website: https://frusapl.com"}),e.jsx("li",{children:"Scheduling Hub for match coordination"}),e.jsx("li",{children:"Direct messaging between players"}),e.jsx("li",{children:"League chat room for announcements"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Statistics & Rankings"}),e.jsx("p",{children:"FargoRate integrated scoring and tracking"}),e.jsxs("ul",{children:[e.jsx("li",{children:"BCAPL scoring app for all matches"}),e.jsx("li",{children:"FargoRate standings and statistics"}),e.jsx("li",{children:"Total points determine final rankings"}),e.jsx("li",{children:"Handicapping based on FargoRate difference"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Fee Structure"}),e.jsx("p",{children:"Transparent pricing for BCAPL singles division"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Registration: $30 per player per division"}),e.jsx("li",{children:"Weekly dues: $10 per week"}),e.jsx("li",{children:"Sessions: 10 weeks long"}),e.jsx("li",{children:"Maximum: 30 players per division"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:" Prize Payouts"}),e.jsx("p",{children:"Estimated payouts for BCAPL singles division based on 30 players"}),e.jsx("h4",{style:{marginTop:"0.5rem",color:"#4CAF50",fontSize:"1rem"},children:" Main Payouts"}),e.jsxs("ul",{children:[e.jsx("li",{children:"1st Place: $600"}),e.jsx("li",{children:"2nd Place: $500"}),e.jsx("li",{children:"3rd Place: $400"}),e.jsx("li",{children:"4th Place: $300"})]}),e.jsx("h4",{style:{marginTop:"0.5rem",color:"#4CAF50",fontSize:"1rem"},children:" Special Awards ($100 each)"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Most Challenge Positions Gained (most spots climbed during challenge phase)"}),e.jsx("li",{children:"Biggest FargoRate Increase (min. 200+ robustness at end)"}),e.jsx("li",{children:"Sportsmanship Award (by player vote)"}),e.jsx("li",{children:"Random Drawing for Full Participation (all 10 matches completed)"}),e.jsx("li",{children:"Random Drawing for Full Pre-payment (paid in full before week 2)"})]}),e.jsxs("p",{style:{marginTop:"1rem",fontSize:"0.85rem",color:"#ccc",fontStyle:"italic",borderTop:"1px solid rgba(255, 255, 255, 0.2)",paddingTop:"0.5rem"},children:[e.jsx("strong",{children:"Note:"})," Places paid, amounts, and special prizes subject to change based on number of players in division."]})]})]}),e.jsxs("div",{className:"join-section",children:[e.jsx("h3",{children:"Ready to Join?"}),e.jsx("p",{children:"Become a member to access all features and start competing!"}),e.jsx("button",{onClick:b,className:"join-btn-large",children:" Join the League Today"}),e.jsxs("p",{className:"contact-info",children:["Contact: ",e.jsx("strong",{children:"frbcapl@gmail.com"})]})]})]})]}),d&&e.jsxs(It,{open:d,onClose:()=>u(!1),title:" Join Front Range Pool League - BCAPL Singles Division",maxWidth:"700px",children:[e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"First Name *"}),e.jsx("input",{type:"text",id:"firstName",value:h.firstName,onChange:j=>p({...h,firstName:j.target.value}),required:!0,placeholder:"Enter your first name",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Last Name *"}),e.jsx("input",{type:"text",id:"lastName",value:h.lastName,onChange:j=>p({...h,lastName:j.target.value}),required:!0,placeholder:"Enter your last name",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Email Address *"}),e.jsx("input",{type:"email",id:"email",value:h.email,onChange:j=>p({...h,email:j.target.value}),required:!0,placeholder:"Enter your email address",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",value:h.phone,onChange:j=>p({...h,phone:j.target.value}),placeholder:"Enter your phone number (optional)",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fargoRate",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Fargo Rate, if applicable"}),e.jsx("input",{type:"number",id:"fargoRate",value:h.fargoRate,onChange:j=>p({...h,fargoRate:j.target.value}),min:"0",max:"850",placeholder:"Enter your Fargo rate (optional)",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"experience",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Experience Level"}),e.jsxs("select",{id:"experience",value:h.experience,onChange:j=>p({...h,experience:j.target.value}),style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"},children:[e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"}),e.jsx("option",{value:"expert",children:"Expert"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentLeague",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Current League (Optional)"}),e.jsx("input",{type:"text",id:"currentLeague",value:h.currentLeague,onChange:j=>p({...h,currentLeague:j.target.value}),placeholder:"e.g., APA, BCA, Local League",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentRanking",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Current Ranking (Optional)"}),e.jsx("input",{type:"text",id:"currentRanking",value:h.currentRanking,onChange:j=>p({...h,currentRanking:j.target.value}),placeholder:"e.g., 5, 6, 7, 8, 9",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("label",{htmlFor:"message",style:{display:"block",color:"#fff",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:"Additional Message (Optional)"}),e.jsx("textarea",{id:"message",value:h.message,onChange:j=>p({...h,message:j.target.value}),placeholder:"Tell us about your pool experience, goals, or any questions you have...",style:{width:"100%",padding:"0.8rem",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"1rem",minHeight:"60px",maxHeight:"80px",resize:"vertical",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.5rem"},children:[e.jsx("button",{type:"button",onClick:()=>u(!1),disabled:g,style:{flex:1,padding:"0.8rem 1.2rem",background:"transparent",color:"#ccc",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,style:{flex:1,padding:"0.8rem 1.2rem",background:"linear-gradient(45deg, #4CAF50, #45a049)",color:"white",border:"2px solid #4CAF50",borderRadius:"8px",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},children:g?"Submitting...":" Join BCAPL Singles Division"})]})]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"0.6rem",marginTop:"0.5rem"},children:[e.jsx("h3",{style:{color:"#4CAF50",margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"bold"},children:" What to Expect"}),e.jsxs("ul",{style:{margin:"0",paddingLeft:"1rem",color:"#ccc",fontSize:"0.9rem",lineHeight:"1.3"},children:[e.jsx("li",{children:"We'll review your application and contact you as soon as possible"}),e.jsx("li",{children:"After registration fee is received, you'll be placed in an appropriate BCAPL singles division based on division availability"}),e.jsx("li",{children:"Start competing in regular season matches and BCAPL tournaments"}),e.jsx("li",{children:"Track your standings and statistics throughout the BCAPL season"})]})]})]})]})};const ire=()=>{const n=yn(),[t]=sb(),[r,s]=y.useState(!0),[a,o]=y.useState(null),[i,l]=y.useState(null);y.useEffect(()=>{c()},[]);const c=async()=>{try{const h=t.get("email"),p=t.get("type"),g=t.get("claimData");if(!h||!p||!g){l("Missing payment information. Please contact support."),s(!1);return}const f=JSON.parse(decodeURIComponent(g));console.log(" Verifying payment for:",h),console.log(" Claim data:",f);const m=await fetch(`${ik}/api/monetization/check-payment-status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,claimData:f})});if(m.ok){const v=await m.json();console.log(" Payment verification result:",v),v.success&&v.paymentStatus==="completed"?o({success:!0,message:` Payment successful! Your claim for Position #${f.position} in the ${f.ladder} ladder has been approved.`,claimData:v.claimData}):l("Payment verification failed. Please contact support.")}else l("Failed to verify payment. Please contact support.")}catch(h){console.error("Error verifying payment:",h),l("An error occurred while verifying payment. Please contact support.")}finally{s(!1)}},d=()=>{n("/guest/ladder?paymentSuccess=true")},u=()=>{window.location.href="mailto:frbcapl@gmail.com?subject=Payment Verification Issue"};return r?e.jsx("div",{className:"payment-success-container",children:e.jsxs("div",{className:"verification-section",children:[e.jsx("div",{className:"loading-spinner",children:""}),e.jsx("h2",{children:"Verifying Payment..."}),e.jsx("p",{children:"Please wait while we verify your payment with Square."})]})}):i?e.jsx("div",{className:"payment-success-container",children:e.jsxs("div",{className:"error-section",children:[e.jsx("div",{className:"error-icon",children:""}),e.jsx("h2",{children:"Payment Verification Failed"}),e.jsx("p",{className:"error-message",children:i}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:d,className:"return-btn",children:" Return to Ladder"}),e.jsx("button",{onClick:u,className:"contact-btn",children:" Contact Support"})]})]})}):a!=null&&a.success?e.jsx("div",{className:"payment-success-container",children:e.jsxs("div",{className:"success-section",children:[e.jsx("div",{className:"success-icon",children:""}),e.jsx("h2",{children:"Payment Successful!"}),e.jsxs("div",{className:"success-message",children:[e.jsx("p",{children:a.message}),e.jsxs("div",{className:"claim-details",children:[e.jsx("h3",{children:"Claim Details:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Position:"})," #",a.claimData.position]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ladder:"})," ",a.claimData.ladder]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email:"})," ",a.claimData.email]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Player:"})," ",a.claimData.playerName]})]})]}),e.jsxs("div",{className:"next-steps",children:[e.jsx("h3",{children:"Next Steps:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Your claim has been approved and recorded"}),e.jsx("li",{children:"You now have access to all ladder features"}),e.jsx("li",{children:"You can start challenging other players"}),e.jsx("li",{children:"Your membership will be automatically renewed monthly"})]})]})]}),e.jsx("div",{className:"action-buttons",children:e.jsx("button",{onClick:d,className:"return-btn",children:" Return to Ladder"})})]})}):e.jsx("div",{className:"payment-success-container",children:e.jsxs("div",{className:"unknown-section",children:[e.jsx("div",{className:"unknown-icon",children:""}),e.jsx("h2",{children:"Payment Status Unknown"}),e.jsx("p",{children:"We couldn't determine the status of your payment. Please contact support."}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:d,className:"return-btn",children:" Return to Ladder"}),e.jsx("button",{onClick:u,className:"contact-btn",children:" Contact Support"})]})]})})},lre=()=>{const[n,t]=y.useState(""),[r,s]=y.useState(""),[a,o]=y.useState(!1),[i,l]=y.useState(""),[c,d]=y.useState(""),[u,h]=y.useState(!1),p=yn();y.useEffect(()=>{(async()=>{try{const m=window.location.hash;console.log("Full URL hash:",m);const v=new URLSearchParams(m.split("#").pop()),b=v.get("access_token"),w=v.get("refresh_token"),x=v.get("type");if(console.log("Access token:",b?"Found":"Not found"),console.log("Refresh token:",w?"Found":"Not found"),console.log("Type:",x),!b||x!=="recovery"){console.error("Invalid password reset link - missing tokens or wrong type"),d("Invalid or expired reset link. Please request a new password reset email.");return}const{data:j,error:S}=await xe.auth.setSession({access_token:b,refresh_token:w});if(S){console.error("Error setting session:",S),d("Invalid or expired reset link. Please request a new password reset email.");return}j.session?(console.log(" Valid password reset session created for:",j.session.user.email),h(!0)):(console.error("No session created"),d("Failed to create reset session. Please try again."))}catch(m){console.error("Error handling password reset:",m),d("Error validating reset link. Please try again.")}})()},[]);const g=async f=>{if(f.preventDefault(),d(""),l(""),!n||!r){d("Please fill in all fields");return}if(n.length<6){d("Password must be at least 6 characters long");return}if(n!==r){d("Passwords do not match");return}o(!0);try{const{error:m}=await xe.auth.updateUser({password:n});if(m)throw m;l(" Password updated successfully! Redirecting to login..."),setTimeout(async()=>{await xe.auth.signOut(),p("/",{replace:!0})},2e3)}catch(m){console.error("Password reset error:",m),d(m.message||"Failed to reset password. Please try again or request a new reset link.")}finally{o(!1)}};return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",padding:"40px",maxWidth:"450px",width:"100%"},children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"10px",color:"#333",textAlign:"center"},children:"Reset Your Password"}),e.jsx("p",{style:{color:"#666",marginBottom:"30px",textAlign:"center"},children:"Enter your new password below"}),c&&e.jsx("div",{style:{background:"#fee",border:"1px solid #fcc",color:"#c33",padding:"12px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px"},children:c}),i&&e.jsx("div",{style:{background:"#efe",border:"1px solid #cfc",color:"#3c3",padding:"12px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px"},children:i}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#333"},children:"New Password"}),e.jsx("input",{type:"password",value:n,onChange:f=>t(f.target.value),disabled:a||!u,placeholder:"Enter new password",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#333"},children:"Confirm Password"}),e.jsx("input",{type:"password",value:r,onChange:f=>s(f.target.value),disabled:a||!u,placeholder:"Confirm new password",style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxSizing:"border-box"}})]}),e.jsx("button",{type:"submit",disabled:a||!u,style:{width:"100%",padding:"14px",background:a||!u?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"bold",cursor:a||!u?"not-allowed":"pointer",marginBottom:"15px"},children:a?"Updating Password...":"Reset Password"}),e.jsx("button",{type:"button",onClick:()=>p("/"),style:{width:"100%",padding:"12px",background:"transparent",color:"#667eea",border:"1px solid #667eea",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:"Back to Home"})]})]})})},cre=()=>{const[n,t]=y.useState(!0),[r,s]=y.useState(""),[a,o]=y.useState(""),i=yn();return y.useEffect(()=>{(async()=>{try{const c=new URLSearchParams(window.location.hash.substring(1)),d=c.get("access_token"),u=c.get("refresh_token"),h=c.get("type");if(console.log("Email confirmation - Type:",h),console.log("Email confirmation - Has tokens:",!!d),h==="signup"&&d&&u){const{data:p,error:g}=await xe.auth.setSession({access_token:d,refresh_token:u});if(g)throw g;if(p.session&&p.user)console.log(" Email confirmed for:",p.user.email),s(" Email confirmed successfully! Your account is now pending admin approval. You'll receive a password setup email once approved."),await xe.auth.signOut(),setTimeout(()=>{i("/",{replace:!0})},5e3);else throw new Error("Failed to confirm email")}else o("Invalid or expired confirmation link. If you've already confirmed your email, you can close this page. Your account is pending admin approval.")}catch(c){console.error("Email confirmation error:",c),o(c.message||"Failed to confirm email. Please try again or contact support.")}finally{t(!1)}})()},[i]),e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",padding:"40px",maxWidth:"500px",width:"100%",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"20px"},children:n?"":a?"":""}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"20px",color:"#333"},children:n?"Confirming Your Email...":a?"Confirmation Error":"Email Confirmed!"}),n&&e.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:"Please wait while we confirm your email address..."}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{background:"#fee",border:"1px solid #fcc",color:"#c33",padding:"15px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",textAlign:"left"},children:a}),e.jsxs("div",{style:{background:"#f8f9fa",border:"1px solid #dee2e6",padding:"15px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",textAlign:"left"},children:[e.jsx("strong",{children:"What to do next:"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0},children:[e.jsx("li",{children:"If you've already confirmed your email, you can close this page"}),e.jsx("li",{children:"Your account is pending admin approval"}),e.jsx("li",{children:"You'll receive a password setup email once approved"}),e.jsx("li",{children:"If you need help, contact the administrator"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{background:"#efe",border:"1px solid #cfc",color:"#3c3",padding:"15px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px"},children:r}),e.jsxs("div",{style:{background:"#f8f9fa",border:"1px solid #dee2e6",padding:"15px",borderRadius:"6px",marginBottom:"20px",fontSize:"14px",textAlign:"left"},children:[e.jsx("strong",{children:"What happens next:"}),e.jsxs("ol",{style:{margin:"10px 0 0 20px",padding:0},children:[e.jsx("li",{children:" Your email is confirmed"}),e.jsx("li",{children:" Admin will review and approve your account (usually within 24 hours)"}),e.jsx("li",{children:" You'll receive a password setup email once approved"}),e.jsx("li",{children:" Set your password and log in!"})]})]}),e.jsx("p",{style:{color:"#666",fontSize:"14px",marginTop:"20px"},children:"Redirecting to home page in 5 seconds..."})]}),e.jsx("button",{type:"button",onClick:()=>i("/"),style:{width:"100%",padding:"12px",background:"transparent",color:"#667eea",border:"1px solid #667eea",borderRadius:"6px",fontSize:"14px",cursor:"pointer",marginTop:"20px"},children:"Go to Home Page"})]})})},dre=({onSuccess:n})=>{const[t,r]=y.useState(!0),[s,a]=y.useState(""),[o,i]=y.useState(!1),[l,c]=y.useState(!1),d=yn();return y.useEffect(()=>{const u=localStorage.getItem("__DUES_TRACKER_OAUTH__")==="true",h=window.location.pathname==="/auth/callback"||window.location.pathname==="/#/auth/callback",p=window.location.hash&&(window.location.hash.includes("access_token")||window.location.hash.includes("type=recovery"));if(u||h&&p&&!localStorage.getItem("supabaseAuth")){console.log(" OAuth callback is for Dues Tracker - IMMEDIATELY redirecting (before any processing)"),console.log(" Current pathname:",window.location.pathname),console.log(" Current hash:",window.location.hash),console.log(" Flag set:",u),localStorage.removeItem("__DUES_TRACKER_OAUTH__");const m=window.location.hash||"",v=window.location.origin+"/dues-tracker/index.html"+m;console.log(" Redirecting to:",v),window.location.replace(v);return}let g=!1;return(async()=>{var m,v;if(g){console.log(" OAuth callback already processing, skipping...");return}g=!0;try{console.log(" Handling OAuth callback..."),console.log(" Current pathname:",window.location.pathname),console.log(" Current hash:",window.location.hash);const b=localStorage.getItem("pendingClaim"),w=b?JSON.parse(b):null,x=localStorage.getItem("pendingOAuthSignup"),j=x?JSON.parse(x):null,S=await sy.handleOAuthCallback();if(S.requiresApproval&&S.user){r(!1),i(!1),a(""),c(!0),setTimeout(()=>{d("/",{replace:!0,state:{signupSuccess:!0,message:S.message}})},5e3);return}if(S.success){if(window.opener){try{window.opener.postMessage({type:"OAUTH_COMPLETE"},window.location.origin)}catch(_){console.warn("postMessage to opener failed",_)}r(!1),i(!0),setTimeout(()=>window.close(),2e3);return}if(console.log(" OAuth authentication successful"),console.log(" OAuth result details:",{success:S.success,requiresApproval:S.requiresApproval,isNewUser:S.isNewUser,hasUser:!!S.user,userType:S.userType,userEmail:(m=S.user)==null?void 0:m.email}),w&&w.isClaiming){console.log(" Processing position claim via OAuth...");try{const C=await(await _a(()=>Promise.resolve().then(()=>D2),void 0)).default.claimLadderPositionWithOAuth({firstName:w.firstName,lastName:w.lastName,email:S.user.email,phone:w.phone||"",message:w.message||"",userId:S.user.id});if(localStorage.removeItem("pendingClaim"),C.success){setMessage(" Position claimed successfully! Redirecting..."),setTimeout(()=>{n?n(`${S.user.first_name} ${S.user.last_name}`.trim(),S.user.email,"oauth",S.userType,"",S.user):d("/hub")},2e3);return}else throw new Error(C.error||"Failed to claim position")}catch(_){console.error(" Claim error:",_),localStorage.removeItem("pendingClaim"),a(_.message||"Failed to claim position. Please try again."),setTimeout(()=>{d("/")},3e3);return}}if(j&&j.isNewSignup){console.log(" Processing new player signup via OAuth...");try{const _=(await _a(()=>Promise.resolve().then(()=>D2),void 0)).default,{supabase:C}=await _a(()=>Promise.resolve().then(()=>eee),void 0),{data:N}=await C.from("ladder_profiles").select("*").eq("user_id",S.user.id).single();if(!N){const{error:M}=await C.from("ladder_profiles").insert({user_id:S.user.id,ladder_name:j.ladderName||"499-under",position:999,fargo_rate:parseInt(j.fargoRate)||400,is_active:!1});M?console.error(" Error creating ladder profile:",M):console.log(" Ladder profile created for new OAuth user")}localStorage.removeItem("pendingOAuthSignup")}catch(_){console.error(" Signup error:",_),localStorage.removeItem("pendingOAuthSignup")}}if(console.log(" User is approved - proceeding with login"),n){const _=S.user.first_name||((v=S.user.email)==null?void 0:v.split("@")[0])||"User",C=S.user.last_name||"",N=`${_} ${C}`.trim()||_;console.log(" OAuth login success, calling onSuccess with:",{name:N,email:S.user.email,firstName:_,lastName:C,userType:S.userType,userData:S.user});const M=S.userType||"user";let E="";try{const{data:{session:P}}=await xe.auth.getSession();P!=null&&P.access_token&&(E=P.access_token)}catch(P){console.log("Could not get session token:",P)}console.log(" Calling onSuccess with complete data:",{fullName:N,email:S.user.email,userType:M,hasToken:!!E,userDataKeys:Object.keys(S.user||{})}),n(N,S.user.email,"",M,E,S.user),console.log(" OAuth login complete - user should be authenticated"),r(!1),i(!0),setTimeout(()=>{d("/hub",{replace:!0})},2e3)}else d("/hub")}else console.error(" OAuth callback failed:",S.message),localStorage.removeItem("pendingClaim"),a(S.message||"Authentication failed. Please try again."),setTimeout(()=>{d("/")},3e3)}catch(b){console.error(" OAuth callback error:",b),localStorage.removeItem("pendingClaim"),a("An error occurred during authentication. Please try again."),setTimeout(()=>{d("/")},3e3)}finally{r(!1),g=!1}})(),()=>{g=!1}},[d,n]),e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:e.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.2)",padding:"40px",maxWidth:"500px",width:"100%",textAlign:"center"},children:t?e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#333"},children:"Authenticating..."}),e.jsx("p",{style:{color:"#666"},children:"Please wait while we complete your sign in..."}),e.jsx("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center"},children:e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),e.jsx("style",{children:`
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            `})]}):o?e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#28a745"},children:" Login Successful!"}),e.jsx("p",{style:{color:"#666",marginBottom:"10px"},children:"Welcome back! You've been successfully logged in with Google."}),e.jsx("p",{style:{color:"#666",fontSize:"0.9rem"},children:"Redirecting you to the hub..."}),e.jsx("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center"},children:e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #28a745",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}):l?e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#28a745"},children:" Account Created!"}),e.jsx("p",{style:{color:"#666",marginBottom:"16px",lineHeight:1.5},children:"Your account has been created successfully."}),e.jsx("p",{style:{color:"#333",fontWeight:"bold",marginBottom:"12px"},children:" Next steps:"}),e.jsxs("p",{style:{color:"#666",marginBottom:"16px",fontSize:"0.95rem",lineHeight:1.6,textAlign:"left"},children:["1. An admin will review your application (usually within 24 hours)",e.jsx("br",{}),"2. You'll receive an approval email when you're approved",e.jsx("br",{}),"3. Log in with Google again to access the ladder"]}),e.jsx("p",{style:{color:"#888",fontSize:"0.9rem"},children:"Redirecting you to the home page..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#dc3545"},children:"Authentication Failed"}),e.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:s}),e.jsx("button",{onClick:()=>d("/"),style:{padding:"12px 24px",background:"#667eea",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Go to Login"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#333"},children:"Account Created!"}),e.jsx("p",{style:{color:"#666",marginBottom:"10px"},children:"Your account has been created successfully."}),e.jsx("p",{style:{color:"#ff9800",fontWeight:"bold",marginBottom:"20px"},children:" Your account is pending admin approval."}),e.jsx("p",{style:{color:"#666",fontSize:"0.9rem"},children:"You will be redirected to the login page shortly..."})]})})})};(function(){const t=localStorage.getItem("__DUES_TRACKER_OAUTH__")==="true",r=window.location.pathname,s=window.location.hash,a=r.includes("access_token=")||r.includes("type=recovery"),o=s&&(s.includes("access_token")||s.includes("type=recovery"));if(t&&(a||o)){console.log(" Dues Tracker OAuth detected in App.jsx - IMMEDIATELY redirecting"),console.log(" Pathname:",r),console.log(" Hash:",s),localStorage.removeItem("__DUES_TRACKER_OAUTH__");let i=s;if(a&&!o){const c=r.match(/(access_token=[^&]+.*)/);c&&(i="#"+c[1])}const l=window.location.origin+"/dues-tracker/index.html"+i;console.log(" Redirecting to:",l),window.location.replace(l)}})();function ure({isAuthenticated:n,userFirstName:t,userLastName:r,userEmail:s,userPin:a,userType:o,handleLoginSuccess:i,handleLogout:l}){return yn(),e.jsx("main",{className:"main-app-content",children:n?e.jsx(OJ,{isAuthenticated:n,userFirstName:t,userLastName:r,userEmail:s,userPin:a,userType:o,handleLogout:l}):e.jsx(yX,{onLoginSuccess:i})})}function hre(){var R,U;const n=qi();y.useLayoutEffect(()=>{const z=window.location.search||"",$=window.location.hash||"",W=window.location.pathname||"",Y=new URLSearchParams(z||($.includes("?")?$.slice($.indexOf("?")):"")),Q=W.match(/transactionId=([^&/]+)/i)||W.match(/transaction_id=([^&/]+)/i)||W.match(/orderId=([^&/]+)/i),H=Q?Q[1]:null,ue=Y.get("transactionId")||Y.get("transaction_id")||H,J=Y.get("credit_purchase_success")==="1"||$.includes("credit_purchase_success=1"),be=Y.get("membership_purchase_success")==="1"||$.includes("membership_purchase_success=1"),Ae=ue||W.includes("transactionId=")||W.includes("orderId=");if(J){try{sessionStorage.setItem("credit_purchase_return","1")}catch{}const O="#/ladder?tab=payment-dashboard&credit_purchase_success=1"+(ue?"&transactionId="+encodeURIComponent(ue):"");$.startsWith("#/ladder")||(W!=="/"&&W!==""&&window.history.replaceState(null,"","/"+z+$),window.location.hash=O)}else if(be){try{sessionStorage.setItem("credit_purchase_return","1")}catch{}const O="#/ladder?tab=payment-dashboard&membership_purchase_success=1"+(ue?"&transactionId="+encodeURIComponent(ue):"");$.startsWith("#/ladder")||(W!=="/"&&W!==""&&window.history.replaceState(null,"","/"+z+$),window.location.hash=O)}else if(Ae&&!$.startsWith("#/ladder")){try{sessionStorage.setItem("credit_purchase_return","1")}catch{}const O="#/ladder?tab=payment-dashboard&membership_purchase_success=1"+(ue?"&transactionId="+encodeURIComponent(ue):"");W!=="/"&&W!==""&&window.history.replaceState(null,"","/"+(window.location.search||"")+$),window.location.hash=O}},[]);const[t,r]=y.useState(!1),[s,a]=y.useState(""),[o,i]=y.useState(""),[l,c]=y.useState(""),[d,u]=y.useState(""),[h,p]=y.useState(""),[g,f]=y.useState("league"),[m,v]=y.useState("");y.useState(!0),y.useEffect(()=>{localStorage.getItem("isAuthenticated")==="true"&&(a(localStorage.getItem("userFirstName")||""),i(localStorage.getItem("userLastName")||""),c(localStorage.getItem("userEmail")||""),u(localStorage.getItem("userPin")||""),p(localStorage.getItem("userToken")||""),f(localStorage.getItem("userType")||"league"),r(!0))},[]),y.useEffect(()=>{const z=$=>{var W;((W=$.data)==null?void 0:W.type)==="OAUTH_COMPLETE"&&$.origin===window.location.origin&&window.location.reload()};return window.addEventListener("message",z),()=>window.removeEventListener("message",z)},[]),y.useEffect(()=>{const z=W=>{v(W.detail)},$=W=>{console.log("App.jsx received ladderLoginSuccess event:",W.detail);const{name:Y,email:Q,pin:H,userType:ue}=W.detail;b(Y,Q,H,ue)};return window.addEventListener("appNameChange",z),window.addEventListener("ladderLoginSuccess",$),()=>{window.removeEventListener("appNameChange",z),window.removeEventListener("ladderLoginSuccess",$)}},[]);const b=(z,$,W,Y,Q,H=null)=>{console.log(" handleLoginSuccess called with:",{name:z,email:$,pin:W?"***":"none",userType:Y,hasToken:!!Q,hasUserData:!!H,userDataKeys:H?Object.keys(H):[]});let ue="",J="";if(z){const be=z.trim().split(" ");ue=be[0],J=be.slice(1).join(" ")}H&&(H.first_name&&(ue=H.first_name),H.last_name&&(J=H.last_name)),a(ue),i(J),c($),u(W||""),p(Q||""),f(Y||"league"),r(!0),localStorage.setItem("userFirstName",ue),localStorage.setItem("userLastName",J),localStorage.setItem("userEmail",$),localStorage.setItem("userPin",W||""),localStorage.setItem("userToken",Q||""),localStorage.setItem("userType",Y||"league"),localStorage.setItem("isAuthenticated","true"),H&&localStorage.setItem("unifiedUserData",JSON.stringify(H)),console.log(" Unified Login Success - Data stored:",{firstName:ue,lastName:J,email:$,userType:Y,isAuthenticated:!0,localStorageCheck:localStorage.getItem("isAuthenticated")})},[w,x]=y.useState(!1),[j,S]=y.useState(!1),[_,C]=y.useState(!1),[N,M]=y.useState(!1),E=()=>w,P=()=>j;y.useEffect(()=>{(async()=>{if(t&&l){C(!0);try{const $=await Bi.isSuperAdmin(l,d||"supabase-auth");x($);const W=await Bi.isAdmin(l,d||"supabase-auth");S(W),console.log(" Admin Status Check:",{userEmail:l,userPin:d?"***":"supabase-auth",isSuperAdmin:$,isAdmin:W})}catch($){console.log(" Admin check failed:",$.message),x(!1),S(!1)}finally{C(!1)}}})()},[t,l,d]);const D=()=>{M(!0)},T=()=>{a(""),i(""),c(""),u(""),f("league"),v(""),r(!1),S(!1),x(!1),localStorage.removeItem("userFirstName"),localStorage.removeItem("userLastName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userPin"),localStorage.removeItem("userType"),localStorage.removeItem("isAuthenticated")},A=z=>{console.log("Claiming ladder position:",z)};if(n.pathname==="/ladder-embed")return e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#000",padding:0,margin:0,zIndex:9999,overflow:"auto"},children:e.jsx(Pte,{})});const k=n.pathname==="/"&&(((R=n.search)==null?void 0:R.includes("preview=1"))||((U=window.location.hash)==null?void 0:U.includes("preview=1")));return e.jsxs("div",{style:{position:"relative",minHeight:"100vh",width:"100%",overflowX:"hidden",background:"#000"},children:[(()=>{const z=n.pathname.startsWith("/ladder"),$=n.pathname==="/embed-preview";return!z&&!$&&e.jsx(vV,{})})(),e.jsx(bX,{currentAppName:m,isAdmin:k?!1:j,isSuperAdmin:k?!1:w,onLogout:T,userFirstName:k?"":s,userLastName:k?"":o,onProfileClick:D,hideBrand:n.pathname==="/embed-preview",hideNavButtons:n.pathname==="/embed-preview"}),e.jsx("div",{className:"main-content-wrapper",style:{position:"relative",zIndex:3,maxWidth:n.pathname==="/"?1400:n.pathname==="/embed-preview"?1e3:900,margin:"0 auto",width:"100%",background:"none",minHeight:"100vh",paddingTop:"80px"},children:e.jsxs(i_,{children:[e.jsx(Rr,{path:"/league",element:t?e.jsx(Os,{appName:"Front Range Pool League",children:e.jsx("main",{className:"main-app-content",children:e.jsx(HC,{playerName:s,playerLastName:o,senderEmail:l,onScheduleMatch:()=>{},onOpenChat:()=>window.location.hash="#/league/chat",userPin:d,onGoToAdmin:()=>{},onGoToPlatformAdmin:()=>navigate("/platform-admin"),isAdmin:j})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/league/chat",element:t?e.jsx(Os,{appName:"Front Range Pool League - Chat",children:e.jsx("main",{className:"main-app-content",children:e.jsx(SC,{userName:`${s} ${o}`,userEmail:l,userPin:d})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/ladder",element:t?e.jsx(Os,{appName:"Ladder of Legends",children:e.jsx("main",{className:"main-app-content",children:e.jsx(Yb,{playerName:s,playerLastName:o,senderEmail:l,userPin:d,isAdmin:j,userType:g,onClaimLadderPosition:A,setShowProfileModal:M})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/guest/league",element:e.jsx(Os,{appName:"League App - Guest Preview",children:e.jsx("main",{className:"main-app-content",children:e.jsx(ore,{})})})}),e.jsx(Rr,{path:"/guest/ladder",element:e.jsx(Os,{appName:"Ladder of Legends - Guest Preview",children:e.jsx("main",{className:"main-app-content guest-ladder-content",children:e.jsx(xX,{})})})}),e.jsx(Rr,{path:"/ladder/manage",element:t&&P()?e.jsx(Os,{appName:"Ladder of Legends Management",children:e.jsx("main",{className:"main-app-content",children:e.jsx(pee,{userEmail:l,userPin:d})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/ladder/admin",element:t&&P()?e.jsx(Os,{appName:"Ladder of Legends Player Management",children:e.jsx("main",{className:"main-app-content",children:e.jsx(Tte,{userToken:h})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/embed/*",element:e.jsx(Ete,{})}),e.jsx(Rr,{path:"/admin",element:t&&P()?e.jsx(Os,{appName:"Admin Dashboard",children:e.jsx("div",{className:"admin-app-content",children:e.jsx(pV,{userToken:h})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/dues-tracker",element:e.jsx(Os,{appName:"USA Pool League Dues Tracker",children:e.jsx("main",{className:"main-app-content",children:e.jsx(Kte,{})})})}),e.jsx(Rr,{path:"/admin/players",element:t&&P()?e.jsx(Os,{appName:"Player Management",children:e.jsx("div",{className:"admin-app-content",children:e.jsx(Vte,{})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/platform-admin",element:t&&E()?e.jsx(Os,{appName:"Platform Admin",children:e.jsx("div",{className:"platform-admin-app-content",children:e.jsx(mV,{})})}):e.jsx(no,{to:"/"})}),e.jsx(Rr,{path:"/confirm-match",element:e.jsx(SA,{})}),e.jsx(Rr,{path:"/payment-success",element:e.jsx(ire,{})}),e.jsx(Rr,{path:"/reset-password",element:e.jsx(lre,{})}),e.jsx(Rr,{path:"/confirm-email",element:e.jsx(cre,{})}),e.jsx(Rr,{path:"/auth/callback",element:e.jsx(dre,{onSuccess:b})}),e.jsx(Rr,{path:"/simple-pool",element:e.jsx(qx,{})}),e.jsx(Rr,{path:"/tenball-tutorial",element:e.jsx(IJ,{})}),e.jsx(Rr,{path:"/mobile-test",element:e.jsx(BJ,{})}),e.jsx(Rr,{path:"/cueless",element:e.jsx(lee,{})}),e.jsx(Rr,{path:"/legends-tracker",element:e.jsx(Os,{appName:"Legends Pool League Tracker",children:e.jsx("main",{className:"main-app-content",children:e.jsx(Jte,{})})})}),e.jsx(Rr,{path:"/tournament-bracket",element:t?e.jsx(Os,{appName:"Tournament Bracket",children:e.jsx("main",{className:"main-app-content",children:e.jsx(are,{})})}):e.jsx(no,{to:"/hub"})}),e.jsx(Rr,{path:"/hub",element:e.jsx(Os,{appName:t?"Front Range Pool Hub":"",children:e.jsx(ure,{isAuthenticated:t,userFirstName:s,userLastName:o,userEmail:l,userPin:d,userType:g,handleLoginSuccess:b,handleLogout:T})})}),e.jsx(Rr,{path:"/embed-preview",element:e.jsx(aee,{})}),e.jsx(Rr,{path:"/",element:e.jsx(see,{})}),e.jsx(Rr,{path:"*",element:e.jsx(no,{to:"/"})})]})}),t&&e.jsx(UC,{isOpen:N,onClose:()=>M(!1),currentUser:{firstName:s,lastName:o,email:l,phone:"",locations:"",availability:{}},isMobile:!1,onUserUpdate:()=>{console.log("Profile updated from global modal")}})]})}function pre(){return e.jsx(l_,{children:e.jsx(hre,{})})}a0.createRoot(document.getElementById("root")).render(e.jsx(Te.StrictMode,{children:e.jsx(pre,{})}));
//# sourceMappingURL=index-d22e7ff7.js.map
